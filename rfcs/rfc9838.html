<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9838: Group Key Management Using the Internet Key Exchange Protocol Version 2 (IKEv2)</title>
<meta content="Valery Smyslov" name="author">
<meta content="Brian Weis" name="author">
<meta content="
        This document presents an extension to the Internet Key Exchange
      Protocol Version 2 (IKEv2) for the purpose of group key management. The
      protocol is in conformance with the Multicast Security (MSEC) Group Key
      Management architecture, which contains two components: member
      registration and group rekeying. Both components are required for a
      Group Controller/Key Server (GCKS) to provide authorized Group Members
      (GMs) with IPsec Group Security Associations (GSAs). The GMs then
      exchange IP multicast or other group traffic as IPsec packets.
       
       This document obsoletes RFC 6407.
       
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="multicast" name="keyword">
<meta content="security" name="keyword">
<meta content="IPsec" name="keyword">
<meta content="GDOI" name="keyword">
<meta content="MSEC" name="keyword">
<meta content="9838" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9838.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://static.ietf.org/fonts/noto-sans/import.css'); /* Sans-serif */
@import url('https://static.ietf.org/fonts/noto-serif/import.css'); /* Serif (print) */
@import url('https://static.ietf.org/fonts/roboto-mono/import.css'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-ipsecme-g-ikev2-23" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9838" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9838</td>
<td class="center">G-IKEv2</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Smyslov &amp; Weis</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9838" class="eref">9838</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6407" class="eref">6407</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11" class="published">November 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">V. Smyslov</div>
<div class="org">ELVIS-PLUS</div>
</div>
<div class="author">
      <div class="author-name">B. Weis</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9838</h1>
<h1 id="title">Group Key Management Using the Internet Key Exchange Protocol Version 2 (IKEv2)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1"> This document presents an extension to the Internet Key Exchange
      Protocol Version 2 (IKEv2) for the purpose of group key management. The
      protocol is in conformance with the Multicast Security (MSEC) Group Key
      Management architecture, which contains two components: member
      registration and group rekeying. Both components are required for a
      Group Controller/Key Server (GCKS) to provide authorized Group Members
      (GMs) with IPsec Group Security Associations (GSAs). The GMs then
      exchange IP multicast or other group traffic as IPsec packets.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document obsoletes RFC 6407.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9838">https://www.rfc-editor.org/info/rfc9838</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction-and-overview" class="internal xref">Introduction and Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation" class="internal xref">Requirements Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-g-ikev2-protocol" class="internal xref">G-IKEv2 Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-g-ikev2-integration-into-th" class="internal xref">G-IKEv2 Integration into the IKEv2 Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-g-ikev2-transport-and-port" class="internal xref">G-IKEv2 Transport and Port</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-g-ikev2-payloads" class="internal xref">G-IKEv2 Payloads</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-g-ikev2-member-registration" class="internal xref">G-IKEv2 Member Registration and Secure Channel Establishment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-gsa_auth-exchange" class="internal xref">GSA_AUTH Exchange</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-gsa_registration-exchange" class="internal xref">GSA_REGISTRATION Exchange</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-gm-registration-operations" class="internal xref">GM Registration Operations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-gcks-registration-operation" class="internal xref">GCKS Registration Operations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-group-maintenance-channel" class="internal xref">Group Maintenance Channel</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-gsa_rekey" class="internal xref">GSA_REKEY</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-gsa_inband_rekey-exchange" class="internal xref">GSA_INBAND_REKEY Exchange</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.3">
                    <p id="section-toc.1-1.2.2.4.2.3.1"><a href="#section-2.4.3" class="auto internal xref">2.4.3</a>.  <a href="#name-deletion-of-sas" class="internal xref">Deletion of SAs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-counter-based-modes-of-oper" class="internal xref">Counter-Based Modes of Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5.2.1">
                    <p id="section-toc.1-1.2.2.5.2.1.1"><a href="#section-2.5.1" class="auto internal xref">2.5.1</a>.  <a href="#name-allocation-of-sender-id" class="internal xref">Allocation of Sender-ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5.2.2">
                    <p id="section-toc.1-1.2.2.5.2.2.1"><a href="#section-2.5.2" class="auto internal xref">2.5.2</a>.  <a href="#name-gm-usage-of-sender-id" class="internal xref">GM Usage of Sender-ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-replay-protection-for-multi" class="internal xref">Replay Protection for Multicast Data-Security SAs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-encryption-transforms-with-" class="internal xref">Encryption Transforms with Implicit IV</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-group-key-management-and-ac" class="internal xref">Group Key Management and Access Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-key-wrap-keys" class="internal xref">Key Wrap Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-default-key-wrap-key" class="internal xref">Default Key Wrap Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-gcks-key-management-semanti" class="internal xref">GCKS Key Management Semantics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-forward-access-control-requ" class="internal xref">Forward Access Control Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-gm-key-management-semantics" class="internal xref">GM Key Management Semantics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-sa-keys" class="internal xref">SA Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-header-and-payload-formats" class="internal xref">Header and Payload Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-g-ikev2-header" class="internal xref">G-IKEv2 Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-group-identification-payloa" class="internal xref">Group Identification Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-security-association-gm-sup" class="internal xref">Security Association - GM Supported Transforms Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-group-security-association-" class="internal xref">Group Security Association Payload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-group-policies" class="internal xref">Group Policies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-group-security-association-p" class="internal xref">Group Security Association Policy Substructure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-group-wide-policy-substruct" class="internal xref">Group-Wide Policy Substructure</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-key-download-payload" class="internal xref">Key Download Payload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-key-bags" class="internal xref">Key Bags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-group-key-bag-substructure" class="internal xref">Group Key Bag Substructure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.3">
                    <p id="section-toc.1-1.4.2.5.2.3.1"><a href="#section-4.5.3" class="auto internal xref">4.5.3</a>.  <a href="#name-member-key-bag-substructure" class="internal xref">Member Key Bag Substructure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.4">
                    <p id="section-toc.1-1.4.2.5.2.4.1"><a href="#section-4.5.4" class="auto internal xref">4.5.4</a>.  <a href="#name-key-wrapping" class="internal xref">Key Wrapping</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-delete-payload" class="internal xref">Delete Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-notify-payload" class="internal xref">Notify Payload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1">
                    <p id="section-toc.1-1.4.2.7.2.1.1"><a href="#section-4.7.1" class="auto internal xref">4.7.1</a>.  <a href="#name-invalid_group_id-notificati" class="internal xref">INVALID_GROUP_ID Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.2">
                    <p id="section-toc.1-1.4.2.7.2.2.1"><a href="#section-4.7.2" class="auto internal xref">4.7.2</a>.  <a href="#name-authorization_failed-notifi" class="internal xref">AUTHORIZATION_FAILED Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.3">
                    <p id="section-toc.1-1.4.2.7.2.3.1"><a href="#section-4.7.3" class="auto internal xref">4.7.3</a>.  <a href="#name-registration_failed-notific" class="internal xref">REGISTRATION_FAILED Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.4">
                    <p id="section-toc.1-1.4.2.7.2.4.1"><a href="#section-4.7.4" class="auto internal xref">4.7.4</a>.  <a href="#name-group_sender-notification" class="internal xref">GROUP_SENDER Notification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-authentication-payload" class="internal xref">Authentication Payload</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-using-g-ikev2-attributes" class="internal xref">Using G-IKEv2 Attributes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-interaction-with-ikev2-and-" class="internal xref">Interaction with IKEv2 and ESP Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-implicit-iv-for-counter-bas" class="internal xref">Implicit IV for Counter-Based Ciphers in ESP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-mixing-preshared-keys-in-ik" class="internal xref">Mixing Preshared Keys in IKEv2 for Post-Quantum Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-aggregation-and-fragmentati" class="internal xref">Aggregation and Fragmentation Mode for ESP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-gdoi-protocol-extensions" class="internal xref">GDOI Protocol Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-gsa-registration-and-secure" class="internal xref">GSA Registration and Secure Channel</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-gsa-maintenance-channel" class="internal xref">GSA Maintenance Channel</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-authentication-authorizatio" class="internal xref">Authentication/Authorization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-confidentiality" class="internal xref">Confidentiality</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="auto internal xref">8.2.3</a>.  <a href="#name-on-path-attack-protection" class="internal xref">On-Path Attack Protection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="auto internal xref">8.2.4</a>.  <a href="#name-replay-reflection-attack-pr" class="internal xref">Replay/Reflection Attack Protection</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-new-registries" class="internal xref">New Registries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-guidance-for-designated-exp" class="internal xref">Guidance for Designated Experts</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-changes-in-the-existing-ike" class="internal xref">Changes in the Existing IKEv2 Registries</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-use-of-lkh-in-g-ikev2" class="internal xref">Use of LKH in G-IKEv2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-group-creation" class="internal xref">Group Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-simple-group-sa-rekey" class="internal xref">Simple Group SA Rekey</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-group-member-exclusion" class="internal xref">Group Member Exclusion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction-and-overview">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-and-overview" class="section-name selfRef">Introduction and Overview</a>
      </h2>
<p id="section-1-1">This document presents an extension to IKEv2
      <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> called G-IKEv2, which accommodates group key management. A group key management protocol provides IPsec keys and policy to a
      set of IPsec devices that are authorized to communicate using a Group
      Security Association (GSA) defined in Multicast Group Security Architecture <span>[<a href="#RFC3740" class="cite xref">RFC3740</a>]</span>.
      The data communications within the group (e.g., IP multicast packets)
      are protected by a key pushed to the Group Members (GMs) by the Group Controller/Key Server (GCKS).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">G-IKEv2 conforms to "The Multicast Group Security
      Architecture" <span>[<a href="#RFC3740" class="cite xref">RFC3740</a>]</span>, "Multicast Extensions to the
      Security Architecture for the Internet Protocol" <span>[<a href="#RFC5374" class="cite xref">RFC5374</a>]</span>,
      and "Multicast Security (MSEC) Group Key Management Architecture" <span>[<a href="#RFC4046" class="cite xref">RFC4046</a>]</span>.
      G-IKEv2 replaces "The Group Domain of Interpretation" <span>[<a href="#RFC6407" class="cite xref">RFC6407</a>]</span>, which defines a
      similar group key management protocol using IKEv1 <span>[<a href="#RFC2409" class="cite xref">RFC2409</a>]</span> (since deprecated by IKEv2). When G-IKEv2 is
      used, group key management use cases can benefit from the simplicity,
      increased robustness, and cryptographic improvements of IKEv2 (see
      <span><a href="https://rfc-editor.org/rfc/rfc7296#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">G-IKEv2 is composed of two phases: registration and rekeying. In the registration phase, a GM
      contacts a GCKS to register to a group and to receive the necessary policy and the keying material 
      to be able communicate with the other GMs in the group as well as with the GCKS. 
      The rekeying phase allows the GCKS to periodically renew the keying material for both GM-to-GM
      communications as well as for communication between the GM and the GCKS.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">G-IKEv2 defines two ways to perform registration. When a GM first
      contacts a GCKS, it uses the GSA_AUTH exchange (<a href="#gsa_auth" class="auto internal xref">Section 2.3.1</a>) to register to a group. This exchange happens after
      the IKE_SA_INIT exchange (similarly to the IKE_AUTH exchange in IKEv2)
      and results in establishing an IKE Security Association (SA) between the GM and the GCKS.
      During this exchange, the GCKS authenticates and authorizes the GM and then
      pushes policy and keys used by the group to the GM.  The second new
      exchange type is the GSA_REGISTRATION exchange (<a href="#gsa_registration" class="auto internal xref">Section 2.3.2</a>), which can be used by the GM within the already-established
      IKE SA with the GCKS (e.g., for registering to another
      group).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Refreshing the group keys can be performed either in a unicast mode via the
      GSA_INBAND_REKEY exchange (<a href="#gsa_inband_rekey" class="auto internal xref">Section 2.4.2</a>) performed over a specific IKE SA between a GM and a GCKS 
      or in a multicast mode with the GSA_REKEY pseudo-exchange (<a href="#gsa_rekey" class="auto internal xref">Section 2.4.1</a>) when new keys are being distributed to all GMs.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Large and small groups may use different sets of these mechanisms.
      When a large group of devices are communicating, the GCKS is likely to
      use the GSA_REKEY message for efficiency. This is shown in <a href="#large-groups" class="auto internal xref">Figure 1</a>, where multicast communications are indicated with a double line.<a href="#section-1-6" class="pilcrow">¶</a></p>
<aside id="section-1-7">
        <p id="section-1-7.1">Note: For clarity, IKE_SA_INIT is omitted from Figures <a href="#large-groups" class="auto internal xref">1</a> and <a href="#small-groups" class="auto internal xref">2</a>.<a href="#section-1-7.1" class="pilcrow">¶</a></p>
</aside>
<span id="name-g-ikev2-used-in-large-group"></span><div id="large-groups">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-1-8.1">
<pre>
                      +--------+
       +----IKEv2----&gt;|  GCKS  |&lt;----IKEv2----+
       |              +--------+              |
       |               ||    ^                |
       |               ||    |                |
       |               || GSA_AUTH            |
       |               ||   or                |
       |               || GSA_REGISTRATION    |
       |               ||    |                |
    GSA_AUTH           ||  IKEv2           GSA_AUTH
      or               ||    |               or
GSA_REGISTRATION   GSA_REKEY |         GSA_REGISTRATION
       |               ||    |                |
       |    *==========**================*    |
       |   ||          ||    |           ||   |
       v   \/          \/    v           \/   v
     +-------+        +--------+        +-------+
     |  GM   |  ...   |   GM   |  ...   |  GM   |
     +-------+        +--------+        +-------+
        ||                ||               ||
         *=====ESP/AH=====**=====ESP/AH====*
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-g-ikev2-used-in-large-group" class="selfRef">G-IKEv2 Used in Large Groups</a>
        </figcaption></figure>
</div>
<p id="section-1-9">Alternatively, a small group may simply use the GSA_AUTH or GSA_REGISTRATION as
      registration protocols, where the GCKS issues rekeys using the
      GSA_INBAND_REKEY within the same IKE SA.<a href="#section-1-9" class="pilcrow">¶</a></p>
<span id="name-g-ikev2-used-in-small-group"></span><div id="small-groups">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-1-10.1">
<pre>
   GSA_AUTH or GSA_REGISTRATION, GSA_INBAND_REKEY
 +--------------------IKEv2----------------------+
 |                                               |
 |   GSA_AUTH or GSA_REGISTRATION,               |
 |         GSA_INBAND_REKEY                      |
 |   +-----------IKEv2-------------+             |
 |   |                             |             |
 |   |GSA_AUTH or GSA_REGISTRATION,|             |
 |   |      GSA_INBAND_REKEY       |             |
 |   |   +--IKEv2-+                |             |
 v   v   v        v                v             v
+---------+    +----+           +----+        +----+
| GCKS/GM |    | GM |           | GM |        | GM |
+---------+    +----+           +----+        +----+
     ||          ||               ||            ||
      *==ESP/AH==**=====ESP/AH====**===ESP/AH===*
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-g-ikev2-used-in-small-group" class="selfRef">G-IKEv2 Used in Small Groups</a>
        </figcaption></figure>
</div>
<p id="section-1-11"> A combination of these approaches is also possible. For example,  
      the GCKS may use more robust GSA_INBAND_REKEY to provide keys for some GMs 
      (for example, those acting as senders in the group) and GSA_REKEY for the rest.<a href="#section-1-11" class="pilcrow">¶</a></p>
<aside id="section-1-12">
        <p id="section-1-12.1">Note: GCKS may also be a GM (as shown in <a href="#small-groups" class="auto internal xref">Figure 2</a>).<a href="#section-1-12.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-1-13">IKEv2 message semantics are preserved in that all communications
      consist of message request-response pairs. The exception to this rule
      is the GSA_REKEY pseudo-exchange, which is a single message delivering group
      updates to the GMs.<a href="#section-1-13" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<div id="terms">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1"> It is assumed that readers are familiar with the IPsec
        architecture <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span> and its extension for multicast
        <span>[<a href="#RFC5374" class="cite xref">RFC5374</a>]</span>. This document defines an extension to the
        IKEv2 protocol <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> and skips many of its
        details. The notation and conventions from <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
        are used for describing G-IKEv2 payloads and exchanges.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">The following key terms are used throughout this document (mostly
        borrowed from <span>[<a href="#RFC3740" class="cite xref">RFC3740</a>]</span>, <span>[<a href="#RFC5374" class="cite xref">RFC5374</a>]</span>, and <span>[<a href="#RFC6407" class="cite xref">RFC6407</a>]</span>).<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><div id="definitions">
<dl class="dlNewline" id="section-1.2-3">
          <dt id="section-1.2-3.1">Group:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">A set of IPsec devices that communicate to each other using multicast.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">Group Member (GM):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">An IPsec device that belongs to a group.  A GM is
          authorized to be a group sender and/or a group receiver.<a href="#section-1.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">Group Receiver:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.6">A GM that is authorized to receive packets sent to a group by a group sender.<a href="#section-1.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Group Sender:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.8">A GM that is authorized to send packets to a group.<a href="#section-1.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.9">Group Key Management (GKM) Protocol:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.10">A key management protocol used by a GCKS to distribute IPsec
          Security Association policy and keying material.  A GKM protocol
          is needed because a group of IPsec devices require the same SAs.  For
          example, when an IPsec SA describes an IP multicast destination,
          the sender and all receivers need to have the group SA.<a href="#section-1.2-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.11">Group Controller/Key Server (GCKS):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.12">A Group Key Management (GKM) protocol server that manages IPsec
          state for a group.  A GCKS authenticates and provides the IPsec SA
          policy and keying material to GMs.<a href="#section-1.2-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.13">Data-Security SA:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.14">A multicast SA between each multicast sender and the group's receivers.
          The Data-Security SA protects data between member senders and
          member receivers. One or more SAs are required for the multicast transmission of
          data messages from the group sender to other GMs.
          This specification relies on Encapsulating Security Payload (ESP) and Authentication Header (AH) as protocols for Data-Security SAs.<a href="#section-1.2-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.15">Rekey SA:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.16">A single multicast SA between the GCKS and all of the GMs.
          This SA is used for multicast transmission of key management messages from the GCKS to all GMs.<a href="#section-1.2-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.17">Group SA:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.18">A Data-Security SA or Rekey SA that is shared as part of group policy.<a href="#section-1.2-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.19">Group Security Association (GSA):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.20">A collection of Data-Security SAs and Rekey SAs
          necessary for a GM to receive key updates.
          A GSA describes the working policy for a group.  Refer to the MSEC Group Key Management Architecture <span>[<a href="#RFC4046" class="cite xref">RFC4046</a>]</span>
          for additional information.<a href="#section-1.2-3.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.21">Traffic Encryption Key (TEK):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.22">The symmetric cipher key used in a Data-Security SA (e.g., IPsec ESP) to protect traffic.<a href="#section-1.2-3.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.23">Key Encryption Key (KEK):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.24">The symmetric key (or a set of keys) used in a Rekey SA to protect its messages. The set of keys may include keys 
          for encryption and authentication, as well as keys for key wrapping.<a href="#section-1.2-3.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.25">Key Wrap Key (KWK):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.26">The symmetric cipher key used to protect another key.<a href="#section-1.2-3.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.27">Group-Wide (GW) policy:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.28">Group policy not related to a particular SA.<a href="#section-1.2-3.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.29">Activation Time Delay (ATD):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.30">Defines how long group senders should wait after receiving new SAs before sending traffic over them.<a href="#section-1.2-3.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.31">Deactivation Time Delay (DTD):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.32">Defines how long GMs should wait after receiving a request to delete Data-Security SAs before actually deleting them.<a href="#section-1.2-3.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.33">Sender-ID:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.34">A unique identifier of a group sender in the context of an active GSA used to form the Initialization Vector (IV) in counter-based cipher modes.<a href="#section-1.2-3.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.35">Logical Key Hierarchy (LKH):</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.36">A group management method defined in <span><a href="https://rfc-editor.org/rfc/rfc2627#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC2627" class="cite xref">RFC2627</a>]</span>.<a href="#section-1.2-3.36" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</div>
</section>
</div>
</section>
<section id="section-2">
      <h2 id="name-g-ikev2-protocol">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-g-ikev2-protocol" class="section-name selfRef">G-IKEv2 Protocol</a>
      </h2>
<p id="section-2-1">G-IKEv2 is an extension to the IKEv2 protocol <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> that provides group authorization, 
        secure policy, and keys download from the GCKS to GMs.<a href="#section-2-1" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-g-ikev2-integration-into-th">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-g-ikev2-integration-into-th" class="section-name selfRef">G-IKEv2 Integration into the IKEv2 Protocol</a>
        </h3>
<p id="section-2.1-1">G-IKEv2 is compatible with most IKEv2 extensions defined so far (see <a href="#ike_ext" class="auto internal xref">Section 6</a> for details). 
        In particular, it is assumed that, if necessary, the IKE_INTERMEDIATE exchanges <span>[<a href="#RFC9242" class="cite xref">RFC9242</a>]</span> may be utilized 
        while establishing the registration SA. It is also believed that 
        future IKEv2 extensions will be possible to use with G-IKEv2. However, some IKEv2 extensions may require 
        special handling when used with G-IKEv2.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<section id="section-2.1.1">
          <h4 id="name-g-ikev2-transport-and-port">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-g-ikev2-transport-and-port" class="section-name selfRef">G-IKEv2 Transport and Port</a>
          </h4>
<p id="section-2.1.1-1"> As an IKEv2 extension, G-IKEv2 <span class="bcp14">SHOULD</span> use the IKEv2 ports (500, 4500). 
G-IKEv2 <span class="bcp14">MAY</span> use TCP transport for the IKE SA used for registration (which is unicast),
   as defined in TCP Encapsulation of IKEv2 and IPsec <span>[<a href="#RFC9329" class="cite xref">RFC9329</a>]</span>.
          G-IKEv2 <span class="bcp14">MAY</span> also use UDP port 848, the same as Group Domain of Interpretation (GDOI) <span>[<a href="#RFC6407" class="cite xref">RFC6407</a>]</span>, because they serve a similar function. 
          The version number in the IKE header distinguishes the G-IKEv2
          protocol from the GDOI protocol <span>[<a href="#RFC6407" class="cite xref">RFC6407</a>]</span>.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2"><span><a href="https://rfc-editor.org/rfc/rfc7296#section-2.23" class="relref">Section 2.23</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> describes how IKEv2 supports paths with NATs.
          The G-IKEv2 registration SA doesn't create any unicast IPsec SAs; thus,
          if a NAT is present between the GM and the GCKS, there is no unicast
          ESP traffic to encapsulate in UDP. However, the actions described in
          this section regarding the IKE SA <span class="bcp14">MUST</span> be honored.
          The behavior of GMs and GCKS <span class="bcp14">MUST NOT</span> depend on the
          port used to create the initial IKE SA.  For example, if the GM and
          the GCKS used UDP port 848 for the IKE_SA_INIT exchange, they will
          operate the same as if they had used UDP port 500.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-2.2">
        <h3 id="name-g-ikev2-payloads">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-g-ikev2-payloads" class="section-name selfRef">G-IKEv2 Payloads</a>
        </h3>
<p id="section-2.2-1">In the following descriptions, the payloads contained in the G-IKEv2 
        messages are indicated by names as listed below.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span id="name-payloads-used-in-g-ikev2"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-payloads-used-in-g-ikev2" class="selfRef">Payloads Used in G-IKEv2</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Notation</th>
              <th class="text-left" rowspan="1" colspan="1">Payload</th>
              <th class="text-left" rowspan="1" colspan="1">Defined in</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AUTH</td>
              <td class="text-left" rowspan="1" colspan="1">Authentication</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CERT</td>
              <td class="text-left" rowspan="1" colspan="1">Certificate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CERTREQ</td>
              <td class="text-left" rowspan="1" colspan="1">Certificate Request</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">D</td>
              <td class="text-left" rowspan="1" colspan="1">Delete</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GSA</td>
              <td class="text-left" rowspan="1" colspan="1">Group Security Association</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#gsa_payload" class="auto internal xref">Section 4.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">HDR</td>
              <td class="text-left" rowspan="1" colspan="1">IKE header (not a payload)</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IDg</td>
              <td class="text-left" rowspan="1" colspan="1">Group Identification</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#idg_payload" class="auto internal xref">Section 4.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IDi</td>
              <td class="text-left" rowspan="1" colspan="1">Identification - Initiator</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IDr</td>
              <td class="text-left" rowspan="1" colspan="1">Identification - Responder</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KD</td>
              <td class="text-left" rowspan="1" colspan="1">Key Download</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#kd_payload" class="auto internal xref">Section 4.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KE</td>
              <td class="text-left" rowspan="1" colspan="1">Key Exchange</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Ni, Nr</td>
              <td class="text-left" rowspan="1" colspan="1">Nonce</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">Notify</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SA</td>
              <td class="text-left" rowspan="1" colspan="1">Security Association</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SAg</td>
              <td class="text-left" rowspan="1" colspan="1">Security Association - GM Supported Transforms</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sag_payload" class="auto internal xref">Section 4.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SK</td>
              <td class="text-left" rowspan="1" colspan="1">Encrypted and Authenticated (also known as Encrypted)</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
<p id="section-2.2-3"> Payloads defined as part of other IKEv2 extensions <span class="bcp14">MAY</span> also be included in 
          these messages. Payloads that may optionally appear in G-IKEv2 messages
          will be shown in brackets, such as [CERTREQ].<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">G-IKEv2 defines several new payloads not used in IKEv2:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.2-5">
          <dt id="section-2.2-5.1">Group Identification (IDg):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.2">The GM requests the GCKS for membership
          into the group by sending its IDg payload.<a href="#section-2.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.3">Security Association - GM Supported
          Transforms (SAg):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.4">The GM optionally sends supported transforms so
          that GCKS may select a policy appropriate for all members of the
          group (which is not negotiated, unlike SA parameters in IKEv2).<a href="#section-2.2-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.5">Group Security Association (GSA):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.6">The GCKS sends the
          group policy to the GM using this payload.<a href="#section-2.2-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.7">Key Download (KD):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.8">The GCKS sends the keys and the
          security parameters to the GMs using this payload.<a href="#section-2.2-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-6"> The details of the contents of each payload are described in <a href="#header_payload" class="auto internal xref">Section 4</a>.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
</section>
<div id="registration">
<section id="section-2.3">
        <h3 id="name-g-ikev2-member-registration">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-g-ikev2-member-registration" class="section-name selfRef">G-IKEv2 Member Registration and Secure Channel Establishment</a>
        </h3>
<p id="section-2.3-1">Initial registration is combined with establishing a secure connection between the 
        entity seeking registration and the GCKS. This process consists of a minimum of two 
        exchanges, IKE_SA_INIT and GSA_AUTH; member registration may have a
        few more messages exchanged if the Extensible Authentication Protocol (EAP) method, cookie challenge (for
        DoS protection), negotiation of key exchange method, or IKEv2 extensions 
        based on the IKEv2 Intermediate Exchange <span>[<a href="#RFC9242" class="cite xref">RFC9242</a>]</span> 
        are used. Each exchange consists of request/response pairs. The first exchange, called
        IKE_SA_INIT, is defined in IKEv2 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>. 

This
        exchange negotiates cryptographic algorithms, exchanges nonces, and
        computes a shared key between the GM and the GCKS.
        In addition to the cryptographic algorithms negotiated for use in IKEv2 SA,
        a key wrap algorithm is also negotiated in this exchange by means of a new "Key Wrap Algorithm" transform. 
        See <a href="#wrapped_key" class="auto internal xref">Section 4.5.4</a> for details.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The second exchange, called GSA_AUTH, is similar to the IKEv2 IKE_AUTH exchange <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.
        It authenticates the previously exchanged messages and exchanges identities and certificates. 
        The GSA_AUTH messages are encrypted and integrity protected with keys established through the previous
        exchanges, so the identities are hidden from eavesdroppers and all
        fields in all the messages are authenticated. The GCKS authorizes
        GMs to be allowed into the group as part of the
        GSA_AUTH exchange. Once the GCKS accepts a GM to join a
        group, it will provide the GM with the data-security keys (TEKs) and/or a group key
        encrypting key (KEK) as part of the GSA_AUTH response message.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The established secure channel between the GM and the GCKS is in fact IKE SA (as defined in 
        <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>) and is referred to as such throughout this document. 
        However, it is <span class="bcp14">NOT RECOMMENDED</span> to use this IKE SA for the purpose of creating
        unicast Child SAs between the GM and the GCKS since authentication requirements for 
        group admission and for unicast communication may differ. In addition, the life cycle
        of this IKE SA is determined by the GCKS and this SA can be deleted at any time.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<div id="gsa_auth">
<section id="section-2.3.1">
          <h4 id="name-gsa_auth-exchange">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-gsa_auth-exchange" class="section-name selfRef">GSA_AUTH Exchange</a>
          </h4>
<p id="section-2.3.1-1">The GSA_AUTH exchange is used to authenticate the previous exchanges and
          exchange identities and certificates. G-IKEv2 also uses this
          exchange for GM registration and authorization.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2"> The GSA_AUTH exchange is similar to the IKE_AUTH exchange with the 
          difference that its goal is to establish a multicast Data-Security SA(s)
          and optionally provide GM with the keys for a Rekey SA. The set of payloads 
          in the GSA_AUTH exchange is slightly different because policy is not
          negotiated between the GM and the GCKS; instead, it is 
          provided by the GCKS for the GM. Also note that GSA_AUTH 
          has its own exchange type, which is different from the IKE_AUTH exchange type.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<aside id="section-2.3.1-3">
            <p id="section-2.3.1-3.1">Note: Due to the similarities between IKE_AUTH and GSA_AUTH,
          most IKEv2 extensions to the IKE_AUTH exchange 
          (like secure password authentication <span>[<a href="#RFC6467" class="cite xref">RFC6467</a>]</span>) can also be used with the GSA_AUTH exchange.<a href="#section-2.3.1-3.1" class="pilcrow">¶</a></p>
</aside>
<span id="name-gsa_auth-request"></span><div id="gsa_auth_request">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-2.3.1-4.1">
<pre>
 Initiator (GM)                                  Responder (GCKS)
--------------------                            ------------------
 HDR, SK{IDi, [CERT,] [CERTREQ,] [IDr,]
      AUTH, IDg, [SAg,] [N(GROUP_SENDER),] [N]}   --&gt;
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-gsa_auth-request" class="selfRef">GSA_AUTH Request</a>
            </figcaption></figure>
</div>
<p id="section-2.3.1-5">A GM initiates a GSA_AUTH request to join a group indicated 
          by the IDg payload. The GM may include an SAg payload declaring which
          Transforms it is willing to accept. A GM that intends to act as group sender 
          <span class="bcp14">MUST</span> include a Notify payload status type of GROUP_SENDER,
          which enables the GCKS to provide any additional policy necessary by
          group senders.<a href="#section-2.3.1-5" class="pilcrow">¶</a></p>
<span id="name-gsa_auth-normal-response"></span><div id="gsa_auth_norm_response">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-2.3.1-6.1">
<pre>
 Initiator (GM)                 Responder (GCKS)
--------------------           ------------------
                          &lt;--   HDR, SK{IDr, [CERT,]
                                     AUTH, GSA, KD, [N]}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-gsa_auth-normal-response" class="selfRef">GSA_AUTH Normal Response</a>
            </figcaption></figure>
</div>
<p id="section-2.3.1-7"> The GCKS responds with IDr, optional CERT, and AUTH payloads 
          with the same meaning as in IKE_AUTH. It also informs the GM
          of the cryptographic policies of the group in the GSA payload and
          the key material in the KD payload.<a href="#section-2.3.1-7" class="pilcrow">¶</a></p>
<p id="section-2.3.1-8"> Possible errors should be handled in accordance with <span><a href="https://rfc-editor.org/rfc/rfc7296#section-2.21.2" class="relref">Section 2.21.2</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.
          In addition to the IKEv2 error handling, the GCKS can reject the
          registration request when the IDg is invalid or authorization fails,
          etc. In these cases (see <a href="#notify" class="auto internal xref">Section 4.7</a>), the GSA_AUTH
          response will not include the GSA and KD but will include a Notify
          payload indicating errors. If a GM included an SAg
          payload and the GCKS chooses to evaluate it and detects that
          the GM cannot support the security policy defined for the
          group, then the GCKS returns the NO_PROPOSAL_CHOSEN notification.
          Other types of error notifications can be INVALID_GROUP_ID, AUTHORIZATION_FAILED, or REGISTRATION_FAILED.<a href="#section-2.3.1-8" class="pilcrow">¶</a></p>
<span id="name-gsa_auth-error-response-for"></span><div id="gsa_auth_err_response">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-2.3.1-9.1">
<pre>
 Initiator (GM)                   Responder (GCKS)
--------------------             ------------------
                           &lt;--   HDR, SK{IDr, [CERT,] AUTH, N}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-gsa_auth-error-response-for" class="selfRef">GSA_AUTH Error Response for Group-Related Errors</a>
            </figcaption></figure>
</div>
<p id="section-2.3.1-10">If the GSA_AUTH exchange is completed successfully but 
          the GM finds that the policy sent by the GCKS is
          unacceptable, the member <span class="bcp14">SHOULD</span> inform the GCKS about this by initiating the GSA_REGISTRATION exchange
          with the IDg payload and the NO_PROPOSAL_CHOSEN notification 
          (see <a href="#gsa_registration_gm_error" class="auto internal xref">Figure 8</a>).<a href="#section-2.3.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gsa_registration">
<section id="section-2.3.2">
          <h4 id="name-gsa_registration-exchange">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-gsa_registration-exchange" class="section-name selfRef">GSA_REGISTRATION Exchange</a>
          </h4>
<p id="section-2.3.2-1">Once the IKE SA between the GM and the GCKS is established,
          the GM can use it for other registration requests if needed.
          In this scenario, the GM will use the
          GSA_REGISTRATION exchange. Payloads in the exchange are generated
          and processed as defined in <a href="#gsa_auth" class="auto internal xref">Section 2.3.1</a>.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<span id="name-gsa_registration-normal-exc"></span><div id="gsa_registration_exchange">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-2.3.2-2.1">
<pre>
 Initiator (GM)                   Responder (GCKS)
--------------------             ------------------
 HDR, SK{IDg, [SAg,]
      [N(GROUP_SENDER),] [N]} --&gt;
                             &lt;--  HDR, SK{GSA, KD, [N]}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-gsa_registration-normal-exc" class="selfRef">GSA_REGISTRATION Normal Exchange</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-3">As with GSA_AUTH exchange, the GCKS can reject the
          registration request when the IDg is invalid or authorization fails,
          or GM cannot support the security policy defined for the
          group (which can be concluded by the GCKS by evaluation of the SAg payload).
          In this case, the GCKS returns an appropriate error notification
          as described in <a href="#gsa_auth" class="auto internal xref">Section 2.3.1</a>.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<span id="name-gsa_registration-error-exch"></span><div id="gsa_registration_err_exchange">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-2.3.2-4.1">
<pre>
 Initiator (GM)                    Responder (GCKS)
--------------------              ------------------
 HDR, SK{IDg, [SAg,]
      [N(GROUP_SENDER),] [N]} --&gt;
                            &lt;--    HDR, SK{N}
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-gsa_registration-error-exch" class="selfRef">GSA_REGISTRATION Error Exchange</a>
            </figcaption></figure>
</div>
<p id="section-2.3.2-5">This exchange can also be used if the GM finds that the
          policy sent by the GCKS is unacceptable or wants to leave 
          the group for some reason. The GM <span class="bcp14">SHOULD</span>
          notify the GCKS by sending IDg and the Notify type
          NO_PROPOSAL_CHOSEN or REGISTRATION_FAILED as shown below. 
          In this case, the GCKS <span class="bcp14">MUST</span> remove the GM from the group denoted in IDg.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
<span id="name-gm-reporting-errors-in-gsa_"></span><div id="gsa_registration_gm_error">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-2.3.2-6.1">
<pre>
 Initiator (GM)                     Responder (GCKS)
--------------------               ------------------
 HDR, SK{IDg, N}      --&gt;
                         &lt;--        HDR, SK{}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-gm-reporting-errors-in-gsa_" class="selfRef">GM Reporting Errors in GSA_REGISTRATION Exchange</a>
            </figcaption></figure>
</div>
</section>
</div>
<section id="section-2.3.3">
          <h4 id="name-gm-registration-operations">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-gm-registration-operations" class="section-name selfRef">GM Registration Operations</a>
          </h4>
<p id="section-2.3.3-1">A GM requesting registration contacts the
          GCKS using the IKE_SA_INIT exchange. This exchange is unchanged from IKE_SA_INIT 
          in the IKEv2 protocol. 


The IKE_SA_INIT exchange may optionally be followed 
          by one or more of the IKE_INTERMEDIATE exchanges if the GM and the GCKS
          negotiated use of IKEv2 extensions based on this exchange.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">Next, the GM sends the GSA_AUTH request message with the IKEv2 payloads
          from IKE_AUTH (without the SAi2, TSi, and TSr payloads) along with
          the Group ID informing the GCKS of the group the GM wishes to
          join. A GM intending to emit data traffic <span class="bcp14">MUST</span> send a
          GROUP_SENDER notification. The GROUP_SENDER notification not only signifies that it
          is a sender but provides the GM the ability to request
          Sender-ID values in case the Data-Security SA supports a counter-mode cipher. <a href="#sid_alloc" class="auto internal xref">Section 2.5.1</a> includes guidance
          on requesting Sender-ID values.<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">A GM may be limited in the Transforms IDs that it is
          able or willing to use and may find it useful to inform the GCKS
          which Transform IDs it is willing to accept for different security protocols
          by including the SAg payload into the request message.
          Proposals for Rekey SA and for Data-Security 
          (AH <span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span> and/or ESP <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span>) SAs 
          may be included into SAg. Proposals for Rekey SA are identified 
          by a new Security Protocol Identifier GIKE_UPDATE with the value 6.
          Each Proposal contains a list of Transforms that the GM is able 
          and willing to support for that protocol. Valid Transform Types depend on the 
          protocol (AH, ESP, GIKE_UPDATE) and are defined in <a href="#allowed_transforms" class="auto internal xref">Table 2</a>.
          Other Transform Types <span class="bcp14">SHOULD NOT</span> be included as they will be ignored by the GCKS.
          The Security Parameter Index (SPI) length of each Proposal in an SAg is set to zero, and thus the SPI field is empty. 
          The GCKS <span class="bcp14">MUST NOT</span> use SPI length and SPI fields in the SAg payload.<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3-4">Generally, a single Proposal for each protocol (GIKE_UPDATE,
          AH/ESP) will suffice. Because the transforms are not negotiated, the
          GM simply alerts the GCKS to restrictions it may have.  In
          particular, the restriction from  <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> that Authenticated Encryption with Associated Data (AEAD) and non-AEAD
          transforms not be combined in a single proposal doesn't hold when
          the SAg payload is being formed. However, if the GM has restrictions
          on the combination of algorithms, this can be expressed by sending
          several proposals.<a href="#section-2.3.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3.3-5">The Proposal Num field in the Proposal substructure is treated specially in the SAg payload:
          it allows a GM to indicate that algorithms used in Rekey SA and in 
          Data-Security (AH and/or ESP) SAs are dependent.
          In particular, Proposals for different protocols having the same value in the
          Proposal Num field are treated as a set so that if GCKS uses transforms
          from one of such Proposal for one protocol, then it <span class="bcp14">MUST</span> only use transforms from 
          one of the Proposals with the same value in the Proposal Num field for other protocols.
          For example, a GM may support algorithms X and Y for both Rekey and
          Data-Security SAs, but with a restriction that if X is used in  Rekey SAs, then only X can be used
          in Data-Security SAs, and the same for Y. 
          Use of the same value in the Proposal Num field of different
          proposals indicates that the GM expects these proposals to be
          used in conjunction with each other.
          In the simplest case when no dependency between transforms exists,
          all Proposals in the SAg payload will have the same value in the Proposal Num field.<a href="#section-2.3.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3.3-6">Although the SAg payload is optional, it is <span class="bcp14">RECOMMENDED</span> that the GM include
          this payload into the GSA_AUTH request to allow the GCKS to select an appropriate policy.<a href="#section-2.3.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3.3-7">A GM <span class="bcp14">MAY</span> also indicate the support for IPcomp by including one or more the IPCOMP_SUPPORTED
          notifications along with the SAg payload in the request. The Compression Parameter Index (CPI) in these notifications is set to zero
          and <span class="bcp14">MUST</span> be ignored by the GCKS.<a href="#section-2.3.3-7" class="pilcrow">¶</a></p>
<p id="section-2.3.3-8">Upon receiving the GSA_AUTH response, the GM parses the
          response from the GCKS authenticating the exchange using the IKEv2
          method, then processes the GSA and KD payloads.<a href="#section-2.3.3-8" class="pilcrow">¶</a></p>
<p id="section-2.3.3-9">The GSA payload contains the security policy and cryptographic
          protocols used by the group.

This policy describes zero or more Data-Security SAs (TEK), zero or one Rekey SA (KEK), and zero or one GW policy (although at least one TEK or KEK policy <span class="bcp14">MUST</span> be
   Present).
          If the policy in the GSA payload is not acceptable to the GM,
          it <span class="bcp14">SHOULD</span> notify the GCKS by initiating a GSA_REGISTRATION exchange 
          with a NO_PROPOSAL_CHOSEN Notify payload (see <a href="#gsa_registration" class="auto internal xref">Section 2.3.2</a>). 
          Note that this should normally not happen if the GM includes the SAg payload 
          in the GSA_AUTH request and the GCKS takes it into account.
          Finally, the KD payload is parsed, providing the keying material for the TEK and/or KEK. 
          The KD payload contains a list of key bags, where each key bag includes the
          keying material for SAs distributed in the GSA payload. Keying
          material is matched by comparing the SPIs in the key bags to SPIs
          previously included in the GSA payloads. Once TEK keys and policy
          are matched, the GM provides them to the data-security subsystem,
          and it is ready to send or receive packets matching the TEK
          policy.<a href="#section-2.3.3-9" class="pilcrow">¶</a></p>
<p id="section-2.3.3-10"> If the GM is not a sender for a received Data-Security SA, 
          then it <span class="bcp14">MUST</span> install this SA only in the inbound direction.
          If the GM is a sender for a received Data-Security SA, 
          and it is not going to receive back the data it sends, 
          then it <span class="bcp14">MUST</span> install this SA only in the outgoing direction.<a href="#section-2.3.3-10" class="pilcrow">¶</a></p>
<p id="section-2.3.3-11">If the first Message ID the GM should expect to receive is non-zero,
          the GSA KEK policy includes the attribute GSA_INITIAL_MESSAGE_ID with
          the expected non-zero value.
          The value of the attribute <span class="bcp14">MUST</span> be checked by a GM against any previously received Message ID for this group.
          If it is less than the previously received number, it should be
          considered stale and <span class="bcp14">MUST</span> be ignored. This could happen if two GSA_AUTH
          exchanges happened in parallel and the Message ID changed. This
          attribute is used by the GM to prevent GSA_REKEY message replay
          attacks. The first GSA_REKEY message that the GM receives from the
          GCKS will have a Message ID greater than or equal to the Message ID
          received in the GSA_INITIAL_MESSAGE_ID attribute.<a href="#section-2.3.3-11" class="pilcrow">¶</a></p>
<p id="section-2.3.3-12">GMs <span class="bcp14">MUST</span> install the Rekey SA only in the inbound direction.<a href="#section-2.3.3-12" class="pilcrow">¶</a></p>
<p id="section-2.3.3-13">Once a GM successfully registers to the group, it <span class="bcp14">MUST</span> replace
          any information related to this group (policy, keys) that it might
          have as a result of a previous registration with a new one.<a href="#section-2.3.3-13" class="pilcrow">¶</a></p>
<p id="section-2.3.3-14">Once a GM has received the GIKE_UPDATE policy during a registration,
          the IKE SA <span class="bcp14">MAY</span> be closed.  By convention, the GCKS
          closes the IKE SA; the GM <span class="bcp14">SHOULD NOT</span> close it.  The
          GCKS <span class="bcp14">MAY</span> choose to keep the IKE SA open for inband
          rekey, especially for small groups.  If inband rekey is used, then
          the initial IKE SA can be rekeyed by any side with the standard
          IKEv2 mechanism described in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-1.3.2" class="relref">Section 1.3.2</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.  If for some reason the
          IKE SA is closed and no GIKE_UPDATE policy is received during the
          registration process, the GM <span class="bcp14">MUST</span> consider itself
          excluded from the group.  To continue participating in the group,
          the GM needs to re-register.<a href="#section-2.3.3-14" class="pilcrow">¶</a></p>
</section>
<section id="section-2.3.4">
          <h4 id="name-gcks-registration-operation">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-gcks-registration-operation" class="section-name selfRef">GCKS Registration Operations</a>
          </h4>
<p id="section-2.3.4-1">A G-IKEv2 GCKS listens for incoming requests from GMs. When the GCKS receives an IKE_SA_INIT request, it selects
          an IKE proposal and generates a nonce and Diffie-Hellman (DH) to include in the
          IKE_SA_INIT response.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">Upon receiving the GSA_AUTH request, the GCKS authenticates the
          GM via the GSA_AUTH exchange. The
          GCKS then authorizes the GM according to group policy
          before preparing to send the GSA_AUTH response. If the GCKS fails to
          authorize the GM, it responds with an AUTHORIZATION_FAILED
          notification. The GCKS may also respond with an INVALID_GROUP_ID notification
          if the requested group is unknown to the GCKS or with an REGISTRATION_FAILED
          notification if there is a problem with the requested group (e.g., if
          the capacity of the group is exceeded).<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<p id="section-2.3.4-3">The GSA_AUTH response will include the group policy in the GSA
          payload and keys in the KD payload. 
If the GCKS policy includes a
          group rekey option and the initial Message ID value the GCKS will use when sending the GSA_REKEY messages 
          to the GMs is non-zero, then this value is specified in the GSA_INITIAL_MESSAGE_ID attribute. 
          This Message ID is used to prevent GSA_REKEY 
          message replay attacks and will be increased each time a GSA_REKEY message is sent
          to the group. The GCKS data traffic policy is included in the GSA
          TEK and keys are included in the KD TEK. The GW policy <span class="bcp14">MAY</span> also be
          included to provide the Activation
   Time Delay (ATD) and/or Deactivation Time Delay (DTD) (<a href="#gwp_attr_atd_dtd" class="auto internal xref">Section 4.4.3.1.1</a>) 
          to specify activation and deactivation
          delays for SAs generated from the TEKs. If the GM has
          indicated that it is a sender of data traffic and one or more Data-Security SAs distributed in the GSA payload included a counter mode
          of operation, the GCKS responds with one or more Sender-ID values (see <a href="#counter-modes" class="auto internal xref">Section 2.5</a>).<a href="#section-2.3.4-3" class="pilcrow">¶</a></p>
<p id="section-2.3.4-4"> Multicast Extensions to the Security Architecture <span>[<a href="#RFC5374" class="cite xref">RFC5374</a>]</span> defines two modes of operation for multicast 
          Data-Security SAs: transport mode and tunnel mode with address preservation.
          In the latter case, outer source and destination addresses are taken from
          the inner IP packet. The mode of operation for the Data-Security SAs is determined 
          by the presence of the USE_TRANSPORT_MODE notification 
          in the GCKS's response message of the registration exchange. If it is present,
          then SAs are created in transport mode; otherwise, SAs are created in tunnel mode.
          If multiple Data-Security SAs are being created in a single registration exchange,
          then all of them will have the same mode of operation.<a href="#section-2.3.4-4" class="pilcrow">¶</a></p>
<p id="section-2.3.4-5">If the GCKS receives a GSA_REGISTRATION exchange with a request
          to register a GM to a group, the GCKS will need to authorize the GM
          with the new group (IDg) and respond with the corresponding group
          policy and keys. If the GCKS fails to authorize the GM, it will
          respond with the AUTHORIZATION_FAILED notification. The GCKS may also 
          respond with an INVALID_GROUP_ID or REGISTRATION_FAILED notify messages 
          for the reasons described above.<a href="#section-2.3.4-5" class="pilcrow">¶</a></p>
<p id="section-2.3.4-6">If a GM includes an SAg in its GSA_AUTH or
          GSA_REGISTRATION request, the GCKS may evaluate it according to an
          implementation-specific policy.<a href="#section-2.3.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-7.1">
              <p id="section-2.3.4-7.1.1">The GCKS could evaluate the list of Transforms and compare it
              to its current policy for the group. If the GM did not
              include all of the ESP, AH, or GIKE_UPDATE Transforms that match the current group policy
              or the capabilities of all other currently active GMs, 
              then the GCKS <span class="bcp14">SHOULD</span> return a NO_PROPOSAL_CHOSEN notification.
              Alternatively, the GCKS can change the group policy as defined below.<a href="#section-2.3.4-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-7.2">
              <p id="section-2.3.4-7.2.1">The GCKS could store the list of Transforms with the goal of
     migrating the group policy from the current set of transforms to 
     a different one once all of the GMs indicate that they 
     can support transforms from the new set.<a href="#section-2.3.4-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-7.3">
              <p id="section-2.3.4-7.3.1">The GCKS could store the list of Transforms and adjust the
              current group policy based on the capabilities of the devices as
              long as they fall within the acceptable security policy of the
              GCKS.<a href="#section-2.3.4-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-8">
          Depending on its policy, the GCKS may have no further need for the
          IKE SA (e.g., it does not plan to initiate a GSA_INBAND_REKEY
          exchange). If the GM does not initiate another registration exchange
          or Notify (e.g., NO_PROPOSAL_CHOSEN) and the GCKS is not intended to use the SA, then the GCKS <span class="bcp14">SHOULD</span> close the IKE SA to save resources after a short period of time.<a href="#section-2.3.4-8" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-2.4">
        <h3 id="name-group-maintenance-channel">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-group-maintenance-channel" class="section-name selfRef">Group Maintenance Channel</a>
        </h3>
<p id="section-2.4-1">The GCKS is responsible for rekeying the secure group per the group
        policy.
   Rekeying is an operation whereby the GCKS provides
   replacement TEK(s) and/or KEK, deleting TEK(s), and/or
   excluding GMs.
        The GCKS may initiate a rekey message if group membership and/or policy has
        changed or if the keys are about to expire. Two forms of group
        maintenance channels are provided in G-IKEv2 to push new policy to
        GMs.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.4-2">
          <dt id="section-2.4-2.1">GSA_REKEY:</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-2.2">The GSA_REKEY is a pseudo-exchange, consisting
          of a one-way IKEv2 message sent by the GCKS where the rekey policy is delivered
          to GMs using IP multicast as a transport. This method is
          valuable for large and dynamic groups and where policy may change
          frequently and a scalable rekey method is required. When the
          GSA_REKEY is used, the IKE SA protecting the member
          registration exchanges is usually terminated and GMs await
          policy changes from the GCKS via the GSA_REKEY messages.<a href="#section-2.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.3">GSA_INBAND_REKEY:</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-2.4">The GSA_INBAND_REKEY is a
          normal IKEv2 exchange using the IKE SA that was set up to protect the
          member registration exchange. This exchange allows the GCKS to
          rekey without using an independent GSA_REKEY pseudo-exchange. The
          GSA_INBAND_REKEY exchange provides a reliable policy delivery and 
          is useful when G-IKEv2 is used with a small group of cooperating devices.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.4-3">Depending on its policy, the GCKS <span class="bcp14">MAY</span> combine these two methods.
        For example, the GCKS may use the GSA_INBAND_REKEY to deliver a key to the 
        GMs in the group acting as senders (as this would provide reliable keys delivery) 
        and the GSA_REKEY for the rest of the GMs.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<div id="gsa_rekey">
<section id="section-2.4.1">
          <h4 id="name-gsa_rekey">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-gsa_rekey" class="section-name selfRef">GSA_REKEY</a>
          </h4>
<p id="section-2.4.1-1">The GCKS initiates the G-IKEv2 rekey by sending a protected
          message to the GMs, usually using IP multicast. Since the Rekey
          messages do not require responses and are sent to multiple GMs,
          the windowing mechanism described in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-2.3" class="relref">Section 2.3</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> <span class="bcp14">MUST NOT</span>
          be used for the Rekey messages.  The GCKS rekey message replaces the
          current rekey GSA KEK or KEK array (e.g., in the case of LKH) and/or
          creates new Data-Security SAs. The GM_SENDER_ID attribute in
          the Key Download payload (defined in <a href="#mkd_attr_gm_sid" class="auto internal xref">Section 4.5.3.3</a>) <span class="bcp14">MUST NOT</span> be part of the
          Rekey Exchange, as this is sender-specific information and the Rekey
          Exchange is group specific. The GCKS initiates the GSA_REKEY
          pseudo-exchange as following:<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<span id="name-gsa_rekey-pseudo-exchange"></span><div id="gsa_rekey_exchange">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-2.4.1-2.1">
<pre>
 GMs (Receivers)              GCKS (Sender)
-----------------            ---------------
                        &lt;--  HDR, SK{GSA, KD, [N,] [AUTH]}
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-gsa_rekey-pseudo-exchange" class="selfRef">GSA_REKEY Pseudo-Exchange</a>
            </figcaption></figure>
</div>
<p id="section-2.4.1-3">HDR is defined in <a href="#header" class="auto internal xref">Section 4.1</a>. While GSA_REKEY reuses the IKEv2 header,
          the "IKE SA Initiator's SPI" and the "IKE SA Responder's SPI" fields are treated as a single field
          with a length of 16 octets containing the SPI of a Rekey SA. The value for this field is provided by the GCKS 
          in the GSA payload (see <a href="#gsa_policy" class="auto internal xref">Section 4.4.2</a>).
          The Message ID in this message will start with the value the GCKS sent to the
          GMs in the attribute GSA_INITIAL_MESSAGE_ID or from
          zero if this attribute wasn't sent. The Message ID will be incremented each time a new
          GSA_REKEY message is sent to the GMs.<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1-4">The GSA payload contains the current policy for rekey and Data-Security SAs.

          The GSA may contain a new Rekey SA and/or a new Data-Security SA(s) 
          (<a href="#gsa_payload" class="auto internal xref">Section 4.4</a>).<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1-5">The KD payload contains the keys for the policy included in the
          GSA. If one or more Data-Security SAs are being refreshed in this rekey
          message, the IPsec keys are updated in the KD, and/or if the Rekey
          SA is being refreshed in this rekey message, the rekey Key or the
          LKH KEK array (e.g., in case of LKH) is updated in the KD payload.<a href="#section-2.4.1-5" class="pilcrow">¶</a></p>
<p id="section-2.4.1-6">A Delete payload <span class="bcp14">MAY</span> be included to instruct the GM to delete
          existing SAs. See <a href="#delete" class="auto internal xref">Section 4.6</a> for more detail.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">The AUTH payload <span class="bcp14">MUST</span> be included to authenticate the GSA_REKEY
          message if the authentication method is based on public key signatures
          and <span class="bcp14">MUST NOT</span> be included if authentication is implicit.
          In the latter case, the fact that a GM can decrypt the GSA_REKEY message and verify its Integrity Check Value (ICV) 
          proves that the sender of this message knows the current KEK,
          thus authenticating the sender as a member of the group. 
          Note that implicit authentication doesn't provide source origin authentication.
          For this reason, using implicit authentication for GSA_REKEY is <span class="bcp14">NOT RECOMMENDED</span> 
          unless source origin authentication is not required (for example, in a small group of
          highly trusted GMs). See more about authentication methods in <a href="#auth_method" class="auto internal xref">Section 4.4.2.1.1</a>.<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<p id="section-2.4.1-8"> During GM registration, the GCKS
          sends the authentication key in the KD payload, the AUTH_KEY attribute, 
          which the GM uses to authenticate the key
          server. Before the current authentication key expires, the GCKS will
          send a new AUTH_KEY to the GMs in a GSA_REKEY message.
          The authentication key that is sent in the rekey message may not
   be the same
          as the authentication key sent during the GM registration. If implicit authentication
          is used, then AUTH_KEY <span class="bcp14">MUST NOT</span> be sent to GMs.<a href="#section-2.4.1-8" class="pilcrow">¶</a></p>
<div id="gsa_rekey_auth">
<section id="section-2.4.1.1">
            <h5 id="name-gsa_rekey-message-authentic">
<a href="#section-2.4.1.1" class="section-number selfRef">2.4.1.1. </a><a href="#name-gsa_rekey-message-authentic" class="section-name selfRef">GSA_REKEY Message Authentication</a>
            </h5>
<p id="section-2.4.1.1-1">The content of the AUTH payload generally depends on the authentication method from the Group Controller Authentication Method (GCAUTH) transform 
            (<a href="#auth_method" class="auto internal xref">Section 4.4.2.1.1</a>). 
This specification defines the use of only one authentication method, Digital Signature, and the AUTH payload contains a digital signature calculated over the content of the not-yet-encrypted GSA_REKEY message.<a href="#section-2.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1.1-2">The digital signing is applied to the concatenation of two chunks: A and P. 
            Chunk A starts with the first octet of the G-IKEv2 header (not including prepended four octets of zeros, if port 4500 is used) 
            and continues to the last octet of the Encrypted Payload header. 
Chunk P consists of the not-yet-encrypted content of the Encrypted payload, excluding 
            the Initialization Vector, the Padding, the Pad Length, and the Integrity Checksum Data fields (see <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.14" class="relref">Section 3.14</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> for the description 
            of the Encrypted payload). In other words, chunk P is the inner payloads of the Encrypted payload in plaintext form. 
            <a href="#auth_data" class="auto internal xref">Figure 10</a> illustrates the layout of chunks P and A in the GSA_REKEY message.<a href="#section-2.4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1.1-3">Before the calculation of the AUTH payload, the inner payloads
            of the Encrypted payload must be fully formed and ready for
            encryption except for the content of the AUTH payload.  The AUTH
            payload must have correct values in the Payload header, the Auth
            Method, and the RESERVED fields.  The Authentication Data field is
            zeroed, but the ASN.1 Length and the AlgorithmIdentifier fields
            must be properly filled in; see Signature Authentication in
            <span>[<a href="#RFC7427" class="cite xref">RFC7427</a>]</span>.<a href="#section-2.4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1.1-4">For the purpose of the AUTH payload calculation, the Length field in the IKE header and the Payload Length 
            field in the Encrypted Payload header are adjusted so that they don't count the lengths
            of Initialization Vector, Integrity Checksum Data, and Padding (along with Pad Length field).
            In other words, the Length field in the IKE header (denoted as AdjustedLen in  
            <a href="#auth_data" class="auto internal xref">Figure 10</a>) is set to the sum of the lengths of A and P, and the Payload Length
            field in the Encrypted Payload header (denoted as AdjustedPldLen in 
            <a href="#auth_data" class="auto internal xref">Figure 10</a>) is set to the length of P plus the size of the Payload header (four octets).<a href="#section-2.4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1.1-5">The input to the digital signature algorithm that computes the content of the AUTH payload can be described as:<a href="#section-2.4.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4.1.1-6">
<pre>
DataToAuthenticate = A | P
GsaRekeyMessage = GenIKEHDR | EncPayload
GenIKEHDR = [ four octets 0 if using port 4500 ] | AdjustedIKEHDR
AdjustedIKEHDR =  SPIi | SPIr |  . . . | AdjustedLen
EncPayload = AdjustedEncPldHdr | IV | InnerPlds | Pad | PadLen | ICV
AdjustedEncPldHdr = NextPld | C | RESERVED | AdjustedPldLen
A = AdjustedIKEHDR | AdjustedEncPldHdr
P = InnerPlds
</pre><a href="#section-2.4.1.1-6" class="pilcrow">¶</a>
</div>
<span id="name-data-to-authenticate-in-the"></span><div id="auth_data">
<figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-2.4.1.1-7.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^ ^
|                       IKE SA Initiator's SPI                  | | |
|                                                               | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ I |
|                       IKE SA Responder's SPI                  | K |
|                                                               | E |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
|  Next Payload | MjVer | MnVer | Exchange Type |     Flags     | h A
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ d |
|                           Message ID                          | r |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | |
|                          AdjustedLen                          | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ x |
| Next Payload  |C|  RESERVED   |         AdjustedPldLen        | | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | v
|                                                               | |
~                     Initialization Vector                     ~ E
|                                                               | n
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ c ^
|                                                               | r |
~             Inner Payloads (not yet encrypted)                ~   P
|                                                               | P |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ l v
~              Padding (0-255 octets)           |  Pad Length   | d
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
|                                                               | |
~                    Integrity Checksum Data                    ~ |
|                                                               | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ v
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-data-to-authenticate-in-the" class="selfRef">Data to Authenticate in the GSA_REKEY Messages</a>
              </figcaption></figure>
</div>
<p id="section-2.4.1.1-8">The authentication data is calculated using the authentication algorithm from the Group Controller Authentication Method transform 
            (<a href="#auth_method" class="auto internal xref">Section 4.4.2.1.1</a>) and the current authentication key provided in the AUTH_KEY attribute (<a href="#mkd_attr_auth_key" class="auto internal xref">Section 4.5.3.2</a>). 
            The calculated authentication data is placed into the AUTH payload, the Length fields in the IKE header and the Encryption Payload
            header are restored, the content of the Encrypted payload is encrypted and the ICV is computed using the current KEK.<a href="#section-2.4.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2.4.1.2">
            <h5 id="name-ike-fragmentation">
<a href="#section-2.4.1.2" class="section-number selfRef">2.4.1.2. </a><a href="#name-ike-fragmentation" class="section-name selfRef">IKE Fragmentation</a>
            </h5>
<p id="section-2.4.1.2-1">IKEv2 fragmentation <span>[<a href="#RFC7383" class="cite xref">RFC7383</a>]</span> can be used to
            perform fragmentation of large GSA_REKEY messages; however, when
            the GSA_REKEY message is emitted as an IP multicast packet, there
            is a lack of response from the GMs. This has the following
            implications.<a href="#section-2.4.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4.1.2-2.1">
                <p id="section-2.4.1.2-2.1.1">Policy regarding the use of IKE fragmentation is implicit.
              If a GCKS detects that all GMs have negotiated support of IKE
              fragmentation in IKE_SA_INIT, then it <span class="bcp14">MAY</span> use IKE
              fragmentation on large GSA_REKEY messages.<a href="#section-2.4.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.4.1.2-2.2">
                <p id="section-2.4.1.2-2.2.1">The GCKS must always use IKE fragmentation based on a
                preconfigured fragmentation threshold, as there is no way to
                check if fragmentation is needed by first sending unfragmented
                messages and waiting for response. <span><a href="https://rfc-editor.org/rfc/rfc7383#section-2.5.1" class="relref">Section 2.5.1</a> of [<a href="#RFC7383" class="cite xref">RFC7383</a>]</span> contains recommendations on selecting the
                fragmentation threshold.<a href="#section-2.4.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.4.1.2-2.3">
                <p id="section-2.4.1.2-2.3.1">The Path MTU (PMTU) mechanism, defined in <span><a href="https://rfc-editor.org/rfc/rfc7383#section-2.5.2" class="relref">Section 2.5.2</a> of [<a href="#RFC7383" class="cite xref">RFC7383</a>]</span>,
                cannot be used due to lack of GSA_REKEY response messages.<a href="#section-2.4.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.4.1.2-3"> The calculation of authentication data <span class="bcp14">MUST</span> be applied to whole messages only before possible IKE Fragmentation. 
            If the message was received in fragmented form, it should be reconstructed before verifying its authenticity as if it were received unfragmented.
The RESERVED field in the reconstructed Encrypted Payload header <span class="bcp14">MUST</span> be set to the value of the RESERVED 
            field in the Encrypted Fragment payload header from the first fragment (with the Fragment Number equal to 1).<a href="#section-2.4.1.2-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4.1.3">
            <h5 id="name-gsa_rekey-gcks-operations">
<a href="#section-2.4.1.3" class="section-number selfRef">2.4.1.3. </a><a href="#name-gsa_rekey-gcks-operations" class="section-name selfRef">GSA_REKEY GCKS Operations</a>
            </h5>
<p id="section-2.4.1.3-1">The GCKS builds the rekey message with a Message ID value that
            is one greater than the value included in the previous rekey message. 
            The first message sent over a new Rekey SA <span class="bcp14">MUST</span> use a Message ID of 0. 
            The GSA, KD, and N payloads follow with the
            same characteristics as in the GSA Registration exchange. 
            The AUTH payload (if present) is created as defined in <a href="#gsa_rekey_auth" class="auto internal xref">Section 2.4.1.1</a>.<a href="#section-2.4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1.3-2">Because GSA_REKEY messages are not acknowledged and could be
            discarded by the network, one or more GMs may not receive 
            the new policy. To mitigate such lost messages, during a rekey event, the
            GCKS may transmit several copies of an encrypted GSA_REKEY message with the new
            policy. The (encrypted) retransmitted messages <span class="bcp14">MUST</span> be bitwise identical and should be
            sent within a short time interval (a few seconds) to ensure 
            that the SA lifetime calculations would not be substantially skewed for the GMs that 
            would receive different copies of the messages.<a href="#section-2.4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1.3-3"> GCKS may also include one or several GSA_NEXT_SPI
            attributes specifying SPIs for the prospected rekeys so that
            listening GMs are able to detect lost rekey messages and recover
            from this situation. See <a href="#gsa_attr_next_spi" class="auto internal xref">Section 4.4.2.2.3</a> for more detail.<a href="#section-2.4.1.3-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4.1.4">
            <h5 id="name-gsa_rekey-gm-operations">
<a href="#section-2.4.1.4" class="section-number selfRef">2.4.1.4. </a><a href="#name-gsa_rekey-gm-operations" class="section-name selfRef">GSA_REKEY GM Operations</a>
            </h5>
<p id="section-2.4.1.4-1">  When a GM receives the rekey message from the GCKS, it
            decrypts the message and verifies its integrity using the current KEK. If the AUTH payload is present
            in the decrypted message, then the GM validates authenticity of the message using the key retrieved 
            in a previous G-IKEv2 exchange. Then the GM verifies the Message ID and processes
            the GSA and KD payloads. The GM then installs the new Data-Security SA(s)
            and/or a new Rekey SA. The parsing of the payloads is identical to
            the parsing done in the registration exchange.<a href="#section-2.4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1.4-2">Replay protection is achieved by a GM rejecting a
            GSA_REKEY message that has a Message ID smaller than the current
            Message ID that the GM is expecting. The GM expects the Message ID
            in the first GSA_REKEY message it receives to be equal to or greater
            than the Message ID it receives in the GSA_INITIAL_MESSAGE_ID attribute.
            Note that if the GSA_INITIAL_MESSAGE_ID attribute is not received for the Rekey SA, 
            the GM <span class="bcp14">MUST</span> assume zero as the first expected Message ID.
            The GM expects the Message ID in subsequent GSA_REKEY messages to
            be greater than the last valid GSA_REKEY message ID it
            received.<a href="#section-2.4.1.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1.4-3"> This specification assumes that the GSA_REKEY messages are sent 
            with intervals that are significantly greater than typical network packet reordering intervals.<a href="#section-2.4.1.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1.4-4">If the GSA payload includes a Data-Security SA using cipher in 
            a counter-mode of operation and the receiving GM is a
            sender for that SA, the GM uses its current Sender-ID value
            with the Data-Security SAs to create counter-mode nonces. If it is
            a sender and does not hold a current Sender-ID value (for example,
            when no counter-mode is employed for other Data-Security SAs), 
            it <span class="bcp14">MUST NOT</span> install the Data-Security SAs. It <span class="bcp14">MUST</span> initiate a re-registration
            to the GCKS in order to obtain a Sender-ID value (along with
            the current group policy).<a href="#section-2.4.1.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1.4-5">Once a new Rekey SA is installed as a result of a GSA_REKEY
            message, the current Rekey SA (over which the message was received)
            <span class="bcp14">MUST</span> be silently deleted after waiting the DEACTIVATION_TIME_DELAY interval 
            regardless of its expiration time. If the message includes a Delete payload
            for an existing Data-Security SA, then after installing a new Data-Security SA, the old one 
            (identified by the Protocol and SPI fields in the Delete payload) <span class="bcp14">MUST</span> be silently deleted 
            after waiting the DEACTIVATION_TIME_DELAY interval regardless of its expiration time.<a href="#section-2.4.1.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4.1.4-6">If a Data-Security SA is not rekeyed yet and is 
            about to expire (a "soft lifetime" expiration is described
            in <span><a href="https://rfc-editor.org/rfc/rfc4301#section-4.4.2.1" class="relref">Section 4.4.2.1</a> of [<a href="#RFC4301" class="cite xref">RFC4301</a>]</span>), the GM <span class="bcp14">SHOULD</span>
            initiate a registration to the GCKS. This registration serves as a
            request for current SAs and will result in the download of
            replacement SAs, assuming the GCKS policy has created them.
            A GM <span class="bcp14">SHOULD</span> also initiate a registration request if a Rekey SA
            is about to expire and not yet replaced with a new one.<a href="#section-2.4.1.4-6" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="gsa_inband_rekey">
<section id="section-2.4.2">
          <h4 id="name-gsa_inband_rekey-exchange">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-gsa_inband_rekey-exchange" class="section-name selfRef">GSA_INBAND_REKEY Exchange</a>
          </h4>
<p id="section-2.4.2-1">When the IKE SA protecting the member registration exchange is
          maintained while a GM participates in the group, the GCKS
          can use the GSA_INBAND_REKEY exchange to individually provide policy
          updates to the GM.<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<span id="name-gsa_inband_rekey-exchange-2"></span><div id="gsa_inband_rekey_exchange">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-2.4.2-2.1">
<pre>
 GM (Responder)               GCKS (Initiator)
----------------             ------------------
                      &lt;--    HDR, SK{GSA, KD, [N]}
 HDR, SK{}            --&gt;
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-gsa_inband_rekey-exchange-2" class="selfRef">GSA_INBAND_REKEY Exchange</a>
            </figcaption></figure>
</div>
<p id="section-2.4.2-3">Because this is a normal IKEv2 exchange, the HDR is treated as defined
          in IKEv2 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-2.4.2-3" class="pilcrow">¶</a></p>
<section id="section-2.4.2.1">
            <h5 id="name-gsa_inband_rekey-gcks-opera">
<a href="#section-2.4.2.1" class="section-number selfRef">2.4.2.1. </a><a href="#name-gsa_inband_rekey-gcks-opera" class="section-name selfRef">GSA_INBAND_REKEY GCKS Operations</a>
            </h5>
<p id="section-2.4.2.1-1">The GSA, KD, and N payloads are built in the same manner as in
            a registration exchange.<a href="#section-2.4.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4.2.2">
            <h5 id="name-gsa_inband_rekey-gm-operati">
<a href="#section-2.4.2.2" class="section-number selfRef">2.4.2.2. </a><a href="#name-gsa_inband_rekey-gm-operati" class="section-name selfRef">GSA_INBAND_REKEY GM Operations</a>
            </h5>
<p id="section-2.4.2.2-1">The GM processes the GSA, KD, and N payloads in the same manner
            as if they were received in a registration exchange.<a href="#section-2.4.2.2-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="deletion">
<section id="section-2.4.3">
          <h4 id="name-deletion-of-sas">
<a href="#section-2.4.3" class="section-number selfRef">2.4.3. </a><a href="#name-deletion-of-sas" class="section-name selfRef">Deletion of SAs</a>
          </h4>
<p id="section-2.4.3-1">There are occasions when the GCKS may want to signal to GMs to delete policy when the application sending data traffic has ended or if group
          policy has changed. Deletion of SAs is accomplished by sending
          the Delete Payload described in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.11" class="relref">Section 3.11</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> 
          as part of the GSA_REKEY pseudo-exchange as shown below.<a href="#section-2.4.3-1" class="pilcrow">¶</a></p>
<span id="name-sa-deletion-in-gsa_rekey"></span><div id="gsa_rekey_sa_deletion">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-2.4.3-2.1">
<pre>
GMs (Receivers)            GCKS (Sender)
----------------          ---------------
                    &lt;--   HDR, SK{D, [N,] [AUTH]}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-sa-deletion-in-gsa_rekey" class="selfRef">SA Deletion in GSA_REKEY</a>
            </figcaption></figure>
</div>
<p id="section-2.4.3-3">If GCKS has a unicast SA with a GM, then it can use the GSA_INBAND_REKEY
          exchange to delete SAs.<a href="#section-2.4.3-3" class="pilcrow">¶</a></p>
<span id="name-sa-deletion-in-gsa_inband_r"></span><div id="gsa_inband_rekey_sa_deletion">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-2.4.3-4.1">
<pre>
GM (Responder)                GCKS (Initiator)
---------------              ------------------
                      &lt;--    HDR, SK{D, [N]}
 HDR, SK{}            --&gt;
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-sa-deletion-in-gsa_inband_r" class="selfRef">SA Deletion in GSA_INBAND_REKEY</a>
            </figcaption></figure>
</div>
<p id="section-2.4.3-5">There may be circumstances where the GCKS may want to start over 
          with a clean state, e.g., in case it runs out of available Sender-IDs. 
          The GCKS can signal deletion of all the Data-Security SAs by
          sending a Delete payload with an SPI value equal to zero.
          For example, if the GCKS wishes to remove the Rekey SA and all the
          Data-Security SAs, the GCKS sends a Delete payload with an SPI
          of zero and a Protocol ID of AH or ESP, followed by another Delete payload
          with an SPI of zero and a Protocol ID of GIKE_UPDATE.<a href="#section-2.4.3-5" class="pilcrow">¶</a></p>
<p id="section-2.4.3-6"> If a GM receives a Delete payload with zero SPI and a Protocol ID
          of GIKE_UPDATE, it means that the GM is excluded from the group. 
          Such Delete payload may be received either in the GSA_REKEY pseudo-exchange or in the GSA_INBAND_REKEY exchange.
          In this situation, the GM <span class="bcp14">MUST</span> re-register if it wants to continue 
          participating in this group. The registration is performed as described
          in <a href="#registration" class="auto internal xref">Section 2.3</a>. It is <span class="bcp14">RECOMMENDED</span> that a GM waits some randomly chosen time
          before initiating a registration request in this situation to avoid overloading the GCKS.
          This document doesn't specify the maximum delay, which is implementation-dependent,
          but it is believed that the order of seconds suits most situations.
          Note that if the unicast SA between the GM and the GCKS exists, then the GM may use the GSA_REGISTRATION exchange 
          to re-register. However, after excluding a GM from the group, the GCKS <span class="bcp14">MAY</span> 
          immediately delete the unicast SA with this GM (if any) if the credentials of this GM are revoked.<a href="#section-2.4.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="counter-modes">
<section id="section-2.5">
        <h3 id="name-counter-based-modes-of-oper">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-counter-based-modes-of-oper" class="section-name selfRef">Counter-Based Modes of Operation</a>
        </h3>
<p id="section-2.5-1">Several counter-based modes of operation have been specified
        for ESP (e.g., AES-CTR <span>[<a href="#RFC3686" class="cite xref">RFC3686</a>]</span>, AES-GCM <span>[<a href="#RFC4106" class="cite xref">RFC4106</a>]</span>, AES-CCM <span>[<a href="#RFC4309" class="cite xref">RFC4309</a>]</span>,
        ChaCha20-Poly1305 <span>[<a href="#RFC7634" class="cite xref">RFC7634</a>]</span>, and
        AES-GMAC <span>[<a href="#RFC4543" class="cite xref">RFC4543</a>]</span>) and AH (e.g., AES-GMAC <span>[<a href="#RFC4543" class="cite xref">RFC4543</a>]</span>). These counter-based modes require that no
        two senders in the group ever send a packet with the same
        IV using the same cipher key and mode. This
        requirement is met in G-IKEv2 when the following measures are
        taken:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.1">
            <p id="section-2.5-2.1.1">The GCKS distributes a unique key for each Data-Security SA.<a href="#section-2.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.5-2.2">
            <p id="section-2.5-2.2.1">The GCKS uses the method described in <span>[<a href="#RFC6054" class="cite xref">RFC6054</a>]</span>, 
        which assigns each sender a portion of the IV space by provisioning each 
        sender with one or more unique Sender-ID values.<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="sid_alloc">
<section id="section-2.5.1">
          <h4 id="name-allocation-of-sender-id">
<a href="#section-2.5.1" class="section-number selfRef">2.5.1. </a><a href="#name-allocation-of-sender-id" class="section-name selfRef">Allocation of Sender-ID</a>
          </h4>
<p id="section-2.5.1-1">When at least one Data-Security SA included in the group policy
          includes a counter-based mode of operation, the GCKS automatically
          allocates and distributes one Sender-ID to each GM acting in the
          role of sender on the Data-Security SA. The Sender-ID value is used
          exclusively by the group sender to which it was allocated. The group
          sender uses the same Sender-ID for each Data-Security SA specifying the
          use of a counter-based mode of operation. A GCKS <span class="bcp14">MUST</span> distribute
          unique keys for each Data-Security SA, including a counter-based mode
          of operation in order to maintain unique key and nonce usage.<a href="#section-2.5.1-1" class="pilcrow">¶</a></p>
<p id="section-2.5.1-2">During registration, the group sender can choose to request one
          or more Sender-ID values. Requesting a value of 1 is not necessary since
          the GCKS will automatically allocate exactly one to the group
          sender. A group sender <span class="bcp14">MUST</span> request as many Sender-ID values matching the number
          of encryption modules in which it will be installing the TEKs in the
          outbound direction. Alternatively, a group sender <span class="bcp14">MAY</span> request more
          than one Sender-ID and use them serially. This could be useful when it is
          anticipated that the group sender will exhaust their range of Data-Security SA nonces using a single Sender-ID too quickly (e.g., before the
          time-based policy in the TEK expires).<a href="#section-2.5.1-2" class="pilcrow">¶</a></p>
<p id="section-2.5.1-3">When the group policy includes a counter-based mode of operation,
          a GCKS should use the following method to allocate Sender-ID values, which
          ensures that each Sender-ID will be allocated to just one group
          sender.<a href="#section-2.5.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5.1-4">
<li id="section-2.5.1-4.1">
              <p id="section-2.5.1-4.1.1">A GCKS maintains a Sender-ID counter, which records the Sender-IDs that
          have been allocated. Sender-IDs are allocated sequentially with zero as
          the first allocated value.<a href="#section-2.5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.5.1-4.2">
              <p id="section-2.5.1-4.2.1">Each time a Sender-ID is allocated, the current value of the
          counter is saved and allocated to the group sender. The Sender-ID counter
          is then incremented in preparation for the next allocation.<a href="#section-2.5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.5.1-4.3">
              <p id="section-2.5.1-4.3.1">When the GCKS specifies a counter-based mode of operation in
          the Data-Security SA, a group sender may request a count of Sender-IDs 
          during registration in a Notify payload information of type SENDER.
          When the GCKS receives this request, it increments the Sender-ID counter
          once for each requested Sender-ID and distributes each Sender-ID value to the
          group sender. The GCKS should have a policy-defined upper bound for
          the number of Sender-ID values that it will return irrespective of the number
          requested by the GM.<a href="#section-2.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.5.1-4.4">
              <p id="section-2.5.1-4.4.1">A GCKS allocates new Sender-ID values for each registration operation 
          by a group sender, regardless of whether the group
          sender had previously contacted the GCKS. In this way, the GCKS is
          not required to maintain a record of which Sender-ID values it had
          previously allocated to each group sender. More importantly, since
          the GCKS cannot reliably detect whether the group sender had sent
          data on the current group Data-Security SAs, it does not know what
          Data-Security counter-mode nonce values that a group sender has
          used. By distributing new Sender-ID values, the key server ensures that
          each time a conforming group sender installs a Data-Security SA, it
          will use a unique set of counter-based mode nonces.<a href="#section-2.5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.5.1-4.5">
              <p id="section-2.5.1-4.5.1">When the Sender-ID counter maintained by the GCKS reaches its final
          Sender-ID value, no more Sender-ID values can be distributed. Before
          distributing any new Sender-ID values, the GCKS <span class="bcp14">MUST</span> 
          exclude all GMs from the group as described
          in <a href="#deletion" class="auto internal xref">Section 2.4.3</a>. This will result in the GMs 
          performing re-registration, during which they will receive new Data-Security SAs 
          and group senders will additionally receive new Sender-ID values.
          The new Sender-ID values can safely be used because they are only used with
          the new Data-Security SAs.<a href="#section-2.5.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="sid-usage">
<section id="section-2.5.2">
          <h4 id="name-gm-usage-of-sender-id">
<a href="#section-2.5.2" class="section-number selfRef">2.5.2. </a><a href="#name-gm-usage-of-sender-id" class="section-name selfRef">GM Usage of Sender-ID</a>
          </h4>
<p id="section-2.5.2-1">A GM applies the Sender-ID to Data-Security SAs as follows:<a href="#section-2.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5.2-2.1">
              <p id="section-2.5.2-2.1.1">The most significant bits of the IV indicated in the GWP_SENDER_ID_BITS attribute (<a href="#gwp_attr_sid_bits" class="auto internal xref">Section 4.4.3.1.2</a>) are
          taken to be the Sender-ID field of the IV.<a href="#section-2.5.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.5.2-2.2">
              <p id="section-2.5.2-2.2.1">The Sender-ID is placed in the least significant bits of the Sender-ID
          field, where any unused most significant bits are set to zero.
          If the Sender-ID value doesn't fit into the number of bits from the GWP_SENDER_ID_BITS attributes,
          then the GM <span class="bcp14">MUST</span> treat this as a fatal error and re-register to the group.<a href="#section-2.5.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="seqnum">
<section id="section-2.6">
        <h3 id="name-replay-protection-for-multi">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-replay-protection-for-multi" class="section-name selfRef">Replay Protection for Multicast Data-Security SAs</a>
        </h3>
<p id="section-2.6-1">IPsec provides anti-replay service as part of its security
        services.  With multicast extensions for IPsec, replay protection is not
        always possible to achieve (see <span><a href="https://rfc-editor.org/rfc/rfc3740#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC3740" class="cite xref">RFC3740</a>]</span>). In particular, if there
        are many group senders for a Data-Security SA, then each of them will
        independently increment the Sequence Number field in the ESP header
        (see <span><a href="https://rfc-editor.org/rfc/rfc4303#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC4303" class="cite xref">RFC4303</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc4302#section-2.5" class="relref">Section 2.5</a> of [<a href="#RFC4302" class="cite xref">RFC4302</a>]</span>), thus making it impossible
        for the group receivers to filter out replayed packets. However, if
        there is only one group sender for a Data-Security SA, then it is
        possible to achieve replay protection with some restrictions (see
        <a href="#antireplay" class="auto internal xref">Section 4.4.2.1.3</a>). The GCKS <span class="bcp14">MAY</span> create
        several Data-Security SAs with the same traffic selectors allowing
        only a single group sender in each SA if it is desirable to get replay
        protection with multiple (but still a limited number) of group senders.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">IPsec architecture assumes that whether 
        anti-replay service is enabled or not is a local matter for an IPsec receiver. In other words, an IPsec sender always increments
        the Sequence Number field in the ESP/AH header and a receiver decides whether to check
        for replayed packets or not. Since it is known in some cases that the replay protection
        is not possible (like in an SA with many group senders), a new Transform ID 
        "32-bit Unspecified Numbers" is defined for the Sequence Numbers (SNs) Transform Type.
        Using this Transform ID, the GCKS can inform GMs that the uniqueness of sequence
        numbers for a given SA is not guaranteed. The decision of whether to enable anti-replay service 
        is still a local matter of a GM (in accordance with IPsec architecture).<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.6-3">The GCKS <span class="bcp14">MUST</span> include the Sequence Numbers transform in the GSA payload for every Data-Security SA.
        See <a href="#antireplay" class="auto internal xref">Section 4.4.2.1.3</a> for more details.<a href="#section-2.6-3" class="pilcrow">¶</a></p>
<p id="section-2.6-4">When a Data-Security SA has a single sender, the GCKS <span class="bcp14">MUST</span> 
        be configured to rekey the SA frequently enough so that the 32-bit sequence numbers do not wrap.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implicit-iv">
<section id="section-2.7">
        <h3 id="name-encryption-transforms-with-">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-encryption-transforms-with-" class="section-name selfRef">Encryption Transforms with Implicit IV</a>
        </h3>
<p id="section-2.7-1">The "Transform Type 1 - Encryption Algorithm Transform IDs" IANA registry <span>[<a href="#IKEV2-IANA" class="cite xref">IKEV2-IANA</a>]</span> defines several transforms
        with implicit IV. These transforms rely on ESP Sequence Numbers for constructing IV 
        (see <span>[<a href="#RFC8750" class="cite xref">RFC8750</a>]</span> for details).
        It requires anti-replay service to be enabled for an ESP SA using these encryption transforms.
        Unless the properties of sequence numbers for a multicast ESP SA include their uniqueness (see <a href="#seqnum" class="auto internal xref">Section 2.6</a>), 
        encryption transforms that rely on Sequence Numbers for IV construction <span class="bcp14">MUST NOT</span> be used.
        In any case, such transforms <span class="bcp14">MUST NOT</span> be used for any G-IKEv2 SA (both unicast and multicast).<a href="#section-2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="key_management">
<section id="section-3">
      <h2 id="name-group-key-management-and-ac">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-group-key-management-and-ac" class="section-name selfRef">Group Key Management and Access Control</a>
      </h2>
<p id="section-3-1">Through the G-IKEv2 rekey, G-IKEv2 supports algorithms such as
      Logical Key Hierarchy (LKH) that have the property of denying access to
      a new group key by a member removed from the group (forward access
      control) and to an old group key by a member added to the group
      (backward access control). This is unrelated to the Perfect Forward
      Secrecy (PFS) property as defined in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-2.12" class="relref">Section 2.12</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Group management algorithms providing forward and backward access
   control other than LKH have also been proposed,
   for example, OFT <span>[<a href="#OFT" class="cite xref">OFT</a>]</span> and Subset Difference <span>[<a href="#NNL" class="cite xref">NNL</a>]</span>. These algorithms could be
      used with G-IKEv2 but are not specified as a part of this
      document.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">This specification assumes that all group keys, that are 
      sent to the GMs by the GCKS, are encrypted with some other keys,
      called Key Wrap Keys (KWKs). The Key Wrap Algorithm transform
      defines the algorithm used for key wrapping in the context of an SA.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="kwk">
<section id="section-3.1">
        <h3 id="name-key-wrap-keys">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-key-wrap-keys" class="section-name selfRef">Key Wrap Keys</a>
        </h3>
<p id="section-3.1-1">Every GM always knows at least one KWK -- the KWK that is associated with the IKE SA
        or multicast Rekey SA over which wrapped keys are sent.
        In this document, it is called default KWK and is denoted as "GSK_w".<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">For the purpose of forward access control, the GCKS may provide each GM 
        with its personal KWK at the time of registration. Additionally, several intermediate KWKs that form a key 
        hierarchy and are shared among several GMs may be provided by the GCKS.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Each KWK is associated with a key wrap algorithm specified in the Key Wrap Algorithm transform.
        The size of these KWKs is determined by the key wrap algorithm used,
        but it <span class="bcp14">SHOULD NOT</span> be less than the size of the key for the Encryption Algorithm transform
        for the Rekey SA and for all Data-Security SAs in the group (taking the Key Length attribute into consideration if it is present).<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="sk_w">
<section id="section-3.1.1">
          <h4 id="name-default-key-wrap-key">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-default-key-wrap-key" class="section-name selfRef">Default Key Wrap Key</a>
          </h4>
<p id="section-3.1.1-1">The default KWK (GSK_w) is only used in the context of a single IKE SA.
          Every IKE SA (unicast IKE SA or multicast Rekey SA) will have its own GSK_w.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">For the unicast IKE SA (used for the GM registration and for GSA_INBAND_REKEY exchanges if they appear), the GSK_w is computed as follows:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-3">
<pre>
GSK_w = prf+(SK_d, "Key Wrap for G-IKEv2")
</pre><a href="#section-3.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-4">
          where the string "Key Wrap for G-IKEv2" is 20 ASCII characters
          without null termination.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">For the multicast Rekey SA, the GSK_w is provided along with
          other SA keys as defined in <a href="#group_sa_keys" class="auto internal xref">Section 3.4</a>.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key_gcks_semantics">
<section id="section-3.2">
        <h3 id="name-gcks-key-management-semanti">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-gcks-key-management-semanti" class="section-name selfRef">GCKS Key Management Semantics</a>
        </h3>
<p id="section-3.2-1">The Wrapped Key Download method allows the GCKS to employ various key management methods.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1">A simple key management method:</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">The GCKS always sends
          group SA keys encrypted with the GSK_w.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-2.3">An LKH key management method:</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.4">The GCKS provides each
          GM with an individual key at the time of the GM registration
          (encrypted with GSK_w). Then, the GCKS forms a hierarchy of keys so
          that the group SA keys are encrypted with other keys that are
          encrypted with other keys and so on, tracing back to the keys for
          each GM.<a href="#section-3.2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-3">
        Other key policies may also be employed by the GCKS.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<section id="section-3.2.1">
          <h4 id="name-forward-access-control-requ">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-forward-access-control-requ" class="section-name selfRef">Forward Access Control Requirements</a>
          </h4>
<p id="section-3.2.1-1">When a group membership is altered using a group management
          algorithm, new Data-Security SAs and their associated keys are usually
          also needed. New Data-Security SAs and keys ensure that members who were
          denied access can no longer participate in the group.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">If forward access control is a desired property of the group,
          a new TEK policy and the associated keys <span class="bcp14">MUST NOT</span> be included 
          in a G-IKEv2 rekey message, which changes group membership. 
          This is required because the GSA TEK policy
          and the associated keys are not protected with the new KEK. 
          A second G-IKEv2 rekey message can
          deliver the new GSA TEK policies and their associated keys 
          because it will be protected with the new KEK and thus will not
          be visible to the members who were denied access.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">If forward access control policy for the group includes
          keeping group policy changes from members that are denied access
          to the group, then two sequential G-IKEv2 rekey messages
          changing the group KEK <span class="bcp14">MUST</span> be sent by the GCKS. The first
          G-IKEv2 rekey message creates a new KEK for the group. GMs, which are denied access, will not be able to access the
          new KEK, but they will see the group policy since the G-IKEv2 rekey
          message is protected under the current KEK. A subsequent G-IKEv2
          rekey message containing the changed group policy and again
          changing the KEK allows complete forward access control. A
          G-IKEv2 rekey message <span class="bcp14">MUST NOT</span> change the policy without
          creating a new KEK.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">If other methods of using LKH or other group management
          algorithms are added to G-IKEv2, those methods <span class="bcp14">MAY</span> remove the
          above restrictions requiring multiple G-IKEv2 rekey messages,
          providing those methods specify how the forward access control
          policy is maintained within a single G-IKEv2 rekey message.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="keys_gm_semantics">
<section id="section-3.3">
        <h3 id="name-gm-key-management-semantics">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-gm-key-management-semantics" class="section-name selfRef">GM Key Management Semantics</a>
        </h3>
<p id="section-3.3-1">This specification defines GM Key Management semantics
        in such a way that it doesn't depend on the key management
        method employed by the GCKS. This allows having all the complexity
        of key management in the GCKS, which is free to implement various
        key management methods such as direct transmitting of group SA
        keys or using some kind of key hierarchy (e.g., LKH). 
        The GM behavior is the same for all of these policies.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">All keys in G-IKEv2 are transmitted in encrypted form as specified 
        in <a href="#wrapped_key" class="auto internal xref">Section 4.5.4</a>. This format includes a 32-bit Key ID
        (ID of a key that is encrypted) and a 32-bit KWK ID
        (ID of a key that was used to encrypt this key). Keys may be 
        encrypted either with a default KWK (GSK_w) or with other keys,
        which the GM has received in the WRAP_KEY attributes.
        If a key was encrypted with GSK_w, then the KWK ID field is set to zero.
        Otherwise, the KWK ID field identifies the key used for encryption.
        A zero Key ID always identifies the key from which the keys for protecting Data-Security SAs and Rekey SA are taken.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">When a GM receives a message from the GCKS installing the new Data-Security or Rekey SA,
        it will contain a KD payload with an SA_KEY attribute containing keying material for this SA.
        For a Data-Security SA, exactly one SA_KEY attribute will be present
        with both Key ID and KWK ID fields set to zero. This means that the 
        default KWK (GSK_w) should be used to extract this keying material.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For a multicast Rekey SA, multiple SA_KEY attributes may be present 
        depending on the key management method employed by the GCKS. If multiple SA_KEY attributes 
        are present, then all of them <span class="bcp14">MUST</span> contain the same keying material encrypted using different KWKs.
        The GM in general is unaware of the key management method used by the GCKS and can always use the same procedure to get 
        the keys. The GM tries to decrypt at least one of the SA_KEY attributes
        using either the GSK_w or the keys from the WRAP_KEY attributes that are present in the same message  
        or were received in previous messages.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">We will use the term "Key Path" to describe an ordered sequence of keys 
        where each subsequent key was used to encrypt the previous one.
        The GM keeps its own Key Path (called Working Key Path) in the memory associated
        with each group it is registered to and updates it when needed.
        When the GSA_REKEY message is received, the GM processes the received SA_KEY attributes 
        one by one and tries to construct a new key path that starts from one of these attributes and 
        ends with any key in the Working Key Path or with the default KWK (GSK_w).<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">In the simplest case, the SA_KEY attribute is encrypted
        with GSK_w so that the new Key Path is empty. 
        If more complex key management methods are used, then a Key Path will
        contain intermediate keys from the WRAP_KEY attributes
        received by a GM so far, starting from its registration to the group. If the GM is able 
        to construct a new Key Path using intermediate keys it has, then it is able to decrypt the SA_KEY attribute 
        and use its content to form new SA keys. If it is unable to build a new Key Path, then it means that the GM is excluded
        from the group.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">Depending on the new Key Path, the GM should do the following actions to be prepared for future key updates:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-8.1">
            <p id="section-3.3-8.1.1">If the new Key Path is empty, then no actions are needed. This may happen 
          if no WRAP_KEY attributes from the received message were used.<a href="#section-3.3-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-8.2">
            <p id="section-3.3-8.2.1">If the new Key Path is non-empty and it ends with the default KWK (GSK_w), then the whole new 
          Key Path is stored by the GM as the GM's Working Key Path.

This situation may only happen at the time the GM is registering to the group,
          when the GCKS is providing the GM with its personal key and the other keys from the key tree that are needed.
          These keys form an initial Working Key Path for this GM.<a href="#section-3.3-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-8.3">
            <p id="section-3.3-8.3.1">In all other cases, the new Key Path will end at some intermediate key from the GM's current Working Key Path. 
          In this case, the new Key Path is constructed by replacing a part of the GM's current Working Key Path from the beginning and up to (but not including) 
          the key that the GM has used to decrypt the last key in the new Key Path.<a href="#section-3.3-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-9">
        <a href="#lkh_key_management" class="auto internal xref">Appendix A</a> contains an example of how this algorithm works in case of LKH key management method.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group_sa_keys">
<section id="section-3.4">
        <h3 id="name-sa-keys">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-sa-keys" class="section-name selfRef">SA Keys</a>
        </h3>
<p id="section-3.4-1">The keys that are used for Data-Security SAs or a Rekey SA (called
        SA keys here) are downloaded to GMs in the form of keying material from which,
        according to policy, a set of keys are deterministically extracted.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">For a Data-Security SA, the keys are taken in accordance to the
        third bullet from <span><a href="https://rfc-editor.org/rfc/rfc7296#section-2.17" class="relref">Section 2.17</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>. In particular, for the ESP and AH SAs, the encryption
        key (if any) <span class="bcp14">MUST</span> be taken from the leftmost bits of
        the keying material and the integrity key (if any) <span class="bcp14">MUST</span>
        be taken from the remaining bits.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">For a Rekey SA, the following keys are taken from the keying material:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-4">
<pre>
GSK_e | GSK_a | GSK_w = KEYMAT
</pre><a href="#section-3.4-4" class="pilcrow">¶</a>
</div>
<p id="section-3.4-5">
where GSK_e and GSK_a are the keys used for the Encryption Algorithm and
  the Integrity Algorithm transforms, respectively, for the corresponding
  SA and GSK_w is a default KWK for this SA. Note that GSK_w is used with 
        the key wrap algorithm specified in the Key Wrap Algorithm transform. If an AEAD algorithm is used for encryption, 
        then the GSK_a key will not be used (GM can use the formula above assuming the length of GSK_a is zero).<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="header_payload">
<section id="section-4">
      <h2 id="name-header-and-payload-formats">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-header-and-payload-formats" class="section-name selfRef">Header and Payload Formats</a>
      </h2>
<p id="section-4-1">The G-IKEv2 is an IKEv2 extension and thus inherits its wire format 
      for data structures. However, the processing of some payloads are
      different. Several new payloads are defined:
      Group Identification (IDg) (<a href="#idg_payload" class="auto internal xref">Section 4.2</a>), Security Association - GM Supported Transforms (SAg) (<a href="#sag_payload" class="auto internal xref">Section 4.3</a>),
      Group Security Association (GSA) (<a href="#gsa_payload" class="auto internal xref">Section 4.4</a>), and Key Download (KD) (<a href="#kd_payload" class="auto internal xref">Section 4.5</a>). 
      The G-IKEv2 header (<a href="#header" class="auto internal xref">Section 4.1</a>), IDg payload, and SAg payload reuse the IKEv2 format for the IKEv2 header, IDi/IDr payloads, and SA payload, respectively. New exchange types GSA_AUTH, GSA_REGISTRATION, GSA_REKEY, and GSA_INBAND_REKEY are
      also added.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This section describes new payloads and the differences in the processing 
      of existing IKEv2 payloads.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="header">
<section id="section-4.1">
        <h3 id="name-g-ikev2-header">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-g-ikev2-header" class="section-name selfRef">G-IKEv2 Header</a>
        </h3>
<p id="section-4.1-1">G-IKEv2 uses the same IKE header format as specified in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>. The Major Version is
        2 and the Minor Version is 0, as in IKEv2. IKE SA Initiator's SPI, IKE SA
        Responder's SPI, Flags, Message ID, and Length are as specified in
        <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="idg_payload">
<section id="section-4.2">
        <h3 id="name-group-identification-payloa">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-group-identification-payloa" class="section-name selfRef">Group Identification Payload</a>
        </h3>
<p id="section-4.2-1">The Group Identification (IDg) payload allows the GM to indicate which group it
        wants to join. The payload is constructed by using the IKEv2
        Identification Payload (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.5" class="relref">Section 3.5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>). 
        ID type ID_KEY_ID <span class="bcp14">MUST</span> be supported. ID types ID_IPV4_ADDR, ID_FQDN, ID_RFC822_ADDR, and ID_IPV6_ADDR <span class="bcp14">SHOULD</span> be supported. ID types ID_DER_ASN1_DN and ID_DER_ASN1_GN 
        are not expected to be used. The Payload Type for the IDg payload is fifty (50).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sag_payload">
<section id="section-4.3">
        <h3 id="name-security-association-gm-sup">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-security-association-gm-sup" class="section-name selfRef">Security Association - GM Supported Transforms Payload</a>
        </h3>
<p id="section-4.3-1">The Security Association - GM Supported Transforms (SAg) payload
        declares which Transforms a GM is willing to
        accept. The payload is constructed using the format of the IKEv2
        Security Association payload (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>).
        The Payload Type for SAg payloads is thirty-three (33), which is
        identical to the SA Payload Type.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gsa_payload">
<section id="section-4.4">
        <h3 id="name-group-security-association-">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-group-security-association-" class="section-name selfRef">Group Security Association Payload</a>
        </h3>
<p id="section-4.4-1">The GSA payload is used by the GCKS to assert security attributes for
  both Rekey and Data-Security SAs.
        The Payload Type for the GSA payload is fifty-one (51).<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<span id="name-gsa-payload-format"></span><div id="gsa_payload_format">
<figure id="figure-14">
          <div class="alignLeft art-text artwork" id="section-4.4-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|   RESERVED  |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                       &lt;Group Policies&gt;                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-gsa-payload-format" class="selfRef">GSA Payload Format</a>
          </figcaption></figure>
</div>
<p id="section-4.4-3">The GSA payload fields are defined as follows:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4-4">
          <dt id="section-4.4-4.1">Next Payload, C, RESERVED, and Payload Length
          fields:</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-4.2">Comprise the IKEv2 generic payload header and are
          defined in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-4.4-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.4-4.3">Group Policies (variable):</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-4.4">A set of group policies for
          the group.<a href="#section-4.4-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="group_policy">
<section id="section-4.4.1">
          <h4 id="name-group-policies">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-group-policies" class="section-name selfRef">Group Policies</a>
          </h4>
<p id="section-4.4.1-1">Group policies are comprised of two types: group SA policy and
          group-wide (GW) policy. Group SA policy defines parameters for the
          Security Association of the group. Depending on the employed
          security protocol, a group SA policy may be either a Rekey SA (GSA
          KEK) policy or a Data-Security (GSA TEK) SA policy. GSA payload may
          contain zero or one GSA KEK policy, zero or more GSA TEK policies,
          and zero or one GW policy, where either one GSA KEK or one GSA TEK
          policy <span class="bcp14">MUST</span> be present.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">This latitude allows various group policies to be accommodated.
          For example, if the group policy does not require the use of a Rekey
          SA, the GCKS would not need to send a GSA KEK policy to the group
          member since all SA updates would be performed using the GSA_INBAND_REKEY exchange via the 
          unicast IKE SA. Alternatively, group policy might use a Rekey SA
          but choose to download a KEK to the GM only as part of the
          unicast IKE SA. Therefore, the GSA KEK policy would not be
          necessary as part of the GSA_REKEY message.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">Specifying multiple GSA TEKs allows multiple related data streams
          (e.g., video, audio, and text) to be associated with a session, but
          each are protected with an individual Security Association.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.1-4">A GW policy allows for the distribution of group-wide policy,
          such as instructions for when to activate and deactivate SAs.<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.4.1-5">Policies are distributed in substructures to the GSA payload.
          The format of the substructures is defined in <a href="#gsa_policy" class="auto internal xref">Section 4.4.2</a>
          (for group SA policy) and in <a href="#gw_policy" class="auto internal xref">Section 4.4.3</a> (for GW policy).
          The first octet of the substructure unambiguously determines its type;
          it is zero for GW policy and non-zero (actually, it contains a Security Protocol Identifier)
          for group SA policies.<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gsa_policy">
<section id="section-4.4.2">
          <h4 id="name-group-security-association-p">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-group-security-association-p" class="section-name selfRef">Group Security Association Policy Substructure</a>
          </h4>
<p id="section-4.4.2-1">The group SA policy substructure contains parameters for a single
          SA that is used with this group. Depending on the security protocol,
          the SA is either a Rekey SA or a Data-Security SA (ESP and AH).  The
          GCKS <span class="bcp14">MUST NOT</span> distribute both ESP and AH policies for
          the same set of Traffic Selectors.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<span id="name-group-sa-policy-substructur"></span><div id="gsa_format">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-4.4.2-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Protocol   |   SPI Size    |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                              SPI                              ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                  Source Traffic Selector                      ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                Destination Traffic Selector                   ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                    &lt;Group SA Transforms&gt;                      ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                    &lt;Group SA Attributes&gt;                      ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-group-sa-policy-substructur" class="selfRef">Group SA Policy Substructure Format</a>
            </figcaption></figure>
</div>
<p id="section-4.4.2-3">The group SA policy fields are defined as follows:<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4.2-4">
            <dt id="section-4.4.2-4.1">Protocol (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.2">Identifies the security protocol
            for this group SA.  The values are defined in the "IKEv2 Security
            Protocol Identifiers" registry in <span>[<a href="#IKEV2-IANA" class="cite xref">IKEV2-IANA</a>]</span>. The valid
            values for this field are 6 (GIKE_UPDATE) for Rekey SA
            and 2 (AH) or 3 (ESP) for Data-Security SAs.<a href="#section-4.4.2-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.3">SPI Size (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.4">Size of the SPI
            for the SA.  SPI size depends on the SA protocol. It is 16 octets for GIKE_UPDATE and 4 octets for AH and ESP.<a href="#section-4.4.2-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.5">Length (2 octets, unsigned integer):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.6">Length of this
            substructure including the header.<a href="#section-4.4.2-4.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.7">SPI (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.8">Security Parameter Index for the group SA.
            The size of this field is determined by the SPI Size field.
            As described above, these SPIs are assigned by the GCKS. 
            In the case of GIKE_UPDATE, the SPI is the IKEv2 header SPI pair where the
            first 8 octets become the "IKE SA Initiator's SPI" field in the
            G-IKEv2 rekey message IKEv2 HDR, and the second 8 octets become
            the "IKE SA Responder's SPI" in the same HDR.<a href="#section-4.4.2-4.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.9">Source &amp; Destination Traffic Selectors (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.10">
              <p id="section-4.4.2-4.10.1">Substructures describing the source and destination of the network
            identities. The format for these substructures is defined in IKEv2
            (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.13.1" class="relref">Section 3.13.1</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>).<a href="#section-4.4.2-4.10.1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4.10.2">For the Rekey SA (with the GIKE_UPDATE protocol), the
            destination traffic selectors <span class="bcp14">MUST</span> define a single
            multicast IP address, an IP protocol (assumed to be UDP), and a
            single port the GSA_REKEY messages will be destined to. In this case, the source
            traffic selector <span class="bcp14">SHOULD</span> define a
            single IP address, an IP protocol (assumed to be UDP), and a single
            port the GSA_REKEY messages will be originated from.  The source
            traffic selector <span class="bcp14">MAY</span> define a wildcard IP address
            and/or wildcard port. For the Data-Security (AH and ESP) SAs, the
            destination traffic selectors will usually define a single
            multicast IP address.  The source traffic selector in this case
            will usually define a single IP address or be a wildcard selector.
            An IP protocol and ports define the characteristics of traffic
            protected by this Data-Security SA.<a href="#section-4.4.2-4.10.2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4.10.3">If the Data-Security SAs are created in tunnel mode, then it
            <span class="bcp14">MUST</span> be tunnel mode with address preservation (see
            Multicast Extensions to the Security Architecture <span>[<a href="#RFC5374" class="cite xref">RFC5374</a>]</span>.  UDP encapsulation of ESP packets <span>[<a href="#RFC3948" class="cite xref">RFC3948</a>]</span> cannot be specified in G-IKEv2 and thus is
            not used for the multicast Data-Security SAs.<a href="#section-4.4.2-4.10.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.11">Group SA Transforms (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.12">A list of Transform
            Substructures specifies the policy information for the SA.  The
            format is defined in IKEv2 (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>).  The "Last Substruc" field
            in each Transform Substructure is set to 3 except for the last
            Transform Substructure, where it is set to 0. <a href="#gsa_transforms" class="auto internal xref">Section 4.4.2.1</a> describes using IKEv2 transforms in the
            group SA policy substructure.<a href="#section-4.4.2-4.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.2-4.13">Group SA Attributes (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.2-4.14">Contains policy attributes
            associated with the group SA. The following sections describe the
            possible attributes. Any or all attributes may be optional,
            depending on the protocol and the group policy. <a href="#gsa_attr" class="auto internal xref">Section 4.4.2.2</a> defines attributes used in the group SA policy
            substructure.<a href="#section-4.4.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="gsa_transforms">
<section id="section-4.4.2.1">
            <h5 id="name-group-sa-transforms">
<a href="#section-4.4.2.1" class="section-number selfRef">4.4.2.1. </a><a href="#name-group-sa-transforms" class="section-name selfRef">Group SA Transforms</a>
            </h5>
<p id="section-4.4.2.1-1">Group SA policy is defined by the means of transforms in the group SA policy substructure.
            For this purpose, the transforms defined in <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
            are used. In addition, new Transform Types are defined for use in G-IKEv2:
            Group Controller Authentication Method (GCAUTH) 
            and Key Wrap Algorithm (KWA); see <a href="#IANA" class="auto internal xref">Section 9</a>.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1-2"> Valid Transform Types depend on the SA protocol and are summarized in the table below.
            Exactly one instance of each mandatory Transform Type and at most one instance of each
            optional Transform Type <span class="bcp14">MUST</span> be present in the group SA policy substructure.<a href="#section-4.4.2.1-2" class="pilcrow">¶</a></p>
<span id="name-valid-transform-types"></span><div id="allowed_transforms">
<table class="center" id="table-2">
              <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-valid-transform-types" class="selfRef">Valid Transform Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Protocol</th>
                  <th class="text-left" rowspan="1" colspan="1">Mandatory Types</th>
                  <th class="text-left" rowspan="1" colspan="1">Optional Types</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE</td>
                  <td class="text-left" rowspan="1" colspan="1">ENCR, INTEG*, GCAUTH**, KWA</td>
                  <td class="text-left" rowspan="1" colspan="1"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">ESP</td>
                  <td class="text-left" rowspan="1" colspan="1">ENCR, SN</td>
                  <td class="text-left" rowspan="1" colspan="1">INTEG</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">AH</td>
                  <td class="text-left" rowspan="1" colspan="1">INTEG, SN</td>
                  <td class="text-left" rowspan="1" colspan="1"></td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-4.4.2.1-4">Notes:<a href="#section-4.4.2.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.2.1-5">
              <dt id="section-4.4.2.1-5.1">(*):</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.2.1-5.2">If the AEAD encryption algorithm is used, then INTEG
              transform either <span class="bcp14">MUST NOT</span> be specified or
              <span class="bcp14">MUST</span> contain value NONE; otherwise, it
              <span class="bcp14">MUST</span> be specified and <span class="bcp14">MUST</span> contain
              a value other than NONE.<a href="#section-4.4.2.1-5.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.4.2.1-5.3">(**):</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.2.1-5.4">May only appear at the time of a GM
              registration (in the GSA_AUTH and GSA_REGISTRATION
              exchanges).<a href="#section-4.4.2.1-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<div id="auth_method">
<section id="section-4.4.2.1.1">
              <h6 id="name-group-controller-authentica">
<a href="#section-4.4.2.1.1" class="section-number selfRef">4.4.2.1.1. </a><a href="#name-group-controller-authentica" class="section-name selfRef">Group Controller Authentication Method Transform</a>
              </h6>
<p id="section-4.4.2.1.1-1">The Group Controller Authentication Method (GCAUTH) transform is used to convey information on how the GCKS 
              will authenticate the GSA_REKEY messages.<a href="#section-4.4.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.1-2"> This document creates a new IKEv2 IANA registry for Transform IDs of this Transform Type, which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
              In particular, the following entries have been added:<a href="#section-4.4.2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-group-controller-authenticat"></span><table class="center" id="table-3">
                <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-group-controller-authenticat" class="selfRef">Group Controller Authentication Method Transform IDs</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Value</th>
                    <th class="text-left" rowspan="1" colspan="1">Group Controller Authentication Method</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0</td>
                    <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">1</td>
                    <td class="text-left" rowspan="1" colspan="1">Implicit</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">2</td>
                    <td class="text-left" rowspan="1" colspan="1">Digital Signature</td>
                  </tr>
                </tbody>
              </table>
<p id="section-4.4.2.1.1-4">These Transform IDs are defined as follows:<a href="#section-4.4.2.1.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4.2.1.1-5">
                <dt id="section-4.4.2.1.1-5.1">Implicit:</dt>
                <dd style="margin-left: 1.5em" id="section-4.4.2.1.1-5.2">No authentication of the
                GSA_REKEY messages will be provided by the GCKS besides the
                ability for the GMs to correctly decrypt them and verify their
                ICV.  In this case, the GCKS <span class="bcp14">MUST NOT</span> include
                the AUTH_KEY attribute into the KD payload.  Additionally, the
                AUTH payload <span class="bcp14">MUST NOT</span> be included in the
                GIKE_UPDATE messages.<a href="#section-4.4.2.1.1-5.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.4.2.1.1-5.3">Digital Signature</dt>
                <dd style="margin-left: 1.5em" id="section-4.4.2.1.1-5.4">
                  <p id="section-4.4.2.1.1-5.4.1">Digital signatures
                will be used by the GCKS to authenticate the GSA_REKEY
                messages.  In this case, the GCKS <span class="bcp14">MUST</span> include
                the AUTH_KEY attribute containing the public key into the KD
                payload at the time the GM is registered to the group. To
                specify the details of the signature algorithm, a new attribute
                Signature Algorithm Identifier (value 18) is
                defined.  This attribute contains DER-encoded ASN.1 object
                AlgorithmIdentifier, which specifies the signature algorithm
                and the hash function that the GCKS will use for
                authentication.  The AlgorithmIdentifier object is defined in
                <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.1.2" class="relref">Section 4.1.1.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. Also, see <span>[<a href="#RFC7427" class="cite xref">RFC7427</a>]</span>
                for the list of common AlgorithmIdentifier values used in
                IKEv2.<a href="#section-4.4.2.1.1-5.4.1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.1-5.4.2">In the case of the Digital Signature Transform ID, the GCKS
                <span class="bcp14">MUST</span> include the Signature Algorithm Identifier
                attribute in the Group Controller Authentication Method
                transform. In this case, the AUTH payload in the GIKE_UPDATE
                messages <span class="bcp14">MUST</span> contain the Digital Signature
                authentication method (value 14) and be formatted as defined
                in <span><a href="https://rfc-editor.org/rfc/rfc7427#section-3" class="relref">Section 3</a> of [<a href="#RFC7427" class="cite xref">RFC7427</a>]</span>. The
                AlgorithmIdentifier ASN.1 object in the AUTH payload
                <span class="bcp14">MUST</span> match the content of the Signature
                Algorithm Identifier attribute in the Group Controller
                Authentication Method transform.  The Signature Algorithm
                Identifier attribute is only meaningful for the Digital
                Signature Transform ID and <span class="bcp14">MUST NOT</span> be used
                with other Transform IDs.<a href="#section-4.4.2.1.1-5.4.2" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-4.4.2.1.1-6">
              More authentication methods may be defined in the future.<a href="#section-4.4.2.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.1-7">The authentication method <span class="bcp14">MUST NOT</span> change as a result of rekey operations.
              This means that the Group Controller Authentication Method transform <span class="bcp14">MUST NOT</span> appear in the rekey
              messages; it may only appear in the registration exchange (either GSA_AUTH or GSA_REGISTRATION).<a href="#section-4.4.2.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.1-8">The type of the Group Controller Authentication Method transform is 14.<a href="#section-4.4.2.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wrapping_alg">
<section id="section-4.4.2.1.2">
              <h6 id="name-key-wrap-algorithm-transfor">
<a href="#section-4.4.2.1.2" class="section-number selfRef">4.4.2.1.2. </a><a href="#name-key-wrap-algorithm-transfor" class="section-name selfRef">Key Wrap Algorithm Transform</a>
              </h6>
<p id="section-4.4.2.1.2-1">The Key Wrap Algorithm (KWA) transform is used to convey information about an algorithm
              that is used for key wrapping in G-IKEv2. See <a href="#wrapped_key" class="auto internal xref">Section 4.5.4</a> for details.<a href="#section-4.4.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.2-2"> This document creates a new IKEv2 IANA registry for the key wrap algorithms, 
              which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
              In particular, the following entries have been added:<a href="#section-4.4.2.1.2-2" class="pilcrow">¶</a></p>
<span id="name-key-wrap-algorithm-transform"></span><table class="center" id="table-4">
                <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-key-wrap-algorithm-transform" class="selfRef">Key Wrap Algorithm Transform IDs</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Value</th>
                    <th class="text-left" rowspan="1" colspan="1">Key Wrap Algorithm</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0</td>
                    <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">1</td>
                    <td class="text-left" rowspan="1" colspan="1">KW_5649_128</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">2</td>
                    <td class="text-left" rowspan="1" colspan="1">KW_5649_192</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">3</td>
                    <td class="text-left" rowspan="1" colspan="1">KW_5649_256</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">4</td>
                    <td class="text-left" rowspan="1" colspan="1">KW_ARX</td>
                  </tr>
                </tbody>
              </table>
<p id="section-4.4.2.1.2-4">These algorithms are defined as follows:<a href="#section-4.4.2.1.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4.2.1.2-5">
                <dt id="section-4.4.2.1.2-5.1">KW_5649_128, KW_5649_192, KW_5649_256:</dt>
                <dd style="margin-left: 1.5em" id="section-4.4.2.1.2-5.2">The key wrap
                algorithm defined in <span>[<a href="#RFC5649" class="cite xref">RFC5649</a>]</span> with a 128-bit,
                192-bit, and 256-bit key, respectively.  This key wrap algorithm
                is designed for use with AES block cipher.<a href="#section-4.4.2.1.2-5.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.4.2.1.2-5.3">KW_ARX:</dt>
                <dd style="margin-left: 1.5em" id="section-4.4.2.1.2-5.4">The ARX-KW-8-2-4-GX key wrap algorithm
                defined in <span>[<a href="#ARX-KW" class="cite xref">ARX-KW</a>]</span>. This key wrap algorithm is
                designed for use with Chacha20 stream cipher.<a href="#section-4.4.2.1.2-5.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-4.4.2.1.2-6">More key wrap algorithms may be defined in the future. The
              requirement is that these algorithms must be able
              to wrap key material of size up to 256 bytes.<a href="#section-4.4.2.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.2-7">The type of the Key Wrap Algorithm transform is 13.<a href="#section-4.4.2.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="antireplay">
<section id="section-4.4.2.1.3">
              <h6 id="name-sequence-numbers-transform">
<a href="#section-4.4.2.1.3" class="section-number selfRef">4.4.2.1.3. </a><a href="#name-sequence-numbers-transform" class="section-name selfRef">Sequence Numbers Transform</a>
              </h6>
<p id="section-4.4.2.1.3-1">The Sequence Numbers (SNs) Transform Type is defined in <span>[<a href="#RFC9827" class="cite xref">RFC9827</a>]</span>.
              This transform describes the properties of sequence numbers of IPsec packets. There are currently two Transform IDs
              defined for this Transform Type: "32-bit Sequential Numbers" and "Partially Transmitted 64-bit Sequential Numbers"
              that correspond to non-ESN and ESN cases from AH <span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span> and ESP <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span> specifications.<a href="#section-4.4.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.3-2">Transform ID "32-bit Sequential Numbers" <span class="bcp14">SHOULD</span> be used by the GCKS for 
              single-sender multicast Data-Security SAs utilizing protocols ESP or AH.<a href="#section-4.4.2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.3-3">Since both AH <span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span> and ESP <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span> are defined in such a way that high-order 32 bits of extended sequence numbers are never transmitted, it makes using ESN in multicast Data-Security SAs
              problematic because GMs that join the group long after it is created will have to somehow learn the current high-order 32 bits
              of ESN for each sender in the group. The algorithm for doing this described in AH <span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span>
              and ESP <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span> is resource-consuming and is only suitable when a receiver is able to guess
              the high-order 32 bits close enough to its real value, which is not the case for multicast SAs. 
              For this reason, the "Partially Transmitted 64-bit Sequential Numbers" Transform ID  
              <span class="bcp14">MUST NOT</span> be used for multicast Data-Security SAs utilizing protocols ESP or AH.<a href="#section-4.4.2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1.3-4"> This document defines a new Transform ID 
              for this Transform Type: "32-bit Unspecified Numbers" (2). This Transform ID defines the following properties:<a href="#section-4.4.2.1.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2.1.3-5.1">Sequence numbers are
32 bits in size and are transmitted in the Sequence Number field of AH and ESP
packets.<a href="#section-4.4.2.1.3-5.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.2.1.3-5.2">The value of sequence numbers is not guaranteed to be unique for the
duration of an SA, thus they are not suitable for replay protection.<a href="#section-4.4.2.1.3-5.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.4.2.1.3-6">This
Transform ID <span class="bcp14">MUST</span> be used by the GCKS in case of multi-sender
multicast Data-Security SAs utilizing protocols ESP or AH to inform the GMs
that the replay protection is not expected to be possible.  The GCKS
<span class="bcp14">MAY</span> also use this Transform ID for single-sender multicast
Data-Security SAs if replay protection is not needed (e.g., it is done on
the application level).<a href="#section-4.4.2.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gsa_attr">
<section id="section-4.4.2.2">
            <h5 id="name-group-sa-attributes">
<a href="#section-4.4.2.2" class="section-number selfRef">4.4.2.2. </a><a href="#name-group-sa-attributes" class="section-name selfRef">Group SA Attributes</a>
            </h5>
<p id="section-4.4.2.2-1">Group SA attributes are generally used to provide GMs with additional parameters
            for the group SA policy. Unlike security parameters distributed via transforms,
            which are expected not to change over time (unless the policy changes), 
            the parameters distributed via group SA  attributes
            may depend on the time the provision takes place, on the
            existence of other group SAs, or on other conditions.<a href="#section-4.4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2-2">This document creates a new IKEv2 IANA registry for the types
            of group SA attributes, which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
            In particular, the following attributes have been added:<a href="#section-4.4.2.2-2" class="pilcrow">¶</a></p>
<span id="name-group-sa-attributes-2"></span><table class="center" id="table-5">
              <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-group-sa-attributes-2" class="selfRef">Group SA Attributes</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Group SA Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                  <th class="text-left" rowspan="1" colspan="1">Used in Protocol</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_KEY_LIFETIME</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE, AH, ESP</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_INITIAL_MESSAGE_ID</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_NEXT_SPI</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">YES</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE, AH, ESP</td>
                </tr>
              </tbody>
            </table>
<p id="section-4.4.2.2-4">
            The attributes follow the format defined in IKEv2 (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3.5" class="relref">Section 3.3.5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>). The
            "Format" column defines what attribute format is allowed:
            Type/Length/Value (TLV) or Type/Value (TV).  The "Multi-Valued"
            column defines whether multiple instances of the attribute can
            appear.  The "Used in Protocol" column lists the security
            protocols, for which the attribute can be used.<a href="#section-4.4.2.2-4" class="pilcrow">¶</a></p>
<div id="gsa_attr_key_lifetime">
<section id="section-4.4.2.2.1">
              <h6 id="name-gsa_key_lifetime-attribute">
<a href="#section-4.4.2.2.1" class="section-number selfRef">4.4.2.2.1. </a><a href="#name-gsa_key_lifetime-attribute" class="section-name selfRef">GSA_KEY_LIFETIME Attribute</a>
              </h6>
<p id="section-4.4.2.2.1-1">The GSA_KEY_LIFETIME attribute (1) specifies the maximum time for
              which the SA is valid. The value is a 4-octet unsigned integer in network byte order, specifying a valid time period in seconds.
              When the lifetime expires, the group SA and all associated keys <span class="bcp14">MUST</span> be deleted. 
              The GCKS may delete the SA at any time before the end of the validity period.<a href="#section-4.4.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.1-2">A single attribute of this type <span class="bcp14">MUST</span> be included into any group SA policy substructure
              if multicast rekey is employed by the GCKS. This attribute <span class="bcp14">SHOULD NOT</span> be used if inband rekey 
              (via the GSA_INBAND_REKEY exchange) is employed by the GCKS for the GM.<a href="#section-4.4.2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gsa_attr_initial_message_id">
<section id="section-4.4.2.2.2">
              <h6 id="name-gsa_initial_message_id-attr">
<a href="#section-4.4.2.2.2" class="section-number selfRef">4.4.2.2.2. </a><a href="#name-gsa_initial_message_id-attr" class="section-name selfRef">GSA_INITIAL_MESSAGE_ID Attribute</a>
              </h6>
<p id="section-4.4.2.2.2-1">The GSA_INITIAL_MESSAGE_ID attribute (2) defines the initial Message ID
              to be used by the GCKS in the GSA_REKEY messages. The Message ID
              is a 4-octet unsigned integer in network byte order.<a href="#section-4.4.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.2-2">A single attribute of this type is included into 
              the GSA KEK policy substructure if the initial Message ID of the Rekey SA is non-zero.
Note that it is always true if a GM joins the group after some
  multicast rekey operations have already taken place in this group.
  In this case, this attribute will be included into the group SA policy when the
  GM is registered.<a href="#section-4.4.2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.2-3">This attribute <span class="bcp14">MUST NOT</span> be used if inband rekey (via the GSA_INBAND_REKEY exchange) is employed by the GCKS for the GM.<a href="#section-4.4.2.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gsa_attr_next_spi">
<section id="section-4.4.2.2.3">
              <h6 id="name-gsa_next_spi-attribute">
<a href="#section-4.4.2.2.3" class="section-number selfRef">4.4.2.2.3. </a><a href="#name-gsa_next_spi-attribute" class="section-name selfRef">GSA_NEXT_SPI Attribute</a>
              </h6>
<p id="section-4.4.2.2.3-1">The optional GSA_NEXT_SPI attribute (3) contains the SPI that the GCKS reserved  
              for the next Rekey SA or Data-Security SAs replacing the current ones. The length of the attribute data
              is determined by the SPI Size field in the group SA policy substructure the attribute
              resides in (see <a href="#gsa_policy" class="auto internal xref">Section 4.4.2</a>), and the attribute data contains the
              SPI as it would appear on the network. Multiple attributes of this type <span class="bcp14">MAY</span> be included,
              meaning that any of the supplied SPIs can be used in the replacement group SA.<a href="#section-4.4.2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.3-2">The GM <span class="bcp14">MAY</span> store these values. Later on, if the GM starts receiving 
              messages with one of these SPIs without seeing a rekey message over the current Rekey SA, then
              it may be used as an indication that the rekey message got lost on its way to this GM.
              In this case, the GM <span class="bcp14">SHOULD</span> re-register to the group.<a href="#section-4.4.2.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.3-3">Note that this method of detecting lost rekey messages can only be used 
              by group receivers. Additionally, there is no point to include this attribute in the GSA_INBAND_REKEY messages
              since they use reliable transport. Also note that the GCKS is free 
              to forget its promises and not to use the SPIs it sent in the GSA_NEXT_SPI 
              attributes before (e.g., in cases where the GCKS is rebooted), so the GM must only treat
              this information as a "best effort" made by the GCKS to prepare for future rekeys.<a href="#section-4.4.2.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2.3-4">This attribute <span class="bcp14">MUST NOT</span> be used if inband rekey (via the GSA_INBAND_REKEY exchange) is employed by the GCKS for the GM.<a href="#section-4.4.2.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="gw_policy">
<section id="section-4.4.3">
          <h4 id="name-group-wide-policy-substruct">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-group-wide-policy-substruct" class="section-name selfRef">Group-Wide Policy Substructure</a>
          </h4>
<p id="section-4.4.3-1">Group-specific policy that does not belong to any SA policy can be distributed to
          all GMs using the GW policy substructure.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">The GW policy substructure is defined as follows:<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
<span id="name-gw-policy-substructure-form"></span><div id="gwp_format">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-4.4.3-3.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Protocol   |   RESERVED    |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                      &lt;GW Policy Attributes&gt;                   ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-gw-policy-substructure-form" class="selfRef">GW Policy Substructure Format</a>
            </figcaption></figure>
</div>
<p id="section-4.4.3-4">The GW policy substructure fields are defined as follows:<a href="#section-4.4.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4.3-5">
            <dt id="section-4.4.3-5.1">Protocol (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.3-5.2">
              <span class="bcp14">MUST</span> be zero. This
            value is reserved (see <a href="#IANA" class="auto internal xref">Section 9</a>) and is never used for
            any security protocol, so it is used here to indicate that this
            substructure contains policy not related to any specific
            protocol.<a href="#section-4.4.3-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-5.3">RESERVED (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.3-5.4">
              <span class="bcp14">MUST</span> be zero on
            transmission and <span class="bcp14">MUST</span> be ignored on receipt.<a href="#section-4.4.3-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-5.5">Length (2 octets, unsigned integer):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.3-5.6">Length of this
            substructure including the header.<a href="#section-4.4.3-5.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-5.7">GW Policy Attributes (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.4.3-5.8">Contains policy
            attributes associated with no specific SA. The following sections
            describe possible attributes. Any or all attributes may be
            optional depending on the group policy.<a href="#section-4.4.3-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="gwp_attr">
<section id="section-4.4.3.1">
            <h5 id="name-gw-policy-attributes">
<a href="#section-4.4.3.1" class="section-number selfRef">4.4.3.1. </a><a href="#name-gw-policy-attributes" class="section-name selfRef">GW Policy Attributes</a>
            </h5>
<p id="section-4.4.3.1-1">This document creates a new IKEv2 IANA registry for the types
              of group-wide policy attributes, which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
              In particular, the following attributes have been added:<a href="#section-4.4.3.1-1" class="pilcrow">¶</a></p>
<span id="name-gw-policy-attributes-2"></span><table class="center" id="table-6">
              <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-gw-policy-attributes-2" class="selfRef">GW Policy Attributes</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">GW Policy Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_ATD</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_DTD</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_SENDER_ID_BITS</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
              </tbody>
            </table>
<p id="section-4.4.3.1-3">The attributes follow the format defined in the IKEv2 (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3.5" class="relref">Section 3.3.5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>). The
            "Format" column defines what attribute format is allowed:
            Type/Length/Value (TLV) or Type/Value (TV).  The "Multi-Valued"
            column defines whether multiple instances of the attribute can
            appear.<a href="#section-4.4.3.1-3" class="pilcrow">¶</a></p>
<div id="gwp_attr_atd_dtd">
<section id="section-4.4.3.1.1">
              <h6 id="name-gwp_atd-and-gwp_dtd-attribu">
<a href="#section-4.4.3.1.1" class="section-number selfRef">4.4.3.1.1. </a><a href="#name-gwp_atd-and-gwp_dtd-attribu" class="section-name selfRef">GWP_ATD and GWP_DTD Attributes</a>
              </h6>
<p id="section-4.4.3.1.1-1"><span><a href="https://rfc-editor.org/rfc/rfc5374#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC5374" class="cite xref">RFC5374</a>]</span> specifies a key rollover method that
              requires two values be provided to GMs: Activation
              Time Delay (ATD) and Deactivation Time Delay (DTD).<a href="#section-4.4.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3.1.1-2">The GWP_ATD attribute (1) allows a GCKS to set the
                Activation Time Delay for Data-Security SAs of the group. The ATD
                defines how long active members of the group (those who sends traffic) 
                should wait after receiving new SAs before sending traffic over them.
                Note that to achieve smooth rollover, passive members of the group should
                activate the SAs immediately once they receive them.<a href="#section-4.4.3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.3.1.1-3">The GWP_DTD attribute (2) allows the GCKS to set the
                DTD for previously distributed SAs. The
                DTD defines how long after receiving a request to delete Data-Security SAs
                passive GMs should wait before actually deleting them.
                Note that active members of the group should stop sending traffic over these old SAs
                once new replacement SAs are activated (after time specified in the GWP_ATD attribute).<a href="#section-4.4.3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.3.1.1-4">The GWP_ATD and GWP_DTD attributes contain a 16-bit unsigned integer in  
                network byte order, specifying the delay in seconds. These attributes are <span class="bcp14">OPTIONAL</span>. 
                If one of them or both are not sent by the GCKS, then no corresponding delay
                should be employed.<a href="#section-4.4.3.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gwp_attr_sid_bits">
<section id="section-4.4.3.1.2">
              <h6 id="name-gwp_sender_id_bits-attribut">
<a href="#section-4.4.3.1.2" class="section-number selfRef">4.4.3.1.2. </a><a href="#name-gwp_sender_id_bits-attribut" class="section-name selfRef">GWP_SENDER_ID_BITS Attribute</a>
              </h6>
<p id="section-4.4.3.1.2-1">The GWP_SENDER_ID_BITS attribute (3) declares how many bits
              of the cipher nonce are taken to represent a Sender-ID
              value. The bits are applied as the most significant bits of the
              IV, as shown in Figure 1 of Using Counter Modes with ESP and AH
              to Protect Group Traffic <span>[<a href="#RFC6054" class="cite xref">RFC6054</a>]</span> and as specified
              in <a href="#sid-usage" class="auto internal xref">Section 2.5.2</a>. Guidance for a GCKS choosing the
              value is provided in <span><a href="https://rfc-editor.org/rfc/rfc6054#section-3" class="relref">Section 3</a> of [<a href="#RFC6054" class="cite xref">RFC6054</a>]</span>. This value is
              applied to each Sender-ID value distributed in the KD
              payload.<a href="#section-4.4.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3.1.2-2">The GCKS <span class="bcp14">MUST</span> include this attribute if there are more than one senders
                in the group and any of the Data-Security SAs use counter-based 
                cipher mode. The number of Sender-ID bits is represented as a 16-bit unsigned integer in 
                network byte order.<a href="#section-4.4.3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="kd_payload">
<section id="section-4.5">
        <h3 id="name-key-download-payload">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-key-download-payload" class="section-name selfRef">Key Download Payload</a>
        </h3>
<p id="section-4.5-1">The Key Download (KD) payload contains the group keys for the SAs
        specified in the GSA payload.
        The Payload Type for the Key Download payload is fifty-two (52).<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<span id="name-key-download-payload-format"></span><div id="kd_payload_format">
<figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-4.5-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |        Payload Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                           &lt;Key Bags&gt;                          ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-key-download-payload-format" class="selfRef">Key Download Payload Format</a>
          </figcaption></figure>
</div>
<p id="section-4.5-3">The Key Download payload fields are defined as follows:<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5-4">
          <dt id="section-4.5-4.1">Next Payload, C, RESERVED, and Payload Length fields:</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-4.2">
          Comprise the IKEv2 generic payload header and are defined in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-4.5-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.5-4.3">Key Bags (variable):</dt>
          <dd style="margin-left: 1.5em" id="section-4.5-4.4">A set of key bag substructures.<a href="#section-4.5-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="key_bag">
<section id="section-4.5.1">
          <h4 id="name-key-bags">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-key-bags" class="section-name selfRef">Key Bags</a>
          </h4>
<p id="section-4.5.1-1"> Keys are distributed in substructures called key bags. Each key bag contains one or more keys 
          that are logically related -- these are keys for either a single SA (Data-Security SA or Rekey SA)
          or a single GM (in the latter case, besides keys, the key bag may also
          contain security parameters for this GM).<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">
For this reason, two types of key bags are defined: Group Key Bag and
   Member Key Bag. The type is unambiguously determined by the first byte of
   the key bag substructure; for a Member Key Bag, it is zero and for a Group
   Key Bag, it contains a Security Protocol Identifier, which is always non-zero. 
   For a Group Key Bag, the Protocol along with the SPI (see <a href="#group_key_bag_format" class="auto internal xref">Figure 18</a>) 
   identify the SA that is associated with the keys in this bag.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="group_key_bag">
<section id="section-4.5.2">
          <h4 id="name-group-key-bag-substructure">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-group-key-bag-substructure" class="section-name selfRef">Group Key Bag Substructure</a>
          </h4>
<p id="section-4.5.2-1">The Group Key Bag substructure contains SA key information. This key information is associated 
          with some group SAs: either with Data-Security SAs or with a group Rekey SA.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<span id="name-group-key-bag-substructure-"></span><div id="group_key_bag_format">
<figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-4.5.2-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Protocol   |   SPI Size    |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                              SPI                              ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                  &lt;Group Key Bag Attributes&gt;                   ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-group-key-bag-substructure-" class="selfRef">Group Key Bag Substructure Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlNewline" id="section-4.5.2-3">
            <dt id="section-4.5.2-3.1">Protocol (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-3.2">Identifies the security protocol
            for this key bag.  The values are defined in the "IKEv2 Security
            Protocol Identifiers" registry in <span>[<a href="#IKEV2-IANA" class="cite xref">IKEV2-IANA</a>]</span>. The valid
            values for this field are: 6 (GIKE_UPDATE) for KEK Key
            packet and 2 (AH) or 3 (ESP) for TEK key bag.<a href="#section-4.5.2-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.2-3.3">SPI Size (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-3.4">Size of the
            SPI for the corresponding SA.  SPI size depends on the security
            protocol. It is 16 octets for GIKE_UPDATE and 4 octets for AH and ESP.<a href="#section-4.5.2-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.2-3.5">Length (2 octets, unsigned integer):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-3.6">Length of this substructure including the header.<a href="#section-4.5.2-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.2-3.7">SPI (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-3.8">Security Parameter Index for the corresponding SA.
            The size of this field is determined by the SPI Size field.
            In the case of GIKE_UPDATE, the SPI is the IKEv2 header SPI pair where the
            first 8 octets become the "IKE SA Initiator's SPI" field in the
            G-IKEv2 rekey message IKEv2 HDR, and the second 8 octets become
            the "IKE SA Responder's SPI" in the same HDR.<a href="#section-4.5.2-3.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.2-3.9">Group Key Bag Attributes (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-3.10">Contains key
            information for the corresponding SA.<a href="#section-4.5.2-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.5.2-4">This document creates a new IKEv2 IANA registry for the types
          of Group Key Bag attributes, which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
          In particular, the following attributes have been added:<a href="#section-4.5.2-4" class="pilcrow">¶</a></p>
<span id="name-group-key-bag-attributes"></span><table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-group-key-bag-attributes" class="selfRef">Group Key Bag Attributes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-left" rowspan="1" colspan="1">Group Key Bag Attributes</th>
                <th class="text-left" rowspan="1" colspan="1">Format</th>
                <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                <th class="text-left" rowspan="1" colspan="1">Used in Protocol</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                <td class="text-left" rowspan="1" colspan="3"></td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">SA_KEY</td>
                <td class="text-left" rowspan="1" colspan="1">TLV</td>
                <td class="text-left" rowspan="1" colspan="1">YES*<br>NO</td>
                <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE<br>AH, ESP</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.5.2-6">Notes:<a href="#section-4.5.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.2-7">
            <dt id="section-4.5.2-7.1">(*):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.2-7.2">Multiple SA_KEY attributes may only appear for the GIKE_UPDATE protocol
          in the GSA_REKEY pseudo-exchange if the GCKS uses the group key management
          method that allows excluding GMs from the group (like LKH).<a href="#section-4.5.2-7.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.5.2-8">The attributes follow the format defined in IKEv2 (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3.5" class="relref">Section 3.3.5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>). The
          "Format" column defines what attribute format is allowed:
          Type/Length/Value (TLV) or Type/Value (TV).  The "Multi-Valued"
          column defines whether multiple instances of the attribute can
          appear.  The "Used in Protocol" column lists the security protocols,
          for which the attribute can be used.<a href="#section-4.5.2-8" class="pilcrow">¶</a></p>
<div id="gkd_attr_group_key">
<section id="section-4.5.2.1">
            <h5 id="name-sa_key-attribute">
<a href="#section-4.5.2.1" class="section-number selfRef">4.5.2.1. </a><a href="#name-sa_key-attribute" class="section-name selfRef">SA_KEY Attribute</a>
            </h5>
<p id="section-4.5.2.1-1">The SA_KEY attribute (1) contains a keying material for the corresponding SA. 
            The content of the attribute is formatted according to 
            <a href="#wrapped_key" class="auto internal xref">Section 4.5.4</a> with a precondition that the Key ID field <span class="bcp14">MUST</span> always be zero.
            The size of the keying material <span class="bcp14">MUST</span> be equal to the total size of the keys needed to be taken
            from this keying material (see <a href="#group_sa_keys" class="auto internal xref">Section 3.4</a>) for the corresponding SA.<a href="#section-4.5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-2">If the key bag is for a Data-Security SA (AH or ESP protocols), 
            then exactly one SA_KEY attribute <span class="bcp14">MUST</span> be present with both
            Key ID and KWK ID fields set to zero.<a href="#section-4.5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-3">If the key bag is for a Rekey SA (GIKE_UPDATE protocol), 
then exactly one SA_KEY attribute <span class="bcp14">MUST</span> be present in the GSA_AUTH, GSA_REGISTRATION, and GSA_INBAND_REKEY exchanges.
            In the GSA_REKEY pseudo-exchange, at least one SA_KEY attribute <span class="bcp14">MUST</span> be present, 
            and more attributes <span class="bcp14">MAY</span> be present (depending on the key management method employed by the GCKS).<a href="#section-4.5.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="member_key_bag">
<section id="section-4.5.3">
          <h4 id="name-member-key-bag-substructure">
<a href="#section-4.5.3" class="section-number selfRef">4.5.3. </a><a href="#name-member-key-bag-substructure" class="section-name selfRef">Member Key Bag Substructure</a>
          </h4>
<p id="section-4.5.3-1">The Member Key Bag substructure contains keys and other
          parameters that are specific for a member of the group and are not
          associated with any particular group SA.<a href="#section-4.5.3-1" class="pilcrow">¶</a></p>
<span id="name-member-key-bag-substructure-"></span><div id="mkd_key_bag">
<figure id="figure-19">
            <div class="alignLeft art-text artwork" id="section-4.5.3-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Protocol   |   RESERVED    |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                  &lt;Member Key Bag Attributes&gt;                  ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-member-key-bag-substructure-" class="selfRef">Member Key Bag Substructure Format</a>
            </figcaption></figure>
</div>
<p id="section-4.5.3-3">The Member Key Bag substructure fields are defined as follows:<a href="#section-4.5.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5.3-4">
            <dt id="section-4.5.3-4.1">Protocol (1 octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.3-4.2">
              <span class="bcp14">MUST</span> be zero. This
            value is reserved (see <a href="#IANA" class="auto internal xref">Section 9</a>) and is never used for
            any security protocol, so it is used here to indicate that this
            key bag is not associated with any particular SA.<a href="#section-4.5.3-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.3-4.3">RESERVED ( octet):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.3-4.4">
              <span class="bcp14">MUST</span> be zero on
            transmission and <span class="bcp14">MUST</span> be ignored on receipt.<a href="#section-4.5.3-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.3-4.5">Length (2 octets, unsigned integer):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.3-4.6">Length of this
            substructure including the header.<a href="#section-4.5.3-4.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.3-4.7">Member Key Bag Attributes (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.3-4.8">Contains key
            information and other parameters exclusively for a particular
            member of the group.<a href="#section-4.5.3-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.5.3-5">
          The Member Key Bag substructure contains sensitive information for a single GM. For this reason,
          it <span class="bcp14">MUST NOT</span> be sent in GSA_REKEY messages and <span class="bcp14">MUST</span> only be sent via unicast
          SA at the time the GM registers to the group (in either GSA_AUTH or GSA_REGISTRATION exchanges).<a href="#section-4.5.3-5" class="pilcrow">¶</a></p>
<p id="section-4.5.3-6">This document creates a new IKEv2 IANA registry for the types
          of Member Key Bag attributes, which has been initially populated as described in <a href="#IANA" class="auto internal xref">Section 9</a>.
          In particular, the following attributes have been added:<a href="#section-4.5.3-6" class="pilcrow">¶</a></p>
<span id="name-member-key-bag-attributes"></span><table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-member-key-bag-attributes" class="selfRef">Member Key Bag Attributes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-left" rowspan="1" colspan="1">Member Key Bag Attributes</th>
                <th class="text-left" rowspan="1" colspan="1">Format</th>
                <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="3">Reserved</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">WRAP_KEY</td>
                <td class="text-left" rowspan="1" colspan="1">TLV</td>
                <td class="text-left" rowspan="1" colspan="1">YES</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">AUTH_KEY</td>
                <td class="text-left" rowspan="1" colspan="1">TLV</td>
                <td class="text-left" rowspan="1" colspan="1">NO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">GM_SENDER_ID</td>
                <td class="text-left" rowspan="1" colspan="1">TLV</td>
                <td class="text-left" rowspan="1" colspan="1">YES</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.5.3-8">The attributes follow the format defined in the IKEv2 (<span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.3.5" class="relref">Section 3.3.5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>). The
          "Format" column defines what attribute format is allowed:
          Type/Length/Value (TLV) or Type/Value (TV).  The "Multi-Valued"
          column defines whether multiple instances of the attribute can
          appear.<a href="#section-4.5.3-8" class="pilcrow">¶</a></p>
<div id="mkd_attr_kwk">
<section id="section-4.5.3.1">
            <h5 id="name-wrap_key-attribute">
<a href="#section-4.5.3.1" class="section-number selfRef">4.5.3.1. </a><a href="#name-wrap_key-attribute" class="section-name selfRef">WRAP_KEY Attribute</a>
            </h5>
<p id="section-4.5.3.1-1">The WRAP_KEY attribute (1) contains a key that is used 
            to encrypt other keys. One or more of these
            attributes are sent to GMs if the GCKS key management method
            relies on some key hierarchy (e.g., LKH).
            This attribute <span class="bcp14">MUST NOT</span> be used if inband rekey (via the GSA_INBAND_REKEY exchange) is employed by the GCKS for the GM.<a href="#section-4.5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.3.1-2">The content of the attribute has a format defined in <a href="#wrapped_key" class="auto internal xref">Section 4.5.4</a>
            with a precondition that the Key ID field <span class="bcp14">MUST NOT</span> be zero. 
            The algorithm associated with the key is defined by the Key Wrap Algorithm transform
            for the SA the WRAP_KEY attributes was sent in. 
            The size of the attribute data <span class="bcp14">MUST</span> be equal to the key size for this key wrap algorithm.<a href="#section-4.5.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.3.1-3">Multiple instances of the WRAP_KEY attributes <span class="bcp14">MAY</span> be present in the key bag.<a href="#section-4.5.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mkd_attr_auth_key">
<section id="section-4.5.3.2">
            <h5 id="name-auth_key-attribute">
<a href="#section-4.5.3.2" class="section-number selfRef">4.5.3.2. </a><a href="#name-auth_key-attribute" class="section-name selfRef">AUTH_KEY Attribute</a>
            </h5>
<p id="section-4.5.3.2-1">The AUTH_KEY attribute (2) contains the key that is used to authenticate 
            the GSA_REKEY messages. The content of the attribute depends on the authentication
            method the GCKS specified in the Group Controller Authentication Method transform in the GSA payload.<a href="#section-4.5.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.3.2-2.1">
                <p id="section-4.5.3.2-2.1.1">If digital signatures are used for the GSA_REKEY message
                authentication, then the content of the AUTH_KEY attribute is a
                public key used for digital signature authentication. The
                public key <span class="bcp14">MUST</span> be represented as DER-encoded
                ASN.1 object SubjectPublicKeyInfo, defined in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.7" class="relref">Section 4.1.2.7</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The algorithm field inside the
                SubjectPublicKeyInfo object <span class="bcp14">MUST</span> match the
                content of the Signature Algorithm Identifier attribute in the
                Group Controller Authentication Method transform.  When the
                id-RSASSA-PSS object identifier appears in the algorithm field
                of the SubjectPublicKeyInfo object, then the parameters field
                <span class="bcp14">MUST</span> include the RSASSA-PSS-params structure.<a href="#section-4.5.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5.3.2-2.2">
                <p id="section-4.5.3.2-2.2.1">In case of implicit authentication, the AUTH_KEY Attribute
       is not used and <span class="bcp14">MUST</span> be absent (see <a href="#gsa_rekey" class="auto internal xref">Section 2.4.1</a>).<a href="#section-4.5.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.5.3.2-3">

            Multiple instances of the AUTH_KEY attributes <span class="bcp14">MUST NOT</span> be sent.<a href="#section-4.5.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mkd_attr_gm_sid">
<section id="section-4.5.3.3">
            <h5 id="name-gm_sender_id-attribute">
<a href="#section-4.5.3.3" class="section-number selfRef">4.5.3.3. </a><a href="#name-gm_sender_id-attribute" class="section-name selfRef">GM_SENDER_ID Attribute</a>
            </h5>
<p id="section-4.5.3.3-1">The GM_SENDER_ID attribute (3) is used to download one or more Sender-ID 
            values for the exclusive use of a GM.  One or more of these attributes <span class="bcp14">MUST</span> be
            sent by the GCKS if the GM informed the GCKS that it would be a sender (by including
            the GROUP_SENDER notification to the request) and if at least one of the Data-Security SAs 
            included in the GSA payload uses a counter-based mode of encryption.<a href="#section-4.5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.5.3.3-2">If the GMs have requested multiple Sender-ID values in the GROUP_SENDER notification, then the GCKS <span class="bcp14">SHOULD</span>
            provide it with the requested number of Sender-IDs by sending multiple instances of the GM_SENDER_ID
            attribute. The GCKS <span class="bcp14">MAY</span> send fewer values than requested by the GM (e.g., if it is running out of Sender-IDs),
            but it <span class="bcp14">MUST NOT</span> send more than requested.<a href="#section-4.5.3.3-2" class="pilcrow">¶</a></p>
<p id="section-4.5.3.3-3">This attribute <span class="bcp14">MUST NOT</span> appear in the rekey operations (in the GSA_REKEY pseudo-exchange or in the GSA_INBAND_REKEY exchange).<a href="#section-4.5.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="wrapped_key">
<section id="section-4.5.4">
          <h4 id="name-key-wrapping">
<a href="#section-4.5.4" class="section-number selfRef">4.5.4. </a><a href="#name-key-wrapping" class="section-name selfRef">Key Wrapping</a>
          </h4>
<p id="section-4.5.4-1">Symmetric keys in G-IKEv2 are never sent in clear inside G-IKEv2 messages.
          They are always protected with other symmetric keys. This protection is called key wrapping.
          Algorithms used for key wrapping are usually based on generic encryption algorithms,
          but their mode of operation is optimized for protecting short high-entropy data with minimal additional overhead.
          While key wrap algorithms can be generic in general, they are often tied to the underlying
          encryption algorithms in practice. For example, AES Key Wrap with Padding Algorithm <span>[<a href="#RFC5649" class="cite xref">RFC5649</a>]</span> defines key wrapping using AES,
          and Key Wrapping Constructions using SipHash and ChaCha <span>[<a href="#ARX-KW" class="cite xref">ARX-KW</a>]</span> define key wrapping using Chacha20.<a href="#section-4.5.4-1" class="pilcrow">¶</a></p>
<p id="section-4.5.4-2">In G-IKEv2, the key wrap algorithm <span class="bcp14">MUST</span> be negotiated in the
 IKE_SA_INIT exchange so that the GCKS is able to send encrypted keys
 to the GM in the GSA_AUTH exchange.  In addition, if the GCKS plans
 to use the multicast Rekey SA for group rekey, then it <span class="bcp14">MUST</span> specify
 the key wrap algorithm in the group SA policy for the Rekey SA inside the GSA payload. Note that key wrap algorithms 
          for these cases <span class="bcp14">MAY</span> be different. For the unicast SA, the key wrap algorithm is negotiated
          between the GM and the GCKS, while for the multicast Rekey SA, the key wrap algorithm
          is provided by the GCKS to the GMs as part of the group policy.
          If an SAg payload is included in the GSA_AUTH request, then it <span class="bcp14">MUST</span> indicate which key wrap algorithms are supported by the GM.
          In all these cases, the key wrap algorithm is specified in a Key Wrap Algorithm transform (see <a href="#wrapping_alg" class="auto internal xref">Section 4.4.2.1.2</a>).<a href="#section-4.5.4-2" class="pilcrow">¶</a></p>
<p id="section-4.5.4-3"> The format of the wrapped key is shown in <a href="#key_format" class="auto internal xref">Figure 20</a>.<a href="#section-4.5.4-3" class="pilcrow">¶</a></p>
<span id="name-wrapped-key-format"></span><div id="key_format">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-4.5.4-4.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Key ID                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              KWK ID                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                          Encrypted Key                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-wrapped-key-format" class="selfRef">Wrapped Key Format</a>
            </figcaption></figure>
</div>
<p id="section-4.5.4-5">The Wrapped Key fields are defined as follows:<a href="#section-4.5.4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.5.4-6">
            <dt id="section-4.5.4-6.1">Key ID (4 octets):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.4-6.2">ID of the encrypted key. The value
            zero means that the encrypted key contains SA keys (in the form of
            keying material; see <a href="#group_sa_keys" class="auto internal xref">Section 3.4</a>). Otherwise,
            it contains some intermediate key.<a href="#section-4.5.4-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.4-6.3">KWK ID (4 octets):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.4-6.4">ID of the key that was used to
            encrypt the key with a specified Key ID.  The value zero means that the
            default KWK was used to encrypt the key. Otherwise, some
            intermediate key was used.<a href="#section-4.5.4-6.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.4-6.5">Encrypted Key (variable):</dt>
            <dd style="margin-left: 1.5em" id="section-4.5.4-6.6">The encrypted key bits. These
            bits comprise either a single encrypted key or a result of
            encryption of a concatenation of keys (key material) for several
            algorithms.  The format of this field is determined by the key
            wrap algorithm for the SA the wrapped key is sent over.<a href="#section-4.5.4-6.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="delete">
<section id="section-4.6">
        <h3 id="name-delete-payload">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-delete-payload" class="section-name selfRef">Delete Payload</a>
        </h3>
<p id="section-4.6-1">Delete payload is used in G-IKEv2 when the GCKS wants to 
        delete Data-Security and Rekey SAs. The interpretation of the Protocol
        field in the Delete payload is extended so that zero protocol
        indicates deletion of whole Group SA (i.e., all Data-Security SAs and the Rekey SA).
        See <a href="#deletion" class="auto internal xref">Section 2.4.3</a> for detail.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notify">
<section id="section-4.7">
        <h3 id="name-notify-payload">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-notify-payload" class="section-name selfRef">Notify Payload</a>
        </h3>
<p id="section-4.7-1">G-IKEv2 uses the same Notify payload as specified in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.10" class="relref">Section 3.10</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">There are additional Notify message types introduced by G-IKEv2 to
  communicate error conditions and status (see <a href="#IANA" class="auto internal xref">Section 9</a>).<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<div id="inv_gr_id">
<section id="section-4.7.1">
          <h4 id="name-invalid_group_id-notificati">
<a href="#section-4.7.1" class="section-number selfRef">4.7.1. </a><a href="#name-invalid_group_id-notificati" class="section-name selfRef">INVALID_GROUP_ID Notification</a>
          </h4>
<p id="section-4.7.1-1">INVALID_GROUP_ID (45) is a new error type notification that indicates that the IDg payload sent during the registration process denotes an invalid group.
          The Protocol ID and SPI Size fields in the Notify payload <span class="bcp14">MUST</span> be zero. 
          There is no data associated with this notification and the content of the 
          Notification Data field <span class="bcp14">MUST</span> be ignored on receipt.<a href="#section-4.7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="autz_failed">
<section id="section-4.7.2">
          <h4 id="name-authorization_failed-notifi">
<a href="#section-4.7.2" class="section-number selfRef">4.7.2. </a><a href="#name-authorization_failed-notifi" class="section-name selfRef">AUTHORIZATION_FAILED Notification</a>
          </h4>
<p id="section-4.7.2-1">AUTHORIZATION_FAILED (46) is a new error type notification that is sent in 
          the response to a GSA_AUTH or GSA_REGISTRATION message when authorization failed.
          The Protocol ID and SPI Size fields in the Notify payload <span class="bcp14">MUST</span> be zero.
          There is no data associated with this notification and the content of the 
          Notification Data field <span class="bcp14">MUST</span> be ignored on receipt.<a href="#section-4.7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reg_failed">
<section id="section-4.7.3">
          <h4 id="name-registration_failed-notific">
<a href="#section-4.7.3" class="section-number selfRef">4.7.3. </a><a href="#name-registration_failed-notific" class="section-name selfRef">REGISTRATION_FAILED Notification</a>
          </h4>
<p id="section-4.7.3-1">REGISTRATION_FAILED (49) is a new error type notification that is sent 
          by the GCKS when the GM registration request cannot be satisfied
          for reasons not related to this particular GM, e.g., if 
          the capacity of the group is exceeded.
          The Protocol ID and SPI Size fields in the Notify payload <span class="bcp14">MUST</span> be zero.
          There is no data associated with this notification and the content of the 
          Notification Data field <span class="bcp14">MUST</span> be ignored on receipt.<a href="#section-4.7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sender">
<section id="section-4.7.4">
          <h4 id="name-group_sender-notification">
<a href="#section-4.7.4" class="section-number selfRef">4.7.4. </a><a href="#name-group_sender-notification" class="section-name selfRef">GROUP_SENDER Notification</a>
          </h4>
<p id="section-4.7.4-1">GROUP_SENDER (16429) is a new status type notification that is sent in 
          the GSA_AUTH or the GSA_REGISTRATION exchanges to indicate that the GM
          intends to be sender of data traffic. The data includes a count of 
          how many Sender-ID values the GM desires. The count <span class="bcp14">MUST</span> be 4 octets long
          and contain the big-endian representation of the number of 
          requested Sender-IDs. The Protocol ID and SPI Size fields in the Notify payload <span class="bcp14">MUST</span> be zero.<a href="#section-4.7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-4.8">
        <h3 id="name-authentication-payload">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-authentication-payload" class="section-name selfRef">Authentication Payload</a>
        </h3>
<p id="section-4.8-1">G-IKEv2 uses the same Authentication payload as specified in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> to
        authenticate the rekey message.  However, if it is used in the
        GSA_REKEY messages, the content of the payload is computed differently
        as described in <a href="#gsa_rekey_auth" class="auto internal xref">Section 2.4.1.1</a>.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="restrictions">
<section id="section-5">
      <h2 id="name-using-g-ikev2-attributes">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-using-g-ikev2-attributes" class="section-name selfRef">Using G-IKEv2 Attributes</a>
      </h2>
<p id="section-5-1">G-IKEv2 defines a number of attributes that are used to convey information
      from the GCKS to GMs. There are some restrictions on where and when these attributes
      can appear in G-IKEv2 messages, which are defined when the attributes are introduced.
      For convenience, these restrictions are summarized in <a href="#mcast_attr" class="auto internal xref">Table 9</a> (for
      multicast rekey operations) and <a href="#inband_attr" class="auto internal xref">Table 10</a> (for inband rekey operations) below.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The following notations are used:<a href="#section-5-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-3">
        <dt id="section-5-3.1">S</dt>
        <dd style="margin-left: 2.5em" id="section-5-3.2">
        A single attribute of this type <span class="bcp14">MUST</span> be present.<a href="#section-5-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-3.3">M</dt>
        <dd style="margin-left: 2.5em" id="section-5-3.4">
        Multiple attributes of this type <span class="bcp14">MAY</span> be present.<a href="#section-5-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-3.5">[]</dt>
        <dd style="margin-left: 2.5em" id="section-5-3.6">
        Attribute is <span class="bcp14">OPTIONAL</span>.<a href="#section-5-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-3.7">-</dt>
        <dd style="margin-left: 2.5em" id="section-5-3.8">
        Attribute <span class="bcp14">MUST NOT</span> be present.<a href="#section-5-3.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-4">
   Note that the restrictions are defined per a substructure for which
   corresponding attributes are defined and not per a whole G-IKEv2 message.<a href="#section-5-4" class="pilcrow">¶</a></p>
<span id="name-attributes-in-g-ikev2-excha"></span><div id="mcast_attr">
<table class="center" id="table-9">
        <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-attributes-in-g-ikev2-excha" class="selfRef">Attributes in G-IKEv2 Exchanges with Multicast Rekey Operations</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Attributes</th>
            <th class="text-left" rowspan="1" colspan="1">GSA_AUTH GSA_REGISTRATION</th>
            <th class="text-left" rowspan="1" colspan="1">GSA_REKEY</th>
            <th class="text-left" rowspan="1" colspan="1">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">Group SA Attributes (<a href="#gsa_attr" class="auto internal xref">Section 4.4.2.2</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_KEY_LIFETIME</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_INITIAL_MESSAGE_ID</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_NEXT_SPI</td>
            <td class="text-left" rowspan="1" colspan="1">[M]</td>
            <td class="text-left" rowspan="1" colspan="1">[M]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">GW Policy Attributes (<a href="#gwp_attr" class="auto internal xref">Section 4.4.3.1</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_ATD</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_DTD</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_SENDER_ID_BITS</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">Key Bag Attributes (<a href="#key_bag" class="auto internal xref">Section 4.5.1</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SA_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">S[M]</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WRAP_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">[M]</td>
            <td class="text-left" rowspan="1" colspan="1">[M]</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">AUTH_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GM_SENDER_ID</td>
            <td class="text-left" rowspan="1" colspan="1">S[M]</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-6">Notes:<a href="#section-5-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-7">
        <dt id="section-5-7.1">(1):</dt>
        <dd style="margin-left: 3.0em" id="section-5-7.2">The GWP_SENDER_ID_BITS attribute <span class="bcp14">MUST</span> be present
        if the GCKS policy includes at least one cipher in counter mode of
        operation and if the GM included the GROUP_SENDER notify into the
        registration request.  Otherwise, it <span class="bcp14">MUST NOT</span> be
        present. At least one GM_SENDER_ID attribute <span class="bcp14">MUST</span> be
        present in the former case (and more <span class="bcp14">MAY</span> be present if
        the GM requested more Sender-IDs), and it <span class="bcp14">MUST NOT</span> be
        present in the latter case.<a href="#section-5-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.3">(2):</dt>
        <dd style="margin-left: 3.0em" id="section-5-7.4">For a Data-Security SA, exactly one SA_KEY attribute <span class="bcp14">MUST</span> be
       present. For a Rekey SA, exactly one SA_KEY attribute <span class="bcp14">MUST</span> be
          present in the GSA_AUTH and the GSA_REGISTRATION exchange.
          In the GSA_REKEY pseudo-exchange, at least one SA_KEY
         attribute <span class="bcp14">MUST</span> be present and more of these attributes <span class="bcp14">MAY</span> be
         present.<a href="#section-5-7.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.5">(3):</dt>
        <dd style="margin-left: 3.0em" id="section-5-7.6">The WRAP_KEY attribute <span class="bcp14">MUST</span> be present if the
        GCKS employs a key management method that relies on a key tree (like LKH).<a href="#section-5-7.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.7">(4):</dt>
        <dd style="margin-left: 3.0em" id="section-5-7.8">The AUTH_KEY attribute <span class="bcp14">MUST</span> be present in the
        GSA_AUTH and GSA_REGISTRATION exchanges if the GCKS employs
        an authentication method of rekey operations based on digital signatures
        and <span class="bcp14">MUST NOT</span> be present if implicit authentication is
        employed. The AUTH_KEY attribute <span class="bcp14">MUST</span> be present in the
        GSA_REKEY pseudo-exchange if the GCKS employs an authentication method based on
        digital signatures and wants to change the public key for the
        following multicast rekey operations.<a href="#section-5-7.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<span id="name-attributes-in-g-ikev2-exchan"></span><div id="inband_attr">
<table class="center" id="table-10">
        <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-attributes-in-g-ikev2-exchan" class="selfRef">Attributes in G-IKEv2 Exchanges with Inband Rekey Operations</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Attributes</th>
            <th class="text-left" rowspan="1" colspan="1">GSA_AUTH GSA_REGISTRATION</th>
            <th class="text-left" rowspan="1" colspan="1">GSA_INBAND_REKEY</th>
            <th class="text-left" rowspan="1" colspan="1">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">Group SA Attributes (<a href="#gsa_attr" class="auto internal xref">Section 4.4.2.2</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_KEY_LIFETIME</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_INITIAL_MESSAGE_ID</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GSA_NEXT_SPI</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">GW Policy Attributes (<a href="#gwp_attr" class="auto internal xref">Section 4.4.3.1</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_ATD</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_DTD</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1">[S]</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GWP_SENDER_ID_BITS</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <th class="text-left" rowspan="1" colspan="4">Key Bag Attributes (<a href="#key_bag" class="auto internal xref">Section 4.5.1</a>)</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SA_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1">S</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">WRAP_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">AUTH_KEY</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">GM_SENDER_ID</td>
            <td class="text-left" rowspan="1" colspan="1">S[M]</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-9">Notes:<a href="#section-5-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-10">
        <dt id="section-5-10.1">(1):</dt>
        <dd style="margin-left: 3.0em" id="section-5-10.2">The GWP_SENDER_ID_BITS attribute <span class="bcp14">MUST</span> be present if
        the GCKS policy includes at least one cipher in counter mode of
        operation and the GM included the GROUP_SENDER notify into the
        registration request.  Otherwise, it <span class="bcp14">MUST NOT</span> be
        present. At least one GM_SENDER_ID attribute <span class="bcp14">MUST</span> be
        present in the former case (and more <span class="bcp14">MAY</span> be present if
        the GM requested more Sender-IDs), and it <span class="bcp14">MUST NOT</span> be
        present in the latter case.<a href="#section-5-10.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ike_ext">
<section id="section-6">
      <h2 id="name-interaction-with-ikev2-and-">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-interaction-with-ikev2-and-" class="section-name selfRef">Interaction with IKEv2 and ESP Extensions</a>
      </h2>
<p id="section-6-1">A number of IKEv2 and ESP extensions are defined that can be used to extend
      protocol functionality. G-IKEv2 is compatible with most of them.
      In particular, EAP authentication defined in <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> can be used 
      to establish registration IKE SA, as well as EAP-only authentication <span>[<a href="#RFC5998" class="cite xref">RFC5998</a>]</span> and 
      secure password authentication <span>[<a href="#RFC6467" class="cite xref">RFC6467</a>]</span>. 
      G-IKEv2 is compatible with and can use IKEv2 Redirect Mechanism <span>[<a href="#RFC5685" class="cite xref">RFC5685</a>]</span> and 
      IKEv2 Session Resumption <span>[<a href="#RFC5723" class="cite xref">RFC5723</a>]</span>. 
      G-IKEv2 is also compatible with Multiple Key Exchanges in the IKEv2 
      framework, as defined in <span>[<a href="#RFC9370" class="cite xref">RFC9370</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The above list of compatible IKEv2 extensions is not exhaustive. However, some IKEv2 
      extensions require special handling if used in G-IKEv2.<a href="#section-6-2" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-implicit-iv-for-counter-bas">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-implicit-iv-for-counter-bas" class="section-name selfRef">Implicit IV for Counter-Based Ciphers in ESP</a>
        </h3>
<p id="section-6.1-1"> Using implicit IV for counter-based encryption modes in ESP is defined in <span>[<a href="#RFC8750" class="cite xref">RFC8750</a>]</span>.
        This extension relies on the uniqueness of ESP sequence numbers. Thus, it cannot be used for multi-sender
        multicast SAs. However, it is possible to use implicit IV extension for a single-sender multicast ESP SA.
        Note that while implicit IVs can be used with ESN, using ESN is prohibited 
        in multicast SAs (see <a href="#antireplay" class="auto internal xref">Section 4.4.2.1.3</a>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2">
        <h3 id="name-mixing-preshared-keys-in-ik">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-mixing-preshared-keys-in-ik" class="section-name selfRef">Mixing Preshared Keys in IKEv2 for Post-Quantum Security</a>
        </h3>
<p id="section-6.2-1">G-IKEv2 can take advantage of the protection provided by
        Post-quantum Preshared Keys (PPKs) for IKEv2 <span>[<a href="#RFC8784" class="cite xref">RFC8784</a>]</span>. However, the use of 
        PPKs leaves the initial IKE SA susceptible to quantum
        computer (QC) attacks. Group SA keys are protected with 
        the default KWK (GSK_w), which is derived from SK_d and thus 
        cannot be broken even by an attacker equipped with a QC.
        However, other data sent over the initial IKE SA may 
        be susceptible to an attacker equipped with a QC of a sufficient size. Such an attacker can store all the traffic 
        until it obtains such a QC and then decrypt it (i.e., Store Now Decrypt Later attack).
        See <span><a href="https://rfc-editor.org/rfc/rfc8784#section-6" class="relref">Section 6</a> of [<a href="#RFC8784" class="cite xref">RFC8784</a>]</span> for details.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">While the group keys are protected with PPK and thus are immune to QC, GCKS implementations that care about other data sent over initial IKE SA 
        <span class="bcp14">MUST</span> rely on IKEv2 extensions that protect even initial IKE SA against QC
        (like <span>[<a href="#RFC9867" class="cite xref">RFC9867</a>]</span>).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-6.3">
        <h3 id="name-aggregation-and-fragmentati">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-aggregation-and-fragmentati" class="section-name selfRef">Aggregation and Fragmentation Mode for ESP</a>
        </h3>
<p id="section-6.3-1">Aggregation and fragmentation mode for ESP is defined in <span>[<a href="#RFC9347" class="cite xref">RFC9347</a>]</span>. This mode allows IP packets to 
        be split over several ESP packets or several IP packets to be aggregated in a single ESP packet.
        This mode can only be used with ESP tunnel mode and relies on monotonically increasing sequence numbers
        in the incoming packets. Thus, it is impossible to use this mode for multi-sender multicast SAs.
        Since multicast Data-Security SAs are unidirectional, the congestion control feature of aggregation and fragmentation mode cannot be used.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2"> It is possible to use the aggregation and fragmentation mode without congestion control for a single-sender multicast ESP SA created in tunnel mode.
        GMs supporting this mode can send the USE_AGGFRAG notification in the registration request along with the SAg payload.
        If the Data-Security SA(s) to be installed on GMs uses the aggregation and fragmentation mode, the GCKS would indicate it by including 
        the USE_AGGFRAG notification along with the GSA payload in its response.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="gdoi_ext">
<section id="section-7">
      <h2 id="name-gdoi-protocol-extensions">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-gdoi-protocol-extensions" class="section-name selfRef">GDOI Protocol Extensions</a>
      </h2>
<p id="section-7-1"> Few extensions were defined for the GDOI protocol <span>[<a href="#RFC6407" class="cite xref">RFC6407</a>]</span>, like 
        GDOI Support for IEC 62351 Security Services <span>[<a href="#RFC8052" class="cite xref">RFC8052</a>]</span> or the GDOI GROUPKEY-PUSH Acknowledgement Message <span>[<a href="#RFC8263" class="cite xref">RFC8263</a>]</span>. 
        It is expected that these extensions will be redefined for G-IKEv2 in separate documents, if needed.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1"> When an entity joins the group and becomes a GM, it has to  
      trust that the GCKS only authorized entities that are admitted to the group and 
      has to trust that other GMs will not leak the information shared within the group.<a href="#section-8-1" class="pilcrow">¶</a></p>
<section id="section-8.1">
        <h3 id="name-gsa-registration-and-secure">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-gsa-registration-and-secure" class="section-name selfRef">GSA Registration and Secure Channel</a>
        </h3>
<p id="section-8.1-1">G-IKEv2 registration procedure uses IKEv2 initial exchanges,
 inheriting all the security considerations documented in <span><a href="https://rfc-editor.org/rfc/rfc7296#section-5" class="relref">Section 5</a> of [<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, including authentication, confidentiality, on-path attack
 protection, protection against replay/reflection attacks, and denial-
 of-service protection.  The GSA_REGISTRATION exchange
 also takes advantage of those protections.
        In addition, G-IKEv2 brings in the
        capability to authorize a particular GM regardless of
        whether they have the IKEv2 credentials.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-gsa-maintenance-channel">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-gsa-maintenance-channel" class="section-name selfRef">GSA Maintenance Channel</a>
        </h3>
<p id="section-8.2-1">The GSA maintenance channel is cryptographically and integrity
        protected using the cryptographic algorithm and key negotiated in the
        GSA member registration exchange.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<section id="section-8.2.1">
          <h4 id="name-authentication-authorizatio">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-authentication-authorizatio" class="section-name selfRef">Authentication/Authorization</a>
          </h4>
<p id="section-8.2.1-1">The authentication key is distributed during the GM registration 
          and the receiver of the rekey message uses that key to verify the message came 
          from the authorized GCKS.
An implicit authentication can also be used, in which case,
   the ability of the GM to decrypt and to verify ICV of 
   incoming messages is used as a proof that the sender
   knows group keys and therefore is a member of the group.
          However, implicit authentication doesn't provide source origin authentication, so the GM cannot be sure
          that the message came from the GCKS. For this reason, using implicit
          authentication is <span class="bcp14">NOT RECOMMENDED</span>
          unless used with a small group of trusted parties.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2.2">
          <h4 id="name-confidentiality">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-confidentiality" class="section-name selfRef">Confidentiality</a>
          </h4>
<p id="section-8.2.2-1">Confidentiality is provided by distributing a confidentiality key
          as part of the GSA member registration exchange.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2.3">
          <h4 id="name-on-path-attack-protection">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-on-path-attack-protection" class="section-name selfRef">On-Path Attack Protection</a>
          </h4>
<p id="section-8.2.3-1">The GSA maintenance channel is integrity protected by using a digital
          signature.<a href="#section-8.2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2.4">
          <h4 id="name-replay-reflection-attack-pr">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-replay-reflection-attack-pr" class="section-name selfRef">Replay/Reflection Attack Protection</a>
          </h4>
<p id="section-8.2.4-1">The GSA_REKEY message includes a monotonically increasing
          sequence number to protect against replay and reflection attacks. A
          GM will recognize a replayed message by comparing the
          Message ID number to that of the last received rekey message. Any
          rekey message containing a Message ID number less than or equal to
          the last received value <span class="bcp14">MUST</span> be discarded. Implementations should
          keep a record of recently received GSA rekey messages for this
          comparison.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
<p id="section-8.2.4-2">The strict role separation between the GCKS and the GMs and, as a consequence, 
          the limitation for a Rekey SA to be outbound/inbound only, helps to prevent reflection attack.<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-new-registries">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-new-registries" class="section-name selfRef">New Registries</a>
        </h3>
<p id="section-9.1-1">Per this document, new registries have been created for G-IKEv2 under the "Internet Key Exchange Version 2 (IKEv2) Parameters" registry group <span>[<a href="#IKEV2-IANA" class="cite xref">IKEV2-IANA</a>]</span>. The terms
        Reserved, Expert Review, and Private Use are as defined
        in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.1-2">
        <li id="section-9.1-2.1">
            <p id="section-9.1-2.1.1">IANA has created the "Transform Type 13 - Key Wrap Algorithm Transform IDs" registry.
The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial values of the registry are as follows:<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
              <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Key Wrap Algorithm</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">KW_5649_128</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">KW_5649_192</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">KW_5649_256</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4</td>
                  <td class="text-left" rowspan="1" colspan="1">KW_ARX</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">5-1023</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1024-65535</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">IANA has created the "Transform Type
            14 - Group Controller Authentication Method Transform
            IDs" registry. The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  The initial values of the registry are as follows:<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
              <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Group Controller Authentication Method</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Implicit</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">Digital Signature</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3-1023</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1024-65535</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.1-2.3">
            <p id="section-9.1-2.3.1">IANA has created the "Group SA Attributes" registry.  The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial values of the registry are as follows:<a href="#section-9.1-2.3.1" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
              <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Group SA Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                  <th class="text-left" rowspan="1" colspan="1">Used in Protocol</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_KEY_LIFETIME</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE, AH, ESP</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_INITIAL_MESSAGE_ID</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_NEXT_SPI</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">YES</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE, AH, ESP</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4-16383</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16384-32767</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">IANA has created the "Group-Wide Policy Attributes" registry. The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial values of the registry are as follows:<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
              <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">GW Policy Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_ATD</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_DTD</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">GWP_SENDER_ID_BITS</td>
                  <td class="text-left" rowspan="1" colspan="1">TV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4-16383</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16384-32767</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.1-2.5">
            <p id="section-9.1-2.5.1">IANA has created the "Group Key Bag Attributes" registry. The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial values of the registry are as follows:<a href="#section-9.1-2.5.1" class="pilcrow">¶</a></p>
<table class="center" id="table-15">
              <caption><a href="#table-15" class="selfRef">Table 15</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Group Key Bag Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                  <th class="text-left" rowspan="1" colspan="1">Used in Protocol</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">SA_KEY</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">YES<br>NO</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE<br>AH, ESP</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2-16383</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16384-32767</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                  <td class="text-left" rowspan="1" colspan="3"></td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.1-2.6">
            <p id="section-9.1-2.6.1">IANA has created the "Member Key Bag Attributes" registry. The registration policy for this registry is Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial values of the registry are as follows:<a href="#section-9.1-2.6.1" class="pilcrow">¶</a></p>
<table class="center" id="table-16">
              <caption><a href="#table-16" class="selfRef">Table 16</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Member Key Bag Attributes</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                  <th class="text-left" rowspan="1" colspan="1">Multi-Valued</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">WRAP_KEY</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">YES</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">AUTH_KEY</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">NO</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">GM_SENDER_ID</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                  <td class="text-left" rowspan="1" colspan="1">YES</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4-16383</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16384-32767</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
                  <td class="text-left" rowspan="1" colspan="2"></td>
                </tr>
              </tbody>
            </table>
</li>
        </ol>
<section id="section-9.1.1">
          <h4 id="name-guidance-for-designated-exp">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-guidance-for-designated-exp" class="section-name selfRef">Guidance for Designated Experts</a>
          </h4>
<p id="section-9.1.1-1"> In all cases of Expert Review described in this section,
           the designated expert (DE) is expected to ascertain the existence of suitable
           documentation (a specification) as described in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> and 
           verify that the document is permanently and publicly available.  The
           DE is also expected to check the clarity of purpose and use of the
           requested code points. Lastly, the DE must verify that any specification produced outside the IETF does not
           conflict with work that is active or already published within the IETF.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-9.2">
        <h3 id="name-changes-in-the-existing-ike">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-changes-in-the-existing-ike" class="section-name selfRef">Changes in the Existing IKEv2 Registries</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-9.2-1">
          <li id="section-9.2-1.1">
            <p id="section-9.2-1.1.1">In the "IKEv2 Exchange Types" registry, IANA has updated the references for the following entries to point to this document and has registered "GSA_INBAND_REKEY":<a href="#section-9.2-1.1.1" class="pilcrow">¶</a></p>
<table class="center" id="table-17">
              <caption><a href="#table-17" class="selfRef">Table 17</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Exchange Type</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">39</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_AUTH</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">40</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_REGISTRATION</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">41</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_REKEY</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">42</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA_INBAND_REKEY</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.2">
            <p id="section-9.2-1.2.1">In the "IKEv2 Payload Types" registry, IANA has listed this document as a reference for the following entries:<a href="#section-9.2-1.2.1" class="pilcrow">¶</a></p>
<table class="center" id="table-18">
              <caption><a href="#table-18" class="selfRef">Table 18</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Next Payload Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Notation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">50</td>
                  <td class="text-left" rowspan="1" colspan="1">Group Identification</td>
                  <td class="text-left" rowspan="1" colspan="1">IDg</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">51</td>
                  <td class="text-left" rowspan="1" colspan="1">Group Security Association</td>
                  <td class="text-left" rowspan="1" colspan="1">GSA</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">52</td>
                  <td class="text-left" rowspan="1" colspan="1">Key Download</td>
                  <td class="text-left" rowspan="1" colspan="1">KD</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.3">
            <p id="section-9.2-1.3.1">In the "IKEv2 Payload Types" registry, IANA has updated the definition of Payload Type 33 and added a reference to this document as follows:<a href="#section-9.2-1.3.1" class="pilcrow">¶</a></p>
<table class="center" id="table-19">
              <caption><a href="#table-19" class="selfRef">Table 19</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Next Payload Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Notation</th>
                  <th class="text-left" rowspan="1" colspan="1">Reference</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="2" colspan="1">33</td>
                  <td class="text-left" rowspan="1" colspan="1">Security Association</td>
                  <td class="text-left" rowspan="1" colspan="1">SA</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>
</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Security Association - GM Supported Transforms</td>
                  <td class="text-left" rowspan="1" colspan="1">SAg</td>
                  <td class="text-left" rowspan="1" colspan="1">RFC 9838</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.4">
            <p id="section-9.2-1.4.1">In the "Transform Type Values" registry, IANA has made the following changes:<a href="#section-9.2-1.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-1.4.2.1">Registered "Key Wrap Algorithm (KWA)" and "Group Controller Authentication Method (GCAUTH)".<a href="#section-9.2-1.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2-1.4.2.2">
                <p id="section-9.2-1.4.2.2.1">Updated the "Used In" column for values 1 and 3 and listed this document as an additional reference.<a href="#section-9.2-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<table class="center" id="table-20">
              <caption><a href="#table-20" class="selfRef">Table 20</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                  <th class="text-left" rowspan="1" colspan="1">Used In</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Encryption Algorithm (ENCR)</td>
                  <td class="text-left" rowspan="1" colspan="1">(IKE, GIKE_UPDATE, ESP)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">Integrity Algorithm (INTEG)</td>
                  <td class="text-left" rowspan="1" colspan="1">(IKE, GIKE_UPDATE, AH, optional in ESP)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">13</td>
                  <td class="text-left" rowspan="1" colspan="1">Key Wrap Algorithm (KWA)</td>
                  <td class="text-left" rowspan="1" colspan="1">(IKE, GIKE_UPDATE)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">14</td>
                  <td class="text-left" rowspan="1" colspan="1">Group Controller Authentication Method (GCAUTH)</td>
                  <td class="text-left" rowspan="1" colspan="1">(GIKE_UPDATE)</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.5">
            <p id="section-9.2-1.5.1">In the "IKEv2 Transform Attribute Types" registry, IANA has added the following entry:<a href="#section-9.2-1.5.1" class="pilcrow">¶</a></p>
<table class="center" id="table-21">
              <caption><a href="#table-21" class="selfRef">Table 21</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Attribute Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Format</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">18</td>
                  <td class="text-left" rowspan="1" colspan="1">Signature Algorithm Identifier</td>
                  <td class="text-left" rowspan="1" colspan="1">TLV</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.6">
            <p id="section-9.2-1.6.1">In the "Transform Type 5 - Sequence Numbers Transform IDs" registry, IANA has added the following entry:<a href="#section-9.2-1.6.1" class="pilcrow">¶</a></p>
<table class="center" id="table-22">
              <caption><a href="#table-22" class="selfRef">Table 22</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Number</th>
                  <th class="text-left" rowspan="1" colspan="1">Name</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">32-bit Unspecified Numbers</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.7">
            <p id="section-9.2-1.7.1">In the "IKEv2 Notify Message Error Types" registry, IANA has made the following changes:<a href="#section-9.2-1.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-1.7.2.1">Registered "REGISTRATION_FAILED".<a href="#section-9.2-1.7.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2-1.7.2.2">Updated the references for "INVALID_GROUP_ID" and "AUTHORIZATION_FAILED" to point to this document.<a href="#section-9.2-1.7.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<table class="center" id="table-23">
              <caption><a href="#table-23" class="selfRef">Table 23</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Notify Message Error Type</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">45</td>
                  <td class="text-left" rowspan="1" colspan="1">INVALID_GROUP_ID</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">46</td>
                  <td class="text-left" rowspan="1" colspan="1">AUTHORIZATION_FAILED</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">49</td>
                  <td class="text-left" rowspan="1" colspan="1">REGISTRATION_FAILED</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.8">
            <p id="section-9.2-1.8.1">An earlier draft of this document <span>[<a href="#I-D.yeung-g-ikev2" class="cite xref">G-IKEV2</a>]</span> registered the Notify
   type 16429 in the "IKEv2 Notify Message Status Types" registry with 
   the name SENDER_REQUEST_ID. Per this document,
   IANA has renamed it as follows:<a href="#section-9.2-1.8.1" class="pilcrow">¶</a></p>
<table class="center" id="table-24">
              <caption><a href="#table-24" class="selfRef">Table 24</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Notify Message Status Type</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">16429</td>
                  <td class="text-left" rowspan="1" colspan="1">GROUP_SENDER</td>
                </tr>
              </tbody>
            </table>
</li>
          <li id="section-9.2-1.9">
            <p id="section-9.2-1.9.1">In the "IKEv2 Security Protocol Identifiers" registry, IANA has added the following entry:<a href="#section-9.2-1.9.1" class="pilcrow">¶</a></p>
<table class="center" id="table-25">
              <caption><a href="#table-25" class="selfRef">Table 25</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Protocol ID</th>
                  <th class="text-left" rowspan="1" colspan="1">Protocol</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">6</td>
                  <td class="text-left" rowspan="1" colspan="1">GIKE_UPDATE</td>
                </tr>
              </tbody>
            </table>
</li>
        </ol>
</section>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4302">[RFC4302]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Authentication Header"</span>, <span class="seriesInfo">RFC 4302</span>, <span class="seriesInfo">DOI 10.17487/RFC4302</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4302">https://www.rfc-editor.org/info/rfc4302</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6054">[RFC6054]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">B. Weis</span>, <span class="refTitle">"Using Counter Modes with Encapsulating Security Payload (ESP) and Authentication Header (AH) to Protect Group Traffic"</span>, <span class="seriesInfo">RFC 6054</span>, <span class="seriesInfo">DOI 10.17487/RFC6054</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6054">https://www.rfc-editor.org/info/rfc6054</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7427">[RFC7427]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span> and <span class="refAuthor">J. Snyder</span>, <span class="refTitle">"Signature Authentication in the Internet Key Exchange Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 7427</span>, <span class="seriesInfo">DOI 10.17487/RFC7427</span>, <time datetime="2015-01" class="refDate">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7427">https://www.rfc-editor.org/info/rfc7427</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9827">[RFC9827]</dt>
      <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Renaming the Extended Sequence Numbers (ESN) Transform Type in the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 9827</span>, <span class="seriesInfo">DOI 10.17487/RFC9827</span>, <time datetime="2025-11" class="refDate">November 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9827">https://www.rfc-editor.org/info/rfc9827</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ARX-KW">[ARX-KW]</dt>
        <dd>
<span class="refAuthor">Shinichi, S.</span>, <span class="refTitle">"ARX-KW, a family of key wrapping constructions using SipHash and ChaCha"</span>, <span class="refContent">Cryptology ePrint Archive, Paper 2020/059</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/059.pdf">https://eprint.iacr.org/2020/059.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.yeung-g-ikev2">[G-IKEV2]</dt>
        <dd>
<span class="refAuthor">Rowles, S.</span>, <span class="refAuthor">Yeung, A.</span>, <span class="refAuthor">Tran, P.</span>, and <span class="refAuthor">Y. Nir</span>, <span class="refTitle">"Group Key Management using IKEv2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yeung-g-ikev2-07</span>, <time datetime="2013-11-05" class="refDate">5 November 2013</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-yeung-g-ikev2-07">https://datatracker.ietf.org/doc/html/draft-yeung-g-ikev2-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEV2-IANA">[IKEV2-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Internet Key Exchange Version 2 (IKEv2) Parameters"</span>, <span>&lt;<a href="http://www.iana.org/assignments/ikev2-parameters">http://www.iana.org/assignments/ikev2-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NNL">[NNL]</dt>
        <dd>
<span class="refAuthor">Naor, D.</span>, <span class="refAuthor">Naor, M.</span>, and <span class="refAuthor">J. Lotspiech</span>, <span class="refTitle">"Revocation and Tracing Schemes for Stateless Receivers"</span>, <span class="refContent">Advances in Cryptology - CRYPTO 2001, Lecture Notes in Computer Science, vol. 2139, pp. 41-62</span>, <span class="seriesInfo">DOI 10.1007/3-540-44647-8_3</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="http://www.wisdom.weizmann.ac.il/~naor/PAPERS/2nl.pdf">http://www.wisdom.weizmann.ac.il/~naor/PAPERS/2nl.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OFT">[OFT]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">A. Sherman</span>, <span class="refTitle">"Key Establishment in Large Dynamic Groups Using One-Way Function Trees"</span>, <span class="refContent">IEEE Transactions on Software Engineering, vol. 29, no. 5, pp. 444-458</span>, <span class="seriesInfo">DOI 10.1109/TSE.2003.1199073</span>, <time datetime="1998-05" class="refDate">May 1998</time>, <span>&lt;<a href="https://pdfs.semanticscholar.org/d24c/7b41f7bcc2b6690e1b4d80eaf8c3e1cc5ee5.pdf">https://pdfs.semanticscholar.org/d24c/7b41f7bcc2b6690e1b4d80eaf8c3e1cc5ee5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2409">[RFC2409]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span> and <span class="refAuthor">D. Carrel</span>, <span class="refTitle">"The Internet Key Exchange (IKE)"</span>, <span class="seriesInfo">RFC 2409</span>, <span class="seriesInfo">DOI 10.17487/RFC2409</span>, <time datetime="1998-11" class="refDate">November 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2409">https://www.rfc-editor.org/info/rfc2409</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2627">[RFC2627]</dt>
        <dd>
<span class="refAuthor">Wallner, D.</span>, <span class="refAuthor">Harder, E.</span>, and <span class="refAuthor">R. Agee</span>, <span class="refTitle">"Key Management for Multicast: Issues and Architectures"</span>, <span class="seriesInfo">RFC 2627</span>, <span class="seriesInfo">DOI 10.17487/RFC2627</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2627">https://www.rfc-editor.org/info/rfc2627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3686">[RFC3686]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 3686</span>, <span class="seriesInfo">DOI 10.17487/RFC3686</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3740">[RFC3740]</dt>
        <dd>
<span class="refAuthor">Hardjono, T.</span> and <span class="refAuthor">B. Weis</span>, <span class="refTitle">"The Multicast Group Security Architecture"</span>, <span class="seriesInfo">RFC 3740</span>, <span class="seriesInfo">DOI 10.17487/RFC3740</span>, <time datetime="2004-03" class="refDate">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3740">https://www.rfc-editor.org/info/rfc3740</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3948">[RFC3948]</dt>
        <dd>
<span class="refAuthor">Huttunen, A.</span>, <span class="refAuthor">Swander, B.</span>, <span class="refAuthor">Volpe, V.</span>, <span class="refAuthor">DiBurro, L.</span>, and <span class="refAuthor">M. Stenberg</span>, <span class="refTitle">"UDP Encapsulation of IPsec ESP Packets"</span>, <span class="seriesInfo">RFC 3948</span>, <span class="seriesInfo">DOI 10.17487/RFC3948</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3948">https://www.rfc-editor.org/info/rfc3948</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4046">[RFC4046]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span>, <span class="refAuthor">Canetti, R.</span>, <span class="refAuthor">Dondeti, L.</span>, and <span class="refAuthor">F. Lindholm</span>, <span class="refTitle">"Multicast Security (MSEC) Group Key Management Architecture"</span>, <span class="seriesInfo">RFC 4046</span>, <span class="seriesInfo">DOI 10.17487/RFC4046</span>, <time datetime="2005-04" class="refDate">April 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4046">https://www.rfc-editor.org/info/rfc4046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4106">[RFC4106]</dt>
        <dd>
<span class="refAuthor">Viega, J.</span> and <span class="refAuthor">D. McGrew</span>, <span class="refTitle">"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4106</span>, <span class="seriesInfo">DOI 10.17487/RFC4106</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4106">https://www.rfc-editor.org/info/rfc4106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4309">[RFC4309]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4309</span>, <span class="seriesInfo">DOI 10.17487/RFC4309</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4309">https://www.rfc-editor.org/info/rfc4309</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4543">[RFC4543]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span> and <span class="refAuthor">J. Viega</span>, <span class="refTitle">"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"</span>, <span class="seriesInfo">RFC 4543</span>, <span class="seriesInfo">DOI 10.17487/RFC4543</span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4543">https://www.rfc-editor.org/info/rfc4543</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5374">[RFC5374]</dt>
        <dd>
<span class="refAuthor">Weis, B.</span>, <span class="refAuthor">Gross, G.</span>, and <span class="refAuthor">D. Ignjatic</span>, <span class="refTitle">"Multicast Extensions to the Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 5374</span>, <span class="seriesInfo">DOI 10.17487/RFC5374</span>, <time datetime="2008-11" class="refDate">November 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5374">https://www.rfc-editor.org/info/rfc5374</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5649">[RFC5649]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span> and <span class="refAuthor">M. Dworkin</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm"</span>, <span class="seriesInfo">RFC 5649</span>, <span class="seriesInfo">DOI 10.17487/RFC5649</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5649">https://www.rfc-editor.org/info/rfc5649</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5685">[RFC5685]</dt>
        <dd>
<span class="refAuthor">Devarapalli, V.</span> and <span class="refAuthor">K. Weniger</span>, <span class="refTitle">"Redirect Mechanism for the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 5685</span>, <span class="seriesInfo">DOI 10.17487/RFC5685</span>, <time datetime="2009-11" class="refDate">November 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5685">https://www.rfc-editor.org/info/rfc5685</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5723">[RFC5723]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption"</span>, <span class="seriesInfo">RFC 5723</span>, <span class="seriesInfo">DOI 10.17487/RFC5723</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5723">https://www.rfc-editor.org/info/rfc5723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5998">[RFC5998]</dt>
        <dd>
<span class="refAuthor">Eronen, P.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">Y. Sheffer</span>, <span class="refTitle">"An Extension for EAP-Only Authentication in IKEv2"</span>, <span class="seriesInfo">RFC 5998</span>, <span class="seriesInfo">DOI 10.17487/RFC5998</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5998">https://www.rfc-editor.org/info/rfc5998</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6407">[RFC6407]</dt>
        <dd>
<span class="refAuthor">Weis, B.</span>, <span class="refAuthor">Rowles, S.</span>, and <span class="refAuthor">T. Hardjono</span>, <span class="refTitle">"The Group Domain of Interpretation"</span>, <span class="seriesInfo">RFC 6407</span>, <span class="seriesInfo">DOI 10.17487/RFC6407</span>, <time datetime="2011-10" class="refDate">October 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6407">https://www.rfc-editor.org/info/rfc6407</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6467">[RFC6467]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span>, <span class="refTitle">"Secure Password Framework for Internet Key Exchange Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 6467</span>, <span class="seriesInfo">DOI 10.17487/RFC6467</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6467">https://www.rfc-editor.org/info/rfc6467</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7383">[RFC7383]</dt>
        <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Message Fragmentation"</span>, <span class="seriesInfo">RFC 7383</span>, <span class="seriesInfo">DOI 10.17487/RFC7383</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7383">https://www.rfc-editor.org/info/rfc7383</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7634">[RFC7634]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span>, <span class="refTitle">"ChaCha20, Poly1305, and Their Use in the Internet Key Exchange Protocol (IKE) and IPsec"</span>, <span class="seriesInfo">RFC 7634</span>, <span class="seriesInfo">DOI 10.17487/RFC7634</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7634">https://www.rfc-editor.org/info/rfc7634</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8052">[RFC8052]</dt>
        <dd>
<span class="refAuthor">Weis, B.</span>, <span class="refAuthor">Seewald, M.</span>, and <span class="refAuthor">H. Falk</span>, <span class="refTitle">"Group Domain of Interpretation (GDOI) Protocol Support for IEC 62351 Security Services"</span>, <span class="seriesInfo">RFC 8052</span>, <span class="seriesInfo">DOI 10.17487/RFC8052</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8052">https://www.rfc-editor.org/info/rfc8052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8263">[RFC8263]</dt>
        <dd>
<span class="refAuthor">Weis, B.</span>, <span class="refAuthor">Mangla, U.</span>, <span class="refAuthor">Karl, T.</span>, and <span class="refAuthor">N. Maheshwari</span>, <span class="refTitle">"Group Domain of Interpretation (GDOI) GROUPKEY-PUSH Acknowledgement Message"</span>, <span class="seriesInfo">RFC 8263</span>, <span class="seriesInfo">DOI 10.17487/RFC8263</span>, <time datetime="2017-11" class="refDate">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8263">https://www.rfc-editor.org/info/rfc8263</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8750">[RFC8750]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">Y. Nir</span>, <span class="refTitle">"Implicit Initialization Vector (IV) for Counter-Based Ciphers in Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 8750</span>, <span class="seriesInfo">DOI 10.17487/RFC8750</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8750">https://www.rfc-editor.org/info/rfc8750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8784">[RFC8784]</dt>
        <dd>
<span class="refAuthor">Fluhrer, S.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">McGrew, D.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Mixing Preshared Keys in the Internet Key Exchange Protocol Version 2 (IKEv2) for Post-quantum Security"</span>, <span class="seriesInfo">RFC 8784</span>, <span class="seriesInfo">DOI 10.17487/RFC8784</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8784">https://www.rfc-editor.org/info/rfc8784</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9242">[RFC9242]</dt>
        <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Intermediate Exchange in the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 9242</span>, <span class="seriesInfo">DOI 10.17487/RFC9242</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9242">https://www.rfc-editor.org/info/rfc9242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9329">[RFC9329]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span> and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"TCP Encapsulation of Internet Key Exchange Protocol (IKE) and IPsec Packets"</span>, <span class="seriesInfo">RFC 9329</span>, <span class="seriesInfo">DOI 10.17487/RFC9329</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9329">https://www.rfc-editor.org/info/rfc9329</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9347">[RFC9347]</dt>
        <dd>
<span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"Aggregation and Fragmentation Mode for Encapsulating Security Payload (ESP) and Its Use for IP Traffic Flow Security (IP-TFS)"</span>, <span class="seriesInfo">RFC 9347</span>, <span class="seriesInfo">DOI 10.17487/RFC9347</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9347">https://www.rfc-editor.org/info/rfc9347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9370">[RFC9370]</dt>
        <dd>
<span class="refAuthor">Tjhai, CJ.</span>, <span class="refAuthor">Tomlinson, M.</span>, <span class="refAuthor">Bartlett, G.</span>, <span class="refAuthor">Fluhrer, S.</span>, <span class="refAuthor">Van Geest, D.</span>, <span class="refAuthor">Garcia-Morchon, O.</span>, and <span class="refAuthor">V. Smyslov</span>, <span class="refTitle">"Multiple Key Exchanges in the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 9370</span>, <span class="seriesInfo">DOI 10.17487/RFC9370</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9370">https://www.rfc-editor.org/info/rfc9370</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9867">[RFC9867]</dt>
      <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Mixing Preshared Keys in the IKE_INTERMEDIATE and CREATE_CHILD_SA Exchanges of the Internet Key Exchange Protocol Version 2 (IKEv2) for Post-Quantum Security"</span>, <span class="seriesInfo">RFC 9867</span>, <span class="seriesInfo">DOI 10.17487/RFC9867</span>, <time datetime="2025-11" class="refDate">November 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9867">https://www.rfc-editor.org/info/rfc9867</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="lkh_key_management">
<section id="appendix-A">
      <h2 id="name-use-of-lkh-in-g-ikev2">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-use-of-lkh-in-g-ikev2" class="section-name selfRef">Use of LKH in G-IKEv2</a>
      </h2>
<p id="appendix-A-1"><span><a href="https://rfc-editor.org/rfc/rfc2627#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC2627" class="cite xref">RFC2627</a>]</span> describes the LKH
      architecture and how a GCKS uses LKH to exclude GMs. This
      section clarifies how the LKH architecture is used with G-IKEv2.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="lkh_notation">
<section id="appendix-A.1">
        <h3 id="name-notation">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="appendix-A.1-1">In this section, we will use the notation X{Y}, 
        where a key with ID Y is encrypted with the key with ID X.
        The notation GSK_w{Y} means that the default wrap key GSK_w (with zero KWK ID)is used 
        to encrypt key Y, and the notation X{K_sa} means key X is used 
        to encrypt the SA key K_sa (which always has a Key ID of zero). Note that GSK_w{K_sa} means that
        the SA key is encrypted with the default wrap key, in which case, both KWK ID and Key ID are zero.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">The content of the KD payload will be shown as a sequence
        of key bags. The Group Key Bag substructure will be denoted as GP(SAn)()
        when n is an SPI for the SA and the Member Key Bag substructure
        will be denoted as MP(). The content of the key bags 
        is shown as SA_KEY and WRAP_KEY attributes with the notation
        described above. For simplicity, the type of the attribute will not be shown
        because it is implicitly defined by the type of key bag.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Below is the example of a KD payload:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<span id="name-example-of-a-kd-payload"></span><figure id="figure-21">
          <div class="alignLeft art-text artwork" id="appendix-A.1-4.1">
<pre>
KD(GP(SA1)(X{K_sa}),MP(Y{X},Z{Y},GSK_w{Z})
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-example-of-a-kd-payload" class="selfRef">Example of a KD Payload</a>
          </figcaption></figure>
<p id="appendix-A.1-5">
        For simplicity, any other attributes in the KD payload are omitted.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6">We will also use the notation X-&gt;Y-&gt;Z
        to describe the Key Path. In this case, key Y is needed to decrypt key X and key Z is needed to decrypt key Y.
        In the example above, the keys had the following relation: K_sa-&gt;X-&gt;Y-&gt;Z-&gt;GSK_w.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<section id="appendix-A.2">
        <h3 id="name-group-creation">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-group-creation" class="section-name selfRef">Group Creation</a>
        </h3>
<p id="appendix-A.2-1">When a GCKS forms a group, it creates a key tree as shown in
        <a href="#initial-tree" class="auto internal xref">Figure 22</a>. The key tree contains logical keys (which are represented as
        the values of their Key IDs in the figure) and a private key shared with only a single GM
        (the GMs are represented as letters followed by the corresponding 
        key ID in parentheses in the figure). The root of the tree contains the
        multicast Rekey SA key (which is represented as SAn(K_san). The figure below assumes that the Key IDs
        are assigned sequentially; this is not a requirement and only used
        for illustrative purposes. The GCKS may create a complete tree as shown or a partial tree, which is
        created on demand as members join the group.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-lkh-tree"></span><div id="initial-tree">
<figure id="figure-22">
          <div class="alignLeft art-text artwork" id="appendix-A.2-2.1">
<pre>
                          SA1(K_sa1)
             +------------------------------+
             1                              2
     +---------------+              +---------------+
     3               4              5               6
 +-------+       +-------+      +--------+      +--------+
A(7)    B(8)    C(9)   D(10)  E(11)    F(12)  G(13)    H(14)
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-initial-lkh-tree" class="selfRef">Initial LKH Tree</a>
          </figcaption></figure>
</div>
<p id="appendix-A.2-3">When GM A joins the group, the GCKS provides it
        with the keys in the KD payload of the GSA_AUTH or
        GSA_REGISTRATION exchange. Given the tree shown in figure above, the
        KD payload will be:<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<span id="name-kd-payload-for-the-group-me"></span><figure id="figure-23">
          <div class="alignLeft art-text artwork" id="appendix-A.2-4.1">
<pre>
KD(GP(SA1)(1{K_sa1}),MP(3{1},7{3},GSK_w{7})
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-kd-payload-for-the-group-me" class="selfRef">KD Payload for the Group Member A</a>
          </figcaption></figure>
<p id="appendix-A.2-5">

        From these attributes, the GM A will construct 
        the Key Path K_sa1-&gt;1-&gt;3-&gt;7-&gt;GSK_w. Since it
        ends up with GSK_w, it will use all the WRAP_KEY attributes 
        present in the path as its Working Key Path: 1-&gt;3-&gt;7.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2-6">Similarly, when other GMs join the group, they will be
  provided with the corresponding keys and thus the GMs
  will have the following Working Key Paths:<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<span id="name-key-paths-for-all-gms"></span><figure id="figure-24">
          <div class="alignLeft art-text artwork" id="appendix-A.2-7.1">
<pre>
A: 1-&gt;3-&gt;7      B: 1-&gt;3-&gt;8      C: 1-&gt;4-&gt;9,     D: 1-&gt;4-&gt;10
E: 2-&gt;5-&gt;11     F: 2-&gt;5-&gt;12     G: 2-&gt;6-&gt;13     H: 2-&gt;6-&gt;14
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-key-paths-for-all-gms" class="selfRef">Key Paths for all GMs</a>
          </figcaption></figure>
</section>
<section id="appendix-A.3">
        <h3 id="name-simple-group-sa-rekey">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-simple-group-sa-rekey" class="section-name selfRef">Simple Group SA Rekey</a>
        </h3>
<p id="appendix-A.3-1">If the GCKS performs a simple SA rekey without changing group membership,
        it will only send a Group Key Bag in the KD payload with a new
        SA key encrypted with the default KWK.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<span id="name-kd-payload-for-the-simple-g"></span><figure id="figure-25">
          <div class="alignLeft art-text artwork" id="appendix-A.3-2.1">
<pre>
KD(GP(SA2)(GSK_w{K_sa2}))
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-kd-payload-for-the-simple-g" class="selfRef">KD Payload for the Simple Group SA Rekey</a>
          </figcaption></figure>
<p id="appendix-A.3-3">
        All the GMs will be able to decrypt it and no changes in their Working Key Paths will happen.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.4">
        <h3 id="name-group-member-exclusion">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-group-member-exclusion" class="section-name selfRef">Group Member Exclusion</a>
        </h3>
<p id="appendix-A.4-1">If the GCKS has reason to believe that a GM should be excluded,
        then it can do so by sending a GSA_REKEY message that includes a set
        of GM_KEY attributes, which would allow all GMs, except for the excluded one, 
        to get a new SA key.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">In the example below, the GCKS excludes GM F. For this purpose,
        it changes the key tree as follows, replacing key 2 with key 15 and
        key 5 with key 16. It also generates a new SA key for a new SA3.<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<span id="name-lkh-tree-after-f-has-been-e"></span><div id="updated-tree">
<figure id="figure-26">
          <div class="alignLeft art-text artwork" id="appendix-A.4-3.1">
<pre>
                          SA3(K_sa3)
             +------------------------------+
             1                             15
     +---------------+              +---------------+
     3               4             16               6
 +-------+       +-------+      +----           +--------+
A(7)    B(8)    C(9)   D(10)  E(11)    F(12)  G(13)    H(14)
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-lkh-tree-after-f-has-been-e" class="selfRef">LKH Tree after F Has Been Excluded</a>
          </figcaption></figure>
</div>
<p id="appendix-A.4-4">Then it sends the following KD payload for the new Rekey SA3:<a href="#appendix-A.4-4" class="pilcrow">¶</a></p>
<span id="name-kd-payload-for-the-group-mem"></span><figure id="figure-27">
          <div class="alignLeft art-text artwork" id="appendix-A.4-5.1">
<pre>
KD(GP(SA3)(1{K_sa3},15{K_sa3}),MP(6{15},16{15},11{16})
</pre>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-kd-payload-for-the-group-mem" class="selfRef">KD Payload for the Group Member F</a>
          </figcaption></figure>
<p id="appendix-A.4-6">
        While processing this KD payload:<a href="#appendix-A.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.4-7.1">
            <p id="appendix-A.4-7.1.1">GMs A, B, C, and D will be able to decrypt the SA_KEY attribute 1{K_sa3} by using
          the "1" key from their key path. Since no new GM_KEY attributes are in the new 
          Key Path, they won't update their Working Key Paths.<a href="#appendix-A.4-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-7.2">
            <p id="appendix-A.4-7.2.1">GMs G and H will construct new Key Path 15-&gt;6 and will be able to decrypt
          the intermediate key 15 using key 6 from their Working Key Paths. So, they will
          update their Working Key Paths replacing their beginnings up to key 6 
          with the new Key Path (thus replacing the key 2 with the key 15).<a href="#appendix-A.4-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-7.3">
            <p id="appendix-A.4-7.3.1">GM E will construct a new Key Path 16-&gt;15-&gt;11 and will be able to decrypt
          the intermediate key 16 using key 11 from its Working Key Path. So, it will
          update its Working Key Path replacing its beginnings up to key 11 
          with the new Key Path (thus replacing key 2 with key 15 and key 5 with key 16).<a href="#appendix-A.4-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.4-7.4">
            <p id="appendix-A.4-7.4.1">GM F won't be able to construct any Key Path leading to any key it possesses,
          so it will be unable to decrypt the new SA key for the SA3. Thus, it will be excluded
          from the group once the SA3 is used.<a href="#appendix-A.4-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.4-8">Finally, the GMs will have the following Working Key Paths:<a href="#appendix-A.4-8" class="pilcrow">¶</a></p>
<span id="name-key-paths-for-all-gms-after"></span><figure id="figure-28">
          <div class="alignLeft art-text artwork" id="appendix-A.4-9.1">
<pre>
A: 1-&gt;3-&gt;7      B: 1-&gt;3-&gt;8      C: 1-&gt;4-&gt;9,     D: 1-&gt;4-&gt;10
E: 15-&gt;16-&gt;11   F: excluded     G: 15-&gt;6-&gt;13    H: 15-&gt;6-&gt;14
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-key-paths-for-all-gms-after" class="selfRef">Key Paths for all GMs after Exclusion of a GM</a>
          </figcaption></figure>
</section>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors thank <span class="contact-name">Lakshminath Dondeti</span> and
      <span class="contact-name">Jing Xiang</span> for first exploring the use of IKEv2
      for group key management and providing the basis behind the
      protocol. <span class="contact-name">Mike Sullenberger</span> and <span class="contact-name">Amjad Inamdar</span> were instrumental in helping resolve many
      issues in several draft versions of the document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The authors are grateful to <span class="contact-name">Tero Kivinen</span>,
      <span class="contact-name">Daniel Migault</span>, <span class="contact-name">Gorry       Fairhurst</span>, <span class="contact-name">Robert Sparks</span>, <span class="contact-name">Russ Housley</span>, and <span class="contact-name">Paul Wouters</span> for
      their careful reviews and valuable proposals for improving the document
      quality.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="appendix-C-1">The following individuals made substantial contributions to earlier
      draft versions of this document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sheela Rowles</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aldous Yeung</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cyyeung@cisco.com" class="email">cyyeung@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paulina Tran</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yoav Nir</span></div>
<div dir="auto" class="left"><span class="org">Dell EMC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ynir.ietf@gmail.com" class="email">ynir.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Valery Smyslov</span></div>
<div dir="auto" class="left"><span class="org">ELVIS-PLUS</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:svan@elvis.ru" class="email">svan@elvis.ru</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Weis</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bew.stds@gmail.com" class="email">bew.stds@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
