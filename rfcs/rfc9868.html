<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9868: Transport Options for UDP</title>
<meta content="Joe Touch" name="author">
<meta content="C. M. (Mike) Heard" name="author">
<meta content="
       Transport protocols are extended through the use of transport header
options. This document updates RFC 768 (UDP) by indicating the
location, syntax, and semantics for UDP transport layer options
within the surplus area after the end of the UDP user data but
before the end of the IP datagram. 
    " name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="example" name="keyword">
<meta content="9868" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9868.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://dx.doi.org/10.17487/rfc9868" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-udp-options-45" rel="prev">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9868</td>
<td class="center">Transport Options for UDP</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Touch &amp; Heard</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9868" class="eref">9868</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc768" class="eref">768</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10" class="published">October 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Touch</div>
<div class="org">Independent Consultant</div>
</div>
<div class="author">
      <div class="author-name">C. Heard, <span class="editor">Ed.</span>
</div>
<div class="org">Unaffiliated</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9868</h1>
<h1 id="title">Transport Options for UDP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Transport protocols are extended through the use of transport header
options. This document updates RFC 768 (UDP) by indicating the
location, syntax, and semantics for UDP transport layer options
within the surplus area after the end of the UDP user data but
before the end of the IP datagram.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9868">https://www.rfc-editor.org/info/rfc9868</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-used-in-this-do" class="internal xref">Conventions Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-udp-option-intended-uses" class="internal xref">UDP Option Intended Uses</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-udp-option-design-principle" class="internal xref">UDP Option Design Principles</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-the-udp-option-area" class="internal xref">The UDP Option Area</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-the-udp-surplus-area-struct" class="internal xref">The UDP Surplus Area Structure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-the-option-checksum-ocs" class="internal xref">The Option Checksum (OCS)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-udp-options" class="internal xref">UDP Options</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-safe-udp-options" class="internal xref">SAFE UDP Options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-end-of-options-list-eol" class="internal xref">End of Options List (EOL)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-no-operation-nop" class="internal xref">No Operation (NOP)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-additional-payload-checksum" class="internal xref">Additional Payload Checksum (APC)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-fragmentation-frag" class="internal xref">Fragmentation (FRAG)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-maximum-datagram-size-mds" class="internal xref">Maximum Datagram Size (MDS)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-maximum-reassembled-datagra" class="internal xref">Maximum Reassembled Datagram Size (MRDS)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#section-11.7" class="auto internal xref">11.7</a>.  <a href="#name-echo-request-req-and-echo-r" class="internal xref">Echo Request (REQ) and Echo Response (RES)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#section-11.8" class="auto internal xref">11.8</a>.  <a href="#name-timestamp-time" class="internal xref">Timestamp (TIME)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a href="#section-11.9" class="auto internal xref">11.9</a>.  <a href="#name-authentication-auth-reserve" class="internal xref">Authentication (AUTH), RESERVED Only</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.10">
                <p id="section-toc.1-1.11.2.10.1"><a href="#section-11.10" class="auto internal xref">11.10</a>. <a href="#name-experimental-exp" class="internal xref">Experimental (EXP)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-unsafe-options" class="internal xref">UNSAFE Options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-unsafe-compression-ucmp" class="internal xref">UNSAFE Compression (UCMP)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-unsafe-encryption-uenc" class="internal xref">UNSAFE Encryption (UENC)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-unsafe-experimental-uexp" class="internal xref">UNSAFE Experimental (UEXP)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-rules-for-designing-new-opt" class="internal xref">Rules for Designing New Options</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-option-inclusion-and-proces" class="internal xref">Option Inclusion and Processing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-udp-api-extensions" class="internal xref">UDP API Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-udp-options-are-for-transpo" class="internal xref">UDP Options Are for Transport, Not Transit</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-udp-options-vs-udp-lite" class="internal xref">UDP Options vs. UDP-Lite</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref">18</a>. <a href="#name-interactions-with-legacy-de" class="internal xref">Interactions with Legacy Devices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="auto internal xref">19</a>. <a href="#name-options-in-a-stateless-unre" class="internal xref">Options in a Stateless, Unreliable Transport Protocol</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-20" class="auto internal xref">20</a>. <a href="#name-udp-option-state-caching" class="internal xref">UDP Option State Caching</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-21" class="auto internal xref">21</a>. <a href="#name-updates-to-rfc-768" class="internal xref">Updates to RFC 768</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#section-22" class="auto internal xref">22</a>. <a href="#name-interactions-with-other-rfc" class="internal xref">Interactions with Other RFCs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#section-23" class="auto internal xref">23</a>. <a href="#name-multicast-and-broadcast-con" class="internal xref">Multicast and Broadcast Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#section-24" class="auto internal xref">24</a>. <a href="#name-network-management-consider" class="internal xref">Network Management Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#section-25" class="auto internal xref">25</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#section-25.1" class="auto internal xref">25.1</a>.  <a href="#name-general-considerations-rega" class="internal xref">General Considerations Regarding the Use of Options</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.2">
                <p id="section-toc.1-1.25.2.2.1"><a href="#section-25.2" class="auto internal xref">25.2</a>.  <a href="#name-considerations-regarding-on" class="internal xref">Considerations Regarding On-Path Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.3">
                <p id="section-toc.1-1.25.2.3.1"><a href="#section-25.3" class="auto internal xref">25.3</a>.  <a href="#name-considerations-regarding-op" class="internal xref">Considerations Regarding Option Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.4">
                <p id="section-toc.1-1.25.2.4.1"><a href="#section-25.4" class="auto internal xref">25.4</a>.  <a href="#name-considerations-for-fragment" class="internal xref">Considerations for Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.5">
                <p id="section-toc.1-1.25.2.5.1"><a href="#section-25.5" class="auto internal xref">25.5</a>.  <a href="#name-considerations-for-providin" class="internal xref">Considerations for Providing UDP Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.6">
                <p id="section-toc.1-1.25.2.6.1"><a href="#section-25.6" class="auto internal xref">25.6</a>.  <a href="#name-considerations-regarding-mi" class="internal xref">Considerations Regarding Middleboxes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#section-26" class="auto internal xref">26</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#section-27" class="auto internal xref">27</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27.2.1">
                <p id="section-toc.1-1.27.2.1.1"><a href="#section-27.1" class="auto internal xref">27.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27.2.2">
                <p id="section-toc.1-1.27.2.2.1"><a href="#section-27.2" class="auto internal xref">27.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28">
            <p id="section-toc.1-1.28.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-implementation-information" class="internal xref">Implementation Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29">
            <p id="section-toc.1-1.29.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.30">
            <p id="section-toc.1-1.30.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Transport protocols use options as a way to extend their
capabilities. TCP <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>, the Stream Control Transmission Protocol (SCTP) <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>, and the Datagram Congestion Control Protocol (DCCP) <span>[<a href="#RFC4340" class="cite xref">RFC4340</a>]</span>
include space for these options, but UDP <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span> currently does not.
This document updates RFC 768 with an extension to UDP that provides
space for transport options including their generic syntax and
semantics for their use in UDP's stateless, unreliable message
protocol. The details of the impact on RFC 768 are provided in
<a href="#sec-updates-768" class="auto internal xref">Section 21</a>. This extension does not apply to UDP-Lite, as discussed
further in <a href="#sec-options-vs-lite" class="auto internal xref">Section 17</a>.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-used-in-this-document">
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>
        <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals,
    as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">In this document, the characters "&gt;&gt;" at the beginning of a paragraph 
indicate a statement using the key words listed above. This
convention aids reviewers in quickly identifying or finding the
portions of this RFC covered by these key words.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The following terminology is used in this document:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">IP datagram <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span> <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
          <p id="section-3-2.2.1">An IP packet, composed of the IP
header (including any IPv4 options) and an IP payload area
(including any IPv6 extension headers or other shim headers).<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Must-support options:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">
          <p id="section-3-2.4.1">UDP Options that all implementations are
required to support. Their use in individual UDP packets is
optional.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">SAFE Options:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">
          <p id="section-3-2.6.1">UDP Options that are designed to be safe to ignore
for a receiver that does not understand them. Such options do not
alter the UDP user data or signal a change in what its contents
represent.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">Socket pair:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.8">
          <p id="section-3-2.8.1">A pair of sockets defining a UDP exchange, defined
by a remote socket and a local socket, each composed of an IP
address and UDP port number (most widely known from TCP <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span>, which has been obsoleted by <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>).<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.9">Surplus area:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.10">
          <p id="section-3-2.10.1">The area of an IP payload that follows a UDP
packet; this area is used for UDP Options in this document.<a href="#section-3-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.11">UDP packet:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.12">
          <p id="section-3-2.12.1">The more contemporary term used herein to refer to a
user datagram <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>.<a href="#section-3-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.13">UDP fragment:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.14">
          <p id="section-3-2.14.1">One or more components of a UDP packet and its UDP
Options that enable transmission over multiple IP payloads,
larger than permitted by the maximum size of a single IP packet;
note that each UDP fragment is itself transmitted as a UDP packet
with its own options.<a href="#section-3-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.15">(UDP) User data:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.16">
          <p id="section-3-2.16.1">The user data field of a UDP packet <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>.<a href="#section-3-2.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.17">UDP Length:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.18">
          <p id="section-3-2.18.1">The length field of a UDP header <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>.<a href="#section-3-2.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.19">UNSAFE Options:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.20">
          <p id="section-3-2.20.1">UDP Options that are not designed to be safely ignored
by a receiver that does not understand them. Such options
could alter the UDP user data or signal a change in what its
contents represent, but there are restrictions on how they can be
transmitted; these restrictions are noted in Sections <a href="#sec-udp-opt" class="auto internal xref">10</a> and <a href="#sec-unsafe-opt" class="auto internal xref">12</a>.<a href="#section-3-2.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.21">User:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.22">
          <p id="section-3-2.22.1">The upper layer application, protocol, or service that
produces and consumes content that UDP transfers.<a href="#section-3-2.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.23">User datagram:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.24">
          <p id="section-3-2.24.1">A UDP packet, composed of a UDP header and UDP
payload; as discussed herein, the UDP payload need not extend to the
end of the IP datagram. In this document, the original intent
that a UDP datagram corresponds to the user portion of a single
IP datagram is redefined, where a UDP datagram can span more than
one IP datagram through UDP fragmentation.<a href="#section-3-2.24.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="background">
<section id="section-4">
      <h2 id="name-background">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-4-1">Many protocols include a default, invariant header and an area for
   header options that varies from packet to packet. These options
   enable the protocol to be extended for use in particular
   environments or in ways unforeseen by the original designers.
   Examples include TCP's Maximum Segment Size (MSS), Window Scale,
      Timestamp, and Authentication Options <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span> <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span> <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Header options are used both in stateful (connection-oriented, e.g.,
   TCP <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>, SCTP <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>, and DCCP <span>[<a href="#RFC4340" class="cite xref">RFC4340</a>]</span>) and stateless
   (connectionless, e.g., IPv4 <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span> and IPv6 <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>) protocols. In
   stateful protocols, they can help extend the way in which state is
   managed. In stateless protocols, their effect is often limited to
   individual packets, but they can have an aggregate effect on a
   sequence of packets as well.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">UDP is one of the most popular protocols that lacks space for header
   options <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>. The UDP header was intended to be a minimal
   addition to IP, providing only port numbers and a checksum for error
   detection. This document extends UDP to provide a trailer area for
      such options, located after the UDP user data.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">UDP Options are possible because UDP includes its own length field,
   separate from that of the IP header. Other transport protocols infer
   transport payload length from the IP datagram length (TCP, DCCP, and
   SCTP). Internet historians have suggested a number of possible
   reasons why the design of UDP includes this field, e.g., to support
   multiple UDP packets within the same IP datagram or to indicate the
   length of the UDP user data as distinct from zero padding required
   for systems that cannot write an arbitrary number of bytes of data. These
   suggestions are not consistent with earlier versions of UDP or with the
   concurrent design of multi-segment, multiplexing protocols; however,
   the real reason remains unknown. Regardless, this field presents
   an opportunity to differentiate the UDP user data from the implied
   transport payload length, which this document leverages to support a
   trailer options field.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">There are other ways to include additional header fields or options
   in protocols that otherwise are not extensible. In particular, in-
   band encoding can be used to differentiate transport payload from
   additional fields, such as was proposed in <span>[<a href="#I-D.hildebrand-spud-prototype" class="cite xref">Hi15</a>]</span>. This approach can
   cause complications for interactions with legacy devices and is
   thus not considered further in this document.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">IPv6 Teredo extensions <span>[<a href="#RFC4380" class="cite xref">RFC4380</a>]</span> <span>[<a href="#RFC6081" class="cite xref">RFC6081</a>]</span> use a similar
   inconsistency between UDP and IPv6 packet lengths to support
   trailers, but in this case, the values differ between the UDP header
   and an IPv6 length contained as the payload of the UDP user data.
   This allows IPv6 trailers in the UDP user data but has no relation
   to the surplus area discussed in this document. As a consequence,
   Teredo extensions are compatible with UDP Options.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udp-option-intended-uses">
<section id="section-5">
      <h2 id="name-udp-option-intended-uses">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-udp-option-intended-uses" class="section-name selfRef">UDP Option Intended Uses</a>
      </h2>
<p id="section-5-1">UDP Options can be used to provide a soft control plane to UDP. They
   enable capabilities available in other transport protocols, such as
   fragmentation and reassembly, that enable UDP frames larger than the
   IP MTU to traverse devices that rely on transport ports, e.g., Network Address Translations (NATs),
   without additional mechanisms or state. They add features that
   could, in the future, protect transport integrity and validate
   source identity (authentication), as well as those that could
   encrypt the user payload while still protecting the UDP transport
   header -- unlike Datagram Transport Layer Security (DTLS) <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.
   They also enable Packetization Layer Path MTU Discovery (PLPMTUD)
   over UDP, known as Datagram Packetization Layer Path Maximum
   Transmission Unit Discovery (DPLPMTUD) <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>, providing a means for
   probe packet validation without affecting the user data plane, as
   well as providing explicit indication of the receiver transport
   reassembly size.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">UDP originally assumed that such capabilities would be provided by
   the user or by a layer above UDP <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>. However, enough protocols
   have evolved to use UDP directly, so such an intermediate layer
   would be difficult to deploy for legacy applications. UDP Options
   leverage the opportunity presented by the surplus area to enable
   these extensions within the UDP transport layer itself. Among the
   use cases where this approach could be of benefit are request-
   response protocols such as DNS over UDP <span>[<a href="#I-D.heard-dnsop-udp-opt-large-dns-responses" class="cite xref">He24</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udp-option-design-principles">
<section id="section-6">
      <h2 id="name-udp-option-design-principle">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-udp-option-design-principle" class="section-name selfRef">UDP Option Design Principles</a>
      </h2>
<p id="section-6-1">UDP Options have been designed based on the following core
   principles. Each is an observation about preexisting behavior of UDP <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>
   in the absence of these extensions that this document does not
   intend to change or a lesson learned from other protocol designs.<a href="#section-6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6-2">
<li id="section-6-2.1">
          <p id="section-6-2.1.1">UDP is stateless; UDP Options do not change that fact.<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6-2.1.2">
The state required or maintained by the endpoints is intended to be
managed either by the application or a layer/library on behalf of
the application. Reassembly of fragments is the only limited
exception where this document introduces a notion of state to
UDP.<a href="#section-6-2.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-6-2.2">
          <p id="section-6-2.2.1">UDP is unidirectional; UDP Options do not change that fact.<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6-2.2.2">
Responses to options are initiated by the application or a
layer/library on behalf of the application. A mechanism that
requires bidirectionality needs to be defined in a separate
document.<a href="#section-6-2.2.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-6-2.3">
          <p id="section-6-2.3.1">UDP Options have no length limit separate from that of the UDP
packet itself.<a href="#section-6-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6-2.3.2">
Past experience with other protocols confirms that static length
limits will always need to be exceeded, e.g., as has been an
issue with TCP options and IPv4 addresses. Each implementation
can limit how long/many options there are, but a specification is
more robust when it does not introduce such a limit.<a href="#section-6-2.3.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-6-2.4">
          <p id="section-6-2.4.1">UDP Options are not intended to replace or replicate other
protocols.<a href="#section-6-2.4.1" class="pilcrow">¶</a></p>
<p id="section-6-2.4.2">
This includes NTP, ICMP (notably echo), etc. UDP Options are
intended to introduce features useful for applications, not to
either replace these other protocols nor instrument UDP to
replace the need for network testing devices.<a href="#section-6-2.4.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-6-2.5">
          <p id="section-6-2.5.1">UDP Options are a framework, not a protocol.<a href="#section-6-2.5.1" class="pilcrow">¶</a></p>
<p id="section-6-2.5.2">
Options can be defined in this initial document even when the
details are not sufficient to specify a complete protocol. Uses
of such options could then be described or supplemented in other
documents. Examples herein include REQ/RES and TIME; in both
cases, the option format is defined, but the protocol that uses
these is specified elsewhere (REQ/RES for DPLPMTUD <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>) or
left undefined (TIME).<a href="#section-6-2.5.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-6-2.6">
          <p id="section-6-2.6.1">The UDP Option mechanism and UDP Options themselves are intended
   to default to the same behavior experienced by a legacy receiver.<a href="#section-6-2.6.1" class="pilcrow">¶</a></p>
<p id="section-6-2.6.2">
By default, even when option checksums (OCS, APC),
authentication, or decryption fail, all received packets (with
the exception of UDP fragments) are passed (possibly with an
empty data payload) to the user application. Options that do not
modify user data are intended to (by default) result in the user
data also being passed, even if, e.g., option checksums or
authentication fails. It is always the user's or application's
obligation to override this default behavior explicitly.<a href="#section-6-2.6.2" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-6-3">These principles are intended to enable the design and use of UDP
   Options with minimal impact to legacy UDP endpoints, preferably
   none. UDP is -- and remains -- a minimal transport protocol.
   Additional capability is explicitly activated by user applications
   or libraries acting on their behalf.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Finally, UDP Options do not attempt to match the number of zero-
   length UDP datagrams received by legacy and option-aware receivers
   from a source using UDP fragmentation (see <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). Legacy
   receivers interpret every UDP fragment as a zero-length packet
   (because they do not perform reassembly), but option-aware receivers
   would reassemble the packet as a non-zero-length packet. Zero-length
   UDP packets have been used as "liveness" indicators (see <span><a href="https://rfc-editor.org/rfc/rfc8085#section-5" class="relref">Section 5</a> of [<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>),
   but such use is dangerous because they lack unique
   identifiers (the IPv6 base header has none, and the IPv4 ID field is
   deprecated for such use <span>[<a href="#RFC6864" class="cite xref">RFC6864</a>]</span>).<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-udp-option-area">
<section id="section-7">
      <h2 id="name-the-udp-option-area">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-the-udp-option-area" class="section-name selfRef">The UDP Option Area</a>
      </h2>
<p id="section-7-1">The UDP transport header includes demultiplexing and service
identification (port numbers), an error detection checksum, and a
field that indicates the UDP datagram length (including UDP header).
The UDP Length field is typically redundant with the size of the
maximum space available as a transport protocol payload, as
determined by the IP header (see details in <a href="#sec-legacy-int" class="auto internal xref">Section 18</a>). The UDP
Option area is created when the UDP Length indicates a smaller
transport payload than implied by the IP header.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">For IPv4, the IP Total Length field indicates the total IP datagram
length (including the IP header), and the size of the IP options is
indicated in the IP header (in 4-byte words) as the "Internet Header
Length" (IHL) <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span>, as shown in <a href="#fig-1" class="auto internal xref">Figure 1</a>. In exceptional cases,
the Protocol field in IPv4 might not indicate UDP (i.e., 17), e.g.,
when intervening shim headers are present such as IP Security
(IPsec) <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span> or for IP Payload Compression (IPComp) <span>[<a href="#RFC3173" class="cite xref">RFC3173</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The upper bound for UDP Length when Protocol = 17 is given by:<a href="#section-7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-4">
<pre>
   UDP_Length &lt;= IPv4_Total_Length - IPv4_IHL * 4
</pre><a href="#section-7-4" class="pilcrow">¶</a>
</div>
<p id="section-7-5">If shim headers are present, this upper bound must be reduced by the
sum of the lengths of shim headers that precede the UDP header.<a href="#section-7-5" class="pilcrow">¶</a></p>
<span id="name-ipv4-datagram-with-udp-head"></span><div id="fig-1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-7-6.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |   DSCP    |ECN|          Total Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identification        |Flags|      Fragment Offset    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Time to Live | Proto=17 (UDP)|        Header Checksum        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Destination Address                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
... zero or more IP options (using space as indicated by IHL) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...     zero or more shim headers (each indicating size)      ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         UDP Source Port       |     UDP Destination Port      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          UDP Length           |         UDP Checksum          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-ipv4-datagram-with-udp-head" class="selfRef">IPv4 Datagram with UDP Header</a>
        </figcaption></figure>
</div>
<p id="section-7-7">For IPv6, the IP Payload Length field indicates the transport
payload after the base IPv6 header, which includes the IPv6
extension headers and space available for the transport protocol, as
shown in <a href="#fig-2" class="auto internal xref">Figure 2</a> <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>. Note that the Next Header field in IPv6
might not indicate UDP (i.e., 17), e.g., when intervening IP
extension headers are present. For IPv6, the lengths of any
additional IP extensions are indicated within each extension
<span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>, so the upper bound for UDP Length is given by:<a href="#section-7-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-8">
<pre>
  UDP_Length &lt;= IPv6_Payload_Length - sum(extension header lengths)
</pre><a href="#section-7-8" class="pilcrow">¶</a>
</div>
<span id="name-ipv6-datagram-with-udp-head"></span><div id="fig-2">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-7-9.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version| Traffic Class |             Flow Label                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Payload Length        |  Next Header  |   Hop Limit   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...
|                       Source Address (128 bits)               |
...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...
|                    Destination Address (128 bits)             |
...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
... zero or more IP Extension headers (each indicating size)  ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         UDP Source Port       |     UDP Destination Port      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          UDP Length           |         UDP Checksum          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-ipv6-datagram-with-udp-head" class="selfRef">IPv6 Datagram with UDP Header</a>
        </figcaption></figure>
</div>
<p id="section-7-10">In both cases, the space available for the UDP packet is indicated
by IP, either directly in the base header or by adding information
in the shim headers or extensions. In either case, this document
will refer to this available space as the "IP transport payload".<a href="#section-7-10" class="pilcrow">¶</a></p>
<p id="section-7-11">As a result of this redundancy, there is an opportunity to use the
UDP Length field as a way to break up the IP transport payload into
two areas -- that intended as UDP user data and an additional
"surplus area" (as shown in <a href="#fig-3" class="auto internal xref">Figure 3</a>).<a href="#section-7-11" class="pilcrow">¶</a></p>
<span id="name-ip-transport-payload-vs-udp"></span><div id="fig-3">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-7-12.1">
<pre>
                         IP transport payload
          &lt;-------------------------------------------------&gt;
+--------+---------+----------------------+------------------+
| IP Hdr | UDP Hdr |     UDP user data    |   surplus area   |
+--------+---------+----------------------+------------------+
          &lt;------------------------------&gt;
                     UDP Length
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-ip-transport-payload-vs-udp" class="selfRef">IP Transport Payload vs. UDP Length</a>
        </figcaption></figure>
</div>
<p id="section-7-13">In most cases, the IP transport payload and UDP Length point to the
same location, indicating that there is no surplus area. This is not
a requirement of UDP <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span> (discussed further in <a href="#sec-legacy-int" class="auto internal xref">Section 18</a>).
This document uses the surplus area for UDP Options.<a href="#section-7-13" class="pilcrow">¶</a></p>
<p id="section-7-14">The surplus area can commence at any valid byte offset, i.e., it
need not be 16-bit or 32-bit aligned. In effect, this document
redefines the UDP Length field as a "trailer options offset".<a href="#section-7-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-udp-surplus-area-structure">
<section id="section-8">
      <h2 id="name-the-udp-surplus-area-struct">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-the-udp-surplus-area-struct" class="section-name selfRef">The UDP Surplus Area Structure</a>
      </h2>
<p id="section-8-1">UDP Options use the entire surplus area, i.e., the contents of the
IP payload after the last byte of the UDP payload. They commence
with a 2-byte Option Checksum (OCS) field aligned to the first 2-
byte boundary (relative to the start of the IP datagram) of that
area, adding zeroes before OCS as needed for alignment. The UDP
Option area can be used with any UDP payload length (including zero,
i.e., a UDP Length of 8), as long as there remains enough space for
the aligned OCS and the options used.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">&gt;&gt; UDP Options <span class="bcp14">MAY</span> begin at any UDP Length offset.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">&gt;&gt; Option area bytes used for alignment before the OCS <span class="bcp14">MUST</span> be zero.
If this is not the case, all options <span class="bcp14">MUST</span> be ignored and the surplus
area silently discarded.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">These alignment bytes, coupled with OCS as computed over the
remainder of the surplus area, ensure that the one's complement sum
of the surplus area is zero. OCS is half-word (2-byte) aligned to
avoid the need for byte-swapping in its implementation.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">The OCS contains an optional one's complement sum that detects errors
in the surplus area, which is not otherwise covered by the UDP
      checksum, as detailed in <a href="#sec-ocs" class="auto internal xref">Section 9</a>.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">The remainder of the surplus area consists of options, all except
two of which are defined using a TLV (type, length, and optional
value) syntax similar to that of TCP <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>, as detailed in
<a href="#sec-udp-opt" class="auto internal xref">Section 10</a> (types No Operation (NOP) and End of Options List (EOL) have an implicit length of one byte).
These options continue until the end of the surplus area or can end
earlier using the EOL Option, followed by zeroes
(discussed further in <a href="#sec-udp-opt" class="auto internal xref">Section 10</a>).<a href="#section-8-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ocs">
<section id="section-9">
      <h2 id="name-the-option-checksum-ocs">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-the-option-checksum-ocs" class="section-name selfRef">The Option Checksum (OCS)</a>
      </h2>
<p id="section-9-1">The Option Checksum (OCS) Option is a conventional Internet checksum
   <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span> that detects errors in the surplus area. The OCS Option
   contains a 16-bit checksum that is aligned to the first 2-byte
   boundary, preceded by zeroes for padding (if needed), as shown in
   <a href="#fig-4" class="auto internal xref">Figure 4</a>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-udp-ocs-format-here-using-o"></span><div id="fig-4">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-9-2.1">
<pre>
                +--------+--------+--------+--------+
                |         UDP data         |    0   |
                +--------+--------+--------+--------+
                |       OCS       |  UDP Options... |
                +--------+--------+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-udp-ocs-format-here-using-o" class="selfRef">UDP OCS Format, Here Using One Zero Byte for Alignment</a>
        </figcaption></figure>
</div>
<p id="section-9-3">The OCS consists of a 16-bit Internet checksum <span>[<a href="#RFC1071" class="cite xref">RFC1071</a>]</span>, computed
   over the surplus area and including the length of the surplus area
   as an unsigned 16-bit value. The OCS protects the surplus area from
   errors in a similar way that the UDP checksum protects the UDP user
   data (when not zero).<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The primary purpose of the OCS is to detect existing nonstandard
   (i.e., non-option) uses of that area and accidental errors. It is
   not intended to detect attacks, as discussed further in <a href="#sec-sec-cons" class="auto internal xref">Section 25</a>.
   OCS is not intended to prevent future nonstandard uses of the
   surplus area nor does it enable shared use with mechanisms that do
   not comply with UDP Options.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">The design enables traversal of errant middleboxes that incorrectly
   compute the UDP checksum over the entire IP payload <span>[<a href="#I-D.fairhurst-udp-options-cco" class="cite xref">Fa18</a>]</span> <span>[<a href="#Zu20" class="cite xref">Zu20</a>]</span>,
   rather than only the UDP header and UDP payload (as indicated by the
   UDP header length). Because the OCS is computed over the surplus
   area and its length and then inverted, the OCS effectively negates the
   effect that incorrectly including the surplus has on the UDP
   checksum. As a result, when OCS is non-zero, the UDP checksum is the
   same in either case.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">&gt;&gt; The OCS <span class="bcp14">MUST</span> be non-zero when the UDP checksum is non-zero.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">&gt;&gt; When the UDP checksum is zero, the OCS <span class="bcp14">MAY</span> be unused and is then
   indicated by a zero OCS value.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">&gt;&gt; UDP Option implementations <span class="bcp14">MUST</span> default to using the OCS (i.e., as a
   non-zero value); users overriding that default take the risk of not
   detecting nonstandard uses of the option area (of which there are
   none currently known).<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">Like the UDP checksum, the OCS is optional under certain
   circumstances and contains zero when not used. UDP checksums can be
   zero for IPv4 <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span> and for IPv6 <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> when the UDP payload
   is already covered by another checksum, as might occur for tunnels
   <span>[<a href="#RFC6935" class="cite xref">RFC6935</a>]</span>. The same exceptions apply to the OCS when used to detect
   bit errors; an additional exception occurs for its use in the UDP
      datagram prior to fragmentation or after reassembly (see <a href="#sec-frag" class="auto internal xref">Section 11.4</a>).<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">The benefits are similar to allowing UDP checksums to be zero, but
   the risks differ. The OCS is additionally important to ensure packets
   with UDP Options can traverse errant middleboxes <span>[<a href="#Zu20" class="cite xref">Zu20</a>]</span>. When the
   cost of computing an OCS is negligible, it is better to use the OCS to
   ensure such traversal. In cases where such traversal risks can
   safely be ignored, such as controlled environments, over paths where
   traversal is validated, or where upper layer protocols
   (applications, libraries, etc.) can adapt (by enabling the OCS when
   packet exchange fails), and when bit errors at the UDP layer would
   be detected by other layers (as with the UDP checksum), the OCS can be
   disabled, e.g., to conserve energy or processing resources or when
   performance can be improved. This is why zeroing the OCS is only safe
   when UDP checksum is also zero and why OCS might still be used in
   that case.<a href="#section-9-10" class="pilcrow">¶</a></p>
<p id="section-9-11">The OCS covers the surplus area as formatted for transmission and is
   processed immediately upon reception.<a href="#section-9-11" class="pilcrow">¶</a></p>
<p id="section-9-12">&gt;&gt; If the receiver validation of the OCS fails, all options <span class="bcp14">MUST</span> be
   ignored and the surplus area silently discarded.<a href="#section-9-12" class="pilcrow">¶</a></p>
<p id="section-9-13">&gt;&gt; UDP user data that is validated by a correct UDP checksum <span class="bcp14">MUST</span> by
   default be delivered to the application layer, even if the OCS
   fails, unless the endpoints have negotiated otherwise for this UDP
   packet's socket pair.<a href="#section-9-13" class="pilcrow">¶</a></p>
<p id="section-9-14">When not used (i.e., containing zero), the OCS is assumed to be
   "correct" for the purpose of accepting UDP datagrams at a receiver
   (see <a href="#sec-opt-inclusion" class="auto internal xref">Section 14</a>).<a href="#section-9-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udp-opt">
<section id="section-10">
      <h2 id="name-udp-options">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-udp-options" class="section-name selfRef">UDP Options</a>
      </h2>
<p id="section-10-1">UDP Options are a minimum of two bytes in length as shown in <a href="#fig-5" class="auto internal xref">Figure 5</a>,
   except only the one-byte options No Operation (NOP) and End
   of Options List (EOL) described below.<a href="#section-10-1" class="pilcrow">¶</a></p>
<span id="name-udp-option-default-format"></span><div id="fig-5">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-10-2.1">
<pre>
                +--------+--------+------------~~------------+
                |  Kind  | Length | (remainder of option...) |
                +--------+--------+------------~~------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-udp-option-default-format" class="selfRef">UDP Option Default Format</a>
        </figcaption></figure>
</div>
<p id="section-10-3">The Kind field is always one byte and is named after the
   corresponding TCP field (though other protocols refer to this as
   "Type"). The Length field, which indicates the length in bytes of the
   entire option, including Kind and Length, is one byte for all
   lengths below 255 (including the Kind and Length bytes). A Length of
   255 indicates use of the UDP Option extended format shown in <a href="#fig-6" class="auto internal xref">Figure 6</a>.
   The Extended Length field is a 16-bit field in network standard
   byte order. The length of the option refers to its Length field or
   Extended Length field, whichever is applicable.<a href="#section-10-3" class="pilcrow">¶</a></p>
<span id="name-udp-option-extended-format"></span><div id="fig-6">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-10-4.1">
<pre>
                +--------+--------+--------+--------+
                |  Kind  |  255   | Extended Length |
                +--------+--------+--------+--------+
                | (remainder of option...)          |
                +--------+--------+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-udp-option-extended-format" class="selfRef">UDP Option Extended Format</a>
        </figcaption></figure>
</div>
<p id="section-10-5">&gt;&gt; The UDP Length <span class="bcp14">MUST</span> be at least as large as the UDP header (8)
   and no larger than the IP transport payload. Datagrams with length
   values outside this range <span class="bcp14">MUST</span> be silently dropped as invalid and
   logged.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">&gt;&gt; All logging <span class="bcp14">SHOULD</span> be rate limited. Excess logging events can be
   coalesced and reported as a count or can be silently dropped if
   needed to avoid resource overloading.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">&gt;&gt; Option Lengths (or Extended Lengths, where applicable) smaller
   than the minimum for the corresponding Kind <span class="bcp14">MUST</span> be treated as an
   error. Such errors call into question the remainder of the surplus
   area and thus <span class="bcp14">MUST</span> result in all UDP Options being silently
   discarded.<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">&gt;&gt; Any UDP Option other than NOP or EOL whose length is 254 or less
   <span class="bcp14">MUST</span> use the UDP Option default format shown in <a href="#fig-5" class="auto internal xref">Figure 5</a>. NOP and
   EOL never use either length format.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">&gt;&gt; Any UDP Option whose length is larger than 254 <span class="bcp14">MUST</span> use the UDP
   Option extended format shown in <a href="#fig-6" class="auto internal xref">Figure 6</a>.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">&gt;&gt; For compactness, UDP Options <span class="bcp14">SHOULD</span> use the smallest option
   format possible.<a href="#section-10-10" class="pilcrow">¶</a></p>
<p id="section-10-11">&gt;&gt; UDP Options <span class="bcp14">MUST</span> be interpreted in the order in which they occur
   in the surplus area or, in the case of UDP fragments, in the order
   in which they appear in the UDP fragment option area (see <a href="#sec-frag" class="auto internal xref">Section 11.4</a>).<a href="#section-10-11" class="pilcrow">¶</a></p>
<p id="section-10-12">The following UDP Options are currently defined:<a href="#section-10-12" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Kind</th>
            <th class="text-left" rowspan="1" colspan="1">Length</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0*</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">End of Options List (EOL)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1*</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">No Operation (NOP)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2*</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">Additional Payload Checksum (APC)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3*</td>
            <td class="text-left" rowspan="1" colspan="1">10/12</td>
            <td class="text-left" rowspan="1" colspan="1">Fragmentation (FRAG)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">4*</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">Maximum Datagram Size (MDS)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5*</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">Maximum Reassembled Datagram Size (MRDS)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6*</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">Request (REQ)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">7*</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">Response (RES)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">Timestamp (TIME)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">RESERVED for Authentication (AUTH)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">10-126</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned (assignable by IANA)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">127</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">RFC3692-style experiments (EXP)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">128-191</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">192</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved for UNSAFE Compression (UCMP)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">193</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved for UNSAFE Encryption (UENC)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">194-253</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned-UNSAFE (assignable by IANA)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">254</td>
            <td class="text-left" rowspan="1" colspan="1">(varies)</td>
            <td class="text-left" rowspan="1" colspan="1">RFC3692-style UNSAFE experiments (UEXP)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">255</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1">Reserved-UNSAFE</td>
          </tr>
        </tbody>
      </table>
<p id="section-10-14">Options indicated by Kind values in the range 0..191 are known as
   SAFE Options because they do not interfere with use of UDP user data by
   legacy endpoints or when the option is unsupported. Options
   indicated by Kind values in the range 192..255 are known as UNSAFE
   Options because they might interfere with use by legacy receiving
   endpoints (e.g., an option that alters the UDP data payload).<a href="#section-10-14" class="pilcrow">¶</a></p>
<p id="section-10-15">UNSAFE Option nicknames are expected to begin with capital "U",
   which needs to be avoided for SAFE Option nicknames (see <a href="#sec-iana-cons" class="auto internal xref">Section 26</a>). 
   RESERVED and RESERVED-UNSAFE are not assignable by IANA and not
   otherwise defined at this time. The AUTH, UCMP, and UENC
   reservations are intended for all future options supporting
   authentication, compression, and encryption, respectively, and
   remain reserved until assigned for those uses.<a href="#section-10-15" class="pilcrow">¶</a></p>
<p id="section-10-16">Although the FRAG Option modifies the original UDP payload contents
   (i.e., is UNSAFE with respect to the original UDP payload), it is
   used only in subsequent fragments with zero-length UDP user data
   payloads, thus is SAFE in actual use, as discussed further in
   <a href="#sec-frag" class="auto internal xref">Section 11.4</a>.<a href="#section-10-16" class="pilcrow">¶</a></p>
<p id="section-10-17">These options are defined in the following subsections. Options 0
   and 1 use the same values as for TCP.<a href="#section-10-17" class="pilcrow">¶</a></p>
<p id="section-10-18">&gt;&gt; An endpoint supporting UDP Options <span class="bcp14">MUST</span> support those marked with
   an "*" above: EOL, NOP, APC, FRAG, MDS, MRDS, REQ, and RES. This
   includes both recognizing and being able to generate these options
   if configured to do so. These are called "must-support" options.<a href="#section-10-18" class="pilcrow">¶</a></p>
<p id="section-10-19">The set of must-support options is defined herein. New options are
   not eligible for this designation.<a href="#section-10-19" class="pilcrow">¶</a></p>
<p id="section-10-20">&gt;&gt; All other SAFE Options (without an "*") <span class="bcp14">MAY</span> be implemented, and
   their use <span class="bcp14">SHOULD</span> be determined either out-of-band or negotiated,
   notably if needed to detect when options are silently ignored by
   legacy receivers.<a href="#section-10-20" class="pilcrow">¶</a></p>
<p id="section-10-21">&gt;&gt; Receivers supporting UDP Options <span class="bcp14">MUST</span> silently ignore unknown or
   malformed SAFE Options (i.e., in the same way a legacy receiver
   would ignore all UDP Options). An option is malformed when its
   length does not indicate (one of) the value(s) stated in the
   option's specification. A malformed FRAG Option is an exception to
   this rule; it <span class="bcp14">SHALL</span> be treated as an unsupported UNSAFE Option.<a href="#section-10-21" class="pilcrow">¶</a></p>
<p id="section-10-22">&gt;&gt; Options with inherently invalid Length field values, i.e., those
   that indicate underruns of the option itself or overruns of the
   surplus area (pointing past the end of the IP payload), <span class="bcp14">MUST</span> be
   treated as an indication of a malformed surplus area, and all
   options <span class="bcp14">MUST</span> silently be discarded.<a href="#section-10-22" class="pilcrow">¶</a></p>
<p id="section-10-23">Receivers cannot generally treat unexpected Option Lengths as
   invalid, as this would unnecessarily limit future revision of
   options (e.g., defining a new APC that is defined by having a
   different length).<a href="#section-10-23" class="pilcrow">¶</a></p>
<p id="section-10-24">&gt;&gt; When UNSAFE Options are present, the UDP user data <span class="bcp14">MUST</span> be empty,
   and any transport payload <span class="bcp14">MUST</span> be contained in a FRAG Option (see
   <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). Recall that such options may alter the transport
   payload or signal a change in what its contents represent. This
   restriction ensures their safe use in environments that might
   include legacy receivers (see <a href="#sec-unsafe-opt" class="auto internal xref">Section 12</a>), because the transport
   payload occurs inside the FRAG Option area and is silently discarded
   by legacy receivers.<a href="#section-10-24" class="pilcrow">¶</a></p>
<p id="section-10-25">&gt;&gt; Receivers supporting UDP Options that receive unsupported options
   in the UNSAFE range <span class="bcp14">MUST</span> terminate all option processing and <span class="bcp14">MUST</span>
   silently drop all UDP Options in that datagram. See <a href="#sec-unsafe-opt" class="auto internal xref">Section 12</a> for
   further discussion of UNSAFE Options.<a href="#section-10-25" class="pilcrow">¶</a></p>
<p id="section-10-26">&gt;&gt; Other than FRAG, NOP, EXP, and UEXP, each option <span class="bcp14">SHOULD NOT</span> occur
   more than once in a single UDP datagram. If an option other than
   these four occurs more than once, a receiver <span class="bcp14">MUST</span> interpret only the
   first instance of that option and <span class="bcp14">MUST</span> ignore later instances.
   <a href="#sec-sec-cons" class="auto internal xref">Section 25</a> provides additional advice for Denial of Service (DoS)
   issues that involve large numbers of options, whether valid,
   unknown, or repeating.<a href="#section-10-26" class="pilcrow">¶</a></p>
<p id="section-10-27">&gt;&gt; NOP <span class="bcp14">MAY</span> occur multiple times, either in succession or between
   other options, for option alignment. Additional repetition
   constraints are indicated in <a href="#sec-nop" class="auto internal xref">Section 11.2</a>.<a href="#section-10-27" class="pilcrow">¶</a></p>
<p id="section-10-28">&gt;&gt; If FRAG occurs more than once, the options area <span class="bcp14">MUST</span> be
   considered malformed and <span class="bcp14">MUST NOT</span> be processed.<a href="#section-10-28" class="pilcrow">¶</a></p>
<p id="section-10-29">&gt;&gt; EXP and UEXP <span class="bcp14">MAY</span> occur more than once but <span class="bcp14">SHOULD NOT</span> occur more
   than once using the same Experimental ID (ExID) (see Sections <a href="#sec-exp" class="auto internal xref">11.10</a> and <a href="#sec-uexp" class="auto internal xref">12.3</a>).<a href="#section-10-29" class="pilcrow">¶</a></p>
<p id="section-10-30">&gt;&gt; Options other than OCS, AUTH, and UENC <span class="bcp14">MUST NOT</span> include fields
   whose values depend on the contents of the surplus area.<a href="#section-10-30" class="pilcrow">¶</a></p>
<p id="section-10-31">AUTH and UENC are always computed as if their hash and the OCS are
   zero; the OCS is always computed as if its contents are zero and
   after the AUTH or UENC hash has been computed.<a href="#section-10-31" class="pilcrow">¶</a></p>
<p id="section-10-32">&gt;&gt; Future options <span class="bcp14">MUST NOT</span> be defined as having an option field
   value dependent on the content or presence of other options or on
   the remaining contents of the surplus area, i.e., the area after the
   last option (presumably EOL).<a href="#section-10-32" class="pilcrow">¶</a></p>
<p id="section-10-33">If future options were to depend on the contents or presence of
   other options, interactions between those values, the OCS, and the
   AUTH and UENC Options could be unpredictable. This does not prohibit
   options that modify later options (in order of appearance within a
   packet), such as would typically be the case for compression (UCMP).<a href="#section-10-33" class="pilcrow">¶</a></p>
<p id="section-10-34">Note that there is no need to reserve area after the last UDP Option
   for future uses, because any such use can be supported by defining a
   new UDP Option over that area instead. Using an option for this
   purpose is safer than treating the region as an exception, because
   its use can be verified based on option Kind and Length.<a href="#section-10-34" class="pilcrow">¶</a></p>
<p id="section-10-35">&gt;&gt; AUTH and UENC <span class="bcp14">MUST NOT</span> be used concurrently.<a href="#section-10-35" class="pilcrow">¶</a></p>
<p id="section-10-36">AUTH and UENC are never used together because UENC would serve both
   purposes.<a href="#section-10-36" class="pilcrow">¶</a></p>
<p id="section-10-37">&gt;&gt; "Must-support" options other than NOP and EOL <span class="bcp14">MUST</span> be placed by
   the transmitter before other SAFE UDP Options. A receiver <span class="bcp14">MAY</span> drop
   all UDP Options if this ordering is not honored. Such events <span class="bcp14">MAY</span> be
   logged for diagnostic purposes.<a href="#section-10-37" class="pilcrow">¶</a></p>
<p id="section-10-38">The requirement that must-support options come before others is
   intended to allow for endpoints to implement DoS protection, as
   discussed further in <a href="#sec-sec-cons" class="auto internal xref">Section 25</a>.<a href="#section-10-38" class="pilcrow">¶</a></p>
</section>
</div>
<div id="safe-udp-options">
<section id="section-11">
      <h2 id="name-safe-udp-options">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-safe-udp-options" class="section-name selfRef">SAFE UDP Options</a>
      </h2>
<p id="section-11-1">SAFE UDP Options can be silently ignored by legacy receivers without
   affecting the meaning of the UDP user data. They stand in contrast
   to UNSAFE Options, which modify UDP user data in ways that render it
   unusable by legacy receivers (<a href="#sec-unsafe-opt" class="auto internal xref">Section 12</a>). The following subsections
   describe SAFE Options defined in this document.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="end-of-options-list-eol">
<section id="section-11.1">
        <h3 id="name-end-of-options-list-eol">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-end-of-options-list-eol" class="section-name selfRef">End of Options List (EOL)</a>
        </h3>
<p id="section-11.1-1">The End of Options List (EOL, Kind=0) Option indicates that there
   are no more options. It is used to indicate the end of the list of
   options without needing to use NOP Options (see the following
   section) as padding to fill all available option space.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span id="name-udp-eol-option-format"></span><div id="fig-7">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-11.1-2.1">
<pre>
                               +--------+
                               | Kind=0 |
                               +--------+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-udp-eol-option-format" class="selfRef">UDP EOL Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.1-3">&gt;&gt; When the UDP Options do not consume the entire surplus area or
   the options area of a UDP fragment, the last non-NOP Option <span class="bcp14">MUST</span> be
   EOL.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">&gt;&gt; NOPs <span class="bcp14">SHOULD NOT</span> be used as padding before the EOL Option. As a
   one-byte option, EOL need not be otherwise aligned.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5">&gt;&gt; All bytes after EOL in the surplus area or the options area of a
   UDP fragment <span class="bcp14">MUST</span> be set to zero on transmit.<a href="#section-11.1-5" class="pilcrow">¶</a></p>
<p id="section-11.1-6">&gt;&gt; Bytes after EOL in the surplus area or the options area of a UDP
   fragment <span class="bcp14">MAY</span> be checked as being zero on receipt but <span class="bcp14">MUST NOT</span> be
   otherwise processed (except for OCS calculation, which zeros would
   not affect) and <span class="bcp14">MUST NOT</span> be passed to the user.<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<p id="section-11.1-7">&gt;&gt; If a receiver elects to check the bytes following EOL and finds
   that they are not all set to zero, it <span class="bcp14">MUST</span> silently discard the
   options area. In this case, the UDP user data <span class="bcp14">MUST</span> be delivered to
   the application layer, unless the socket has been explicitly
   configured to do otherwise, as decided by the upper layer or
   negotiated with the other endpoint.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1-8">Requiring the post-option surplus area to be zero prevents side-
   channel uses of this area, instead requiring that all use of the
   surplus area be UDP Options supported by both endpoints. It is
   useful to allow this area to be used for zero padding to increase
   the UDP datagram length without affecting the UDP user data length,
   e.g., for UDP DPLPMTUD (<span><a href="https://rfc-editor.org/rfc/rfc9869#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>).<a href="#section-11.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-nop">
<section id="section-11.2">
        <h3 id="name-no-operation-nop">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-no-operation-nop" class="section-name selfRef">No Operation (NOP)</a>
        </h3>
<p id="section-11.2-1">The No Operation (NOP, Kind=1) Option is a one-byte placeholder,
   intended to be used as padding, e.g., to align multi-byte options
   along 16-bit, 32-bit, or 64-bit boundaries.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<span id="name-udp-nop-option-format"></span><div id="fig-8">
<figure id="figure-8">
          <div class="alignLeft art-text artwork" id="section-11.2-2.1">
<pre>
                            +--------+
                            | Kind=1 |
                            +--------+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-udp-nop-option-format" class="selfRef">UDP NOP Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.2-3">&gt;&gt; UDP packets <span class="bcp14">SHOULD NOT</span> use more than seven consecutive NOPs,
   i.e., to support alignment up to 8-byte boundaries. UDP packets
   <span class="bcp14">SHOULD NOT</span> use NOPs at the end of the options area as a substitute
   for EOL followed by zero-fill. NOPs are intended to assist with
   alignment, not as other padding or fill.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">&gt;&gt; Receivers persistently experiencing packets with more than seven
   consecutive NOPs <span class="bcp14">SHOULD</span> log such events, at least occasionally, as a
   potential DoS indicator.<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2-5">NOPs are not reported to the user, whether used per-datagram or per-
   fragment (as defined in <a href="#sec-frag" class="auto internal xref">Section 11.4</a>).<a href="#section-11.2-5" class="pilcrow">¶</a></p>
<p id="section-11.2-6">This issue is discussed further in <a href="#sec-sec-cons" class="auto internal xref">Section 25</a>.<a href="#section-11.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-payload-checksum-apc">
<section id="section-11.3">
        <h3 id="name-additional-payload-checksum">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-additional-payload-checksum" class="section-name selfRef">Additional Payload Checksum (APC)</a>
        </h3>
<p id="section-11.3-1">The Additional Payload Checksum (APC, Kind=2) Option provides a
   stronger supplement to the checksum in the UDP header, using a 32-
   bit Cyclic Redundancy Check (CRC) of the conventional UDP user data payload only (excluding
   the IP pseudoheader, UDP header, and surplus area). It is not an
   alternative to the UDP checksum because it does not cover the IP
   pseudoheader or UDP header, and it is not a supplement to the OCS
   because the latter covers the surplus area only. Its purpose is to
   detect user data errors that the UDP checksum might not detect.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">A CRC32c has been chosen because of its ubiquity and use in other
   Internet protocols, including Internet Small Computer System Interface (iSCSI) <span>[<a href="#RFC3385" class="cite xref">RFC3385</a>]</span> and SCTP. The option
   contains the CRC32c in network standard byte order, as used for
   iSCSI.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
<span id="name-udp-apc-option-format"></span><div id="fig-9">
<figure id="figure-9">
          <div class="alignLeft art-text artwork" id="section-11.3-3.1">
<pre>
                +--------+--------+--------+--------+
                | Kind=2 | Len=6  |    CRC32c...    |
                +--------+--------+--------+--------+
                |  CRC32c (cont.) |
                +--------+--------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-udp-apc-option-format" class="selfRef">UDP APC Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.3-4">When present, the APC always contains a valid CRC checksum. There
   are no reserved values, including the value zero. A CRC value of
   zero is a potentially valid checksum. As such, it does not indicate
   that the APC is not used; instead, the option would simply not be
   included if that were the desired effect.<a href="#section-11.3-4" class="pilcrow">¶</a></p>
<p id="section-11.3-5">The APC does not protect the UDP pseudoheader; only the current UDP
   checksum provides that protection (when used). The APC cannot provide
   that protection because it would need to be updated whenever the UDP
   pseudoheader changed, e.g., during NAT address and port translation
 (see <span>[<a href="#RFC1141" class="cite xref">RFC1141</a>]</span>).<a href="#section-11.3-5" class="pilcrow">¶</a></p>
<p id="section-11.3-6">&gt;&gt; UDP packets with incorrect APC Option checksum fields <span class="bcp14">SHOULD</span> be passed to the
   application with an indication of APC Option checksum failure. This is the default
   behavior for APC.<a href="#section-11.3-6" class="pilcrow">¶</a></p>
<p id="section-11.3-7">&gt;&gt; Like all SAFE UDP Options, the APC <span class="bcp14">MUST</span> be silently ignored when
   failing, unless the receiver has been explicitly configured to do
   otherwise.<a href="#section-11.3-7" class="pilcrow">¶</a></p>
<p id="section-11.3-8">Although all UDP Option aware endpoints support the APC (being in the
   required set), this silently ignored behavior ensures that option-
   aware receivers operate the same as legacy receivers unless
   overridden. Another reason is because the APC check could fail even
   where the user data has not been corrupted, such as when its
   contents have been intentionally overwritten, e.g., by a middlebox to
   update embedded port numbers or IP addresses. Such overwrites could
   be intentional and not widely known; defaulting to silent ignore
   ensures that option-aware endpoints do not change how users or
   applications operate unless explicitly directed to do otherwise.<a href="#section-11.3-8" class="pilcrow">¶</a></p>
<p id="section-11.3-9">&gt;&gt; UDP packets with unrecognized APC lengths <span class="bcp14">MUST</span> receive the same
   treatment as UDP packets with incorrect APC Option checksum fields.<a href="#section-11.3-9" class="pilcrow">¶</a></p>
<p id="section-11.3-10">Ensuring that unrecognized APC lengths are treated as incorrect
   checksums enables future variants of APC to be treated similarly.<a href="#section-11.3-10" class="pilcrow">¶</a></p>
<p id="section-11.3-11">The APC is reported to the user and useful only per-datagram, because
   fragments have no UDP user data.<a href="#section-11.3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-frag">
<section id="section-11.4">
        <h3 id="name-fragmentation-frag">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-fragmentation-frag" class="section-name selfRef">Fragmentation (FRAG)</a>
        </h3>
<p id="section-11.4-1">The Fragmentation (FRAG, Kind=3) Option supports UDP fragmentation
   and reassembly, which can be used to transfer UDP messages larger
   than allowed by the IP Effective MTU for
   Receiving (EMTU_R) <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. FRAG includes
   a copy of the same UDP transport ports in each fragment, enabling
   them to traverse stateless Network Address (and port) Translation
   (NAT) devices, in contrast to the behavior of IP fragments
   <span>[<a href="#RFC4787" class="cite xref">RFC4787</a>]</span>. FRAG is typically used with the UDP MDS and MRDS Options
   to enable more efficient use of large messages, both at the UDP and
   IP layers. The design of FRAG is similar to that of the IPv6
   Fragmentation Header <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>, except that the UDP variant uses a
   16-bit Offset measured in bytes, rather than IPv6's 13-bit Fragment
   Offset measured in 8-byte units. This UDP variant avoids creating
   reserved fields.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">The FRAG header also enables use of options that modify the contents
   of the UDP payload, such as encryption (UENC, see <a href="#unsafe-encryption-uenc" class="auto internal xref">Section 12.2</a>). Like
   FRAG, such options would not be safely used on UDP payloads
   because they would be misinterpreted by legacy receivers. FRAG
   allows use of these options, either on fragments or on a whole,
   unfragmented message (i.e., an "atomic" fragment at the UDP layer,
   similar to atomic IP datagrams <span>[<a href="#RFC6864" class="cite xref">RFC6864</a>]</span>). This is safe because FRAG
   hides the payload from legacy receivers by placing it within the
   surplus area.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">&gt;&gt; When FRAG is present, it <span class="bcp14">SHOULD</span> come as early as possible in the
   UDP Options list.<a href="#section-11.4-3" class="pilcrow">¶</a></p>
<p id="section-11.4-4">When present, placing FRAG first can simplify some implementations,
   notably those using hardware acceleration that assume a fixed
   location for the FRAG Option. However, there are cases where FRAG
   cannot occur first, such as when combined with per-fragment UENC or
   UCMP. In those cases, encryption or compression (or both) would
   precede FRAG when they also encrypt or compress the fragment option
   itself. Additional cases could include recoding, such as could be
   used to support Forward Error Correction (FEC) over a group of
   fragments. FRAG not being first might result in software (so-called
   "slow path") option processing or might also be accommodated via a
 small set of known cases.<a href="#section-11.4-4" class="pilcrow">¶</a></p>
<p id="section-11.4-5">&gt;&gt; When FRAG is present, the UDP user data <span class="bcp14">MUST</span> be empty. If the
   user data is not empty, all UDP Options <span class="bcp14">MUST</span> be silently ignored and
   the user data received <span class="bcp14">MUST</span> be sent to the user.<a href="#section-11.4-5" class="pilcrow">¶</a></p>
<p id="section-11.4-6">Legacy receivers interpret FRAG messages as zero-length user data
   UDP packets (i.e., UDP Length field is 8, the length of just the UDP
   header), which would not affect the receiver unless the presence of
   the UDP packet itself were a signal (see <span><a href="https://rfc-editor.org/rfc/rfc8085#section-5" class="relref">Section 5</a> of [<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>).
   In this manner, the FRAG Option also helps hide UNSAFE Options so
   they can be used more safely in the presence of legacy receivers.<a href="#section-11.4-6" class="pilcrow">¶</a></p>
<p id="section-11.4-7">The FRAG Option has two formats: non-terminal fragments use the
   shorter variant (<a href="#fig-10" class="auto internal xref">Figure 10</a>) and terminal fragments use the longer
   (<a href="#fig-11" class="auto internal xref">Figure 11</a>). The latter includes stand-alone fragments, i.e., when
   data is contained in the FRAG Option but reassembly is not required.<a href="#section-11.4-7" class="pilcrow">¶</a></p>
<span id="name-udp-non-terminal-frag-optio"></span><div id="fig-10">
<figure id="figure-10">
          <div class="alignLeft art-text artwork" id="section-11.4-8.1">
<pre>
                +--------+--------+--------+--------+
                | Kind=3 | Len=10 |   Frag. Start   |
                +--------+--------+--------+--------+
                |           Identification          |
                +--------+--------+--------+--------+
                |  Frag. Offset   |
                +--------+--------+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-udp-non-terminal-frag-optio" class="selfRef">UDP Non-Terminal FRAG Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.4-9">Most fields are common to both FRAG Option formats. The option Len
   field indicates whether there are more fragments (Len=10) or no more
   fragments (Len=12).<a href="#section-11.4-9" class="pilcrow">¶</a></p>
<p id="section-11.4-10">The Frag. Start field indicates the location of the beginning of the fragment
   data, measured from the beginning of the UDP header of the fragment.
   The fragment data follows the remainder of the UDP Options and
   continues to the end of the IP datagram (i.e., the end of the
   surplus area). Those options (i.e., any that precede or follow the
   FRAG Option) are applied to this UDP fragment.<a href="#section-11.4-10" class="pilcrow">¶</a></p>
<p id="section-11.4-11">The Frag. Offset field indicates the location of this fragment
   relative to the original UDP datagram (prior to fragmentation or
   after reassembly), measured from the start of the original UDP
   datagram's header.<a href="#section-11.4-11" class="pilcrow">¶</a></p>
<p id="section-11.4-12">The Identification field is a 32-bit value that, when used in
   combination with the IP source address, UDP source port, IP
   destination address, and UDP destination port, uniquely identifies
   the original UDP datagram.<a href="#section-11.4-12" class="pilcrow">¶</a></p>
<span id="name-udp-non-terminal-frag-option"></span><div id="fig-11">
<figure id="figure-11">
          <div class="alignLeft art-text artwork" id="section-11.4-13.1">
<pre>
               +--------+--------+--------+--------+
               | Kind=3 | Len=12 |   Frag. Start   |
               +--------+--------+--------+--------+
               |           Identification          |
               +--------+--------+--------+--------+
               |  Frag. Offset   |Reass DgOpt Start|
               +--------+--------+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-udp-non-terminal-frag-option" class="selfRef">UDP Non-Terminal FRAG Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.4-14">The terminal FRAG Option format adds a Reassembled Datagram Option
   Start (RDOS) pointer, measured from the start of the original UDP
   datagram header, indicating the end of the reassembled data and the
   start of the surplus area within the original UDP datagram. UDP
   Options that apply to the reassembled datagram are contained in the
   reassembled surplus area, as indicated by RDOS. UDP Options that
   occur within the fragment are processed on the fragment itself. This
   allows either pre-reassembly or post-reassembly UDP Option effects,
   such as using UENC on each fragment while also using TIME on the
   reassembled datagram for round-trip latency measurements.<a href="#section-11.4-14" class="pilcrow">¶</a></p>
<p id="section-11.4-15">An example showing the relationship between UDP fragments and the
   original UDP datagram is provided in <a href="#fig-12" class="auto internal xref">Figure 12</a>. In this example, the
   trailer containing per-datagram options resides entirely within the
   terminal fragment, but this need not always be the case.<a href="#section-11.4-15" class="pilcrow">¶</a></p>
<span id="name-udp-fragments-and-original-"></span><div id="fig-12">
<figure id="figure-12">
          <div class="alignLeft art-text artwork" id="section-11.4-16.1">
<pre>
       Constituent UDP Fragments         Original UDP Datagram

     +-------------+------------+
     | Src Port    | Dst Port   |
     +-------------+------------+
     | UDP Len (8) | UDP Chksum |
     +-------------+------------+
     |     OCS     | K=3   L=10 |      +-------------+------------+
     +-------------+------------+      | Src Port    | Dst Port   |
  ,--| Frag. Start | Identifi-  ~      +-------------+------------+
  |  +-------------+------------+      | UDP L.(RDOS)| UDP Chksum |
  |  ~ cation      | Frag. Off. |-----&gt;+-------------+------------+
  |  +-------------+------------+      | Frag Data from 1st Frag. |
  |  ~ Per-Fragment Options     ~      |             .            |
  '-&gt;+-------------+------------+      ~             .            ~
     ~      Fragment Data       ~      |             .            |
     +-------------+------------+  ,--&gt;+-------------+------------+
                                   |   | Frag Data from 2nd Frag. |
     +-------------+------------+  |   |             .            |
     | Src Port    | Dst Port   |  |   ~             .            ~
     +-------------+------------+  |   |             .            |
     | UDP Len (8) | UDP Chksum |  | ,&gt;+-------------+------------+
     +-------------+------------+  | | |     OCS     | UDP Options|
     |     OCS     | K=3   L=12 |  | | +-------------+            +
     +-------------+------------+  | | ~             .            ~
  ,--| Frag. Start | Identifi-  ~  | | +-------------+------------+
  |  +-------------+------------+  | |
  |  ~ cation      | Frag. Off. |--' |
  |  +-------------+------------+    |
  |  |  RDOS       | Frag.Opts. |    |
  '-&gt;+--|----------+------------+    |
     ~  |   Fragment Data       ~    |
     +--|----------+------------+    |
        |                            |
        '----------------------------'
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-udp-fragments-and-original-" class="selfRef">UDP Fragments and Original UDP Datagram</a>
          </figcaption></figure>
</div>
<p id="section-11.4-17">The FRAG Option does not need a "more fragments" bit (as used by IP
   fragmentation) because it provides the same indication by using the
   longer, 12-byte variant, as shown in <a href="#fig-11" class="auto internal xref">Figure 11</a>.<a href="#section-11.4-17" class="pilcrow">¶</a></p>
<p id="section-11.4-18">&gt;&gt; The FRAG Option <span class="bcp14">MAY</span> be used on a single fragment; in this case,
   the Frag. Offset would be zero and the option would have the 12-byte
   format.<a href="#section-11.4-18" class="pilcrow">¶</a></p>
<p id="section-11.4-19">&gt;&gt; Endpoints supporting UDP Options <span class="bcp14">MUST</span> be capable of fragmenting
   and reassembling at least two fragments, each of a size that will
   fit within the standard Ethernet MTU of 1,500 bytes. For further
   details, please see <a href="#sec-mrds" class="auto internal xref">Section 11.6</a>.<a href="#section-11.4-19" class="pilcrow">¶</a></p>
<p id="section-11.4-20">Use of the single fragment variant can be helpful in supporting use
   of UNSAFE Options without undesirable impact to receivers that do
   not support either UDP Options or the specific UNSAFE Options.<a href="#section-11.4-20" class="pilcrow">¶</a></p>
<p id="section-11.4-21">During fragmentation, the UDP header checksum of each fragment
   remains constant. It does not depend on the fragment data (which
   appears in the surplus area) because all fragments have a zero-
   length user data field.<a href="#section-11.4-21" class="pilcrow">¶</a></p>
<p id="section-11.4-22">&gt;&gt; The Identification field is a 32-bit value that <span class="bcp14">MUST</span> be unique
   over the expected fragment reassembly timeout.<a href="#section-11.4-22" class="pilcrow">¶</a></p>
<p id="section-11.4-23">&gt;&gt; The Identification field <span class="bcp14">SHOULD</span> be generated in a manner similar
   to that of the IPv6 Fragment ID <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-11.4-23" class="pilcrow">¶</a></p>
<p id="section-11.4-24">&gt;&gt; UDP fragments <span class="bcp14">MUST NOT</span> overlap.<a href="#section-11.4-24" class="pilcrow">¶</a></p>
<p id="section-11.4-25">&gt;&gt; Similar to IPv6 reassembly <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>, if any of the fragments
   being reassembled overlap with any other fragments being reassembled
   for the same UDP packet, reassembly of that UDP packet <span class="bcp14">MUST</span> be
   abandoned and all the fragments that have been received for that UDP
   packet <span class="bcp14">MUST</span> be discarded, and no ICMP error messages are to be sent
   in this case (to avoid a potential DoS attack turning into an ICMP
   storm in the reverse direction).<a href="#section-11.4-25" class="pilcrow">¶</a></p>
<p id="section-11.4-26">&gt;&gt; Note that fragments might be duplicated in the network. Instead
   of treating these exact duplicate fragments as overlapping
   fragments, an implementation <span class="bcp14">MAY</span> choose to detect this case and drop
   exact duplicate fragments while keeping the other fragments
   belonging to the same UDP packet.<a href="#section-11.4-26" class="pilcrow">¶</a></p>
<p id="section-11.4-27">UDP fragmentation relies on a fragment expiration timer, which can
   be preset or could use a value computed using the UDP Timestamp
   Option.<a href="#section-11.4-27" class="pilcrow">¶</a></p>
<p id="section-11.4-28">&gt;&gt; The default UDP reassembly expiration timeout <span class="bcp14">SHOULD</span> be no more
   than 2 minutes.<a href="#section-11.4-28" class="pilcrow">¶</a></p>
<p id="section-11.4-29">&gt;&gt; UDP reassembly expiration <span class="bcp14">MUST NOT</span> generate an ICMP error. Such
   events are not an IP error and can be addressed by the
   user/application layer if desired.<a href="#section-11.4-29" class="pilcrow">¶</a></p>
<p id="section-11.4-30">&gt;&gt; UDP reassembly space <span class="bcp14">SHOULD</span> be limited to reduce the impact of
 DoS attacks on resource use.<a href="#section-11.4-30" class="pilcrow">¶</a></p>
<p id="section-11.4-31">&gt;&gt; UDP reassembly space limits <span class="bcp14">SHOULD NOT</span> be computed as a shared
   resource across multiple sockets, to avoid cross-socket pair DoS
   attacks.<a href="#section-11.4-31" class="pilcrow">¶</a></p>
<p id="section-11.4-32">&gt;&gt; Individual UDP fragments <span class="bcp14">MUST NOT</span> be forwarded to the user. The
   reassembled datagram is received only after complete reassembly,
   checksum validation, and continued processing of the remaining UDP
   Options.<a href="#section-11.4-32" class="pilcrow">¶</a></p>
<p id="section-11.4-33">Per-fragment UDP Options, if used in addition to FRAG, occur before
   the fragment data. They typically occur after the FRAG Option,
   except where they modify the FRAG Option itself (e.g., UENC or
   UCMP). Per-fragment options are processed before the fragment is
   included in the reassembled datagram. Such options can be useful to
   protect the reassembly process itself, e.g., to prevent the
   reassembly cache from being polluted (using AUTH or UENC).<a href="#section-11.4-33" class="pilcrow">¶</a></p>
<p id="section-11.4-34">&gt;&gt; Fragments of a single datagram <span class="bcp14">MAY</span> use different sets of options.
   It is expected to be computationally expensive to validate
   uniformity across all fragments, and there could be legitimate
   reasons for including options in a fragment but not all fragments
   (e.g., MDS and MRDS).<a href="#section-11.4-34" class="pilcrow">¶</a></p>
<p id="section-11.4-35">If an option is used per-fragment but defined as not usable per-
   fragment, it is treated the same as any other unknown option.<a href="#section-11.4-35" class="pilcrow">¶</a></p>
<p id="section-11.4-36">Per-datagram UDP Options, if used, reside in the surplus area of the
   original UDP datagram. Processing of those options occurs after
   reassembly is complete. This enables the safe use of UNSAFE Options,
   which are required to result in discarding the entire UDP datagram
   if they are unknown to the receiver or otherwise fail (see <a href="#sec-unsafe-opt" class="auto internal xref">Section 12</a>).<a href="#section-11.4-36" class="pilcrow">¶</a></p>
<p id="section-11.4-37">In general, UDP packets are fragmented as follows:<a href="#section-11.4-37" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.4-38">
<li id="section-11.4-38.1">
            <p id="section-11.4-38.1.1">Create a UDP packet with data and UDP Options. This is the
original UDP datagram, which we will call "D". The UDP Options
follow the UDP user data and occur in the surplus area, just as
in an unfragmented UDP datagram with UDP Options.<a href="#section-11.4-38.1.1" class="pilcrow">¶</a></p>
<p id="section-11.4-38.1.2">
&gt;&gt; UDP Options for the original packet <span class="bcp14">MUST</span> be fully prepared
before the rest of the fragmentation steps that follow here.<a href="#section-11.4-38.1.2" class="pilcrow">¶</a></p>
<p id="section-11.4-38.1.3">
&gt;&gt; The UDP checksum of the original packet <span class="bcp14">SHOULD</span> be set to zero
because it is never transmitted. Equivalent protection is
provided if each fragment has a non-zero OCS value, as will be
the case if each fragment's UDP checksum is non-zero. Similarly,
the OCS value of the original packet <span class="bcp14">SHOULD</span> be zero if each
fragment will have a non-zero OCS value, as will be the case if
each fragment's UDP checksum is non-zero.<a href="#section-11.4-38.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.4-38.2">
            <p id="section-11.4-38.2.1">Identify the desired fragment size, which we will call "S". This
value is calculated to take into account the path MTU (if known)
and to allow space for per-fragment options.<a href="#section-11.4-38.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.4-38.3">
            <p id="section-11.4-38.3.1">Fragment "D" into chunks of size no larger than "S"-12 each (10
for the non-terminal FRAG Option and 2 for OCS), with one final
chunk no larger than "S"-14 (12 for the terminal FRAG Option and
2 for OCS). Note that all the per-datagram options in step #1
need not be limited to the terminal fragment, i.e., the RDOS
pointer can indicate the start of the original surplus area
anywhere in the reassembled datagram.<a href="#section-11.4-38.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.4-38.4">
            <p id="section-11.4-38.4.1">For each chunk of "D" in step #3, create a UDP packet with no
user data (UDP Length=8) followed by the word-aligned OCS, the
FRAG Option, and any additional per-fragment UDP Options,
followed by the FRAG data chunk.<a href="#section-11.4-38.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-11.4-38.5">
            <p id="section-11.4-38.5.1">Complete the processing associated with creating these additional
per-fragment UDP Options for each fragment.<a href="#section-11.4-38.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-11.4-39">Receivers reverse the above sequence. They process all received
   options in each fragment. When the FRAG Option is encountered, the
   FRAG data is used in reassembly. After all fragments are received,
   the entire UDP packet is processed with any trailing UDP Options
   applying to the reassembled user data.<a href="#section-11.4-39" class="pilcrow">¶</a></p>
<p id="section-11.4-40">&gt;&gt; Reassembly failures at the receiver result in silent discard of
   any per-fragment options and fragment contents, and such failures
   <span class="bcp14">SHOULD NOT</span> generate zero-length frames to the user.<a href="#section-11.4-40" class="pilcrow">¶</a></p>
<p id="section-11.4-41">&gt;&gt; Finally, because fragmentation processing can be expensive, the
   FRAG Option <span class="bcp14">SHOULD</span> be avoided unless the original datagram requires
   fragmentation or it is needed for "safe" use of UNSAFE Options.<a href="#section-11.4-41" class="pilcrow">¶</a></p>
<p id="section-11.4-42">&gt;&gt; The FRAG Option <span class="bcp14">MAY</span> also be used to provide limited support for
   UDP Options in systems that have access to only the initial portion
   of the data in incoming or outgoing packets, as such systems could
   potentially access per-fragment options. Such packets would, of
   course, be silently ignored by legacy receivers that do not support
   UDP Options.<a href="#section-11.4-42" class="pilcrow">¶</a></p>
<p id="section-11.4-43">The presence of the FRAG Option is not reported to the user.<a href="#section-11.4-43" class="pilcrow">¶</a></p>
</section>
</div>
<div id="maximum-datagram-size-mds">
<section id="section-11.5">
        <h3 id="name-maximum-datagram-size-mds">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-maximum-datagram-size-mds" class="section-name selfRef">Maximum Datagram Size (MDS)</a>
        </h3>
<p id="section-11.5-1">The Maximum Datagram Size (MDS, Kind=4) Option is a 16-bit hint of
   the largest UDP packet or UDP fragment that an endpoint believes can
   be received without use of IP fragmentation. It helps UDP
   applications limit the largest UDP packet that can be sent without
   UDP fragmentation and helps UDP fragmentation determine the largest
   UDP fragment to send -- in both cases, to avoid IP fragmentation.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">As with the TCP Maximum Segment Size (MSS) Option <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>, the
   size indicated is the IP layer MTU decreased by the fixed IP and UDP
   headers only <span>[<a href="#RFC9293" class="cite xref">RFC9293</a>]</span>. The space needed for IP and UDP Options
   needs to be adjusted by the sender when using the value indicated.
   The value transmitted is based on EMTU_R, the largest IP datagram
   that can be received (i.e., reassembled at the receiver) <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>.
   However, as with TCP, this value is only a hint at what the receiver
   believes, as when used with PLPMTUD at the UDP layer, as discussed
   later in this section.<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3">&gt;&gt; MDS does not indicate a known path MTU and thus <span class="bcp14">MUST NOT</span> be used
   to limit transmissions.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<span id="name-udp-mds-option-format"></span><div id="fig-13">
<figure id="figure-13">
          <div class="alignLeft art-text artwork" id="section-11.5-4.1">
<pre>
                +--------+--------+--------+--------+
                | Kind=4 | Len=4  |    MDS size     |
                +--------+--------+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-udp-mds-option-format" class="selfRef">UDP MDS Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.5-5">&gt;&gt; The UDP MDS Option <span class="bcp14">MAY</span> be used as a hint for path MTU discovery
   <span>[<a href="#RFC1191" class="cite xref">RFC1191</a>]</span> <span>[<a href="#RFC8201" class="cite xref">RFC8201</a>]</span>, but this could be difficult because of known
   issues with ICMP blocking <span>[<a href="#RFC2923" class="cite xref">RFC2923</a>]</span> as well as UDP lacking automatic
   retransmission.<a href="#section-11.5-5" class="pilcrow">¶</a></p>
<p id="section-11.5-6">MDS is more likely to be useful when coupled with IP source
   fragmentation or UDP fragmentation to limit the largest reassembled
   UDP message as indicated by MRDS (see <a href="#sec-mrds" class="auto internal xref">Section 11.6</a>), e.g., when
   EMTU_R is larger than the required minimums (576 for IPv4 <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span>
   and 1500 for IPv6 <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>).<a href="#section-11.5-6" class="pilcrow">¶</a></p>
<p id="section-11.5-7">&gt;&gt; MDS can be used with DPLPMTUD <span>[<a href="#RFC8899" class="cite xref">RFC8899</a>]</span> to provide a hint to the
   Packetization Layer Path MTU (PLPMTU) value, though it <span class="bcp14">MUST NOT</span>
   prohibit transmission of larger UDP packets used as DPLPMTUD probes.<a href="#section-11.5-7" class="pilcrow">¶</a></p>
<p id="section-11.5-8">MDS is reported to the user, whether used per-datagram or per-
   fragment (as defined in <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). When used per-fragment, the
   reported value is the minimum of the MDS values received per-
   fragment.<a href="#section-11.5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-mrds">
<section id="section-11.6">
        <h3 id="name-maximum-reassembled-datagra">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-maximum-reassembled-datagra" class="section-name selfRef">Maximum Reassembled Datagram Size (MRDS)</a>
        </h3>
<p id="section-11.6-1">The Maximum Reassembled Datagram Size (MRDS, Kind=5) Option is a 16-
   bit indicator of the largest reassembled UDP datagram that can be
   received, including the UDP header and any per-datagram UDP Options,
   accompanied by an 8-bit indication of how many UDP fragments can be
   reassembled. The MRDS size field is the UDP equivalent of IP's EMTU_R, but the
   two are not related <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>. Using the FRAG Option (<a href="#sec-frag" class="auto internal xref">Section 11.4</a>),
   UDP packets can be transmitted as transport fragments, each in their
   own (presumably not fragmented) IP datagram, and be reassembled at
   the UDP layer. MRDS segs is the number of UDP fragments that can be
   reassembled.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<span id="name-udp-mrds-option-format"></span><div id="fig-14">
<figure id="figure-14">
          <div class="alignLeft art-text artwork" id="section-11.6-2.1">
<pre>
            +--------+--------+--------+--------+---------+
            | Kind=5 | Len=5  |    MRDS size    |MRDS segs|
            +--------+--------+--------+--------+---------+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-udp-mrds-option-format" class="selfRef">UDP MRDS Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.6-3">&gt;&gt; Endpoints supporting UDP Options <span class="bcp14">MUST</span> support a local MRDS size
   of at least 2,926 bytes for IPv4 and 2,886 bytes for IPv6. Support
   for larger values is encouraged.<a href="#section-11.6-3" class="pilcrow">¶</a></p>
<p id="section-11.6-4">&gt;&gt; Endpoints supporting UDP Options <span class="bcp14">MUST</span> support a local MRDS segs
 value of at least 2. Support for larger values is encouraged.<a href="#section-11.6-4" class="pilcrow">¶</a></p>
<p id="section-11.6-5">These parameters plus the Path MTU (PMTU) allow a sender to compute the size of
   the largest pre-fragmentation UDP packet that a receiver will
   guarantee to accept. MMS_S is defined as the PMTU less the size of
   the IP header and the UDP header, i.e., the maximum UDP message size
   that can be successfully sent in a single UDP datagram if there are
   no IP options or extension headers and no UDP per-fragment options.
   Given the above size definitions, the size of the largest pre-fragmentation UDP packet that the
   receiver will guarantee to accept is the smaller of the MRDS size
   and the following:<a href="#section-11.6-5" class="pilcrow">¶</a></p>
<p id="section-11.6-6">(MMS_S - 12) * (MRDS segs) - 2 - (Total Per-Frag IP/UDP Options) + 8<a href="#section-11.6-6" class="pilcrow">¶</a></p>
<p id="section-11.6-7">In the above expression, the Total Per-Frag IP/UDP Options includes the size of all IP
   options and extension headers and all per-fragment UDP Options,
   except for OCS and FRAG, that are in the sequence of UDP fragments.<a href="#section-11.6-7" class="pilcrow">¶</a></p>
<p id="section-11.6-8">&gt;&gt; If no MRDS Option has been received, a sender <span class="bcp14">MUST</span> assume that
   MRDS size is 2,926 bytes for IPv4 and 2,886 bytes for IPv6 and that
   MRDS segs is 2, i.e., the minimum values allowed.<a href="#section-11.6-8" class="pilcrow">¶</a></p>
<p id="section-11.6-9">MRDS is reported to the user, whether used per-datagram or per-
   fragment (as defined in <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). When used per-fragment, the
   reported value is the minimum of the MRDS values received per-
   fragment.<a href="#section-11.6-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="echo-request-req-and-echo-response-res">
<section id="section-11.7">
        <h3 id="name-echo-request-req-and-echo-r">
<a href="#section-11.7" class="section-number selfRef">11.7. </a><a href="#name-echo-request-req-and-echo-r" class="section-name selfRef">Echo Request (REQ) and Echo Response (RES)</a>
        </h3>
<p id="section-11.7-1">The echo Request (REQ, Kind=6) and echo Response (RES, Kind=7)
   Options provide UDP packet-level acknowledgments as a capability
   for use by upper layer protocols, e.g., user applications,
   libraries, operating systems, etc. Both the REQ and RES are under
   the control of these upper layers, i.e., UDP Option support
   described in this document never automatically responds to a REQ
   with a RES. Instead, the REQ is delivered to the upper layer, which
   decides whether and when to issue a RES.<a href="#section-11.7-1" class="pilcrow">¶</a></p>
<p id="section-11.7-2">One such use is described as part of DPLPMTUD <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>. This use case
   is described as part of UDP Options but is logically considered to
   be a capability of an upper layer that uses UDP Options. The options
   both have the format indicated in <a href="#fig-15" class="auto internal xref">Figure 15</a>, in which the token has
   no internal structure or meaning.<a href="#section-11.7-2" class="pilcrow">¶</a></p>
<span id="name-udp-req-and-res-options-for"></span><div id="fig-15">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="section-11.7-3.1">
<pre>
                +--------+--------+-----------------+
                |  Kind  | Len=6  |      token      |
                +--------+--------+-----------------+
                  1 byte   1 byte       4 bytes
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-udp-req-and-res-options-for" class="selfRef">UDP REQ and RES Options Format</a>
          </figcaption></figure>
</div>
<p id="section-11.7-4">&gt;&gt; As advice to upper layer protocol/library designers, when
   supporting REQ/RES and responding with a RES, the upper layer <span class="bcp14">SHOULD</span>
   respond with the most recently received REQ token.<a href="#section-11.7-4" class="pilcrow">¶</a></p>
<p id="section-11.7-5">&gt;&gt; If the implementation includes a layer/library that produces and
   consumes REQ/RES on behalf of the user/application, then that layer
   <span class="bcp14">MUST</span> be disabled by default; in this case, REQ/RES are simply sent
   upon request by the user/application and passed to it when received,
 as with most other UDP Options.<a href="#section-11.7-5" class="pilcrow">¶</a></p>
<p id="section-11.7-6">For example, an application needs to explicitly enable the
   generation of a RES Option by DPLPMTUD when using UDP Options
   <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>.<a href="#section-11.7-6" class="pilcrow">¶</a></p>
<p id="section-11.7-7">&gt;&gt; The token transmitted in a RES Option <span class="bcp14">MUST</span> be a token received in
   a REQ Option by the transmitter. This ensures that the response is
   to a received request.<a href="#section-11.7-7" class="pilcrow">¶</a></p>
<p id="section-11.7-8">REQ and RES Option kinds each appear at most once in each UDP
   packet, as with most other options. A single packet can include both
   options, though they would be otherwise unrelated to each other.
   Note also that the FRAG Option is not used when sending DPLPMTUD
   probes to determine a PLPMTU <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>.<a href="#section-11.7-8" class="pilcrow">¶</a></p>
<p id="section-11.7-9">REQ and RES are reported to the user, whether used per-datagram or
   per-fragment (as defined in <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). When used per-fragment,
   the reported value indicates the most recently received token.<a href="#section-11.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timestamps-time">
<section id="section-11.8">
        <h3 id="name-timestamp-time">
<a href="#section-11.8" class="section-number selfRef">11.8. </a><a href="#name-timestamp-time" class="section-name selfRef">Timestamp (TIME)</a>
        </h3>
<p id="section-11.8-1">Timestamps are provided as a capability to be used by applications
   and other upper layer protocols. They are based on a notion of time
   as a monotonically non-decreasing unsigned integer, with wraparound.
   They are defined the same way as TCP Protection Against Wrapped
   Sequence (PAWS) numbers, i.e., "without any connection to [real-world,
   classical physics wall-clock] time" <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>. They are quite
   similar to the behavior of relativistic time or the individual
   scalars of Lamport clocks <span>[<a href="#La78" class="cite xref">La78</a>]</span>. However, if desired, they can
   correspond to real-world time, e.g., as used for round-trip time (RTT)
   estimation. This option makes no assertions as to which is the case;
 the decision is up to the application layer using this option.<a href="#section-11.8-1" class="pilcrow">¶</a></p>
<p id="section-11.8-2">The Timestamp (TIME, Kind=8) Option exchanges two four-byte unsigned
   timestamp fields. It serves a similar purpose to TCP's Timestamp (TS) Option
   <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>, enabling UDP to estimate the RTT
   between hosts. For UDP, this RTT can be useful for establishing UDP
   fragment reassembly timeouts or transport-layer rate limiting
   <span>[<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>.<a href="#section-11.8-2" class="pilcrow">¶</a></p>
<span id="name-udp-time-option-format"></span><div id="fig-16">
<figure id="figure-16">
          <div class="alignLeft art-text artwork" id="section-11.8-3.1">
<pre>
     +--------+--------+------------------+------------------+
     | Kind=8 | Len=10 |      TSval       |      TSecr       |
     +--------+--------+------------------+------------------+
       1 byte   1 byte       4 bytes            4 bytes
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-udp-time-option-format" class="selfRef">UDP TIME Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.8-4">TS Value (TSval) and TS Echo Reply (TSecr) are used in a similar
   manner to the TCP TS Option <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>. On transmitted UDP packets
   using the option, TSval is always set based on the local "time"
   value. Received TSval and TSecr field contents are provided to the
   application, which can pass the received TSval to be used as TSecr in
   UDP messages sent in response (i.e., to echo the received TSval). A
   received TSecr of zero indicates that the TSval was not echoed by
   the transmitter, i.e., from a previously received UDP packet.<a href="#section-11.8-4" class="pilcrow">¶</a></p>
<p id="section-11.8-5">&gt;&gt; TIME <span class="bcp14">MAY</span> use an RTT estimate based on non-zero Timestamp values as
   a hint for fragmentation reassembly, rate limiting, or other
   mechanisms that benefit from such an estimate.<a href="#section-11.8-5" class="pilcrow">¶</a></p>
<p id="section-11.8-6">&gt;&gt; An application <span class="bcp14">MAY</span> use TIME to compute this RTT estimate for
   further use by the user.<a href="#section-11.8-6" class="pilcrow">¶</a></p>
<p id="section-11.8-7">UDP timestamps are modeled after TCP timestamps and have similar
   expectations. In particular, they are expected to follow these
   guidelines:<a href="#section-11.8-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.8-8.1">
            <p id="section-11.8-8.1.1">Values are monotonic and non-decreasing except for anticipated
 number-space rollover events.<a href="#section-11.8-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.8-8.2">
            <p id="section-11.8-8.2.1">Values "increase" (allowing for rollover, i.e., modulo the field
 size except zero) according to a typical 'tick' time.<a href="#section-11.8-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.8-8.3">
            <p id="section-11.8-8.3.1">A request is defined as TSval being non-zero, and a reply is
 defined as TSecr being non-zero.<a href="#section-11.8-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.8-8.4">
            <p id="section-11.8-8.4.1">A receiver always responds to a request with the highest TSval
 received (allowing for rollover), which is not necessarily the
 most recently received.<a href="#section-11.8-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.8-9">Rollover can be handled as a special case or more completely using
   sequence number extension <span>[<a href="#RFC9187" class="cite xref">RFC9187</a>]</span>; however, zero values need to be
   avoided explicitly.<a href="#section-11.8-9" class="pilcrow">¶</a></p>
<p id="section-11.8-10">&gt;&gt; TIME values <span class="bcp14">MUST NOT</span> use zeros as valid time values, because they
   are used as indicators of requests and responses.<a href="#section-11.8-10" class="pilcrow">¶</a></p>
<p id="section-11.8-11">TIME is reported to the user, whether used per-datagram or per-
   fragment (as defined in <a href="#sec-frag" class="auto internal xref">Section 11.4</a>). When used per-fragment, the
   reported value is the minimum and maximum of each of the timestamp
   values received per-fragment.<a href="#section-11.8-11" class="pilcrow">¶</a></p>
<p id="section-11.8-12">&gt;&gt; Use of TIME per-fragment is <span class="bcp14">NOT RECOMMENDED</span>. Exceptions include
   supporting diagnostics on the reassembly process itself, which could
   be more appropriate to handle within the UDP Option processing
   implementation.<a href="#section-11.8-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-auth">
<section id="section-11.9">
        <h3 id="name-authentication-auth-reserve">
<a href="#section-11.9" class="section-number selfRef">11.9. </a><a href="#name-authentication-auth-reserve" class="section-name selfRef">Authentication (AUTH), RESERVED Only</a>
        </h3>
<p id="section-11.9-1">The Authentication (AUTH, Kind=9) Option is reserved for all UDP
   authentication mechanisms <span>[<a href="#I-D.touch-tsvwg-udp-auth-opt" class="cite xref">To24</a>]</span>. AUTH is expected to cover the UDP
   user data and UDP Options, with possible additional coverage of the
   IP pseudoheader and UDP header and potentially also support for NAT
   traversal (i.e., by zeroing the remote socket -- the source IP
   address and UDP port -- before computing the check), the latter in a
   similar manner as per TCP Authentication Option (TCP-AO) NAT traversal <span>[<a href="#RFC6978" class="cite xref">RFC6978</a>]</span>.<a href="#section-11.9-1" class="pilcrow">¶</a></p>
<p id="section-11.9-2">Like APC, AUTH is a SAFE Option because it does not modify the UDP
   user data. AUTH could fail even where the user data has not been
   corrupted, such as when its contents have been overwritten. Such
   overwrites could be intentional and not widely known; defaulting to
   silent ignore ensures that option-aware endpoints do not change how
   users or applications operate unless explicitly directed to do
   otherwise. When a socket pair relies on AUTH, e.g., upon
   configuration of a security policy, this default is expected to be
   overridden, where incoming packets without AUTH or with a failed
   AUTH check would be silently dropped, such that only authenticated
   packets would be sent to the user. This approach enables security
   checks for AUTH to occur above UDP, in a separate shim layer or
   application library.<a href="#section-11.9-2" class="pilcrow">¶</a></p>
<p id="section-11.9-3">A specification for using AUTH is expected to define the
   coordination of AUTH security parameters and configuration of the
   socket pair when those parameters are installed. That specification
   is expected to address rules for when AUTH is required upon
   transmission and when the presence and correct validation of AUTH is
   required on reception.<a href="#section-11.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-exp">
<section id="section-11.10">
        <h3 id="name-experimental-exp">
<a href="#section-11.10" class="section-number selfRef">11.10. </a><a href="#name-experimental-exp" class="section-name selfRef">Experimental (EXP)</a>
        </h3>
<p id="section-11.10-1">The Experimental (EXP, Kind=127) Option is allocated for experiments
   <span>[<a href="#RFC3692" class="cite xref">RFC3692</a>]</span>. Only one such value is allocated because experiments are
   expected to use an Experimental ID (ExID) to differentiate
   concurrent use for different purposes, using UDP ExIDs registered
   with IANA according to the approach developed for TCP experimental
   options <span>[<a href="#RFC6994" class="cite xref">RFC6994</a>]</span>.<a href="#section-11.10-1" class="pilcrow">¶</a></p>
<span id="name-udp-exp-option-format"></span><div id="fig-17">
<figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-11.10-2.1">
<pre>
            +----------+----------+----------+----------+
            | Kind=127 |   Len    |      UDP ExID       |
            +----------+----------+----------+----------+
            |  (option contents, as defined)...         |
            +----------+----------+----------+----------+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-udp-exp-option-format" class="selfRef">UDP EXP Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.10-3">&gt;&gt; The length of the Experimental Option <span class="bcp14">MUST</span> be at least 4 to
   account for the Kind, Len, and 16-bit UDP ExID
   (similar to TCP ExIDs <span>[<a href="#RFC6994" class="cite xref">RFC6994</a>]</span>).<a href="#section-11.10-3" class="pilcrow">¶</a></p>
<p id="section-11.10-4">The UDP EXP Option uses only 16-bit ExIDs, unlike TCP ExIDs. In TCP,
   the first 16 bits of the ExID is unique; the additional 16 bits,
   where present, are used to decrease the chance of the entire ExID
   occurring in legacy use of the TCP EXP Option. This extended variant
   provides no similar use for UDP EXP because ExIDs are required.<a href="#section-11.10-4" class="pilcrow">¶</a></p>
<p id="section-11.10-5">The UDP EXP Option also includes an Extended Length format, where
   the option Len is 255, followed by two bytes of Extended Length.<a href="#section-11.10-5" class="pilcrow">¶</a></p>
<span id="name-udp-exp-extended-option-for"></span><div id="fig-18">
<figure id="figure-18">
          <div class="alignLeft art-text artwork" id="section-11.10-6.1">
<pre>
            +----------+----------+----------+----------+
            | Kind=127 |   255    |   Extended Length   |
            +----------+----------+----------+----------+
            |      UDP ExID       |(option contents...) |
            +----------+----------+----------+----------+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-udp-exp-extended-option-for" class="selfRef">UDP EXP Extended Option Format</a>
          </figcaption></figure>
</div>
<p id="section-11.10-7">UDP Experimental IDs (ExIDs) are assigned from a combined
   TCP/UDP ExID registry managed by IANA (see <a href="#sec-iana-cons" class="auto internal xref">Section 26</a>). Assigned
   ExIDs can be used in either the EXP or UEXP Options (see <a href="#sec-uexp" class="auto internal xref">Section 12.3</a> 
   for the latter).<a href="#section-11.10-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-unsafe-opt">
<section id="section-12">
      <h2 id="name-unsafe-options">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-unsafe-options" class="section-name selfRef">UNSAFE Options</a>
      </h2>
<p id="section-12-1">UNSAFE Options are not safe to ignore and can be used
   unidirectionally or without soft-state confirmation of UDP Option
   capability. They are always used only when the user data occurs
   inside a reassembled set of one or more UDP fragments, such that if
   UDP fragmentation is not supported, the enclosed UDP user data would
   be silently dropped anyway.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">&gt;&gt; Applications using UNSAFE Options <span class="bcp14">SHOULD NOT</span> also use zero-length
   UDP packets as signals, because they will arrive when UNSAFE Options
   fail. Those that choose to allow such packets <span class="bcp14">MUST</span> account for such
   events.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">&gt;&gt; UNSAFE Options <span class="bcp14">MUST</span> be used only as part of UDP fragments, used
      either per-fragment or after reassembly.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">&gt;&gt; Receivers supporting UDP Options <span class="bcp14">MUST</span> silently drop the UDP user
   data of the reassembled datagram if any fragment or the entire
   datagram includes an UNSAFE Option whose Kind is not supported or
   if an UNSAFE Option appears outside the context of a fragment or
   reassembled fragments.<a href="#section-12-4" class="pilcrow">¶</a></p>
<div id="unsafe-compression-ucmp">
<section id="section-12.1">
        <h3 id="name-unsafe-compression-ucmp">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-unsafe-compression-ucmp" class="section-name selfRef">UNSAFE Compression (UCMP)</a>
        </h3>
<p id="section-12.1-1">The UNSAFE Compression (UCMP, Kind=192) Option is reserved for all
   UDP compression mechanisms. UCMP is expected to cover the UDP user
   data and some (e.g., later, in sequence) UDP Options.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unsafe-encryption-uenc">
<section id="section-12.2">
        <h3 id="name-unsafe-encryption-uenc">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-unsafe-encryption-uenc" class="section-name selfRef">UNSAFE Encryption (UENC)</a>
        </h3>
<p id="section-12.2-1">The UNSAFE Encryption (UENC, Kind=193) Option is reserved for all
   UDP encryption mechanisms. UENC is expected to provide all of the
   services of the AUTH Option (<a href="#sec-auth" class="auto internal xref">Section 11.9</a>) and in addition to
   encrypt the UDP user data and some (e.g., later or in sequence) UDP
   Options, in a similar manner as TCP Authentication Option Extension for Payload Encryption (TCP-AO-ENC) <span>[<a href="#I-D.touch-tcp-ao-encrypt" class="cite xref">To18</a>]</span>.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-uexp">
<section id="section-12.3">
        <h3 id="name-unsafe-experimental-uexp">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-unsafe-experimental-uexp" class="section-name selfRef">UNSAFE Experimental (UEXP)</a>
        </h3>
<p id="section-12.3-1">The UNSAFE Experimental (UEXP, Kind=254) Option is reserved for
   experiments <span>[<a href="#RFC3692" class="cite xref">RFC3692</a>]</span>. As with EXP, only one such UEXP value is
   reserved because experiments are expected to use an Experimental ID
   (ExIDs) to differentiate concurrent use for different purposes,
   using UDP ExIDs registered with IANA according to the approach
   developed for TCP experimental options <span>[<a href="#RFC6994" class="cite xref">RFC6994</a>]</span>.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">Assigned ExIDs can be used with either the UEXP or EXP Options.<a href="#section-12.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-rules">
<section id="section-13">
      <h2 id="name-rules-for-designing-new-opt">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-rules-for-designing-new-opt" class="section-name selfRef">Rules for Designing New Options</a>
      </h2>
<p id="section-13-1">The UDP Option Kind space allows for the definition of new options;
   however, the currently defined options (including AUTH, UENC, and
   UCMP) do not allow for arbitrary new options. The following is a
   summary of rules for new options and their rationales:<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">&gt;&gt; New options <span class="bcp14">MUST NOT</span> be defined as "must-implement", i.e., they
   are not eligible for the asterisk ("*") designation used in <a href="#sec-udp-opt" class="auto internal xref">Section 10</a>.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">This document defines the minimum set of "must-implement" UDP
   Options. All new options are included at the discretion of a given
   implementation.<a href="#section-13-3" class="pilcrow">¶</a></p>
<p id="section-13-4">&gt;&gt; New options <span class="bcp14">MUST NOT</span> modify the content of options that precede
   them (in order of appearance and thus processing).<a href="#section-13-4" class="pilcrow">¶</a></p>
<p id="section-13-5">&gt;&gt; The fields of new options <span class="bcp14">MUST NOT</span> depend on the content of other
   options.<a href="#section-13-5" class="pilcrow">¶</a></p>
<p id="section-13-6">UNSAFE Options can both depend on and vary user data content because
   they are contained only inside UDP fragments and thus are processed
   only by receivers capable of handling UDP Options.<a href="#section-13-6" class="pilcrow">¶</a></p>
<p id="section-13-7">&gt;&gt; New options <span class="bcp14">MUST NOT</span> declare their order relative to other
      options, whether new or old, even as a preference.<a href="#section-13-7" class="pilcrow">¶</a></p>
<p id="section-13-8">&gt;&gt; At the sender, new options <span class="bcp14">MUST NOT</span> modify UDP packet content
   anywhere outside their option field, excepting only UNSAFE Options; areas that need to remain
   unmodified include the IP header, IP options, UDP user data, and
   surplus area (i.e., other options).<a href="#section-13-8" class="pilcrow">¶</a></p>
<p id="section-13-9">&gt;&gt; Options <span class="bcp14">MUST NOT</span> be modified in transit. This includes those
   already defined as well as new options.<a href="#section-13-9" class="pilcrow">¶</a></p>
<p id="section-13-10">&gt;&gt; New options <span class="bcp14">MUST NOT</span> require or allow that any UDP Options
   (including themselves) or the remaining surplus area be modified in
      transit.<a href="#section-13-10" class="pilcrow">¶</a></p>
<p id="section-13-11">&gt;&gt; All options <span class="bcp14">MUST</span> indicate whether they can be used per-fragment
   and, if so, <span class="bcp14">MUST</span> also indicate how their success or failure is
   reported to the user. It is <span class="bcp14">RECOMMENDED</span> that new options be designed to support per-fragment use; it is also <span class="bcp14">RECOMMENDED</span> that options used per-fragment
   be reported to the user as a finite aggregate (e.g., a sum,
      a flag, etc.) rather than individually.<a href="#section-13-11" class="pilcrow">¶</a></p>
<p id="section-13-12">With one exception, UNSAFE Options are used when UDP user data needs to be modified:<a href="#section-13-12" class="pilcrow">¶</a></p>
<p id="section-13-13">&gt;&gt; The FRAG Option modifies UDP user data, splitting it across
 multiple IP packets. UNSAFE Options <span class="bcp14">MAY</span> modify the UDP user data,
 e.g., by encryption, compression, or other transformations. All
 other (SAFE) options <span class="bcp14">MUST NOT</span> modify the UDP user data.<a href="#section-13-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-opt-inclusion">
<section id="section-14">
      <h2 id="name-option-inclusion-and-proces">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-option-inclusion-and-proces" class="section-name selfRef">Option Inclusion and Processing</a>
      </h2>
<p id="section-14-1">The following rules apply to option inclusion by senders and
   processing by receivers.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">&gt;&gt; Senders <span class="bcp14">MAY</span> add any option, as configured by the API.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">&gt;&gt; All "must-support" options <span class="bcp14">MUST</span> be processed by receivers, if
      present (presuming UDP Options are supported at that receiver).<a href="#section-14-3" class="pilcrow">¶</a></p>
<p id="section-14-4">&gt;&gt; Options that are not "must-support" options <span class="bcp14">MAY</span>, if present, be ignored by receivers,
   based, e.g., on API settings.<a href="#section-14-4" class="pilcrow">¶</a></p>
<p id="section-14-5">&gt;&gt; All options <span class="bcp14">MUST</span> be processed by receivers in the order
   encountered in the options area.<a href="#section-14-5" class="pilcrow">¶</a></p>
<p id="section-14-6">&gt;&gt; Unless configuration settings direct otherwise, all options
   except UNSAFE Options <span class="bcp14">MUST</span> result in the UDP user data being passed
   to the upper layer protocol or application, regardless of whether
   all options are processed, are supported, or succeed.<a href="#section-14-6" class="pilcrow">¶</a></p>
<p id="section-14-7">The basic premise is that, for options-aware endpoints, the sender
   decides what options to add and the receiver decides what options to
   handle. Simply adding an option does not force work upon a receiver,
   with the exception of the "must-support" options.<a href="#section-14-7" class="pilcrow">¶</a></p>
<p id="section-14-8">Upon receipt, the receiver checks various properties of the UDP
   packet and its options to decide whether to accept or drop the UDP
   packet and whether to accept or ignore some of its options as
   follows (in order):<a href="#section-14-8" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-14-9">
<pre>
        if the UDP checksum fails then
            silently drop the entire UDP packet (per RFC 1122)
        if the UDP checksum passes or is zero then
            if (OCS != 0 and OCS fails) or
               (OCS == 0 and UDP CS != 0) then
                deliver the UDP user data but ignore other options
                (this is required to emulate legacy behavior)
            if (OCS != 0 and OCS passes) or
               (OCS == 0 and UDP CS == 0) then
                deliver the UDP user data after parsing
                and processing the rest of the options,
                regardless of whether each is supported or succeeds
                (again, this is required to emulate legacy behavior)
</pre><a href="#section-14-9" class="pilcrow">¶</a>
</div>
<p id="section-14-10">The design of the UNSAFE Options ensures that the resulting UDP data
   will be silently dropped in both legacy receivers and options-aware receivers
   that do not recognize those options. Again, note that this still
   results in the delivery of a zero-length UDP packet.<a href="#section-14-10" class="pilcrow">¶</a></p>
<p id="section-14-11">Options-aware receivers can drop UDP packets with option processing
   errors via either an override of the default UDP processing or at
   the application layer.<a href="#section-14-11" class="pilcrow">¶</a></p>
<p id="section-14-12">Put another way, all options are treated the same, in that the transmitter can
   add each option as desired and the receiver has the choice to require a given option or
   not. Only if a particular option is indicated as mandatory by a receiver (e.g., by API configuration) would the
   receiver need to confirm it being present and correct.<a href="#section-14-12" class="pilcrow">¶</a></p>
<p id="section-14-13">In summary, for all options:<a href="#section-14-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14-14.1">
          <p id="section-14-14.1.1">if the option is not required by the receiver, then UDP packets
 missing the option are accepted.<a href="#section-14-14.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-14-14.2">
          <p id="section-14-14.2.1">if the option is required (e.g., by override of the default
 behavior at the receiver) and missing or incorrectly formed,
 silently drop the UDP packet.<a href="#section-14-14.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-14-14.3">
          <p id="section-14-14.3.1">if the UDP packet is accepted (either because the option is not
 required or because it was required and correct), then pass the
 option with the UDP packet via the API. Note that FRAG, NOP, and
 EOL are not passed to the user (see <a href="#sec-udp-api" class="auto internal xref">Section 15</a>).<a href="#section-14-14.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-14-15">&gt;&gt; Any options whose length exceeds that of the UDP packet (i.e.,
   intending to use data that would have been beyond the surplus area)
   <span class="bcp14">SHOULD</span> be silently ignored (again to model legacy behavior).<a href="#section-14-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udp-api">
<section id="section-15">
      <h2 id="name-udp-api-extensions">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-udp-api-extensions" class="section-name selfRef">UDP API Extensions</a>
      </h2>
<p id="section-15-1">UDP currently specifies an Application Programming Interface (API),
   summarized as follows (with Unix-style command as an example)
   <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>:<a href="#section-15-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-2.1">
          <p id="section-15-2.1.1">Method to create new receive ports<a href="#section-15-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-2.1.2.1">
              <p id="section-15-2.1.2.1.1">e.g., bind(handle, recvaddr(optional), recvport)<a href="#section-15-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-15-2.2">
          <p id="section-15-2.2.1">Receive, which returns data octets, source port, and source
address<a href="#section-15-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-2.2.2.1">
              <p id="section-15-2.2.2.1.1">e.g., recvfrom(handle, srcaddr, srcport, data)<a href="#section-15-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-15-2.3">
          <p id="section-15-2.3.1">Send, which specifies data, source and destination addresses, and
source and destination ports<a href="#section-15-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-2.3.2.1">
              <p id="section-15-2.3.2.1.1">e.g., sendto(handle, destaddr, destport, data)<a href="#section-15-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-15-3">This API is extended to support options as follows:<a href="#section-15-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.1">
          <p id="section-15-4.1.1">Extend the method to create receive ports to include per-packet
 and per-fragment receive options that are required or omitted as
 indicated by the application.<a href="#section-15-4.1.1" class="pilcrow">¶</a></p>
<p id="section-15-4.1.2">
&gt;&gt; Datagrams not containing these required options <span class="bcp14">MUST</span> be
 silently dropped and <span class="bcp14">SHOULD</span> be logged.<a href="#section-15-4.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-4.2">
          <p id="section-15-4.2.1">Extend the method to create receive ports to have a means to
 indicate that all packets containing UDP Options that are
 received on a particular socket pair are to be discarded.<a href="#section-15-4.2.1" class="pilcrow">¶</a></p>
<p id="section-15-4.2.2">
&gt;&gt; The default value for the setting to drop all packets
 containing UDP Options <span class="bcp14">MUST</span> be to process packets containing UDP
 Options normally (i.e., not to discard them).<a href="#section-15-4.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-4.3">
          <p id="section-15-4.3.1">Extend the receive function to indicate the per-packet options
 and their parameters as received with the corresponding received
 datagram. Note that per-fragment options are handled within the
 processing of each fragment.<a href="#section-15-4.3.1" class="pilcrow">¶</a></p>
<p id="section-15-4.3.2">
&gt;&gt; Options and their processing status (success/fail) <span class="bcp14">MUST</span> be
 available to the user (i.e., application layer or upper layer
 protocol/service), both for the packet and for the fragment set,
 except for FRAG, NOP, and EOL; those three options are handled
 within UDP Option processing only. As a reminder (from <a href="#sec-opt-inclusion" class="auto internal xref">Section 14</a>), all options except UNSAFE Options <span class="bcp14">MUST</span> result in the UDP
 user data being passed to the application layer (unless
 overridden in the API), regardless of whether all options are
 processed, supported, or succeed.<a href="#section-15-4.3.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-4.4">
          <p id="section-15-4.4.1">For fragments, success for an option is reported only when all
 fragments succeed for that option.<a href="#section-15-4.4.1" class="pilcrow">¶</a></p>
<p id="section-15-4.4.2">
&gt;&gt; Per-fragment option status reporting <span class="bcp14">SHOULD</span> default as needed
 (e.g., not computed and/or not passed up to the upper layers) to
 minimize overhead unless actively requested (e.g., by the
   user/application layer).<a href="#section-15-4.4.2" class="pilcrow">¶</a></p>
<p id="section-15-4.4.3">
&gt;&gt; SAFE Options associated with fragments are accumulated when
 associated with the reassembled packet; values <span class="bcp14">MAY</span> be coalesced,
 e.g., to indicate that only an AUTH failure of a fragment
 occurred, rather than not indicating the AUTH status of each
 fragment.<a href="#section-15-4.4.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-4.5">
          <p id="section-15-4.5.1">Extend the send function to indicate the options to be added to
 the corresponding sent datagram. This includes indicating which
 options apply to individual fragments vs. which apply to the UDP
 packet prior to fragmentation, if fragmentation is enabled. This
 includes a minimum datagram length, such that the options list
 ends in EOL and additional space is zero-filled as needed. It
 also includes a maximum fragment size, e.g., as discovered by
 DPLPMTUD, whether implemented at the application layer per
 <span>[<a href="#RFC8899" class="cite xref">RFC8899</a>]</span> or in conjunction with other UDP Options <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>.<a href="#section-15-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-15-5">Examples of API instances for Linux and FreeBSD are provided in
   <a href="#implementation-information" class="auto internal xref">Appendix A</a> to encourage uniform cross-platform implementations.<a href="#section-15-5" class="pilcrow">¶</a></p>
<p id="section-15-6">APIs are not intended to provide user control over option order,
   especially on a per-packet basis, as this could create a covert
   channel (see <a href="#sec-sec-cons" class="auto internal xref">Section 25</a>). Similarly, APIs are not intended to
   provide user/application control over UDP fragment boundaries on a
   per-packet basis; they are, however, expected to allow control over
   which options, including fragmentation, are enabled (or disabled) on
   a per-packet basis. Such control over fragmentation is critical to
   DPLPMTUD.<a href="#section-15-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udp-options-are-for-transport-not-transit">
<section id="section-16">
      <h2 id="name-udp-options-are-for-transpo">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-udp-options-are-for-transpo" class="section-name selfRef">UDP Options Are for Transport, Not Transit</a>
      </h2>
<p id="section-16-1">UDP Options are indicated in the surplus area of the IP payload that
   is not used by UDP. That area is really part of the IP payload, not
   the UDP payload, and as such, it might be tempting to consider
   whether this is a generally useful approach to extending IP.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">Unfortunately, the surplus area exists only for transports that
   include their own transport layer payload length indicator. TCP and
   SCTP include header length fields that already provide space for
   transport options by indicating the total length of the header area,
   such that the entire remaining area indicated in the network layer
   (IP) is the transport payload. UDP-Lite already uses the UDP Length
   field to indicate the boundary between data covered by the transport
   checksum and data not covered, and so there is no remaining area
   where the length of the UDP-Lite payload as a whole can be indicated
   <span>[<a href="#RFC3828" class="cite xref">RFC3828</a>]</span>.<a href="#section-16-2" class="pilcrow">¶</a></p>
<p id="section-16-3">UDP Options are transport options. They are no more (or less)
   appropriate to be modified in-transit than any other portion of the
      transport datagram.<a href="#section-16-3" class="pilcrow">¶</a></p>
<p id="section-16-4">&gt;&gt; Generally, transport headers, options, and data are not intended
   to be modified in-transit. UDP Options are no exception and are
   specified here as "<span class="bcp14">MUST NOT</span> be altered in transit".<a href="#section-16-4" class="pilcrow">¶</a></p>
<p id="section-16-5">However, note that the UDP Option mechanism provides no specific
   protection against in-transit modification of the UDP header, UDP
   payload, or surplus area, except as provided by the OCS or the
   options selected (e.g., AUTH or UENC).<a href="#section-16-5" class="pilcrow">¶</a></p>
<p id="section-16-6">Unless protected by encryption (e.g., UENC or via other layers,
   like IPsec), UDP Options remain visible to devices on the network
   path. The decision to not require mandatory encryption for UDP
   Options to prevent such visibility was made because the key
   distribution and management infrastructure necessary to support such
   encryption does not exist in many of the deployment scenarios of
   interest, notably those that use UDP directly as a stateless and
   connectionless transport protocol (e.g., see <span>[<a href="#I-D.heard-dnsop-udp-opt-large-dns-responses" class="cite xref">He24</a>]</span>).<a href="#section-16-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-options-vs-lite">
<section id="section-17">
      <h2 id="name-udp-options-vs-udp-lite">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-udp-options-vs-udp-lite" class="section-name selfRef">UDP Options vs. UDP-Lite</a>
      </h2>
<p id="section-17-1">UDP-Lite provides partial checksum coverage so that UDP packets
   with errors in some locations can be delivered to the user
   <span>[<a href="#RFC3828" class="cite xref">RFC3828</a>]</span>. It uses a different transport protocol number (136) than
   UDP (17) to interpret the UDP Length field as the prefix covered by
   the UDP checksum.<a href="#section-17-1" class="pilcrow">¶</a></p>
<p id="section-17-2">UDP (protocol 17) already defines the UDP Length field as the limit
   of the UDP checksum but by default also limits the data provided to
   the application as that which precedes the UDP Length. A goal of
   UDP-Lite is to deliver data beyond UDP Length as a default, which is
   why a separate transport protocol number was required.<a href="#section-17-2" class="pilcrow">¶</a></p>
<p id="section-17-3">UDP Options do not use or need a separate transport protocol number
   because the data beyond the UDP Length offset (surplus data) is not
   provided to the application by default. That data is interpreted
   exclusively within the UDP transport layer.<a href="#section-17-3" class="pilcrow">¶</a></p>
<p id="section-17-4">UDP-Lite cannot support UDP Options, either as proposed here or in
   any other form, because the entire payload of the UDP packet is
   already defined as user data and there is no additional field in
   which to indicate a surplus area for options. The UDP Length field
   in UDP-Lite is already used to indicate the boundary between user
   data covered by the checksum and user data not covered.<a href="#section-17-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-legacy-int">
<section id="section-18">
      <h2 id="name-interactions-with-legacy-de">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-interactions-with-legacy-de" class="section-name selfRef">Interactions with Legacy Devices</a>
      </h2>
<p id="section-18-1">It has always been permissible for the UDP Length to be inconsistent
   with the IP transport payload length <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>. Such inconsistency
   has been utilized in UDP-Lite using a different transport number <span>[<a href="#RFC3828" class="cite xref">RFC3828</a>]</span>. 
   There are no known systems that use this inconsistency for UDP. 
   It is possible that such use might interact with UDP
   Options, i.e., where legacy systems might generate UDP datagrams
   that appear to have UDP Options. The OCS provides protection against
   such events and is stronger than a static "magic number".<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2">UDP Options have been tested as interoperable with Linux, macOS, and
   Windows Cygwin and worked through NAT devices. These systems
   successfully delivered only the user data indicated by the UDP
   Length field and silently discarded the surplus area.<a href="#section-18-2" class="pilcrow">¶</a></p>
<p id="section-18-3">One reported embedded device passes the entire IP datagram to the
   UDP application layer. Although this feature could enable
   application-layer UDP Option processing, it would require that
   conventional UDP user applications examine only the UDP user data.
   This feature is also inconsistent with the UDP application interface
      <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span> <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>.<a href="#section-18-3" class="pilcrow">¶</a></p>
<p id="section-18-4">It has been noted that Alcatel-Lucent's "Brick" Intrusion
   Detection System has a default configuration that interprets
   inconsistencies between UDP Length and IP Length as an attack to be
   reported. Note that other firewall systems, e.g., Check Point, use a
   default "relaxed UDP Length verification" to avoid falsely
      interpreting this inconsistency as an attack.<a href="#section-18-4" class="pilcrow">¶</a></p>
<p id="section-18-5">There are known uses of UDP exchanges of zero-length UDP user data
   packets, notably in the TIME protocol <span>[<a href="#RFC0868" class="cite xref">RFC0868</a>]</span>. The need to support
   such packets is also noted in the UDP usage guidelines <span>[<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>.
   Some of the mechanisms in this document can generate more zero-length 
   UDP packets for a UDP Option aware endpoint than for a legacy
   endpoint (e.g., based on some error conditions), and some
   can generate fewer (e.g., fragment reassembly). Because such packets
   inherently carry no unique transport header or transport content,
   endpoints are already expected to be tolerant of their (inadvertent)
   replication or loss by the network, so such variations are not
   expected to be problematic.<a href="#section-18-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="options-in-a-stateless-unreliable-transport-protocol">
<section id="section-19">
      <h2 id="name-options-in-a-stateless-unre">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-options-in-a-stateless-unre" class="section-name selfRef">Options in a Stateless, Unreliable Transport Protocol</a>
      </h2>
<p id="section-19-1">There are two ways to interpret options for a stateless, unreliable
   protocol -- an option is either local to the message or intended to
   affect a stream of messages in a soft-state manner. Either
   interpretation is valid for defined UDP Options.<a href="#section-19-1" class="pilcrow">¶</a></p>
<p id="section-19-2">It is impossible to know in advance whether an endpoint supports a
   UDP Option.<a href="#section-19-2" class="pilcrow">¶</a></p>
<p id="section-19-3">&gt;&gt; All UDP Options other than UNSAFE ones <span class="bcp14">MUST</span> be ignored if not
   supported or upon failure (e.g., APC).<a href="#section-19-3" class="pilcrow">¶</a></p>
<p id="section-19-4">&gt;&gt; All UDP Options that fail <span class="bcp14">MUST</span> result in the UDP data still being
   sent to the application layer by default to ensure equivalence with
   legacy devices.<a href="#section-19-4" class="pilcrow">¶</a></p>
<p id="section-19-5">UDP Options that rely on soft-state exchange need to allow message
   reordering and loss, in the same way as UDP applications <span>[<a href="#RFC8085" class="cite xref">RFC8085</a>]</span>.<a href="#section-19-5" class="pilcrow">¶</a></p>
<p id="section-19-6">The above requirements prevent using any option that cannot be
   safely ignored unless it is hidden inside the FRAG area (i.e.,
   UNSAFE Options). Legacy systems also always need to be able to
   interpret the transport fragments as individual UDP packets.<a href="#section-19-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="udp-option-state-caching">
<section id="section-20">
      <h2 id="name-udp-option-state-caching">
<a href="#section-20" class="section-number selfRef">20. </a><a href="#name-udp-option-state-caching" class="section-name selfRef">UDP Option State Caching</a>
      </h2>
<p id="section-20-1">Some TCP connection parameters, stored in the TCP Control Block (TCB), can
   be usefully shared either among concurrent connections or between
   connections in sequence, known as TCB sharing <span>[<a href="#RFC9040" class="cite xref">RFC9040</a>]</span>. Although
   UDP is stateless, some of the options proposed herein could have
   similar benefits in being shared or cached. We call this UCB sharing,
   or UDP Control Block sharing, by analogy. Just as TCB sharing is not
   a standard because it is consistent with existing TCP
   specifications, UCB sharing would be consistent with existing UDP
   specifications, including this one. Both are implementation issues
   that are outside the scope of their respective specifications, and
   so UCB sharing is outside the scope of this document.<a href="#section-20-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-updates-768">
<section id="section-21">
      <h2 id="name-updates-to-rfc-768">
<a href="#section-21" class="section-number selfRef">21. </a><a href="#name-updates-to-rfc-768" class="section-name selfRef">Updates to RFC 768</a>
      </h2>
<p id="section-21-1">This document updates <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span> as follows:<a href="#section-21-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-21-2.1">
          <p id="section-21-2.1.1">This document defines the meaning of the IP payload area beyond
 the UDP Length but within the IP Length as the surplus area used
 herein for UDP Options.<a href="#section-21-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-21-2.2">
          <p id="section-21-2.2.1">This document extends the UDP API to support the use of UDP
 Options.<a href="#section-21-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="interactions-with-other-rfcs-and-drafts">
<section id="section-22">
      <h2 id="name-interactions-with-other-rfc">
<a href="#section-22" class="section-number selfRef">22. </a><a href="#name-interactions-with-other-rfc" class="section-name selfRef">Interactions with Other RFCs</a>
      </h2>
<p id="section-22-1">This document clarifies the interaction between UDP Length and IP
   Length that is not explicitly constrained in either UDP or the host
      requirements <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span> <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>.<a href="#section-22-1" class="pilcrow">¶</a></p>
<p id="section-22-2">Teredo extensions define use of a similar difference between
   these lengths for trailers <span>[<a href="#RFC4380" class="cite xref">RFC4380</a>]</span> <span>[<a href="#RFC6081" class="cite xref">RFC6081</a>]</span>. In <span>[<a href="#RFC6081" class="cite xref">RFC6081</a>]</span>, Teredo extensions define the length
   of an IPv6 payload inside UDP as pointing to less than the end of
   the UDP payload, enabling trailing options for that IPv6 packet:<a href="#section-22-2" class="pilcrow">¶</a></p>
<blockquote id="section-22-3">
        <p id="section-22-3.1">...the IPv6 packet length (i.e., the Payload Length value in
the IPv6 header plus the IPv6 header size) is less than or
equal to the UDP payload length (i.e., the Length value in
the UDP header minus the UDP header size)<a href="#section-22-3.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-22-4">UDP Options are not affected by the difference between the UDP user
   payload end and the payload IPv6 end; both would end at the UDP user
   payload, which could end before the enclosing IPv4 or IPv6 header
   indicates -- allowing UDP Options in addition to the trailer options
   of the IPv6 payload. The result, if UDP Options were used, is shown
   in <a href="#fig-19" class="auto internal xref">Figure 19</a>.<a href="#section-22-4" class="pilcrow">¶</a></p>
<span id="name-te-trailers-and-udp-options"></span><div id="fig-19">
<figure id="figure-19">
        <div class="alignLeft art-text artwork" id="section-22-5.1">
<pre>
                         Outer IP Length
    &lt;----------------------------------------------------------&gt;
   +--------+---------+------------------------------+----------+
   | IP Hdr | UDP Hdr | IPv6 packet/len | TE trailer | surplus  |
   +--------+---------+------------------------------+----------+
                       &lt;---------------&gt;
                       Inner IPv6 Length
             &lt;--------------------------------------&gt;
                           UDP Length
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-te-trailers-and-udp-options" class="selfRef">TE Trailers and UDP Options Used Concurrently</a>
        </figcaption></figure>
</div>
<p id="section-22-6">UDP Options cannot be supported when a UDP packet has no independent
   UDP Length. One such case is when UDP Length==0 in IPv6, intended
   for (but not limited to) IPv6 Jumbograms <span>[<a href="#RFC2675" class="cite xref">RFC2675</a>]</span>. Note that
   although this technique is "Standard", the specification did not
   "update" UDP <span>[<a href="#RFC0768" class="cite xref">RFC0768</a>]</span>. Another such case arises when UDP is proxied
   via HTTP <span>[<a href="#RFC9298" class="cite xref">RFC9298</a>]</span>, as the UDP header is omitted and only the UDP
   user data is transported.<a href="#section-22-6" class="pilcrow">¶</a></p>
<p id="section-22-7">This document is consistent with the UDP profile for RObust Header
   Compression (ROHC) <span>[<a href="#RFC3095" class="cite xref">RFC3095</a>]</span>, noted here:<a href="#section-22-7" class="pilcrow">¶</a></p>
<blockquote id="section-22-8">
        <p id="section-22-8.1">The Length field of the UDP header <span class="bcp14">MUST</span> match the Length
field(s) of the preceding subheaders, i.e., there must not
be any padding after the UDP payload that is covered by the
IP Length.<a href="#section-22-8.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-22-9">ROHC compresses UDP headers only when this match succeeds. It does
   not prohibit UDP headers where the match fails; in those cases, ROHC
   default rules (<span><a href="https://rfc-editor.org/rfc/rfc3095#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC3095" class="cite xref">RFC3095</a>]</span>) would cause the UDP header to remain
   uncompressed. Upon receipt of a compressed UDP header, <span><a href="https://rfc-editor.org/rfc/rfc3095#appendix-A.1.3" class="relref">Appendix A.1.3</a> of [<a href="#RFC3095" class="cite xref">RFC3095</a>]</span>
   indicates that the UDP Length is "INFERRED"; in
   uncompressed packets, it would simply be explicitly provided.<a href="#section-22-9" class="pilcrow">¶</a></p>
<p id="section-22-10">This issue of handling UDP header compression is more explicitly
   described in more recent specifications, e.g., <span><a href="https://rfc-editor.org/rfc/rfc8724#section-10.10" class="relref">Section 10.10</a> of [<a href="#RFC8724" class="cite xref">RFC8724</a>]</span>.<a href="#section-22-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multicast-and-broadcast-considerations">
<section id="section-23">
      <h2 id="name-multicast-and-broadcast-con">
<a href="#section-23" class="section-number selfRef">23. </a><a href="#name-multicast-and-broadcast-con" class="section-name selfRef">Multicast and Broadcast Considerations</a>
      </h2>
<p id="section-23-1">UDP Options are primarily intended for unicast use. Using these
   options over multicast or broadcast IP requires careful
   consideration, e.g., to ensure that the options used are safe for
   different endpoints to interpret differently (e.g., either to
   support or silently ignore) or to ensure that all receivers of a
   multicast or broadcast group confirm support for the options in use.<a href="#section-23-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="network-management-considerations">
<section id="section-24">
      <h2 id="name-network-management-consider">
<a href="#section-24" class="section-number selfRef">24. </a><a href="#name-network-management-consider" class="section-name selfRef">Network Management Considerations</a>
      </h2>
<p id="section-24-1">UDP Options use and configuration may be useful to track and manage
   remotely. IP Flow Information Export (IPFIX) <span>[<a href="#RFC7011" class="cite xref">RFC7011</a>]</span> Information
   Elements for UDP Options have been defined in <span>[<a href="#RFC9870" class="cite xref">RFC9870</a>]</span>. Similar to
   what has been done for TCP <span>[<a href="#RFC9648" class="cite xref">RFC9648</a>]</span>, a YANG model <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span> for use
   by network management protocols (e.g., NETCONF <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span> or RESTCONF
   <span>[<a href="#RFC8040" class="cite xref">RFC8040</a>]</span>) may be developed. Development of these models is outside
   the scope of this document.<a href="#section-24-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-sec-cons">
<section id="section-25">
      <h2 id="name-security-considerations">
<a href="#section-25" class="section-number selfRef">25. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-25-1">There are a number of security issues raised by the introduction of
   options to UDP. Some are specific to this variant, but others are
   associated with any packet processing mechanism; all are discussed
   further in this section.<a href="#section-25-1" class="pilcrow">¶</a></p>
<div id="general-considerations-regarding-the-use-of-options">
<section id="section-25.1">
        <h3 id="name-general-considerations-rega">
<a href="#section-25.1" class="section-number selfRef">25.1. </a><a href="#name-general-considerations-rega" class="section-name selfRef">General Considerations Regarding the Use of Options</a>
        </h3>
<p id="section-25.1-1">Note that any user application that considers UDP Options to
   adversely affect security need not enable them. However, their use
   does not impact security in a substantially different way than TCP
   options; both enable the use of a control channel that has the
   potential for abuse. Similar to TCP, there are many options that, if
   unprotected, could be used by an attacker to interfere with
   communication.<a href="#section-25.1-1" class="pilcrow">¶</a></p>
<p id="section-25.1-2">UDP Options are not covered by DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. Neither TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>
   (Transport Layer Security for TCP) nor DTLS (TLS for UDP) protect
   the transport layer; both operate as a shim layer solely on the user
   data of transport packets, protecting only their contents.<a href="#section-25.1-2" class="pilcrow">¶</a></p>
<p id="section-25.1-3">Just as TLS does not protect the TCP header or its options, DTLS
   does not protect the UDP header or the new options introduced by
   this document. Transport security is provided in TCP by the TCP
   Authentication Option (TCP-AO) <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span> and (when defined) in UDP
   by the Authentication (AUTH) Option (<a href="#sec-auth" class="auto internal xref">Section 11.9</a>) and (when
   defined) the UNSAFE Encryption (UENC) Option (<a href="#sec-unsafe-opt" class="auto internal xref">Section 12</a>). Transport
   headers are also protected as payload when using IP security (IPsec)
   <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span>.<a href="#section-25.1-3" class="pilcrow">¶</a></p>
<p id="section-25.1-4">Some UDP Options are never passed to the receiving application,
   notably FRAG, NOP, and EOL. They are not intended to convey
   information, either by their presence (FRAG, EOL) or number (NOP).
   It could also be useful to provide the options received in a
   reference order (e.g., sorted by option number) to avoid the order
   of options being used as a covert channel.<a href="#section-25.1-4" class="pilcrow">¶</a></p>
<p id="section-25.1-5">All logging is rate limited to avoid logging itself becoming a
   resource vulnerability.<a href="#section-25.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-regarding-on-path-attacks">
<section id="section-25.2">
        <h3 id="name-considerations-regarding-on">
<a href="#section-25.2" class="section-number selfRef">25.2. </a><a href="#name-considerations-regarding-on" class="section-name selfRef">Considerations Regarding On-Path Attacks</a>
        </h3>
<p id="section-25.2-1">UDP Options, like any options, have the potential to expose option
   information to on-path attackers, unless the options themselves are
   encrypted (as might be the case with some configurations of UENC,
   when defined). Application protocol designers are expected to ensure
   that information in UDP Options is not used with the assumption of
   privacy unless UENC provides that capability. Application protocol
   designers using secure payload contents (e.g., via DTLS) are
   expected to be aware that UDP Options add information that is not
   inside the UDP payload and thus not protected by the same mechanism
   and that alternate mechanisms (again, as might be the case with some
   configurations of UENC) could be additionally required to protect
   against information disclosure.<a href="#section-25.2-1" class="pilcrow">¶</a></p>
<p id="section-25.2-2">&gt;&gt; Implementations concerned with the potential use of UDP Options
   as a covert channel <span class="bcp14">MAY</span> consider limiting use of some or all
   options. Such implementations <span class="bcp14">SHOULD</span> return options in an order not
   related to their sequence in the received packet.<a href="#section-25.2-2" class="pilcrow">¶</a></p>
<p id="section-25.2-3">UDP Options create new potential opportunities for Distributed DoS
   (DDos) attacks, notably through the use of fragmentation. When
   enabled, UDP Options cause additional work at the receiver; however,
   of the "must-support" options, only REQ (e.g., when used with
   DPLPMTUD <span>[<a href="#RFC9869" class="cite xref">RFC9869</a>]</span>) will cause the upper layer to initiate a UDP
   response in the absence of user transmission.<a href="#section-25.2-3" class="pilcrow">¶</a></p>
<p id="section-25.2-4">&gt;&gt; Implementations concerned with the potential for DoS attacks
   involving large numbers of UDP Options, either implemented or
   unknown, or excessive sequences of valid repeating options (e.g.,
   NOPs) <span class="bcp14">SHOULD</span> detect excessive numbers of such occurrences and limit
   resources they use, e.g., through silent packet drops. Such
   responses <span class="bcp14">SHOULD</span> be logged. Specific thresholds for such limits will
   vary based on implementation and are thus not included here.<a href="#section-25.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-regarding-option-processing">
<section id="section-25.3">
        <h3 id="name-considerations-regarding-op">
<a href="#section-25.3" class="section-number selfRef">25.3. </a><a href="#name-considerations-regarding-op" class="section-name selfRef">Considerations Regarding Option Processing</a>
        </h3>
<p id="section-25.3-1">UDP Options use the TLV syntax similar to that of TCP. This syntax
   is known to require serial processing and could pose a DoS risk,
   e.g., if an attacker adds large numbers of unknown options that need
   to be parsed in their entirety, as is the case for IPv6 <span>[<a href="#RFC8504" class="cite xref">RFC8504</a>]</span>.<a href="#section-25.3-1" class="pilcrow">¶</a></p>
<p id="section-25.3-2">The use of UDP packets with inconsistent IP and UDP Length fields
   has the potential to trigger a buffer overflow error if not properly
   handled, e.g., if space is allocated based on the smaller field and
   copying is based on the larger field. However, there have been no reports
   of such vulnerability, and it would rely on inconsistent use of the
   two fields for memory allocation and copying.<a href="#section-25.3-2" class="pilcrow">¶</a></p>
<p id="section-25.3-3">Because required options come first and at most once each (with the
   exception of NOPs, which never need to come in sequences of more
   than seven in a row), their DoS impact is limited. Note that TLV
   formats for options do require serial processing, but any format
   that allows future options, whether ignored or not, could introduce
   a similar DoS vulnerability.<a href="#section-25.3-3" class="pilcrow">¶</a></p>
<p id="section-25.3-4">&gt;&gt; Implementations concerned with the potential for UDP Options
   introducing a vulnerability <span class="bcp14">MAY</span> implement only the required UDP
   Options and <span class="bcp14">SHOULD</span> also limit processing of TLVs, in number
   of non-padding options, total length, or both. The number of non-zero
   TLVs allowed in such cases <span class="bcp14">MUST</span> be at least as many as the
   number of concurrent options supported with an additional few to
   account for unexpected unknown options but <span class="bcp14">SHOULD</span> also consider
   being adaptive and based on the implementation to avoid locking in
   that limit globally.<a href="#section-25.3-4" class="pilcrow">¶</a></p>
<p id="section-25.3-5">For example, if a system supports 10 different option types that could
   concurrently be used, it is expected to allow up to around 13-14
   different options in the same packet. This document avoids
   specifying a fixed minimum but recognizes that a given system might
   not expect to receive more than a few unknown option types per
   packet.<a href="#section-25.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-for-fragmentation">
<section id="section-25.4">
        <h3 id="name-considerations-for-fragment">
<a href="#section-25.4" class="section-number selfRef">25.4. </a><a href="#name-considerations-for-fragment" class="section-name selfRef">Considerations for Fragmentation</a>
        </h3>
<p id="section-25.4-1">UDP fragmentation introduces its own set of security concerns, which
   can be handled in a manner similar to IP reassembly or TCP segment
   reordering <span>[<a href="#CERT18" class="cite xref">CERT18</a>]</span>. In particular, the number of UDP packets
   pending reassembly and effort used for reassembly is typically
   limited. In addition, it could be useful to assume a reasonable
   minimum fragment size, e.g., that non-terminal fragments are never
   smaller than 500 bytes.<a href="#section-25.4-1" class="pilcrow">¶</a></p>
<p id="section-25.4-2">&gt;&gt; Implementations concerned with the potential for UDP
   fragmentation introducing a vulnerability <span class="bcp14">SHOULD</span> implement limits on
   the number of pending fragments.<a href="#section-25.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-for-providing-udp-security">
<section id="section-25.5">
        <h3 id="name-considerations-for-providin">
<a href="#section-25.5" class="section-number selfRef">25.5. </a><a href="#name-considerations-for-providin" class="section-name selfRef">Considerations for Providing UDP Security</a>
        </h3>
<p id="section-25.5-1">UDP security is not intended to rely solely on transport layer
   processing of options. UNSAFE Options are the only type that share
   fate with the UDP data because of the way that data is hidden in
   the surplus area until after those options are processed. All other
   options default to being silently ignored at the transport layer but
   could be dropped if that default is either overridden (e.g., by
   configuration) or discarded at the application layer (e.g., using
   information about the options processed that are passed along with
   the UDP packet).<a href="#section-25.5-1" class="pilcrow">¶</a></p>
<p id="section-25.5-2">Options providing UDP security, e.g., AUTH and UENC, require
   endpoint key and security parameter coordination, which UDP Options
   (being stateless) do not facilitate. These parameters include
   whether and when to override the defaults described herein,
   especially at the transmitter as to when emitted packets need to
   include AUTH and at the receiver as to whether (and when) packets
   with failed AUTH and/or without AUTH (or that fail the AUTH checks)
   are not to be forwarded to the user/application.<a href="#section-25.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations-regarding-middleboxes">
<section id="section-25.6">
        <h3 id="name-considerations-regarding-mi">
<a href="#section-25.6" class="section-number selfRef">25.6. </a><a href="#name-considerations-regarding-mi" class="section-name selfRef">Considerations Regarding Middleboxes</a>
        </h3>
<p id="section-25.6-1">Some middleboxes operate as UDP relays, forwarding data between a
   UDP socket and another transport socket by modifying the IP and/or
   UDP headers without properly acting as a protocol endpoint (i.e., an
   application layer proxy). In such cases, a sender might add UDP
   Options that could be stripped by the middlebox before the packet is
   forwarded to the second socket. A remote application will not
   receive the options (for SAFE Options, the payload data will be
   received; for UNSAFE Options, the payload data will not be received).
   In such cases, the application will function as it would if
   communicating with a remote endpoint that does not support UDP
   Options.<a href="#section-25.6-1" class="pilcrow">¶</a></p>
<p id="section-25.6-2">Additionally, <span>[<a href="#Zu20" class="cite xref">Zu20</a>]</span> reports that packets containing UDP Options do
   not traverse certain Internet paths; most likely, those options were
   stripped (e.g., by resetting the IP Length to correspond to the UDP
   Length, truncating the surplus area) or packets with options were
   dropped. UDP Options do not function over such paths.<a href="#section-25.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana-cons">
<section id="section-26">
      <h2 id="name-iana-considerations">
<a href="#section-26" class="section-number selfRef">26. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-26-1">IANA has created the "User Datagram Protocol (UDP)" registry group, which 
      consists of the "UDP Option Kind Numbers" registry and a pointer to the unified "TCP/UDP Experimental Option Experiment Identifiers (TCP/UDP ExIDs)" registry.  Note that the "TCP experimental IDs (ExIDs)" registry has been renamed as the "TCP/UDP Experimental Option Experiment Identifiers (TCP/UDP ExIDs)" registry, and is a unified registry for both TCP and UDP ExIDs.  IANA has added the following note to the unified TCP/UDP ExID registry:<a href="#section-26-1" class="pilcrow">¶</a></p>
<blockquote id="section-26-2">
    16-bit ExIDs can be used with either TCP or UDP; 32-bit ExIDs can be 
    used with TCP or their first 16 bits can be used with UDP. Use with 
    each transport (TCP, UDP) is indicated in the protocol column, as 
    defined in RFC 9868.<a href="#section-26-2" class="pilcrow">¶</a>
</blockquote>
<p id="section-26-3">Initial values of the "UDP Option Kind Numbers" registry are as listed in
   <a href="#sec-udp-opt" class="auto internal xref">Section 10</a>, including those both assigned and reserved. Additional
   values in this registry are to be assigned from the Unassigned
   values in <a href="#sec-udp-opt" class="auto internal xref">Section 10</a> by IESG Approval or Standards Action <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.
   Those assignments are subject to the conditions set forth in this
   document, particularly (but not limited to) those in <a href="#sec-rules" class="auto internal xref">Section 13</a>.<a href="#section-26-3" class="pilcrow">¶</a></p>
<p id="section-26-4">&gt;&gt; Although option nicknames are not used in-band, new UNSAFE
   Option names <span class="bcp14">MUST</span> commence with the capital letter "U" and new SAFE
   Options <span class="bcp14">MUST NOT</span> commence with either uppercase or lowercase "U".<a href="#section-26-4" class="pilcrow">¶</a></p>
<p id="section-26-5">IANA has added the following note to the "UDP Option Kind Numbers" indicating
   entries are mandatory to implement when UDP Options are supported.  
   No new options may be created that are mandatory to
   implement in all UDP Options implementations.<a href="#section-26-5" class="pilcrow">¶</a></p>
<blockquote id="section-26-6">
        <p id="section-26-6.1">Codepoints 0-7 <span class="bcp14">MUST</span> be supported on any implementation
supporting UDP Options. All others are supported at the
discretion of each implementation.<a href="#section-26-6.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-26-7">UDP Experimental Option Experiment Identifiers (UDP ExIDs) are
   intended for use in a similar manner as TCP ExIDs <span>[<a href="#RFC6994" class="cite xref">RFC6994</a>]</span>. Both
   TCP and UDP ExIDs are managed as a single, unified registry because
   such options could be used for both transport protocols and because
   the option space is large enough that there is no clear need to
   maintain them separately. This new TCP/UDP ExIDs registry has entries
   for both transports, although each codepoint needs to be explicitly
   defined for each transport protocol in which it is used, i.e.,
   defining a codepoint in TCP does not imply it has a similar use in
   UDP. IANA has added a "Protocol" field to the registry and updated
   the current TCP ExIDs to be indicated as defined for TCP.  New assignments are to indicate the transport for which
   it is defined.<a href="#section-26-7" class="pilcrow">¶</a></p>
<p id="section-26-8">TCP/UDP ExIDs can be used in either (or both) the UDP EXP (<a href="#sec-exp" class="auto internal xref">Section 11.10</a>) or UEXP (<a href="#sec-uexp" class="auto internal xref">Section 12.3</a>) Options. TCP/UDP ExID entries for use
   in UDP consist of a 16-bit ExID (in network-standard order), and (as
   with the original TCP ExIDs) will preferentially also include a
   short description and acronym for use in documentation. TCP/UDP
   ExIDs used for UDP are always 16 bits because their use in EXP and
   UEXP Options is required and thus do not need a larger codepoint
   value to decrease the probability of accidental occurrence with non-ExID
   uses of the experimental options, as is the case with TCP ExIDs
   (e.g., when using 32-bit ExIDs). ExIDs defined solely for TCP
   options could be either 16 or 32 bits and all ExIDs (including now
   UDP) need to be unique in their first 16 bits, as originally
   described for TCP <span>[<a href="#RFC6994" class="cite xref">RFC6994</a>]</span>.<a href="#section-26-8" class="pilcrow">¶</a></p>
<p id="section-26-9">Values in the TCP/UDP ExID registry are to be assigned by IANA using
   the First Come First Served (FCFS) policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, which applies to both the ExID value
   and the acronym. UDP Options using these ExIDs are subject
   to the same conditions as new UDP Options, i.e., they too are
   subject to the conditions set forth in this document, particularly
   (but not limited to) those in <a href="#sec-rules" class="auto internal xref">Section 13</a>.<a href="#section-26-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-27">
      <h2 id="name-references">
<a href="#section-27" class="section-number selfRef">27. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-27.1">
        <h3 id="name-normative-references">
<a href="#section-27.1" class="section-number selfRef">27.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9869">[RFC9869]</dt>
      <dd>
<span class="refAuthor">Fairhurst, G.</span> and <span class="refAuthor">T. Jones</span>, <span class="refTitle">"Datagram Packetization Layer Path MTU Discovery (DPLPMTUD) for UDP Options"</span>, <span class="seriesInfo">RFC 9869</span>, <span class="seriesInfo">DOI 10.17487/RFC9869</span>, <time datetime="2025-10" class="refDate">October 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9869">https://www.rfc-editor.org/info/rfc9869</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-27.2">
        <h3 id="name-informative-references">
<a href="#section-27.2" class="section-number selfRef">27.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CERT18">[CERT18]</dt>
        <dd>
<span class="refAuthor">CERT Coordination Center</span>, <span class="refTitle">"TCP implementations vulnerable to Denial of Service"</span>, <span class="refContent">Vulnerability Note VU#962459</span>, <span class="refContent">Software Engineering Institute, CMU</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://www.kb.cert.org/vuls/id/962459">https://www.kb.cert.org/vuls/id/962459</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fairhurst-udp-options-cco">[Fa18]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, and <span class="refAuthor">R. Zullo</span>, <span class="refTitle">"Checksum Compensation Options for UDP Options"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fairhurst-udp-options-cco-00</span>, <time datetime="2018-10-19" class="refDate">19 October 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fairhurst-udp-options-cco-00">https://datatracker.ietf.org/doc/html/draft-fairhurst-udp-options-cco-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.heard-dnsop-udp-opt-large-dns-responses">[He24]</dt>
        <dd>
<span class="refAuthor">Heard, C. M.</span>, <span class="refTitle">"Use of UDP Options for Transmission of Large DNS Responses"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-heard-dnsop-udp-opt-large-dns-responses-00</span>, <time datetime="2024-04-28" class="refDate">28 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-heard-dnsop-udp-opt-large-dns-responses-00">https://datatracker.ietf.org/doc/html/draft-heard-dnsop-udp-opt-large-dns-responses-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.hildebrand-spud-prototype">[Hi15]</dt>
        <dd>
<span class="refAuthor">Hildebrand, J.</span> and <span class="refAuthor">B. Trammell</span>, <span class="refTitle">"Substrate Protocol for User Datagrams (SPUD) Prototype"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hildebrand-spud-prototype-03</span>, <time datetime="2015-03-09" class="refDate">9 March 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hildebrand-spud-prototype-03">https://datatracker.ietf.org/doc/html/draft-hildebrand-spud-prototype-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="La78">[La78]</dt>
        <dd>
<span class="refAuthor">Lamport, L.</span>, <span class="refTitle">"Time, clocks, and the ordering of events in a distributed system"</span>, <span class="refContent">Communications of the ACM, vol. 21, no. 7, pp. 558-565</span>, <span class="seriesInfo">DOI 10.1145/359545.359563</span>, <time datetime="1978-07" class="refDate">July 1978</time>, <span>&lt;<a href="https://doi.org/10.1145/359545.359563">https://doi.org/10.1145/359545.359563</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0868">[RFC0868]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span> and <span class="refAuthor">K. Harrenstien</span>, <span class="refTitle">"Time Protocol"</span>, <span class="seriesInfo">STD 26</span>, <span class="seriesInfo">RFC 868</span>, <span class="seriesInfo">DOI 10.17487/RFC0868</span>, <time datetime="1983-05" class="refDate">May 1983</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc868">https://www.rfc-editor.org/info/rfc868</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1071">[RFC1071]</dt>
        <dd>
<span class="refAuthor">Braden, R.</span>, <span class="refAuthor">Borman, D.</span>, and <span class="refAuthor">C. Partridge</span>, <span class="refTitle">"Computing the Internet checksum"</span>, <span class="seriesInfo">RFC 1071</span>, <span class="seriesInfo">DOI 10.17487/RFC1071</span>, <time datetime="1988-09" class="refDate">September 1988</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1071">https://www.rfc-editor.org/info/rfc1071</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1141">[RFC1141]</dt>
        <dd>
<span class="refAuthor">Mallory, T.</span> and <span class="refAuthor">A. Kullberg</span>, <span class="refTitle">"Incremental updating of the Internet checksum"</span>, <span class="seriesInfo">RFC 1141</span>, <span class="seriesInfo">DOI 10.17487/RFC1141</span>, <time datetime="1990-01" class="refDate">January 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1141">https://www.rfc-editor.org/info/rfc1141</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time datetime="1990-11" class="refDate">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2675">[RFC2675]</dt>
        <dd>
<span class="refAuthor">Borman, D.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"IPv6 Jumbograms"</span>, <span class="seriesInfo">RFC 2675</span>, <span class="seriesInfo">DOI 10.17487/RFC2675</span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2675">https://www.rfc-editor.org/info/rfc2675</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2923">[RFC2923]</dt>
        <dd>
<span class="refAuthor">Lahey, K.</span>, <span class="refTitle">"TCP Problems with Path MTU Discovery"</span>, <span class="seriesInfo">RFC 2923</span>, <span class="seriesInfo">DOI 10.17487/RFC2923</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2923">https://www.rfc-editor.org/info/rfc2923</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3095">[RFC3095]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Burmeister, C.</span>, <span class="refAuthor">Degermark, M.</span>, <span class="refAuthor">Fukushima, H.</span>, <span class="refAuthor">Hannu, H.</span>, <span class="refAuthor">Jonsson, L.</span>, <span class="refAuthor">Hakenberg, R.</span>, <span class="refAuthor">Koren, T.</span>, <span class="refAuthor">Le, K.</span>, <span class="refAuthor">Liu, Z.</span>, <span class="refAuthor">Martensson, A.</span>, <span class="refAuthor">Miyazaki, A.</span>, <span class="refAuthor">Svanbro, K.</span>, <span class="refAuthor">Wiebke, T.</span>, <span class="refAuthor">Yoshimura, T.</span>, and <span class="refAuthor">H. Zheng</span>, <span class="refTitle">"RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed"</span>, <span class="seriesInfo">RFC 3095</span>, <span class="seriesInfo">DOI 10.17487/RFC3095</span>, <time datetime="2001-07" class="refDate">July 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3095">https://www.rfc-editor.org/info/rfc3095</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3173">[RFC3173]</dt>
        <dd>
<span class="refAuthor">Shacham, A.</span>, <span class="refAuthor">Monsour, B.</span>, <span class="refAuthor">Pereira, R.</span>, and <span class="refAuthor">M. Thomas</span>, <span class="refTitle">"IP Payload Compression Protocol (IPComp)"</span>, <span class="seriesInfo">RFC 3173</span>, <span class="seriesInfo">DOI 10.17487/RFC3173</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3173">https://www.rfc-editor.org/info/rfc3173</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3385">[RFC3385]</dt>
        <dd>
<span class="refAuthor">Sheinwald, D.</span>, <span class="refAuthor">Satran, J.</span>, <span class="refAuthor">Thaler, P.</span>, and <span class="refAuthor">V. Cavanna</span>, <span class="refTitle">"Internet Protocol Small Computer System Interface (iSCSI) Cyclic Redundancy Check (CRC)/Checksum Considerations"</span>, <span class="seriesInfo">RFC 3385</span>, <span class="seriesInfo">DOI 10.17487/RFC3385</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3385">https://www.rfc-editor.org/info/rfc3385</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3692">[RFC3692]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refTitle">"Assigning Experimental and Testing Numbers Considered Useful"</span>, <span class="seriesInfo">BCP 82</span>, <span class="seriesInfo">RFC 3692</span>, <span class="seriesInfo">DOI 10.17487/RFC3692</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3692">https://www.rfc-editor.org/info/rfc3692</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3828">[RFC3828]</dt>
        <dd>
<span class="refAuthor">Larzon, L.</span>, <span class="refAuthor">Degermark, M.</span>, <span class="refAuthor">Pink, S.</span>, <span class="refAuthor">Jonsson, L., Ed.</span>, and <span class="refAuthor">G. Fairhurst, Ed.</span>, <span class="refTitle">"The Lightweight User Datagram Protocol (UDP-Lite)"</span>, <span class="seriesInfo">RFC 3828</span>, <span class="seriesInfo">DOI 10.17487/RFC3828</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3828">https://www.rfc-editor.org/info/rfc3828</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4340">[RFC4340]</dt>
        <dd>
<span class="refAuthor">Kohler, E.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">S. Floyd</span>, <span class="refTitle">"Datagram Congestion Control Protocol (DCCP)"</span>, <span class="seriesInfo">RFC 4340</span>, <span class="seriesInfo">DOI 10.17487/RFC4340</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4340">https://www.rfc-editor.org/info/rfc4340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4380">[RFC4380]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refTitle">"Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)"</span>, <span class="seriesInfo">RFC 4380</span>, <span class="seriesInfo">DOI 10.17487/RFC4380</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4380">https://www.rfc-editor.org/info/rfc4380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4787">[RFC4787]</dt>
        <dd>
<span class="refAuthor">Audet, F., Ed.</span> and <span class="refAuthor">C. Jennings</span>, <span class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>, <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4787">https://www.rfc-editor.org/info/rfc4787</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6081">[RFC6081]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refTitle">"Teredo Extensions"</span>, <span class="seriesInfo">RFC 6081</span>, <span class="seriesInfo">DOI 10.17487/RFC6081</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6081">https://www.rfc-editor.org/info/rfc6081</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6864">[RFC6864]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Updated Specification of the IPv4 ID Field"</span>, <span class="seriesInfo">RFC 6864</span>, <span class="seriesInfo">DOI 10.17487/RFC6864</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6864">https://www.rfc-editor.org/info/rfc6864</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6935">[RFC6935]</dt>
        <dd>
<span class="refAuthor">Eubanks, M.</span>, <span class="refAuthor">Chimento, P.</span>, and <span class="refAuthor">M. Westerlund</span>, <span class="refTitle">"IPv6 and UDP Checksums for Tunneled Packets"</span>, <span class="seriesInfo">RFC 6935</span>, <span class="seriesInfo">DOI 10.17487/RFC6935</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6935">https://www.rfc-editor.org/info/rfc6935</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6978">[RFC6978]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"A TCP Authentication Option Extension for NAT Traversal"</span>, <span class="seriesInfo">RFC 6978</span>, <span class="seriesInfo">DOI 10.17487/RFC6978</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6978">https://www.rfc-editor.org/info/rfc6978</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6994">[RFC6994]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Shared Use of Experimental TCP Options"</span>, <span class="seriesInfo">RFC 6994</span>, <span class="seriesInfo">DOI 10.17487/RFC6994</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6994">https://www.rfc-editor.org/info/rfc6994</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7011">[RFC7011]</dt>
        <dd>
<span class="refAuthor">Claise, B., Ed.</span>, <span class="refAuthor">Trammell, B., Ed.</span>, and <span class="refAuthor">P. Aitken</span>, <span class="refTitle">"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"</span>, <span class="seriesInfo">STD 77</span>, <span class="seriesInfo">RFC 7011</span>, <span class="seriesInfo">DOI 10.17487/RFC7011</span>, <time datetime="2013-09" class="refDate">September 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7011">https://www.rfc-editor.org/info/rfc7011</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7323">[RFC7323]</dt>
        <dd>
<span class="refAuthor">Borman, D.</span>, <span class="refAuthor">Braden, B.</span>, <span class="refAuthor">Jacobson, V.</span>, and <span class="refAuthor">R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8724">[RFC8724]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, <span class="refAuthor">Gomez, C.</span>, <span class="refAuthor">Barthel, D.</span>, and <span class="refAuthor">JC. Zuniga</span>, <span class="refTitle">"SCHC: Generic Framework for Static Context Header Compression and Fragmentation"</span>, <span class="seriesInfo">RFC 8724</span>, <span class="seriesInfo">DOI 10.17487/RFC8724</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8724">https://www.rfc-editor.org/info/rfc8724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Rüngeler, I.</span>, and <span class="refAuthor">T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9040">[RFC9040]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Welzl, M.</span>, and <span class="refAuthor">S. Islam</span>, <span class="refTitle">"TCP Control Block Interdependence"</span>, <span class="seriesInfo">RFC 9040</span>, <span class="seriesInfo">DOI 10.17487/RFC9040</span>, <time datetime="2021-07" class="refDate">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9040">https://www.rfc-editor.org/info/rfc9040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9187">[RFC9187]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Sequence Number Extension for Windowed Protocols"</span>, <span class="seriesInfo">RFC 9187</span>, <span class="seriesInfo">DOI 10.17487/RFC9187</span>, <time datetime="2022-01" class="refDate">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9187">https://www.rfc-editor.org/info/rfc9187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9260">[RFC9260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tüxen, M.</span>, and <span class="refAuthor">K. Nielsen</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 9260</span>, <span class="seriesInfo">DOI 10.17487/RFC9260</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9260">https://www.rfc-editor.org/info/rfc9260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9293">[RFC9293]</dt>
        <dd>
<span class="refAuthor">Eddy, W., Ed.</span>, <span class="refTitle">"Transmission Control Protocol (TCP)"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 9293</span>, <span class="seriesInfo">DOI 10.17487/RFC9293</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9293">https://www.rfc-editor.org/info/rfc9293</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9298">[RFC9298]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span>, <span class="refTitle">"Proxying UDP in HTTP"</span>, <span class="seriesInfo">RFC 9298</span>, <span class="seriesInfo">DOI 10.17487/RFC9298</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9298">https://www.rfc-editor.org/info/rfc9298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9648">[RFC9648]</dt>
        <dd>
<span class="refAuthor">Scharf, M.</span>, <span class="refAuthor">Jethanandani, M.</span>, and <span class="refAuthor">V. Murgai</span>, <span class="refTitle">"YANG Data Model for TCP"</span>, <span class="seriesInfo">RFC 9648</span>, <span class="seriesInfo">DOI 10.17487/RFC9648</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9648">https://www.rfc-editor.org/info/rfc9648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9870">[RFC9870]</dt>
        <dd>
<span class="refAuthor">Boucadair, M.</span> and <span class="refAuthor">T. Reddy.K</span>, <span class="refTitle">"Export of UDP Options Information in IP Flow Information Export (IPFIX)"</span>, <span class="seriesInfo">RFC 9870</span>, <span class="seriesInfo">DOI 10.17487/RFC9870</span>, <time datetime="2025-10" class="refDate">October 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9870">https://www.rfc-editor.org/info/rfc9870</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.touch-tcp-ao-encrypt">[To18]</dt>
        <dd>
<span class="refAuthor">Touch, J. D.</span>, <span class="refTitle">"A TCP Authentication Option Extension for Payload Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-touch-tcp-ao-encrypt-09</span>, <time datetime="2018-07-19" class="refDate">19 July 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-touch-tcp-ao-encrypt-09">https://datatracker.ietf.org/doc/html/draft-touch-tcp-ao-encrypt-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.touch-tsvwg-udp-auth-opt">[To24]</dt>
        <dd>
<span class="refAuthor">Touch, J. D.</span>, <span class="refTitle">"The UDP Authentication Option"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-touch-tsvwg-udp-auth-opt-00</span>, <time datetime="2024-03-03" class="refDate">3 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-touch-tsvwg-udp-auth-opt-00">https://datatracker.ietf.org/doc/html/draft-touch-tsvwg-udp-auth-opt-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zu20">[Zu20]</dt>
      <dd>
<span class="refAuthor">Zullo, R.</span>, <span class="refAuthor">Jones, T.</span>, and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"Overcoming the Sorrows of the Young UDP Options"</span>, <span class="refContent">4th Network Traffic Measurement and Analysis Conference (TMA)</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://dl.ifip.org/db/conf/tma/tma2020/tma2020-camera-paper70.pdf">https://dl.ifip.org/db/conf/tma/tma2020/tma2020-camera-paper70.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="implementation-information">
<section id="appendix-A">
      <h2 id="name-implementation-information">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-implementation-information" class="section-name selfRef">Implementation Information</a>
      </h2>
<p id="appendix-A-1">The following information is provided to encourage consistent naming
   for API implementations.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">System-level variables (sysctl):<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
        <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Default</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">UDP Options available</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_ocs</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">Use OCS</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_apc</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include APC</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_frag</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Fragment</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_mds</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include MDS</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_mrds</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include MRDS</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_req</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include REQ</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_resp</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include RES</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_time</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include TIME</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_auth</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include AUTH</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_exp</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include EXP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_ucmp</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include UCMP</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_uenc</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include UENC</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_uexp</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Include UEXP</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-4">Socket options (sockopt), cached for outgoing datagrams:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP Options (at all)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_OCS</td>
            <td class="text-left" rowspan="1" colspan="1">Use UDP OCS</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_APC</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP APC Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_FRAG</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP fragmentation</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT MDS</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP MDS Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT MRDS</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP MRDS Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT REQ</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP REQ Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT RES</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP RES Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_TIME</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP TIME Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT AUTH</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP AUTH Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT EXP</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP EXP Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_UCMP</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP UCMP Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_OPT_UENC</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP UENC Option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP OPT UEXP</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP UEXP Option</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-6">Send/sendto parameters:<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-7.1">
          <p id="appendix-A-7.1.1">(Same as sysctl, with different prefixes)<a href="#appendix-A-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-8">Connection parameters (per-socket pair cached state, part UCB):<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
        <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Initial Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">opts_enabled</td>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ocs_enabled</td>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_ocs</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-10">NB: The JUNK Option is included for debugging purposes and is not
   intended to be enabled otherwise.<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<p id="appendix-A-11">System variables:<a href="#appendix-A-11" class="pilcrow">¶</a></p>
<p id="appendix-A-12">net.ipv4.udp_opt_junk   0<a href="#appendix-A-12" class="pilcrow">¶</a></p>
<p id="appendix-A-13">System-level variables (sysctl):<a href="#appendix-A-13" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
        <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Default</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_junk</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Default use of junk</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-15">Socket options (sockopt):<a href="#appendix-A-15" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
        <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Params</th>
            <th class="text-left" rowspan="1" colspan="1">Meaning</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_JUNK</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Enable UDP junk option</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_JUNK_VAL</td>
            <td class="text-left" rowspan="1" colspan="1">fillval</td>
            <td class="text-left" rowspan="1" colspan="1">Value to use as junk fill</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">UDP_JUNK_LEN</td>
            <td class="text-left" rowspan="1" colspan="1">length</td>
            <td class="text-left" rowspan="1" colspan="1">Length of junk payload in bytes</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-A-17">Connection parameters (per-socket pair cached state, part UCB):<a href="#appendix-A-17" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
        <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Initial Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">junk_enabled</td>
            <td class="text-left" rowspan="1" colspan="1">net.ipv4.udp_opt_junk</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">junk_value</td>
            <td class="text-left" rowspan="1" colspan="1">0xABCD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">junk_len</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="acks">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This work benefitted from feedback from <span class="contact-name">Erik Auerswald</span>, <span class="contact-name">Bob Briscoe</span>,
<span class="contact-name">Ken Calvert</span>, <span class="contact-name">Ted Faber</span>, <span class="contact-name">Gorry Fairhurst</span> (including OCS for errant
middlebox traversal), <span class="contact-name">C. M. Heard</span> (editor of this document, including
combining previous FRAG and LITE Options into the new FRAG, as well
as <a href="#fig-12" class="auto internal xref">Figure 12</a>), <span class="contact-name">Tom Herbert</span>, <span class="contact-name">Tom Jones</span>, <span class="contact-name">Mark Smith</span>, <span class="contact-name">Carl Williams</span>,
and <span class="contact-name">Raffaele Zullo</span>, as well as discussions on the IETF TSVWG and
SPUD email lists.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">This work was partly supported by USC/ISI's Postel Center.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joe Touch</span></div>
<div dir="auto" class="left"><span class="org">Independent Consultant</span></div>
<div dir="auto" class="left">
<span class="locality">Manhattan Beach</span>, <span class="region">CA</span> <span class="postal-code">90266</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20(310)%20560-0334" class="tel">+1 (310) 560-0334</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:touch@strayalpha.com" class="email">touch@strayalpha.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">C. M. (Mike) Heard (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Unaffiliated</span></div>
<div dir="auto" class="left"><span class="street-address">PO Box 2667</span></div>
<div dir="auto" class="left">
<span class="locality">Redwood City</span>, <span class="region">CA</span> <span class="postal-code">94064-2667</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20(408)%20499-7257" class="tel">+1 (408) 499-7257</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:heard@pobox.com" class="email">heard@pobox.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
