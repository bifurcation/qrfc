<!DOCTYPE html>
<html lang="en" class="RFC STD">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9777: Multicast Listener Discovery Version 2 (MLDv2) for IPv6</title>
<meta content="Brian Haberman" name="author">
<meta content="
       This document specifies the
   Multicast Listener Discovery version 2 (MLDv2) protocol.  MLD is used by an
   IPv6 router to discover the presence of multicast listeners on
   directly attached links and to discover which multicast addresses
   are of interest to those neighboring nodes.  MLDv2 is designed to be
   interoperable with MLDv1.  MLDv2 adds the ability for a node to
   report interest in listening to packets with a particular multicast
   address only from specific source addresses or from all sources
   except for specific source addresses. 
       This document updates RFC 2710 and obsoletes RFC 3810. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="9777" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 64.1
-->
<link href="rfc9777.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-pim-3810bis-12" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9777" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9777</td>
<td class="center">MLDv2 for IPv6</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Haberman</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9777" class="eref">9777</a></dd>
<dt class="label-std">STD:</dt>
<dd class="std">101</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc3810" class="eref">3810</a> </dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc2710" class="eref">2710</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03" class="published">March 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Haberman, <span class="editor">Ed.</span>
</div>
<div class="org">JHU APL</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9777</h1>
<h1 id="title">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the
   Multicast Listener Discovery version 2 (MLDv2) protocol.  MLD is used by an
   IPv6 router to discover the presence of multicast listeners on
   directly attached links and to discover which multicast addresses
   are of interest to those neighboring nodes.  MLDv2 is designed to be
   interoperable with MLDv1.  MLDv2 adds the ability for a node to
   report interest in listening to packets with a particular multicast
   address only from specific source addresses or from all sources
   except for specific source addresses.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document updates RFC 2710 and obsoletes RFC 3810.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9777">https://www.rfc-editor.org/info/rfc9777</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-used-in-this-do" class="internal xref">Conventions Used in This Document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-building-multicast-address-" class="internal xref">Building Multicast Address Listening State on Multicast Address Listeners</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-exchanging-messages-between" class="internal xref">Exchanging Messages between the Querier and the Listening Nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-building-multicast-address-l" class="internal xref">Building Multicast Address Listening State on Multicast Routers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-the-service-interface-for-r" class="internal xref">The Service Interface for Requesting IP Multicast Reception</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-multicast-address-listening" class="internal xref">Multicast Address Listening State Maintained by Nodes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-per-socket-state" class="internal xref">Per-Socket State</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-per-interface-state" class="internal xref">Per-Interface State</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-message-formats" class="internal xref">Message Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-multicast-listener-query-me" class="internal xref">Multicast Listener Query Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-code" class="internal xref">Code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-checksum" class="internal xref">Checksum</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-maximum-response-code" class="internal xref">Maximum Response Code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-reserved" class="internal xref">Reserved</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="auto internal xref">5.1.5</a>.  <a href="#name-multicast-address" class="internal xref">Multicast Address</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a href="#section-5.1.6" class="auto internal xref">5.1.6</a>.  <a href="#name-flags" class="internal xref">Flags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a href="#section-5.1.7" class="auto internal xref">5.1.7</a>.  <a href="#name-s-flag-suppress-router-side" class="internal xref">S Flag (Suppress Router-Side Processing)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a href="#section-5.1.8" class="auto internal xref">5.1.8</a>.  <a href="#name-qrv-queriers-robustness-var" class="internal xref">QRV (Querier's Robustness Variable)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.9">
                    <p id="section-toc.1-1.5.2.1.2.9.1"><a href="#section-5.1.9" class="auto internal xref">5.1.9</a>.  <a href="#name-qqic-queriers-query-interva" class="internal xref">QQIC (Querier's Query Interval Code)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.10">
                    <p id="section-toc.1-1.5.2.1.2.10.1"><a href="#section-5.1.10" class="auto internal xref">5.1.10</a>. <a href="#name-number-of-sources-n" class="internal xref">Number of Sources (N)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.11">
                    <p id="section-toc.1-1.5.2.1.2.11.1"><a href="#section-5.1.11" class="auto internal xref">5.1.11</a>. <a href="#name-source-address-i" class="internal xref">Source Address [i]</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.12">
                    <p id="section-toc.1-1.5.2.1.2.12.1"><a href="#section-5.1.12" class="auto internal xref">5.1.12</a>. <a href="#name-additional-data" class="internal xref">Additional Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.13">
                    <p id="section-toc.1-1.5.2.1.2.13.1"><a href="#section-5.1.13" class="auto internal xref">5.1.13</a>. <a href="#name-query-variants" class="internal xref">Query Variants</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.14">
                    <p id="section-toc.1-1.5.2.1.2.14.1"><a href="#section-5.1.14" class="auto internal xref">5.1.14</a>. <a href="#name-source-addresses-for-querie" class="internal xref">Source Addresses for Queries</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.15">
                    <p id="section-toc.1-1.5.2.1.2.15.1"><a href="#section-5.1.15" class="auto internal xref">5.1.15</a>. <a href="#name-destination-addresses-for-q" class="internal xref">Destination Addresses for Queries</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-version-2-multicast-listene" class="internal xref">Version 2 Multicast Listener Report Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-reserved-2" class="internal xref">Reserved</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-checksum-2" class="internal xref">Checksum</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-flags-2" class="internal xref">Flags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-nr-of-mcast-address-records" class="internal xref">Nr of Mcast Address Records (M)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-multicast-address-record" class="internal xref">Multicast Address Record</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="auto internal xref">5.2.6</a>.  <a href="#name-record-type" class="internal xref">Record Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.7">
                    <p id="section-toc.1-1.5.2.2.2.7.1"><a href="#section-5.2.7" class="auto internal xref">5.2.7</a>.  <a href="#name-aux-data-len" class="internal xref">Aux Data Len</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8">
                    <p id="section-toc.1-1.5.2.2.2.8.1"><a href="#section-5.2.8" class="auto internal xref">5.2.8</a>.  <a href="#name-number-of-sources-n-2" class="internal xref">Number of Sources (N)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.9">
                    <p id="section-toc.1-1.5.2.2.2.9.1"><a href="#section-5.2.9" class="auto internal xref">5.2.9</a>.  <a href="#name-multicast-address-2" class="internal xref">Multicast Address</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.10">
                    <p id="section-toc.1-1.5.2.2.2.10.1"><a href="#section-5.2.10" class="auto internal xref">5.2.10</a>. <a href="#name-source-address-i-2" class="internal xref">Source Address [i]</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.11">
                    <p id="section-toc.1-1.5.2.2.2.11.1"><a href="#section-5.2.11" class="auto internal xref">5.2.11</a>. <a href="#name-auxiliary-data" class="internal xref">Auxiliary Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.12">
                    <p id="section-toc.1-1.5.2.2.2.12.1"><a href="#section-5.2.12" class="auto internal xref">5.2.12</a>. <a href="#name-additional-data-2" class="internal xref">Additional Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.13">
                    <p id="section-toc.1-1.5.2.2.2.13.1"><a href="#section-5.2.13" class="auto internal xref">5.2.13</a>. <a href="#name-multicast-address-record-ty" class="internal xref">Multicast Address Record Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.14">
                    <p id="section-toc.1-1.5.2.2.2.14.1"><a href="#section-5.2.14" class="auto internal xref">5.2.14</a>. <a href="#name-source-addresses-for-report" class="internal xref">Source Addresses for Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.15">
                    <p id="section-toc.1-1.5.2.2.2.15.1"><a href="#section-5.2.15" class="auto internal xref">5.2.15</a>. <a href="#name-destination-addresses-for-r" class="internal xref">Destination Addresses for Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.16">
                    <p id="section-toc.1-1.5.2.2.2.16.1"><a href="#section-5.2.16" class="auto internal xref">5.2.16</a>. <a href="#name-multicast-listener-report-s" class="internal xref">Multicast Listener Report Size</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-protocol-description-for-mu" class="internal xref">Protocol Description for Multicast Address Listeners</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-action-on-change-of-per-int" class="internal xref">Action on Change of Per-Interface State</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-action-on-reception-of-a-qu" class="internal xref">Action on Reception of a Query</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-action-on-timer-expiration" class="internal xref">Action on Timer Expiration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-description-of-the-protocol" class="internal xref">Description of the Protocol for Multicast Routers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-conditions-for-mld-queries" class="internal xref">Conditions for MLD Queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mld-state-maintained-by-mul" class="internal xref">MLD State Maintained by Multicast Routers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-definition-of-router-filter" class="internal xref">Definition of Router Filter Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-definition-of-filter-timers" class="internal xref">Definition of Filter Timers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-7.2.3" class="auto internal xref">7.2.3</a>.  <a href="#name-definition-of-source-timers" class="internal xref">Definition of Source Timers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-mldv2-source-specific-forwa" class="internal xref">MLDv2 Source-Specific Forwarding Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-action-on-reception-of-repo" class="internal xref">Action on Reception of Reports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-reception-of-current-state-" class="internal xref">Reception of Current-State Records</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-reception-of-filter-mode-ch" class="internal xref">Reception of Filter-Mode-Change and Source-List-Change Records</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-switching-router-filter-mod" class="internal xref">Switching Router Filter Modes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-action-on-reception-of-quer" class="internal xref">Action on Reception of Queries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.1">
                    <p id="section-toc.1-1.7.2.6.2.1.1"><a href="#section-7.6.1" class="auto internal xref">7.6.1</a>.  <a href="#name-timer-updates" class="internal xref">Timer Updates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2">
                    <p id="section-toc.1-1.7.2.6.2.2.1"><a href="#section-7.6.2" class="auto internal xref">7.6.2</a>.  <a href="#name-querier-election" class="internal xref">Querier Election</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.3">
                    <p id="section-toc.1-1.7.2.6.2.3.1"><a href="#section-7.6.3" class="auto internal xref">7.6.3</a>.  <a href="#name-building-and-sending-specif" class="internal xref">Building and Sending Specific Queries</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-interoperation-with-mldv1" class="internal xref">Interoperation with MLDv1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-query-version-distinctions" class="internal xref">Query Version Distinctions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-multicast-address-listener-" class="internal xref">Multicast Address Listener Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-in-the-presence-of-mldv1-ro" class="internal xref">In the Presence of MLDv1 Routers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-in-the-presence-of-mldv1-mu" class="internal xref">In the Presence of MLDv1 Multicast Address Listeners</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-multicast-router-behavior" class="internal xref">Multicast Router Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-in-the-presence-of-mldv1-rou" class="internal xref">In the Presence of MLDv1 Routers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-in-the-presence-of-mldv1-mul" class="internal xref">In the Presence of MLDv1 Multicast Address Listeners</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-list-of-timers-counters-and" class="internal xref">List of Timers, Counters, and Their Default Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-robustness-variable" class="internal xref">Robustness Variable</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-query-interval" class="internal xref">Query Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-query-response-interval" class="internal xref">Query Response Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-multicast-address-listening-" class="internal xref">Multicast Address Listening Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-other-querier-present-inter" class="internal xref">Other Querier Present Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-startup-query-interval" class="internal xref">Startup Query Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-startup-query-count" class="internal xref">Startup Query Count</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="auto internal xref">9.8</a>.  <a href="#name-last-listener-query-interva" class="internal xref">Last Listener Query Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-9.9" class="auto internal xref">9.9</a>.  <a href="#name-last-listener-query-count" class="internal xref">Last Listener Query Count</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10">
                <p id="section-toc.1-1.9.2.10.1"><a href="#section-9.10" class="auto internal xref">9.10</a>. <a href="#name-last-listener-query-time" class="internal xref">Last Listener Query Time</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11">
                <p id="section-toc.1-1.9.2.11.1"><a href="#section-9.11" class="auto internal xref">9.11</a>. <a href="#name-unsolicited-report-interval" class="internal xref">Unsolicited Report Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.12">
                <p id="section-toc.1-1.9.2.12.1"><a href="#section-9.12" class="auto internal xref">9.12</a>. <a href="#name-older-version-querier-prese" class="internal xref">Older Version Querier Present Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.13">
                <p id="section-toc.1-1.9.2.13.1"><a href="#section-9.13" class="auto internal xref">9.13</a>. <a href="#name-older-version-host-present-" class="internal xref">Older Version Host Present Interval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.14">
                <p id="section-toc.1-1.9.2.14.1"><a href="#section-9.14" class="auto internal xref">9.14</a>. <a href="#name-configuring-timers" class="internal xref">Configuring Timers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.14.2.1">
                    <p id="section-toc.1-1.9.2.14.2.1.1"><a href="#section-9.14.1" class="auto internal xref">9.14.1</a>.  <a href="#name-robustness-variable-2" class="internal xref">Robustness Variable</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.14.2.2">
                    <p id="section-toc.1-1.9.2.14.2.2.1"><a href="#section-9.14.2" class="auto internal xref">9.14.2</a>.  <a href="#name-query-interval-2" class="internal xref">Query Interval</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.14.2.3">
                    <p id="section-toc.1-1.9.2.14.2.3.1"><a href="#section-9.14.3" class="auto internal xref">9.14.3</a>.  <a href="#name-maximum-response-delay" class="internal xref">Maximum Response Delay</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-query-message" class="internal xref">Query Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-current-state-report-messag" class="internal xref">Current-State Report Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-state-change-report-message" class="internal xref">State-Change Report Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-design-rationale" class="internal xref">Design Rationale</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-the-need-for-state-change-r" class="internal xref">The Need for State-Change Report Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-host-suppression" class="internal xref">Host Suppression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-switching-router-filter-mode" class="internal xref">Switching Router Filter Modes from EXCLUDE to INCLUDE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-summary-of-changes" class="internal xref">Summary of Changes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-mldv1" class="internal xref">MLDv1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-changes-since-rfc-3810" class="internal xref">Changes since RFC 3810</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-B.3" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-B.4" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Multicast Listener Discovery (MLD) protocol is used by IPv6
   routers to discover the presence of multicast listeners (i.e., nodes
   that wish to receive multicast packets) on their directly attached
   links and to discover specifically which multicast addresses are of
   interest to those neighboring nodes.
   Note that a multicast router
   may itself be a listener of one or more multicast addresses; in this
   case, it performs both the "multicast router part" and the "Multicast
   Address Listener part" of the protocol, to collect the multicast
   listener information needed by its multicast routing protocol and to inform
   itself and other neighboring multicast
   routers of its listening state, respectively.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document specifies version 2 of MLD.  The previous version of
      MLD is specified in <span>[<a href="#RFC2710" class="cite xref">RFC2710</a>]</span>; in this document,
      we will refer to it as "MLDv1".  MLDv2 is a translation of IGMPv3 <span>[<a href="#RFC9776" class="cite xref">RFC9776</a>]</span>
   for IPv6 semantics.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The MLDv2 protocol, when compared to MLDv1, adds support for "source
   filtering", i.e., the ability for a node to report interest in
   listening to packets only from specific source addresses, as
   required to support Source-Specific Multicast (SSM) <span>[<a href="#RFC3569" class="cite xref">RFC3569</a>]</span>, or from <strong>all
   but</strong> specific source addresses, sent to a particular multicast
   address.  MLDv2 is designed to be interoperable with MLDv1.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document uses "SSM-aware" to refer to systems that support SSM
    as defined in <span>[<a href="#RFC4607" class="cite xref">RFC4607</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document obsoletes <span>[<a href="#RFC3810" class="cite xref">RFC3810</a>]</span>. <a href="#_810-changes" class="auto internal xref">Appendix B.2</a> lists the main
   changes from <span>[<a href="#RFC3810" class="cite xref">RFC3810</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-conventions-used-in-this-do">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in This Document</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section gives a brief description of the protocol operation. The
   following sections present the protocol details.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">MLD is an asymmetric protocol; it specifies separate behaviors for
   Multicast Address Listeners (i.e., hosts or routers that listen to
   multicast packets) and multicast routers.  The purpose of MLD is to
   enable each multicast router to learn, for each of its directly
   attached links, which multicast addresses and which sources have
   interested listeners on that link.  The information gathered by MLD
   is provided to whichever multicast routing protocol is used by the
   router, in order to ensure that multicast packets are delivered to
   all links where there are listeners interested in such packets.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Multicast routers only need to know that at least one node on an
   attached link is listening to packets for a particular multicast
   address, from a particular source; a multicast router is not required
   to individually keep track of the interests of each neighboring
    node.  (Nevertheless, see <a href="#host_suppress" class="auto internal xref">Appendix A.2</a>, item 1 for discussion.)<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">A multicast router performs the router part of the MLDv2 protocol
   (described in detail in <a href="#mr_proto" class="auto internal xref">Section 7</a>) on each of its directly attached
   links.  If a multicast router has more than one interface connected
   to the same link, it only needs to operate the protocol on one of
   those interfaces.  The router behavior depends on whether there are
   several multicast routers on the same subnet, or not.  If that is the
   case, a querier election mechanism (described in <a href="#elect" class="auto internal xref">Section 7.6.2</a>) is
   used to elect a single multicast router to be in Querier state.  This
   router is called the "Querier".  All multicast routers on the subnet
   listen to the messages sent by Multicast Address Listeners, and
   maintain the same multicast listening information state, so that they
   can take over the querier role, should the present Querier fail.
   Nevertheless, only the Querier sends periodical or triggered Query
   Messages on the subnet, as described in <a href="#mld_qrys" class="auto internal xref">Section 7.1</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">A Multicast Address Listener performs the listener part of the
   MLDv2 protocol (described in detail in <a href="#proto" class="auto internal xref">Section 6</a>) on all interfaces
   on which multicast reception is supported, even if more than one of
   those interfaces are connected to the same link.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="build_state">
<section id="section-2.1">
        <h3 id="name-building-multicast-address-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-building-multicast-address-" class="section-name selfRef">Building Multicast Address Listening State on Multicast Address Listeners</a>
        </h3>
<p id="section-2.1-1">Upper-layer protocols and applications that run on a Multicast
   Address Listener node use specific service interface calls (described
   in <a href="#srvc_if" class="auto internal xref">Section 3</a>) to ask the IP layer to enable or disable reception of
   packets sent to specific multicast addresses.  The node keeps
   Multicast Address Listening state for each socket on which the
   service interface calls have been invoked (<a href="#sock_state" class="auto internal xref">Section 4.1</a>).  In addition
   to this per-socket Multicast Address Listening state, a node must also
   maintain or compute Multicast Address Listening state for each of its
   interfaces (<a href="#if_state" class="auto internal xref">Section 4.2</a>).  Conceptually, that state consists of a set
   of records, with each record containing an IPv6 multicast address, a
   filter-mode, and a source-list.  The filter-mode may be either
   INCLUDE or EXCLUDE.  In INCLUDE mode, reception of packets sent to
   the specified multicast address is enabled only from the source
   addresses listed in the source-list.  In EXCLUDE mode, reception of
   packets sent to the given multicast address is enabled from all
 source addresses except those listed in the source-list.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">At most, one record per multicast address exists for a given
   interface.  This per-interface state is derived from the per-socket
   state, but it may differ from the per-socket state when different
   sockets have differing
   filter-modes and/or source-lists for the same multicast address and
   interface.  After a multicast packet has been accepted from an
   interface by the IP layer, its subsequent delivery to the application
   connected to a particular socket depends on the Multicast Address Listening
   state of that socket (and possibly also on other conditions, such as
   what transport-layer port the socket is bound to).  Note that MLDv2
   messages are not subject to source filtering and must always be
   processed by hosts and routers.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="msg_ex">
<section id="section-2.2">
        <h3 id="name-exchanging-messages-between">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-exchanging-messages-between" class="section-name selfRef">Exchanging Messages between the Querier and the Listening Nodes</a>
        </h3>
<p id="section-2.2-1">There are three types of MLDv2 Query Messages: General Queries,
   Multicast Address Specific Queries, and Multicast Address and Source
   Specific Queries.  The Querier periodically sends General Queries, to
   learn Multicast Address Listener information from an attached link.
   These queries are used to build and refresh the Multicast Address
   Listening state inside all multicast routers on the link.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Nodes respond to these queries by reporting their per-interface
   Multicast Address Listening state through Current-State Report
   messages sent to a specific multicast address that all MLDv2 routers on
   the link listen to.  On the other hand, if the listening state of a
   node changes, the node immediately reports these changes through a
   State-Change Report message.  The State-Change Report contains either
   Filter-Mode-Change Records, Source-List-Change Records, or records of
   both types.  A detailed description of the report messages is
   presented in <a href="#mar_types" class="auto internal xref">Section 5.2.13</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Both router and listener state changes are mainly triggered by the
   expiration of a specific timer or the reception of an MLD message
   (listener state change can be also triggered by the invocation of a
   service interface call).  Therefore, to enhance protocol robustness,
   in spite of the possible unreliability of message exchanges, messages
   are retransmitted several times.  Furthermore, timers are set so as
   to take into account the possible message losses and to wait for
   retransmissions.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Periodical General Queries and Current-State Reports do not apply
   this rule, in order to not overload the link; it is assumed that in
   general, these messages do not generate state changes as their main
   purpose is to refresh existing state.  Thus, even if one such
   message is lost, the corresponding state will be refreshed during the
   next reporting period.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">As opposed to Current-State Reports, State-Change Reports are
   retransmitted several times, in order to avoid them being missed by
   one or more multicast routers.  The number of retransmissions depends
   on the so-called Robustness Variable.  This variable allows tuning
   the protocol according to the expected packet loss on a link.  If a
   link is expected to be lossy (e.g., a wireless connection), the value
   of the Robustness Variable may be increased.  MLD is robust to
   [Robustness Variable]-1 packet losses.  This document recommends a
    default value of 2 for the Robustness Variable (see <a href="#robust" class="auto internal xref">Section 9.1</a>).<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">If more changes to the same per-interface state entry occur before
   all the retransmissions of the State-Change Report for the first
   change have been completed, each additional change triggers the
    immediate transmission of a new State-Change Report.  <a href="#chg_if_state" class="auto internal xref">Section 6.1</a>
   shows how the content of this new report is computed. Retransmissions
   of the new State-Change Report will be scheduled as well, in order to
   ensure that each instance of state change is transmitted at least
    [Robustness Variable] times.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">If a node on a link expresses, through a State-Change Report, its
   desire to no longer listen to a particular multicast address (or
   source),  the Querier must query for other listeners of the multicast
   address (or source) before deleting the multicast address (or source)
   from its Multicast Address Listening state and stopping the
   corresponding traffic.  Thus, the Querier sends a Multicast Address
   Specific Query to verify whether there are nodes still listening to a
   specified multicast address or not.  Similarly, the Querier sends a
   Multicast Address and Source Specific Query to verify whether, for a
   specified multicast address, there are nodes still listening to a
    specific set of sources, or not.  <a href="#qry_vars" class="auto internal xref">Section 5.1.13</a> describes each query
    in more detail.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">Both Multicast Address Specific Queries and Multicast Address and
   Source Specific Queries are only sent in response to State-Change
   Reports, never in response to Current-State Reports.  This
   distinction between the two types of reports is needed to avoid the
   router treating all Multicast Listener Reports as potential changes
   in state.  By doing so, the fast leave mechanism of MLDv2, described
   in more detail in <a href="#mr-state" class="auto internal xref">Section 2.3</a>, might not be effective if a State-Change
   Report is lost and only the following Current-State Report is
   received by the router.  Nevertheless, it avoids an increased
   processing at the router, and it reduces the MLD traffic on the link.
   More details on the necessity of distinguishing between the two
    report types can be found in <a href="#state_change" class="auto internal xref">Appendix A.1</a>.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">Nodes respond to the above queries through Current-State Reports
   that contain their per-interface Multicast Address Listening state
    only for the multicast addresses (or sources) being queried.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<p id="section-2.2-10">As stated earlier, in order to ensure protocol robustness, all the
   queries, except the periodical General Queries, are retransmitted
   several times within a given time interval.  The number of
   retransmissions depends on the Robustness Variable.  If, while
   scheduling new queries, there are pending queries to be retransmitted
   for the same multicast address, the new queries and the pending
   queries have to be merged.  In addition, host reports received for a
   multicast address with pending queries may affect the contents of
   those queries.  The process of building and maintaining the state of
    pending queries is presented in <a href="#spec_qry" class="auto internal xref">Section 7.6.3</a>.<a href="#section-2.2-10" class="pilcrow">¶</a></p>
<p id="section-2.2-11">Protocol robustness is also enhanced through the use of the S flag (Suppress Router-Side Processing).  As described above, when a
   Multicast Address Specific or a Multicast Address and Source Specific
   Query is sent by the Querier, a number of retransmissions of the
   query are scheduled.  In the original (first) query, the S flag is
   clear.  When the Querier sends this query, it lowers the timers for
   the concerned multicast address (or source) to a given value;
   similarly, any non-querier multicast router that receives the query
   lowers its timers in the same way.  Nevertheless, while waiting for
   the next scheduled queries to be sent, the Querier may receive a
   report that updates the timers.  The scheduled queries still have to
   be sent, in order to ensure that a non-querier router keeps its state
   synchronized with the current Querier (the non-querier router might
   have missed the first query).  Nevertheless, the timers should not be
   lowered again, as a valid answer was already received.  Therefore, in
    subsequent queries, the Querier sets the S flag.<a href="#section-2.2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mr-state">
<section id="section-2.3">
        <h3 id="name-building-multicast-address-l">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-building-multicast-address-l" class="section-name selfRef">Building Multicast Address Listening State on Multicast Routers</a>
        </h3>
<p id="section-2.3-1">Multicast routers that implement MLDv2 (whether they are in Querier
   state or not) keep state per multicast address per attached link.
   This Multicast Address Listening state consists of a filter-mode, a
   filter timer, and a source-list, with a timer associated to each
   source from the list.  The filter-mode is used to summarize the total
   listening state of a multicast address to a minimum set, such that
   all nodes' listening states are respected.  The filter-mode may
   change in response to the reception of particular types of report
    messages or when certain timer conditions occur.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">A router is in INCLUDE mode for a specific multicast address on a
   given interface if all the listeners on the link interested in that
   address are in INCLUDE mode.  The router state is represented through
   the notation INCLUDE (A), where A is a list of sources, called the
   "Include List".  The Include List is the set of sources that one or
   more listeners on the link have requested to receive.  All the
   sources from the Include List will be forwarded by the router.  Any
   other source that is not in the Include List will be blocked by the
    router.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">A source can be added to the current Include List if a listener in
   INCLUDE mode sends a Current-State or a State-Change Report that
   includes that source.  Each source from the Include List is
   associated with a Source Timer that is updated whenever a listener in
   INCLUDE mode sends a report that confirms its interest in that
   specific source.  If the timer of a source from the Include List
    expires, the source is deleted from the Include List.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">Besides this "soft leave" mechanism, there is also a "fast leave"
   scheme in MLDv2; it is also based on the use of source timers.  When
   a node in INCLUDE mode expresses its desire to stop listening to a
   specific source, all the multicast routers on the link lower their
   timers for that source to a given value.  The Querier then sends a
   Multicast Address and Source Specific Query, to verify whether there
   are other listeners for that source on the link, or not.  If a report
   that includes this source is received before the timer expiration,
   all the multicast routers on the link update the source timer.  If
   not, the source is deleted from the Include List.  The handling of
   the Include List, according to the received reports, is detailed in Sections 
   <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">A router is in EXCLUDE mode for a specific multicast address on a
   given interface if there is at least one listener in EXCLUDE mode for
   that address on the link.  When the first report is received from
   such a listener, the router sets the Filter Timer that corresponds to
   that address.  This timer is reset each time an EXCLUDE mode listener
   confirms its listening state through a Current-State Report.  The
   timer is also updated when a listener, formerly in INCLUDE mode,
   announces its filter-mode change through a State-Change Report
   message.  If the Filter Timer expires, it means that there are no
   more listeners in EXCLUDE mode on the link.  In this case, the router
    switches back to INCLUDE mode for that multicast address.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">When the router is in EXCLUDE mode, the router state is represented
   by the notation EXCLUDE (X,Y), where X is called the "Requested List"
   and Y is called the "Exclude List".  All sources, except those from
   the Exclude List, will be forwarded by the router.  The Requested
   List has no effect on forwarding.  Nevertheless, the router has to
   maintain the Requested List for two reasons:<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-7">
          <li id="section-2.3-7.1">
            <p id="section-2.3-7.1.1">To keep track of sources that listeners in INCLUDE mode listen
            to.  This is necessary to assure a seamless transition of the
            router to INCLUDE mode, when there is no listener in EXCLUDE mode
            left.  This transition should not interrupt the flow of traffic to
            listeners in INCLUDE mode for that multicast address.  Therefore,
            at the time of the transition, the Requested List should contain
            the set of sources that nodes in INCLUDE mode have explicitly
            requested.<a href="#section-2.3-7.1.1" class="pilcrow">¶</a></p>
<p id="section-2.3-7.1.2">
      When the router switches to INCLUDE mode, the sources in the Requested
      List are moved to the Include List, and the Exclude List is deleted.
      Before switching, the Requested List can contain an inexact guess of the
      sources listeners in INCLUDE mode listen to, which might be too large or too
      small.  These inexactitudes are due to the fact that the Requested List
      is also used for fast blocking purposes, as described below.  If such a
      fast blocking is required, some sources may be deleted from the
      Requested List (as shown in Sections <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>) in
      order to reduce router state.  Nevertheless, in each such case, the
      Filter Timer is updated as well.  Therefore, listeners in INCLUDE mode
      will have enough time, before an eventual switching, to reconfirm their
      interest in the eliminated source(s) and rebuild the Requested List
      accordingly.  The protocol ensures that when a switch to INCLUDE mode
      occurs, the Requested List will be accurate.  Details about the
      transition of the router to INCLUDE mode are presented in <a href="#mode_switch" class="auto internal xref">Appendix A.3</a>.<a href="#section-2.3-7.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.3-7.2">
            <p id="section-2.3-7.2.1">To allow the fast blocking of previously unblocked sources.  If
      the router receives a report that contains such a request, the
      concerned sources are added to the Requested List.  Their timers
      are set to a given small value, and a Multicast Address and Source
      Specific Query is sent by the Querier, to check whether there are
      nodes on the link still interested in those sources, or not.  If
      no node announces its interest in receiving those specific sources,
      the timers of those sources expire.  Then, the sources are moved
      from the Requested List to the Exclude List.  From then on, the
    sources will be blocked by the router.<a href="#section-2.3-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-2.3-8">The handling of the EXCLUDE mode router state, according to the
        received reports, is detailed in Sections <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>.<a href="#section-2.3-8" class="pilcrow">¶</a></p>
<p id="section-2.3-9">Both the MLDv2 router and listener behaviors described in this
   document were defined to ensure backward interoperability with MLDv1
    hosts and routers.  Interoperability issues are detailed in <a href="#interop" class="auto internal xref">Section 8</a>.<a href="#section-2.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="srvc_if">
<section id="section-3">
      <h2 id="name-the-service-interface-for-r">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-the-service-interface-for-r" class="section-name selfRef">The Service Interface for Requesting IP Multicast Reception</a>
      </h2>
<p id="section-3-1">Within an IP system, there is (at least conceptually) a service
   interface used by upper-layer protocols or application programs to
   ask the IP layer to enable or disable reception of packets sent to
   specific IP multicast addresses.  In order to take full advantage of
   the capabilities of MLDv2, a node's IP service interface must support
    the following operation:<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-3-2">
<pre>
   IPv6MulticastListen ( socket, interface, IPv6 multicast-address,
                         filter-mode, source-list )</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<p id="section-3-3">where:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">"socket" is an implementation-specific parameter used to
      distinguish among different requesting entities (e.g., programs and
      processes) within the node; the socket parameter of BSD Unix
    system calls is a specific example.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.2">
          <p id="section-3-4.2.1">"interface" is a local identifier of the network interface on
      which reception of the specified multicast address is to be
      enabled or disabled.  Interfaces may be physical (e.g., an
      Ethernet interface) or virtual (e.g., the endpoint of a Frame
      Relay virtual circuit or an IP-in-IP "tunnel").  An implementation
      may allow a special "unspecified" value to be passed as the
      interface parameter, in which case the request would apply to the
      "primary" or "default" interface of the node (perhaps established
      by system configuration).  If reception of the same multicast
      address is desired on more than one interface, IPv6MulticastListen
    is invoked separately for each desired interface.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.3">
          <p id="section-3-4.3.1">"IPv6 multicast address" is the multicast address to which the
      request pertains.  If reception of more than one multicast address
      on a given interface is desired, IPv6MulticastListen is invoked
    separately for each desired address.<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.4">
          <p id="section-3-4.4.1">"filter-mode" may be either INCLUDE or EXCLUDE.  In INCLUDE mode,
      reception of packets sent to the specified multicast address is
      requested only from the source addresses listed in the source-list
      parameter.  In EXCLUDE mode, reception of packets sent to the
      given multicast address is requested from all source addresses
    except those listed in the source-list parameter.<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.5">
          <p id="section-3-4.5.1">"source-list" is an unordered list of zero or more unicast
      addresses from which multicast reception is desired or not
      desired, depending on the filter-mode.  An implementation <span class="bcp14">MAY</span>
      impose a limit on the size of source-lists.  When an operation
      causes the source-list size limit to be exceeded, the service
    interface <span class="bcp14">SHOULD</span> return an error.<a href="#section-3-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-5">For a given combination of socket, interface, and IPv6 multicast
   address, only a single filter-mode and source-list can be in effect
   at any one time.  Nevertheless, either the filter-mode or the source-list,
   or both, may be changed by subsequent IPv6MulticastListen
   requests that specify the same socket, interface, and IPv6 multicast
   address.  Each subsequent request completely replaces any earlier
    request for the given socket, interface, and multicast address.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The MLDv1 protocol did not support source filters and had a simpler
   service interface; it consisted of Start Listening and Stop Listening
   operations to enable and disable listening to a given multicast
   address (from all sources) on a given interface.  The equivalent
    operations in the service interface are as follows.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The Start Listening operation is equivalent to:<a href="#section-3-7" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-3-8">
<pre>
   IPv6MulticastListen ( socket, interface, IPv6 multicast address,
                         EXCLUDE, {} )</pre><a href="#section-3-8" class="pilcrow">¶</a>
</div>
<p id="section-3-9">and the Stop Listening operation is equivalent to:<a href="#section-3-9" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-3-10">
<pre>
   IPv6MulticastListen ( socket, interface, IPv6 multicast address,
                         INCLUDE, {} )</pre><a href="#section-3-10" class="pilcrow">¶</a>
</div>
<p id="section-3-11">where {} is an empty source-list.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">An example of an API that provides the capabilities outlined in this
    service interface is given in <span>[<a href="#RFC3678" class="cite xref">RFC3678</a>]</span>.<a href="#section-3-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node_state">
<section id="section-4">
      <h2 id="name-multicast-address-listening">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-multicast-address-listening" class="section-name selfRef">Multicast Address Listening State Maintained by Nodes</a>
      </h2>
<div id="sock_state">
<section id="section-4.1">
        <h3 id="name-per-socket-state">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-per-socket-state" class="section-name selfRef">Per-Socket State</a>
        </h3>
<p id="section-4.1-1">For each socket on which IPv6MulticastListen has been invoked, the
   node records the desired Multicast Address Listening state for that socket.
    That state conceptually consists of a set of records of the form:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.1-2">
<pre>
   (interface, IPv6 multicast address, filter-mode, source-list)</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The per-socket state evolves in response to each invocation of
   IPv6MulticastListen on the socket, as follows:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">If the requested filter-mode is INCLUDE and the requested source-list
      is empty, then the entry that corresponds to the requested
      interface and multicast address is deleted, if present.  If no
    such entry is present, the request has no effect.<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">If the requested filter-mode is EXCLUDE or the requested source-list
      is non-empty, then the entry that corresponds to the
      requested interface and multicast address, if present, is changed
      to contain the requested filter-mode and source-list.  If no such
      entry is present, a new entry is created, using the parameters
    specified in the request.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="if_state">
<section id="section-4.2">
        <h3 id="name-per-interface-state">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-per-interface-state" class="section-name selfRef">Per-Interface State</a>
        </h3>
<p id="section-4.2-1">In addition to the per-socket Multicast Address Listening state, a node must
   also maintain or compute Multicast Address Listening state for each of its
   interfaces.  That state conceptually consists of a set of records of
   the form:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.2-2">
<pre>
      (IPv6 multicast address, filter-mode, source-list)</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">At most, one record per multicast address exists for a given
   interface.  This per-interface state is derived from the per-socket
   state, but it may differ from the per-socket state when different sockets have differing
   filter-modes and/or source-lists for the same multicast address and
   interface. For example, suppose one application or process invokes
   the following operation on socket s1:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.2-4">
<pre>
      IPv6MulticastListen ( s1, i, m, INCLUDE, {a, b, c} )</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">requesting reception on interface i of packets sent to multicast
   address m, only if they come from the sources a, b, or c.  Suppose
   another application or process invokes the following operation on
   socket s2:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-4.2-6">
<pre>
      IPv6MulticastListen ( s2, i, m, INCLUDE, {b, c, d} )</pre><a href="#section-4.2-6" class="pilcrow">¶</a>
</div>
<p id="section-4.2-7">requesting reception on the same interface i of packets sent to the
   same multicast address m, only if they come from sources b, c, or
   d.  In order to satisfy the reception requirements of both sockets,
   it is necessary for interface i to receive packets sent to m from any
   one of the sources a, b, c, or d.  Thus, in this example, the
   listening state of interface i for multicast address m has filter-mode
   INCLUDE and source-list {a, b, c, d}.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">After a multicast packet has been accepted from an interface by the
   IP layer, its subsequent delivery to the application or process that
   listens on a particular socket depends on the Multicast Address Listening
   state of that socket (and possibly also on other conditions, such as
   what transport-layer port the socket is bound to).  So, in the above
   example, if a packet arrives on interface i, destined to multicast
   address m, with source address a, it may be delivered on socket s1
   but not on socket s2.  Note that MLDv2 messages are not subject to
   source filtering and must always be processed by hosts and routers.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">Requiring the filtering of packets based upon a socket's multicast
   reception state is a feature of this service interface.  The
   previous service interface described no filtering based upon
   Multicast Address Listening state; rather, a Start Listening operation on a
   socket simply caused the node to start to listen to a multicast
   address on the given interface; packets sent to that multicast
   address could be delivered to all sockets, whether they had started
   to listen or not.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">The general rules for deriving the per-interface state from the per-
   socket state are as follows:  for each distinct (interface, IPv6
   multicast address) pair that appears in any per-socket state, a per-
   interface record is created for that multicast address on that
   interface.  Considering all socket records that contain the same
   (interface, IPv6 multicast address) pair,<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1">
            <p id="section-4.2-11.1.1">if any such record has a filter-mode of EXCLUDE, then the
            filter-mode of the interface record is EXCLUDE, and the source-list
            of the interface record is the intersection of the source-lists
            of all socket records in EXCLUDE mode, minus those source
            addresses that appear in any socket record in INCLUDE mode.  For
            example, if the socket records for multicast address m on
            interface i are:<a href="#section-4.2-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1.2.1">from socket s1: ( i, m, EXCLUDE, {a, b, c, d} )<a href="#section-4.2-11.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-11.1.2.2">from socket s2: ( i, m, EXCLUDE, {b, c, d, e} )<a href="#section-4.2-11.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-11.1.2.3">from socket s3: ( i, m, INCLUDE, {d, e, f} )<a href="#section-4.2-11.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.2-11.1.3">then the corresponding interface record on interface i is:<a href="#section-4.2-11.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1.4.1">( m, EXCLUDE, {b, c} )<a href="#section-4.2-11.1.4.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.2-11.1.5">If a fourth socket is added, such as:<a href="#section-4.2-11.1.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1.6.1">From socket s4: ( i, m, EXCLUDE, {} )<a href="#section-4.2-11.1.6.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.2-11.1.7">then the interface record becomes:<a href="#section-4.2-11.1.7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1.8.1">( m, EXCLUDE, {} )<a href="#section-4.2-11.1.8.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-11.2">
            <p id="section-4.2-11.2.1">if all such records have a filter-mode of INCLUDE, then the
            filter-mode of the interface record is INCLUDE, and the source-list
            of the interface record is the union of the source-lists of
            all the socket records.  For example, if the socket records for
            multicast address m on interface i are:<a href="#section-4.2-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.2.2.1">from socket s1:  ( i, m, INCLUDE, {a, b, c} )<a href="#section-4.2-11.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-11.2.2.2">from socket s2:  ( i, m, INCLUDE, {b, c, d} )<a href="#section-4.2-11.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-11.2.2.3">from socket s3:  ( i, m, INCLUDE, {e, f} )<a href="#section-4.2-11.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.2-11.2.3">then the corresponding interface record on interface i is:<a href="#section-4.2-11.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.2.4.1">( m, INCLUDE, {a, b, c, d, e, f} )<a href="#section-4.2-11.2.4.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.2-11.2.5">An implementation <span class="bcp14">MUST NOT</span> use an EXCLUDE
            interface record for a multicast address if all sockets for this
            multicast address are in INCLUDE state.  If system resource limits
            are reached when a per- interface state source-list is calculated,
            an error <span class="bcp14">MUST</span> be returned to the application which
            requested the operation.<a href="#section-4.2-11.2.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-12">The above rules for deriving the per-interface state are
   (re)evaluated whenever an IPv6MulticastListen invocation modifies the
   per-socket state by adding, deleting, or modifying a per-socket state
   record.  Note that a change of the per-socket state does not
    necessarily result in a change of the per-interface state.<a href="#section-4.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-5">
      <h2 id="name-message-formats">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-message-formats" class="section-name selfRef">Message Formats</a>
      </h2>
<p id="section-5-1">MLDv2 is a sub-protocol of ICMPv6, that is, MLDv2 message types are a
   subset of ICMPv6 messages, and MLDv2 messages are identified in IPv6
   packets by a preceding Next Header value of 58.  All MLDv2 messages
   described in this document <span class="bcp14">MUST</span> be sent with a link-local IPv6 Source
   Address, an IPv6 Hop Limit of 1, and an IPv6 Router Alert option
   <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span> in a Hop-by-Hop Options header.  (The Router Alert option
   is necessary to cause routers to examine MLDv2 messages sent to IPv6
   multicast addresses in which the routers themselves have no
   interest.)  MLDv2 Reports can be sent with the source address set to
    the unspecified address <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>, if a valid link-local IPv6 source
   address has not been acquired yet for the sending interface.  (See
    <a href="#src_addrs" class="auto internal xref">Section 5.2.14</a> for details.)<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">There are two MLD message types of concern to the MLDv2 protocol
   described in this document:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">
          <p id="section-5-3.1.1">Multicast Listener Query (Type = decimal 130)<a href="#section-5-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-3.2">
          <p id="section-5-3.2.1">Version 2 Multicast Listener Report (Type = decimal 143).  See
    <a href="#iana" class="auto internal xref">Section 11</a> for IANA considerations.<a href="#section-5-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-4">To assure the interoperability with nodes that implement MLDv1 (see
   <a href="#interop" class="auto internal xref">Section 8</a>), an implementation of MLDv2 must also support the
   following two message types:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">Multicast Listener Report (Type = decimal 131) <span>[<a href="#RFC2710" class="cite xref">RFC2710</a>]</span><a href="#section-5-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.2">
          <p id="section-5-5.2.1">Multicast Listener Done (Type = decimal 132) <span>[<a href="#RFC2710" class="cite xref">RFC2710</a>]</span><a href="#section-5-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-6">Unrecognized message types <span class="bcp14">MUST</span> be silently ignored.  Other message
   types may be used by newer versions or extensions of MLD, by
    multicast routing protocols, or for other uses.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">In this document, unless otherwise qualified, the capitalized words
   "Query" and "Report" refer to MLD Multicast Listener Queries and MLD
    Version 2 Multicast Listener Reports, respectively.<a href="#section-5-7" class="pilcrow">¶</a></p>
<div id="qry_msg">
<section id="section-5.1">
        <h3 id="name-multicast-listener-query-me">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-multicast-listener-query-me" class="section-name selfRef">Multicast Listener Query Message</a>
        </h3>
<p id="section-5.1-1">Multicast Listener Queries are sent by multicast routers in Querier
   state to query the Multicast Address Listening state of neighboring
    interfaces.  Queries have the following format:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Type = 130   |      Code     |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Maximum Response Code      |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
*                                                               *
|                                                               |
*                       Multicast Address                       *
|                                                               |
*                                                               *
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Flags |S| QRV |     QQIC      |     Number of Sources (N)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [1]                      *
|                                                               |
*                                                               *
|                                                               |
+-                                                             -+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [2]                      *
|                                                               |
*                                                               *
|                                                               |
+-                              .                              -+
.                               .                               .
.                               .                               .
+-                                                             -+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [N]                      *
|                                                               |
*                                                               *
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<section id="section-5.1.1">
          <h4 id="name-code">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-code" class="section-name selfRef">Code</a>
          </h4>
<p id="section-5.1.1-1">The Code field is initialized to zero by the sender and ignored by receivers.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.2">
          <h4 id="name-checksum">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-checksum" class="section-name selfRef">Checksum</a>
          </h4>
<p id="section-5.1.2-1">The Checksum field is the standard ICMPv6 checksum; it covers the entire MLDv2 message,
    plus a "pseudo-header" of IPv6 header fields <span>[<a href="#RFC4443" class="cite xref">RFC4443</a>]</span>  <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.  For
   computing the checksum, the Checksum field is set to zero.  When a
   packet is received, the checksum <span class="bcp14">MUST</span> be verified before processing
    it.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
<div id="mrcode">
<section id="section-5.1.3">
          <h4 id="name-maximum-response-code">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-maximum-response-code" class="section-name selfRef">Maximum Response Code</a>
          </h4>
<p id="section-5.1.3-1">The Maximum Response Code field specifies the maximum time
          allowed before sending a responding Report.  The actual time
          allowed, called the "Maximum Response Delay", is represented in units
          of milliseconds and is derived from the Maximum Response Code as
          follows:<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3-2.1">If Maximum Response Code &lt; 32768, Maximum Response Delay =
            Maximum Response Code.<a href="#section-5.1.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.3-2.2">
              <p id="section-5.1.3-2.2.1">If Maximum Response Code
            &gt;=32768, Maximum Response Code represents a floating-point
            value as follows:<a href="#section-5.1.3-2.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.3-2.2.2">
<pre>
    0 1 2 3 4 5 6 7 8 9 A B C D E F
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |1| exp |          mant         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Maximum Response Delay = (mant | 0x1000) &lt;&lt; (exp+3)</pre><a href="#section-5.1.3-2.2.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-5.1.3-3">Small values of Maximum Response Delay allow MLDv2 routers to tune
   the leave latency (the time between the moment the last node on a
   link ceases to listen to a specific multicast address and the moment
   the routing protocol is notified that there are no more listeners for
   that address).  Larger values, especially in the exponential range,
    allow the tuning of the burstiness of MLD traffic on a link.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.1.4">
          <h4 id="name-reserved">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-reserved" class="section-name selfRef">Reserved</a>
          </h4>
<p id="section-5.1.4-1">The Reserved field is set to zero on transmission and ignored on reception.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.5">
          <h4 id="name-multicast-address">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-multicast-address" class="section-name selfRef">Multicast Address</a>
          </h4>
<p id="section-5.1.5-1">For a General Query, the Multicast Address field is set to zero.  For
   a Multicast Address Specific Query or Multicast Address and Source
   Specific Query, it is set to the multicast address being queried (see
    <a href="#num_srcs" class="auto internal xref">Section 5.1.10</a>, below).<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.6">
          <h4 id="name-flags">
<a href="#section-5.1.6" class="section-number selfRef">5.1.6. </a><a href="#name-flags" class="section-name selfRef">Flags</a>
          </h4>
<p id="section-5.1.6-1">Allocation of individual bits within the Flags field is described in
   <span><a href="https://rfc-editor.org/rfc/rfc9778#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC9778" class="cite xref">RFC9778</a>]</span>. Future specifications
   will define the associated meaning tied to any such allocation.<a href="#section-5.1.6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.7">
          <h4 id="name-s-flag-suppress-router-side">
<a href="#section-5.1.7" class="section-number selfRef">5.1.7. </a><a href="#name-s-flag-suppress-router-side" class="section-name selfRef">S Flag (Suppress Router-Side Processing)</a>
          </h4>
<p id="section-5.1.7-1">When set to one, the S flag indicates to any receiving multicast
   routers that they have to suppress the normal timer updates they
   perform upon receiving a Query.  Nevertheless, it does not suppress the
   querier election or the normal "host-side" processing of a Query that
   a router may be required to perform as a consequence of itself being
    a multicast listener.<a href="#section-5.1.7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.8">
          <h4 id="name-qrv-queriers-robustness-var">
<a href="#section-5.1.8" class="section-number selfRef">5.1.8. </a><a href="#name-qrv-queriers-robustness-var" class="section-name selfRef">QRV (Querier's Robustness Variable)</a>
          </h4>
<p id="section-5.1.8-1">If non-zero, the QRV field contains the [Robustness Variable] value
   used by the Querier.  If the Querier's [Robustness Variable] exceeds
    7 (the maximum value of the QRV field), the QRV field is set to zero.<a href="#section-5.1.8-1" class="pilcrow">¶</a></p>
<p id="section-5.1.8-2">Routers adopt the QRV value from the most recently received Query as
   their own [Robustness Variable] value, unless that most recently
   received QRV was zero, in which case they use the default [Robustness
    Variable] value specified in <a href="#robust" class="auto internal xref">Section 9.1</a> or a statically configured
    value.<a href="#section-5.1.8-2" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.9">
          <h4 id="name-qqic-queriers-query-interva">
<a href="#section-5.1.9" class="section-number selfRef">5.1.9. </a><a href="#name-qqic-queriers-query-interva" class="section-name selfRef">QQIC (Querier's Query Interval Code)</a>
          </h4>
<p id="section-5.1.9-1">The QQIC field specifies the [Query
   Interval] used by the Querier.  The actual interval, called the
   "Querier's Query Interval (QQI)", is represented in units of seconds
    and is derived from the QQIC as follows:<a href="#section-5.1.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.9-2.1">If QQIC &lt; 128, QQI = QQIC<a href="#section-5.1.9-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.9-2.2">
              <p id="section-5.1.9-2.2.1">If QQIC &gt;= 128, QQIC represents a floating-point value as follows:<a href="#section-5.1.9-2.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.9-2.2.2">
<pre>
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |1| exp | mant  |
   +-+-+-+-+-+-+-+-+

QQI = (mant | 0x10) &lt;&lt; (exp + 3)</pre><a href="#section-5.1.9-2.2.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-5.1.9-3">Multicast routers that are not the current Querier adopt the QQI
   value from the most recently received Query as their own [Query
   Interval] value, unless that most recently received QQI was zero, in
   which case the receiving routers use the default [Query Interval]
    value specified in <a href="#qry_int" class="auto internal xref">Section 9.2</a>.<a href="#section-5.1.9-3" class="pilcrow">¶</a></p>
</section>
<div id="num_srcs">
<section id="section-5.1.10">
          <h4 id="name-number-of-sources-n">
<a href="#section-5.1.10" class="section-number selfRef">5.1.10. </a><a href="#name-number-of-sources-n" class="section-name selfRef">Number of Sources (N)</a>
          </h4>
<p id="section-5.1.10-1">The Number of Sources (N) field specifies how many source addresses
   are present in the Query.  This number is zero in a General Query or
   a Multicast Address Specific Query and non-zero in a Multicast
   Address and Source Specific Query.  This number is limited by the MTU
   of the link over which the Query is transmitted.  For example, on an
   Ethernet link with an MTU of 1500 octets, the IPv6 header (40 octets)
   together with the Hop-by-Hop Extension Header (8 octets) that
   includes the Router Alert option consume 48 octets; the MLD fields up
   to the Number of Sources (N) field consume 28 octets; thus, there are
   1424 octets left for source addresses, which limits the number of
    source addresses to 89 (1424/16).<a href="#section-5.1.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.1.11">
          <h4 id="name-source-address-i">
<a href="#section-5.1.11" class="section-number selfRef">5.1.11. </a><a href="#name-source-address-i" class="section-name selfRef">Source Address [i]</a>
          </h4>
<p id="section-5.1.11-1">The Source Address [i] fields are a vector of n unicast addresses,
    where n is the value in the Number of Sources (N) field.<a href="#section-5.1.11-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.12">
          <h4 id="name-additional-data">
<a href="#section-5.1.12" class="section-number selfRef">5.1.12. </a><a href="#name-additional-data" class="section-name selfRef">Additional Data</a>
          </h4>
<p id="section-5.1.12-1">If the Payload Length field in the IPv6 header of a received Query
   indicates that there are additional octets of data present, beyond
   the fields described here, MLDv2 implementations <span class="bcp14">MUST</span> include those
   octets in the computation to verify the received MLD Checksum, but
   <span class="bcp14">MUST</span> otherwise ignore those additional octets.  When sending a Query,
   an MLDv2 implementation <span class="bcp14">MUST NOT</span> include additional octets beyond the
    fields described above.<a href="#section-5.1.12-1" class="pilcrow">¶</a></p>
</section>
<div id="qry_vars">
<section id="section-5.1.13">
          <h4 id="name-query-variants">
<a href="#section-5.1.13" class="section-number selfRef">5.1.13. </a><a href="#name-query-variants" class="section-name selfRef">Query Variants</a>
          </h4>
<p id="section-5.1.13-1">There are three variants of the Query Message:<a href="#section-5.1.13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.13-2.1">
              <p id="section-5.1.13-2.1.1">A "General Query" is sent by the Querier to learn which
              multicast addresses have listeners on an attached link.  In a
              General Query, both the Multicast Address field and the Number
              of Sources (N) field are zero.<a href="#section-5.1.13-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.13-2.2">
              <p id="section-5.1.13-2.2.1">A "Multicast Address Specific Query" is sent by the Querier
              to learn if a particular multicast address has any listeners on
              an attached link.  In a Multicast Address Specific Query, the
              Multicast Address field contains the multicast address of
              interest, while the Number of Sources (N) field is set to
              zero.<a href="#section-5.1.13-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.13-2.3">
              <p id="section-5.1.13-2.3.1">A "Multicast Address and Source Specific Query" is sent by
              the Querier to learn if any of the sources from the specified
              list for the particular multicast address has any listeners on
              an attached link or not.  In a Multicast Address and Source
              Specific Query the Multicast Address field contains the
              multicast address of interest, while the Source Address [i]
              field(s) contain(s) the source address(es) of interest.<a href="#section-5.1.13-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<section id="section-5.1.14">
          <h4 id="name-source-addresses-for-querie">
<a href="#section-5.1.14" class="section-number selfRef">5.1.14. </a><a href="#name-source-addresses-for-querie" class="section-name selfRef">Source Addresses for Queries</a>
          </h4>
<p id="section-5.1.14-1">All MLDv2 Queries <span class="bcp14">MUST</span> be sent with a valid IPv6 link-local source
   address.  If a node (router or host) receives a Query Message with
   the IPv6 Source Address set to the unspecified address (::), or any
   other address that is not a valid IPv6 link-local address, it <span class="bcp14">MUST</span>
    silently discard the message and <span class="bcp14">SHOULD</span> log a warning.<a href="#section-5.1.14-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.15">
          <h4 id="name-destination-addresses-for-q">
<a href="#section-5.1.15" class="section-number selfRef">5.1.15. </a><a href="#name-destination-addresses-for-q" class="section-name selfRef">Destination Addresses for Queries</a>
          </h4>
<p id="section-5.1.15-1">In MLDv2, General Queries are sent to the link-scope all-nodes
   multicast address (ff02::1).  Multicast Address Specific and
   Multicast Address and Source Specific Queries are sent with an IP
   destination address equal to the multicast address of interest.
   However, a node <span class="bcp14">MUST</span> accept and process any Query whose IP
   Destination Address field contains any of the addresses (unicast or
   multicast) assigned to the interface on which the Query arrives. This
    might be useful, e.g., for debugging purposes.<a href="#section-5.1.15-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-5.2">
        <h3 id="name-version-2-multicast-listene">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-version-2-multicast-listene" class="section-name selfRef">Version 2 Multicast Listener Report Message</a>
        </h3>
<p id="section-5.2-1">Version 2 Multicast Listener Reports are sent by IP nodes to report
   (to neighboring routers) the current Multicast Address Listening state, or
   changes in the Multicast Address Listening state, of their interfaces.
    Reports have the following format:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Type = 143   |    Reserved   |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Flags             |Nr of Mcast Address Records (M)|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                  Multicast Address Record [1]                 .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                  Multicast Address Record [2]                 .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               .                               |
.                               .                               .
|                               .                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                  Multicast Address Record [M]                 .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">Each Multicast Address Record has the following internal format:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Record Type  |  Aux Data Len |     Number of Sources (N)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
*                                                               *
|                                                               |
*                       Multicast Address                       *
|                                                               |
*                                                               *
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [1]                      *
|                                                               |
*                                                               *
|                                                               |
+-                                                             -+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [2]                      *
|                                                               |
*                                                               *
|                                                               |
+-                                                             -+
.                               .                               .
.                               .                               .
.                               .                               .
+-                                                             -+
|                                                               |
*                                                               *
|                                                               |
*                       Source Address [N]                      *
|                                                               |
*                                                               *
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                         Auxiliary Data                        .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<section id="section-5.2.1">
          <h4 id="name-reserved-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-reserved-2" class="section-name selfRef">Reserved</a>
          </h4>
<p id="section-5.2.1-1">The Reserved field is set to zero on transmission and ignored on reception.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.2">
          <h4 id="name-checksum-2">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-checksum-2" class="section-name selfRef">Checksum</a>
          </h4>
<p id="section-5.2.2-1">The Checksum Field is the standard ICMPv6 checksum; it covers the entire MLDv2 message, plus a "pseudo-header" of IPv6 header fields <span>[<a href="#RFC4443" class="cite xref">RFC4443</a>]</span> <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.  In
   order to compute the checksum, the Checksum field is set to zero.
   When a packet is received, the checksum <span class="bcp14">MUST</span> be verified before
    processing it.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.3">
          <h4 id="name-flags-2">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-flags-2" class="section-name selfRef">Flags</a>
          </h4>
<p id="section-5.2.3-1">Allocation of individual bits within the Flags field is described in
   <span><a href="https://rfc-editor.org/rfc/rfc9778#section-2.3" class="relref">Section 2.3</a> of [<a href="#RFC9778" class="cite xref">RFC9778</a>]</span>. Future specifications
   will define the associated meaning tied to any such allocation.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.4">
          <h4 id="name-nr-of-mcast-address-records">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-nr-of-mcast-address-records" class="section-name selfRef">Nr of Mcast Address Records (M)</a>
          </h4>
<p id="section-5.2.4-1">The Nr of the Mcast Address Records (M) field specifies how many
    Multicast Address Records are present in this Report.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.5">
          <h4 id="name-multicast-address-record">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-multicast-address-record" class="section-name selfRef">Multicast Address Record</a>
          </h4>
<p id="section-5.2.5-1">Each Multicast Address Record is a block of fields that contain
   information on the sender listening to a single multicast address on
    the interface from which the Report is sent.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.6">
          <h4 id="name-record-type">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-record-type" class="section-name selfRef">Record Type</a>
          </h4>
<p id="section-5.2.6-1">The Record Type field specifies the type of the Multicast Address Record.  See 
   <a href="#mar_types" class="auto internal xref">Section 5.2.13</a> for a detailed description of the different possible Record
    Types.<a href="#section-5.2.6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.7">
          <h4 id="name-aux-data-len">
<a href="#section-5.2.7" class="section-number selfRef">5.2.7. </a><a href="#name-aux-data-len" class="section-name selfRef">Aux Data Len</a>
          </h4>
<p id="section-5.2.7-1">The Aux Data Len field contains the length of the Auxiliary Data
   field in this Multicast Address Record, in units of 32-bit words.  It
    may contain zero, to indicate the absence of any auxiliary data.<a href="#section-5.2.7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.8">
          <h4 id="name-number-of-sources-n-2">
<a href="#section-5.2.8" class="section-number selfRef">5.2.8. </a><a href="#name-number-of-sources-n-2" class="section-name selfRef">Number of Sources (N)</a>
          </h4>
<p id="section-5.2.8-1">The Number of Sources (N) field specifies how many source addresses
    are present in this Multicast Address Record.<a href="#section-5.2.8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.9">
          <h4 id="name-multicast-address-2">
<a href="#section-5.2.9" class="section-number selfRef">5.2.9. </a><a href="#name-multicast-address-2" class="section-name selfRef">Multicast Address</a>
          </h4>
<p id="section-5.2.9-1">The Multicast Address field contains the multicast address to which
    this Multicast Address Record pertains.<a href="#section-5.2.9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.10">
          <h4 id="name-source-address-i-2">
<a href="#section-5.2.10" class="section-number selfRef">5.2.10. </a><a href="#name-source-address-i-2" class="section-name selfRef">Source Address [i]</a>
          </h4>
<p id="section-5.2.10-1">The Source Address [i] fields are a vector of n unicast addresses,
    where n is the value in this record's Number of Sources (N) field.<a href="#section-5.2.10-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.11">
          <h4 id="name-auxiliary-data">
<a href="#section-5.2.11" class="section-number selfRef">5.2.11. </a><a href="#name-auxiliary-data" class="section-name selfRef">Auxiliary Data</a>
          </h4>
<p id="section-5.2.11-1">The Auxiliary Data field, if present, contains additional information
   that pertains to this Multicast Address Record.  The protocol
   specified in this document, MLDv2, does not define any auxiliary
   data.  Therefore, implementations of MLDv2 <span class="bcp14">MUST NOT</span> include any
   auxiliary data (i.e., <span class="bcp14">MUST</span> set the Aux Data Len field to zero) in any
   transmitted Multicast Address Record and <span class="bcp14">MUST</span> ignore any such data
   present in any received Multicast Address Record.  The semantics and
   the internal encoding of the Auxiliary Data field are to be defined
    by any future version or extension of MLD that uses this field.<a href="#section-5.2.11-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2.12">
          <h4 id="name-additional-data-2">
<a href="#section-5.2.12" class="section-number selfRef">5.2.12. </a><a href="#name-additional-data-2" class="section-name selfRef">Additional Data</a>
          </h4>
<p id="section-5.2.12-1">If the Payload Length field in the IPv6 header of a received Report
   indicates that there are additional octets of data present, beyond
   the last Multicast Address Record, MLDv2 implementations <span class="bcp14">MUST</span> include
   those octets in the computation to verify the received MLD Checksum,
   but <span class="bcp14">MUST</span> otherwise ignore those additional octets.  When sending a
   Report, an MLDv2 implementation <span class="bcp14">MUST NOT</span> include additional octets
    beyond the last Multicast Address Record.<a href="#section-5.2.12-1" class="pilcrow">¶</a></p>
</section>
<div id="mar_types">
<section id="section-5.2.13">
          <h4 id="name-multicast-address-record-ty">
<a href="#section-5.2.13" class="section-number selfRef">5.2.13. </a><a href="#name-multicast-address-record-ty" class="section-name selfRef">Multicast Address Record Types</a>
          </h4>
<p id="section-5.2.13-1">There are a number of different types of Multicast Address
          Records that may be included in a Report message:<a href="#section-5.2.13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.13-2.1">
              <p id="section-5.2.13-2.1.1">A "Current-State Record" is sent by a node in response to
            a Query received on an interface.  It reports the current
            listening state of that interface, with respect to a single
            multicast address.  The Record Type of a Current-State Record may
            be one of the following two values:<a href="#section-5.2.13-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.13-2.1.2">
<li id="section-5.2.13-2.1.2.1">
                  <p id="section-5.2.13-2.1.2.1.1">MODE_IS_INCLUDE - indicates that the interface has a
                  filter-mode of INCLUDE for the specified multicast address.
                  The Source Address [i] fields in this Multicast Address
                  Record contain the interface's source-list for the specified
                  multicast address.  A MODE_IS_INCLUDE Record is never sent
                  with an empty source-list.<a href="#section-5.2.13-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.13-2.1.2.2">
                  <p id="section-5.2.13-2.1.2.2.1">MODE_IS_EXCLUDE - indicates that the interface has a
                  filter-mode of EXCLUDE for the specified multicast address.
                  The Source Address [i] fields in this Multicast Address
                  Record contain the interface's source-list for the specified
                  multicast address, if it is non-empty. An SSM-aware host
                  <span class="bcp14">SHOULD NOT</span> send a MODE_IS_EXCLUDE record type
                  for multicast addresses that fall within the SSM address
                  range as they will be ignored by SSM-aware routers <span>[<a href="#RFC4604" class="cite xref">RFC4604</a>]</span>.<a href="#section-5.2.13-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li class="normal" id="section-5.2.13-2.2">
              <p id="section-5.2.13-2.2.1">A "Filter-Mode-Change Record" is sent by a node whenever a
              local invocation of IPv6MulticastListen causes a change of the
              filter-mode (i.e., a change from INCLUDE to EXCLUDE, or from
              EXCLUDE to INCLUDE) of the interface-level state entry for a
              particular multicast address, whether the source-list changes at
              the same time or not.  The Record is included in a Report sent
              from the interface on which the change occurred.  The Record
              Type of a Filter-Mode-Change Record may be one of the following
              two values:<a href="#section-5.2.13-2.2.1" class="pilcrow">¶</a></p>
<ol start="3" type="1" class="normal type-1" id="section-5.2.13-2.2.2">
<li id="section-5.2.13-2.2.2.1">
                  <p id="section-5.2.13-2.2.2.1.1">CHANGE_TO_INCLUDE_MODE - indicates that the interface has
                  changed to INCLUDE filter-mode for the specified multicast
                  address.  The Source Address [i] fields in this Multicast
                  Address Record contain the interface's new source-list for
                  the specified multicast address, if it is non-empty.<a href="#section-5.2.13-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.13-2.2.2.2">
                  <p id="section-5.2.13-2.2.2.2.1">CHANGE_TO_EXCLUDE_MODE - indicates that the interface has
                  changed to EXCLUDE filter-mode for the specified multicast
                  address.  The Source Address [i] fields in this Multicast
                  Address Record contain the interface's new source-list for
                  the specified multicast address, if it is non-empty. An
                  SSM-aware host <span class="bcp14">SHOULD NOT</span> send a
                  CHANGE_TO_EXCLUDE_MODE record type for multicast addresses
                  that fall within the SSM address range.<a href="#section-5.2.13-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li class="normal" id="section-5.2.13-2.3">
              <p id="section-5.2.13-2.3.1">A "Source-List-Change Record" is sent by a node whenever a
              local invocation of IPv6MulticastListen causes a change of
              source-list that is not coincident with a change of filter-mode,
              of the interface-level state entry for a particular multicast
              address.  The Record is included in a Report sent from the
              interface on which the change occurred.  The Record Type of a
              Source-List-Change Record may be one of the following two
              values:<a href="#section-5.2.13-2.3.1" class="pilcrow">¶</a></p>
<ol start="5" type="1" class="normal type-1" id="section-5.2.13-2.3.2">
<li id="section-5.2.13-2.3.2.1">
                  <p id="section-5.2.13-2.3.2.1.1">ALLOW_NEW_SOURCES - indicates that the Source Address [i]
                  fields in this Multicast Address Record contain a list of
                  the additional sources that the node wishes to listen to,
                  for packets sent to the specified multicast address.  If the
                  change was to an INCLUDE source-list, these are the
                  addresses that were added to the list; if the change was to
                  an EXCLUDE source-list, these are the addresses that were
                  deleted from the list.<a href="#section-5.2.13-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.13-2.3.2.2">
                  <p id="section-5.2.13-2.3.2.2.1">BLOCK_OLD_SOURCES - indicates that the Source Address [i]
                  fields in this Multicast Address Record contain a list of
                  the sources that the node no longer wishes to listen to, for
                  packets sent to the specified multicast address.  If the
                  change was to an INCLUDE source-list, these are the
                  addresses that were deleted from the list; if the change was
                  to an EXCLUDE source-list, these are the addresses that were
                  added to the list.<a href="#section-5.2.13-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
          </ul>
<p id="section-5.2.13-3">If a change of source-list results in both allowing new sources and
   blocking old sources, then two Multicast Address Records are sent for
   the same multicast address, one of type ALLOW_NEW_SOURCES and one of
    type BLOCK_OLD_SOURCES.<a href="#section-5.2.13-3" class="pilcrow">¶</a></p>
<p id="section-5.2.13-4">We use the term "State-Change Record" to refer to either a Filter
    Mode Change Record or a Source-List-Change Record.<a href="#section-5.2.13-4" class="pilcrow">¶</a></p>
<p id="section-5.2.13-5">Multicast Address Records with an unrecognized Record Type value <span class="bcp14">MUST</span>
    be silently ignored, with the rest of the report being processed.<a href="#section-5.2.13-5" class="pilcrow">¶</a></p>
<p id="section-5.2.13-6">In the rest of this document, we use the following notation to
   describe the contents of a Multicast Address Record that pertains to
    a particular multicast address:<a href="#section-5.2.13-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.2.13-7.1">IS_IN ( x )  -  Type MODE_IS_INCLUDE, source addresses x<a href="#section-5.2.13-7.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.2.13-7.2">IS_EX ( x )  -  Type MODE_IS_EXCLUDE, source addresses x<a href="#section-5.2.13-7.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.2.13-7.3">TO_IN ( x )  -  Type CHANGE_TO_INCLUDE_MODE, source addresses x<a href="#section-5.2.13-7.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.2.13-7.4">TO_EX ( x )  -  Type CHANGE_TO_EXCLUDE_MODE, source addresses x<a href="#section-5.2.13-7.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.2.13-7.5">ALLOW ( x )  -  Type ALLOW_NEW_SOURCES, source addresses x<a href="#section-5.2.13-7.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.2.13-7.6">BLOCK ( x )  -  Type BLOCK_OLD_SOURCES, source addresses x<a href="#section-5.2.13-7.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.13-8">where x is either:<a href="#section-5.2.13-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.13-9.1">
              <p id="section-5.2.13-9.1.1">a capital letter (e.g., "A") to represent the set of source
    addresses or<a href="#section-5.2.13-9.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.13-9.2">
              <p id="section-5.2.13-9.2.1">a set expression (e.g., "A+B"), where "A+B" means the union of
      sets A and B,  "A*B" means the intersection of sets A and B, and
    "A-B" means the removal of all elements of set B from set A.<a href="#section-5.2.13-9.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="src_addrs">
<section id="section-5.2.14">
          <h4 id="name-source-addresses-for-report">
<a href="#section-5.2.14" class="section-number selfRef">5.2.14. </a><a href="#name-source-addresses-for-report" class="section-name selfRef">Source Addresses for Reports</a>
          </h4>
<p id="section-5.2.14-1">An MLDv2 Report <span class="bcp14">MUST</span> be sent with a valid IPv6 link-local source
   address, or the unspecified address (::), if the sending interface
   has not acquired a valid link-local address yet.  Sending reports
   with the unspecified address is allowed to support the use of IP
   multicast in the Neighbor Discovery Protocol <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span>.  For
   stateless autoconfiguration, as defined in <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>, a node is
   required to join several IPv6 multicast groups, in order to perform
   Duplicate Address Detection (DAD).  Prior to DAD, the only address
   the reporting node has for the sending interface is a tentative one,
   which cannot be used for communication.  Thus, the unspecified
    address must be used.<a href="#section-5.2.14-1" class="pilcrow">¶</a></p>
<p id="section-5.2.14-2">On the other hand, routers <span class="bcp14">MUST</span> silently discard a message that is
   not sent with a valid link-local address, without taking any action
   on the contents of the packet.  Thus, a Report is discarded if the
   router cannot identify the source address of the packet as belonging
   to a link connected to the interface on which the packet was
   received.  A Report sent with the unspecified address is also
   discarded by the router.  This enhances security, as unidentified
   reporting nodes cannot influence the state of the MLDv2 router(s).
   Nevertheless, the reporting node has modified its listening state for
   multicast addresses that are contained in the Multicast Address
   Records of the Report message.  From now on, it will treat packets
   sent to those multicast addresses according to this new listening
   state.  Once a valid link-local address is available, a node <span class="bcp14">SHOULD</span>
   generate new MLDv2 Report messages for all multicast addresses joined
    on the interface.<a href="#section-5.2.14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dest_addr">
<section id="section-5.2.15">
          <h4 id="name-destination-addresses-for-r">
<a href="#section-5.2.15" class="section-number selfRef">5.2.15. </a><a href="#name-destination-addresses-for-r" class="section-name selfRef">Destination Addresses for Reports</a>
          </h4>
<p id="section-5.2.15-1">Version 2 Multicast Listener Reports are sent with an IP destination
   address of ff02::16, to which all MLDv2-capable multicast
   routers listen (see <a href="#iana" class="auto internal xref">Section 11</a> for IANA considerations related to
   this special destination address).  A node that operates in version 1
   compatibility mode (see details in <a href="#interop" class="auto internal xref">Section 8</a>) sends version 1 Reports
   to the multicast address specified in the Multicast Address field of
   the Report.  In addition, a node <span class="bcp14">MUST</span> accept and process any version
   1 Report whose IP Destination Address field contains any of the
   IPv6 addresses (unicast or multicast) assigned to the interface on
   which the Report arrives.  This might be useful, e.g., for debugging
   purposes.<a href="#section-5.2.15-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.2.16">
          <h4 id="name-multicast-listener-report-s">
<a href="#section-5.2.16" class="section-number selfRef">5.2.16. </a><a href="#name-multicast-listener-report-s" class="section-name selfRef">Multicast Listener Report Size</a>
          </h4>
<p id="section-5.2.16-1">If the set of Multicast Address Records required in a Report does not
   fit within the size limit of a single Report message (as determined
   by the MTU of the link on which it will be sent), the Multicast
   Address Records are sent in as many Report messages as needed to
    report the entire set.<a href="#section-5.2.16-1" class="pilcrow">¶</a></p>
<p id="section-5.2.16-2">If a single Multicast Address Record contains so many source
   addresses that it does not fit within the size limit of a single
   Report message, then:<a href="#section-5.2.16-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.16-3.1">
              <p id="section-5.2.16-3.1.1">if its Type is not IS_EX or TO_EX, it is split into multiple
      Multicast Address Records; each such record contains a different
    subset of the source addresses and is sent in a separate Report.<a href="#section-5.2.16-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.16-3.2">
              <p id="section-5.2.16-3.2.1">if its Type is IS_EX or TO_EX, a single Multicast Address Record
      is sent, with as many source addresses as can fit; the remaining
      source addresses are not reported.  Although the choice of which
      sources to report is arbitrary, it is preferable to report the
      same set of sources in each subsequent report, rather than
    reporting different sources each time.<a href="#section-5.2.16-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</section>
</section>
<div id="proto">
<section id="section-6">
      <h2 id="name-protocol-description-for-mu">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-protocol-description-for-mu" class="section-name selfRef">Protocol Description for Multicast Address Listeners</a>
      </h2>
<p id="section-6-1">MLD is an asymmetric protocol, as it specifies separate behaviors for
   Multicast Address Listeners -- that is, hosts or routers that listen
   to multicast packets -- and multicast routers.  This section
   describes the part of MLDv2 that applies to all Multicast Address
   Listeners.  (Note that a multicast router that is also a Multicast
   Address Listener performs both parts of MLDv2; it receives and it
   responds to its own MLD messages as well as to those of its
   neighbors.)  The multicast router part of MLDv2 is described in
   <a href="#mr_proto" class="auto internal xref">Section 7</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A node performs the protocol described in this section over all
   interfaces on which multicast reception is supported, even if more
   than one of those interfaces are connected to the same link.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">For interoperability with multicast routers that run the MLDv1
   protocol, nodes maintain a Host Compatibility Mode variable for each
   interface on which multicast reception is supported.  This section
   describes the behavior of Multicast Address Listener nodes on
   interfaces for which Host Compatibility Mode = MLDv2.  The algorithm
   for determining Host Compatibility Mode and the behavior if its
   value is set to MLDv1 are described in <a href="#interop" class="auto internal xref">Section 8</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The link-scope all-nodes multicast address, (ff02::1), is handled as
   a special case.  On all nodes -- that is, all hosts and routers
   including multicast routers -- listening to packets destined to the
   all-nodes multicast address, from all sources, is permanently enabled
   on all interfaces on which multicast listening is supported.
   No MLD messages are ever sent regarding neither the link-scope all-nodes
   multicast address, nor any multicast address of scope 0 (reserved) or
   1 (node-local). Multicast listeners <span class="bcp14">MUST</span> send MLD messages for all multicast
   addresses except for the link-scope all-nodes multicast address and any multicast
   addresses of scope less than 2.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">There are three types of events that trigger MLDv2 protocol actions
   on an interface:<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">
          <p id="section-6-6.1.1">a change of the per-interface listening state, caused by a local
    invocation of IPv6MulticastListen;<a href="#section-6-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.2">
          <p id="section-6-6.2.1">the firing of a specific timer; and<a href="#section-6-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.3">
          <p id="section-6-6.3.1">the reception of a Query.<a href="#section-6-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-7">(Received MLD messages of types other than Query are silently
   ignored, except as required for interoperation with nodes that
    implement MLDv1.)<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The following subsections describe the actions to be taken for each
   case.  Timer and counter names appear in square brackets.  Default
    values for those timers and counters are specified in <a href="#timers" class="auto internal xref">Section 9</a>.<a href="#section-6-8" class="pilcrow">¶</a></p>
<div id="chg_if_state">
<section id="section-6.1">
        <h3 id="name-action-on-change-of-per-int">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-action-on-change-of-per-int" class="section-name selfRef">Action on Change of Per-Interface State</a>
        </h3>
<p id="section-6.1-1">An invocation of IPv6MulticastListen may cause the Multicast Address Listening
 state of an interface to change, according to the rules in
   <a href="#if_state" class="auto internal xref">Section 4.2</a>.  Each such change affects the per-interface entry for a
   single multicast address.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A change of per-interface state causes the node to immediately
   transmit a State-Change Report from that interface.  The type and
   contents of the Multicast Address Record(s) in that Report are
   determined by comparing the filter-mode and source-list for the
   affected multicast address before and after the change, according to
   <a href="#rec-xmit-logic" class="auto internal xref">Table 1</a>.  If no per-interface state existed for that
   multicast address before the change (i.e., the change consisted of
   creating a new per-interface record), or if no state exists after the
   change (i.e., the change consisted of deleting a per-interface
   record), then the "non-existent" state is considered to have an
    INCLUDE filter-mode and an empty source-list.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-state-change-record-transmi"></span><div id="rec-xmit-logic">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-state-change-record-transmi" class="selfRef">State-Change Record Transmission Logic</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Old State</th>
              <th class="text-left" rowspan="1" colspan="1">New State</th>
              <th class="text-left" rowspan="1" colspan="1">State-Change Record Sent</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE (B)</td>
              <td class="text-left" rowspan="1" colspan="1">ALLOW (B-A), BLOCK (A-B)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE (A)</td>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE (B)</td>
              <td class="text-left" rowspan="1" colspan="1">ALLOW (A-B), BLOCK (B-A)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE (B)</td>
              <td class="text-left" rowspan="1" colspan="1">TO_EX (B)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE (A)</td>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE (B)</td>
              <td class="text-left" rowspan="1" colspan="1">TO_IN (B)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.1-4">If the computed source-list for either an ALLOW or a BLOCK State-Change 
    Record is empty, that record is omitted from the Report.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">To cover the possibility of the State-Change Report being missed by
   one or more multicast routers, [Robustness Variable] - 1
   retransmissions are scheduled, through a Retransmission Timer, at
   intervals chosen at random from the range (0, [Unsolicited Report
    Interval]).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">If more changes to the same per-interface state entry occur before
   all the retransmissions of the State-Change Report for the first
   change have been completed, each such additional change triggers the
    immediate transmission of a new State-Change Report.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">The contents of the new Report are calculated as follows:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-8.1">
            <p id="section-6.1-8.1.1">As for the first Report, the per-interface state for the affected
    multicast address before and after the latest change is compared.<a href="#section-6.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-8.2">
            <p id="section-6.1-8.2.1">The records that express the difference are built according to the
      table above.  Nevertheless, these records are not transmitted in a
      separate message, but they are instead merged with the contents of
      the pending report, to create the new State-Change Report.  The
    rules for calculating this merged report are described below.<a href="#section-6.1-8.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-9">The transmission of the merged State-Change Report terminates
   retransmissions of the earlier State-Change Reports for the same
   multicast address and becomes the first of [Robustness Variable]
   transmissions of the new State-Change Reports.  These transmissions
   are necessary in order to ensure that each instance of state change
    is transmitted at least [Robustness Variable] times.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">Each time a source is included in the difference report calculated
   above, retransmission state for that source needs to be maintained
   until [Robustness Variable] State-Change Reports have been sent by
   the node.  This is done in order to ensure that a series of
   successive state changes do not break the protocol robustness.
   Sources in retransmission state can be kept in a per-multicast-address
   Retransmission List, with a Source Retransmission Counter
   associated to each source in the list.  When a source is included in
   the list, its counter is set to [Robustness Variable].  Each time a
   State-Change Report is sent, the counter is decreased by one unit.
   When the counter reaches zero, the source is deleted from the
    Retransmission List for that multicast address.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<p id="section-6.1-11">If the per-interface listening change that triggers the new report is
   a filter-mode change, then the next [Robustness Variable] State-Change
   Reports will include a Filter-Mode-Change Record.  This
   applies even if any number of source-list changes occur in that
   period.  The node has to maintain retransmission state for the
   multicast address until the [Robustness Variable] State-Change
   Reports have been sent. This can be done through a per-multicast-address
   Filter Mode Retransmission Counter.  When the filter-mode
   changes, the counter is set to [Robustness Variable].  Each time a
   State-Change Report is sent the counter is decreased by one unit.
   When the counter reaches zero, i.e., [Robustness Variable] State-Change
   Reports with Filter-Mode-Change Records have been transmitted
   after the last filter-mode change, and if source-list changes have
   resulted in additional reports being scheduled, then the next State-Change
    Report will include Source-List-Change Records.<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<p id="section-6.1-12">Each time a per-interface listening state change triggers the
   immediate transmission of a new State-Change Report, its contents are
   determined as follows.  If the report should contain a Filter-Mode-Change
   Record, i.e., the Filter Mode Retransmission Counter for that
   multicast address has a value higher than zero, then, if the current
   filter-mode of the interface is INCLUDE, a TO_IN record is included
   in the report; otherwise, a TO_EX record is included.  If instead the
   report should contain Source-List-Change Records, i.e., the Filter
   Mode Retransmission Counter for that multicast address is zero, an
   ALLOW and a BLOCK record is included.  The contents of these records
    are built according <a href="#if-rep-info" class="auto internal xref">Table 2</a>.<a href="#section-6.1-12" class="pilcrow">¶</a></p>
<span id="name-per-interface-state-change-"></span><div id="if-rep-info">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-per-interface-state-change-" class="selfRef">Per-Interface State-Change Report Contents</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Record</th>
              <th class="text-left" rowspan="1" colspan="1">Sources Included</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TO_IN</td>
              <td class="text-left" rowspan="1" colspan="1">All in the current per-interface state that must be forwarded.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TO_EX</td>
              <td class="text-left" rowspan="1" colspan="1">All in the current per-interface state that must be blocked.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ALLOW</td>
              <td class="text-left" rowspan="1" colspan="1">All with retransmission state (i.e., all sources from the Retransmission List) that must be forwarded.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BLOCK</td>
              <td class="text-left" rowspan="1" colspan="1">All with retransmission state that must be blocked.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.1-14">If the computed source-list for either an ALLOW or a BLOCK record is
 empty, that record is omitted from the State-Change Report.<a href="#section-6.1-14" class="pilcrow">¶</a></p>
<aside id="section-6.1-15">
          <p id="section-6.1-15.1">Note:  When the first State-Change Report is sent, the non-existent
   pending report to merge with can be treated as a Source-Change Report
   with empty ALLOW and BLOCK records (no sources have retransmission
    state).<a href="#section-6.1-15.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-6.1-16">The building of a scheduled State-Change Report, triggered by the
   firing of a Retransmission Timer, instead of a per-interface
    listening state change, is described in <a href="#timer_act" class="auto internal xref">Section 6.3</a>.<a href="#section-6.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.2">
        <h3 id="name-action-on-reception-of-a-qu">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-action-on-reception-of-a-qu" class="section-name selfRef">Action on Reception of a Query</a>
        </h3>
<p id="section-6.2-1">Upon reception of an MLD message that contains a Query, the node
   checks if the source address of the message is a valid link-local
   address, if the Hop Limit is set to 1, and if the Router Alert option
   is present in the Hop-by-Hop Options header of the IPv6 packet.  If
    any of these checks fail, the packet is dropped.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">If the validity of the MLD message is verified, the node starts to
   process the Query.  Instead of responding immediately, the node
   delays its response by a random amount of time, bounded by the
   Maximum Response Delay value derived from the Maximum Response Code
   in the received Query Message.  A node may receive a variety of
   Queries on different interfaces and of different kinds (e.g., General
   Queries, Multicast Address Specific Queries, and Multicast Address
   and Source Specific Queries), each of which may require its own
    delayed response.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Before scheduling a response to a Query, the node must first consider
   previously scheduled pending responses and, in many cases, schedule a
   combined response.  Therefore, for each of its interfaces on which it
   operates the listener part of the MLDv2 protocol, the node must be
   able to maintain the following state:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-4.1">
            <p id="section-6.2-4.1.1">an Interface Timer for scheduling responses to General Queries;<a href="#section-6.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-4.2">
            <p id="section-6.2-4.2.1">a Multicast Address Timer for scheduling responses to Multicast
      Address (and Source) Specific Queries, for each multicast address
    the node has to report on; and<a href="#section-6.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-4.3">
            <p id="section-6.2-4.3.1">a per-multicast-address list of sources to be reported in response
    to a Multicast Address and Source Specific Query.<a href="#section-6.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-5">When a valid General Query arrives on an interface, the node
   checks whether it has any per-interface listening state record to
   report on, or not.  Similarly, when a valid Multicast Address
   (and Source) Specific Query arrives on an interface, the node checks
   whether it has a per-interface listening state record that
   corresponds to the queried multicast address (and source), or not. If
   it does, a delay for a response is randomly selected in the range (0,
   [Maximum Response Delay]), where Maximum Response Delay is derived
   from the Maximum Response Code inserted in the received Query
   Message.  The following rules are then used to determine if a Report
   needs to be scheduled or not and the type of Report to schedule.
   (The rules are considered in order and only the first matching rule
   is applied.)<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-6">
<li id="section-6.2-6.1">
            <p id="section-6.2-6.1.1">If there is a pending response to a previous General Query
      scheduled sooner than the selected delay, no additional response
    needs to be scheduled.<a href="#section-6.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-6.2">
            <p id="section-6.2-6.2.1">If the received Query is a General Query, the Interface Timer is
      used to schedule a response to the General Query after the
      selected delay.  Any previously pending response to a General
    Query is canceled.<a href="#section-6.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-6.3">
            <p id="section-6.2-6.3.1">If the received Query is a Multicast Address Specific Query or a
      Multicast Address and Source Specific Query and there is no
      pending response to a previous Query for this multicast address,
      then the Multicast Address Timer is used to schedule a report.  If
      the received Query is a Multicast Address and Source Specific
      Query, the list of queried sources is recorded for use when
    generating a response.<a href="#section-6.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-6.4">
            <p id="section-6.2-6.4.1">If there is already a pending response to a previous Query
      scheduled for this multicast address, and either the new Query is
      a Multicast Address Specific Query or the recorded source-list
      associated with the multicast address is empty, then the multicast
      address source-list is cleared and a single response is scheduled,
      using the Multicast Address Timer.  The new response is scheduled
      to be sent at the earliest of the remaining time for the pending
    report and the selected delay.<a href="#section-6.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-6.5">
            <p id="section-6.2-6.5.1">If the received Query is a Multicast Address and Source Specific
      Query and there is a pending response for this multicast address
      with a non-empty source-list, then the multicast address source-list
      is augmented to contain the list of sources in the new Query,
      and a single response is scheduled using the Multicast Address
      Timer.  The new response is scheduled to be sent at the earliest
      of the remaining time for the pending report and the selected
    delay.<a href="#section-6.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
<div id="timer_act">
<section id="section-6.3">
        <h3 id="name-action-on-timer-expiration">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-action-on-timer-expiration" class="section-name selfRef">Action on Timer Expiration</a>
        </h3>
<p id="section-6.3-1">There are several timers that, upon expiration, trigger protocol
   actions on an MLDv2 Multicast Address Listener node.  All these
   actions are related to pending reports scheduled by the node.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-2">
<li id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">If the expired timer is the Interface Timer (i.e., there is a
            pending response to a General Query), then one Current-State
            Record is sent for each multicast address for which the specified
            interface has listening state, as described in <a href="#if_state" class="auto internal xref">Section 4.2</a>.  The Current-State Record
            carries the multicast address and its associated filter-mode
            (MODE_IS_INCLUDE or MODE_IS_EXCLUDE) and source-list.  Multiple
            Current-State Records are packed into individual Report messages,
            to the extent possible.<a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.3-2.1.2">This naive algorithm may result in bursts of packets when a
            node listens to a large number of multicast addresses.  Instead of
            using a single Interface Timer, implementations are recommended to
            spread transmission of such Report messages over the interval (0,
            [Maximum Response Delay]).  Note that any such implementation
            <span class="bcp14">MUST</span> avoid the "ack-implosion" problem, i.e.,
            <span class="bcp14">MUST NOT</span> send a Report immediately upon reception
            of a General Query.<a href="#section-6.3-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">If the expired timer is a Multicast Address Timer and the list
            of recorded sources for that multicast address is empty (i.e.,
            there is a pending response to a Multicast Address Specific
            Query), then if, and only if, the interface has listening state
            for that multicast address, a single Current-State Record is sent
            for that address.  The Current-State Record carries the multicast
            address and its associated filter-mode (MODE_IS_INCLUDE or
            MODE_IS_EXCLUDE) and source-list, if any.<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.3">
            <p id="section-6.3-2.3.1">If the expired timer is a Multicast Address Timer and the list
            of recorded sources for that multicast address is non-empty (i.e.,
            there is a pending response to a Multicast Address and Source
            Specific Query), then if, and only if, the interface has listening
            state for that multicast address, the contents of the
            corresponding Current-State Record are determined from the per-
            interface state and the pending response record, as specified in
            <a href="#csr-info" class="auto internal xref">Table 3</a>.<a href="#section-6.3-2.3.1" class="pilcrow">¶</a></p>
<span id="name-determining-contents-of-cur"></span><div id="csr-info">
<table class="left" id="table-3">
              <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-determining-contents-of-cur" class="selfRef">Determining Contents of Current-State Record</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Per-Interface State</th>
                  <th class="text-left" rowspan="1" colspan="1">Set of Sources in the Pending Response Record</th>
                  <th class="text-left" rowspan="1" colspan="1">Current-State Record</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                  <td class="text-left" rowspan="1" colspan="1">B</td>
                  <td class="text-left" rowspan="1" colspan="1">IS_IN (A*B)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">EXCLUDE (A)</td>
                  <td class="text-left" rowspan="1" colspan="1">B</td>
                  <td class="text-left" rowspan="1" colspan="1">IS_IN (B-A)</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-6.3-2.3.3">If the resulting Current-State Record has an empty set of
          source addresses, then no response is sent.  After the required
          Report messages have been generated, the source-lists associated
          with any reported multicast addresses are cleared.<a href="#section-6.3-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.4">
            <p id="section-6.3-2.4.1">If the expired timer is a Retransmission Timer for a multicast
            address (i.e., there is a pending State-Change Report for that
            multicast address), the contents of the report are determined as
            follows.  If the report should contain a Filter-Mode-Change
            Record, i.e., the Filter Mode Retransmission Counter for that
            multicast address has a value higher than zero, then, if the
            current filter-mode of the interface is INCLUDE, a TO_IN record is
            included in the report; otherwise a TO_EX record is included.  In
            both cases, the Filter Mode Retransmission Counter for that
            multicast address is decremented by one unit after the
            transmission of the report.<a href="#section-6.3-2.4.1" class="pilcrow">¶</a></p>
<p id="section-6.3-2.4.2">If instead the report should contain Source-List-Change
            Records, i.e., the Filter Mode Retransmission Counter for that
            multicast address is zero, an ALLOW and a BLOCK record is
            included.  The contents of these records are built according to
            <a href="#slcr-info" class="auto internal xref">Table 4</a>.<a href="#section-6.3-2.4.2" class="pilcrow">¶</a></p>
<span id="name-determining-contents-of-sou"></span><div id="slcr-info">
<table class="left" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-determining-contents-of-sou" class="selfRef">Determining Contents of Source-List-Change Records</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Record</th>
                  <th class="text-left" rowspan="1" colspan="1">Sources Included</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">TO_IN</td>
                  <td class="text-left" rowspan="1" colspan="1">All in the current per-interface state that must be forwarded.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">TO_EX</td>
                  <td class="text-left" rowspan="1" colspan="1">All in the current per-interface state that must be blocked.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">ALLOW</td>
                  <td class="text-left" rowspan="1" colspan="1">All with retransmission state (i.e., all sources from the
       Retransmission List) that must be forwarded.  For each included source,
       its Source Retransmission Counter is decreased with one unit after the
       transmission of the report.  If the counter reaches zero, the source is
     deleted from the Retransmission List for that multicast address.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">BLOCK</td>
                  <td class="text-left" rowspan="1" colspan="1">All with retransmission state (i.e., all sources from the
       Retransmission List) that must be blocked.  For each included source,
       its Source Retransmission Counter is decreased with one unit after the
       transmission of the report.  If the counter reaches zero, the source is
     deleted from the Retransmission List for that multicast address.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-6.3-2.4.4">If the computed source-list for either an ALLOW or a BLOCK record
      is empty, that record is omitted from the State-Change Report.<a href="#section-6.3-2.4.4" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="mr_proto">
<section id="section-7">
      <h2 id="name-description-of-the-protocol">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-description-of-the-protocol" class="section-name selfRef">Description of the Protocol for Multicast Routers</a>
      </h2>
<p id="section-7-1">The purpose of MLD is to enable each multicast router to learn, for
   each of its directly attached links, which multicast addresses have
   listeners on that link.  MLD version 2 adds the capability for a
   multicast router to also learn which sources have listeners among
   the neighboring nodes, for packets sent to any particular multicast
   address.  The information gathered by MLD is provided to whichever
   multicast routing protocol is used by the router, in order to ensure
   that multicast packets are delivered to all links where there are
    interested listeners.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This section describes the part of MLDv2 that is performed by
   multicast routers.  Multicast routers may themselves become Multicast
   Address Listeners and therefore also perform the multicast listener
    part of MLDv2, as described in <a href="#proto" class="auto internal xref">Section 6</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">A multicast router performs the protocol described in this section
   over each of its directly attached links.  If a multicast router has
   more than one interface to the same link, it only needs to operate
    this protocol over one of those interfaces.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">For each interface over which the router operates the MLD protocol,
   the router must configure that interface to listen to all link-layer
   multicast addresses that can be generated by IPv6 multicasts.  For
   example, an Ethernet-attached router must set its Ethernet address
   reception filter to accept all Ethernet multicast addresses that
    start with the hexadecimal value 3333 <span>[<a href="#RFC2464" class="cite xref">RFC2464</a>]</span>; in the case of an
   Ethernet interface that does not support the filtering of such a
   multicast address range, it must be configured to accept ALL Ethernet
    multicast addresses, in order to meet the requirements of MLD.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">On each interface over which this protocol is being run, the router
   <span class="bcp14">MUST</span> enable reception of the link-scope "all MLDv2-capable routers"
   multicast address from all sources and <span class="bcp14">MUST</span> perform the Multicast
    Address Listener part of MLDv2 for that address on that interface.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">Multicast routers only need to know that at least one node on an
   attached link listens to packets for a particular multicast address
   from a particular source; a multicast router is not required to
   individually keep track of the interests of each neighboring node.
    (Nevertheless, see <a href="#host_suppress" class="auto internal xref">Appendix A.2</a>, item 1 for discussion.)<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">MLDv2 is backward compatible with the MLDv1 protocol.  For a detailed
    description of compatibility issues, see <a href="#interop" class="auto internal xref">Section 8</a>.<a href="#section-7-7" class="pilcrow">¶</a></p>
<div id="mld_qrys">
<section id="section-7.1">
        <h3 id="name-conditions-for-mld-queries">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-conditions-for-mld-queries" class="section-name selfRef">Conditions for MLD Queries</a>
        </h3>
<p id="section-7.1-1">The behavior of a router that implements the MLDv2 protocol depends
   on whether there are several multicast routers on the same subnet, or
   not.  If it is the case, a querier election mechanism (described in
    <a href="#elect" class="auto internal xref">Section 7.6.2</a>) is used to elect a single multicast router to be in
   Querier state.  All the multicast routers on the subnet listen to the
   messages sent by Multicast Address Listeners, and maintain the same
   multicast listening information state, so that they can quickly and
   correctly take over the querier functionality, should the present
   Querier fail.  Nevertheless, it is only the Querier that sends
    periodical or triggered Query Messages on the subnet.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The Querier periodically sends General Queries to request Multicast
   Address Listener information from an attached link.  These queries
   are used to build and refresh the Multicast Address Listening state of
    routers on attached links.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Nodes respond to these queries by reporting their Multicast Address
   Listening state (and set of sources they listen to) with Current
    State Multicast Address Records in MLD Version 2 Multicast Listener Reports.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">As a listener of a multicast address, a node may express interest in
   listening or not listening to traffic from particular sources.  As
   the desired listening state of a node changes, it reports these
   changes using Filter-Mode-Change Records or Source-List-Change
   Records.  These records indicate an explicit state change in a
   multicast address at a node in either the Multicast Address Record's
   source-list or its filter-mode.  When Multicast Address Listening is
   terminated at a node or traffic from a particular source is no longer
   desired, the Querier must query for other listeners of the multicast
   address or of the source before deleting the multicast address (or
   source) from its Multicast Address Listening state and pruning its
    traffic.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">To enable all nodes on a link to respond to changes in multicast
   address listening, the Querier sends specific queries.  A Multicast
   Address Specific Query is sent to verify that there are no nodes that
   listen to the specified multicast address or to "rebuild" the
   listening state for a particular multicast address.  Multicast
   Address Specific Queries are sent when the Querier receives a State-Change 
   Record indicating that a node ceases to listen to a multicast
   address.  They are also sent in order to enable a fast transition of
   a router from EXCLUDE to INCLUDE mode, in case a received State-Change 
    Record motivates this action.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">A Multicast Address and Source Specific Query is used to verify that
   there are no nodes on a link that listen to traffic from a specific
   set of sources.  Multicast Address and Source Specific Queries list
   sources for a particular multicast address that have been requested
   to no longer be forwarded.  This query is sent by the Querier in
   order to learn if any node listens to packets sent to the specified
   multicast address, from the specified source addresses.  Multicast
   Address and Source Specific Queries are only sent in response to
   State-Change Records and never in response to Current-State Records.
    <a href="#qry_vars" class="auto internal xref">Section 5.1.13</a> describes each query in more detail.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.2">
        <h3 id="name-mld-state-maintained-by-mul">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mld-state-maintained-by-mul" class="section-name selfRef">MLD State Maintained by Multicast Routers</a>
        </h3>
<p id="section-7.2-1">Multicast routers that implement the MLDv2 protocol keep state per
   multicast address per attached link.  This multicast address state
   consists of a filter-mode, a list of sources, and various timers. For
   each attached link on which MLD runs, a multicast router records the
   listening state for that link.  That state conceptually consists of a
    set of records of the form:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-7.2-2">
<pre>
      (IPv6 multicast address, Filter Timer,
       Router Filter Mode, (source records) )</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.2-3">Each source record is of the form:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-7.2-4">
<pre>
      (IPv6 source address, source timer)</pre><a href="#section-7.2-4" class="pilcrow">¶</a>
</div>
<p id="section-7.2-5">If all sources for a multicast address are listened to, an empty
   source record list is kept with the Router Filter Mode set to
   EXCLUDE.  This means that nodes on this link want all sources for
   this multicast address to be forwarded.  This is the MLDv2 equivalent
    of an MLDv1 listening state.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<div id="def-router-filter-mode">
<section id="section-7.2.1">
          <h4 id="name-definition-of-router-filter">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-definition-of-router-filter" class="section-name selfRef">Definition of Router Filter Mode</a>
          </h4>
<p id="section-7.2.1-1">To reduce internal state, MLDv2 routers keep a filter-mode per
   multicast address per attached link.  This filter-mode is used to
   summarize the total listening state of a multicast address to a
   minimum set such that all nodes' listening states are respected.  The
   filter-mode may change in response to the reception of particular
   types of Multicast Address Records or when certain timer conditions
   occur.  In the following sections, we use the term "Router Filter
   Mode" to refer to the filter-mode of a particular multicast address
    within a router.  <a href="#rcv_rpt" class="auto internal xref">Section 7.4</a> describes the changes of the Router
    Filter Mode per Multicast Address Record received.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">A router is in INCLUDE mode for a specific multicast address on a
   given interface if all the listeners on the link interested in that
   address are in INCLUDE mode.  The router state is represented through
   the notation INCLUDE (A), where A is called the "Include List".  The
   Include List is the set of sources that one or more listeners on the
   link have requested to receive.  All the sources from the Include
   List will be forwarded by the router.  Any other source that is not
    in the Include List will be blocked by the router.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">A router is in EXCLUDE mode for a specific multicast address on a
   given interface if there is at least one listener in EXCLUDE mode
   interested in that address on the link.  Conceptually, when a
   Multicast Address Record is received, the Router Filter Mode for that
   multicast address is updated to cover all the requested sources using
   the least amount of state.  As a rule, once a Multicast Address
   Record with a filter-mode of EXCLUDE is received, the Router Filter
   Mode for that multicast address will be set to EXCLUDE. Nevertheless,
   if all nodes with a Multicast Address Record having filter-mode set
   to EXCLUDE cease reporting, it is desirable for the Router Filter
   Mode for that multicast address to transition back to INCLUDE mode.
   This transition occurs when the Filter Timer expires; see <a href="#rtr_mode" class="auto internal xref">Section 7.5</a> for more details.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">When the router is in EXCLUDE mode, the router state is represented
   through the notation EXCLUDE (X,Y), where X is called the "Requested
   List" and Y is called the "Exclude List".  All sources, except those
   from the Exclude List, will be forwarded by the router.  The
   Requested List has no effect on forwarding.  Nevertheless, it has to
    be maintained for several reasons, as explained in <a href="#src_timers" class="auto internal xref">Section 7.2.3</a>.<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
<p id="section-7.2.1-5">The exact handling of both the INCLUDE and EXCLUDE mode router state,
   according to the received reports, is presented in detail in Sections 
   <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>.<a href="#section-7.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.2.2">
          <h4 id="name-definition-of-filter-timers">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-definition-of-filter-timers" class="section-name selfRef">Definition of Filter Timers</a>
          </h4>
<p id="section-7.2.2-1">The Filter Timer is only used when the router is in EXCLUDE mode for
   a specific multicast address, and it represents the time for the
   Router Filter Mode of the multicast address to expire and switch to
   INCLUDE mode.  A Filter Timer is a decrementing timer with a lower
   bound of zero.  One Filter Timer exists per Multicast Address Record.
   Filter timers are updated according to the types of Multicast Address
   Records received.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">If a Filter Timer expires, with the Router Filter Mode for that
   multicast address being EXCLUDE, it means that there are no more
   listeners in EXCLUDE mode on the attached link.  At this point, the
   router transitions to INCLUDE filter-mode.  <a href="#rtr_mode" class="auto internal xref">Section 7.5</a> describes the
   actions taken when a Filter Timer expires while in EXCLUDE mode.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3" class="keepWithNext"><a href="#FTM" class="auto internal xref">Table 5</a> summarizes the role of the Filter Timer. 
   <a href="#rcv_rpt" class="auto internal xref">Section 7.4</a> describes the details of setting the Filter Timer per type of
    Multicast Address Record received.<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<span id="name-filter-timer-management"></span><div id="FTM">
<table class="left" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-filter-timer-management" class="selfRef">Filter Timer Management</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Router Filter Mode</th>
                <th class="text-left" rowspan="1" colspan="1">Filter Timer Value</th>
                <th class="text-left" rowspan="1" colspan="1">Actions/Comments</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE</td>
                <td class="text-left" rowspan="1" colspan="1">Not Used</td>
                <td class="text-left" rowspan="1" colspan="1">All listeners in INCLUDE mode.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE</td>
                <td class="text-left" rowspan="1" colspan="1">Timer &gt; 0</td>
                <td class="text-left" rowspan="1" colspan="1">At least one listener in EXCLUDE mode.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE</td>
                <td class="text-left" rowspan="1" colspan="1">Timer == 0</td>
                <td class="text-left" rowspan="1" colspan="1">No more listeners in EXCLUDE mode for
    the multicast address.  If the Requested List is empty, delete
    Multicast Address Record.  If not, switch to INCLUDE filter-mode;
    the sources in the Requested List are moved to the Include List,
    and the Exclude List is deleted.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<div id="src_timers">
<section id="section-7.2.3">
          <h4 id="name-definition-of-source-timers">
<a href="#section-7.2.3" class="section-number selfRef">7.2.3. </a><a href="#name-definition-of-source-timers" class="section-name selfRef">Definition of Source Timers</a>
          </h4>
<p id="section-7.2.3-1">A Source Timer is a decrementing timer with a lower bound of zero.
   One Source Timer is kept per source record.  Source timers are
   updated according to the type and filter-mode of the Multicast
    Address Record received.  <a href="#rcv_rpt" class="auto internal xref">Section 7.4</a> describes the setting of source
    timers per type of Multicast Address Records received.<a href="#section-7.2.3-1" class="pilcrow">¶</a></p>
<p id="section-7.2.3-2">In the following, abbreviations are used for several variables (all
    of which are described in detail in <a href="#timers" class="auto internal xref">Section 9</a>).  The variable MALI
   stands for the Multicast Address Listening Interval, which is the
   time in which multicast address listening state will time out.  The
   variable LLQT is the Last Listener Query Time, which is the total
   time the router should wait for a report, after the Querier has sent
   the first query.  During this time, the Querier should send [Last
   Member Query Count]-1 retransmissions of the query.  LLQT represents
   the leave latency or the difference between the transmission of a
   listener state change and the modification of the information passed
    to the routing protocol.<a href="#section-7.2.3-2" class="pilcrow">¶</a></p>
<p id="section-7.2.3-3">If the router is in INCLUDE filter-mode, a source can be added to the
   current Include List if a listener in INCLUDE mode sends a Current-State
   or a State-Change Report that includes that source.  Each
   source from the Include List is associated with a Source Timer that
   is updated whenever a listener in INCLUDE mode sends a report that
   confirms its interest in that specific source.  If the timer of a
   source from the Include List expires, the source is deleted from the
   Include List.  If there are no more source records left, the
    Multicast Address Record is deleted from the router.<a href="#section-7.2.3-3" class="pilcrow">¶</a></p>
<p id="section-7.2.3-4">Besides this "soft leave" mechanism, there is also a "fast leave"
   scheme in MLDv2; it is also based on the use of source timers.  When
   a node in INCLUDE mode expresses its desire to stop listening to a
   specific source, all the multicast routers on the link lower their
   timer for that source to a small interval of LLQT milliseconds.  The
   Querier then sends then a Multicast Address and Source Specific
   Query, to verify whether there are other listeners for that source on
   the link, or not.  If a corresponding report is received before the
   timer expires, all the multicast routers on the link update their
   source timer.  If not, the source is deleted from the Include List.
   The handling of the Include List, according to the received reports,
    is detailed in Sections <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>.<a href="#section-7.2.3-4" class="pilcrow">¶</a></p>
<p id="section-7.2.3-5">Source timers are treated differently when the Router Filter Mode for
   a multicast address is EXCLUDE.  For sources from the Requested List,
   the source timers have running values; these sources are forwarded by
   the router.  For sources from the Exclude List, the source timers are
   set to zero; these sources are blocked by the router.  If the timer
   of a source from the Requested List expires, the source is moved to
   the Exclude List.  Then, the router informs the routing protocol that
   there is no longer a listener on the link interested in traffic from
    this source.<a href="#section-7.2.3-5" class="pilcrow">¶</a></p>
<p id="section-7.2.3-6">The router has to maintain the Requested List for two reasons:<a href="#section-7.2.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2.3-7">
            <li id="section-7.2.3-7.1">
              <p id="section-7.2.3-7.1.1">To keep track of sources that listeners in INCLUDE mode
              listen to.  This is necessary in order to assure a seamless
              transition of the router to INCLUDE mode, when there will be no
              listener in EXCLUDE mode left.  This transition should not
              interrupt the flow of traffic to the listeners in INCLUDE mode
              still interested in that multicast address.  Therefore, at the
              moment of the transition, the Requested List should represent
              the set of sources that nodes in INCLUDE mode have explicitly
              requested.<a href="#section-7.2.3-7.1.1" class="pilcrow">¶</a></p>
<p id="section-7.2.3-7.1.2">When the router switches to INCLUDE mode, the sources in the
              Requested List are moved to the Include List, and the Exclude
              List is deleted.  Before the switch, the Requested List can
              contain an inexact guess at the sources that listeners in
              INCLUDE mode listen to, which might be too large or too small.  These
              inexactitudes are due to the fact that the Requested List is
              also used for fast blocking purposes, as described below.  If
              such a fast blocking is required, some sources may be deleted
              from the Requested List (as shown in Sections <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>) in order to reduce router
              state.  Nevertheless, in each such case the Filter Timer is
              updated as well.  Therefore, listeners in INCLUDE mode will have
              enough time, before an eventual switching, to reconfirm their
              interest in the eliminated source(s), and rebuild the Requested
              List accordingly.  The protocol ensures that when a switch to
              INCLUDE mode occurs, the Requested List will be accurate.
              Details about the transition of the router to INCLUDE mode are
              presented in <a href="#mode_switch" class="auto internal xref">Appendix A.3</a>.<a href="#section-7.2.3-7.1.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-7.2.3-7.2">
              <p id="section-7.2.3-7.2.1">To allow a fast blocking of previously unblocked sources.  If
              the router receives a report that contains such a request, the
              concerned sources are added to the Requested List.  Their timers
              are set to a small interval of LLQT milliseconds, and a
              Multicast Address and Source Specific Query is sent by the
              Querier, to check whether there are nodes on the link still
              interested in those sources, or not.  If no node confirms its
              interest in receiving a specific source, the timer of that
              source expires.  Then, the source is moved from the Requested
              List to the Exclude List.  From then on, the source will be
              blocked by the router.<a href="#section-7.2.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-7.2.3-8">The handling of the EXCLUDE mode router state, according to the
          received reports, is detailed in Sections <a href="#curr_state_recs" class="auto internal xref">7.4.1</a> and <a href="#fm_chg" class="auto internal xref">7.4.2</a>.<a href="#section-7.2.3-8" class="pilcrow">¶</a></p>
<p id="section-7.2.3-9">When the Router Filter Mode for a multicast address is EXCLUDE,
          source records are only deleted when the Filter Timer expires or
          when newly received Multicast Address Records modify the source
          record list of the router.<a href="#section-7.2.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-7.3">
        <h3 id="name-mldv2-source-specific-forwa">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-mldv2-source-specific-forwa" class="section-name selfRef">MLDv2 Source-Specific Forwarding Rules</a>
        </h3>
<p id="section-7.3-1">When a multicast router receives a datagram from a source destined to
   a particular multicast address, a decision has to be made whether to
   forward the datagram on an attached link or not.  The multicast
   routing protocol in use is in charge of this decision and should use
   the MLDv2 information to ensure that all sources/multicast addresses
   that have listeners on a link are forwarded to that link.  MLDv2
   information does not override multicast routing information; for
   example, if the MLDv2 filter-mode for a multicast address is EXCLUDE,
   a router may still forward packets for excluded sources to a transit
    link.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">To summarize, <a href="#MLDv2_forwarding_suggestions" class="auto internal xref">Table 6</a> below describes the forwarding
   suggestions made by MLDv2 to the routing protocol for traffic
   originating from a source destined to a multicast address.  It also
   summarizes the actions taken upon the expiration of a Source Timer
 based on the Router Filter Mode of the multicast address.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<span id="name-mld-forwarding-recommendati"></span><div id="MLDv2_forwarding_suggestions">
<table class="left" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-mld-forwarding-recommendati" class="selfRef">MLD Forwarding Recommendations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Router Filter Mode</th>
              <th class="text-left" rowspan="1" colspan="1">Source Timer Value</th>
              <th class="text-left" rowspan="1" colspan="1">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">TIMER &gt; 0</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to forward traffic from source.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">TIMER == 0</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to stop forwarding traffic from
    source and remove the source record.  If there are no more source records,
    delete the Multicast Address Record.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">INCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">No Source Element</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to not forward traffic from source.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">TIMER &gt; 0</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to forward traffic from source.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">TIMER == 0</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to not forward traffic from source.
    Move the source from the Requested List to the Exclude List (DO NOT remove the source record).</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">EXCLUDE</td>
              <td class="text-left" rowspan="1" colspan="1">No Source Element</td>
              <td class="text-left" rowspan="1" colspan="1">Suggest to forward traffic from all sources.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<div id="rcv_rpt">
<section id="section-7.4">
        <h3 id="name-action-on-reception-of-repo">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-action-on-reception-of-repo" class="section-name selfRef">Action on Reception of Reports</a>
        </h3>
<p id="section-7.4-1">Upon reception of an MLD message that contains a Report, the router
   checks if the source address of the message is a valid link-local
   address, if the Hop Limit is set to 1, and if the Router Alert option
   is present in the Hop-by-Hop Options header of the IPv6 packet.  If
   any of these checks fail, the packet is dropped.  If the validity of
   the MLD message is verified, the router starts to process the Report.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">SSM-aware routers <span class="bcp14">SHOULD</span> ignore records that contain multicast addresses
   in the SSM address range if the record type is MODE_IS_EXCLUDE or
   CHANGE_TO_EXCLUDE_MODE. SSM-aware routers <span class="bcp14">SHOULD</span> ignore MLDv1 Report and DONE
   messages that
   contain multicast addresses in the SSM address range, <span class="bcp14">SHOULD NOT</span> use
   such Reports to establish IP forwarding state, and <span class="bcp14">MAY</span> log an error if it
   receives such a message.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<div id="curr_state_recs">
<section id="section-7.4.1">
          <h4 id="name-reception-of-current-state-">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-reception-of-current-state-" class="section-name selfRef">Reception of Current-State Records</a>
          </h4>
<p id="section-7.4.1-1">When receiving Current-State Records, a router updates both its
   Filter Timer and its source timers.  In some circumstances, the
   reception of a type of Multicast Address Record will cause the Router
   Filter Mode for that multicast address to change.  <a href="#rcvd-csr" class="auto internal xref">Table 7</a>
   describes the actions, with respect to state and timers, that occur
   to a router's state upon reception of Current-State Records.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<p id="section-7.4.1-2">If the router is in INCLUDE filter-mode for a multicast address, we
   will use the notation INCLUDE (A), where A denotes the associated
   Include List.  If the router is in EXCLUDE filter-mode for a
   multicast address, we will use the notation EXCLUDE (X,Y), where X
   and Y denote the associated Requested List and Exclude List,
   respectively.<a href="#section-7.4.1-2" class="pilcrow">¶</a></p>
<p id="section-7.4.1-3">Within the "Actions" section of the router state tables, we use the
   notation '(A)=J', which means that set A of the source records should
   have their source timers set to value J.  'Delete (A)' means that 
   set A of the source records should be deleted.  'Filter Timer = J' means
   that the Filter Timer for the multicast address should be set to
   value J.<a href="#section-7.4.1-3" class="pilcrow">¶</a></p>
<span id="name-actions-for-received-curren"></span><div id="rcvd-csr">
<table class="left" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-actions-for-received-curren" class="selfRef">Actions for Received Current-State Records</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Router State</th>
                <th class="text-left" rowspan="1" colspan="1">Report Received</th>
                <th class="text-left" rowspan="1" colspan="1">New Router State</th>
                <th class="text-left" rowspan="1" colspan="1">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">IS_IN (B)</td>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A+B)</td>
                <td class="text-left" rowspan="1" colspan="1">(B)=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">IS_EX (B)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (A*B, B-A)</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <ul class="normal text-left ulBare ulEmpty">
<li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.2.4.1.1">(B-A)=0<a href="#section-7.4.1-4.2.2.4.1.1" class="pilcrow">¶</a>
</li>
                    <li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.2.4.1.2">Delete (A-B)<a href="#section-7.4.1-4.2.2.4.1.2" class="pilcrow">¶</a>
</li>
                    <li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.2.4.1.3">Filter Timer=MALI<a href="#section-7.4.1-4.2.2.4.1.3" class="pilcrow">¶</a>
</li>
                  </ul>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">IS_IN (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X+A, Y-A)</td>
                <td class="text-left" rowspan="1" colspan="1">(A)=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">IS_EX (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (A-Y, Y*A)</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <ul class="normal text-left ulBare ulEmpty">
<li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.4.4.1.1">(A-X-Y)=MALI<a href="#section-7.4.1-4.2.4.4.1.1" class="pilcrow">¶</a>
</li>
                    <li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.4.4.1.2">Delete (X-A)<a href="#section-7.4.1-4.2.4.4.1.2" class="pilcrow">¶</a>
</li>
                    <li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.4.4.1.3">Delete (Y-A)<a href="#section-7.4.1-4.2.4.4.1.3" class="pilcrow">¶</a>
</li>
                    <li class="normal text-left ulBare ulEmpty" id="section-7.4.1-4.2.4.4.1.4">Filter Timer=MALI<a href="#section-7.4.1-4.2.4.4.1.4" class="pilcrow">¶</a>
</li>
                  </ul>
</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="fm_chg">
<section id="section-7.4.2">
          <h4 id="name-reception-of-filter-mode-ch">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-reception-of-filter-mode-ch" class="section-name selfRef">Reception of Filter-Mode-Change and Source-List-Change Records</a>
          </h4>
<p id="section-7.4.2-1">When a change in the global state of a multicast address occurs in a
   node, the node sends either a Source-List-Change Record or a Filter
   Mode Change Record for that multicast address.  As with Current-State
   Records, routers must act upon these records and possibly change
    their own state to reflect the new listening state of the link.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<p id="section-7.4.2-2">The Querier must query sources or multicast addresses that are
   requested to be no longer forwarded.  When a router queries or
   receives a query for a specific set of sources, it lowers its source
   timers for those sources to a small interval of Last Listener Query
   Time milliseconds.  If Multicast Address Records are received in
   response to the queries that express interest in listening to the
    queried sources, the corresponding timers are updated.<a href="#section-7.4.2-2" class="pilcrow">¶</a></p>
<p id="section-7.4.2-3">Multicast Address Specific queries can also be used in order to
   enable a fast transition of a router from EXCLUDE to INCLUDE mode, in
   case a received Multicast Address Record motivates this action.  The
   Filter Timer for that multicast address is lowered to a small
   interval of Last Listener Query Time milliseconds.  If any Multicast
   Address Records that express EXCLUDE mode interest in the multicast
   address are received within this interval, the Filter Timer is
   updated and the suggestion to the routing protocol to forward the
   multicast address stands without any interruption.  If not, the
    router will switch to INCLUDE filter-mode for that multicast address.<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
<p id="section-7.4.2-4">During the query period (i.e., Last Listener Query Time milliseconds),
   the MLD component in the router continues to suggest to the routing
   protocol to forward traffic from the multicast addresses or sources
   that are queried.
   It is not until after Last Listener Query Time
   milliseconds, and without receiving a record that expresses interest in
   the queried multicast address or sources, that the router may prune
    the multicast address or sources from the link.<a href="#section-7.4.2-4" class="pilcrow">¶</a></p>
<p id="section-7.4.2-5"><a href="#mr-state-trans" class="auto internal xref">Table 8</a> describes the changes in multicast address state
   and the action(s) taken when receiving either Filter-Mode-Change or
   Source-List-Change Records.  <a href="#mr-state-trans" class="auto internal xref">Table 8</a> also describes the queries
    that are sent by the Querier when a particular report is received.<a href="#section-7.4.2-5" class="pilcrow">¶</a></p>
<p id="section-7.4.2-6">We use the following notation to describe the queries that are
   sent.  We use the notation 'Q(MA)' to describe a Multicast Address
   Specific Query to the MA multicast address.  We use the notation
   'Q(MA,A)' to describe a Multicast Address and Source Specific Query
   to the MA multicast address with source-list A.  If source-list A is
   null as a result of the action (e.g. A*B), then no query is sent as a
    result of the operation.<a href="#section-7.4.2-6" class="pilcrow">¶</a></p>
<p id="section-7.4.2-7">In order to maintain protocol robustness, queries defined in the
   Actions column of <a href="#mr-state-trans" class="auto internal xref">Table 8</a> need to be transmitted [Last
   Listener Query Count] times, once every [Last Listener Query
    Interval] period.<a href="#section-7.4.2-7" class="pilcrow">¶</a></p>
<p id="section-7.4.2-8">If while scheduling new queries there are already pending queries to
   be retransmitted for the same multicast address, the new and pending
   queries have to be merged.  In addition, received host reports for a
   multicast address with pending queries may affect the contents of
    those queries.  <a href="#spec_qry" class="auto internal xref">Section 7.6.3</a> describes the process of building and
    maintaining the state of pending queries.<a href="#section-7.4.2-8" class="pilcrow">¶</a></p>
<span id="name-multicast-router-state-tran"></span><div id="mr-state-trans">
<table class="left" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-multicast-router-state-tran" class="selfRef">Multicast Router State Transitions</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Router State</th>
                <th class="text-left" rowspan="1" colspan="1">Report Received</th>
                <th class="text-left" rowspan="1" colspan="1">New Router State</th>
                <th class="text-left" rowspan="1" colspan="1">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">ALLOW (B)</td>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE(A+B)</td>
                <td class="text-left" rowspan="1" colspan="1">(B)=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">BLOCK (B)</td>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE(A)</td>
                <td class="text-left" rowspan="1" colspan="1">Send Q(MA,A*B)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">TO_EX (B)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE(A*B,B-A)</td>
                <td class="text-left" rowspan="1" colspan="1">(B-A)=0, Delete (A-B), Send Q(MA,A*B), Filter Timer=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE (A)</td>
                <td class="text-left" rowspan="1" colspan="1">TO_IN (B)</td>
                <td class="text-left" rowspan="1" colspan="1">INCLUDE(A+B)</td>
                <td class="text-left" rowspan="1" colspan="1">(B)=MALI, Send Q(MA,A-B)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">ALLOW (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE(X+A,Y-A)</td>
                <td class="text-left" rowspan="1" colspan="1">(A)=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">BLOCK (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE(X+(A-Y),Y)</td>
                <td class="text-left" rowspan="1" colspan="1">(A-X-Y)=Filter Timer, Send Q(MA,A-Y)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">TO_EX (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE(A-Y,Y*A)</td>
                <td class="text-left" rowspan="1" colspan="1">(A-X-Y)=Filter Timer, Delete (X-A), Delete (Y-A), Send Q(MA,A-Y), Filter Timer=MALI</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE (X,Y)</td>
                <td class="text-left" rowspan="1" colspan="1">TO_IN (A)</td>
                <td class="text-left" rowspan="1" colspan="1">EXCLUDE(X+A,Y-A)</td>
                <td class="text-left" rowspan="1" colspan="1">(A)=MALI, Send Q(MA,X-A), Send Q(MA)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
<div id="rtr_mode">
<section id="section-7.5">
        <h3 id="name-switching-router-filter-mod">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-switching-router-filter-mod" class="section-name selfRef">Switching Router Filter Modes</a>
        </h3>
<p id="section-7.5-1">The Filter Timer is used as a mechanism for transitioning the Router
    Filter Mode from EXCLUDE to INCLUDE.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">When a Filter Timer expires with a Router Filter Mode of EXCLUDE, a
   router assumes that there are no nodes with a filter-mode of
   EXCLUDE present on the attached link.  Thus, the router transitions
    to INCLUDE filter-mode for the multicast address.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">A router uses the sources from the Requested List as its state for
   the switch to a filter-mode of INCLUDE.  Sources from the Requested
   List are moved in the Include List, while sources from the Exclude
   List are deleted.  For example, if a router's state for a multicast
   address is EXCLUDE(X,Y) and the Filter Timer expires for that
   multicast address, the router switches to filter-mode of INCLUDE with
   state INCLUDE(X).  If at the moment of the switch the Requested List
   (X) is empty, the Multicast Address Record is deleted from the
    router.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.6">
        <h3 id="name-action-on-reception-of-quer">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-action-on-reception-of-quer" class="section-name selfRef">Action on Reception of Queries</a>
        </h3>
<p id="section-7.6-1">Upon reception of an MLD message that contains a Query, the router
   checks if the source address of the message is a valid link-local
   address, if the Hop Limit is set to 1, and if the Router Alert option
   is present in the Hop-by-Hop Options header of the IPv6 packet.  If
    any of these checks fail, the packet is dropped.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">If the validity of the MLD message is verified, the router starts to
    process the Query.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<section id="section-7.6.1">
          <h4 id="name-timer-updates">
<a href="#section-7.6.1" class="section-number selfRef">7.6.1. </a><a href="#name-timer-updates" class="section-name selfRef">Timer Updates</a>
          </h4>
<p id="section-7.6.1-1">MLDv2 uses the S flag to ensure
    robustness, as explained in <a href="#build_state" class="auto internal xref">Section 2.1</a>.  When a router sends or
   receives a query with a clear S flag,
   it must update its timers to reflect the correct timeout values for
   the multicast address or sources being queried.  The following table
   describes the timer actions when sending or receiving a Multicast
   Address Specific or Multicast Address and Source Specific Query with
    the S flag not set.<a href="#section-7.6.1-1" class="pilcrow">¶</a></p>
<span id="name-timer-actions-for-query-mes"></span><table class="left" id="table-9">
            <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-timer-actions-for-query-mes" class="selfRef">Timer Actions for Query Message Transmission</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Query</th>
                <th class="text-left" rowspan="1" colspan="1">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Q(MA,A)</td>
                <td class="text-left" rowspan="1" colspan="1">Source Timers for sources in A are lowered to LLQT.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Q(MA)</td>
                <td class="text-left" rowspan="1" colspan="1">The Filter Timer is lowered to LLQT.</td>
              </tr>
            </tbody>
          </table>
<p id="section-7.6.1-3">When a router sends or receives a query with the S
   flag set, it will not update its timers.<a href="#section-7.6.1-3" class="pilcrow">¶</a></p>
</section>
<div id="elect">
<section id="section-7.6.2">
          <h4 id="name-querier-election">
<a href="#section-7.6.2" class="section-number selfRef">7.6.2. </a><a href="#name-querier-election" class="section-name selfRef">Querier Election</a>
          </h4>
<p id="section-7.6.2-1">MLDv2 elects a single router per subnet to be in Querier state;
          all the other routers on the subnet should be in Non-Querier
          state. MLDv2 uses the same querier election mechanism as MLDv1,
          namely the IPv6 address.  When a router starts operating on a
          subnet, by default it considers itself as being the Querier.  Thus,
          it sends several General Queries separated by a small time interval
          (see Sections <a href="#start_qry_int" class="auto internal xref">9.6</a> and
          <a href="#start_qry_cnt" class="auto internal xref">9.7</a> for details).<a href="#section-7.6.2-1" class="pilcrow">¶</a></p>
<p id="section-7.6.2-2">When a router receives a query with a lower IPv6 address than its
          own, it sets the Other-Querier-Present Timer to [Other Querier
          Present Interval]; if it was previously in Querier state, it switches
          to Non- Querier state and ceases to send queries on the link.  After
          the Other-Querier-Present Timer expires, it should re-enter the
          Querier state and begin sending General Queries.<a href="#section-7.6.2-2" class="pilcrow">¶</a></p>
<p id="section-7.6.2-3">All MLDv2 queries <span class="bcp14">MUST</span> be sent with the fe80::/64
          link-local source address prefix.  Therefore, for the purpose of
          MLDv2 querier election, an IPv6 address A is considered to be lower
          than an IPv6 address B if the interface ID represented by the last
          64 bits of address A, in big-endian bit order, is lower than the
          interface ID represented by the last 64 bits of address B.<a href="#section-7.6.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spec_qry">
<section id="section-7.6.3">
          <h4 id="name-building-and-sending-specif">
<a href="#section-7.6.3" class="section-number selfRef">7.6.3. </a><a href="#name-building-and-sending-specif" class="section-name selfRef">Building and Sending Specific Queries</a>
          </h4>
<section id="section-7.6.3.1">
            <h5 id="name-building-and-sending-multic">
<a href="#section-7.6.3.1" class="section-number selfRef">7.6.3.1. </a><a href="#name-building-and-sending-multic" class="section-name selfRef">Building and Sending Multicast Address Specific Queries</a>
            </h5>
<p id="section-7.6.3.1-1">When a table action "Send Q(MA)" is encountered, the Filter Timer
   must be lowered to LLQT.  The Querier must then immediately send a
   Multicast Address Specific Query as well as schedule [Last Listener
   Query Count - 1] query retransmissions to be sent every [Last
    Listener Query Interval], over [Last Listener Query Time].<a href="#section-7.6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.6.3.1-2">When transmitting a Multicast Address Specific Query, if the Filter
   Timer is larger than LLQT, the "Suppress Router-Side Processing" bit
    is set in the Query Message.<a href="#section-7.6.3.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-7.6.3.2">
            <h5 id="name-building-and-sending-multica">
<a href="#section-7.6.3.2" class="section-number selfRef">7.6.3.2. </a><a href="#name-building-and-sending-multica" class="section-name selfRef">Building and Sending Multicast Address and Source Specific Queries</a>
            </h5>
<p id="section-7.6.3.2-1">When a table action "Send Q(MA,X)" is encountered by the Querier in
   <a href="#mr-state-trans" class="auto internal xref">Table 8</a> (<a href="#fm_chg" class="auto internal xref">Section 7.4.2</a>), the following actions must be performed
   for each of the sources in X that send to multicast address MA, with
   the Source Timer larger than LLQT:<a href="#section-7.6.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6.3.2-2.1">
                <p id="section-7.6.3.2-2.1.1">lower Source Timer to LLQT;<a href="#section-7.6.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.3.2-2.2">
                <p id="section-7.6.3.2-2.2.1">add the sources to the Retransmission List; and<a href="#section-7.6.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.6.3.2-2.3">
                <p id="section-7.6.3.2-2.3.1">set the Source Retransmission Counter for each source to [Last Listener Query Count].<a href="#section-7.6.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.6.3.2-3">The Querier must then immediately send a Multicast Address and Source
   Specific Query as well as schedule [Last Listener Query Count -1]
   query retransmissions to be sent every [Last Listener Query
   Interval], over [Last Listener Query Time].  The contents of these
    queries are calculated as follows.<a href="#section-7.6.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.6.3.2-4">When building a Multicast Address and Source Specific Query for a
   multicast address MA, two separate Query Messages are sent for the
   multicast address.  The first one has the "Suppress Router-Side
   Processing" bit set and contains all the sources with retransmission
   state (i.e., sources from the Retransmission List of that multicast
   address) and timers greater than LLQT.  The second has the "Suppress
   Router-Side Processing" bit clear and contains all the sources with
   retransmission state and timers lower or equal to LLQT.  If either of
   the two calculated messages does not contain any sources, then its
    transmission is suppressed.<a href="#section-7.6.3.2-4" class="pilcrow">¶</a></p>
<aside id="section-7.6.3.2-5">
              <p id="section-7.6.3.2-5.1">Note: If a Multicast Address Specific Query is scheduled to be
   transmitted at the same time as a Multicast Address and Source
   Specific Query for the same multicast address, then transmission of
   the Multicast Address and Source Specific message with the "Suppress
    Router-Side Processing" bit set may be suppressed.<a href="#section-7.6.3.2-5.1" class="pilcrow">¶</a></p>
</aside>
</section>
</section>
</div>
</section>
</section>
</div>
<div id="interop">
<section id="section-8">
      <h2 id="name-interoperation-with-mldv1">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-interoperation-with-mldv1" class="section-name selfRef">Interoperation with MLDv1</a>
      </h2>
<p id="section-8-1">MLD version 2 hosts and routers interoperate with hosts and routers
   that have not yet been upgraded to MLDv2.  This compatibility is
   maintained by hosts and routers taking appropriate actions depending
   on the versions of MLD operating on hosts and routers within a
    network.<a href="#section-8-1" class="pilcrow">¶</a></p>
<section id="section-8.1">
        <h3 id="name-query-version-distinctions">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-query-version-distinctions" class="section-name selfRef">Query Version Distinctions</a>
        </h3>
<p id="section-8.1-1">The MLD version of a Multicast Listener Query Message is determined
   as follows:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-2.1">
            <p id="section-8.1-2.1.1">MLDv1 Query: length = 24 octets<a href="#section-8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-2.2">
            <p id="section-8.1-2.2.1">MLDv2 Query: length &gt;= 28 octets<a href="#section-8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-3">Query Messages that do not match any of the above conditions (e.g., a
    Query of length 26 octets) <span class="bcp14">MUST</span> be silently ignored.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-multicast-address-listener-">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-multicast-address-listener-" class="section-name selfRef">Multicast Address Listener Behavior</a>
        </h3>
<section id="section-8.2.1">
          <h4 id="name-in-the-presence-of-mldv1-ro">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-in-the-presence-of-mldv1-ro" class="section-name selfRef">In the Presence of MLDv1 Routers</a>
          </h4>
<p id="section-8.2.1-1">In order to be compatible with MLDv1 routers, MLDv2 hosts <span class="bcp14">MUST</span>
   operate in version 1 compatibility mode.  MLDv2 hosts <span class="bcp14">MUST</span> keep state
   per local interface regarding the compatibility mode of each attached
   link.  A host's compatibility mode is determined from the Host
   Compatibility Mode variable that can be in one of the two states:
    MLDv1 or MLDv2.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">The Host Compatibility Mode of an interface is set to MLDv1 whenever
   an MLDv1 Multicast Address Listener General Query is received on that
   interface.  At the same time, the Older-Version-Querier-Present Timer
   for the interface is set to [Older Version Querier Present Interval]
   seconds.  The timer is reset whenever a new MLDv1 General Query is received
   on that interface.  If the Older-Version-Querier-Present Timer
    expires, the host switches back to Host Compatibility Mode of MLDv2.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">When Host Compatibility Mode is MLDv2, a host acts using the MLDv2
   protocol on that interface.  When Host Compatibility Mode is MLDv1, a
   host acts in MLDv1 compatibility mode, using only the MLDv1 protocol,
    on that interface.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4">An MLDv1 Querier will send General Queries with the Maximum Response
   Code set to the desired Maximum Response Delay, i.e., the full range
   of this field is linear and the exponential algorithm described in
    <a href="#mrcode" class="auto internal xref">Section 5.1.3</a>. is not used.<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
<p id="section-8.2.1-5">Whenever a host changes its compatibility mode, it cancels all its
    pending responses and retransmission timers.<a href="#section-8.2.1-5" class="pilcrow">¶</a></p>
<p id="section-8.2.1-6">An SSM-aware host that receives an MLDv1 General Query or MLDv1 Group
   Specific Query for a multicast address in the SSM address range <span class="bcp14">SHOULD</span> log an error.
   It is <span class="bcp14">RECOMMENDED</span> that implementations provide a configuration option to disable the
   use of Host Compatibility Mode to allow networks to operate only in SSM mode.
   This configuration option <span class="bcp14">SHOULD</span> be disabled by default.<a href="#section-8.2.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2.2">
          <h4 id="name-in-the-presence-of-mldv1-mu">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-in-the-presence-of-mldv1-mu" class="section-name selfRef">In the Presence of MLDv1 Multicast Address Listeners</a>
          </h4>
<p id="section-8.2.2-1">An MLDv2 host may be placed on a link where there are MLDv1 hosts.  A
   host <span class="bcp14">MAY</span> allow its MLD Version 2 Multicast Listener Report to be suppressed
    by an MLDv1 Multicast Listener Report (Type = decimal 131).<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-8.3">
        <h3 id="name-multicast-router-behavior">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-multicast-router-behavior" class="section-name selfRef">Multicast Router Behavior</a>
        </h3>
<section id="section-8.3.1">
          <h4 id="name-in-the-presence-of-mldv1-rou">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-in-the-presence-of-mldv1-rou" class="section-name selfRef">In the Presence of MLDv1 Routers</a>
          </h4>
<p id="section-8.3.1-1">MLDv2 routers may be placed on a network where there is at least one
   MLDv1 router.  The following requirements apply:<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.1-2.1">
              <p id="section-8.3.1-2.1.1">If an MLDv1 router is present on the link, the Querier <span class="bcp14">MUST</span> use
      the lowest version of MLD present on the network.  This must be
      administratively assured.  Routers that desire to be compatible
      with MLDv1 <span class="bcp14">MUST</span> have a configuration option to act in MLDv1 mode;
      if an MLDv1 router is present on the link, the system
      administrator must explicitly configure all MLDv2 routers to act
      in MLDv1 mode. When in MLDv1 mode, the Querier <span class="bcp14">MUST</span> send periodic
      General Queries truncated at the Multicast Address field (i.e., 24
      bytes long) and <span class="bcp14">SHOULD</span> also warn about receiving an MLDv2 Query
      (such warnings <span class="bcp14">MUST</span> be rate-limited).  The Querier <span class="bcp14">MUST</span> also fill
      in the Maximum Response Delay in the Maximum Response Code field,
      i.e., the exponential algorithm described in <a href="#mrcode" class="auto internal xref">Section 5.1.3</a> is not
       used.<a href="#section-8.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-2.2">
              <p id="section-8.3.1-2.2.1">If a router is not explicitly configured to use MLDv1 and receives
      an MLDv1 General Query, it <span class="bcp14">SHOULD</span> log a warning.  These warnings
    <span class="bcp14">MUST</span> be rate-limited.<a href="#section-8.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-2.3">
              <p id="section-8.3.1-2.3.1">It is <span class="bcp14">RECOMMENDED</span> that implementations provide a configuration option
   to disable use of compatibility mode to allow networks to operate only in SSM mode.
   This configuration option <span class="bcp14">SHOULD</span> be disabled by default.<a href="#section-8.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
<section id="section-8.3.2">
          <h4 id="name-in-the-presence-of-mldv1-mul">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-in-the-presence-of-mldv1-mul" class="section-name selfRef">In the Presence of MLDv1 Multicast Address Listeners</a>
          </h4>
<p id="section-8.3.2-1">MLDv2 routers may be placed on a network where there are hosts that
   have not yet been upgraded to MLDv2.  In order to be compatible with
   MLDv1 hosts, MLDv2 routers <span class="bcp14">MUST</span> operate in version 1 compatibility
   mode.  MLDv2 routers keep a compatibility mode per Multicast Address
   Record.  The compatibility mode of a multicast address is determined
   from the Multicast Address Compatibility Mode variable, which can be
    in one of the two following states: MLDv1 or MLDv2.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-2">The Multicast Address Compatibility Mode of a Multicast Address
   Record is set to MLDv1 whenever an MLDv1 Multicast Listener Report (Type = decimal 131) is
   received for that multicast address.  At the same time, the Older-Version-Host-Present
   Timer for the multicast address is set to [Older Version Host Present Interval] seconds. The timer is reset whenever a
   new MLDv1 Report is received for that multicast address.  If the
   Older-Version-Host-Present Timer expires, the router switches back to
   the Multicast Address Compatibility Mode of MLDv2 for that multicast
    address.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
<p id="section-8.3.2-3">Note that when a router switches back to MLDv2 Multicast Address
   Compatibility Mode for a multicast address, it takes some time to
   regain source-specific state information.  Source-specific
   information will be learned during the next General Query, but
   sources that should be blocked will not be blocked until [Multicast
    Address Listening Interval] after that.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
<p id="section-8.3.2-4">When Multicast Address Compatibility Mode is MLDv2, a router acts
   using the MLDv2 protocol for that multicast address.  When Multicast
   Address Compatibility Mode is MLDv1, a router internally translates
   the following MLDv1 messages for that multicast address to their
    MLDv2 equivalents (<a href="#msg-xlate" class="auto internal xref">Table 10</a>).<a href="#section-8.3.2-4" class="pilcrow">¶</a></p>
<span id="name-mld-message-translation"></span><div id="msg-xlate">
<table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-mld-message-translation" class="selfRef">MLD Message Translation</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">MLDv1 Message</th>
                <th class="text-left" rowspan="1" colspan="1">MLDv2 Equivalent</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Report</td>
                <td class="text-left" rowspan="1" colspan="1">IS_EX( {} )</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Done</td>
                <td class="text-left" rowspan="1" colspan="1">TO_IN( {} )</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-8.3.2-6">MLDv2 BLOCK messages are ignored, as are source-lists in TO_EX()
   messages (i.e., any TO_EX() message is treated as TO_EX( {} )).  On
   the other hand, the Querier continues to send MLDv2 queries,
    regardless of its Multicast Address Compatibility Mode.<a href="#section-8.3.2-6" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<div id="timers">
<section id="section-9">
      <h2 id="name-list-of-timers-counters-and">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-list-of-timers-counters-and" class="section-name selfRef">List of Timers, Counters, and Their Default Values</a>
      </h2>
<p id="section-9-1">Most of these timers are configurable.  If non-default settings are
   used, they <span class="bcp14">MUST</span> be consistent among all nodes on a single link.  Note
   that parentheses are used to group expressions to make the algebra
    clear.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="robust">
<section id="section-9.1">
        <h3 id="name-robustness-variable">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-robustness-variable" class="section-name selfRef">Robustness Variable</a>
        </h3>
<p id="section-9.1-1">The Robustness Variable allows tuning for the expected packet loss on
   a link.  If a link is expected to be lossy, the value of the
   Robustness Variable may be increased.  MLD is robust to [Robustness
   Variable] - 1 packet losses.  The value of the Robustness Variable
    <span class="bcp14">MUST NOT</span> be zero and <span class="bcp14">SHOULD NOT</span> be one.  Default value: 2.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qry_int">
<section id="section-9.2">
        <h3 id="name-query-interval">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-query-interval" class="section-name selfRef">Query Interval</a>
        </h3>
<p id="section-9.2-1">The Query Interval variable denotes the interval between General
    Queries sent by the Querier.  Default value: 125 seconds.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">By varying the Query Interval, an administrator may tune the number
   of MLD messages on the link; larger values cause MLD Queries to be
    sent less often.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9.3">
        <h3 id="name-query-response-interval">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-query-response-interval" class="section-name selfRef">Query Response Interval</a>
        </h3>
<p id="section-9.3-1">The Query Response Interval is the Maximum Response Delay used to calculate the Maximum Response
   Code that is inserted into the periodic General Queries.  Default value:
    10000 (10 seconds)<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">By varying the Query Response Interval, an administrator may tune
   the burstiness of MLD messages on the link; larger values make the
   traffic less bursty, as host responses are spread out over a larger
   interval.  The number of seconds represented by [Query Response
    Interval] must be less than the [Query Interval].<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9.4">
        <h3 id="name-multicast-address-listening-">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-multicast-address-listening-" class="section-name selfRef">Multicast Address Listening Interval</a>
        </h3>
<p id="section-9.4-1">The Multicast Address Listening Interval (MALI) is the amount of time
   that must pass before a multicast router decides there are no more
   listeners of a multicast address or a particular source on a link.
   This value <span class="bcp14">MUST</span> be ([Robustness Variable] times [Query Interval])
   plus 2 times [Query Response Interval].<a href="#section-9.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.5">
        <h3 id="name-other-querier-present-inter">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-other-querier-present-inter" class="section-name selfRef">Other Querier Present Interval</a>
        </h3>
<p id="section-9.5-1">The Other Querier Present Interval is the length of time that must
   pass before a multicast router decides that there is no longer
   another multicast router that should be the Querier.  This value
   <span class="bcp14">MUST</span> be ([Robustness Variable] times ([Query Interval]) plus
    (0.5 times [Query Response Interval]).<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
<div id="start_qry_int">
<section id="section-9.6">
        <h3 id="name-startup-query-interval">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-startup-query-interval" class="section-name selfRef">Startup Query Interval</a>
        </h3>
<p id="section-9.6-1">The Startup Query Interval is the interval between General Queries
   sent by a Querier on startup.  Default value: 1/4 the [Query
    Interval].<a href="#section-9.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="start_qry_cnt">
<section id="section-9.7">
        <h3 id="name-startup-query-count">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-startup-query-count" class="section-name selfRef">Startup Query Count</a>
        </h3>
<p id="section-9.7-1">The Startup Query Count is the number of Queries sent out on startup,
   separated by the Startup Query Interval.  Default value: [Robustness
    Variable].<a href="#section-9.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9.8">
        <h3 id="name-last-listener-query-interva">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-last-listener-query-interva" class="section-name selfRef">Last Listener Query Interval</a>
        </h3>
<p id="section-9.8-1">The Last Listener Query Interval (LLQI) is the Maximum Response Delay used
   to calculate the Maximum Response Code inserted into Multicast
   Address Specific Queries sent in response to MLDv1 Multicast
   Listener Done (Type = decimal 132) messages.  It is also the Maximum Response Delay used
   to calculate the Maximum Response Code inserted into Multicast
   Address and Source Specific Query Messages.  Default value: 1000 (1
 second).<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2">Note that for values of LLQI greater than 32.768 seconds, a limited
   set of values can be represented, corresponding to sequential values
   of Maximum Response Code.  When converting a configured time to a
   Maximum Response Code value, it is recommended to use the exact value
   if possible, or the next lower value if the requested value is not
    exactly representable.<a href="#section-9.8-2" class="pilcrow">¶</a></p>
<p id="section-9.8-3">This value may be tuned to modify the leave latency of the link.  A
   reduced value results in reduced time to detect the departure of the
    last listener for a multicast address or source.<a href="#section-9.8-3" class="pilcrow">¶</a></p>
</section>
<section id="section-9.9">
        <h3 id="name-last-listener-query-count">
<a href="#section-9.9" class="section-number selfRef">9.9. </a><a href="#name-last-listener-query-count" class="section-name selfRef">Last Listener Query Count</a>
        </h3>
<p id="section-9.9-1">The Last Listener Query Count is the number of Multicast Address
   Specific Queries sent before the router assumes there are no local
   listeners.  The Last Listener Query Count is also the number of
   Multicast Address and Source Specific Queries sent before the router
   assumes there are no listeners for a particular source.  Default
    value: [Robustness Variable].<a href="#section-9.9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.10">
        <h3 id="name-last-listener-query-time">
<a href="#section-9.10" class="section-number selfRef">9.10. </a><a href="#name-last-listener-query-time" class="section-name selfRef">Last Listener Query Time</a>
        </h3>
<p id="section-9.10-1">The Last Listener Query Time is the time value represented by the
   [Last Listener Query Interval] times [Last Listener Query
   Count].  It is not a tunable value, but it may be tuned by changing its
    components.<a href="#section-9.10-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.11">
        <h3 id="name-unsolicited-report-interval">
<a href="#section-9.11" class="section-number selfRef">9.11. </a><a href="#name-unsolicited-report-interval" class="section-name selfRef">Unsolicited Report Interval</a>
        </h3>
<p id="section-9.11-1">The Unsolicited Report Interval is the time between repetitions of a
   node's initial report of interest in a multicast address.  Default
    value: 1 second.<a href="#section-9.11-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.12">
        <h3 id="name-older-version-querier-prese">
<a href="#section-9.12" class="section-number selfRef">9.12. </a><a href="#name-older-version-querier-prese" class="section-name selfRef">Older Version Querier Present Interval</a>
        </h3>
<p id="section-9.12-1">The Older Version Querier Present Interval is the timeout for
   transitioning a host back to MLDv2 Host Compatibility Mode.  When an
   MLDv1 query is received, MLDv2 hosts set their Older-Version-Querier-Present
    Timer to [Older Version Querier Present Interval].<a href="#section-9.12-1" class="pilcrow">¶</a></p>
<p id="section-9.12-2">This value <span class="bcp14">MUST</span> be ([Robustness Variable] times [Query Interval]
    in the last Query received) plus ([Query Response Interval]).<a href="#section-9.12-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9.13">
        <h3 id="name-older-version-host-present-">
<a href="#section-9.13" class="section-number selfRef">9.13. </a><a href="#name-older-version-host-present-" class="section-name selfRef">Older Version Host Present Interval</a>
        </h3>
<p id="section-9.13-1">The Older Version Host Present Interval is the timeout for
   transitioning a router back to MLDv2 Multicast Address Compatibility
   Mode for a specific multicast address.  When an MLDv1 report is
   received for that multicast address, routers set their Older-Version-Host-Present
    Timer to [Older Version Host Present Interval].<a href="#section-9.13-1" class="pilcrow">¶</a></p>
<p id="section-9.13-2">This value <span class="bcp14">MUST</span> be ([Robustness Variable] times [Query Interval])
    plus ([Query Response Interval]).<a href="#section-9.13-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9.14">
        <h3 id="name-configuring-timers">
<a href="#section-9.14" class="section-number selfRef">9.14. </a><a href="#name-configuring-timers" class="section-name selfRef">Configuring Timers</a>
        </h3>
<p id="section-9.14-1">This section is meant to provide advice to network administrators on
   how to tune these settings to their network.  Ambitious router
   implementations might tune these settings dynamically based upon
    changing characteristics of the network.<a href="#section-9.14-1" class="pilcrow">¶</a></p>
<section id="section-9.14.1">
          <h4 id="name-robustness-variable-2">
<a href="#section-9.14.1" class="section-number selfRef">9.14.1. </a><a href="#name-robustness-variable-2" class="section-name selfRef">Robustness Variable</a>
          </h4>
<p id="section-9.14.1-1">The Robustness Variable tunes MLD to expected losses on a link.
   MLDv2 is robust to [Robustness Variable] - 1 packet losses, e.g., if
   the Robustness Variable is set to the default value of 2, MLDv2 is
   robust to a single packet loss but may operate imperfectly if more
   losses occur.  On lossy links, the value of the Robustness Variable
   should be increased to allow for the expected level of packet loss.
   However, increasing the value of the Robustness Variable increases
   the leave latency of the link (the time between when the last
   listener stops listening to a source or multicast address and when
    the traffic stops flowing).<a href="#section-9.14.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.14.2">
          <h4 id="name-query-interval-2">
<a href="#section-9.14.2" class="section-number selfRef">9.14.2. </a><a href="#name-query-interval-2" class="section-name selfRef">Query Interval</a>
          </h4>
<p id="section-9.14.2-1">The overall level of periodic MLD traffic is inversely proportional
   to the Query Interval.  A longer Query Interval results in a lower
   overall level of MLD traffic.  The value of the Query Interval <span class="bcp14">MUST</span>
   be equal to or greater than the Maximum Response Delay used to
   calculate the Maximum Response Code inserted in General Query
    Messages.<a href="#section-9.14.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9.14.3">
          <h4 id="name-maximum-response-delay">
<a href="#section-9.14.3" class="section-number selfRef">9.14.3. </a><a href="#name-maximum-response-delay" class="section-name selfRef">Maximum Response Delay</a>
          </h4>
<p id="section-9.14.3-1">The burstiness of MLD traffic is inversely proportional to the
   Maximum Response Delay.  A longer Maximum Response Delay will spread
   Report messages over a longer interval.  However, a longer Maximum
   Response Delay in Multicast Address Specific and Multicast Address
   and Source Specific Queries extends the leave latency (the time
   between when the last listener stops listening to a source or
   multicast address and when the traffic stops flowing.)  The expected
   rate of Report messages can be calculated by dividing the expected
   number of Reporters by the Maximum Response Delay.  The Maximum
   Response Delay may be dynamically calculated (as shown in <a href="#mrd-calc" class="auto internal xref">Table 11</a>) per Query by using the
   expected number of Reporters for that Query.<a href="#section-9.14.3-1" class="pilcrow">¶</a></p>
<span id="name-maximum-response-delay-calc"></span><div id="mrd-calc">
<table class="center" id="table-11">
            <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-maximum-response-delay-calc" class="selfRef">Maximum Response Delay Calculation</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Query Type</th>
                <th class="text-left" rowspan="1" colspan="1">Expected Number of Reporters</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">General Query</td>
                <td class="text-left" rowspan="1" colspan="1">All nodes on the link.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Multicast Address Specific Query</td>
                <td class="text-left" rowspan="1" colspan="1">All nodes on the link that had expressed interest in the multicast address.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Multicast Address and Source Specific Query</td>
                <td class="text-left" rowspan="1" colspan="1">All nodes on the link that had expressed interest in the source and multicast address.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-9.14.3-3">A router is not required to calculate these populations or tune the
    Maximum Response Delay dynamically; these are simply guidelines.<a href="#section-9.14.3-3" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">MLD does not contain any cryptographic protection, thus its messages
   are not authenticated, the message contents are not confidential, and
   any message can be replayed. The ability to replay messages does not affect
   the behavior of the protocol itself.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Replaying messages can lead to multicast
   forwarding state to remain active beyond the needs of group members on a
   link. Excessive retention of multicast state may lead to resource
   exhaustion in some devices.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">The lack of confidentiality allows any device with access to the link
   to determine which multicast groups are being requested. This is a privacy
    issue as some multicast content may be sensitive.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">The lack of authentication allows for the creation of forged messages.  Note
   that before processing an MLD message, nodes verify if the source
   address of the message is a valid link-local address (or the
   unspecified address), if the Hop Limit is set to 1, and if the Router
   Alert option is present in the Hop-by-Hop Options header of the IPv6
   packet.  If any of these checks fails, the packet is dropped.  This
   defends the MLDv2 nodes from acting on forged MLD messages originated
   off-link.  Therefore, we discuss only the effects of
    on-link forgery in the following section.<a href="#section-10-4" class="pilcrow">¶</a></p>
<section id="section-10.1">
        <h3 id="name-query-message">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-query-message" class="section-name selfRef">Query Message</a>
        </h3>
<p id="section-10.1-1">A forged Query Message from a machine with a lower IPv6 address than
   the current Querier will cause Querier duties to be assigned to the
   forger.  If the forger then sends no more Query Messages, other
   routers' Other Querier Present Timer will time out and one will
   resume the role of Querier.  During this time, if the forger ignores
   Multicast Listener Done messages, traffic might flow to multicast
   addresses with no listeners for up to [Multicast Address Listener
   Interval].<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">A forged Version 1 Query Message will put MLDv2 listeners on that
   link in MLDv1 Host Compatibility Mode.  This scenario can be avoided
   by providing MLDv2 hosts with a configuration option to ignore
   Version 1 messages completely.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">A DoS attack on a node could be staged through forged Multicast
   Address and Source Specific Queries.  The attacker can find out about
   the listening state of a specific node with a General Query.  After
   that, it could send a large number of Multicast Address and Source
   Specific Queries, each with a large source-list and/or long Maximum
   Response Delay.  The node will have to store and maintain the sources
   specified in all of those queries for as long as it takes to send the
   delayed response.  This would consume both memory and CPU cycles in
   order to augment the recorded sources with the source-lists included
   in the successive queries.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">To protect against such a DoS attack, a node stack implementation
   could restrict the number of Multicast Address and Source Specific
   Queries per multicast address within this interval and/or record
   only a limited number of sources.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-10.2">
        <h3 id="name-current-state-report-messag">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-current-state-report-messag" class="section-name selfRef">Current-State Report Messages</a>
        </h3>
<p id="section-10.2-1">A forged Report message may cause multicast routers to think there
   are listeners of a multicast address on a link when there are not.
   Nevertheless, since listening to a multicast address on a host is
   generally an unprivileged operation, a local user may trivially gain
   the same result without forging any messages. If a large number of
   forged Report messages are generated, a multicast router may consume
   significant resources maintaining multicast forwarding state.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">A forged Version 1 Report Message may put a router into MLDv1
   Multicast Address Compatibility Mode for a particular multicast
   address, meaning that the router will ignore MLDv2 source-specific
   state messages.  This can cause traffic to flow from unwanted sources
   for up to [Multicast Address Listener Interval].  This can be solved
   by providing routers with a configuration switch to ignore Version 1
   messages completely.  This breaks automatic compatibility with
   Version 1 hosts, so it should only be used in situations where source
   filtering is critical.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-10.3">
        <h3 id="name-state-change-report-message">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-state-change-report-message" class="section-name selfRef">State-Change Report Messages</a>
        </h3>
<p id="section-10.3-1">A forged State-Change Report message will cause the Querier to send
   out Multicast Address Specific or Multicast Address and Source
   Specific Queries for the multicast address in question.  This causes
   extra processing on each router and on each listener of the multicast
   address, but it cannot cause loss of desired traffic.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="iana">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">IANA has assigned the IPv6 link-local multicast address
   ff02::16, called "all MLDv2-capable routers", as described
   in <a href="#dest_addr" class="auto internal xref">Section 5.2.15</a>.  Version 2 Multicast Listener Reports will be sent
   to this special address.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">In addition, IANA has assigned the ICMPv6 message Type value of 143
   for Version 2 Multicast Listener Report messages, as specified in
   <a href="#node_state" class="auto internal xref">Section 4</a>.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2464">[RFC2464]</dt>
        <dd>
<span class="refAuthor">Crawford, M.</span>, <span class="refTitle">"Transmission of IPv6 Packets over Ethernet Networks"</span>, <span class="seriesInfo">RFC 2464</span>, <span class="seriesInfo">DOI 10.17487/RFC2464</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2464">https://www.rfc-editor.org/info/rfc2464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2710">[RFC2710]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Fenner, W.</span>, and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Multicast Listener Discovery (MLD) for IPv6"</span>, <span class="seriesInfo">RFC 2710</span>, <span class="seriesInfo">DOI 10.17487/RFC2710</span>, <time datetime="1999-10" class="refDate">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2710">https://www.rfc-editor.org/info/rfc2710</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2711">[RFC2711]</dt>
        <dd>
<span class="refAuthor">Partridge, C.</span> and <span class="refAuthor">A. Jackson</span>, <span class="refTitle">"IPv6 Router Alert Option"</span>, <span class="seriesInfo">RFC 2711</span>, <span class="seriesInfo">DOI 10.17487/RFC2711</span>, <time datetime="1999-10" class="refDate">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2711">https://www.rfc-editor.org/info/rfc2711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4604">[RFC4604]</dt>
        <dd>
<span class="refAuthor">Holbrook, H.</span>, <span class="refAuthor">Cain, B.</span>, and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Using Internet Group Management Protocol Version 3 (IGMPv3) and Multicast Listener Discovery Protocol Version 2 (MLDv2) for Source-Specific Multicast"</span>, <span class="seriesInfo">RFC 4604</span>, <span class="seriesInfo">DOI 10.17487/RFC4604</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4604">https://www.rfc-editor.org/info/rfc4604</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4607">[RFC4607]</dt>
        <dd>
<span class="refAuthor">Holbrook, H.</span> and <span class="refAuthor">B. Cain</span>, <span class="refTitle">"Source-Specific Multicast for IP"</span>, <span class="seriesInfo">RFC 4607</span>, <span class="seriesInfo">DOI 10.17487/RFC4607</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4607">https://www.rfc-editor.org/info/rfc4607</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9778">[RFC9778]</dt>
      <dd>
<span class="refAuthor">Haberman, B., Ed.</span>, <span class="refTitle">"IANA Considerations for Internet Group Management Protocols"</span>, <span class="seriesInfo">BCP 57</span>, <span class="seriesInfo">RFC 9778</span>, <span class="seriesInfo">DOI 10.17487/RFC9778</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9778">https://www.rfc-editor.org/info/rfc9778</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3569">[RFC3569]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, S., Ed.</span>, <span class="refTitle">"An Overview of Source-Specific Multicast (SSM)"</span>, <span class="seriesInfo">RFC 3569</span>, <span class="seriesInfo">DOI 10.17487/RFC3569</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3569">https://www.rfc-editor.org/info/rfc3569</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3678">[RFC3678]</dt>
        <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Fenner, B.</span>, and <span class="refAuthor">B. Quinn</span>, <span class="refTitle">"Socket Interface Extensions for Multicast Source Filters"</span>, <span class="seriesInfo">RFC 3678</span>, <span class="seriesInfo">DOI 10.17487/RFC3678</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3678">https://www.rfc-editor.org/info/rfc3678</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9776">[RFC9776]</dt>
      <dd>
<span class="refAuthor">Haberman, B., Ed.</span>, <span class="refTitle">"Internet Group Management Protocol, Version 3"</span>, <span class="seriesInfo">STD 100</span>, <span class="seriesInfo">RFC 9776</span>, <span class="seriesInfo">DOI 10.17487/RFC9776</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9776">https://www.rfc-editor.org/info/rfc9776</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-design-rationale">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-design-rationale" class="section-name selfRef">Design Rationale</a>
      </h2>
<div id="state_change">
<section id="appendix-A.1">
        <h3 id="name-the-need-for-state-change-r">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-the-need-for-state-change-r" class="section-name selfRef">The Need for State-Change Report Messages</a>
        </h3>
<p id="appendix-A.1-1">MLDv2 specifies two types of Multicast Listener Reports: Current
   State and State Change.  This section describes the rationale for the
   need for both these types of Reports.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Routers need to distinguish Multicast Listener Reports that were sent
   in response to Queries from those that were sent as a result of a
   change in the per-interface state.  Multicast Listener Reports that
   are sent in response to Multicast Address Listener Queries are used
   mainly to refresh the existing state at the router; they typically do
   not cause transitions in state at the router.  Multicast Listener
   Reports that are sent in response to changes in the per-interface
   state require the router to take some action in response to the
    received report (see <a href="#rcv_rpt" class="auto internal xref">Section 7.4</a>).<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">The inability to distinguish between the two types of reports would
   force a router to treat all Multicast Listener Reports as potential
   changes in state and could result in increased processing at the
   router as well as an increase in MLD traffic on the link.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="host_suppress">
<section id="appendix-A.2">
        <h3 id="name-host-suppression">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-host-suppression" class="section-name selfRef">Host Suppression</a>
        </h3>
<p id="appendix-A.2-1">In MLDv1, a host would not send a pending Multicast Listener Report
   if a similar report was sent by another listener on the link.  In
   MLDv2, the suppression of Multicast Listener Reports has been
   removed.  The following points explain this decision.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2-2">
<li id="appendix-A.2-2.1">
            <p id="appendix-A.2-2.1.1">Routers may want to track per-host Multicast Listener status on an
      interface.  This would allow routers to implement fast leaves
      (e.g., for layered multicast congestion control schemes) as well
      as track listener status for possible security or accounting
      purposes.  The present specification does not require routers to
      implement per-host tracking.  Nevertheless, the lack of host
      suppression in MLDv2 makes it possible to implement either
      proprietary or future standard behavior of multicast routers that
      would support per-host tracking, while being fully interoperable
      with MLDv2 listeners and routers that implement the exact behavior
    described in this specification.<a href="#appendix-A.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.2">
            <p id="appendix-A.2-2.2.1">Multicast Listener Report suppression does not work well on
      bridged LANs.  Many bridges and Layer 2 / Layer 3 switches that
      implement MLD snooping do not forward MLD messages across LAN
      segments in order to prevent Multicast Listener Report
    suppression.<a href="#appendix-A.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.3">
            <p id="appendix-A.2-2.3.1">By eliminating Multicast Listener Report suppression, hosts have
      fewer messages to process; this leads to a simpler state machine
    implementation.<a href="#appendix-A.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-2.4">
            <p id="appendix-A.2-2.4.1">In MLDv2, a single Multicast Listener Report now bundles multiple
      Multicast Address Records to decrease the number of packets sent.
      In comparison, the previous version of MLD required that each
    multicast address be reported in a separate message.<a href="#appendix-A.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="mode_switch">
<section id="appendix-A.3">
        <h3 id="name-switching-router-filter-mode">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-switching-router-filter-mode" class="section-name selfRef">Switching Router Filter Modes from EXCLUDE to INCLUDE</a>
        </h3>
<p id="appendix-A.3-1">If on a link there are nodes in both EXCLUDE and INCLUDE modes for a
   single multicast address, the router must be in EXCLUDE mode as well
   (see <a href="#def-router-filter-mode" class="auto internal xref">Section 7.2.1</a>).  In EXCLUDE mode, a router forwards traffic from
   all sources except those in the Exclude List.  If all nodes in
   EXCLUDE mode cease to exist or to listen, it would be desirable for
   the router to switch back to INCLUDE mode seamlessly, without
    interrupting the flow of traffic to existing listeners.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">One of the ways to accomplish this is for routers to keep track of
   all sources that nodes that are in INCLUDE mode listen to, even
   though the router itself is in EXCLUDE mode.  If the Filter Timer for
   a multicast address expires, it implies that there are no nodes in
   EXCLUDE mode on the link (otherwise, a Multicast Listener Report from
   that node would have refreshed the filter timer).  The router can
   then switch to INCLUDE mode seamlessly; sources from the Requested
   List are moved to the Include List, while sources from the Exclude
    List are deleted.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="appendix-B">
      <h2 id="name-summary-of-changes">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-summary-of-changes" class="section-name selfRef">Summary of Changes</a>
      </h2>
<section id="appendix-B.1">
        <h3 id="name-mldv1">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-mldv1" class="section-name selfRef">MLDv1</a>
        </h3>
<p id="appendix-B.1-1">The following is a summary of changes from MLDv1, specified in <span>[<a href="#RFC2710" class="cite xref">RFC2710</a>]</span>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">
            <p id="appendix-B.1-2.1.1">MLDv2 introduces source filtering.<a href="#appendix-B.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.2">
            <p id="appendix-B.1-2.2.1">The IP service interface of MLDv2 nodes is modified accordingly.
    It enables the specification of a filter-mode and a source-list.<a href="#appendix-B.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.3">
            <p id="appendix-B.1-2.3.1">An MLDv2 node keeps per-socket and per-interface Multicast Address Listening states that include a filter-mode and a source-list for
      each multicast address.  This enables packet filtering based on a
    socket's multicast reception state.<a href="#appendix-B.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.4">
            <p id="appendix-B.1-2.4.1">MLDv2 state kept on routers includes a filter-mode and a list of
      sources and source timers for each multicast address that has
      listeners on the link.  MLDv1 routers kept only the list of
    multicast addresses.<a href="#appendix-B.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.5">
            <p id="appendix-B.1-2.5.1">Queries include additional fields (<a href="#qry_msg" class="auto internal xref">Section 5.1</a>).<a href="#appendix-B.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.6">
            <p id="appendix-B.1-2.6.1">The S flag is included in queries in order to fix robustness issues.<a href="#appendix-B.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.7">
            <p id="appendix-B.1-2.7.1">The Querier's Robustness Variable and Query Interval Code are
      included in Queries in order to synchronize all MLDv2 routers
    connected to the same link.<a href="#appendix-B.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.8">
            <p id="appendix-B.1-2.8.1">A new Query type (Multicast Address and Source Specific Query) is
    introduced.<a href="#appendix-B.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.9">
            <p id="appendix-B.1-2.9.1">The Maximum Response Delay is not directly included in the Query
      anymore.  Instead, an exponential algorithm is used to calculate
      its value, based on the Maximum Response Code included in the
      Query.  The maximum value is increased from 65535 milliseconds to
    about 140 minutes.<a href="#appendix-B.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.10">
            <p id="appendix-B.1-2.10.1">Reports include Multicast Address Records.  Information on the
      listening state for several different multicast addresses can be
    included in the same Report message.<a href="#appendix-B.1-2.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.11">
            <p id="appendix-B.1-2.11.1">Reports are sent to the "all MLDv2-capable multicast routers"
      address, instead of the multicast address the host listens to, as
      in MLDv1.  This facilitates the operation of Layer 2 snooping
    switches.<a href="#appendix-B.1-2.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.12">
            <p id="appendix-B.1-2.12.1">There is no "host suppression", as in MLDv1.  All nodes send
    Report messages.<a href="#appendix-B.1-2.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.13">
            <p id="appendix-B.1-2.13.1">Unsolicited Reports, announcing changes in receiver listening
      state, are sent [Robustness Variable] times.  <span>[<a href="#RFC2710" class="cite xref">RFC2710</a>]</span> is less
    explicit.<a href="#appendix-B.1-2.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.14">
            <p id="appendix-B.1-2.14.1">There are no Done messages.<a href="#appendix-B.1-2.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.15">
            <p id="appendix-B.1-2.15.1">Interoperability with MLDv1 systems is achieved by MLDv2 state
    operations.<a href="#appendix-B.1-2.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.16">
            <p id="appendix-B.1-2.16.1">In order to ensure interoperability, hosts maintain a Host
      Compatibility Mode variable and an Older-Version-Querier-Present
      Timer per interface.  Routers maintain a Multicast Address
      Compatibility Mode variable and an Older-Version-Host-Present
      Timer per multicast address.<a href="#appendix-B.1-2.16.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<div id="_810-changes">
<section id="appendix-B.2">
        <h3 id="name-changes-since-rfc-3810">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-changes-since-rfc-3810" class="section-name selfRef">Changes since RFC 3810</a>
        </h3>
<p id="appendix-B.2-1">The following summarizes the changes made since <span>[<a href="#RFC3810" class="cite xref">RFC3810</a>]</span>.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">Added definition of Resv to address Erratum 4773.<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">Added clarifying text on which multicast addresses require the sending of MLD messages
    to address Erratum 5977.<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.3">
            <p id="appendix-B.2-2.3.1">Added text to clarify the Group Membership Interval Timer changes per Erratum 6725.<a href="#appendix-B.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.4">
            <p id="appendix-B.2-2.4.1">Changed "Reserved field" to "Flags field" in messages to facilitate use of an IANA-managed registry for future bit allocations.<a href="#appendix-B.2-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<section id="appendix-B.3">
        <h3 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
        </h3>
<p id="appendix-B.3-1">We would like to thank <span class="contact-name">Hitoshi Asaeda</span>, <span class="contact-name">Randy Bush</span>, <span class="contact-name">Francis Dupont</span>, <span class="contact-name">Ted Hardie</span>, <span class="contact-name">Russ Housley</span>, <span class="contact-name">Konstantin Kabassanov</span>, <span class="contact-name">Erik Nordmark</span>,
      <span class="contact-name">Shinsuke Suzuki</span>, <span class="contact-name">Margaret       Wasserman</span>, <span class="contact-name">Bert Wijnen</span>, and <span class="contact-name">Remi Zara</span> for their valuable comments and suggestions on
      this specification.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2"><span class="contact-name">Stig Venaas</span>, <span class="contact-name">Hitoshi       Asaeda</span>, and <span class="contact-name">Mike McBride</span> have provided valuable
      feedback on this specification, and we thank them for
      their input.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.4">
        <h3 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
        </h3>
<p id="appendix-B.4-1"><span class="contact-name">Roland Vida</span>, <span class="contact-name">Luis Henrique       Maciel Kosmalski Costa</span>, <span class="contact-name">Serge Fdida</span>, <span class="contact-name">Steve Deering</span>, <span class="contact-name">Bill Fenner</span>, and
      <span class="contact-name">Isidor Kouvelas</span> are the authors of RFC 3810, which
      makes up the majority of the content in this specification.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4-2"><span class="contact-name">Anuj Budhiraja</span>, <span class="contact-name">Toerless       Eckert</span>, <span class="contact-name">Olufemi Komolafe</span>, and <span class="contact-name">Tim Winters</span> have contributed valuable content to this
      specification.<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Haberman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Johns Hopkins University Applied Physics Lab</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:brian@innovationslab.net" class="email">brian@innovationslab.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
