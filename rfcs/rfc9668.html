<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9668: Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="Stefan Hristozov" name="author">
<meta content="Göran Selander" name="author">
<meta content="
       The lightweight authenticated key exchange protocol Ephemeral Diffie-Hellman Over COSE (EDHOC) can be run over the Constrained Application Protocol (CoAP) and used by two peers to establish a Security Context for the security protocol Object Security for Constrained RESTful Environments (OSCORE). This document details this use of the EDHOC protocol by specifying a number of additional and optional mechanisms, including an optimization approach for combining the execution of EDHOC with the first OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="Security" name="keyword">
<meta content="Key agreement; Secure communication" name="keyword">
<meta content="Constrained enviornments" name="keyword">
<meta content="AKE" name="keyword">
<meta content="lightweight authenticated key exchange" name="keyword">
<meta content="IoT security" name="keyword">
<meta content="9668" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9668.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-core-oscore-edhoc-11" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9668" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9668</td>
<td class="center">Using EDHOC with CoAP and OSCORE</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9668" class="eref">9668</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11" class="published">November 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">S. Hristozov</div>
<div class="org">Eriptic</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9668</h1>
<h1 id="title">Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The lightweight authenticated key exchange protocol Ephemeral Diffie-Hellman Over COSE (EDHOC) can be run over the Constrained Application Protocol (CoAP) and used by two peers to establish a Security Context for the security protocol Object Security for Constrained RESTful Environments (OSCORE). This document details this use of the EDHOC protocol by specifying a number of additional and optional mechanisms, including an optimization approach for combining the execution of EDHOC with the first OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9668">https://www.rfc-editor.org/info/rfc9668</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-edhoc-overview" class="internal xref">EDHOC Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-edhoc-combined-with-oscore" class="internal xref">EDHOC Combined with OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-edhoc-option" class="internal xref">EDHOC Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client-processing" class="internal xref">Client Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-processing-of-the-edhoc-osc" class="internal xref">Processing of the EDHOC + OSCORE Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-supporting-block-wise-trans" class="internal xref">Supporting Block-Wise Transfers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-server-processing" class="internal xref">Server Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-processing-of-the-edhoc-osco" class="internal xref">Processing of the EDHOC + OSCORE Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-supporting-block-wise-transf" class="internal xref">Supporting Block-Wise Transfers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-example-of-the-edhoc-oscore" class="internal xref">Example of the EDHOC + OSCORE Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-use-of-edhoc-connection-ide" class="internal xref">Use of EDHOC Connection Identifiers with OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-additional-processing-of-ed" class="internal xref">Additional Processing of EDHOC Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-initiator-processing-of-mes" class="internal xref">Initiator Processing of Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-responder-processing-of-mes" class="internal xref">Responder Processing of Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-initiator-processing-of-mess" class="internal xref">Initiator Processing of Message 2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-extension-and-consistency-o" class="internal xref">Extension and Consistency of Application Profiles</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-web-linking" class="internal xref">Web Linking</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-coap-option-numbers-registr" class="internal xref">CoAP Option Numbers Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-target-attributes-registry" class="internal xref">Target Attributes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-edhoc-authentication-creden" class="internal xref">EDHOC Authentication Credential Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Ephemeral Diffie-Hellman Over COSE (EDHOC) <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is a lightweight authenticated key exchange protocol that is specifically intended for use in constrained scenarios. In particular, EDHOC messages can be transported over the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and used for establishing a Security Context for Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document details the use of the EDHOC protocol with CoAP and OSCORE and specifies a number of additional and optional mechanisms. These include an optimization approach that combines the EDHOC execution with the first OSCORE transaction (see <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a>). This allows for a minimum number of two round trips necessary to set up the OSCORE Security Context and complete an OSCORE transaction, e.g., when an Internet of Things (IoT) device gets configured in a network for the first time.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This optimization is desirable since the number of message exchanges can have a substantial impact on the latency of conveying the first OSCORE request when using certain radio technologies.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Without this optimization, it is not possible to achieve the minimum number of two round trips. This optimization makes it possible since the message_3 of the EDHOC protocol can be made relatively small (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), thus allowing additional OSCORE-protected CoAP data within target MTU sizes.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The minimum number of two round trips can be achieved only if the default forward message flow of EDHOC is used, i.e., when a CoAP client acts as EDHOC Initiator and a CoAP server acts as EDHOC Responder. The performance advantage of using this optimization can be lost when used in combination with Block-wise transfers <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> that rely on specific parameter values and block sizes.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Furthermore, this document defines a number of parameters corresponding to
different information elements of an EDHOC application profile (see <a href="#web-linking" class="auto internal xref">Section 6</a>). These parameters can be specified as target attributes in the link to an
EDHOC resource associated with that application profile, thus enabling an
enhanced discovery of such a resource for CoAP clients.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The reader is expected to be familiar with terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-edhoc-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-edhoc-overview" class="section-name selfRef">EDHOC Overview</a>
      </h2>
<p id="section-2-1">This section is not normative and summarizes what is specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> (specifically <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). Thus, it provides a baseline for the enhancements in the subsequent sections.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The EDHOC protocol specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> allows two peers to agree on a cryptographic secret in a mutually-authenticated way and achieves forward secrecy by using Diffie-Hellman ephemeral keys. The two peers are denoted as the "Initiator" and "Responder", as the one sending or receiving the initial EDHOC message_1, respectively.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">After successful processing of EDHOC message_3, both peers agree on a cryptographic secret that can be used to derive further security material and establish an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. The Responder can also send an optional EDHOC message_4 in order for the Initiator to achieve key confirmation, e.g., in deployments where no protected application message is sent from the Responder to the Initiator.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> specifies how to transfer EDHOC over CoAP.  That is, the EDHOC data (i.e., the EDHOC message possibly with a prepended connection identifier) is transported in the payload of CoAP requests and responses. The default forward message flow of EDHOC consists in the CoAP client acting as Initiator and the CoAP server acting as Responder (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.1" class="relref">Appendix A.2.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). Alternatively, the two roles can be reversed as per the reverse message flow of EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.2" class="relref">Appendix A.2.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). In the rest of this document, EDHOC messages are considered to be transferred over CoAP.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"><a href="#fig-non-combined" class="auto internal xref">Figure 1</a> shows a successful execution of EDHOC, with a CoAP client and a CoAP server running EDHOC as Initiator and Responder, respectively. In particular, it extends Figure 10 from <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.1" class="relref">Appendix A.2.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> by highlighting when the two peers perform EDHOC verification and establish the OSCORE Security Context, and by adding an exchange of OSCORE-protected CoAP messages after completing the EDHOC execution.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">That is, the client sends a POST request to a reserved EDHOC resource at the server, by default at the Uri-Path "/.well-known/edhoc". The request payload consists of the CBOR simple value <code>true</code> (0xf5) concatenated with EDHOC message_1, which also includes the EDHOC connection identifier C_I of the client encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The request has Content-Format application/cid-edhoc+cbor-seq.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">This triggers the EDHOC execution at the server, which replies with a 2.04 (Changed) response. The response payload consists of EDHOC message_2, which also includes the EDHOC connection identifier C_R of the server encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The response has Content-Format application/edhoc+cbor-seq.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">Finally, the client sends a POST request to the same EDHOC resource used earlier when it sent EDHOC message_1. The request payload consists of the EDHOC connection identifier C_R encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> concatenated with EDHOC message_3. The request has Content-Format application/cid-edhoc+cbor-seq.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">After this exchange takes place, and after successful verifications as specified in the EDHOC protocol, the client and server can derive an OSCORE Security Context as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. After that, the client and server can use OSCORE to protect their communications as per <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Note that the EDHOC connection identifier C_R is used as the OSCORE Sender ID of the client (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). Therefore, C_R is transported in the 'kid' field of the OSCORE option of the OSCORE Request (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">The client and server are required to agree in advance on certain information and parameters describing how they should use EDHOC. These are specified in an application profile associated with the EDHOC resource addressed (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.9" class="relref">Section 3.9</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-2-10" class="pilcrow">¶</a></p>
<span id="name-sequential-flow-of-edhoc-an"></span><div id="fig-non-combined">
<figure id="figure-1">
        <div id="section-2-11.1">
          <div class="alignCenter art-svg artwork" id="section-2-11.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="768" width="544" viewBox="0 0 544 768" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 64,64 L 64,256" fill="none" stroke="black"></path>
              <path d="M 64,288 L 64,544" fill="none" stroke="black"></path>
              <path d="M 64,592 L 64,752" fill="none" stroke="black"></path>
              <path d="M 488,64 L 488,384" fill="none" stroke="black"></path>
              <path d="M 488,464 L 488,752" fill="none" stroke="black"></path>
              <path d="M 80,96 L 208,96" fill="none" stroke="black"></path>
              <path d="M 336,96 L 472,96" fill="none" stroke="black"></path>
              <path d="M 80,192 L 208,192" fill="none" stroke="black"></path>
              <path d="M 336,192 L 472,192" fill="none" stroke="black"></path>
              <path d="M 80,304 L 208,304" fill="none" stroke="black"></path>
              <path d="M 336,304 L 472,304" fill="none" stroke="black"></path>
              <path d="M 80,480 L 208,480" fill="none" stroke="black"></path>
              <path d="M 336,480 L 472,480" fill="none" stroke="black"></path>
              <path d="M 80,608 L 200,608" fill="none" stroke="black"></path>
              <path d="M 336,608 L 472,608" fill="none" stroke="black"></path>
              <path d="M 80,688 L 200,688" fill="none" stroke="black"></path>
              <path d="M 344,688 L 472,688" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="480,608 468,602.4 468,613.6" fill="black" transform="rotate(0,472,608)"></polygon>
              <polygon class="arrowhead" points="480,304 468,298.4 468,309.6" fill="black" transform="rotate(0,472,304)"></polygon>
              <polygon class="arrowhead" points="480,96 468,90.4 468,101.6" fill="black" transform="rotate(0,472,96)"></polygon>
              <polygon class="arrowhead" points="88,688 76,682.4 76,693.6" fill="black" transform="rotate(180,80,688)"></polygon>
              <polygon class="arrowhead" points="88,480 76,474.4 76,485.6" fill="black" transform="rotate(180,80,480)"></polygon>
              <polygon class="arrowhead" points="88,192 76,186.4 76,197.6" fill="black" transform="rotate(180,80,192)"></polygon>
              <g class="text">
                <text x="36" y="36">CoAP</text>
                <text x="84" y="36">client</text>
                <text x="452" y="36">CoAP</text>
                <text x="500" y="36">server</text>
                <text x="28" y="52">(EDHOC</text>
                <text x="100" y="52">Initiator)</text>
                <text x="428" y="52">(EDHOC</text>
                <text x="500" y="52">Responder)</text>
                <text x="240" y="100">EDHOC</text>
                <text x="296" y="100">Request</text>
                <text x="120" y="116">Header:</text>
                <text x="172" y="116">0.02</text>
                <text x="220" y="116">(POST)</text>
                <text x="128" y="132">Uri-Path:</text>
                <text x="252" y="132">"/.well-known/edhoc"</text>
                <text x="152" y="148">Content-Format:</text>
                <text x="340" y="148">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="164">Payload:</text>
                <text x="184" y="164">true,</text>
                <text x="232" y="164">EDHOC</text>
                <text x="296" y="164">message_1</text>
                <text x="240" y="196">EDHOC</text>
                <text x="300" y="196">Response</text>
                <text x="152" y="212">Header:</text>
                <text x="204" y="212">2.04</text>
                <text x="264" y="212">(Changed)</text>
                <text x="184" y="228">Content-Format:</text>
                <text x="356" y="228">application/edhoc+cbor-seq</text>
                <text x="156" y="244">Payload:</text>
                <text x="216" y="244">EDHOC</text>
                <text x="280" y="244">message_2</text>
                <text x="24" y="276">EDHOC</text>
                <text x="100" y="276">verification</text>
                <text x="240" y="308">EDHOC</text>
                <text x="296" y="308">Request</text>
                <text x="120" y="324">Header:</text>
                <text x="172" y="324">0.02</text>
                <text x="220" y="324">(POST)</text>
                <text x="128" y="340">Uri-Path:</text>
                <text x="252" y="340">"/.well-known/edhoc"</text>
                <text x="152" y="356">Content-Format:</text>
                <text x="340" y="356">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="372">Payload:</text>
                <text x="180" y="372">C_R,</text>
                <text x="224" y="372">EDHOC</text>
                <text x="288" y="372">message_3</text>
                <text x="416" y="404">EDHOC</text>
                <text x="492" y="404">verification</text>
                <text x="488" y="420">+</text>
                <text x="444" y="436">OSCORE</text>
                <text x="488" y="436">Sec</text>
                <text x="520" y="436">Ctx</text>
                <text x="468" y="452">Derivation</text>
                <text x="240" y="484">EDHOC</text>
                <text x="300" y="484">Response</text>
                <text x="152" y="500">Header:</text>
                <text x="204" y="500">2.04</text>
                <text x="264" y="500">(Changed)</text>
                <text x="184" y="516">Content-Format:</text>
                <text x="356" y="516">application/edhoc+cbor-seq</text>
                <text x="156" y="532">Payload:</text>
                <text x="216" y="532">EDHOC</text>
                <text x="280" y="532">message_4</text>
                <text x="28" y="564">OSCORE</text>
                <text x="72" y="564">Sec</text>
                <text x="104" y="564">Ctx</text>
                <text x="52" y="580">Derivation</text>
                <text x="236" y="612">OSCORE</text>
                <text x="296" y="612">Request</text>
                <text x="120" y="628">Header:</text>
                <text x="172" y="628">0.02</text>
                <text x="220" y="628">(POST)</text>
                <text x="120" y="644">OSCORE:</text>
                <text x="160" y="644">{</text>
                <text x="184" y="644">...</text>
                <text x="208" y="644">;</text>
                <text x="236" y="644">kid:</text>
                <text x="272" y="644">C_R</text>
                <text x="296" y="644">}</text>
                <text x="124" y="660">Payload:</text>
                <text x="228" y="660">OSCORE-protected</text>
                <text x="316" y="660">data</text>
                <text x="236" y="692">OSCORE</text>
                <text x="300" y="692">Response</text>
                <text x="232" y="708">Header:</text>
                <text x="284" y="708">2.04</text>
                <text x="344" y="708">(Changed)</text>
                <text x="232" y="724">OSCORE:</text>
                <text x="272" y="724">{</text>
                <text x="296" y="724">...</text>
                <text x="320" y="724">}</text>
                <text x="236" y="740">Payload:</text>
                <text x="340" y="740">OSCORE-protected</text>
                <text x="428" y="740">data</text>
              </g>
            </svg><a href="#section-2-11.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-sequential-flow-of-edhoc-an" class="selfRef">Sequential Flow of EDHOC and OSCORE with the Optional message_4
        Included</a>
        </figcaption></figure>
</div>
<p id="section-2-12">  The sequential flow of EDHOC and OSCORE (where EDHOC runs first and
  OSCORE is used after) takes three round trips to complete, as shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13"><a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a> defines an optimization for combining EDHOC with the first OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and complete an OSCORE transaction using that Security Context.<a href="#section-2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-in-oscore">
<section id="section-3">
      <h2 id="name-edhoc-combined-with-oscore">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-edhoc-combined-with-oscore" class="section-name selfRef">EDHOC Combined with OSCORE</a>
      </h2>
<p id="section-3-1">This section defines an optimization for combining the EDHOC message exchange with the first OSCORE transaction, thus minimizing the number of round trips between the two peers to the absolute possible minimum of two round trips.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To this end, this approach can be used only if the default forward message flow of EDHOC is used, i.e., when the client acts as Initiator and the server acts as Responder. The same is not possible in the case with reversed roles as per the reverse message flow of EDHOC.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">When running the sequential flow of <a href="#overview" class="auto internal xref">Section 2</a>, the client has all the information to derive the OSCORE Security Context already after receiving EDHOC message_2 and before sending EDHOC message_3.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Hence, the client can potentially send both EDHOC message_3 and the subsequent OSCORE Request at the same time. On a semantic level, this requires sending two REST requests at once as shown in <a href="#fig-combined" class="auto internal xref">Figure 2</a>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-combined"></span><div id="fig-combined">
<figure id="figure-2">
        <div id="section-3-5.1">
          <div class="alignCenter art-svg artwork" id="section-3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="552" viewBox="0 0 552 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 64,64 L 64,240" fill="none" stroke="black"></path>
              <path d="M 64,320 L 64,560" fill="none" stroke="black"></path>
              <path d="M 496,64 L 496,400" fill="none" stroke="black"></path>
              <path d="M 496,480 L 496,560" fill="none" stroke="black"></path>
              <path d="M 80,80 L 216,80" fill="none" stroke="black"></path>
              <path d="M 344,80 L 480,80" fill="none" stroke="black"></path>
              <path d="M 80,176 L 216,176" fill="none" stroke="black"></path>
              <path d="M 344,176 L 480,176" fill="none" stroke="black"></path>
              <path d="M 80,336 L 184,336" fill="none" stroke="black"></path>
              <path d="M 384,336 L 480,336" fill="none" stroke="black"></path>
              <path d="M 80,496 L 200,496" fill="none" stroke="black"></path>
              <path d="M 344,496 L 480,496" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="488,336 476,330.4 476,341.6" fill="black" transform="rotate(0,480,336)"></polygon>
              <polygon class="arrowhead" points="488,80 476,74.4 476,85.6" fill="black" transform="rotate(0,480,80)"></polygon>
              <polygon class="arrowhead" points="88,496 76,490.4 76,501.6" fill="black" transform="rotate(180,80,496)"></polygon>
              <polygon class="arrowhead" points="88,176 76,170.4 76,181.6" fill="black" transform="rotate(180,80,176)"></polygon>
              <g class="text">
                <text x="36" y="36">CoAP</text>
                <text x="84" y="36">client</text>
                <text x="460" y="36">CoAP</text>
                <text x="508" y="36">server</text>
                <text x="28" y="52">(EDHOC</text>
                <text x="100" y="52">Initiator)</text>
                <text x="436" y="52">(EDHOC</text>
                <text x="508" y="52">Responder)</text>
                <text x="248" y="84">EDHOC</text>
                <text x="304" y="84">Request</text>
                <text x="120" y="100">Header:</text>
                <text x="172" y="100">0.02</text>
                <text x="220" y="100">(POST)</text>
                <text x="128" y="116">Uri-Path:</text>
                <text x="252" y="116">"/.well-known/edhoc"</text>
                <text x="152" y="132">Content-Format:</text>
                <text x="340" y="132">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="148">Payload:</text>
                <text x="184" y="148">true,</text>
                <text x="232" y="148">EDHOC</text>
                <text x="296" y="148">message_1</text>
                <text x="248" y="180">EDHOC</text>
                <text x="308" y="180">Response</text>
                <text x="160" y="196">Header:</text>
                <text x="224" y="196">2.04</text>
                <text x="284" y="196">(Changed)</text>
                <text x="192" y="212">Content-Format:</text>
                <text x="364" y="212">application/edhoc+cbor-seq</text>
                <text x="164" y="228">Payload:</text>
                <text x="224" y="228">EDHOC</text>
                <text x="288" y="228">message_2</text>
                <text x="24" y="260">EDHOC</text>
                <text x="100" y="260">verification</text>
                <text x="64" y="276">+</text>
                <text x="36" y="292">OSCORE</text>
                <text x="80" y="292">Sec</text>
                <text x="112" y="292">Ctx</text>
                <text x="68" y="308">Derivation</text>
                <text x="216" y="340">EDHOC</text>
                <text x="248" y="340">+</text>
                <text x="284" y="340">OSCORE</text>
                <text x="344" y="340">Request</text>
                <text x="120" y="356">Header:</text>
                <text x="172" y="356">0.02</text>
                <text x="220" y="356">(POST)</text>
                <text x="120" y="372">OSCORE:</text>
                <text x="160" y="372">{</text>
                <text x="184" y="372">...</text>
                <text x="208" y="372">;</text>
                <text x="236" y="372">kid:</text>
                <text x="272" y="372">C_R</text>
                <text x="296" y="372">}</text>
                <text x="124" y="388">Payload:</text>
                <text x="184" y="388">EDHOC</text>
                <text x="248" y="388">message_3</text>
                <text x="296" y="388">+</text>
                <text x="372" y="388">OSCORE-protected</text>
                <text x="460" y="388">data</text>
                <text x="424" y="420">EDHOC</text>
                <text x="500" y="420">verification</text>
                <text x="496" y="436">+</text>
                <text x="444" y="452">OSCORE</text>
                <text x="488" y="452">Sec</text>
                <text x="520" y="452">Ctx</text>
                <text x="484" y="468">Derivation</text>
                <text x="236" y="500">OSCORE</text>
                <text x="300" y="500">Response</text>
                <text x="256" y="516">Header:</text>
                <text x="308" y="516">2.04</text>
                <text x="368" y="516">(Changed)</text>
                <text x="256" y="532">OSCORE:</text>
                <text x="296" y="532">{</text>
                <text x="320" y="532">...</text>
                <text x="344" y="532">}</text>
                <text x="260" y="548">Payload:</text>
                <text x="364" y="548">OSCORE-protected</text>
                <text x="452" y="548">data</text>
              </g>
            </svg><a href="#section-3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-edhoc-and-oscore-combined" class="selfRef">EDHOC and OSCORE Combined</a>
        </figcaption></figure>
</div>
<p id="section-3-6">To this end, the specific approach defined in this section consists of sending a single EDHOC + OSCORE request, which conveys the pair (C_R, EDHOC message_3) within an OSCORE-protected CoAP message.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">That is, the EDHOC + OSCORE request is composed of the following two
      parts combined together in a single CoAP message. The steps for
      processing the EDHOC + OSCORE request and the two parts combined in the
      request itself are defined in Sections <a href="#client-processing" class="auto internal xref">3.2.1</a> and <a href="#server-processing" class="auto internal xref">3.3.1</a>.<a href="#section-3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">The OSCORE Request from <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, which, in this case, is also sent to a protected resource with the correct CoAP method and options intended for accessing that resource.<a href="#section-3-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-8.2">
          <p id="section-3-8.2.1">EDHOC data consisting of the pair (C_R, EDHOC message_3) required for completing the EDHOC session transported as follows:<a href="#section-3-8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.2.2.1">C_R is the OSCORE Sender ID of the client; hence, it is transported in the 'kid' field of the OSCORE option (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>). Unlike the sequential workflow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, C_R is not transported in the payload of the EDHOC + OSCORE request.<a href="#section-3-8.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3-8.2.2.2">EDHOC message_3 is transported in the payload of the EDHOC + OSCORE request and prepended to the payload of the OSCORE Request. This is because EDHOC message_3 may be too large to be included in a CoAP option, e.g., when conveying a large public key certificate chain in the ID_CRED_I field (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), or when conveying large External Authorization Data in the EAD_3 field (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-3-8.2.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-3-9">The rest of this section specifies how to transport the data in the EDHOC + OSCORE request and their processing order. In particular, the use of this approach is explicitly signalled by including an EDHOC option (<a href="#edhoc-option" class="auto internal xref">Section 3.1</a>) in the EDHOC + OSCORE request. The processing of the EDHOC + OSCORE request is specified in <a href="#client-processing-intro" class="auto internal xref">Section 3.2</a> for the client side and in <a href="#server-processing-intro" class="auto internal xref">Section 3.3</a> for the server side.<a href="#section-3-9" class="pilcrow">¶</a></p>
<div id="edhoc-option">
<section id="section-3.1">
        <h3 id="name-edhoc-option">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-edhoc-option" class="section-name selfRef">EDHOC Option</a>
        </h3>
<p id="section-3.1-1">This section defines the EDHOC option. This option is used in a CoAP request to signal that the request payload conveys both an EDHOC message_3 and OSCORE-protected data combined together.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The EDHOC option has the properties summarized in <a href="#fig-edhoc-option" class="auto internal xref">Table 1</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.
The option is Critical, Safe-to-Forward, and part of the Cache-Key.  The option <span class="bcp14">MUST</span> occur at most once and <span class="bcp14">MUST</span> be empty. If any value is sent, the recipient <span class="bcp14">MUST</span> ignore it. (Future documents may update the definition of the option by expanding its semantics and specifying admitted values.) The option is intended only for CoAP requests and is of Class U for OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-the-edhoc-option-ccritical-"></span><div id="fig-edhoc-option">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-the-edhoc-option-ccritical-" class="selfRef">The EDHOC Option. C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">Empty</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-4">The presence of this option means that the message payload also contains EDHOC data that must be extracted and processed as defined in <a href="#server-processing-intro" class="auto internal xref">Section 3.3</a> before the rest of the message can be processed.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"><a href="#fig-edhoc-opt" class="auto internal xref">Figure 3</a> shows an example of a CoAP message that is transported over UDP and that contains both the EDHOC data and the OSCORE ciphertext using the newly defined EDHOC option for signalling.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-example-of-a-coap-message-c"></span><div id="fig-edhoc-opt">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-3.1-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ver| T |  TKL  |      Code     |          Message ID           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Token (if any, TKL bytes) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Observe Option| OSCORE Option ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| EDHOC Option  | Other Options (if any) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1 1 1 1 1 1 1 1| Payload ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-a-coap-message-c" class="selfRef">Example of a CoAP Message Containing the Combined EDHOC and OSCORE Data, Signalled by the EDHOC Option and Transported over UDP</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="client-processing-intro">
<section id="section-3.2">
        <h3 id="name-client-processing">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-processing" class="section-name selfRef">Client Processing</a>
        </h3>
<p id="section-3.2-1">This section describes the processing on the client side.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="client-processing">
<section id="section-3.2.1">
          <h4 id="name-processing-of-the-edhoc-osc">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-processing-of-the-edhoc-osc" class="section-name selfRef">Processing of the EDHOC + OSCORE Request</a>
          </h4>
<p id="section-3.2.1-1">The client prepares an EDHOC + OSCORE request as follows.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2.1-2">
<dt>Step 1.</dt>
<dd id="section-3.2.1-2.1" style="margin-left: 4.5em">
<div id="L1S1">Compose EDHOC message_3 into EDHOC_MSG_3 as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.2" class="relref">Section 5.4.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#L1S1" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-3.2.1-2.2" style="margin-left: 4.5em">
<div id="L1S2">
              <p id="section-3.2.1-2.2.1">Establish the new OSCORE Security Context and use it to encrypt the original CoAP request as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.2.2">
Note that the OSCORE ciphertext is not computed over EDHOC message_3, which is not protected by OSCORE. That is, the result of this step is the OSCORE Request as in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>.<a href="#section-3.2.1-2.2.2" class="pilcrow">¶</a></p>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-3.2.1-2.3" style="margin-left: 4.5em">
<div id="L1S3">
              <p id="section-3.2.1-2.3.1">Build COMB_PAYLOAD as the concatenation of EDHOC_MSG_3 and OSCORE_PAYLOAD in the order of COMB_PAYLOAD = EDHOC_MSG_3 | OSCORE_PAYLOAD, where | denotes byte string concatenation and:<a href="#section-3.2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.3.2.1">EDHOC_MSG_3 is the binary encoding of EDHOC message_3 resulting from <a href="#L1S1" class="internal xref">Step 1</a>. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.1" class="relref">Section 5.4.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC message_3 consists of one CBOR data item CIPHERTEXT_3, which is a CBOR byte string. Therefore, EDHOC_MSG_3 is the binary encoding of CIPHERTEXT_3.<a href="#section-3.2.1-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.2.1-2.3.2.2">OSCORE_PAYLOAD is the OSCORE ciphertext of the OSCORE-protected CoAP request resulting from <a href="#L1S2" class="internal xref">Step 2</a>.<a href="#section-3.2.1-2.3.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 4.</dt>
<dd id="section-3.2.1-2.4" style="margin-left: 4.5em">
<div id="L1S4">
              <p id="section-3.2.1-2.4.1">Compose the EDHOC + OSCORE request, as the OSCORE-protected CoAP request resulting from <a href="#L1S2" class="internal xref">Step 2</a>, where the payload is replaced with COMB_PAYLOAD built at <a href="#L1S3" class="internal xref">Step 3</a>.<a href="#section-3.2.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.4.2">
 Note that the new payload includes EDHOC message_3, but it does not include the EDHOC connection identifier C_R.
   As the client is the EDHOC Initiator, C_R is the OSCORE Sender ID of
   the client, which is already specified as the value of the 'kid' field in the OSCORE option of the
   request from <a href="#L1S2" class="internal xref">Step 2</a>; hence, C_R is specified as the value of the 'kid' field of the EDHOC + OSCORE request.<a href="#section-3.2.1-2.4.2" class="pilcrow">¶</a></p>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-3.2.1-2.5" style="margin-left: 4.5em">
<div id="L1S5">
              <p id="section-3.2.1-2.5.1">Include the new EDHOC option defined in <a href="#edhoc-option" class="auto internal xref">Section 3.1</a> into the EDHOC + OSCORE request.<a href="#section-3.2.1-2.5.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.5.2">
The application/cid-edhoc+cbor-seq media type does not apply to this message, whose media type is unnamed.<a href="#section-3.2.1-2.5.2" class="pilcrow">¶</a></p>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 6.</dt>
<dd id="section-3.2.1-2.6" style="margin-left: 4.5em">
<div id="L1S6">Send the EDHOC + OSCORE request to the server.<a href="#L1S6" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
</dl>
<p id="section-3.2.1-3">With the same server, the client <span class="bcp14">SHOULD NOT</span> have multiple simultaneous outstanding interactions (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.7" class="relref">Section 4.7</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>), such that they consist of an EDHOC + OSCORE request and their EDHOC data pertains to the EDHOC session with the same connection identifier C_R.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">An exception might apply for clients that operate under particular time constraints over particularly unreliable networks, thus raising the chances to promptly complete the EDHOC execution with the server through multiple simultaneous EDHOC + OSCORE requests. As discussed in <a href="#security-considerations" class="auto internal xref">Section 7</a>, this does not have any impact in terms of security.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-blockwise">
<section id="section-3.2.2">
          <h4 id="name-supporting-block-wise-trans">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-supporting-block-wise-trans" class="section-name selfRef">Supporting Block-Wise Transfers</a>
          </h4>
<p id="section-3.2.2-1">If Block-wise transfers <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> are supported, the client may fragment the first CoAP application request before protecting it as an original message with OSCORE as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4.1" class="relref">Section 4.1.3.4.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">In such a case, the OSCORE processing in <a href="#L1S2" class="internal xref">Step 2</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a> is performed on each inner block of the first CoAP application request. The following also applies.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">The client takes the following additional step between Steps <a href="#L1S2" class="internal xref">2</a> and <a href="#L1S3" class="internal xref">3</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2.2-3.1.2">
<dt>Step 2.1.</dt>
<dd style="margin-left: 5.0em" id="section-3.2.2-3.1.2.1">If the OSCORE-protected request from <a href="#L1S2" class="internal xref">Step 2</a> conveys a non-first inner block of the first CoAP application request (i.e., the Block1 option processed at Step 2 had NUM different than 0), then the client skips the following steps and sends the OSCORE-protected request to the server. In particular, the client <span class="bcp14">MUST NOT</span> include the EDHOC option in the OSCORE-protected request.<a href="#section-3.2.2-3.1.2.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
            <li class="normal" id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">The client takes the following additional step between Steps <a href="#L1S3" class="internal xref">3</a> and <a href="#L1S4" class="internal xref">4</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2.2-3.2.2">
<dt>Step 3.1.</dt>
<dd style="margin-left: 5.0em" id="section-3.2.2-3.2.2.1">
If the size of COMB_PAYLOAD exceeds MAX_UNFRAGMENTED_SIZE (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4.2" class="relref">Section 4.1.3.4.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), the client <span class="bcp14">MUST</span> stop processing the request and <span class="bcp14">MUST</span> abandon the Block-wise transfer. Then, the client can continue by switching to the sequential workflow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>. That is, the client first sends EDHOC message_3 prepended by the EDHOC connection identifier C_R encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. Then, the client sends the OSCORE-protected CoAP request once the EDHOC execution is completed.<a href="#section-3.2.2-3.2.2.1" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-3.2.2-4">The performance advantage of using the EDHOC + OSCORE request can be lost when used in combination with Block-wise transfers that rely on specific parameter values and block sizes. Application policies at the CoAP client can define when and how to detect whether the performance advantage is lost. If that is the case, they can also define whether to appropriately adjust the parameter values and block sizes or  to fall back on the sequential workflow of EDHOC.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="server-processing-intro">
<section id="section-3.3">
        <h3 id="name-server-processing">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-server-processing" class="section-name selfRef">Server Processing</a>
        </h3>
<p id="section-3.3-1">This section describes the processing on the server side.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="server-processing">
<section id="section-3.3.1">
          <h4 id="name-processing-of-the-edhoc-osco">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-processing-of-the-edhoc-osco" class="section-name selfRef">Processing of the EDHOC + OSCORE Request</a>
          </h4>
<p id="section-3.3.1-1">In order to process a request containing the EDHOC option, i.e., an EDHOC + OSCORE request, the server <span class="bcp14">MUST</span> perform the following steps.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3.1-2">
<dt>Step 1.</dt>
<dd id="section-3.3.1-2.1" style="margin-left: 4.5em">
<div id="L2S1">Check that the EDHOC + OSCORE request includes the OSCORE option and that the request payload has the format defined at <a href="#L1S3" class="internal xref">Step 3</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a> for COMB_PAYLOAD. If this is not the case, the server <span class="bcp14">MUST</span> stop processing the request and <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#L2S1" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 2.</dt>
<dd id="section-3.3.1-2.2" style="margin-left: 4.5em">
<div id="L2S2">Extract EDHOC message_3 from the payload COMB_PAYLOAD of the EDHOC + OSCORE request as the first element EDHOC_MSG_3 (see <a href="#L1S3" class="internal xref">Step 3</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>).<a href="#L2S2" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 3.</dt>
<dd id="section-3.3.1-2.3" style="margin-left: 4.5em">
<div id="L2S3">Take the value of the 'kid' field from the OSCORE option of the EDHOC + OSCORE request (i.e., the OSCORE Sender ID of the client), and use it as the EDHOC connection identifier C_R.<a href="#L2S3" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 4.</dt>
<dd id="section-3.3.1-2.4" style="margin-left: 4.5em">
<div id="L2S4">
              <p id="section-3.3.1-2.4.1">Retrieve the correct EDHOC session by using the connection identifier C_R from <a href="#L2S3" class="internal xref">Step 3</a>.<a href="#section-3.3.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.2">
If the application profile used in the EDHOC session specifies that EDHOC message_4 shall be sent, the server <span class="bcp14">MUST</span> stop the EDHOC processing and consider it failed due to a client error.<a href="#section-3.3.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.3">
Otherwise, perform the EDHOC processing on the EDHOC message_3 extracted at <a href="#L2S2" class="internal xref">Step 2</a> as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> based on the protocol state of the retrieved EDHOC session.<a href="#section-3.3.1-2.4.3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.4">
The application profile used in the EDHOC session is the same one associated with the EDHOC resource where the server received the request conveying EDHOC message_1 that started the session. This is relevant in case the server provides multiple EDHOC resources that  may generally refer to different application profiles.<a href="#section-3.3.1-2.4.4" class="pilcrow">¶</a></p>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 5.</dt>
<dd id="section-3.3.1-2.5" style="margin-left: 4.5em">
<div id="L2S5">Establish a new OSCORE Security Context associated with the client as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> using the EDHOC output from <a href="#L2S4" class="internal xref">Step 4</a>.<a href="#L2S5" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 6.</dt>
<dd id="section-3.3.1-2.6" style="margin-left: 4.5em">
<div id="L2S6">Extract the OSCORE ciphertext from the payload COMB_PAYLOAD of the EDHOC + OSCORE request as the second element OSCORE_PAYLOAD (see <a href="#L1S3" class="internal xref">Step 3</a> of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>).<a href="#L2S6" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 7.</dt>
<dd id="section-3.3.1-2.7" style="margin-left: 4.5em">
<div id="L2S7">Rebuild the OSCORE-protected CoAP request as the EDHOC + OSCORE request, where the payload is replaced with the OSCORE ciphertext extracted at <a href="#L2S6" class="internal xref">Step 6</a>. Then, remove the EDHOC option.<a href="#L2S7" class="pilcrow">¶</a>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 8.</dt>
<dd id="section-3.3.1-2.8" style="margin-left: 4.5em">
<div id="L2S8">
              <p id="section-3.3.1-2.8.1">Decrypt and verify the OSCORE-protected CoAP request rebuilt at <a href="#L2S7" class="internal xref">Step 7</a> as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> by using the OSCORE Security Context established at <a href="#L2S5" class="internal xref">Step 5.</a><a href="#section-3.3.1-2.8.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.8.2">
When the decrypted request is checked for any critical CoAP options (as it is during regular CoAP processing), the presence of an EDHOC option <span class="bcp14">MUST</span> be regarded as an unprocessed critical option unless it is processed by some further mechanism.<a href="#section-3.3.1-2.8.2" class="pilcrow">¶</a></p>
</div>
            </dd>
<dd class="break"></dd>
<dt>Step 9.</dt>
<dd id="section-3.3.1-2.9" style="margin-left: 4.5em">
<div id="L2S9">Deliver the CoAP request resulting from <a href="#L2S8" class="internal xref">Step 8</a> to the application.<a href="#L2S9" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
</dl>
<p id="section-3.3.1-3">If Steps <a href="#L2S4" class="internal xref">4</a> (EDHOC processing) and <a href="#L2S8" class="internal xref">8</a> (OSCORE processing) are both successfully completed, the server <span class="bcp14">MUST</span> reply with an OSCORE-protected response (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). The usage of EDHOC message_4 as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is not applicable to the approach defined in this document.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">If <a href="#L2S4" class="internal xref">Step 4</a> (EDHOC processing) fails, the server aborts the session as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> and responds with an EDHOC error message with error code 1, which is formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The server <span class="bcp14">MUST NOT</span> establish a new OSCORE Security Context from the present EDHOC session with the client. The CoAP response conveying the EDHOC error message is not protected with OSCORE. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.5" class="relref">Section 9.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, the server has to make sure that the error message does not reveal sensitive information. The CoAP response conveying the EDHOC error message <span class="bcp14">MUST</span> have Content-Format set to application/edhoc+cbor-seq registered in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.9" class="relref">Section 10.9</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">If <a href="#L2S4" class="internal xref">Step 4</a> (EDHOC processing) is successfully completed but <a href="#L2S8" class="internal xref">Step 8</a> (OSCORE processing) fails, the same OSCORE error handling as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> applies.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-blockwise">
<section id="section-3.3.2">
          <h4 id="name-supporting-block-wise-transf">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-supporting-block-wise-transf" class="section-name selfRef">Supporting Block-Wise Transfers</a>
          </h4>
<p id="section-3.3.2-1">If Block-wise transfers <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> are supported, the server takes the additional following step before any other in <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3.2-2">
          <dt>Step 0.</dt>
<dd style="margin-left: 4.5em" id="section-3.3.2-2.1">If a Block option is present in the request, then process the Outer Block options according to <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> until all blocks of the request have been received (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4" class="relref">Section 4.1.3.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-3.3.2-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="example">
<section id="section-3.4">
        <h3 id="name-example-of-the-edhoc-oscore">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-example-of-the-edhoc-oscore" class="section-name selfRef">Example of the EDHOC + OSCORE Request</a>
        </h3>
<p id="section-3.4-1"><a href="#fig-edhoc-opt-2" class="auto internal xref">Figure 4</a> shows an example of an EDHOC + OSCORE request transported over UDP. In particular, the example assumes that:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">The OSCORE Partial IV in use is 0 consistently with the first request protected with the new OSCORE Security Context.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The OSCORE Sender ID of the client is 0x01.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.2">
As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this straightforwardly corresponds to the EDHOC connection identifier C_R 0x01.<a href="#section-3.4-2.2.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.3">
As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, when using the sequential flow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, the same C_R with a value of 0x01 would be encoded on the wire as the CBOR integer 1 (0x01 in CBOR encoding) and prepended to EDHOC message_3 in the payload of the second EDHOC request.<a href="#section-3.4-2.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">This results in the following components shown in <a href="#fig-edhoc-opt-2" class="auto internal xref">Figure 4</a>:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-4">
          <dt id="section-3.4-4.1">OSCORE option value:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-4.2">0x090001 (3 bytes)<a href="#section-3.4-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-4.3">EDHOC option value:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-4.4">- (0 bytes)<a href="#section-3.4-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-4.5">EDHOC message_3:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-4.6">0x52d5535f3147e85f1cfacd9e78abf9e0a81bbf (19 bytes)<a href="#section-3.4-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-4.7">OSCORE ciphertext:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-4.8">0x612f1092f1776f1c1668b3825e (13 bytes)<a href="#section-3.4-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-example-of-a-protected-coap"></span><div id="fig-edhoc-opt-2">
<figure id="figure-4">
          <div class="lang-coap sourcecode" id="section-3.4-5.1">
<pre>
   0x44025d1f               ; CoAP 4-byte Header
     00003974               ; Token
     93 090001              ; OSCORE Option
     c0                     ; EDHOC Option
     ff 52d5535f3147e85f1cfacd9e78abf9e0a81bbf
        612f1092f1776f1c1668b3825e
   (46 bytes)
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-a-protected-coap" class="selfRef">Example of a Protected CoAP Request Combining EDHOC and OSCORE Data</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="use-of-ids">
<section id="section-4">
      <h2 id="name-use-of-edhoc-connection-ide">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-use-of-edhoc-connection-ide" class="section-name selfRef">Use of EDHOC Connection Identifiers with OSCORE</a>
      </h2>
<p id="section-4-1">The OSCORE Sender/Recipient IDs are the EDHOC connection identifiers (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). This applies also to the optimized workflow defined in <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a> of this document.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Note that the value of the 'kid' field in the OSCORE option of the EDHOC + OSCORE request is both the server's Recipient ID (i.e., the client's Sender ID) and the EDHOC connection identifier C_R of the server at <a href="#L2S3" class="internal xref">Step 3</a> of <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="oscore-edhoc-message-processing">
<section id="section-4.1">
        <h3 id="name-additional-processing-of-ed">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-additional-processing-of-ed" class="section-name selfRef">Additional Processing of EDHOC Messages</a>
        </h3>
<p id="section-4.1-1">When using EDHOC to establish an OSCORE Security Context, the client and server <span class="bcp14">MUST</span> perform the following additional steps during an EDHOC execution, thus extending <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5" class="relref">Section 5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="initiator-processing-of-message-1">
<section id="section-4.1.1">
          <h4 id="name-initiator-processing-of-mes">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-initiator-processing-of-mes" class="section-name selfRef">Initiator Processing of Message 1</a>
          </h4>
<p id="section-4.1.1-1">The Initiator selects an EDHOC connection identifier C_I as follows.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">The Initiator <span class="bcp14">MUST</span> choose a C_I that is neither used in any current EDHOC session as this peer's EDHOC connection identifier nor the Recipient ID in a current OSCORE Security Context where the ID Context is not present.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">The chosen C_I <span class="bcp14">SHOULD NOT</span> be the Recipient ID of any current OSCORE Security Context. Note that, unless the two peers concurrently use alternative methods to establish OSCORE Security Contexts, this allows the Responder to always omit the 'kid context' in the OSCORE option of its messages sent to the Initiator when protecting those with an OSCORE Security Context where C_I is the Responder's OSCORE Sender ID (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="responder-processing-of-message-2">
<section id="section-4.1.2">
          <h4 id="name-responder-processing-of-mes">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-responder-processing-of-mes" class="section-name selfRef">Responder Processing of Message 2</a>
          </h4>
<p id="section-4.1.2-1">The Responder selects an EDHOC connection identifier C_R as follows.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The Responder <span class="bcp14">MUST</span> choose a C_R that is none of the following:<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-3.1">used in any current EDHOC session as this peer's EDHOC connection identifier,<a href="#section-4.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-3.2">equal to the EDHOC connection identifier C_I specified in the EDHOC message_1 of the present EDHOC session, or<a href="#section-4.1.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-3.3">the Recipient ID in a current OSCORE Security Context where the ID Context is not present.<a href="#section-4.1.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.2-4">The chosen C_R <span class="bcp14">SHOULD NOT</span> be the Recipient ID of any current OSCORE Security Context. Note that, for a reason analogous to the one given in <a href="#initiator-processing-of-message-1" class="auto internal xref">Section 4.1.1</a> with C_I, this allows the Initiator to always omit the 'kid context' in the OSCORE option of its messages sent to the Responder when protecting those with an OSCORE Security Context where C_R is the Initiator's OSCORE Sender ID (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiator-processing-of-message-2">
<section id="section-4.1.3">
          <h4 id="name-initiator-processing-of-mess">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-initiator-processing-of-mess" class="section-name selfRef">Initiator Processing of Message 2</a>
          </h4>
<p id="section-4.1.3-1">If the EDHOC connection identifier C_I is equal to the EDHOC connection identifier C_R specified in EDHOC message_2, then the Initiator <span class="bcp14">MUST</span> abort the session and reply with an EDHOC error message with error code 1 formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="app-statements">
<section id="section-5">
      <h2 id="name-extension-and-consistency-o">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-extension-and-consistency-o" class="section-name selfRef">Extension and Consistency of Application Profiles</a>
      </h2>
<p id="section-5-1">It is possible to include the information below in the application profile referred by the client and server according to the specified consistency rules.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If the server supports the EDHOC + OSCORE request within an EDHOC execution started at a certain EDHOC resource, then the application profile associated with that resource <span class="bcp14">SHOULD</span> explicitly specify support for the EDHOC + OSCORE request.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">In the case where the application profile indicates that the server supports the optional EDHOC message_4 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), it is still possible to use the optimized workflow based on the EDHOC + OSCORE request. However, this means that the server is not going to send EDHOC message_4 since it is not applicable to the optimized workflow (see <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>).<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Also, in the case where the application profile indicates that the server shall send EDHOC message_4, the application profile <span class="bcp14">MUST NOT</span> specify support for the EDHOC + OSCORE request. There is no point for the client to use the optimized workflow that is bound to fail (see <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>).<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="web-linking">
<section id="section-6">
      <h2 id="name-web-linking">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-web-linking" class="section-name selfRef">Web Linking</a>
      </h2>
<p id="section-6-1"><span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.10" class="relref">Section 10.10</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> registers the resource type "core.edhoc", which can be used as target attribute in a web link <span>[<a href="#RFC8288" class="cite xref">RFC8288</a>]</span> to an EDHOC resource, e.g., using a link-format document <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>. This enables clients to discover the presence of EDHOC resources at a server, possibly using the resource type as a filter criterion.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">At the same time, the application profile associated with an EDHOC resource provides information describing how the EDHOC protocol can be used through that resource. A client may become aware of the application profile, e.g., by obtaining its information elements upon discovering the EDHOC resources at the server. 
This allows the client to discover the EDHOC resources whose associated application profile denotes a way of using EDHOC that is most suitable to the client, e.g., with EDHOC cipher suites or authentication methods that the client also supports or prefers.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">That is, while discovering an EDHOC resource, a client can contextually obtain relevant pieces of information from the application profile associated with that resource. The resource discovery can occur by means of a direct interaction with the server or by means of the CoRE Resource Directory <span>[<a href="#RFC9176" class="cite xref">RFC9176</a>]</span> where the server may have registered the links to its resources.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">In order to enable the above, this section defines a number of parameters, each of which can be optionally specified as a target attribute with the same name in the link to the respective EDHOC resource or as filter criterion in a discovery request from the client. When specifying these parameters in a link to an EDHOC resource, the target attribute rt="core.edhoc" <span class="bcp14">MUST</span> be included and the same consistency rules defined in <a href="#app-statements" class="auto internal xref">Section 5</a> for the corresponding information elements of an application profile <span class="bcp14">MUST</span> be followed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The following parameters are defined.<a href="#section-6-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-6">
        <dt id="section-6-6.1">'ed-i':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.2">If present, specifies that the server supports the EDHOC Initiator role, hence the reverse message flow of EDHOC. A value <span class="bcp14">MUST NOT</span> be given to this parameter and any present value <span class="bcp14">MUST</span> be ignored by the recipient.<a href="#section-6-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.3">'ed-r':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.4">If present, specifies that the server supports the EDHOC Responder role, hence the forward message flow of EDHOC. A value <span class="bcp14">MUST NOT</span> be given to this parameter and any present value <span class="bcp14">MUST</span> be ignored by the recipient.<a href="#section-6-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.5">'ed-method':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.6">Specifies an authentication method supported by the server. This parameter <span class="bcp14">MUST</span> specify a single value, which is taken from the 'Value' column of the "EDHOC Method Type" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.3" class="relref">Section 10.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter <span class="bcp14">MAY</span> occur multiple times, with each occurrence specifying an authentication method.<a href="#section-6-6.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.7">'ed-csuite':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.8">Specifies an EDHOC cipher suite supported by the server. This parameter <span class="bcp14">MUST</span> specify a single value, which is taken from the 'Value' column of the "EDHOC Cipher Suites" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.2" class="relref">Section 10.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter <span class="bcp14">MAY</span> occur multiple times, with each occurrence specifying a cipher suite.<a href="#section-6-6.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.9">'ed-cred-t':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.10">Specifies a type of authentication credential supported by the server. This parameter <span class="bcp14">MUST</span> specify a single value, which is taken from the 'Value' column of the "EDHOC Authentication Credential Types" Registry defined in <a href="#iana-edhoc-auth-cred-types" class="auto internal xref">Section 8.3</a> of this document. This parameter <span class="bcp14">MAY</span> occur multiple times, with each occurrence specifying a type of authentication credential.<a href="#section-6-6.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.11">'ed-idcred-t':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.12">
          <p id="section-6-6.12.1">Specifies a type of identifier supported by the server for identifying authentication credentials. This parameter <span class="bcp14">MUST</span> specify a single value, which is taken from the 'Label' column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>. This parameter <span class="bcp14">MAY</span> occur multiple times, with each occurrence specifying a type of identifier for authentication credentials.<a href="#section-6-6.12.1" class="pilcrow">¶</a></p>
<p id="section-6-6.12.2">
Note that the values in the 'Label' column of the "COSE Header Parameters" registry are strongly typed. On the contrary, CoRE Link Format is weakly typed; thus, it does not distinguish between, for instance, the string value "-10" and the integer value -10. Therefore, if responses in CoRE Link Format are returned, string values that look like an integer are not supported. Thus, such values <span class="bcp14">MUST NOT</span> be used in the 'ed-idcred-t' parameter.<a href="#section-6-6.12.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.13">'ed-ead':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.14">Specifies the support of the server for an External Authorization Data (EAD) item (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). This parameter <span class="bcp14">MUST</span> specify a single value, which is taken from the 'Label' column of the "EDHOC External Authorization Data" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.5" class="relref">Section 10.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter <span class="bcp14">MAY</span> occur multiple times, with each occurrence specifying the ead_label of an EAD item that the server supports.<a href="#section-6-6.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-6.15">'ed-comb-req':</dt>
        <dd style="margin-left: 1.5em" id="section-6-6.16">If present, specifies that the server supports the EDHOC + OSCORE request defined in <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a>. A value <span class="bcp14">MUST NOT</span> be given to this parameter and any present value <span class="bcp14">MUST</span> be ignored by the recipient.<a href="#section-6-6.16" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-7">Future documents may update the definition of the parameters 'ed-i', 'ed-r', and 'ed-comb-req' by expanding their semantics and specifying what they can take as value.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The example in <a href="#fig-web-link-example" class="auto internal xref">Figure 5</a> shows how a client discovers one EDHOC resource at a server and obtains information elements from the respective application profile. The CoRE Link Format notation from <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="cite xref">RFC6690</a>]</span> is used.<a href="#section-6-8" class="pilcrow">¶</a></p>
<span id="name-the-web-link"></span><div id="fig-web-link-example">
<figure id="figure-5">
        <div class="alignCenter art-text artwork" id="section-6-9.1">
<pre>
REQ: GET /.well-known/core

RES: 2.05 Content
    &lt;/sensors/temp&gt;;osc,
    &lt;/sensors/light&gt;;if=sensor,
    &lt;/.well-known/edhoc&gt;;rt=core.edhoc;ed-csuite=0;ed-csuite=2;
        ed-method=0;ed-cred-t=0;ed-cred-t=1;ed-idcred-t=4;
        ed-i;ed-r;ed-comb-req
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-the-web-link" class="selfRef">The Web Link</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The same security considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> hold for this document. In addition, the following considerations apply.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"><a href="#client-processing" class="auto internal xref">Section 3.2.1</a> specifies that a client <span class="bcp14">SHOULD NOT</span> have multiple outstanding EDHOC + OSCORE requests pertaining to the same EDHOC session. Even if a client did not fulfill this requirement, it would not have any impact in terms of security. That is, the server would still not process different instances of the same EDHOC message_3 more than once in the same EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and would still enforce replay protection of the OSCORE-protected request (see Sections <a href="https://rfc-editor.org/rfc/rfc8613#section-7.4" class="relref">7.4</a> and <a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">8.2</a> of <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">When using the optimized workflow in <a href="#fig-combined" class="auto internal xref">Figure 2</a>, a minimum of 128-bit security against online brute-force attacks is achieved after the client receives and successfully verifies the first OSCORE-protected response (see Sections <a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">9.1</a> and <a href="https://rfc-editor.org/rfc/rfc9528#section-9.4" class="relref">9.4</a> of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). As an example, if EDHOC is used with method 3 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and cipher suite 2 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), then the following holds:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">The Initiator is authenticated with 128-bit security against online attacks. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this results from the combination of the strength of the 64-bit Message Authentication Code (MAC) in EDHOC message_3 and of the 64-bit MAC in the Authenticated Encryption with Associated Data (AEAD) of the first OSCORE-protected CoAP request as rebuilt at <a href="#L2S7" class="internal xref">Step 7</a> of <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">The Responder is authenticated with 128-bit security against online attacks. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this results from the combination of the strength of the 64-bit MAC in EDHOC message_2 and of the 64-bit MAC in the AEAD of the first OSCORE-protected CoAP response.<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-5">With reference to the sequential workflow in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, the OSCORE request might have to undergo access-control checks at the server before being actually executed for accessing the target protected resource. The same <span class="bcp14">MUST</span> hold when the optimized workflow in <a href="#fig-combined" class="auto internal xref">Figure 2</a> is used, i.e., when using the EDHOC + OSCORE request.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">That is, the rebuilt OSCORE-protected application request from <a href="#L2S7" class="internal xref">Step 7</a> in <a href="#server-processing" class="auto internal xref">Section 3.3.1</a> <span class="bcp14">MUST</span> undergo the same access-control checks that would be performed on a traditional OSCORE-protected application request sent individually as shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">To this end, validated information to perform access-control checks (e.g., an access token issued by a trusted party) has to be available at the server before starting to process the rebuilt OSCORE-protected application request. Such information may have been provided to the server separately before starting the EDHOC execution altogether, or instead as External Authorization Data during the EDHOC execution (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">Thus, a successful completion of the EDHOC protocol and the following derivation of the OSCORE Security Context at the server do not play a role in determining whether the rebuilt OSCORE-protected request is authorized to access the target protected resource at the server.<a href="#section-7-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has the following actions for IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="iana-coap-options">
<section id="section-8.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-8.1-1">IANA has registered the following option number in the "CoAP Option Numbers" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-registration-in-the-coap-op"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-registration-in-the-coap-op" class="selfRef">Registration in the "CoAP Option Numbers" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9668</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-target-attributes">
<section id="section-8.2">
        <h3 id="name-target-attributes-registry">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-target-attributes-registry" class="section-name selfRef">Target Attributes Registry</a>
        </h3>
<p id="section-8.2-1">IANA has registered the following entries in the "Target Attributes" registry <span>[<a href="#CORE.Target.Attributes" class="cite xref">CORE.Target.Attributes</a>]</span> within the "Constrained RESTful Environments (CoRE) Parameters" registry group as per <span>[<a href="#RFC9423" class="cite xref">RFC9423</a>]</span>.
For all entries, the Change Controller is IETF and the reference is RFC 9668.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-registrations-in-the-target"></span><table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-registrations-in-the-target" class="selfRef">Registrations in the "Target Attributes" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute Name</th>
              <th class="text-left" rowspan="1" colspan="1">Brief Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-i</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC Initiator role</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-r</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC Responder role</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-method</td>
              <td class="text-left" rowspan="1" colspan="1">A supported authentication method for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-csuite</td>
              <td class="text-left" rowspan="1" colspan="1">A supported cipher suite for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-cred-t</td>
              <td class="text-left" rowspan="1" colspan="1">A supported type of authentication credential for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-idcred-t</td>
              <td class="text-left" rowspan="1" colspan="1">A supported type of authentication credential identifier for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-ead</td>
              <td class="text-left" rowspan="1" colspan="1">A supported External Authorization Data (EAD) item for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-comb-req</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC + OSCORE request</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-edhoc-auth-cred-types">
<section id="section-8.3">
        <h3 id="name-edhoc-authentication-creden">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-edhoc-authentication-creden" class="section-name selfRef">EDHOC Authentication Credential Types Registry</a>
        </h3>
<p id="section-8.3-1">IANA has created the "EDHOC Authentication Credential Types" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The registration policy is either "Private Use", "Standards Action with Expert Review", or "Specification Required" per <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. "Expert Review" guidelines are provided in <a href="#review" class="auto internal xref">Section 8.4</a>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">All assignments according to "Standards Action with Expert Review"
        are made on a "Standards Action" basis per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">Section 4.9</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> with "Expert Review"
        additionally required per <span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The procedure for early IANA allocation of
        "standards track code points" defined in <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span> also
        applies.  When such a procedure is used, IANA will ask the designated
        expert(s) to approve the early allocation before registration. In
        addition, working group chairs are encouraged to consult the expert(s)
        early during the process outlined in <span><a href="https://rfc-editor.org/rfc/rfc7120#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">The columns of this registry are:<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.3-5">
          <dt id="section-8.3-5.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-8.3-5.2">
            <p id="section-8.3-5.2.1">This field contains the value used to identify the type of authentication credential. These values <span class="bcp14">MUST</span> be unique. The value can be an unsigned integer or a negative integer. Different ranges of values use different registration policies:<a href="#section-8.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-5.2.2.1">Integer values from -24 to 23 are designated as "Standards Action With Expert Review".<a href="#section-8.3-5.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-8.3-5.2.2.2">Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required".<a href="#section-8.3-5.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-8.3-5.2.2.3">Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-8.3-5.2.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-5.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-8.3-5.4">This field contains a short description of the type of authentication credential.<a href="#section-8.3-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-5.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-8.3-5.6">This field contains a pointer to the public specification for the type of authentication credential.<a href="#section-8.3-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-initial-entries-in-the-edho"></span><div id="pre-reg">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-initial-entries-in-the-edho" class="selfRef">Initial Entries in the "EDHOC Authentication Credential Types" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims. CWT is defined in RFC 8392.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims. CCS is defined in RFC 8392.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">X.509 certificate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="review">
<section id="section-8.4">
        <h3 id="name-expert-review-instructions">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-8.4-1">"Standards Action with Expert Review" and "Specification Required" are two of the registration policies defined for the IANA registry established in <a href="#iana-edhoc-auth-cred-types" class="auto internal xref">Section 8.3</a>.
This section gives some general guidelines for what the experts should be looking for; however, they are being designated as experts for a reason, so they should be given substantial latitude.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Expert reviewers should take into consideration the following points:<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.1">Clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Experts need to make sure that registered identifiers indicate a type of authentication credential whose format and encoding is clearly defined in the corresponding specification. Identifiers of types of authentication credentials that do not meet these objectives of clarity and completeness must not be registered.<a href="#section-8.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.2">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as "Private Use" are intended for testing purposes and closed environments. Code points in other ranges should not be assigned for testing.<a href="#section-8.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.3">Specifications are required for the "Standards Action With Expert Review" range of point assignment. Specifications should exist for "Specification Required" ranges, but early assignment before a specification is available is considered to be permissible. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-8.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.4">Experts should take into account the expected usage of fields
          when approving point assignment. Documents published via Standards
          Action can also register points outside the Standards Action
          range. The length of the encoded value should be weighed against how
          many code points of that length are left, the size of device it will
          be used on, and the number of code points left that encode to that
          size.<a href="#section-8.4-3.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CORE.Target.Attributes">[CORE.Target.Attributes]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Target Attributes"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7120">[RFC7120]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refTitle">"Early IANA Allocation of Standards Track Code Points"</span>, <span class="seriesInfo">BCP 100</span>, <span class="seriesInfo">RFC 7120</span>, <span class="seriesInfo">DOI 10.17487/RFC7120</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7120">https://www.rfc-editor.org/info/rfc7120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8288">https://www.rfc-editor.org/info/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
        <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9176">https://www.rfc-editor.org/info/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9528">https://www.rfc-editor.org/info/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9423">[RFC9423]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Target Attributes Registry"</span>, <span class="seriesInfo">RFC 9423</span>, <span class="seriesInfo">DOI 10.17487/RFC9423</span>, <time datetime="2024-04" class="refDate">April 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9423">https://www.rfc-editor.org/info/rfc9423</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Emmanuel Baccelli</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Esko Dijk</span>, <span class="contact-name">Joel Halpern</span>, <span class="contact-name">Wes Hardaker</span>, <span class="contact-name">Klaus Hartke</span>, <span class="contact-name">John Preuß Mattsson</span>, <span class="contact-name">David Navarro</span>, <span class="contact-name">Shuping Peng</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Jürgen Schönwälder</span>, <span class="contact-name">John Scudder</span>, <span class="contact-name">Orie Steele</span>, <span class="contact-name">Gunter Van de Velde</span>, <span class="contact-name">Mališa Vučinić</span>, and <span class="contact-name">Paul Wouters</span> for their feedback and comments.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The work on this document has been partly supported by the Sweden's Innovation Agency VINNOVA and the Celtic-Next project CRITISEC, and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Hristozov</span></div>
<div dir="auto" class="left"><span class="org">Eriptic</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.hristozov@eriptic.com" class="email">stefan.hristozov@eriptic.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
