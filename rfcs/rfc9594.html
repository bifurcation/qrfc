<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9594: Key Provisioning for Group Communication Using Authentication and Authorization for Constrained Environments (ACE)</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       This document defines how to use the Authentication and Authorization for Constrained Environments (ACE) framework to distribute keying material and configuration parameters for secure group communication. Candidate group members that act as Clients and are authorized to join a group can do so by interacting with a Key Distribution Center (KDC) acting as the Resource Server, from which they obtain the keying material to communicate with other group members. While defining general message formats as well as the interface and operations available at the KDC, this document supports different approaches and protocols for secure group communication. Therefore, details are delegated to separate application profiles of this document as specialized instances that target a particular group communication approach and define how communications in the group are protected. Compliance requirements for such application profiles are also specified. 
    " name="description">
<meta content="xml2rfc 3.23.0" name="generator">
<meta content="Key Management" name="keyword">
<meta content="Access Control" name="keyword">
<meta content="Constrained Application Protocol (CoAP)" name="keyword">
<meta content="Secure group communication" name="keyword">
<meta content="9594" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.23.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9594.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-ace-key-groupcomm-18" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9594" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9594</td>
<td class="center">Key Provisioning for Group Communication</td>
<td class="right">September 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini &amp; Tiloca</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9594" class="eref">9594</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-09" class="published">September 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9594</h1>
<h1 id="title">Key Provisioning for Group Communication Using Authentication and Authorization for Constrained Environments (ACE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines how to use the Authentication and Authorization for Constrained Environments (ACE) framework to distribute keying material and configuration parameters for secure group communication. Candidate group members that act as Clients and are authorized to join a group can do so by interacting with a Key Distribution Center (KDC) acting as the Resource Server, from which they obtain the keying material to communicate with other group members. While defining general message formats as well as the interface and operations available at the KDC, this document supports different approaches and protocols for secure group communication. Therefore, details are delegated to separate application profiles of this document as specialized instances that target a particular group communication approach and define how communications in the group are protected. Compliance requirements for such application profiles are also specified.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9594">https://www.rfc-editor.org/info/rfc9594</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-authorization-to-join-a-gro" class="internal xref">Authorization to Join a Group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-authorization-request" class="internal xref">Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authorization-response" class="internal xref">Authorization Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-token-transferring" class="internal xref">Token Transferring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-sign_info-parameter" class="internal xref">'sign_info' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-kdcchallenge-parameter" class="internal xref">'kdcchallenge' Parameter</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-kdc-functionalities" class="internal xref">KDC Functionalities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-interface-at-the-kdc" class="internal xref">Interface at the KDC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-operations-supported-by-cli" class="internal xref">Operations Supported by Clients</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-ace-group" class="internal xref">/ace-group</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-fetch-handler" class="internal xref">FETCH Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.1">
                        <p id="section-toc.1-1.4.2.2.2.1.2.1.1"><a href="#section-4.2.1.1" class="auto internal xref">4.2.1.1</a>.  <a href="#name-retrieve-group-names" class="internal xref">Retrieve Group Names</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-ace-group-groupname" class="internal xref">/ace-group/GROUPNAME</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-post-handler" class="internal xref">POST Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1.2.1">
                        <p id="section-toc.1-1.4.2.3.2.1.2.1.1"><a href="#section-4.3.1.1" class="auto internal xref">4.3.1.1</a>.  <a href="#name-join-the-group" class="internal xref">Join the Group</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-get-handler" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2.2.1">
                        <p id="section-toc.1-1.4.2.3.2.2.2.1.1"><a href="#section-4.3.2.1" class="auto internal xref">4.3.2.1</a>.  <a href="#name-retrieve-group-keying-mater" class="internal xref">Retrieve Group Keying Material</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-ace-group-groupname-creds" class="internal xref">/ace-group/GROUPNAME/creds</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-fetch-handler-2" class="internal xref">FETCH Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1.2.1">
                        <p id="section-toc.1-1.4.2.4.2.1.2.1.1"><a href="#section-4.4.1.1" class="auto internal xref">4.4.1.1</a>.  <a href="#name-retrieve-a-subset-of-authen" class="internal xref">Retrieve a Subset of Authentication Credentials in the Group</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-get-handler-2" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2.2.1">
                        <p id="section-toc.1-1.4.2.4.2.2.2.1.1"><a href="#section-4.4.2.1" class="auto internal xref">4.4.2.1</a>.  <a href="#name-retrieve-all-authentication" class="internal xref">Retrieve All Authentication Credentials in the Group</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-ace-group-groupname-kdc-cre" class="internal xref">/ace-group/GROUPNAME/kdc-cred</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-get-handler-3" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1.2.1">
                        <p id="section-toc.1-1.4.2.5.2.1.2.1.1"><a href="#section-4.5.1.1" class="auto internal xref">4.5.1.1</a>.  <a href="#name-retrieve-the-kdcs-authentic" class="internal xref">Retrieve the KDC's Authentication Credential</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-ace-group-groupname-policie" class="internal xref">/ace-group/GROUPNAME/policies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.  <a href="#name-get-handler-4" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1.2.1">
                        <p id="section-toc.1-1.4.2.6.2.1.2.1.1"><a href="#section-4.6.1.1" class="auto internal xref">4.6.1.1</a>.  <a href="#name-retrieve-the-group-policies" class="internal xref">Retrieve the Group Policies</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-ace-group-groupname-num" class="internal xref">/ace-group/GROUPNAME/num</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1">
                    <p id="section-toc.1-1.4.2.7.2.1.1"><a href="#section-4.7.1" class="auto internal xref">4.7.1</a>.  <a href="#name-get-handler-5" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7.2.1.2.1">
                        <p id="section-toc.1-1.4.2.7.2.1.2.1.1"><a href="#section-4.7.1.1" class="auto internal xref">4.7.1.1</a>.  <a href="#name-retrieve-the-keying-materia" class="internal xref">Retrieve the Keying Material Version</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-ace-group-groupname-nodes-n" class="internal xref">/ace-group/GROUPNAME/nodes/NODENAME</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1">
                    <p id="section-toc.1-1.4.2.8.2.1.1"><a href="#section-4.8.1" class="auto internal xref">4.8.1</a>.  <a href="#name-get-handler-6" class="internal xref">GET Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.1.2.1">
                        <p id="section-toc.1-1.4.2.8.2.1.2.1.1"><a href="#section-4.8.1.1" class="auto internal xref">4.8.1.1</a>.  <a href="#name-retrieve-group-and-individu" class="internal xref">Retrieve Group and Individual Keying Material</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2">
                    <p id="section-toc.1-1.4.2.8.2.2.1"><a href="#section-4.8.2" class="auto internal xref">4.8.2</a>.  <a href="#name-post-handler-2" class="internal xref">POST Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.2.2.1">
                        <p id="section-toc.1-1.4.2.8.2.2.2.1.1"><a href="#section-4.8.2.1" class="auto internal xref">4.8.2.1</a>.  <a href="#name-request-to-change-individua" class="internal xref">Request to Change Individual Keying Material</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.3">
                    <p id="section-toc.1-1.4.2.8.2.3.1"><a href="#section-4.8.3" class="auto internal xref">4.8.3</a>.  <a href="#name-delete-handler" class="internal xref">DELETE Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8.2.3.2.1">
                        <p id="section-toc.1-1.4.2.8.2.3.2.1.1"><a href="#section-4.8.3.1" class="auto internal xref">4.8.3.1</a>.  <a href="#name-leave-the-group" class="internal xref">Leave the Group</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-ace-group-groupname-nodes-no" class="internal xref">/ace-group/GROUPNAME/nodes/NODENAME/cred</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.1">
                    <p id="section-toc.1-1.4.2.9.2.1.1"><a href="#section-4.9.1" class="auto internal xref">4.9.1</a>.  <a href="#name-post-handler-3" class="internal xref">POST Handler</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9.2.1.2.1">
                        <p id="section-toc.1-1.4.2.9.2.1.2.1.1"><a href="#section-4.9.1.1" class="auto internal xref">4.9.1.1</a>.  <a href="#name-uploading-an-authentication" class="internal xref">Uploading an Authentication Credential</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-removal-of-a-group-member" class="internal xref">Removal of a Group Member</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-group-rekeying-process" class="internal xref">Group Rekeying Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-point-to-point-group-rekeyi" class="internal xref">Point-to-Point Group Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-one-to-many-group-rekeying" class="internal xref">One-to-Many Group Rekeying</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-protection-of-rekeying-mess" class="internal xref">Protection of Rekeying Messages</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-misalignment-of-group-keyin" class="internal xref">Misalignment of Group Keying Material</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-extended-scope-format" class="internal xref">Extended Scope Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-ace-groupcomm-parameters" class="internal xref">ACE Groupcomm Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-ace-groupcomm-error-identif" class="internal xref">ACE Groupcomm Error Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-secure-communication-in-the" class="internal xref">Secure Communication in the Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-update-of-group-keying-mate" class="internal xref">Update of Group Keying Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-block-wise-considerations" class="internal xref">Block-Wise Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-media-type-registrations" class="internal xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-coap-content-formats" class="internal xref">CoAP Content-Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-oauth-parameters" class="internal xref">OAuth Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-interface-description-if-li" class="internal xref">Interface Description (if=) Link Target Attribute Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-custom-problem-detail-keys-" class="internal xref">Custom Problem Detail Keys Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#section-11.7" class="auto internal xref">11.7</a>.  <a href="#name-ace-groupcomm-parameters-3" class="internal xref">ACE Groupcomm Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#section-11.8" class="auto internal xref">11.8</a>.  <a href="#name-ace-groupcomm-key-types-2" class="internal xref">ACE Groupcomm Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a href="#section-11.9" class="auto internal xref">11.9</a>.  <a href="#name-ace-groupcomm-profiles-2" class="internal xref">ACE Groupcomm Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.10">
                <p id="section-toc.1-1.11.2.10.1"><a href="#section-11.10" class="auto internal xref">11.10</a>. <a href="#name-ace-groupcomm-policies-2" class="internal xref">ACE Groupcomm Policies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.11">
                <p id="section-toc.1-1.11.2.11.1"><a href="#section-11.11" class="auto internal xref">11.11</a>. <a href="#name-sequence-number-synchroniza" class="internal xref">Sequence Number Synchronization Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.12">
                <p id="section-toc.1-1.11.2.12.1"><a href="#section-11.12" class="auto internal xref">11.12</a>. <a href="#name-ace-groupcomm-errors" class="internal xref">ACE Groupcomm Errors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.13">
                <p id="section-toc.1-1.11.2.13.1"><a href="#section-11.13" class="auto internal xref">11.13</a>. <a href="#name-ace-groupcomm-rekeying-schem" class="internal xref">ACE Groupcomm Rekeying Schemes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.14">
                <p id="section-toc.1-1.11.2.14.1"><a href="#section-11.14" class="auto internal xref">11.14</a>. <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-requirements-for-applicatio" class="internal xref">Requirements for Application Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-mandatory-to-address-requir" class="internal xref">Mandatory-to-Address Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-optional-to-address-require" class="internal xref">Optional-to-Address Requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-extensibility-for-future-co" class="internal xref">Extensibility for Future COSE Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-format-of-sign_info_entry" class="internal xref">Format of 'sign_info_entry'</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document builds on the Authentication and Authorization for Constrained Environments (ACE) framework and defines how to request, distribute, and renew keying material and configuration parameters to protect message exchanges in a group communication environment.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Candidate group members that act as ACE Clients and are authorized to join a group can interact with the Key Distribution Center (KDC) acting as the ACE Resource Server that is responsible for that group in order to obtain the necessary keying material and parameters to communicate with other group members.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In particular, this document defines the operations and interface available at the KDC, as well as general message formats for the interactions between Clients and the KDC. At the same time, communications in the group can rely on different approaches, e.g., based on multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">GROUP-CoAP</a>]</span> or publish-subscribe (pub-sub) messaging <span>[<a href="#I-D.ietf-core-coap-pubsub" class="cite xref">CoAP-PUBSUB</a>]</span>, and can be protected in different ways.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Therefore, this document delegates details on the communication and security approaches used in a group to separate application profiles. These are specialized instances of this document that target a particular group communication approach and define how communications in the group are protected, as well as the specific keying material and configuration parameters provided to group members.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">In order to ensure consistency and aid the development of such application profiles, <a href="#req" class="auto internal xref">Appendix A</a> of this document defines a number of related compliance requirements. In particular, <a href="#req-mandatory" class="auto internal xref">Appendix A.1</a> compiles the requirements that application profiles are <span class="bcp14">REQUIRED</span> to fulfill; these are referred to by an identifier that starts with "REQ". Instead, <a href="#req-optional" class="auto internal xref">Appendix A.2</a> compiles the requirements that application profiles <span class="bcp14">MAY</span> fulfill; these are referred to by an identifier that starts with "OPT".<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">New keying material is intended to be generated and distributed to the group upon membership changes (rekeying). If the application requires backward security (i.e., new group members must be prevented from accessing communications in the group prior to their joining), then a rekeying has to occur every time new members join the group. If the application requires forward security (i.e., former group members must be prevented from accessing communications in the group after their leaving), then a rekeying has to occur every time current members leave or are evicted from the group.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">A group rekeying scheme performs the actual distribution of the new keying material by rekeying the current group members when a new Client joins the group and rekeying the remaining group members when a Client leaves the group. This can rely on different approaches, including efficient group rekeying schemes such as those described in <span>[<a href="#RFC2093" class="cite xref">RFC2093</a>]</span>, <span>[<a href="#RFC2094" class="cite xref">RFC2094</a>]</span>, and <span>[<a href="#RFC2627" class="cite xref">RFC2627</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Consistently with what is recommended in the ACE framework, this document uses Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> for data encoding. However, using JSON <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> instead of CBOR is possible by relying on the conversion method specified in Sections <a href="https://rfc-editor.org/rfc/rfc8949#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc8949#section-6.2" class="relref">6.2</a> of <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the following:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">The terms and concepts described in the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and in the Authorization Information Format (AIF) <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> to express authorization information. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. In particular, this includes Client (C), Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.2">The terms and concepts described in the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. The term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as /token and /introspect at the AS  and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-3.3">The terms and concepts described in Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, and CBOR Object Signing and Encryption (COSE) <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> <span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>.<a href="#section-1.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-4">A node interested in participating in group communication, as well as one that is already participating as a group member, is interchangeably denoted as "Client".<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">This document also uses the following terms.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-6">
          <dt id="section-1.1-6.1">Group:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-6.2">
            <p id="section-1.1-6.2.1">A set of nodes that share common keying material and security parameters used to protect their communications with one another. That is, the term refers to a "security group".<a href="#section-1.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-1.1-6.2.2">
This term is not to be confused with an "application group", which has relevance at the application level and whose members share a common pool of resources or content. Examples of application groups are the set of all nodes deployed in a same physical room or the set of nodes registered to a pub-sub topic.<a href="#section-1.1-6.2.2" class="pilcrow">¶</a></p>
<p id="section-1.1-6.2.3">
This term is also not to be confused with a "multicast group", which has relevance at the network level and whose members all listen to a group network address for receiving messages sent to that group. An example of a multicast group is the set of nodes that are configured to receive messages that are sent to the group's associated IP multicast address.<a href="#section-1.1-6.2.3" class="pilcrow">¶</a></p>
<p id="section-1.1-6.2.4">
The same security group might be associated with multiple application groups. Also, the same application group might be associated with multiple security groups. Further details and considerations on the mapping between the three types of groups are out of the scope of this document.<a href="#section-1.1-6.2.4" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-6.3">Key Distribution Center (KDC):</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-6.4">The entity responsible for managing one or multiple groups, with particular reference to the group membership and the keying material to use for protecting group communications.<a href="#section-1.1-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-7">Furthermore, this document uses "names" or "identifiers" for groups and nodes. Their different meanings are summarized below.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-8">
          <dt id="section-1.1-8.1">Group name:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-8.2">The identifier of a group as a text string encoded as UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span>. Once established, it is invariant. It is used in the interactions between the Client, AS, and RS to identify a group. A group name is always unique among the group names of the existing groups under the same KDC.<a href="#section-1.1-8.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-8.3">GROUPNAME:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-8.4">The text string used in URIs to identify a group. Once established, it is invariant. GROUPNAME uniquely maps to the group name of a group, although they do not necessarily coincide.<a href="#section-1.1-8.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-8.5">Group identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-8.6">The identifier of the group keying material used in a group. Unlike group name and GROUPNAME, this identifier changes over time when the group keying material is updated.<a href="#section-1.1-8.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-8.7">Node name:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-8.8">The identifier of a node as a text string encoded as UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> and consistent with the semantics of URI path segments (see <span><a href="https://rfc-editor.org/rfc/rfc3986#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>). Once established, it is invariant. It is used in the interactions between the Client and RS, as well as to identify a member of a group. A node name is always unique among the node names of the current nodes within a group.<a href="#section-1.1-8.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-8.9">NODENAME:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-8.10">The text string used in URIs to identify a member of a group. Once established, it is invariant. Its value coincides with the node name of the associated group member.<a href="#section-1.1-8.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-9">This document additionally uses the following terminology:<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-10">
          <dt id="section-1.1-10.1">Transport profile:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-10.2">A profile of the ACE framework as per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.4.3" class="relref">Section 5.8.4.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. 
A transport profile specifies the communication protocol and communication security protocol between an ACE Client and Resource Server, as well as proof-of-possession methods if it supports proof-of-possession access tokens. Transport profiles of ACE include, for instance, those described in <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, and <span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span>.<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-10.3">Application profile:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-10.4">A profile that defines how applications enforce and use supporting security services they require. These services may include, for instance, provisioning, revocation, and distribution of keying material. An application profile may define specific procedures and message formats.<a href="#section-1.1-10.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-10.5">Authentication credential:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-10.6">The set of information associated with an entity, including that entity's public key and parameters associated with the public key. Examples of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">C509-CERT</a>]</span>.<a href="#section-1.1-10.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-10.7">Individual keying material:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-10.8">Information pertaining exclusively to a group member, as associated with its group membership and related to other keying material and parameters used in the group. For example, this can be an identifier that the secure communication protocol employs to uniquely identify a node as a group member (e.g., a cryptographic key identifier uniquely associated with the group member in question). The specific nature and format of individual keying material used in a group is defined in the application profiles of this specification. The individual keying material of a group member is not related to the secure association between that group member and the KDC.<a href="#section-1.1-10.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-11">Throughout this document, examples for CBOR data items are expressed in CBOR extended diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> ("diagnostic notation"), unless noted otherwise. We often use diagnostic notation comments to provide a textual representation of the parameters' keys and values.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">At a high level, the key provisioning process is separated in two phases: the first one follows the ACE framework between the Client, AS, and KDC, while the second one is the actual key distribution between the Client and KDC. After the two phases are completed, the Client is able to participate in the group communication via a Dispatcher entity.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-key-distribution-participan"></span><div id="fig-roles">
<figure id="figure-1">
        <div id="section-2-2.1">
          <div class="alignCenter art-svg artwork" id="section-2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 700 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
              <path d="M 8,128 L 8,176" fill="none" stroke="black"></path>
              <path d="M 56,72 L 56,120" fill="none" stroke="black"></path>
              <path d="M 112,32 L 112,64" fill="none" stroke="black"></path>
              <path d="M 112,128 L 112,176" fill="none" stroke="black"></path>
              <path d="M 184,48 L 184,144" fill="none" stroke="black"></path>
              <path d="M 240,32 L 240,64" fill="none" stroke="black"></path>
              <path d="M 240,144 L 240,176" fill="none" stroke="black"></path>
              <path d="M 344,32 L 344,64" fill="none" stroke="black"></path>
              <path d="M 344,144 L 344,176" fill="none" stroke="black"></path>
              <path d="M 408,128 L 408,176" fill="none" stroke="black"></path>
              <path d="M 424,144 L 424,192" fill="none" stroke="black"></path>
              <path d="M 440,160 L 440,208" fill="none" stroke="black"></path>
              <path d="M 504,128 L 504,144" fill="none" stroke="black"></path>
              <path d="M 520,144 L 520,160" fill="none" stroke="black"></path>
              <path d="M 536,160 L 536,208" fill="none" stroke="black"></path>
              <path d="M 8,32 L 112,32" fill="none" stroke="black"></path>
              <path d="M 240,32 L 344,32" fill="none" stroke="black"></path>
              <path d="M 184,48 L 232,48" fill="none" stroke="black"></path>
              <path d="M 8,64 L 112,64" fill="none" stroke="black"></path>
              <path d="M 240,64 L 344,64" fill="none" stroke="black"></path>
              <path d="M 8,128 L 112,128" fill="none" stroke="black"></path>
              <path d="M 408,128 L 504,128" fill="none" stroke="black"></path>
              <path d="M 120,144 L 184,144" fill="none" stroke="black"></path>
              <path d="M 240,144 L 344,144" fill="none" stroke="black"></path>
              <path d="M 424,144 L 520,144" fill="none" stroke="black"></path>
              <path d="M 120,160 L 232,160" fill="none" stroke="black"></path>
              <path d="M 352,160 L 400,160" fill="none" stroke="black"></path>
              <path d="M 440,160 L 536,160" fill="none" stroke="black"></path>
              <path d="M 8,176 L 112,176" fill="none" stroke="black"></path>
              <path d="M 240,176 L 344,176" fill="none" stroke="black"></path>
              <path d="M 408,176 L 424,176" fill="none" stroke="black"></path>
              <path d="M 424,192 L 440,192" fill="none" stroke="black"></path>
              <path d="M 440,208 L 536,208" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="408,160 396,154.4 396,165.6" fill="black" transform="rotate(0,400,160)"></polygon>
              <polygon class="arrowhead" points="360,160 348,154.4 348,165.6" fill="black" transform="rotate(180,352,160)"></polygon>
              <polygon class="arrowhead" points="240,160 228,154.4 228,165.6" fill="black" transform="rotate(0,232,160)"></polygon>
              <polygon class="arrowhead" points="240,48 228,42.4 228,53.6" fill="black" transform="rotate(0,232,48)"></polygon>
              <polygon class="arrowhead" points="128,160 116,154.4 116,165.6" fill="black" transform="rotate(180,120,160)"></polygon>
              <polygon class="arrowhead" points="128,144 116,138.4 116,149.6" fill="black" transform="rotate(180,120,144)"></polygon>
              <polygon class="arrowhead" points="64,120 52,114.4 52,125.6" fill="black" transform="rotate(90,56,120)"></polygon>
              <polygon class="arrowhead" points="64,72 52,66.4 52,77.6" fill="black" transform="rotate(270,56,72)"></polygon>
              <g class="text">
                <text x="60" y="52">AS</text>
                <text x="288" y="52">KDC</text>
                <text x="60" y="148">Client</text>
                <text x="292" y="164">Dispatcher</text>
                <text x="488" y="180">Group</text>
                <text x="488" y="196">members</text>
              </g>
            </svg><a href="#section-2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-key-distribution-participan" class="selfRef">Key Distribution Participants</a>
        </figcaption></figure>
</div>
<p id="section-2-3">The following participants (see <a href="#fig-roles" class="auto internal xref">Figure 1</a>) take part in the authorization and key distribution.<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">Client (C): A node that wants to join a group and take part in group communication with other group members. Within the group, the Client can have different roles.<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.2">Authorization Server (AS): As per the AS defined in the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, it enforces access policies that prescribe whether a node is allowed to join a given group or not and with what roles and rights (e.g., write and/or read).<a href="#section-2-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.3">Key Distribution Center (KDC): An entity that maintains the keying material to protect group communications and provides it to Clients authorized to join a given group. During the first phase of the process (<a href="#sec-auth" class="auto internal xref">Section 3</a>), the KDC takes the role of the RS in the ACE framework. During the second phase of the process (<a href="#key-distr" class="auto internal xref">Section 4</a>), which is not based on the ACE framework, the KDC distributes the keying material. In addition, the KDC provides the latest keying material to group members when requested or, if required by the application, when group membership changes.<a href="#section-2-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-4.4">
          <p id="section-2-4.4.1">Group members: Nodes that have joined a group where they take part in group communication with one another, protecting it with the group keying material obtained from the KDC.<a href="#section-2-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.5">
          <p id="section-2-4.5.1">Dispatcher: An entity through which the Clients communicate with the group when sending a message intended for multiple group members. That is, the Dispatcher distributes such a one-to-many message to the group members as intended recipients. The Dispatcher does not have access to the group keying material. A single-recipient message intended for only one group member may be delivered by alternative means, i.e., with no assistance from the Dispatcher.<a href="#section-2-4.5.1" class="pilcrow">¶</a></p>
<p id="section-2-4.5.2">
Examples of a Dispatcher are: the Broker in a pub-sub setting; a relayer for group communication that delivers group messages as multiple unicast messages to all group members; and an implicit entity as in a multicast communication setting, where messages are transmitted to a multicast IP address and delivered on the transport channel.<a href="#section-2-4.5.2" class="pilcrow">¶</a></p>
<p id="section-2-4.5.3">
If it consists of an explicit entity, such as a pub-sub Broker or a message relayer, the Dispatcher is comparable to an untrusted on-path intermediary; as such, it is able to see the messages sent by Clients in the group but not able to decrypt them and read their plain content.<a href="#section-2-4.5.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5">This document specifies a mechanism for:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">Authorizing a Client to join the group (<a href="#sec-auth" class="auto internal xref">Section 3</a>) and providing it with the group keying material to communicate with the other group members (<a href="#key-distr" class="auto internal xref">Section 4</a>),<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.2">Allowing a group member to retrieve group keying material (Sections <a href="#ssec-key-material-retrieval" class="auto internal xref">4.3.2.1</a> and <a href="#update-keys" class="auto internal xref">4.8.1.1</a>),<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.3">Allowing a group member to retrieve authentication credentials of other group members (<a href="#sec-key-retrieval" class="auto internal xref">Section 4.4.1.1</a>) and to provide an updated authentication credential (<a href="#update-pub-key" class="auto internal xref">Section 4.9.1.1</a>),<a href="#section-2-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.4">Allowing a group member to leave the group (<a href="#ssec-group-leaving" class="auto internal xref">Section 4.8.3.1</a>),<a href="#section-2-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.5">Evicting a group member from the group (<a href="#sec-node-removal" class="auto internal xref">Section 5</a>), and<a href="#section-2-6.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.6">
          <p id="section-2-6.6.1">Renewing and redistributing the group keying material (rekeying), e.g., upon a membership change in the group (<a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>).<a href="#section-2-6.6.1" class="pilcrow">¶</a></p>
<p id="section-2-6.6.2">
Rekeying the group may result in a temporary misalignment of the keying material stored by the different group members. Different situations where this can happen and how they can be handled are discussed in <a href="#sec-misalignment-keying-material" class="auto internal xref">Section 6.3</a>.<a href="#section-2-6.6.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-7"><a href="#fig-flow" class="auto internal xref">Figure 2</a> provides a high-level overview of the message flow for a node joining a group. The message flow can be expanded as follows.<a href="#section-2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-8">
<li id="section-2-8.1">
          <p id="section-2-8.1.1">The joining node requests an access token from the AS in order to access one or more group-membership resources at the KDC and hence join the associated groups.<a href="#section-2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-2-8.1.2">
This exchange between the Client and AS <span class="bcp14">MUST</span> be secured, as specified by the transport profile of ACE used between the Client and KDC. Based on the response from the AS, the joining node will establish or continue using a secure communication association with the KDC.<a href="#section-2-8.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.2">
          <p id="section-2-8.2.1">The joining node transfers authentication and authorization information to the KDC by transferring the obtained access token. This is typically achieved by including the access token in a request sent to the /authz-info endpoint at the KDC.<a href="#section-2-8.2.1" class="pilcrow">¶</a></p>
<p id="section-2-8.2.2">
Once this exchange is completed, the joining node <span class="bcp14">MUST</span> have a secure communication association established with the KDC before joining a group under that KDC.<a href="#section-2-8.2.2" class="pilcrow">¶</a></p>
<p id="section-2-8.2.3">
This exchange and the following secure communications between the Client and the KDC <span class="bcp14">MUST</span> occur in accordance with the transport profile of ACE used between the Client and KDC, such as the DTLS transport profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> or the OSCORE transport profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-2-8.2.3" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.3">
          <p id="section-2-8.3.1">The joining node starts the joining process to become a member of the group by sending a request to the related group-membership resource at the KDC. Based on the application requirements and policies, the KDC may perform a group rekeying by generating new group keying material and distributing it to the current group members through the rekeying scheme used in the group.<a href="#section-2-8.3.1" class="pilcrow">¶</a></p>
<p id="section-2-8.3.2">
At the end of the joining process, the joining node has received the parameters and group keying material from the KDC to securely communicate with the other group members. Also, the KDC has stored the association between the authorization information from the access token and the secure communication association with the joining node.<a href="#section-2-8.3.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-8.4">The joining node and the KDC maintain the secure communication association to support possible future communications. These especially include key management operations, such as the retrieval of updated keying material or the participation in a group rekeying process.<a href="#section-2-8.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-8.5">The joining node can communicate securely with the other group members by using the keying material obtained in step 3.<a href="#section-2-8.5" class="pilcrow">¶</a>
</li>
      </ol>
<span id="name-message-flow-upon-a-new-nod"></span><div id="fig-flow">
<figure id="figure-2">
        <div id="section-2-9.1">
          <div class="alignCenter art-svg artwork" id="section-2-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 432" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 48,64 L 48,96" fill="none" stroke="black"></path>
              <path d="M 48,128 L 48,176" fill="none" stroke="black"></path>
              <path d="M 72,32 L 72,384" fill="none" stroke="black"></path>
              <path d="M 312,32 L 312,136" fill="none" stroke="black"></path>
              <path d="M 312,184 L 312,216" fill="none" stroke="black"></path>
              <path d="M 312,232 L 312,280" fill="none" stroke="black"></path>
              <path d="M 312,296 L 312,336" fill="none" stroke="black"></path>
              <path d="M 344,32 L 344,336" fill="none" stroke="black"></path>
              <path d="M 440,352 L 440,384" fill="none" stroke="black"></path>
              <path d="M 528,48 L 528,384" fill="none" stroke="black"></path>
              <path d="M 80,64 L 96,64" fill="none" stroke="black"></path>
              <path d="M 288,64 L 304,64" fill="none" stroke="black"></path>
              <path d="M 80,96 L 96,96" fill="none" stroke="black"></path>
              <path d="M 80,144 L 96,144" fill="none" stroke="black"></path>
              <path d="M 304,144 L 336,144" fill="none" stroke="black"></path>
              <path d="M 80,176 L 104,176" fill="none" stroke="black"></path>
              <path d="M 304,176 L 336,176" fill="none" stroke="black"></path>
              <path d="M 80,224 L 144,224" fill="none" stroke="black"></path>
              <path d="M 264,224 L 336,224" fill="none" stroke="black"></path>
              <path d="M 504,256 L 520,256" fill="none" stroke="black"></path>
              <path d="M 80,288 L 144,288" fill="none" stroke="black"></path>
              <path d="M 272,288 L 336,288" fill="none" stroke="black"></path>
              <path d="M 80,366 L 136,366" fill="none" stroke="black"></path>
              <path d="M 80,370 L 136,370" fill="none" stroke="black"></path>
              <path d="M 368,366 L 432,366" fill="none" stroke="black"></path>
              <path d="M 368,370 L 432,370" fill="none" stroke="black"></path>
              <path d="M 448,366 L 520,366" fill="none" stroke="black"></path>
              <path d="M 448,370 L 520,370" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="528,368 516,362.4 516,373.6" fill="black" transform="rotate(0,520,368)"></polygon>
              <polygon class="arrowhead" points="528,256 516,250.4 516,261.6" fill="black" transform="rotate(0,520,256)"></polygon>
              <polygon class="arrowhead" points="344,224 332,218.4 332,229.6" fill="black" transform="rotate(0,336,224)"></polygon>
              <polygon class="arrowhead" points="344,144 332,138.4 332,149.6" fill="black" transform="rotate(0,336,144)"></polygon>
              <polygon class="arrowhead" points="312,64 300,58.4 300,69.6" fill="black" transform="rotate(0,304,64)"></polygon>
              <polygon class="arrowhead" points="88,368 76,362.4 76,373.6" fill="black" transform="rotate(180,80,368)"></polygon>
              <polygon class="arrowhead" points="88,288 76,282.4 76,293.6" fill="black" transform="rotate(180,80,288)"></polygon>
              <polygon class="arrowhead" points="88,176 76,170.4 76,181.6" fill="black" transform="rotate(180,80,176)"></polygon>
              <polygon class="arrowhead" points="88,96 76,90.4 76,101.6" fill="black" transform="rotate(180,80,96)"></polygon>
              <g class="text">
                <text x="72" y="20">C</text>
                <text x="308" y="20">AS</text>
                <text x="344" y="20">KDC</text>
                <text x="528" y="20">Group</text>
                <text x="528" y="36">Members</text>
                <text x="56" y="52">/</text>
                <text x="192" y="68">Authorization Request</text>
                <text x="208" y="100">Authorization Response --</text>
                <text x="24" y="116">(1) &lt;</text>
                <text x="204" y="148">Token Transfer Request</text>
                <text x="208" y="180">Token Transfer Response</text>
                <text x="56" y="196">\</text>
                <text x="204" y="228">Join Request</text>
                <text x="424" y="260">-- Group rekeying</text>
                <text x="436" y="276">(optional)</text>
                <text x="208" y="292">Join Response</text>
                <text x="444" y="340">Dispatcher</text>
                <text x="252" y="372">Secure group communication</text>
                <text x="132" y="420">(1) Defined in the ACE framework</text>
              </g>
            </svg><a href="#section-2-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-message-flow-upon-a-new-nod" class="selfRef">Message Flow upon a New Node's Joining</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-auth">
<section id="section-3">
      <h2 id="name-authorization-to-join-a-gro">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-authorization-to-join-a-gro" class="section-name selfRef">Authorization to Join a Group</a>
      </h2>
<p id="section-3-1">This section describes in detail the format of messages exchanged by the participants when a node requests access to a given group. This exchange is based on ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">As defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the Client asks the AS for the authorization to join the group through the KDC (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>). If the request is approved and authorization is granted, the AS provides the Client with a proof-of-possession access token and parameters to securely communicate with the KDC (see <a href="#ssec-authorization-response" class="auto internal xref">Section 3.2</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Communications between the Client and the AS <span class="bcp14">MUST</span> be secured according to what is defined by the used transport profile of ACE. The Content-Format used in the message also depends on the used transport profile of ACE. 
For example, it can be "application/ace+cbor" for the first two messages and "application/cwt" for the third message, which are defined in the ACE framework.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The transport profile of ACE also defines a number of details, such as the communication and security protocols used with the KDC (see <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5"><a href="#fig-group-member-registration" class="auto internal xref">Figure 3</a> gives an overview of the exchange described above.<a href="#section-3-5" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-join-author"></span><div id="fig-group-member-registration">
<figure id="figure-3">
        <div id="section-3-6.1">
          <div class="alignCenter art-svg artwork" id="section-3-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,32 L 32,160" fill="none" stroke="black"></path>
              <path d="M 424,32 L 424,104" fill="none" stroke="black"></path>
              <path d="M 472,32 L 472,160" fill="none" stroke="black"></path>
              <path d="M 40,48 L 64,48" fill="none" stroke="black"></path>
              <path d="M 360,48 L 416,48" fill="none" stroke="black"></path>
              <path d="M 40,80 L 64,80" fill="none" stroke="black"></path>
              <path d="M 392,80 L 416,80" fill="none" stroke="black"></path>
              <path d="M 40,112 L 64,112" fill="none" stroke="black"></path>
              <path d="M 408,112 L 464,112" fill="none" stroke="black"></path>
              <path d="M 40,144 L 64,144" fill="none" stroke="black"></path>
              <path d="M 400,144 L 464,144" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="472,144 460,138.4 460,149.6" fill="black" transform="rotate(0,464,144)"></polygon>
              <polygon class="arrowhead" points="472,112 460,106.4 460,117.6" fill="black" transform="rotate(0,464,112)"></polygon>
              <polygon class="arrowhead" points="424,48 412,42.4 412,53.6" fill="black" transform="rotate(0,416,48)"></polygon>
              <polygon class="arrowhead" points="48,144 36,138.4 36,149.6" fill="black" transform="rotate(180,40,144)"></polygon>
              <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
              <g class="text">
                <text x="28" y="20">Client</text>
                <text x="420" y="20">AS</text>
                <text x="472" y="20">KDC</text>
                <text x="212" y="52">Authorization Request: POST /token</text>
                <text x="228" y="84">Authorization Response: 2.01 (Created)</text>
                <text x="236" y="116">Token Transfer Request: POST /authz-info</text>
                <text x="424" y="132">|</text>
                <text x="232" y="148">Token Transfer Response: 2.01 (Created)</text>
                <text x="424" y="164">|</text>
              </g>
            </svg><a href="#section-3-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-of-join-author" class="selfRef">Message Flow of Join Authorization</a>
        </figcaption></figure>
</div>
<div id="ssec-authorization-request">
<section id="section-3.1">
        <h3 id="name-authorization-request">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-3.1-1">The Authorization Request sent from the Client to the AS is defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and <span class="bcp14">MAY</span> contain the following parameters, which, if included, <span class="bcp14">MUST</span> have the format and value as specified below.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">'scope': specifying the names of the groups that the Client requests to access and optionally the roles that the Client requests to have in those groups.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.2">
This parameter is encoded as a CBOR byte string, which wraps a CBOR array of scope entries. All the scope entries are specified according to the same format, i.e., either the Authorization Information Format (AIF) or the textual format defined below.<a href="#section-3.1-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.3.1">
                <p id="section-3.1-2.1.3.1.1">If AIF is used, each scope entry is encoded as per <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>, i.e., as a CBOR array [Toid, Tperm]. If a scope entry expresses a set of roles to take in a group as per this document, the object identifier "Toid" specifies the group name and <span class="bcp14">MUST</span> be encoded as a CBOR text string, while the permission set "Tperm" specifies the roles that the Client wishes to take in the group.<a href="#section-3.1-2.1.3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.3.1.2">
AIF is the default format for application profiles of this specification and is preferable for those that aim for a compact encoding of scope. This is especially desirable for application profiles defining several roles, with the Client possibly asking for multiple roles combined.<a href="#section-3.1-2.1.3.1.2" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.3.1.3"><a href="#cddl-ex-0" class="auto internal xref">Figure 4</a> shows an example in CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> where scope uses AIF.<a href="#section-3.1-2.1.3.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.3.2">
                <p id="section-3.1-2.1.3.2.1">If the textual format is used, each scope entry is a CBOR array formatted as follows.<a href="#section-3.1-2.1.3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.3.2.2.1">As the first element, the group name, encoded as a CBOR text string.<a href="#section-3.1-2.1.3.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-3.1-2.1.3.2.2.2">Optionally, as the second element, the role or CBOR array of roles that the Client wishes to take in the group. This element is optional since roles may have been pre-assigned to the Client, as associated with its verifiable identity credentials. Alternatively, the application may have defined a single, well-known role for the target resource(s) and audience(s).<a href="#section-3.1-2.1.3.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-3.1-2.1.3.2.3">
<a href="#cddl-ex" class="auto internal xref">Figure 5</a> shows an example in CDDL notation where scope uses the textual format with the group name and role identifiers encoded as CBOR text strings.<a href="#section-3.1-2.1.3.2.3" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1-2.1.4">
It is <span class="bcp14">REQUIRED</span> for application profiles of this specification to specify the exact format and encoding of scope (<a href="#req1" class="internal xref">REQ1</a>). This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format.<a href="#section-3.1-2.1.4" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.5">
If the application profile uses AIF, it is also <span class="bcp14">REQUIRED</span> to register its specific instance of "Toid" and "Tperm", as well as the corresponding media type and Content-Format, as per the guidelines in <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span> (<a href="#req2" class="internal xref">REQ2</a>).<a href="#section-3.1-2.1.5" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.6">
If the application profile uses the textual format, it <span class="bcp14">MAY</span> additionally specify CBOR values to use for abbreviating the role identifiers (<a href="#opt1" class="internal xref">OPT1</a>).<a href="#section-3.1-2.1.6" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">'audience': with an identifier of the KDC.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">As defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, other additional parameters can be included if necessary.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<span id="name-example-of-scope-using-aif"></span><div id="cddl-ex-0">
<figure id="figure-4">
          <div class="lang-cddl sourcecode" id="section-3.1-4.1">
<pre>
;# include rfc9237

gname = tstr

permissions = uint .bits roles

roles = &amp;(
   Requester: 1,
   Responder: 2,
   Monitor: 3,
   Verifier: 4
)

scope_entries = AIF-Generic&lt;gname, permissions&gt;

scope = bstr .cbor scope_entries
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-scope-using-aif" class="selfRef">Example of scope Using AIF</a>
          </figcaption></figure>
</div>
<span id="name-example-of-scope-using-the-"></span><div id="cddl-ex">
<figure id="figure-5">
          <div class="lang-cddl sourcecode" id="section-3.1-5.1">
<pre>
gname = tstr

role = tstr

scope_entry = [gname, ? ( role / [2* role] )]

scope_entries = [* scope_entry]

scope = bstr .cbor scope_entries
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-scope-using-the-" class="selfRef">Example of scope Using the Textual Format, with the Role Identifiers Encoded as Text Strings</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="ssec-authorization-response">
<section id="section-3.2">
        <h3 id="name-authorization-response">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-response" class="section-name selfRef">Authorization Response</a>
        </h3>
<p id="section-3.2-1">The AS processes the Authorization Request as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, especially verifying that the Client is authorized to access the specified groups with the requested roles or possibly a subset of those.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In case of successful verification, the Authorization Response sent from the AS to the Client is also defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Note that the 'expires_in' parameter  <span class="bcp14">MAY</span> be omitted if the application defines how the expiration time is communicated to the Client via other means or if it establishes a default value.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Additionally, when included, the following parameter <span class="bcp14">MUST</span> have the corresponding values:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">'scope' has the same format and encoding of 'scope' in the Authorization Request, as defined in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>. If this parameter is not present, the granted scope is equal to the one requested in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">The proof-of-possession access token in the 'access_token' parameter <span class="bcp14">MUST</span> contain the following:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">a confirmation claim (for example, see 'cnf' defined in <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="cite xref">RFC8747</a>]</span> for CWTs)<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">an expiration time claim (for example, see 'exp' defined in <span><a href="https://rfc-editor.org/rfc/rfc8392#section-3.1.4" class="relref">Section 3.1.4</a> of [<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> for CWTs)<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1">a scope claim (for example, see 'scope' registered in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.14" class="relref">Section 8.14</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> for CWTs)<a href="#section-3.2-6.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.2">If the 'scope' parameter is present in the Authorization Response, this claim specifies the same access control information as in the 'scope' parameter. Instead, if the 'scope' parameter is not present in the Authorization Response, this claim specifies the same access control information as in the 'scope' parameter of the Authorization Request, if the parameter is present therein, or the default scope that the AS is granting the Client otherwise.<a href="#section-3.2-6.3.2" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.3">
By default, this claim has the same encoding as the 'scope' parameter in the Authorization Request, as defined in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2-6.3.3" class="pilcrow">¶</a></p>
<p id="section-3.2-6.3.4">
Optionally, an alternative extended format of scope defined in <a href="#sec-extended-scope" class="auto internal xref">Section 7</a> can be used. This format explicitly signals the semantics used to express the actual access control information, which has to be parsed. This enables a Resource Server to correctly process a received access token, also in case:<a href="#section-3.2-6.3.4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.3.5.1">The Resource Server implements a KDC that supports multiple application profiles of this specification using different scope semantics and/or<a href="#section-3.2-6.3.5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-6.3.5.2">The Resource Server implements further services beyond a KDC for group communication using different scope semantics.<a href="#section-3.2-6.3.5.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.2-6.3.6">
If the Authorization Server is aware that this applies to the Resource Server for which the access token is issued, the Authorization Server <span class="bcp14">SHOULD</span> use the extended format of scope defined in <a href="#sec-extended-scope" class="auto internal xref">Section 7</a>.<a href="#section-3.2-6.3.6" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">The access token <span class="bcp14">MAY</span> additionally contain other claims that the transport profile of ACE or other optional parameters require.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">When receiving an Authorization Request from a Client that was previously authorized and for which the AS still stores a valid non-expired access token, the AS <span class="bcp14">MAY</span> reply with that token. Note that it is up to application profiles of ACE to make sure that reposting the same access token does not cause reuse of keying material between nodes (for example, that is accomplished with the use of random nonces in <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>).<a href="#section-3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-post">
<section id="section-3.3">
        <h3 id="name-token-transferring">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-transferring" class="section-name selfRef">Token Transferring</a>
        </h3>
<p id="section-3.3-1">The Client sends a Token Transfer Request to the KDC, i.e., a CoAP POST request including the access token and targeting the /authz-info endpoint (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Note that this request deviates from the one defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, since it allows asking the KDC for additional information concerning the authentication credentials used in the group to ensure source authentication, as well as for possible additional group parameters.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The joining node <span class="bcp14">MAY</span> ask for this information from the KDC through the same Token Transfer Request.
 In this case, the message <span class="bcp14">MUST</span> have Content-Format "application/ace+cbor" registered in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.16" class="relref">Section 8.16</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, and the message payload <span class="bcp14">MUST</span> be formatted as a CBOR map, which <span class="bcp14">MUST</span> include the access token. The CBOR map <span class="bcp14">MAY</span> additionally include the following parameter, which, if included, <span class="bcp14">MUST</span> have the format and value as specified below.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">'sign_info': defined in <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>, specifying the CBOR simple value <code>null</code> (0xf6) to request information about the signature algorithm, the signature algorithm parameters, the signature key parameters, and the exact format of authentication credentials used in the groups that the Client has been authorized to join.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-5">Alternatively, such information may be pre-configured on the joining node or may be retrieved by alternative means. For example, the joining node may have performed an early group discovery process and obtained the link to the associated group-membership resource at the KDC, along with attributes that describe the group configuration (e.g., see <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="cite xref">OSCORE-DISCOVERY</a>]</span>).<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">After successful verification, the Client is authorized to receive the group keying material from the KDC and join the group. Hence, the KDC replies to the Client with a Token Transfer Response, i.e., a  CoAP 2.01 (Created) response.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">The Token Transfer Response <span class="bcp14">MUST</span> have Content-Format "application/ace+cbor", and its payload is a CBOR map. Note that this deviates from what is defined in the ACE framework, where the response from the /authz-info endpoint is defined as conveying no payload (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">If a scope entry in the access token specifies a role that requires the Client to send its own authentication credential to the KDC when joining the related group, then the CBOR map <span class="bcp14">MUST</span> include the 'kdcchallenge' parameter defined in <a href="#kdcchallenge" class="auto internal xref">Section 3.3.2</a>, specifying a dedicated challenge N_S generated by the KDC.<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">Later, when joining the group (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>), the Client uses the 'kdcchallenge' value and additional information to build a proof-of-possession (PoP) input. In turn, this is used to compute the PoP evidence that the Client also provides to the KDC, in order to prove possession of its own private key (see the 'client_cred_verify' parameter in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">While storing the access token, the KDC <span class="bcp14">MUST</span> store the 'kdcchallenge' value associated with the Client at least until it receives a Join Request from the Client (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>) to be able to verify the PoP evidence provided during the join process and thus that the Client possesses its own private key. The KDC deletes the 'kdcchallenge' value associated with the Client upon deleting the access token (e.g., upon its expiration, see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.3" class="relref">Section 5.10.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">The same 'kdcchallenge' value <span class="bcp14">MAY</span> be reused several times by the Client to generate new PoP evidence, e.g., in case the Client provides the KDC with a new authentication credential while being a group member (see <a href="#update-pub-key" class="auto internal xref">Section 4.9.1.1</a>) or joins a different group where it intends to use a different authentication credential. Therefore, it is <span class="bcp14">RECOMMENDED</span> that the KDC keeps storing the 'kdcchallenge' value after the first join is processed as well. If, upon receiving a Join Request from a Client, the KDC has already discarded the 'kdcchallenge' value, that will trigger an error response with a newly generated 'kdcchallenge' value that the Client can use to restart the join process, as specified in <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3-12">If 'sign_info' is included in the Token Transfer Request, the KDC <span class="bcp14">SHOULD</span> include the 'sign_info' parameter in the Token Transfer Response, as per the format defined in <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>. Note that the field 'id' of each 'sign_info_entry' specifies the name or array of group names to which that 'sign_info_entry' applies. As an exception, the KDC <span class="bcp14">MAY</span> omit the 'sign_info' parameter in the Token Transfer Response even if 'sign_info' is included in the Token Transfer Request in case none of the groups that the Client is authorized to join use signatures to achieve source authentication.<a href="#section-3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3-13">Note that the CBOR map specified as payload of the 2.01 (Created) response may include further parameters, e.g., according to the used transport profile of ACE. Application profiles of this specification <span class="bcp14">MAY</span> define additional parameters to use within this exchange (<a href="#opt2" class="internal xref">OPT2</a>).<a href="#section-3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3-14">Application profiles of this specification <span class="bcp14">MAY</span> define alternative specific negotiations of parameter values for the signature algorithm and signature keys if 'sign_info' is not used (<a href="#opt3" class="internal xref">OPT3</a>).<a href="#section-3.3-14" class="pilcrow">¶</a></p>
<p id="section-3.3-15">If allowed by the used transport profile of ACE, the Client may provide the access token to the KDC by other means than the Token Transfer Request. An example is the DTLS transport profile of ACE, where the Client can provide the access token to the KDC during the secure session establishment (see <span><a href="https://rfc-editor.org/rfc/rfc9202#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>).<a href="#section-3.3-15" class="pilcrow">¶</a></p>
<div id="sign-info">
<section id="section-3.3.1">
          <h4 id="name-sign_info-parameter">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-sign_info-parameter" class="section-name selfRef">'sign_info' Parameter</a>
          </h4>
<p id="section-3.3.1-1">The 'sign_info' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the request and response messages exchanged between the Client and the /authz-info endpoint at the RS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">This parameter allows the Client and the RS to exchange information about a signature algorithm and about authentication credentials to accordingly use for signature verification. Its exact semantics and content are application specific.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">In this specification and in application profiles building on it, this parameter is used to exchange information about the signature algorithm and about authentication credentials to be used with it in the groups indicated by the transferred access token as per its 'scope' claim (see <a href="#ssec-authorization-response" class="auto internal xref">Section 3.2</a>).<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">When used in the Token Transfer Request sent to the KDC (see <a href="#token-post" class="auto internal xref">Section 3.3</a>), the 'sign_info' parameter specifies the CBOR simple value <code>null</code> (0xf6). This is done to ask for information about the signature algorithm and about the authentication credentials used in the groups that, as per the granted roles, the Client has been authorized to join or interact with (e.g., as an external signature verifier).<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">When used in the following Token Transfer Response from the KDC (see <a href="#token-post" class="auto internal xref">Section 3.3</a>), the 'sign_info' parameter is a CBOR array of one or more elements. The number of elements is at most the number of groups that the Client has been authorized to join or interact with. Each element contains information about signing parameters and about authentication credentials for one or more groups and is formatted as follows.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-6.1">The first element 'id' is a group name or a CBOR array of group names, which is associated with groups for which the next four elements apply. Each specified group name is a CBOR text string and is hereafter referred to as 'gname'.<a href="#section-3.3.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.2">The second element 'sign_alg' is a CBOR integer or a text string that indicates the signature algorithm used in the groups identified by the 'gname' values. It is <span class="bcp14">REQUIRED</span> for application profiles to define specific values that this parameter can take (<a href="#req3" class="internal xref">REQ3</a>), which are selected from the set of signing algorithms of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#section-3.3.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.3">The third element 'sign_parameters' is a CBOR array that indicates the parameters of the signature algorithm used in the groups identified by the 'gname' values. Its content depends on the value of 'sign_alg'. It is <span class="bcp14">REQUIRED</span> for application profiles to define the possible values and structure for the elements of this parameter (<a href="#req4" class="internal xref">REQ4</a>).<a href="#section-3.3.1-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.4">The fourth element 'sign_key_parameters' is a CBOR array that indicates the parameters of the key used with the signature algorithm in the groups identified by the 'gname' values. Its content depends on the value of 'sign_alg'. It is <span class="bcp14">REQUIRED</span> for application profiles to define the possible values and structure for the elements of this parameter (<a href="#req5" class="internal xref">REQ5</a>).<a href="#section-3.3.1-6.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.3.1-6.5">The fifth element 'cred_fmt' either is a CBOR integer indicating the format of authentication credentials used in the groups identified by the 'gname' values or is the CBOR simple value <code>null</code> (0xf6), which indicates that the KDC does not act as a repository of authentication credentials for group members. Its acceptable integer values are taken from the "Label" column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>, with some of those values also indicating the type of container to use for exchanging the authentication credentials with the KDC (e.g., a chain or bag of certificates). It is <span class="bcp14">REQUIRED</span> for application profiles to define specific values to use for this parameter, consistently with the acceptable formats of authentication credentials (<a href="#req6" class="internal xref">REQ6</a>).<a href="#section-3.3.1-6.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.1-7">The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the 'sign_info' parameter is given below.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-3.3.1-8">
<pre>
sign_info = sign_info_req / sign_info_resp

sign_info_req  = null                  ; in the Token Transfer
                                       ; Request to the KDC

sign_info_resp = [+ sign_info_entry]   ; in the Token Transfer
                                       ; Response from the KDC

sign_info_entry =
[
 id: gname / [+ gname],
 sign_alg: int / tstr,
 sign_parameters: [any],
 sign_key_parameters: [+ parameter: any],
 cred_fmt: int / null
]

gname = tstr
</pre><a href="#section-3.3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-9">This format is consistent with every signature algorithm currently defined in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, i.e., with algorithms that have only the COSE key type as their COSE capability. <a href="#sec-future-cose-algs" class="auto internal xref">Appendix B</a> describes how the format of each 'sign_info_entry' can be generalized for possible future registered algorithms having a different set of COSE capabilities.<a href="#section-3.3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kdcchallenge">
<section id="section-3.3.2">
          <h4 id="name-kdcchallenge-parameter">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-kdcchallenge-parameter" class="section-name selfRef">'kdcchallenge' Parameter</a>
          </h4>
<p id="section-3.3.2-1">The 'kdcchallenge' parameter is an <span class="bcp14">OPTIONAL</span> parameter of the response message returned from the /authz-info endpoint at the RS, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. This parameter contains a challenge generated by the RS and provided to the Client.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">In this specification and in application profiles building on it, the Client can use this challenge to prove possession of its own private key in the Join Request (see the 'client_cred_verify' parameter in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-distr">
<section id="section-4">
      <h2 id="name-kdc-functionalities">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-kdc-functionalities" class="section-name selfRef">KDC Functionalities</a>
      </h2>
<p id="section-4-1">This section describes the functionalities provided by the KDC, as related to the provisioning of the keying material as well as to the group membership management.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In particular, this section defines the interface available at the KDC, specifies the handlers of each resource provided by the KDC interface, and describes how Clients interact with those resources to join a group and to perform additional operations as group members.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">A key operation that the Client can perform after transferring the access token to the KDC is a Join Request-Response exchange with the KDC. In the Join Request, the Client specifies the group it requests to join (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>). The KDC will then check the stored access token associated with the Client and verify that the Client is accordingly authorized to join the specified group. In case of successful verification, the KDC provides the Client with the keying material to securely communicate with the other members of the group.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Later on as a group member, the Client can also rely on the interface at the KDC to perform additional operations consistent with the roles it has in the group.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="kdc-if">
<section id="section-4.1">
        <h3 id="name-interface-at-the-kdc">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-interface-at-the-kdc" class="section-name selfRef">Interface at the KDC</a>
        </h3>
<p id="section-4.1-1">The KDC provides its interface by hosting the following resources. Note that the root url-path "ace-group" used hereafter is a default name; implementations are not required to use this name and can define their own instead.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">If request messages sent to the KDC as well as success response messages from the KDC include a payload and specify a Content-Format, those messages <span class="bcp14">MUST</span> have Content-Format "application/ace-groupcomm+cbor", which is registered in <a href="#content-type" class="auto internal xref">Section 11.2</a>. CBOR map keys used for the message parameters are defined in <a href="#params" class="auto internal xref">Section 8</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">
            <p id="section-4.1-3.1.1">/ace-group : the path of this root resource is invariant once the resource is established. Its employment indicates that this specification is used. If other applications run on a KDC implementing this specification and use this same path, those applications will collide, and a mechanism will be needed to differentiate the endpoints.<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.1.2">
A Client can access this resource in order to retrieve a set of group names, each corresponding to one of the specified group identifiers. This operation is described in <a href="#retrieval-gnames" class="auto internal xref">Section 4.2.1.1</a>.<a href="#section-4.1-3.1.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.1.3">
Clients may be authorized to access this resource even without being members of any group managed by the KDC and even if they are not authorized to become group members (e.g., when authorized to be external signature verifiers).<a href="#section-4.1-3.1.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.1.4">
The Interface Description (if=) Link Target Attribute value "ace.groups" is registered in <a href="#if-ace-group" class="auto internal xref">Section 11.5</a> and can be used to describe the interface provided by this root resource.<a href="#section-4.1-3.1.4" class="pilcrow">¶</a></p>
<p id="section-4.1-3.1.5">
The example below shows an exchange with a KDC with address 2001:db8::ab that hosts the resource /ace-group and returns a link to such a resource in link-format <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>.<a href="#section-4.1-3.1.5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3.1.6">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: ".well-known"
Uri-Path: "core"
Uri-Query: "if=ace.groups"

Response:

Header: Content (Code=2.05)
Content-Format: 40 (application/link-format)
Payload:
  &lt;coap://[2001:db8::ab]/ace-group&gt;;if="ace.groups"
</pre><a href="#section-4.1-3.1.6" class="pilcrow">¶</a>
</div>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">/ace-group/GROUPNAME : one such sub-resource to /ace-group is hosted for each group with the name GROUPNAME that the KDC manages. In particular, it is the group-membership resource associated with that group, and it contains the symmetric group keying material of that group.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.2">
A Client can access this resource in order to join the group with name GROUPNAME or later as a group member to retrieve the current group keying material. These operations are described in Sections <a href="#ssec-key-distribution-exchange" class="auto internal xref">4.3.1.1</a> and <a href="#ssec-key-material-retrieval" class="auto internal xref">4.3.2.1</a>, respectively.<a href="#section-4.1-3.2.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.3">
The Interface Description (if=) Link Target Attribute value "ace.group" is registered in <a href="#if-ace-group" class="auto internal xref">Section 11.5</a> and can be used to describe the interface provided by a group-membership resource.<a href="#section-4.1-3.2.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.4">
The example below shows an exchange with a KDC with address 2001:db8::ab that hosts the group-membership resource /ace-group/gp1 and returns a link to such a resource in link-format <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>.<a href="#section-4.1-3.2.4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-3.2.5">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: ".well-known"
Uri-Path: "core"
Uri-Query: "if=ace.group"

Response:

Header: Content (Code=2.05)
Content-Format: 40 (application/link-format)
Payload:
  &lt;coap://[2001:db8::ab]/ace-group/gp1&gt;;if="ace.group"
</pre><a href="#section-4.1-3.2.5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3.2.6">
If it is not required that the value of the GROUPNAME URI path and the group name in the access token scope ('gname' in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>) coincide, the KDC <span class="bcp14">MUST</span> implement a mechanism to map the GROUPNAME value in the URI to the group name in order to refer to the correct group (<a href="#req7" class="internal xref">REQ7</a>).<a href="#section-4.1-3.2.6" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.3">
            <p id="section-4.1-3.3.1">/ace-group/GROUPNAME/creds : the path of this resource is invariant once the resource is established. This resource contains the authentication credentials of all the members of the group with the name GROUPNAME.<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.2">
This resource is created only in case the KDC acts as a repository of authentication credentials for group members.<a href="#section-4.1-3.3.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.3">
As a group member, a Client can access this resource in order to retrieve the authentication credentials of other group members. That is, the Client can retrieve the authentication credentials of all the current group members or a subset of them by specifying filter criteria. These operations are described in Sections <a href="#sec-key-retrieval-all" class="auto internal xref">4.4.2.1</a> and <a href="#sec-key-retrieval" class="auto internal xref">4.4.1.1</a>, respectively.<a href="#section-4.1-3.3.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.3.4">
Clients may be authorized to access this resource even without being group members, e.g., if authorized to be external signature verifiers for the group.<a href="#section-4.1-3.3.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.4">
            <p id="section-4.1-3.4.1">/ace-group/GROUPNAME/kdc-cred : the path of this resource is invariant once the resource is established. This resource contains the authentication credential of the KDC for the group with the name GROUPNAME.<a href="#section-4.1-3.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.2">
This resource is created only in case the KDC has an associated authentication credential and this is required for the correct group operation. It is <span class="bcp14">REQUIRED</span> for application profiles to define whether the KDC has such an associated authentication credential (<a href="#req8" class="internal xref">REQ8</a>).<a href="#section-4.1-3.4.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.3">
As a group member, a Client can access this resource in order to retrieve the current authentication credential of the KDC. This operation is described in   <a href="#kdc-pub-key" class="auto internal xref">Section 4.5.1.1</a>.<a href="#section-4.1-3.4.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.4.4">
Clients may be authorized to access this resource even without being group members, e.g., if authorized to be external signature verifiers for the group.<a href="#section-4.1-3.4.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.5">
            <p id="section-4.1-3.5.1">/ace-group/GROUPNAME/policies : the path of this resource is invariant once the resource is established. This resource contains the group policies of the group with the name GROUPNAME.<a href="#section-4.1-3.5.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.5.2">
A Client can access this resource as a group member in order to retrieve the group policies. This operation is described in <a href="#policies" class="auto internal xref">Section 4.6.1.1</a>.<a href="#section-4.1-3.5.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.6">
            <p id="section-4.1-3.6.1">/ace-group/GROUPNAME/num : the path of this resource is invariant once the resource is established. This resource contains the current version number for the symmetric group keying material of the group with the name GROUPNAME.<a href="#section-4.1-3.6.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.6.2">
A Client can access this resource as a group member in order to retrieve the version number of the keying material currently used in the group. This operation is described in <a href="#key-version" class="auto internal xref">Section 4.7.1.1</a>.<a href="#section-4.1-3.6.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.7">
            <p id="section-4.1-3.7.1">/ace-group/GROUPNAME/nodes/NODENAME : one such sub-resource of /ace-group/GROUPNAME is hosted for each group member of the group with the name GROUPNAME. Each such resource is identified by the node name NODENAME of the associated group member and contains the group keying material and the individual keying material for that group member.<a href="#section-4.1-3.7.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.7.2">
A Client as a group member can access this resource in order to retrieve the current group keying material together with its individual keying material, request new individual keying material to use in the group, and leave the group. These operations are described in Sections <a href="#update-keys" class="auto internal xref">4.8.1.1</a>, <a href="#new-keys" class="auto internal xref">4.8.2.1</a>, and <a href="#ssec-group-leaving" class="auto internal xref">4.8.3.1</a>, respectively.<a href="#section-4.1-3.7.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.8">
            <p id="section-4.1-3.8.1">/ace-group/GROUPNAME/nodes/NODENAME/cred : the path of this resource is invariant once the resource is established. This resource contains the individual authentication credential for the node with the name NODENAME as a group member of the group with the name GROUPNAME.<a href="#section-4.1-3.8.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.8.2">
A Client can access this resource in order to upload at the KDC a new authentication credential to use in the group. This operation is described in <a href="#update-pub-key" class="auto internal xref">Section 4.9.1.1</a>.<a href="#section-4.1-3.8.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.8.3">
This resource is not created if the group member does not have an authentication credential to use in the group or if the KDC does not store the authentication credentials of group members.<a href="#section-4.1-3.8.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-4">The KDC is expected to fully provide the interface defined above. It is otherwise <span class="bcp14">REQUIRED</span> for  the application profiles of this specification to indicate which resources are not hosted, i.e., which parts of the interface defined in this section are not supported by the KDC (<a href="#req9" class="internal xref">REQ9</a>). Application profiles of this specification <span class="bcp14">MAY</span> extend the KDC interface by defining additional handlers, as well as defining additional resources and their handlers.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">It is <span class="bcp14">REQUIRED</span> for application profiles of this specification to register a Resource Type for the group-membership resources (<a href="#req10" class="internal xref">REQ10</a>). This Resource Type can be used to discover the correct URL for sending a Join Request to the KDC. This Resource Type can also be used to indicate which specific application profile of this specification is used by a specific group-membership resource at the KDC.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">It is <span class="bcp14">REQUIRED</span> for application profiles of this specification to define what specific actions (e.g., CoAP methods) are allowed on each resource provided by the KDC interface, depending on whether the Client is a current group member, the roles that a Client is authorized to take as per the obtained access token (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>), and the roles that the Client has as current group member (<a href="#req11" class="internal xref">REQ11</a>).<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div id="client-operations">
<section id="section-4.1.1">
          <h4 id="name-operations-supported-by-cli">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-operations-supported-by-cli" class="section-name selfRef">Operations Supported by Clients</a>
          </h4>
<p id="section-4.1.1-1">It is expected that a Client minimally supports the following set of primary operations and corresponding interactions with the KDC.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-2.1">FETCH request to /ace-group/ in order to retrieve group names associated with group identifiers.<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.2">POST and GET requests to /ace-group/GROUPNAME/ in order to join a group (POST) and later retrieve the current group keying material as a group member (GET).<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.3">GET and FETCH requests to /ace-group/GROUPNAME/creds in order to retrieve the authentication credentials of all the other group members (GET) or only some of them by filtering (FETCH). While retrieving authentication credentials remains possible by using GET requests, retrieval by filtering allows Clients to greatly limit the size of exchanged messages.<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.4">GET request to /ace-group/GROUPNAME/num in order to retrieve the current version of the group keying material as a group member.<a href="#section-4.1.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.5">DELETE request to /ace-group/GROUPNAME/nodes/NODENAME  in order to leave the group.<a href="#section-4.1.1-2.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">In addition, some Clients may rather not support the following set of secondary operations and corresponding interactions with the KDC. This can be specified, for instance, in compliance documents defining minimalistic Clients and their capabilities in specific deployments. In turn, these might also have to consider the used application profile of this specification.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-4.1">GET request to /ace-group/GROUPNAME/kdc-cred in order to retrieve the current authentication credential of the KDC. This is relevant only if the KDC has an associated authentication credential and this is required for the correct group operation.<a href="#section-4.1.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.2">GET request to /ace-group/GROUPNAME/policies in order to retrieve the current group policies as a group member.<a href="#section-4.1.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.3">GET request to /ace-group/GROUPNAME/nodes/NODENAME in order to retrieve the current group keying material and individual keying material. The former can also be retrieved through a GET request to /ace-group/GROUPNAME/ (see above).<a href="#section-4.1.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.4">POST request to /ace-group/GROUPNAME/nodes/NODENAME in order to ask for new individual keying material. Alternatively, the Client could obtain new individual keying material by rejoining the group through a POST request to /ace-group/GROUPNAME/ (see above). Furthermore, depending on its roles in the group or on the application profile of this specification, the Client might simply not be associated with any individual keying material.<a href="#section-4.1.1-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-4.5">POST request to /ace-group/GROUPNAME/nodes/NODENAME/cred in order to provide the KDC with a new authentication credential. Alternatively, the Client could provide a new authentication credential by rejoining the group through a POST request to /ace-group/GROUPNAME/ (see above). Furthermore, depending on its roles in the group, the Client might simply not have an associated authentication credential to provide.<a href="#section-4.1.1-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-5">It is <span class="bcp14">REQUIRED</span> for application profiles of this specification to categorize possible newly defined operations for Clients into primary and secondary operations and to provide accompanying considerations (<a href="#req12" class="internal xref">REQ12</a>).<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kdc-if-errors">
<section id="section-4.1.2">
          <h4 id="name-error-handling">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
          </h4>
<p id="section-4.1.2-1">Upon receiving a request from a Client, the KDC <span class="bcp14">MUST</span> check that it is storing a valid access token from that Client. If this is not the case, the KDC <span class="bcp14">MUST</span> reply with a 4.01 (Unauthorized) error response.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">Unless the request targets the /ace-group resource, the KDC <span class="bcp14">MUST</span> check that it is storing a valid access token for that Client such that:<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-3.1">the scope specified in the access token includes a scope entry related to the group name GROUPNAME associated with the targeted resource and<a href="#section-4.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.2-3.2">the set of roles specified in that scope entry allows the Client to perform the requested operation on the targeted resource (<a href="#req11" class="internal xref">REQ11</a>).<a href="#section-4.1.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.2-4">In case the KDC stores a valid access token but the verifications above fail, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. This response <span class="bcp14">MAY</span> be an AS Request Creation Hints, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, in which case the Content-Format <span class="bcp14">MUST</span> be "application/ace+cbor".<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">If the request is not formatted correctly (e.g., required fields are not present or are not encoded as expected), the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">If the request includes unknown or unexpected fields, the KDC <span class="bcp14">MUST</span> silently ignore them and continue processing the request. Application profiles of this specification <span class="bcp14">MAY</span> define optional or mandatory payload formats for specific error cases (<a href="#opt4" class="internal xref">OPT4</a>).<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-4.1.2-7">Some error responses from the KDC can convey error-specific information according to the problem-details format defined in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>. Such error responses <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor". The payload of these error responses <span class="bcp14">MUST</span> be a CBOR map specifying a Concise Problem Details data item (see <span><a href="https://rfc-editor.org/rfc/rfc9290#section-2" class="relref">Section 2</a> of [<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>). The CBOR map is formatted as follows.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-8.1">
              <p id="section-4.1.2-8.1.1">It <span class="bcp14">MUST</span> include the Custom Problem Detail entry 'ace-groupcomm-error', which is registered in <a href="#iana-custom-problem-details" class="auto internal xref">Section 11.6</a> of this document.<a href="#section-4.1.2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8.1.2">
This entry is formatted as a CBOR map including only one field, namely 'error-id'. The map key for 'error-id' is the CBOR unsigned integer with value 0. The value of 'error-id' is a CBOR integer specifying the error that occurred at the KDC. This value is taken from the "Value" column of the "ACE Groupcomm Errors" registry defined in <a href="#iana-ace-groupcomm-errors" class="auto internal xref">Section 11.12</a> of this document.<a href="#section-4.1.2-8.1.2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8.1.3">
The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the 'ace-groupcomm-error' entry is given below.<a href="#section-4.1.2-8.1.3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.2-8.1.4">
<pre>
   ace-groupcomm-error = {
     &amp;(error-id: 0) =&gt; int
   }
</pre><a href="#section-4.1.2-8.1.4" class="pilcrow">¶</a>
</div>
</li>
            <li class="normal" id="section-4.1.2-8.2">
              <p id="section-4.1.2-8.2.1">It <span class="bcp14">MAY</span> include further Standard Problem Detail entries or Custom Problem Detail entries (see <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>).<a href="#section-4.1.2-8.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-8.2.2">
In particular, it can include the Standard Problem Detail entry 'detail' (map key -2), whose value is a CBOR text string that specifies a human-readable, diagnostic description of the error occurred at the KDC. The diagnostic text is intended for software engineers as well as for device and network operators in order to aid debugging and provide context for possible intervention. The diagnostic message <span class="bcp14">SHOULD</span> be logged by the KDC. The 'detail' entry is unlikely relevant in an unattended setup where human intervention is not expected.<a href="#section-4.1.2-8.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.1.2-9">An example of an error response using the problem-details format is shown in <a href="#fig-exapmle-error-response" class="auto internal xref">Figure 6</a>.<a href="#section-4.1.2-9" class="pilcrow">¶</a></p>
<span id="name-example-of-an-error-respons"></span><div id="fig-exapmle-error-response">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-4.1.2-10.1">
<pre>
Response:

Header: Service Unavailable (Code=5.03)
Content-Format: 257 (application/concise-problem-details+cbor)
Payload:
{
  / title /               -1: "No available individual keying material",
  / detail /              -2: "Things will change after a
                                group rekeying; try later",
  / ace-groupcomm-error /  0: {
    / error-id /  0: 4 / "No available individual keying material" /
  }
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-an-error-respons" class="selfRef">Example of an Error Response with Problem Details</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-11">The problem-details format (in general) and the Custom Problem Detail entry 'ace-groupcomm-error' (in particular) are <span class="bcp14">OPTIONAL</span> for Clients to support. A Client supporting the entry 'ace-groupcomm-error' and that can understand the specified error may use that information to determine what actions to take next.<a href="#section-4.1.2-11" class="pilcrow">¶</a></p>
<p id="section-4.1.2-12"><a href="#error-types" class="auto internal xref">Section 9</a> of this specification defines an initial set of error identifiers as possible values for the 'error-id' field. Application profiles of this specification inherit this initial set of error identifiers and <span class="bcp14">MAY</span> define additional values (<a href="#opt5" class="internal xref">OPT5</a>).<a href="#section-4.1.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ace-group">
<section id="section-4.2">
        <h3 id="name-ace-group">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-ace-group" class="section-name selfRef">/ace-group</a>
        </h3>
<p id="section-4.2-1">This resource implements the FETCH handler.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="ace-group-fetch">
<section id="section-4.2.1">
          <h4 id="name-fetch-handler">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-fetch-handler" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-4.2.1-1">The FETCH handler receives group identifiers and returns the corresponding group names and GROUPNAME URIs.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">The handler expects a request with the payload formatted as a CBOR map, which <span class="bcp14">MUST</span> contain the following fields:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">'gid': its value is encoded as a CBOR array, containing one or more group identifiers. The exact encoding of the group identifier <span class="bcp14">MUST</span> be specified by the application profile (<a href="#req13" class="internal xref">REQ13</a>). The Client indicates that it wishes to receive the group names of all the groups having these identifiers.<a href="#section-4.2.1-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-4">The handler identifies the groups where communications are secured by using the keying material identified by those group identifiers.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">If all verifications succeed, the handler replies with a 2.05 (Content) response, whose payload is formatted as a CBOR map that <span class="bcp14">MUST</span> contain the following fields:<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-6.1">'gid': its value is encoded as a CBOR array, containing zero or more group identifiers. The handler indicates that those are the identifiers it is sending group names for. This CBOR array is a subset of the 'gid' array in the FETCH request.<a href="#section-4.2.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.2">'gname': its value is encoded as a CBOR array, containing zero or more group names. The elements of this array are encoded as text strings. Each element of index i in this CBOR array is associated with the element of index i in the 'gid' array.<a href="#section-4.2.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-6.3">'guri': its value is encoded as a CBOR array, containing zero or more URIs, each indicating a group-membership resource. The elements of this array are encoded as text strings. Each element of index i in this CBOR array is associated with the element of index i in the 'gid' array.<a href="#section-4.2.1-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-7">If the KDC does not find any group associated with the specified group identifiers, the handler returns a response with the payload formatted as a CBOR byte string of zero length (0x40).<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">Note that the KDC only verifies that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verification on the group messages may be allowed to access this resource if the application needs it.<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<div id="retrieval-gnames">
<section id="section-4.2.1.1">
            <h5 id="name-retrieve-group-names">
<a href="#section-4.2.1.1" class="section-number selfRef">4.2.1.1. </a><a href="#name-retrieve-group-names" class="section-name selfRef">Retrieve Group Names</a>
            </h5>
<p id="section-4.2.1.1-1">In case the joining node only knows the group identifier of the group it wishes to join or about which it wishes to get updated information from the KDC, the node can contact the KDC to request the corresponding group name and group-membership resource URI. In particular, it does so by sending a CoAP FETCH request to the /ace-group endpoint at the KDC formatted as defined in <a href="#ace-group-fetch" class="auto internal xref">Section 4.2.1</a>. The node can specify several group identifiers at once.<a href="#section-4.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.1-2"><a href="#fig-ace-group-fetch" class="auto internal xref">Figure 7</a> gives an overview of the exchanges described above, and <a href="#fig-ace-group-fetch-2" class="auto internal xref">Figure 8</a> shows an example.<a href="#section-4.2.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-group-name-"></span><div id="fig-ace-group-fetch">
<figure id="figure-7">
              <div id="section-4.2.1.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.2.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,112" fill="none" stroke="black"></path>
                    <path d="M 520,32 L 520,112" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 128,48" fill="none" stroke="black"></path>
                    <path d="M 448,48 L 512,48" fill="none" stroke="black"></path>
                    <path d="M 40,96 L 56,96" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="520,48 508,42.4 508,53.6" fill="black" transform="rotate(0,512,48)"></polygon>
                    <polygon class="arrowhead" points="48,96 36,90.4 36,101.6" fill="black" transform="rotate(180,40,96)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="520" y="20">KDC</text>
                      <text x="288" y="52">Group Name and URI Retrieval Request:</text>
                      <text x="276" y="68">FETCH /ace-group</text>
                      <text x="292" y="100">Group Name and URI Retrieval Response: 2.05 (Content) --</text>
                    </g>
                  </svg><a href="#section-4.2.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-message-flow-of-group-name-" class="selfRef">Message Flow of Group Name and URI Retrieval Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-group-name-and-u"></span><div id="fig-ace-group-fetch-2">
<figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-4.2.1.1-4.1">
<pre>

Request:

Header: FETCH (Code=0.05)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / gid / 0: [1, 2]
}


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / gid /   0: [1, 2],
  / gname / 1: ["group1", "group2"],
  / guri /  2: ["/ace-group/g1", "/ace-group/g2"]
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-group-name-and-u" class="selfRef">Example of Group Name and URI Retrieval Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupname">
<section id="section-4.3">
        <h3 id="name-ace-group-groupname">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-ace-group-groupname" class="section-name selfRef">/ace-group/GROUPNAME</a>
        </h3>
<p id="section-4.3-1">This resource implements the POST and GET handlers.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div id="gid-post">
<section id="section-4.3.1">
          <h4 id="name-post-handler">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-post-handler" class="section-name selfRef">POST Handler</a>
          </h4>
<p id="section-4.3.1-1">The POST handler processes the Join Request sent by a Client to join a group and returns a Join Response as a successful result of the joining process (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>). At a high level, the POST handler adds the Client to the list of current group members, adds the authentication credential of the Client to the list of the group members' authentication credentials, and returns the symmetric group keying material for the group identified by GROUPNAME.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">The handler expects a request with payload formatted as a CBOR map, which <span class="bcp14">MAY</span> contain the following fields, which, if included, <span class="bcp14">MUST</span> have the format and value as specified below.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.1">'scope': its value specifies the name of the group that the Client is attempting to join and the roles that the client wishes to have in the group. This value is encoded as a CBOR byte string wrapping one scope entry, as defined in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>.<a href="#section-4.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-3.2">
              <p id="section-4.3.1-3.2.1">'get_creds': it is included if the Client wishes to receive the authentication credentials of the current group members from the KDC. This parameter may be included in the Join Request if the KDC stores the authentication credentials of the group members, while it is not useful to include it if the Client obtains those authentication credentials through alternative means, e.g., from the AS. Note that including this parameter might result in a following Join Response of a large size, which can be inconvenient for resource-constrained devices.<a href="#section-4.3.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.2">
If the Client wishes to retrieve the authentication credentials of all the current group members, the 'get_creds' parameter <span class="bcp14">MUST</span> encode the CBOR simple value <code>null</code> (0xf6). Otherwise, if the Client wishes to retrieve the authentication credentials of nodes with specific roles, the 'get_creds' parameter <span class="bcp14">MUST</span> encode a non-empty CBOR array containing the three elements 'inclusion_flag', 'role_filter', and 'id_filter', as defined below.<a href="#section-4.3.1-3.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.2.3.1">The first element, namely 'inclusion_flag', encodes the CBOR simple value <code>true</code> (0xf5) if the Client wishes to receive the authentication credentials of the nodes having their node identifier specified in 'id_filter' (i.e., selection by inclusive filtering). Instead, this element encodes the CBOR simple value <code>false</code> (0xf4) if the Client wishes to receive the authentication credentials of the nodes that do not have the node identifiers specified in the third element 'id_filter' (i.e., selection by exclusive filtering). In the Join Request, this parameter encodes the CBOR simple value <code>true</code> (0xf5).<a href="#section-4.3.1-3.2.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-3.2.3.2">
                  <p id="section-4.3.1-3.2.3.2.1">The second element, namely 'role_filter', is a CBOR array. Each element of the array contains one role or a combination of roles for the group identified by GROUPNAME. This parameter indicates that the Client wishes to receive the authentication credentials of all the group members having any of the specified roles or combination of roles (i.e., having any of those single roles or at least all the roles indicated in any of those combinations of roles).<a href="#section-4.3.1-3.2.3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.3.2.2">
For example, the array ["role1", "role2+role3"] indicates that the Client wishes to receive the authentication credentials of all group members that have at least "role1" or at least both "role2" and "role3". In the Join Request, this parameter is a non-empty array.<a href="#section-4.3.1-3.2.3.2.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.3.1-3.2.3.3">
                  <p id="section-4.3.1-3.2.3.3.1">The third element, namely 'id_filter', is a CBOR array. Each element of the array contains a node identifier of a group member for the group identified by GROUPNAME. This parameter indicates that the Client wishes to receive the authentication credentials of the nodes that have or do not have the specified node identifiers based on the value of 'inclusion_flag' (i.e., as a selection by inclusive or exclusive filtering). In the Join Request, the Client does not filter authentication credentials based on node identifiers, so this parameter is an empty array.<a href="#section-4.3.1-3.2.3.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.3.3.2">
In fact, when first joining the group, the Client is not expected or capable to express a filter based on node identifiers of other group members. Instead, when already a group member and sending a Join Request to rejoin, the Client is not expected to include the 'get_creds' parameter in the Join Request altogether, since it can rather retrieve authentication credentials associated with specific group identifiers as defined in <a href="#sec-key-retrieval" class="auto internal xref">Section 4.4.1.1</a>.<a href="#section-4.3.1-3.2.3.3.2" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-4.3.1-3.2.4">
The CDDL definition <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of 'get_creds' is given in <a href="#cddl-ex-getpubkeys" class="auto internal xref">Figure 9</a>; as an example, it uses node identifiers encoded as CBOR byte strings, role identifiers encoded as CBOR text strings, and combinations of roles encoded as CBOR arrays of role identifiers.<a href="#section-4.3.1-3.2.4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.2.5">
Note that, for this handler, 'inclusion_flag' is always set to true and the array of roles 'role_filter' is always non-empty, while the array of node identifiers 'id_filter' is always empty. However, this is not necessarily the case for other handlers using the 'get_creds' parameter.<a href="#section-4.3.1-3.2.5" class="pilcrow">¶</a></p>
<span id="name-cddl-definition-of-get_cred"></span><div id="cddl-ex-getpubkeys">
<figure id="figure-9">
                <div class="lang-cddl sourcecode" id="section-4.3.1-3.2.6.1">
<pre>
inclusion_flag = bool

role = tstr
comb_role = [2* role]
role_filter = [* ( role / comb_role )]

id = bstr
id_filter = [* id]

get_creds = null / [inclusion_flag, role_filter, id_filter]
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-cddl-definition-of-get_cred" class="selfRef">CDDL Definition of 'get_creds', Using an Example Node Identifier Encoded as bstr and Role as tstr</a>
                </figcaption></figure>
</div>
</li>
            <li class="normal" id="section-4.3.1-3.3">'client_cred': encoded as a CBOR byte string, whose value is the original binary representation of the Client's authentication credential. This parameter <span class="bcp14">MUST</span> be present if the KDC is managing (collecting from and distributing to Clients) the authentication credentials of the group members and the Client's role in the group will require the Client to send messages to one or more group members. It is <span class="bcp14">REQUIRED</span> for application profiles to define the specific formats that are acceptable to use for authentication credentials in the group (<a href="#req6" class="internal xref">REQ6</a>).<a href="#section-4.3.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-3.4">'cnonce': encoded as a CBOR byte string, whose value is a dedicated nonce N_C generated by the Client. This parameter <span class="bcp14">MUST</span> be present.<a href="#section-4.3.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-3.5">
              <p id="section-4.3.1-3.5.1">'client_cred_verify': encoded as a CBOR byte string. This parameter <span class="bcp14">MUST</span> be present if the 'client_cred' parameter is present and no authentication credential associated with the Client's access token can be retrieved for that group.<a href="#section-4.3.1-3.5.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.5.2">
The value of the CBOR byte string is the proof-of-possession (PoP) evidence computed by the Client over the following PoP input: the scope (encoded as a CBOR byte string) concatenated with N_S (encoded as a CBOR byte string) concatenated with N_C (encoded as a CBOR byte string), where:<a href="#section-4.3.1-3.5.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-3.5.3.1">scope is either specified in the 'scope' parameter above, if present, or a default scope entry that the handler is expected to know otherwise;<a href="#section-4.3.1-3.5.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-3.5.3.2">N_S is the challenge received from the KDC in the 'kdcchallenge' parameter of the 2.01 (Created) response to the Token Transfer Request (see <a href="#token-post" class="auto internal xref">Section 3.3</a>), encoded as a CBOR byte string; and<a href="#section-4.3.1-3.5.3.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-3.5.3.3">N_C is the nonce generated by the Client and specified in the 'cnonce' parameter above, encoded as a CBOR byte string.<a href="#section-4.3.1-3.5.3.3" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.3.1-3.5.4">
An example of PoP input to compute 'client_cred_verify' using CBOR encoding is given in <a href="#fig-client-cred-input" class="auto internal xref">Figure 10</a>.<a href="#section-4.3.1-3.5.4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.5.5">
A possible type of PoP evidence is a signature that the Client computes by using its own private key, whose corresponding public key is specified in the authentication credential carried in the 'client_cred' parameter. Application profiles of this specification <span class="bcp14">MUST</span> specify the exact approaches used to compute the PoP evidence to include in 'client_cred_verify' and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req14" class="internal xref">REQ14</a>).<a href="#section-4.3.1-3.5.5" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.5.6">
If the access token was not provided to the KDC through a Token Transfer Request (e.g., the access token is instead transferred during the establishment of a secure communication association), it is <span class="bcp14">REQUIRED</span> of the specific application profile to define how the challenge N_S is generated (<a href="#req15" class="internal xref">REQ15</a>).<a href="#section-4.3.1-3.5.6" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-3.6">'creds_repo': it can be present if the format of the Client's authentication credential conveyed in the 'client_cred' parameter is a certificate. In such a case, this parameter has as its value the URI of the certificate. This parameter is encoded as a CBOR text string. Alternative specific encodings of this parameter <span class="bcp14">MAY</span> be defined in application profiles of this specification (<a href="#opt6" class="internal xref">OPT6</a>).<a href="#section-4.3.1-3.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-3.7">
              <p id="section-4.3.1-3.7.1">'control_uri': its value is a full URI, encoded as a CBOR text string. A default url-path is /ace-group/GROUPNAME/node, although implementations can use different ones instead. The URI <span class="bcp14">MUST NOT</span> have url-path /ace-group/GROUPNAME.<a href="#section-4.3.1-3.7.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.7.2">
If 'control_uri' is specified in the Join Request, the Client acts as a CoAP server and hosts a resource at this specific URI. The KDC <span class="bcp14">MAY</span> use this URI to send CoAP requests to the Client (acting as a CoAP server in this exchange), for example, for one-to-one provisioning of new group keying material when performing a group rekeying (see <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a>) or to inform the Client of its removal from the group (see <a href="#sec-node-removal" class="auto internal xref">Section 5</a>).<a href="#section-4.3.1-3.7.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3.7.3">
In particular, this resource is intended for communications exclusively concerning the group identified by GROUPNAME and whose group name is specified in the 'scope' parameter of the Join Request, if present therein. If the KDC does not implement mechanisms using this resource for that group, it can ignore this parameter. Other additional functionalities of this resource <span class="bcp14">MAY</span> be defined in application profiles of this specifications (<a href="#opt7" class="internal xref">OPT7</a>).<a href="#section-4.3.1-3.7.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-example-of-pop-input-to-com"></span><div id="fig-client-cred-input">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-4.3.1-4.1">
<pre>
scope, N_S, and N_C expressed in CBOR diagnostic notation:
  scope = h'826667726f7570316673656e646572'
  N_S   = h'018a278f7faab55a'
  N_C   = h'25a8991cd700ac01'


scope, N_S, and N_C as CBOR encoded byte strings:
  scope = 0x4f826667726f7570316673656e646572
  N_S   = 0x48018a278f7faab55a
  N_C   = 0x4825a8991cd700ac01

PoP input:
  0x4f 826667726f7570316673656e646572
    48 018a278f7faab55a 48 25a8991cd700ac01
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-pop-input-to-com" class="selfRef">Example of PoP Input to Compute 'client_cred_verify' Using CBOR Encoding</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-5">If the request does not include the 'scope'  parameter, the KDC is expected to understand what roles the Client is requesting to join the group with. For example, as per the access token, the Client might have been granted access to the group with only one role. If the KDC cannot determine which exact roles should be considered for the Client, it <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1-6">The handler considers the scope specified in the access token associated with the Client and checks the scope entry related to the group identified by the GROUPNAME associated with the endpoint. In particular, the handler checks whether the set of roles specified in that scope entry includes all the roles that the Client wishes to have in the group as per the Join Request. If this is not the case, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response.<a href="#section-4.3.1-6" class="pilcrow">¶</a></p>
<p id="section-4.3.1-7">If the KDC manages the group members' authentication credentials, the handler checks if one is included in the 'client_cred' parameter. If so, the KDC retrieves the authentication credential and performs the following actions.<a href="#section-4.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-8.1">If the access token was provided through a Token Transfer Request (see <a href="#token-post" class="auto internal xref">Section 3.3</a>) but the KDC cannot retrieve the 'kdcchallenge' associated with this Client (see <a href="#token-post" class="auto internal xref">Section 3.3</a>), the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response, which <span class="bcp14">MUST</span> also have Content-Format "application/ace-groupcomm+cbor". The payload of the error response is a CBOR map including a newly generated 'kdcchallenge' value, which is specified in the 'kdcchallenge' parameter. The KDC <span class="bcp14">MUST</span> store the newly generated value as the 'kdcchallenge' value associated with this Client, replacing the currently stored value (if any).<a href="#section-4.3.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-8.2">
              <p id="section-4.3.1-8.2.1">The KDC checks the authentication credential to be valid for the group identified by GROUPNAME. That is, it checks that the authentication credential has the format used in the group, is intended for the public key algorithm used in the group, and is aligned with the possible associated parameters used in the group.<a href="#section-4.3.1-8.2.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-8.2.2">
If this verification fails, the handler <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 2 ("Authentication credential incompatible with the group configuration").<a href="#section-4.3.1-8.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-8.3">
              <p id="section-4.3.1-8.3.1">The KDC verifies the PoP evidence conveyed in the 'client_cred_verify' parameter. Application profiles of this specification <span class="bcp14">MUST</span> specify the exact approaches used to verify the PoP evidence and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req14" class="internal xref">REQ14</a>).<a href="#section-4.3.1-8.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-8.3.2">
If the PoP evidence does not pass verification, the handler <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format  "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 3 ("Invalid proof-of-possession evidence").<a href="#section-4.3.1-8.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.3.1-9">If no authentication credential is conveyed in the 'client_cred' parameter, the handler checks if the KDC currently stores an authentication credential that is associated with the access token and with the group identified by GROUPNAME (see also <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>). Note that the same joining node may use different authentication credentials in different groups, and all those authentication credentials would be associated with the same access token.<a href="#section-4.3.1-9" class="pilcrow">¶</a></p>
<p id="section-4.3.1-10">If an eligible authentication credential for the Client is neither present in the 'client_cred' parameter nor retrieved from the stored ones at the KDC, it is <span class="bcp14">RECOMMENDED</span> that the handler stops the processing and replies with a 4.00 (Bad Request) error response. Application profiles <span class="bcp14">MAY</span> define alternatives (<a href="#opt8" class="internal xref">OPT8</a>).<a href="#section-4.3.1-10" class="pilcrow">¶</a></p>
<p id="section-4.3.1-11">If, regardless of the reason, the KDC replies with a 4.00 (Bad Request) error response, the payload of the response <span class="bcp14">MAY</span> be a CBOR map. For instance, the CBOR map can include a 'sign_info' parameter formatted as 'sign_info_resp' defined in <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>, with the 'cred_fmt' element set to the CBOR simple value <code>null</code> (0xf6) if the Client sent its own authentication credential and the KDC is not set to store authentication credentials of the group members. When the response payload is a CBOR map including such parameters, the error response has Content-Format "application/ace-groupcomm+cbor".<a href="#section-4.3.1-11" class="pilcrow">¶</a></p>
<p id="section-4.3.1-12">If all the verifications above succeed, the KDC proceeds as follows.<a href="#section-4.3.1-12" class="pilcrow">¶</a></p>
<p id="section-4.3.1-13">First, only in case the Client is not already a group member, the handler performs the following actions:<a href="#section-4.3.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-14.1">The handler adds the Client to the list of current members of the group.<a href="#section-4.3.1-14.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-14.2">The handler assigns a name NODENAME to the Client and creates a sub-resource to /ace-group/GROUPNAME at the KDC, i.e., /ace-group/GROUPNAME/nodes/NODENAME.<a href="#section-4.3.1-14.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-14.3">The handler associates the node identifier NODENAME with the access token and the secure communication association for the Client.<a href="#section-4.3.1-14.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-15">Then, the handler performs the following actions.<a href="#section-4.3.1-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-16.1">
              <p id="section-4.3.1-16.1.1">If the KDC manages the group members' authentication credentials:<a href="#section-4.3.1-16.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-16.1.2.1">The handler associates the retrieved Client's authentication credential with the tuple composed of the node name NODENAME, the group name GROUPNAME, and the access token.<a href="#section-4.3.1-16.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-16.1.2.2">The handler adds the retrieved Client's authentication credential to the list of authentication credentials stored for the group identified by GROUPNAME. If such a list already includes an authentication credential for the Client, but a different authentication credential is specified in the 'client_cred' parameter, then the handler <span class="bcp14">MUST</span> replace the old authentication credential in the list with the one specified in the 'client_cred' parameter.<a href="#section-4.3.1-16.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-4.3.1-16.2">If backward security is prescribed by application policies installed at the KDC or by the used application profile of this specification, then the KDC <span class="bcp14">MUST</span> generate new group keying material and securely distribute it to the current group members (see <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>).<a href="#section-4.3.1-16.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-16.3">The handler returns a successful Join Response, as defined below, which contains the symmetric group keying material, the group policies, and the authentication credentials of the current members of the group if the KDC manages those and the Client requested those.<a href="#section-4.3.1-16.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-17">The Join Response <span class="bcp14">MUST</span> have response code 2.01 (Created) if the Client has been added to the list of group members in this join exchange (see above) or 2.04 (Changed) otherwise, i.e., if the Client is rejoining the group without having left it.<a href="#section-4.3.1-17" class="pilcrow">¶</a></p>
<p id="section-4.3.1-18">The Join Response message <span class="bcp14">MUST</span> include the Location-Path CoAP Options, specifying the path to the sub-resource associated with the Client, i.e., /ace-group/GROUPNAME/nodes/NODENAME.<a href="#section-4.3.1-18" class="pilcrow">¶</a></p>
<p id="section-4.3.1-19">The Join Response message <span class="bcp14">MUST</span> have Content-Format "application/ace-groupcomm+cbor". The payload of the response is formatted as a CBOR map, which <span class="bcp14">MUST</span> contain the following fields with the values specified below:<a href="#section-4.3.1-19" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-20.1">'gkty': identifying the key type of the keying material specified in the 'key' parameter. This parameter is encoded as a CBOR integer or a CBOR text string. Possible values are taken from the "Key Type Value" column of the "ACE Groupcomm Key Types" registry defined in <a href="#iana-key" class="auto internal xref">Section 11.8</a> of this specification. Implementations <span class="bcp14">MUST</span> verify that the key type specified by this parameter matches the application profile being used and, if applicable, that such an application profile is listed in the "Profile" column of the "ACE Groupcomm Key Types" registry for the key type in question.<a href="#section-4.3.1-20.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-20.2">'key': containing the keying material used for securing the group communication or information required to derive such keying material.<a href="#section-4.3.1-20.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-20.3">'num': containing the current version number of the group keying material, encoded as a CBOR integer. The version number has a value that increases in a strictly monotonic way as the group keying material changes. The application profile <span class="bcp14">MUST</span> define the initial value of the version number (<a href="#req16" class="internal xref">REQ16</a>).<a href="#section-4.3.1-20.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-21">The format of the keying material conveyed in the 'key' parameter <span class="bcp14">MUST</span> be defined in application profiles of this specification (<a href="#req17" class="internal xref">REQ17</a>), together with corresponding key types to specify as value of the 'gkty' parameter and that are accepted by the application (<a href="#req18" class="internal xref">REQ18</a>). Additionally, documents specifying a type of keying material <span class="bcp14">MUST</span> register an entry in the "ACE Groupcomm Key Types" registry defined in <a href="#iana-key" class="auto internal xref">Section 11.8</a>, including its name, the corresponding key type to specify as value for the 'gkty' parameter, and the application profile to be used with.<a href="#section-4.3.1-21" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-key-types"></span><div id="fig-gkty">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-ace-groupcomm-key-types" class="selfRef">ACE Groupcomm Key Types</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Key Type Value</th>
                <th class="text-left" rowspan="1" colspan="1">Profile</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">This value is reserved</td>
                <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.1-23">The Join Response <span class="bcp14">SHOULD</span> contain the following fields with the values specified below:<a href="#section-4.3.1-23" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-24.1">'exp': its value specifies the expiration time of the group keying material specified in the 'key' parameter, encoded as a CBOR unsigned integer. The value is the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what is specified for NumericDate in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. After the time indicated in this parameter, group members <span class="bcp14">MUST NOT</span> use the group keying material specified in the 'key' parameter. The group members can retrieve the latest group keying material from the KDC.<a href="#section-4.3.1-24.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-24.2">'exi': its value specifies the residual lifetime of the group keying material, encoded as a CBOR unsigned integer. If the 'exp' parameter is included, this parameter <span class="bcp14">MUST</span> also be included. The value represents the residual lifetime of the group keying material specified in the 'key' parameter, i.e., it is the number of seconds between the current time at the KDC and the time when the keying material expires (as specified in the 'exp' parameter, if present). A Client determines the expiration time of the keying material by adding the seconds specified in the 'exi' parameter to its current time upon receiving the Join Response containing the 'exi' parameter. After such an expiration time, the Client <span class="bcp14">MUST NOT</span> use the group keying material specified in the 'key' parameter. The Client can retrieve the latest group keying material from the KDC.<a href="#section-4.3.1-24.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-25">If a Client has a reliable way to synchronize its internal clock with UTC, and both the 'exp' and 'exi' parameters are present, then the Client <span class="bcp14">MUST</span> use the 'exp' parameter value as expiration time for the group keying material. Otherwise, the Client uses the 'exi' parameter value to determine the expiration time as defined above.<a href="#section-4.3.1-25" class="pilcrow">¶</a></p>
<p id="section-4.3.1-26">When a Client relies on the 'exi' parameter, the expiration time that it computes is offset in the future with respect to the actual expiration time as intended by the KDC and specified in the 'exp' parameter (if present). Such an offset is the amount of time between when the KDC sends the response message including the 'exi' parameter and when the Client receives that message. That is, especially if the delivery of the response to the Client is delayed, the Client will believe the keying material to be valid for a longer time than the KDC actually means. However, before approaching the actual expiration time, the KDC is expected to rekey the group and distribute new keying material (see <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>).<a href="#section-4.3.1-26" class="pilcrow">¶</a></p>
<p id="section-4.3.1-27">Optionally, the Join Response <span class="bcp14">MAY</span> contain the following parameters, which, if included, <span class="bcp14">MUST</span> have the format and value as specified below.<a href="#section-4.3.1-27" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-28.1">
              <p id="section-4.3.1-28.1.1">'ace_groupcomm_profile': its value is encoded as a CBOR integer and <span class="bcp14">MUST</span> be used to uniquely identify the application profile for group communication. Applications of this specification <span class="bcp14">MUST</span> register an application profile identifier and the related value for this parameter in the "ACE Groupcomm Profiles" registry (<a href="#req19" class="internal xref">REQ19</a>).<a href="#section-4.3.1-28.1.1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-profiles"></span><div id="ace-groupcomm-profile-0">
<table class="center" id="table-2">
                <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-ace-groupcomm-profiles" class="selfRef">ACE Groupcomm Profiles</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Name</th>
                    <th class="text-left" rowspan="1" colspan="1">Description</th>
                    <th class="text-left" rowspan="1" colspan="1">CBOR Value</th>
                    <th class="text-left" rowspan="1" colspan="1">Reference</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                    <td class="text-left" rowspan="1" colspan="1">This value is reserved</td>
                    <td class="text-left" rowspan="1" colspan="1">0</td>
                    <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
                  </tr>
                </tbody>
              </table>
</div>
</li>
            <li class="normal" id="section-4.3.1-28.2">'creds': it <span class="bcp14">MUST</span> be present if 'get_creds' was present in the Join Request; otherwise, it <span class="bcp14">MUST NOT</span> be present. Its value is encoded as a CBOR array specifying the authentication credentials of the group members, i.e., of all of them or of the ones selected according to the 'get_creds' parameter in the Join Request. In particular, each element of the array is a CBOR byte string, whose value is the original binary representation of a group member's authentication credential. It is <span class="bcp14">REQUIRED</span> for application profiles to define the specific formats of authentication credentials that are acceptable to use in the group (<a href="#req6" class="internal xref">REQ6</a>).<a href="#section-4.3.1-28.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.3">
              <p id="section-4.3.1-28.3.1">'peer_roles': it <span class="bcp14">SHOULD</span> be present if 'creds' is also present; otherwise, it <span class="bcp14">MUST NOT</span> be present. Its value is encoded as a CBOR array of n elements, where n is the number of authentication credentials included in the 'creds' parameter (at most, the number of members in the group). The i-th element of the array specifies the role(s) that the group member associated with the i-th authentication credential in 'creds' has in the group. In particular, each array element is encoded like the role element of a scope entry, which is consistent with the used format (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>).<a href="#section-4.3.1-28.3.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.3.2">
This parameter <span class="bcp14">MAY</span> be omitted if the Client can rely on other means to unambiguously gain knowledge of the role of each group member whose associated authentication credential is specified in the 'creds' parameter. For example, all such group members may have the same role in the group joined by the Client, and such a role can be unambiguously assumed by the Client (e.g., based on what is defined in the used application profile of this specification). As another example, each of the authentication credentials specified in the 'creds' parameter can indicate the role(s) that the corresponding group member has in the group joined by the Client.<a href="#section-4.3.1-28.3.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.3.3">
When receiving the authentication credential of a Client in the 'client_cred' parameter of a Join Request (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>) or of an Authentication Credential Update Request (see <a href="#update-pub-key" class="auto internal xref">Section 4.9.1.1</a>), the KDC is not expected to check that the authentication credential indicates the role(s) that the Client can have or has in the group in question. When preparing a Join Response, the KDC can decide whether to include the 'peer_roles' parameter, depending on the specific set of authentication credentials specified in the 'creds' parameter of that Join Response.<a href="#section-4.3.1-28.3.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-28.4">'peer_identifiers': it <span class="bcp14">MUST</span> be present if 'creds' is also present; otherwise, it <span class="bcp14">MUST NOT</span> be present. Its value is encoded as a CBOR array of n elements, where n is the number of authentication credentials included in the 'creds' parameter (at most, the number of members in the group). The i-th element of the array specifies the node identifier that the group member associated with the i-th authentication credential in 'creds' has in the group. In particular, the i-th array element is encoded as a CBOR byte string, whose value is the node identifier of the group member. The specific format of node identifiers of group members is specified by the application profile (<a href="#req25" class="internal xref">REQ25</a>).<a href="#section-4.3.1-28.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.5">
              <p id="section-4.3.1-28.5.1">'group_policies': its value is encoded as a CBOR map, whose elements specify how the group handles specific management aspects. These include, for instance, approaches to achieve synchronization of sequence numbers among group members. The possible elements of the CBOR map are registered in the "ACE Groupcomm Policies" registry defined in <a href="#ace-groupcomm-policies" class="auto internal xref">Section 11.10</a> of this specification. This specification defines the three elements "Sequence Number Synchronization Methods", "Key Update Check Interval", and "Expiration Delta", which are summarized in <a href="#fig-ACE-Groupcomm-Policies" class="auto internal xref">Table 3</a>. Application profiles of this specification <span class="bcp14">MUST</span> specify the format and default values for the entries of the CBOR map conveyed in the 'group_policies' parameter (<a href="#req20" class="internal xref">REQ20</a>).<a href="#section-4.3.1-28.5.1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-policies"></span><div id="fig-ACE-Groupcomm-Policies">
<table class="center" id="table-3">
                <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-ace-groupcomm-policies" class="selfRef">ACE Groupcomm Policies</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Name</th>
                    <th class="text-left" rowspan="1" colspan="1">CBOR Label</th>
                    <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
                    <th class="text-left" rowspan="1" colspan="1">Description</th>
                    <th class="text-left" rowspan="1" colspan="1">Reference</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Sequence Number Synchronization Method</td>
                    <td class="text-left" rowspan="1" colspan="1">0</td>
                    <td class="text-left" rowspan="1" colspan="1">int or tstr</td>
                    <td class="text-left" rowspan="1" colspan="1"> Method for recipient group members to synchronize with sequence numbers of sender group members. Its value is taken from the "Value" column of the "Sequence Number Synchronization Method" registry.</td>
                    <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Key Update Check Interval</td>
                    <td class="text-left" rowspan="1" colspan="1">1</td>
                    <td class="text-left" rowspan="1" colspan="1">int</td>
                    <td class="text-left" rowspan="1" colspan="1">Polling interval in seconds, for group members to check at the KDC if the latest group keying material is the one that they store.</td>
                    <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Expiration Delta</td>
                    <td class="text-left" rowspan="1" colspan="1">2</td>
                    <td class="text-left" rowspan="1" colspan="1">uint</td>
                    <td class="text-left" rowspan="1" colspan="1">Number of seconds from 'exp' until a UTC date/time, after which group members <span class="bcp14">MUST</span> stop using the group keying material that they store to decrypt incoming messages.</td>
                    <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
                  </tr>
                </tbody>
              </table>
</div>
</li>
            <li class="normal" id="section-4.3.1-28.6">
              <p id="section-4.3.1-28.6.1">'kdc_cred': its value is the original binary representation of the KDC's authentication credential, encoded as a CBOR byte string. This parameter is used if the KDC has an associated authentication credential and this is required for the correct group operation. It is <span class="bcp14">REQUIRED</span> for application profiles to define whether the KDC has an authentication credential as required for the correct group operation and if this has to be provided through the 'kdc_cred' parameter (<a href="#req8" class="internal xref">REQ8</a>).<a href="#section-4.3.1-28.6.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.6.2">
If the KDC has an authentication credential as required for the correct group operation, the KDC's authentication credential <span class="bcp14">MUST</span> have the same format used for the authentication credentials of the group members. It is <span class="bcp14">REQUIRED</span> for application profiles to define the specific formats that are acceptable to use for the authentication credentials in the group (<a href="#req6" class="internal xref">REQ6</a>).<a href="#section-4.3.1-28.6.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-28.7">'kdc_nonce': its value is a dedicated nonce N_KDC generated by the KDC, encoded as a CBOR byte string. This parameter <span class="bcp14">MUST</span> be present if the 'kdc_cred' parameter is present.<a href="#section-4.3.1-28.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-28.8">
              <p id="section-4.3.1-28.8.1">'kdc_cred_verify': its value is as defined below and is encoded as a CBOR byte string. This parameter <span class="bcp14">MUST</span> be present if the 'kdc_cred' parameter is present.<a href="#section-4.3.1-28.8.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.8.2">
The value of this parameter is the proof-of-possession (PoP) evidence computed by the KDC over the following PoP input: the nonce N_C (encoded as a CBOR byte string) concatenated with the nonce N_KDC (encoded as a CBOR byte string), where:<a href="#section-4.3.1-28.8.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-28.8.3.1">N_C is the nonce generated by the Client and specified in the 'cnonce' parameter of the Join Request.<a href="#section-4.3.1-28.8.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.3.1-28.8.3.2">N_KDC is the nonce generated by the KDC and specified in the 'kdc_nonce' parameter.<a href="#section-4.3.1-28.8.3.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.3.1-28.8.4">
An example of PoP input to compute 'kdc_cred_verify' using CBOR encoding is given in <a href="#fig-kdc-cred-input" class="auto internal xref">Figure 11</a>.<a href="#section-4.3.1-28.8.4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.8.5">
A possible type of PoP evidence is a signature that the KDC computes by using its own private key, whose corresponding public key is specified in the authentication credential conveyed in the 'kdc_cred' parameter. Application profiles of this specification <span class="bcp14">MUST</span> specify the approaches used by the KDC to compute the PoP evidence to include in 'kdc_cred_verify' and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req21" class="internal xref">REQ21</a>).<a href="#section-4.3.1-28.8.5" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-28.9">
              <p id="section-4.3.1-28.9.1">'rekeying_scheme': identifying the rekeying scheme that the KDC uses to provide new group keying material to the group members. The value of this parameter is encoded as a CBOR integer and is taken from the "Value" column of the "ACE Groupcomm Rekeying Schemes" registry defined in <a href="#iana-ace-groupcomm-rekeying-schemes" class="auto internal xref">Section 11.13</a> of this specification.<a href="#section-4.3.1-28.9.1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-rekeying-sche"></span><div id="rekeying-scheme-0">
<table class="center" id="table-4">
                <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-ace-groupcomm-rekeying-sche" class="selfRef">ACE Groupcomm Rekeying Schemes</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Value</th>
                    <th class="text-left" rowspan="1" colspan="1">Name</th>
                    <th class="text-left" rowspan="1" colspan="1">Description</th>
                    <th class="text-left" rowspan="1" colspan="1">Reference</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">0</td>
                    <td class="text-left" rowspan="1" colspan="1">Point-to-Point</td>
                    <td class="text-left" rowspan="1" colspan="1">The KDC individually targets each node to rekey, using the pairwise secure communication association with that node</td>
                    <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
                  </tr>
                </tbody>
              </table>
</div>
<p id="section-4.3.1-28.9.3">Application profiles of this specification <span class="bcp14">MAY</span> define a default group rekeying scheme to refer to in case the 'rekeying_scheme' parameter is not included in the Join Response (<a href="#opt9" class="internal xref">OPT9</a>).<a href="#section-4.3.1-28.9.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-28.10">
              <p id="section-4.3.1-28.10.1">'mgt_key_material': encoded as a CBOR byte string and containing the specific administrative keying material that the joining node requires in order to participate in the group rekeying process performed by the KDC. This parameter <span class="bcp14">MUST NOT</span> be present if the 'rekeying_scheme' parameter is not present and the application profile does not specify a default group rekeying scheme to use in the group. Some simple rekeying schemes may not require specific administrative keying material to be provided, e.g., the basic "Point-to-Point" group rekeying scheme (see <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a>).<a href="#section-4.3.1-28.10.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.10.2">
In more advanced group rekeying schemes, the administrative keying material can be composed of multiple keys organized, for instance, into a logical tree hierarchy, whose root key is the only administrative key shared by all the group members. In such a case, each group member is exclusively associated with one leaf key in the hierarchy and stores only the administrative keys from the associated leaf key all the way up along the path to the root key. That is, different group members can be provided with a different subset of the overall administrative keying material.<a href="#section-4.3.1-28.10.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.10.3">
 It is expected from separate documents to define how the advanced group rekeying scheme, possibly indicated in the 'rekeying_scheme' parameter, is used by an application profile of this specification. This includes defining the format of the administrative keying material to specify in 'mgt_key_material' consistently with the group rekeying scheme and the application profile in question.<a href="#section-4.3.1-28.10.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.1-28.11">
              <p id="section-4.3.1-28.11.1">'control_group_uri': its value is a full URI, encoded as a CBOR text string. The URI <span class="bcp14">MUST</span> specify addressing information intended to reach all the members in the group. For example, this can be a multicast IP address, optionally together with a port number that, if omitted, defaults to 5683, i.e., the default port number for the "coap" URI scheme (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>). The URI <span class="bcp14">MUST</span> include GROUPNAME in the url-path. A default url-path is /ace-group/GROUPNAME, although implementations can use different ones instead. The URI <span class="bcp14">MUST NOT</span> have url-path /ace-group/GROUPNAME/nodes.<a href="#section-4.3.1-28.11.1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.11.2">
If 'control_group_uri' is included in the Join Response, the Clients supporting this parameter act as CoAP servers, host a resource at this specific URI, and listen to the specified addressing information.<a href="#section-4.3.1-28.11.2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.11.3">
The KDC <span class="bcp14">MAY</span> use this URI to send one-to-many CoAP requests to the Client group members (acting as CoAP servers in this exchange), for example, for one-to-many provisioning of new group keying material when performing a group rekeying (see <a href="#one-to-many-rekeying" class="auto internal xref">Section 6.2</a>) or to inform the Clients of their removal from the group (see <a href="#sec-node-removal" class="auto internal xref">Section 5</a>).<a href="#section-4.3.1-28.11.3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-28.11.4">
In particular, this resource is intended for communications exclusively concerning the group identified by GROUPNAME and whose group name was specified in the 'scope' parameter of the Join Request, if present. If the KDC does not implement mechanisms using this resource for that group, it can ignore this parameter. Other additional functionalities of this resource <span class="bcp14">MAY</span> be defined in application profiles of this specifications (<a href="#opt10" class="internal xref">OPT10</a>).<a href="#section-4.3.1-28.11.4" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-example-of-pop-input-to-comp"></span><div id="fig-kdc-cred-input">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-4.3.1-29.1">
<pre>
N_C and N_KDC expressed in CBOR diagnostic notation:
  N_C   = h'25a8991cd700ac01'
  N_KDC = h'cef04b2aa791bc6d'


N_C and N_KDC as CBOR encoded byte strings:
  N_C   = 0x4825a8991cd700ac01
  N_KDC = 0x48cef04b2aa791bc6d

PoP input:
  0x48 25a8991cd700ac01 48 cef04b2aa791bc6d
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-of-pop-input-to-comp" class="selfRef">Example of PoP Input to Compute 'kdc_cred_verify' Using CBOR Encoding</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-30">After sending the Join Response, if the KDC has an associated authentication credential as required for the correct group operation, then the KDC <span class="bcp14">MUST</span> store the N_C value specified in the 'cnonce' parameter of the Join Request as a 'clientchallenge' value associated with the Client, replacing the currently stored value (if any). If, as a group member, the Client later sends a GET request to the /ace-group/GROUPNAME/kdc-cred resource for retrieving the latest KDC's authentication credential (see <a href="#kdc-pub-key-get" class="auto internal xref">Section 4.5.1</a>), then the KDC uses the stored 'clientchallenge' for computing the PoP evidence to include in the response sent to the Client, hence proving the possession of its own private key.<a href="#section-4.3.1-30" class="pilcrow">¶</a></p>
<p id="section-4.3.1-31">If the Join Response includes the 'kdc_cred_verify' parameter, the Client verifies the conveyed PoP evidence and considers the group joining unsuccessful in case of failed verification. Application profiles of this specification <span class="bcp14">MUST</span> specify the exact approaches used by the Client to verify the PoP evidence in 'kdc_cred_verify' and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req21" class="internal xref">REQ21</a>).<a href="#section-4.3.1-31" class="pilcrow">¶</a></p>
<p id="section-4.3.1-32">Application profiles of this specification <span class="bcp14">MUST</span> specify the communication protocol that members of the group use to communicate with each other (<a href="#req22" class="internal xref">REQ22</a>) and the security protocol that they use to protect the group communication (<a href="#req23" class="internal xref">REQ23</a>).<a href="#section-4.3.1-32" class="pilcrow">¶</a></p>
<div id="ssec-key-distribution-exchange">
<section id="section-4.3.1.1">
            <h5 id="name-join-the-group">
<a href="#section-4.3.1.1" class="section-number selfRef">4.3.1.1. </a><a href="#name-join-the-group" class="section-name selfRef">Join the Group</a>
            </h5>
<p id="section-4.3.1.1-1"><a href="#fig-key-distr-join" class="auto internal xref">Figure 12</a> gives an overview of the join exchange between the Client and the KDC when the Client first joins a group, while <a href="#fig-key-distr-join-2" class="auto internal xref">Figure 13</a> shows an example.<a href="#section-4.3.1.1-1" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-the-join-re"></span><div id="fig-key-distr-join">
<figure id="figure-12">
              <div id="section-4.3.1.1-2.1">
                <div class="alignCenter art-svg artwork" id="section-4.3.1.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,96" fill="none" stroke="black"></path>
                    <path d="M 488,32 L 488,96" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 96,48" fill="none" stroke="black"></path>
                    <path d="M 432,48 L 480,48" fill="none" stroke="black"></path>
                    <path d="M 40,80 L 136,80" fill="none" stroke="black"></path>
                    <path d="M 392,80 L 472,80" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="488,48 476,42.4 476,53.6" fill="black" transform="rotate(0,480,48)"></polygon>
                    <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="488" y="20">KDC</text>
                      <text x="264" y="52">Join Request: POST /ace-group/GROUPNAME</text>
                      <text x="264" y="84">Join Response: 2.01 (Created)</text>
                      <text x="256" y="100">Location-Path = "/ace-group/GROUPNAME/nodes/NODENAME"</text>
                    </g>
                  </svg><a href="#section-4.3.1.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-message-flow-of-the-join-re" class="selfRef">Message Flow of the Join Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-the-first-join-r"></span><div id="fig-key-distr-join-2">
<figure id="figure-13">
              <div class="alignLeft art-text artwork" id="section-4.3.1.1-3.1">
<pre>
Request:

Header: POST (Code=0.02)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / scope /               3: &lt;&lt;["group1", ["sender", "receiver"]]&gt;&gt;,
  / get_creds /           4: [true, ["sender"], []],
  / client_cred /         5: h'a2026008a101a5010202410a20012158
                               20bbc34960526ea4d32e940cad2a2341
                               48ddc21791a12afbcbac93622046dd44
                               f02258204519e257236b2a0ce2023f09
                               31f1f386ca7afda64fcde0108c224c51
                               eabf6072',
  / cnonce /              6: h'25a8991cd700ac01',
  / client_cred_verify / 24: h'66e6d9b0db009f3e105a673f88556117
                               26caed57f530f8cae9d0b168513ab949
                               fedc3e80a96ebe94ba08d3f8d3bf8348
                               7458e2ab4c2f936ff78b50e33c885e35'
}


Response:

Header: Created (Code=2.01)
Content-Format: 261 (application/ace-groupcomm+cbor)
Location-Path: "ace-group"
Location-Path: "g1"
Location-Path: "nodes"
Location-Path: "c101"
Payload (in CBOR diagnostic notation):
{
  / gkty /              7: 65600,
  / key /               8: h'73657373696f6e6b6579',
  / num /               9: 12,
  / exp /              11: 1924992000,
  / exi /              12: 2592000,
  / creds /            13: [h'a2026008a101a5010202410220012158
                              20cd4177ba62433375ede279b5e18e8b
                              91bc3ed8f1e174474a26fc0edb44ea53
                              73225820a0391de29c5c5badda610d4e
                              301eaaa18422367722289cd18cbe6624
                              e89b9cfd',
                            h'a2026008a101a5010202410320012158
                              20ac75e9ece3e50bfc8ed60399889522
                              405c47bf16df96660a41298cb4307f7e
                              b62258206e5de611388a4b8a8211334a
                              c7d37ecb52a387d257e6db3c2a93df21
                              ff3affc8'],
  / peer_roles /       14: ["sender", ["sender", "receiver"]],
  / peer_identifiers / 15: [h'01', h'02']
}
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-of-the-first-join-r" class="selfRef">Example of the First Join Request-Response for Group Joining</a>
              </figcaption></figure>
</div>
<p id="section-4.3.1.1-4">If not previously established, the Client and the KDC <span class="bcp14">MUST</span> first establish a pairwise secure communication association (<a href="#req24" class="internal xref">REQ24</a>). This can be achieved, for instance, by using a transport profile of ACE. The join exchange <span class="bcp14">MUST</span> occur over that secure communication association. The Client and the KDC <span class="bcp14">MAY</span> use that same secure communication association to protect further pairwise communications that must be protected.<a href="#section-4.3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-5">It is <span class="bcp14">REQUIRED</span> that the secure communication association between the Client and the KDC is established by using the proof-of-possession key bound to the access token. As a result, the proof of possession to bind the access token to the Client is performed by using the proof-of-possession key bound to the access token for establishing the pairwise secure communication association between the Client and the KDC.<a href="#section-4.3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-6">To join the group, the Client sends a CoAP POST request to the /ace-group/GROUPNAME endpoint at the KDC, where the group to join is identified by GROUPNAME. The group name is specified in the scope entry conveyed by the 'scope' parameter of the request (if present), formatted as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>. This group name is the same as in the scope entry corresponding to that group, specified in the 'scope' parameter of the Authorization Request/Response, or it can be determined from it. Note that, in case of successful joining, the Location-Path Options in the Join Response provide the Client with the path of the URI to use for retrieving individual keying material and for leaving the group.<a href="#section-4.3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-7">If the node is joining a group for the first time and the KDC maintains the authentication credentials of the group members, the Client is <span class="bcp14">REQUIRED</span> to send its own authentication credential and proof-of-possession (PoP) evidence in the Join Request (see the 'client_cred' and 'client_cred_verify' parameters in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>). The request is accepted only if both the authentication credential is provided and the PoP evidence is successfully verified.<a href="#section-4.3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.3.1.1-8">If a node rejoins a group as authorized by the same access token and using the same authentication credential, it can omit the authentication credential and the PoP evidence, or just the PoP evidence, from the Join Request. Then, the KDC will be able to retrieve the node's authentication credential associated with the access token for that group. If the authentication credential has been discarded, the KDC replies with a 4.00 (Bad Request) error response, as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>. If a node rejoins a group but wants to update its own authentication credential, it needs to include both its authentication credential and the PoP evidence in the Join Request, like when it joined the group for the first time.<a href="#section-4.3.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gid-get">
<section id="section-4.3.2">
          <h4 id="name-get-handler">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-get-handler" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.3.2-1">The GET handler returns the symmetric group keying material for the group identified by GROUPNAME.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The handler expects a GET request.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">If all verifications succeed, the handler replies with a 2.05 (Content) response containing the symmetric group keying material. The payload of the response is formatted as a CBOR map that <span class="bcp14">MUST</span> contain the parameters 'gkty', 'key', and 'num', as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<p id="section-4.3.2-5">The payload <span class="bcp14">MUST</span> also include the parameters 'rekeying_scheme' and 'mgt_key_material' as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>, if they are included in the payload of the Join Responses sent for the group.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
<p id="section-4.3.2-6">The payload <span class="bcp14">MAY</span> also include the parameters 'ace_groupcomm_profile', 'exp', and 'exi', as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>. If the 'exp' parameter is included, the 'exi' parameter <span class="bcp14">MUST</span> also be included. If the 'exi' parameter is included, its value specifies the residual lifetime of the group keying material from the current time at the KDC.<a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
<div id="ssec-key-material-retrieval">
<section id="section-4.3.2.1">
            <h5 id="name-retrieve-group-keying-mater">
<a href="#section-4.3.2.1" class="section-number selfRef">4.3.2.1. </a><a href="#name-retrieve-group-keying-mater" class="section-name selfRef">Retrieve Group Keying Material</a>
            </h5>
<p id="section-4.3.2.1-1">A node in the group can contact the KDC to retrieve the current group keying material by sending a CoAP GET request to the /ace-group/GROUPNAME endpoint at the KDC, where the group is identified by GROUPNAME.<a href="#section-4.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2.1-2"><a href="#fig-retrieve-key-material" class="auto internal xref">Figure 14</a> gives an overview of the key distribution exchange between the Client and the KDC, while <a href="#fig-retrieve-key-material-2" class="auto internal xref">Figure 15</a> shows an example.<a href="#section-4.3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-distrib"></span><div id="fig-retrieve-key-material">
<figure id="figure-14">
              <div id="section-4.3.2.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.3.2.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,96" fill="none" stroke="black"></path>
                    <path d="M 560,32 L 560,96" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 80,48" fill="none" stroke="black"></path>
                    <path d="M 504,48 L 552,48" fill="none" stroke="black"></path>
                    <path d="M 40,80 L 128,80" fill="none" stroke="black"></path>
                    <path d="M 480,80 L 544,80" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="560,48 548,42.4 548,53.6" fill="black" transform="rotate(0,552,48)"></polygon>
                    <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="560" y="20">KDC</text>
                      <text x="292" y="52">Key Distribution Request: GET /ace-group/GROUPNAME</text>
                      <text x="304" y="84">Key Distribution Response: 2.05 (Content)</text>
                    </g>
                  </svg><a href="#section-4.3.2.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-message-flow-of-key-distrib" class="selfRef">Message Flow of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-distribution"></span><div id="fig-retrieve-key-material-2">
<figure id="figure-15">
              <div class="alignLeft art-text artwork" id="section-4.3.2.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / gkty / 7: 65600,
  / key /  8: h'73657373696f6e6b6579',
  / num /  9: 12
}
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-example-of-key-distribution" class="selfRef">Example of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamecreds">
<section id="section-4.4">
        <h3 id="name-ace-group-groupname-creds">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-ace-group-groupname-creds" class="section-name selfRef">/ace-group/GROUPNAME/creds</a>
        </h3>
<p id="section-4.4-1">This resource implements the GET and FETCH handlers.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div id="pubkey-fetch">
<section id="section-4.4.1">
          <h4 id="name-fetch-handler-2">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-fetch-handler-2" class="section-name selfRef">FETCH Handler</a>
          </h4>
<p id="section-4.4.1-1">The FETCH handler receives identifiers of group members for the group identified by GROUPNAME and returns the authentication credentials of such group members.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">The handler expects a request with the payload formatted as a CBOR map, which <span class="bcp14">MUST</span> contain the following field.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-3.1">
              <p id="section-4.4.1-3.1.1">'get_creds': its value is encoded as in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>, with the following modifications.<a href="#section-4.4.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-3.1.2.1">
                  <p id="section-4.4.1-3.1.2.1.1">The arrays 'role_filter' and 'id_filter' <span class="bcp14">MUST NOT</span> both be empty, i.e., in CDDL notation: [ bool, [ ], [ ] ]. If the 'get_creds' parameter has such a format, the request <span class="bcp14">MUST</span> be considered malformed, and the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response.<a href="#section-4.4.1-3.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3.1.2.1.2">
Note that a group member can retrieve the authentication credentials of all the current group members by sending a GET request to the same KDC resource instead (see <a href="#sec-key-retrieval-all" class="auto internal xref">Section 4.4.2.1</a>).<a href="#section-4.4.1-3.1.2.1.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.2">The element 'inclusion_flag' encodes the CBOR simple value <code>true</code> (0xf5) or <code>false</code> (0xf4), as defined in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>.<a href="#section-4.4.1-3.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.3">The array 'role_filter' can be empty if the Client does not wish to filter the requested authentication credentials based on the roles of the group members.<a href="#section-4.4.1-3.1.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.4.1-3.1.2.4">The array 'id_filter' contains zero or more node identifiers of group members for the group identified by GROUPNAME, as defined in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>. The array may be empty if the Client does not wish to filter the requested authentication credentials based on the node identifiers of the group members.<a href="#section-4.4.1-3.1.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.4.1-4">Note that, in case the 'role_filter' array and the 'id_filter' array are both non-empty:<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-5.1">If the 'inclusion_flag' encodes the CBOR simple value <code>true</code> (0xf5), the handler returns the authentication credentials of group members whose roles match with 'role_filter' and/or have their node identifier specified in 'id_filter'.<a href="#section-4.4.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-5.2">If the 'inclusion_flag' encodes the CBOR simple value <code>false</code> (0xf4), the handler returns the authentication credentials of group members whose roles match with 'role_filter' and, at the same time, do not have their node identifier specified in 'id_filter'.<a href="#section-4.4.1-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-6">The specific format of authentication credentials as well as the identifiers, roles, and combination of roles of group members <span class="bcp14">MUST</span> be specified by application profiles of this specification (<a href="#req1" class="internal xref">REQ1</a>, <a href="#req6" class="internal xref">REQ6</a>, <a href="#req25" class="internal xref">REQ25</a>).<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.4.1-7">The handler identifies the authentication credentials of the current group members for which either of the following holds:<a href="#section-4.4.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-8.1">The role identifier matches with one of those indicated in the request; note that the request can specify a combination of roles, in which case the handler selects only the group members that have all the roles included in the combination.<a href="#section-4.4.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-8.2">The node identifier matches with one of those indicated in the request or does not match with any of those, which is consistent with the value of the element 'inclusion_flag'.<a href="#section-4.4.1-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-9">If all verifications succeed, the handler returns a 2.05 (Content) message response with the payload formatted as a CBOR map, containing only the following parameters from <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>.<a href="#section-4.4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-10.1">'num': encoding the version number of the current group keying material.<a href="#section-4.4.1-10.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-10.2">'creds': encoding the list of authentication credentials of the selected group members.<a href="#section-4.4.1-10.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-10.3">
              <p id="section-4.4.1-10.3.1">'peer_roles': encoding the role(s) that each of the selected group members has in the group.<a href="#section-4.4.1-10.3.1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-10.3.2">
This parameter <span class="bcp14">SHOULD</span> be present, and it <span class="bcp14">MAY</span> be omitted according to the same criteria defined for the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.4.1-10.3.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.4.1-10.4">'peer_identifiers': encoding the node identifier that each of the selected group members has in the group.<a href="#section-4.4.1-10.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-11">The specific format of authentication credentials as well as of node identifiers of group members is specified by the application profile (<a href="#req6" class="internal xref">REQ6</a>, <a href="#req25" class="internal xref">REQ25</a>).<a href="#section-4.4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.4.1-12">If the KDC does not store any authentication credential associated with the specified node identifiers, the handler returns a response with the payload formatted as a CBOR byte string of zero length (0x40).<a href="#section-4.4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.4.1-13">The handler <span class="bcp14">MAY</span> enforce one of the following policies in order to handle possible node identifiers that are included in the 'id_filter' element of the 'get_creds' parameter of the request but are not associated with any current group member. Such a policy <span class="bcp14">MUST</span> be specified by application profiles of this specification (<a href="#req26" class="internal xref">REQ26</a>).<a href="#section-4.4.1-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-14.1">The KDC silently ignores those node identifiers.<a href="#section-4.4.1-14.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-14.2">
              <p id="section-4.4.1-14.2.1">The KDC retains authentication credentials of group members for a given amount of time after their leaving before discarding them. As long as such authentication credentials are retained, the KDC provides them to a requesting Client.<a href="#section-4.4.1-14.2.1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-14.2.2">
If the KDC adopts this policy, the application profile <span class="bcp14">MUST</span> also specify the amount of time during which the KDC retains the authentication credential of a former group member after its leaving, possibly on a per-member basis.<a href="#section-4.4.1-14.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.4.1-15">Note that this resource handler only verifies that the node is authorized by the AS to access this resource. Nodes that are not members of the group but are authorized to do signature verifications on the group messages may be allowed to access this resource if the application needs it.<a href="#section-4.4.1-15" class="pilcrow">¶</a></p>
<div id="sec-key-retrieval">
<section id="section-4.4.1.1">
            <h5 id="name-retrieve-a-subset-of-authen">
<a href="#section-4.4.1.1" class="section-number selfRef">4.4.1.1. </a><a href="#name-retrieve-a-subset-of-authen" class="section-name selfRef">Retrieve a Subset of Authentication Credentials in the Group</a>
            </h5>
<p id="section-4.4.1.1-1">In case the KDC maintains the authentication credentials of group members, a node in the group can contact the KDC to request the authentication credentials, roles, and node identifiers of a specified subset of group members by sending a CoAP FETCH request to the /ace-group/GROUPNAME/creds endpoint at the KDC, which is formatted as defined in <a href="#pubkey-fetch" class="auto internal xref">Section 4.4.1</a> and where GROUPNAME identifies the group.<a href="#section-4.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1.1-2"><a href="#fig-public-key-1" class="auto internal xref">Figure 16</a> gives an overview of the exchange mentioned above, while <a href="#fig-public-key-2" class="auto internal xref">Figure 17</a> shows an example of such an exchange.<a href="#section-4.4.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-authenticat"></span><div id="fig-public-key-1">
<figure id="figure-16">
              <div id="section-4.4.1.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.4.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,128" fill="none" stroke="black"></path>
                    <path d="M 496,32 L 496,128" fill="none" stroke="black"></path>
                    <path d="M 40,64 L 488,64" fill="none" stroke="black"></path>
                    <path d="M 40,112 L 56,112" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="496,64 484,58.4 484,69.6" fill="black" transform="rotate(0,488,64)"></polygon>
                    <polygon class="arrowhead" points="48,112 36,106.4 36,117.6" fill="black" transform="rotate(180,40,112)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="496" y="20">KDC</text>
                      <text x="268" y="52">Authentication Credential Request:</text>
                      <text x="268" y="84">FETCH /ace-group/GROUPNAME/creds</text>
                      <text x="280" y="116">Authentication Credential Response: 2.05 (Content) --</text>
                    </g>
                  </svg><a href="#section-4.4.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-message-flow-of-authenticat" class="selfRef">Message Flow of Authentication Credential Request-Response to Obtain the Authentication Credentials of Specific Group Members</a>
              </figcaption></figure>
</div>
<span id="name-example-of-authentication-c"></span><div id="fig-public-key-2">
<figure id="figure-17">
              <div class="alignLeft art-text artwork" id="section-4.4.1.1-4.1">
<pre>
Request:

Header: FETCH (Code=0.05)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "creds"
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / get_creds / 4: [true, [], [h'02', h'03']]
}


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / creds /            13: [h'a2026008a101a5010202410320012158
                              20ac75e9ece3e50bfc8ed60399889522
                              405c47bf16df96660a41298cb4307f7e
                              b62258206e5de611388a4b8a8211334a
                              c7d37ecb52a387d257e6db3c2a93df21
                              ff3affc8',
                            h'a2026008a101a5010202410920012158
                              206f9702a66602d78f5e81bac1e0af01
                              f8b52810c502e87ebb7c926c07426fd0
                              2f225820c8d33274c71c9b3ee57d842b
                              bf2238b8283cb410eca216fb72a78ea7
                              a870f800'],
  / peer_roles /       14: [["sender", "receiver"], "receiver"],
  / peer_identifiers / 15: [h'02', h'03']
}
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-example-of-authentication-c" class="selfRef">Example of Authentication Credential Request-Response to Obtain the Authentication Credentials of Specific Group Members</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="pubkey-get">
<section id="section-4.4.2">
          <h4 id="name-get-handler-2">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-get-handler-2" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.4.2-1">The handler expects a GET request.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">If all verifications succeed, the KDC replies with a 2.05 (Content) response as in the FETCH handler in <a href="#pubkey-fetch" class="auto internal xref">Section 4.4.1</a>, but its payload specifies the authentication credentials of all the group members, together with their roles and node identifiers.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-3">The 'peer_roles' parameter <span class="bcp14">SHOULD</span> be present in the payload of the response, and it <span class="bcp14">MAY</span> be omitted according to the same criteria defined for the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<div id="sec-key-retrieval-all">
<section id="section-4.4.2.1">
            <h5 id="name-retrieve-all-authentication">
<a href="#section-4.4.2.1" class="section-number selfRef">4.4.2.1. </a><a href="#name-retrieve-all-authentication" class="section-name selfRef">Retrieve All Authentication Credentials in the Group</a>
            </h5>
<p id="section-4.4.2.1-1">In case the KDC maintains the authentication credentials of group members, a node in the group or an external signature verifier can contact the KDC to request the authentication credentials, roles, and node identifiers of all the current group members, by sending a CoAP GET request to the /ace-group/GROUPNAME/creds endpoint at the KDC, where the group is identified by GROUPNAME.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.1-2"><a href="#fig-public-key-3" class="auto internal xref">Figure 18</a> gives an overview of the message exchange, while <a href="#fig-public-key-4" class="auto internal xref">Figure 19</a> shows an example of such an exchange.<a href="#section-4.4.2.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-authenticati"></span><div id="fig-public-key-3">
<figure id="figure-18">
              <div id="section-4.4.2.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.4.2.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,128" fill="none" stroke="black"></path>
                    <path d="M 496,32 L 496,128" fill="none" stroke="black"></path>
                    <path d="M 40,64 L 488,64" fill="none" stroke="black"></path>
                    <path d="M 40,112 L 56,112" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="496,64 484,58.4 484,69.6" fill="black" transform="rotate(0,488,64)"></polygon>
                    <polygon class="arrowhead" points="48,112 36,106.4 36,117.6" fill="black" transform="rotate(180,40,112)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="496" y="20">KDC</text>
                      <text x="268" y="52">Authentication Credential Request:</text>
                      <text x="268" y="84">GET /ace-group/GROUPNAME/creds</text>
                      <text x="280" y="116">Authentication Credential Response: 2.05 (Content) --</text>
                    </g>
                  </svg><a href="#section-4.4.2.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-message-flow-of-authenticati" class="selfRef">Message Flow of Authentication Credential Request-Response to Obtain the Authentication Credentials of All the Group Members</a>
              </figcaption></figure>
</div>
<span id="name-example-of-authentication-cr"></span><div id="fig-public-key-4">
<figure id="figure-19">
              <div class="alignLeft art-text artwork" id="section-4.4.2.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "creds"


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / num /               9: 12,
  / creds /            13: [h'a2026008a101a5010202410220012158
                              20cd4177ba62433375ede279b5e18e8b
                              91bc3ed8f1e174474a26fc0edb44ea53
                              73225820a0391de29c5c5badda610d4e
                              301eaaa18422367722289cd18cbe6624
                              e89b9cfd',
                            h'a2026008a101a5010202410320012158
                              20ac75e9ece3e50bfc8ed60399889522
                              405c47bf16df96660a41298cb4307f7e
                              b62258206e5de611388a4b8a8211334a
                              c7d37ecb52a387d257e6db3c2a93df21
                              ff3affc8',
                            h'a2026008a101a5010202410920012158
                              206f9702a66602d78f5e81bac1e0af01
                              f8b52810c502e87ebb7c926c07426fd0
                              2f225820c8d33274c71c9b3ee57d842b
                              bf2238b8283cb410eca216fb72a78ea7
                              a870f800'],
  / peer_roles /       14: ["sender", ["sender", "receiver"],
                            "receiver"],
  / peer_identifiers / 15: [h'01', h'02', h'03']
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-example-of-authentication-cr" class="selfRef">Example of Authentication Credential Request-Response to Obtain the Authentication Credentials of All the Group Members</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamekdc-cred">
<section id="section-4.5">
        <h3 id="name-ace-group-groupname-kdc-cre">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-ace-group-groupname-kdc-cre" class="section-name selfRef">/ace-group/GROUPNAME/kdc-cred</a>
        </h3>
<p id="section-4.5-1">This resource implements a GET handler.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="kdc-pub-key-get">
<section id="section-4.5.1">
          <h4 id="name-get-handler-3">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-get-handler-3" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.5.1-1">The handler expects a GET request.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">If all verifications succeed, the handler returns a 2.05 (Content) message containing the KDC's authentication credential together with the proof-of-possession (PoP) evidence. The response <span class="bcp14">MUST</span> have Content-Format "application/ace-groupcomm+cbor". The payload of the response is a CBOR map, which includes the following fields.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.1-3.1">'kdc_cred: specifying the KDC's authentication credential. This parameter is encoded like the 'kdc_cred' parameter in the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-3.2">'kdc_nonce': specifying a nonce generated by the KDC. This parameter is encoded like the 'kdc_nonce' parameter in the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.5.1-3.3">
              <p id="section-4.5.1-3.3.1">'kdc_cred_verify': specifying the PoP evidence computed by the KDC over the following PoP input: the nonce N_C (encoded as a CBOR byte string) concatenated with the nonce N_KDC (encoded as a CBOR byte string), where:<a href="#section-4.5.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.1-3.3.2.1">N_C is the nonce generated by the Client group member such that: i) the nonce was specified in the 'cnonce' parameter of the latest Join Request that the Client sent to the KDC in order to join the group identified by GROUPNAME; and ii) the KDC stored the nonce as a 'clientchallenge' value associated with the Client after sending the corresponding Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4.5.1-3.3.2.2">N_KDC is the nonce generated by the KDC and specified in the 'kdc_nonce' parameter.<a href="#section-4.5.1-3.3.2.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4.5.1-3.3.3">
An example of PoP input to compute 'kdc_cred_verify' using CBOR encoding is given in <a href="#fig-kdc-cred-input-2" class="auto internal xref">Figure 20</a>.<a href="#section-4.5.1-3.3.3" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3.3.4">
The PoP evidence is computed by means of the same method used for computing the PoP evidence that was included in the Join Response for this Client (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-4.5.1-3.3.4" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3.3.5">
Application profiles of this specification <span class="bcp14">MUST</span> specify the exact approaches used by the KDC to compute the PoP evidence to include in the 'kdc_cred_verify' parameter and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req21" class="internal xref">REQ21</a>).<a href="#section-4.5.1-3.3.5" class="pilcrow">¶</a></p>
<p id="section-4.5.1-3.3.6">
If an application profile supports the presence of external signature verifiers that send GET requests to this resource, then the application profile <span class="bcp14">MUST</span> specify how external signature verifiers provide the KDC with a self-generated nonce to use as N_C (<a href="#req21" class="internal xref">REQ21</a>).<a href="#section-4.5.1-3.3.6" class="pilcrow">¶</a></p>
</li>
          </ul>
<span id="name-example-of-pop-input-to-compu"></span><div id="fig-kdc-cred-input-2">
<figure id="figure-20">
            <div class="alignLeft art-text artwork" id="section-4.5.1-4.1">
<pre>
N_C and N_KDC expressed in CBOR diagnostic notation:
  N_C   = h'25a8991cd700ac01'
  N_KDC = h'0b7db12aaff56da3'


N_C and N_KDC as CBOR encoded byte strings:
  N_C   = 0x4825a8991cd700ac01
  N_KDC = 0x480b7db12aaff56da3

PoP input:
  0x48 25a8991cd700ac01 48 0b7db12aaff56da3
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-example-of-pop-input-to-compu" class="selfRef">Example of PoP Input to Compute 'kdc_cred_verify' Using CBOR Encoding</a>
            </figcaption></figure>
</div>
<div id="kdc-pub-key">
<section id="section-4.5.1.1">
            <h5 id="name-retrieve-the-kdcs-authentic">
<a href="#section-4.5.1.1" class="section-number selfRef">4.5.1.1. </a><a href="#name-retrieve-the-kdcs-authentic" class="section-name selfRef">Retrieve the KDC's Authentication Credential</a>
            </h5>
<p id="section-4.5.1.1-1">In case the KDC has an associated authentication credential as required for the correct group operation, a group member or an external signature verifier can contact the KDC to request the KDC's authentication credential by sending a CoAP GET request to the /ace-group/GROUPNAME/kdc-cred endpoint at the KDC, where GROUPNAME identifies the group.<a href="#section-4.5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-2">Upon receiving the 2.05 (Content) response, the Client retrieves the KDC's authentication credential from the 'kdc_cred' parameter and <span class="bcp14">MUST</span> verify the proof-of-possession (PoP) evidence specified in the 'kdc_cred_verify' parameter. In case of successful verification of the PoP evidence, the Client <span class="bcp14">MUST</span> store the obtained KDC's authentication credential and replace the currently stored one.<a href="#section-4.5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-3">The PoP evidence is verified by means of the same method used when processing the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>). Application profiles of this specification <span class="bcp14">MUST</span> specify the exact approaches used by the Client to verify the PoP evidence in 'kdc_cred_verify' and <span class="bcp14">MUST</span> specify which of those approaches is used in which case (<a href="#req21" class="internal xref">REQ21</a>).<a href="#section-4.5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1.1-4"><a href="#fig-kdc-pub-key-req-resp" class="auto internal xref">Figure 21</a> gives an overview of the exchange described above, while <a href="#fig-kdc-pub-key-req-resp-ex" class="auto internal xref">Figure 22</a> shows an example.<a href="#section-4.5.1.1-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-kdc-authent"></span><div id="fig-kdc-pub-key-req-resp">
<figure id="figure-21">
              <div id="section-4.5.1.1-5.1">
                <div class="alignCenter art-svg artwork" id="section-4.5.1.1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 24,48 L 24,144" fill="none" stroke="black"></path>
                    <path d="M 520,48 L 520,144" fill="none" stroke="black"></path>
                    <path d="M 32,80 L 512,80" fill="none" stroke="black"></path>
                    <path d="M 32,128 L 48,128" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="520,80 508,74.4 508,85.6" fill="black" transform="rotate(0,512,80)"></polygon>
                    <polygon class="arrowhead" points="40,128 28,122.4 28,133.6" fill="black" transform="rotate(180,32,128)"></polygon>
                    <g class="text">
                      <text x="24" y="20">Group</text>
                      <text x="28" y="36">Member</text>
                      <text x="520" y="36">KDC</text>
                      <text x="280" y="68">KDC Authentication Credential Request</text>
                      <text x="280" y="100">GET /ace-group/GROUPNAME/kdc-cred</text>
                      <text x="288" y="132">KDC Authentication Credential Response: 2.05 (Content) --</text>
                    </g>
                  </svg><a href="#section-4.5.1.1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-message-flow-of-kdc-authent" class="selfRef">Message Flow of KDC Authentication Credential Request-Response to Obtain the Authentication Credential of the KDC</a>
              </figcaption></figure>
</div>
<span id="name-example-of-kdc-authenticati"></span><div id="fig-kdc-pub-key-req-resp-ex">
<figure id="figure-22">
              <div class="alignLeft art-text artwork" id="section-4.5.1.1-6.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "kdc-cred"


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / kdc_cred /        17: h'a2026008a101a5010202419920012158
                            2065eda5a12577c2bae829437fe33870
                            1a10aaa375e1bb5b5de108de439c0855
                            1d2258201e52ed75701163f7f9e40ddf
                            9f341b3dc9ba860af7e0ca7ca7e9eecd
                            0084d19c',
  / kdc_nonce /       18: h'0b7db12aaff56da3',
  / kdc_cred_verify / 19: h'3fc54702aa56e1b2cb20284294c9106a
                            63f91bac658d69351210a031d8fc7c5f
                            f3e4be39445b1a3e83e1510d1aca2f2e
                            8a7c081c7645042b18aba9d1fad1bd9c'
}
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-example-of-kdc-authenticati" class="selfRef">Example of KDC Authentication Credential Request-Response to Obtain the Authentication Credential of the KDC</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamepolicies">
<section id="section-4.6">
        <h3 id="name-ace-group-groupname-policie">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-ace-group-groupname-policie" class="section-name selfRef">/ace-group/GROUPNAME/policies</a>
        </h3>
<p id="section-4.6-1">This resource implements the GET handler.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<div id="policies-get">
<section id="section-4.6.1">
          <h4 id="name-get-handler-4">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-get-handler-4" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.6.1-1">The handler expects a GET request.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1-2">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-4.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.6.1-3">If all verifications succeed, the handler replies with a 2.05 (Content) response containing the list of policies for the group identified by GROUPNAME. The payload of the response is formatted as a CBOR map including only the 'group_policies' parameter defined in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a> and specifying the current policies in the group. If the KDC does not store any policy, the payload is formatted as a CBOR byte string of zero length (0x40).<a href="#section-4.6.1-3" class="pilcrow">¶</a></p>
<p id="section-4.6.1-4">The specific format and meaning of group policies <span class="bcp14">MUST</span> be specified in application profiles of this specification (<a href="#req20" class="internal xref">REQ20</a>).<a href="#section-4.6.1-4" class="pilcrow">¶</a></p>
<div id="policies">
<section id="section-4.6.1.1">
            <h5 id="name-retrieve-the-group-policies">
<a href="#section-4.6.1.1" class="section-number selfRef">4.6.1.1. </a><a href="#name-retrieve-the-group-policies" class="section-name selfRef">Retrieve the Group Policies</a>
            </h5>
<p id="section-4.6.1.1-1">A node in the group can contact the KDC to retrieve the current group policies by sending a CoAP GET request to the /ace-group/GROUPNAME/policies endpoint at the KDC, which is formatted as defined in <a href="#policies-get" class="auto internal xref">Section 4.6.1</a> and where GROUPNAME identifies the group.<a href="#section-4.6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1.1-2"><a href="#fig-policies" class="auto internal xref">Figure 23</a> gives an overview of the exchange described above, while <a href="#fig-policies-2" class="auto internal xref">Figure 24</a> shows an example.<a href="#section-4.6.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-policies-re"></span><div id="fig-policies">
<figure id="figure-23">
              <div id="section-4.6.1.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.6.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,96" fill="none" stroke="black"></path>
                    <path d="M 504,32 L 504,96" fill="none" stroke="black"></path>
                    <path d="M 480,48 L 496,48" fill="none" stroke="black"></path>
                    <path d="M 40,80 L 128,80" fill="none" stroke="black"></path>
                    <path d="M 416,80 L 496,80" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="504,48 492,42.4 492,53.6" fill="black" transform="rotate(0,496,48)"></polygon>
                    <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="504" y="20">KDC</text>
                      <text x="252" y="52">-- Policies Request: GET /ace-group/GROUPNAME/policies</text>
                      <text x="272" y="84">Policies Response: 2.05 (Content)</text>
                    </g>
                  </svg><a href="#section-4.6.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-message-flow-of-policies-re" class="selfRef">Message Flow of Policies Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-policies-request"></span><div id="fig-policies-2">
<figure id="figure-24">
              <div class="alignLeft art-text artwork" id="section-4.6.1.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "policies"


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload(in CBOR diagnostic notation):
{
  / group_policies / 16: {
    / Expiration Delta / 2: 120
  }
}
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-example-of-policies-request" class="selfRef">Example of Policies Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenum">
<section id="section-4.7">
        <h3 id="name-ace-group-groupname-num">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-ace-group-groupname-num" class="section-name selfRef">/ace-group/GROUPNAME/num</a>
        </h3>
<p id="section-4.7-1">This resource implements the GET handler.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<div id="num-get">
<section id="section-4.7.1">
          <h4 id="name-get-handler-5">
<a href="#section-4.7.1" class="section-number selfRef">4.7.1. </a><a href="#name-get-handler-5" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.7.1-1">The handler expects a GET request.<a href="#section-4.7.1-1" class="pilcrow">¶</a></p>
<p id="section-4.7.1-2">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-4.7.1-2" class="pilcrow">¶</a></p>
<p id="section-4.7.1-3">If all verifications succeed, the handler returns a 2.05 (Content) message containing an integer that represents the version number of the symmetric group keying material. This number is incremented on the KDC every time the KDC updates the symmetric group keying material  before the new keying material is distributed. This number is stored in persistent storage.<a href="#section-4.7.1-3" class="pilcrow">¶</a></p>
<p id="section-4.7.1-4">The payload of the response is formatted as a CBOR integer.<a href="#section-4.7.1-4" class="pilcrow">¶</a></p>
<div id="key-version">
<section id="section-4.7.1.1">
            <h5 id="name-retrieve-the-keying-materia">
<a href="#section-4.7.1.1" class="section-number selfRef">4.7.1.1. </a><a href="#name-retrieve-the-keying-materia" class="section-name selfRef">Retrieve the Keying Material Version</a>
            </h5>
<p id="section-4.7.1.1-1">A node in the group can contact the KDC to request information about the version number of the symmetric group keying material by sending a CoAP GET request to the /ace-group/GROUPNAME/num endpoint at the KDC, which is formatted as defined in <a href="#num-get" class="auto internal xref">Section 4.7.1</a> and where GROUPNAME identifies the group. In particular, the version is incremented by the KDC every time the group keying material is renewed before it is distributed to the group members.<a href="#section-4.7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.7.1.1-2"><a href="#fig-version" class="auto internal xref">Figure 25</a> gives an overview of the exchange described above, while <a href="#fig-version-2" class="auto internal xref">Figure 26</a> shows an example.<a href="#section-4.7.1.1-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-version-req"></span><div id="fig-version">
<figure id="figure-25">
              <div id="section-4.7.1.1-3.1">
                <div class="alignCenter art-svg artwork" id="section-4.7.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,96" fill="none" stroke="black"></path>
                    <path d="M 488,32 L 488,96" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 64,48" fill="none" stroke="black"></path>
                    <path d="M 448,48 L 480,48" fill="none" stroke="black"></path>
                    <path d="M 40,80 L 120,80" fill="none" stroke="black"></path>
                    <path d="M 400,80 L 480,80" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="488,48 476,42.4 476,53.6" fill="black" transform="rotate(0,480,48)"></polygon>
                    <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="488" y="20">KDC</text>
                      <text x="256" y="52">Version Request: GET /ace-group/GROUPNAME/num</text>
                      <text x="260" y="84">Version Response: 2.05 (Content)</text>
                    </g>
                  </svg><a href="#section-4.7.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-message-flow-of-version-req" class="selfRef">Message Flow of Version Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-version-request-"></span><div id="fig-version-2">
<figure id="figure-26">
              <div class="alignLeft art-text artwork" id="section-4.7.1.1-4.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "num"


Response:

Header: Content (Code=2.05)
Content-Format: 60 (application/cbor)
Payload (in CBOR diagnostic notation):
  13
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-example-of-version-request-" class="selfRef">Example of Version Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="node-subresource">
<section id="section-4.8">
        <h3 id="name-ace-group-groupname-nodes-n">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-ace-group-groupname-nodes-n" class="section-name selfRef">/ace-group/GROUPNAME/nodes/NODENAME</a>
        </h3>
<p id="section-4.8-1">This resource implements the GET, POST, and DELETE handlers.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<p id="section-4.8-2">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>, each of the handlers performs the following two verifications.<a href="#section-4.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8-3.1">The handler verifies that the Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-4.8-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.8-3.2">The handler verifies that the node name of the Client is equal to NODENAME used in the url-path. If the verification fails, the handler replies with a 4.03 (Forbidden) error response.<a href="#section-4.8-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="node-get">
<section id="section-4.8.1">
          <h4 id="name-get-handler-6">
<a href="#section-4.8.1" class="section-number selfRef">4.8.1. </a><a href="#name-get-handler-6" class="section-name selfRef">GET Handler</a>
          </h4>
<p id="section-4.8.1-1">The handler expects a GET request.<a href="#section-4.8.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.1-2">If all verifications succeed, the handler replies with a 2.05 (Content) response containing both the group keying material and the individual keying material for the Client or information enabling the Client to derive it.<a href="#section-4.8.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.1-3">The payload of the response is formatted as a CBOR map, which includes the same fields of the response defined in <a href="#gid-get" class="auto internal xref">Section 4.3.2</a>. In particular, the format for the group keying material is the same as defined in the response of <a href="#gid-get" class="auto internal xref">Section 4.3.2</a>. If the 'exp' parameter is included, the 'exi' parameter <span class="bcp14">MUST</span> also be included. If the parameter 'exi' is included, its value specifies the residual lifetime of the group keying material from the current time at the KDC.<a href="#section-4.8.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1-4">The CBOR map can include additional parameters that specify the individual keying material for the Client. The specific format of individual keying material for group members or of the information to derive such keying material <span class="bcp14">MUST</span> be defined in application profiles of this specification (<a href="#req27" class="internal xref">REQ27</a>), together with the corresponding CBOR map key that has to be registered in the "ACE Groupcomm Parameters" registry defined in <a href="#iana-reg" class="auto internal xref">Section 11.7</a>.<a href="#section-4.8.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1-5">Optionally, the KDC can make the sub-resource at /ace-group/GROUPNAME/nodes/NODENAME also observable <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> for the associated node. In case the KDC removes that node from the group without having been explicitly asked for it, this allows the KDC to send an unsolicited 4.04 (Not Found) response to the node as a notification of eviction from the group (see <a href="#sec-node-removal" class="auto internal xref">Section 5</a>).<a href="#section-4.8.1-5" class="pilcrow">¶</a></p>
<p id="section-4.8.1-6">Note that the node could have also been observing the resource at /ace-group/GROUPNAME in order to be informed of changes in the group keying material. In such a case, this method would result in largely overlapping notifications received for the resource at /ace-group/GROUPNAME and the sub-resource at /ace-group/GROUPNAME/nodes/NODENAME.<a href="#section-4.8.1-6" class="pilcrow">¶</a></p>
<p id="section-4.8.1-7">In order to mitigate this, a node that supports the CoAP No-Response Option <span>[<a href="#RFC7967" class="cite xref">RFC7967</a>]</span> can use it when starting the observation of the sub-resource at /ace-group/GROUPNAME/nodes/NODENAME. In particular, the GET observation request can also include the No-Response option, with value set to 2 (Not interested in 2.xx responses).<a href="#section-4.8.1-7" class="pilcrow">¶</a></p>
<div id="update-keys">
<section id="section-4.8.1.1">
            <h5 id="name-retrieve-group-and-individu">
<a href="#section-4.8.1.1" class="section-number selfRef">4.8.1.1. </a><a href="#name-retrieve-group-and-individu" class="section-name selfRef">Retrieve Group and Individual Keying Material</a>
            </h5>
<p id="section-4.8.1.1-1">When any of the following happens, a node <span class="bcp14">MUST</span> stop using the stored group keying material to protect outgoing messages and <span class="bcp14">SHOULD</span> stop using it to decrypt and verify incoming messages.<a href="#section-4.8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8.1.1-2.1">Upon expiration of the keying material, according to what is indicated by the KDC through the 'exp' and/or 'exi' parameter (e.g., in a Join Response) or to a pre-configured value.<a href="#section-4.8.1.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.8.1.1-2.2">Upon receiving a notification of revoked/renewed keying material from the KDC, possibly as part of an update of the keying material (rekeying) triggered by the KDC.<a href="#section-4.8.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.8.1.1-2.3">Upon receiving messages from other group members without being able to retrieve the keying material to correctly decrypt them. This may be due to rekeying messages previously sent by the KDC that the Client was not able to receive or decrypt.<a href="#section-4.8.1.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.8.1.1-3">In either case, if it wants to continue participating in the group communication, the Client has to request the latest keying material from the KDC. To this end, the Client sends a CoAP GET request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, formatted as specified in <a href="#node-get" class="auto internal xref">Section 4.8.1</a>. The Client can request the latest keying material from the KDC before the currently stored, old keying material reaches its expiration time.<a href="#section-4.8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-4">Note that policies can be set up so that the Client sends a Key Distribution Request to the KDC only after a given number of received messages could not be decrypted (because of failed decryption processing or the inability to retrieve the necessary keying material).<a href="#section-4.8.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-5">It is application dependent and pertaining to the used secure message exchange (e.g., <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">GROUP-OSCORE</a>]</span>) to set up these policies for instructing Clients to retain incoming messages and for how long (<a href="#opt11" class="internal xref">OPT11</a>). This allows Clients to possibly decrypt such messages after getting updated keying material, rather than just consider them invalid messages to discard right away.<a href="#section-4.8.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-6">After having failed to decrypt messages from another group member and having sent a Key Distribution Request to the KDC, the Client might end up retrieving the same, latest group keying material that it already stores. In such a case, multiple failed decryptions might be due to the message sender and/or the KDC that have changed their authentication credential. Hence, the Client can retrieve such latest authentication credentials by sending to the KDC an Authentication Credential Request (see Sections <a href="#sec-key-retrieval" class="auto internal xref">4.4.1.1</a> and <a href="#sec-key-retrieval-all" class="auto internal xref">4.4.2.1</a>) and a KDC Authentication Credential Request (see <a href="#kdc-pub-key" class="auto internal xref">Section 4.5.1.1</a>), respectively.<a href="#section-4.8.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-7">The Client can also send to the KDC a Key Distribution Request without having been triggered by a failed decryption of a message from another group member, if the Client wants to be sure that it currently stores the latest group keying material. If that is the case, the Client will receive from the KDC the same group keying material it already stores.<a href="#section-4.8.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.8.1.1-8"><a href="#fig-key-redistr-req-resp" class="auto internal xref">Figure 27</a> gives an overview of the exchange described above, while <a href="#fig-key-redistr-req-resp-2" class="auto internal xref">Figure 28</a> shows an example.<a href="#section-4.8.1.1-8" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-distribu"></span><div id="fig-key-redistr-req-resp">
<figure id="figure-27">
              <div id="section-4.8.1.1-9.1">
                <div class="alignCenter art-svg artwork" id="section-4.8.1.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,112" fill="none" stroke="black"></path>
                    <path d="M 528,32 L 528,112" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 176,48" fill="none" stroke="black"></path>
                    <path d="M 400,48 L 520,48" fill="none" stroke="black"></path>
                    <path d="M 40,96 L 104,96" fill="none" stroke="black"></path>
                    <path d="M 456,96 L 520,96" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="528,48 516,42.4 516,53.6" fill="black" transform="rotate(0,520,48)"></polygon>
                    <polygon class="arrowhead" points="48,96 36,90.4 36,101.6" fill="black" transform="rotate(180,40,96)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="528" y="20">KDC</text>
                      <text x="288" y="52">Key Distribution Request:</text>
                      <text x="280" y="68">GET /ace-group/GROUPNAME/nodes/NODENAME</text>
                      <text x="280" y="100">Key Distribution Response: 2.05 (Content)</text>
                    </g>
                  </svg><a href="#section-4.8.1.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-27" class="selfRef">Figure 27</a>:
<a href="#name-message-flow-of-key-distribu" class="selfRef">Message Flow of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-distribution-"></span><div id="fig-key-redistr-req-resp-2">
<figure id="figure-28">
              <div class="alignLeft art-text artwork" id="section-4.8.1.1-10.1">
<pre>
Request:

Header: GET (Code=0.01)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"


Response:

Header: Content (Code=2.05)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation, with "ind-key" being the
         profile-specified label for individual keying material):
{
  / gkty / 7: 65600,
  / key /  8: h'73657373696f6e6b6579',
  / num /  9: 12,
   "ind-key": h'fcae9023'
}
</pre>
</div>
<figcaption><a href="#figure-28" class="selfRef">Figure 28</a>:
<a href="#name-example-of-key-distribution-" class="selfRef">Example of Key Distribution Request-Response</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="node-put">
<section id="section-4.8.2">
          <h4 id="name-post-handler-2">
<a href="#section-4.8.2" class="section-number selfRef">4.8.2. </a><a href="#name-post-handler-2" class="section-name selfRef">POST Handler</a>
          </h4>
<p id="section-4.8.2-1">The POST handler processes requests from a Client that asks for new individual keying material, as required to process messages exchanged in the group.<a href="#section-4.8.2-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2-2">The handler expects a POST request with an empty payload.<a href="#section-4.8.2-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2-3">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a> and at the beginning of <a href="#node-subresource" class="auto internal xref">Section 4.8</a>, the handler verifies that this operation is consistent with the set of roles that the Client has in the group (<a href="#req11" class="internal xref">REQ11</a>). If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 1 ("Request inconsistent with the current roles").<a href="#section-4.8.2-3" class="pilcrow">¶</a></p>
<p id="section-4.8.2-4">If the KDC is currently not able to serve this request, i.e., to generate new individual keying material for the requesting Client, the KDC <span class="bcp14">MUST</span> reply with a 5.03 (Service unavailable) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 4 ("No available individual keying material").<a href="#section-4.8.2-4" class="pilcrow">¶</a></p>
<p id="section-4.8.2-5">If all verifications succeed, the handler replies with a 2.04 (Changed) response containing newly generated individual keying material for the Client. The payload of the response is formatted as a CBOR map. The specific format of newly generated individual keying material for group members or of the information to derive such keying material <span class="bcp14">MUST</span> be defined in application profiles of this specification (<a href="#req27" class="internal xref">REQ27</a>), together with the corresponding CBOR map key that has to be registered in the "ACE Groupcomm Parameters" registry defined in <a href="#iana-reg" class="auto internal xref">Section 11.7</a>.<a href="#section-4.8.2-5" class="pilcrow">¶</a></p>
<p id="section-4.8.2-6">The typical successful outcome consists in replying with newly generated individual keying material for the Client, as defined above. However, application profiles of this specification <span class="bcp14">MAY</span> also extend this handler in order to achieve different akin outcomes (<a href="#opt12" class="internal xref">OPT12</a>), for instance:<a href="#section-4.8.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.8.2-7.1">Not providing the Client with newly generated individual keying material, but rather rekeying the whole group, i.e., providing all the current group members with newly generated group keying material.<a href="#section-4.8.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.8.2-7.2">Both providing the Client with newly generated individual keying material, as well as rekeying the whole group, i.e., providing all the current group members with newly generated group keying material.<a href="#section-4.8.2-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.8.2-8">In either case, the handler may specify the new group keying material as part of the 2.04 (Changed) response.<a href="#section-4.8.2-8" class="pilcrow">¶</a></p>
<p id="section-4.8.2-9">Note that this handler is not intended to accommodate requests from a group member to trigger a group rekeying, whose scheduling and execution is an exclusive prerogative of the KDC (also see related security considerations in <a href="#sec-cons-rekeying" class="auto internal xref">Section 10.2</a>).<a href="#section-4.8.2-9" class="pilcrow">¶</a></p>
<div id="new-keys">
<section id="section-4.8.2.1">
            <h5 id="name-request-to-change-individua">
<a href="#section-4.8.2.1" class="section-number selfRef">4.8.2.1. </a><a href="#name-request-to-change-individua" class="section-name selfRef">Request to Change Individual Keying Material</a>
            </h5>
<p id="section-4.8.2.1-1">A Client may ask the KDC for new individual keying material. For instance, this can be due to the expiration of such individual keying material or to the exhaustion of Authenticated Encryption with Associated Data (AEAD) nonces if an AEAD encryption algorithm is used for protecting communications in the group. An example of individual keying material can simply be an individual encryption key associated with the Client. Hence, the Client may ask for a new individual encryption key or for new input material to derive it.<a href="#section-4.8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-2">To this end, the Client performs a Key Renewal Request-Response exchange with the KDC, i.e., it sends a CoAP POST request to the /ace-group/GROUPNAME/nodes/NODENAME endpoint at the KDC, which is formatted as defined in  <a href="#node-get" class="auto internal xref">Section 4.8.1</a>, where GROUPNAME identifies the group and NODENAME is the node name of the Client.<a href="#section-4.8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-3"><a href="#fig-renewal-req-resp" class="auto internal xref">Figure 29</a> gives an overview of the exchange described above, while <a href="#fig-renewal-req-resp-2" class="auto internal xref">Figure 30</a> shows an example.<a href="#section-4.8.2.1-3" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-key-renewal"></span><div id="fig-renewal-req-resp">
<figure id="figure-29">
              <div id="section-4.8.2.1-4.1">
                <div class="alignCenter art-svg artwork" id="section-4.8.2.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 32,32 L 32,112" fill="none" stroke="black"></path>
                    <path d="M 480,32 L 480,112" fill="none" stroke="black"></path>
                    <path d="M 40,48 L 160,48" fill="none" stroke="black"></path>
                    <path d="M 344,48 L 472,48" fill="none" stroke="black"></path>
                    <path d="M 40,96 L 104,96" fill="none" stroke="black"></path>
                    <path d="M 416,96 L 472,96" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="480,48 468,42.4 468,53.6" fill="black" transform="rotate(0,472,48)"></polygon>
                    <polygon class="arrowhead" points="48,96 36,90.4 36,101.6" fill="black" transform="rotate(180,40,96)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="480" y="20">KDC</text>
                      <text x="252" y="52">Key Renewal Request:</text>
                      <text x="252" y="68">POST /ace-group/GROUPNAME/nodes/NODENAME</text>
                      <text x="260" y="100">Key Renewal Response: 2.04 (Changed)</text>
                    </g>
                  </svg><a href="#section-4.8.2.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-29" class="selfRef">Figure 29</a>:
<a href="#name-message-flow-of-key-renewal" class="selfRef">Message Flow of Key Renewal Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-key-renewal-requ"></span><div id="fig-renewal-req-resp-2">
<figure id="figure-30">
              <div class="alignLeft art-text artwork" id="section-4.8.2.1-5.1">
<pre>
Request:

Header: POST (Code=0.02)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"


Response:

Header: Changed (Code=2.04)
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation, with "ind-key" being the
         profile-specified label for individual keying material):
{
  "ind-key": h'b71acc28'
}
</pre>
</div>
<figcaption><a href="#figure-30" class="selfRef">Figure 30</a>:
<a href="#name-example-of-key-renewal-requ" class="selfRef">Example of Key Renewal Request-Response</a>
              </figcaption></figure>
</div>
<p id="section-4.8.2.1-6">Note that there is a difference between the Key Renewal Request in this section and the Key Distribution Request in <a href="#update-keys" class="auto internal xref">Section 4.8.1.1</a>. The former asks the KDC for new individual keying material, while the latter asks the KDC for the current group keying material together with the current individual keying material.<a href="#section-4.8.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.8.2.1-7">As discussed in <a href="#node-put" class="auto internal xref">Section 4.8.2</a>, application profiles of this specification may define alternative outcomes for the Key Renewal Request-Response exchange (<a href="#opt12" class="internal xref">OPT12</a>), where the provisioning of new individual keying material is replaced by or combined with the execution of a whole group rekeying.<a href="#section-4.8.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="node-delete">
<section id="section-4.8.3">
          <h4 id="name-delete-handler">
<a href="#section-4.8.3" class="section-number selfRef">4.8.3. </a><a href="#name-delete-handler" class="section-name selfRef">DELETE Handler</a>
          </h4>
<p id="section-4.8.3-1">The DELETE handler removes the node identified by NODENAME from the group identified by GROUPNAME.<a href="#section-4.8.3-1" class="pilcrow">¶</a></p>
<p id="section-4.8.3-2">The handler expects a DELETE request with an empty payload.<a href="#section-4.8.3-2" class="pilcrow">¶</a></p>
<p id="section-4.8.3-3">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>, the handler verifies that the Client is a current member of the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.03 (Forbidden) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 0 ("Operation permitted only to group members").<a href="#section-4.8.3-3" class="pilcrow">¶</a></p>
<p id="section-4.8.3-4">If all verification succeeds, the handler performs the actions defined in <a href="#sec-node-removal" class="auto internal xref">Section 5</a> and replies with a 2.02 (Deleted) response with an empty payload.<a href="#section-4.8.3-4" class="pilcrow">¶</a></p>
<div id="ssec-group-leaving">
<section id="section-4.8.3.1">
            <h5 id="name-leave-the-group">
<a href="#section-4.8.3.1" class="section-number selfRef">4.8.3.1. </a><a href="#name-leave-the-group" class="section-name selfRef">Leave the Group</a>
            </h5>
<p id="section-4.8.3.1-1">A Client can actively request to leave the group. In this case, the Client sends a CoAP DELETE request to the endpoint /ace-group/GROUPNAME/nodes/NODENAME at the KDC, where GROUPNAME identifies the group and NODENAME is the Client's node name.<a href="#section-4.8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.8.3.1-2">Note that, after having left the group, the Client may wish to join it again. Then, as long as the Client is still authorized to join the group, i.e., the associated access token is still valid, the Client can request to rejoin the group directly to the KDC (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>) without having to retrieve a new access token from the AS.<a href="#section-4.8.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ace-groupgroupnamenodesnodenamecred">
<section id="section-4.9">
        <h3 id="name-ace-group-groupname-nodes-no">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-ace-group-groupname-nodes-no" class="section-name selfRef">/ace-group/GROUPNAME/nodes/NODENAME/cred</a>
        </h3>
<p id="section-4.9-1">This resource implements the POST handler.<a href="#section-4.9-1" class="pilcrow">¶</a></p>
<div id="node-pub-key-post">
<section id="section-4.9.1">
          <h4 id="name-post-handler-3">
<a href="#section-4.9.1" class="section-number selfRef">4.9.1. </a><a href="#name-post-handler-3" class="section-name selfRef">POST Handler</a>
          </h4>
<p id="section-4.9.1-1">The POST handler is used to replace the stored authentication credential of this Client (identified by NODENAME) with the one specified in the request at the KDC for the group identified by GROUPNAME.<a href="#section-4.9.1-1" class="pilcrow">¶</a></p>
<p id="section-4.9.1-2">The handler expects a POST request with the payload as specified in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>, with the difference that the payload includes only the parameters 'client_cred', 'cnonce', and 'client_cred_verify'.<a href="#section-4.9.1-2" class="pilcrow">¶</a></p>
<p id="section-4.9.1-3">The PoP evidence included in the 'client_cred_verify' parameter is computed in the same way considered in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a> and defined by the specific application profile (<a href="#req14" class="internal xref">REQ14</a>) by using the following to build the PoP input: i) the same scope entry specified by the Client in the 'scope' parameter of the latest Join Request that the Client sent to the KDC in order to join the group identified by GROUPNAME; ii) the latest N_S value stored by the Client; and iii) a new N_C nonce generated by the Client and specified in the parameter 'cnonce' of this request.<a href="#section-4.9.1-3" class="pilcrow">¶</a></p>
<p id="section-4.9.1-4">An example of PoP input to compute 'client_cred_verify' using CBOR encoding is given in <a href="#fig-client-cred-input-2" class="auto internal xref">Figure 31</a>.<a href="#section-4.9.1-4" class="pilcrow">¶</a></p>
<p id="section-4.9.1-5">It is <span class="bcp14">REQUIRED</span> for application profiles to define the specific formats of authentication credentials that are acceptable to use in the group (<a href="#req6" class="internal xref">REQ6</a>).<a href="#section-4.9.1-5" class="pilcrow">¶</a></p>
<p id="section-4.9.1-6">In addition to what is defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a> and at the beginning of <a href="#node-subresource" class="auto internal xref">Section 4.8</a>, the handler verifies that this operation is consistent with the set of roles that the node has in the group. If the verification fails, the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 1 ("Request inconsistent with the current roles").<a href="#section-4.9.1-6" class="pilcrow">¶</a></p>
<p id="section-4.9.1-7">If the KDC cannot retrieve the 'kdcchallenge' associated with this Client (see <a href="#token-post" class="auto internal xref">Section 3.3</a>), the KDC <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response, which <span class="bcp14">MUST</span> also have Content-Format "application/ace-groupcomm+cbor". The payload of the error response is a CBOR map including the 'kdcchallenge' parameter, which specifies a newly generated 'kdcchallenge' value. In such a case, the KDC <span class="bcp14">MUST</span> store the newly generated value as the 'kdcchallenge' value associated with this Client, replacing the currently stored value (if any).<a href="#section-4.9.1-7" class="pilcrow">¶</a></p>
<p id="section-4.9.1-8">Otherwise, the handler checks that the authentication credential specified in the 'client_cred' field is valid for the group identified by GROUPNAME. That is, the handler checks that the authentication credential is encoded according to the format used in the group, is intended for the public key algorithm used in the group, and is aligned with the possible associated parameters used in the group. If that cannot be successfully verified, the handler <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format  "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 2 ("Authentication credential incompatible with the group configuration").<a href="#section-4.9.1-8" class="pilcrow">¶</a></p>
<p id="section-4.9.1-9">Otherwise, the handler verifies the PoP evidence conveyed in the 'client_cred_verify' parameter of the request, by using the authentication credential specified in the 'client_cred' parameter as well as the same way considered in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a> and defined by the specific application profile (<a href="#req14" class="internal xref">REQ14</a>). If the PoP evidence does not pass verification, the handler <span class="bcp14">MUST</span> reply with a 4.00 (Bad Request) error response. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 3 ("Invalid proof-of-possession evidence").<a href="#section-4.9.1-9" class="pilcrow">¶</a></p>
<p id="section-4.9.1-10">If all verifications succeed, the handler performs the following actions.<a href="#section-4.9.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.9.1-11.1">The handler associates the authentication credential from the 'client_cred' parameter of the request with the node identifier NODENAME, as well as with the access token associated with the node identified by NODENAME.<a href="#section-4.9.1-11.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.9.1-11.2">In the stored list of group members' authentication credentials for the group identified by GROUPNAME, the handler replaces the authentication credential of the node identified by NODENAME with the authentication credential specified in the 'client_cred' parameter of the request.<a href="#section-4.9.1-11.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.9.1-12">Then, the handler replies with a 2.04 (Changed) response, which does not include a payload.<a href="#section-4.9.1-12" class="pilcrow">¶</a></p>
<span id="name-example-of-pop-input-to-comput"></span><div id="fig-client-cred-input-2">
<figure id="figure-31">
            <div class="alignLeft art-text artwork" id="section-4.9.1-13.1">
<pre>
scope, N_S, and N_C expressed in CBOR diagnostic notation:
  scope = h'826667726f7570316673656e646572'
  N_S   = h'018a278f7faab55a'
  N_C   = h'0446baefc56111bf'


scope, N_S, and N_C as CBOR encoded byte strings:
  scope = 0x4f826667726F7570316673656E646572
  N_S   = 0x48018a278f7faab55a
  N_C   = 0x480446baefc56111bf

PoP input:
  0x4f 826667726f7570316673656e646572
    48 018a278f7faab55a 48 0446baefc56111bf
</pre>
</div>
<figcaption><a href="#figure-31" class="selfRef">Figure 31</a>:
<a href="#name-example-of-pop-input-to-comput" class="selfRef">Example of PoP Input to Compute 'client_cred_verify' Using CBOR Encoding</a>
            </figcaption></figure>
</div>
<div id="update-pub-key">
<section id="section-4.9.1.1">
            <h5 id="name-uploading-an-authentication">
<a href="#section-4.9.1.1" class="section-number selfRef">4.9.1.1. </a><a href="#name-uploading-an-authentication" class="section-name selfRef">Uploading an Authentication Credential</a>
            </h5>
<p id="section-4.9.1.1-1">In case the KDC maintains the authentication credentials of group members, a node in the group can contact the KDC to upload a new authentication credential to use in the group and to replace the currently stored one.<a href="#section-4.9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-2">To this end, the Client performs an Authentication Credential Update Request-Response exchange with the KDC, i.e., it sends a CoAP POST request to the /ace-group/GROUPNAME/nodes/NODENAME/cred endpoint at the KDC, where GROUPNAME identifies the group and NODENAME is the Client's node name.<a href="#section-4.9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-3">The request is formatted as specified in <a href="#node-pub-key-post" class="auto internal xref">Section 4.9.1</a>.<a href="#section-4.9.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.9.1.1-4"><a href="#fig-pub-key-update-req-resp" class="auto internal xref">Figure 32</a> gives an overview of the exchange described above, while <a href="#fig-pub-key-update-req-resp-2" class="auto internal xref">Figure 33</a> shows an example.<a href="#section-4.9.1.1-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-of-authenticatio"></span><div id="fig-pub-key-update-req-resp">
<figure id="figure-32">
              <div id="section-4.9.1.1-5.1">
                <div class="alignCenter art-svg artwork" id="section-4.9.1.1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 650 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,32 L 8,112" fill="none" stroke="black"></path>
                    <path d="M 528,32 L 528,112" fill="none" stroke="black"></path>
                    <path d="M 16,48 L 96,48" fill="none" stroke="black"></path>
                    <path d="M 448,48 L 520,48" fill="none" stroke="black"></path>
                    <path d="M 16,96 L 32,96" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="528,48 516,42.4 516,53.6" fill="black" transform="rotate(0,520,48)"></polygon>
                    <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
                    <g class="text">
                      <text x="28" y="20">Client</text>
                      <text x="528" y="20">KDC</text>
                      <text x="272" y="52">Authentication Credential Update Request:</text>
                      <text x="264" y="68">POST /ace-group/GROUPNAME/nodes/NODENAME/cred</text>
                      <text x="284" y="100">Authentication Credential Update Response: 2.04 (Changed) --</text>
                    </g>
                  </svg><a href="#section-4.9.1.1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-32" class="selfRef">Figure 32</a>:
<a href="#name-message-flow-of-authenticatio" class="selfRef">Message Flow of Authentication Credential Update Request-Response</a>
              </figcaption></figure>
</div>
<span id="name-example-of-authentication-cre"></span><div id="fig-pub-key-update-req-resp-2">
<figure id="figure-33">
              <div class="alignLeft art-text artwork" id="section-4.9.1.1-6.1">
<pre>
Request:

Header: POST (Code=0.02)
Uri-Host: "kdc.example.com"
Uri-Path: "ace-group"
Uri-Path: "g1"
Uri-Path: "nodes"
Uri-Path: "c101"
Uri-Path: "cred"
Content-Format: 261 (application/ace-groupcomm+cbor)
Payload (in CBOR diagnostic notation):
{
  / client_cred /         5: h'a2026008a101a501020241fc20012158
                               20bac5b11cad8f99f9c72b05cf4b9e26
                               d244dc189f745228255a219a86d6a09e
                               ff22582020138bf82dc1b6d562be0fa5
                               4ab7804a3a64b6d72ccfed6b6fb6ed28
                               bbfc117e',
  / cnonce /              6: h'0446baefc56111bf',
  / client_cred_verify / 24: h'e2aeafd40d69d19dfe6e52077c5d7ff4
                               e408282cbefb5d06cbf414af2e19d982
                               ac45ac98b8544c908b4507de1e90b717
                               c3d34816fe926a2b98f53afd2fa0f30a'
}


Response:

Header: Changed (Code=2.04)
</pre>
</div>
<figcaption><a href="#figure-33" class="selfRef">Figure 33</a>:
<a href="#name-example-of-authentication-cre" class="selfRef">Example of Authentication Credential Update Request-Response</a>
              </figcaption></figure>
</div>
<p id="section-4.9.1.1-7">Additionally, after updating its own authentication credential, a group member <span class="bcp14">MAY</span> send to the group a number of requests, including an identifier of the updated authentication credential, to notify other group members that they have to retrieve it. How this is done depends on the group communication protocol used and therefore is application profile specific (<a href="#opt13" class="internal xref">OPT13</a>).<a href="#section-4.9.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-node-removal">
<section id="section-5">
      <h2 id="name-removal-of-a-group-member">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-removal-of-a-group-member" class="section-name selfRef">Removal of a Group Member</a>
      </h2>
<p id="section-5-1">A Client identified by NODENAME may be removed from a group identified by GROUPNAME where it is a member, for example, due to the following reasons.<a href="#section-5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-2">
 <li id="section-5-2.1">The Client explicitly asks to leave the group, as defined in <a href="#ssec-group-leaving" class="auto internal xref">Section 4.8.3.1</a>.<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.2">The node has been found compromised or is suspected so. The KDC is expected to determine that a group member has to be evicted either through its own means or based on information that it obtains from a trusted source (e.g., an Intrusion Detection System or an issuer of authentication credentials). Additional mechanics, protocols, and interfaces at the KDC that can support this are out of the scope of this document.<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-2.3">The Client's authorization to be a group member with the current roles is not valid anymore, i.e., the access token has expired or has been revoked. If the AS provides token introspection (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the KDC can optionally use it and check whether the Client is still authorized.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-3">In all cases, the KDC performs the following actions.<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">The KDC removes the Client from the list of current members of the group. When doing so, the KDC deletes the currently stored value of 'clientchallenge' for that Client, which was specified in the latest Join Request that the Client sent to the KDC in order to join the group (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">In case of forced eviction, i.e., for cases 2 and 3 above, the KDC deletes the authentication credential of the removed Client if it acts as a repository of authentication credentials for group members.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.3">If the removed Client is registered as an observer of the group-membership resource at /ace-group/GROUPNAME, the KDC removes the Client from the list of observers of that resource.<a href="#section-5-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.4">
          <p id="section-5-4.4.1">If the sub-resource /nodes/NODENAME was created for the removed Client, the KDC deletes that sub-resource.<a href="#section-5-4.4.1" class="pilcrow">¶</a></p>
<p id="section-5-4.4.2">
In case of forced eviction, i.e., for cases 2 and 3 above, the KDC <span class="bcp14">MAY</span> explicitly inform the removed Client by means of the following methods.<a href="#section-5-4.4.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.4.3.1">If the evicted Client implements the 'control_uri' resource (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>), the KDC sends a DELETE request to that resource, targeting the URI specified in the 'control_uri' parameter of the Join Request (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-5-4.4.3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5-4.4.3.2">
              <p id="section-5-4.4.3.2.1">If the evicted Client is observing its associated sub-resource at /ace-group/GROUPNAME/nodes/NODENAME (see <a href="#node-get" class="auto internal xref">Section 4.8.1</a>), the KDC sends an unsolicited 4.04 (Not Found) error response, which does not include the Observe Option and indicates that the observed resource has been deleted (see <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>).<a href="#section-5-4.4.3.2.1" class="pilcrow">¶</a></p>
<p id="section-5-4.4.3.2.2">
The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 5 ("Group membership terminated").<a href="#section-5-4.4.3.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-5-4.5">If forward security is prescribed by application policies installed at the KDC or by the used application profile of this specification, then the KDC <span class="bcp14">MUST</span> generate new group keying material and securely distribute it to all the current group members except the leaving node (see <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>).<a href="#section-5-4.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-group-rekeying">
<section id="section-6">
      <h2 id="name-group-rekeying-process">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-group-rekeying-process" class="section-name selfRef">Group Rekeying Process</a>
      </h2>
<p id="section-6-1">A group rekeying is started and driven by the KDC. The KDC is not intended to accommodate explicit requests from group members to trigger a group rekeying. That is, the scheduling and execution of a group rekeying is an exclusive prerogative of the KDC.
      Some reasons that can trigger a group rekeying include a change in the group membership, the current group keying material approaching its expiration time, or a regularly scheduled update of the group keying material.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The KDC can perform a group rekeying before the current group keying material expires, unless it is acceptable or there are reasons to temporarily pause secure communications in the group, following the expiration of the current keying material. For example, a pause in the group communication might have been scheduled to start anyway when the group keying material expires, e.g., to allow maintenance operations on the group members. As another example, the KDC might be carrying out a verification that some group members are seemingly compromised and to be evicted, and this needs to be completed in order to appropriately define and schedule the exact rekeying process to perform. As a result, the KDC could delay the execution of the group rekeying.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The KDC <span class="bcp14">MUST</span> increment the version number NUM of the current keying material before distributing the newly generated keying material with version number NUM+1 to the group. Once the group rekeying is completed, the KDC <span class="bcp14">MUST</span> delete the old keying material and <span class="bcp14">SHOULD</span> store the newly distributed keying material in persistent storage.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Distributing the new group keying material requires the KDC to send multiple rekeying messages to the group members. Depending on the rekeying scheme used in the group and the reason that has triggered the rekeying process, each rekeying message can be intended for one or multiple group members, hereafter referred to as target group members. The KDC <span class="bcp14">MUST</span> support at least the "Point-to-Point" group rekeying scheme described in <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a> and <span class="bcp14">MAY</span> support additional ones.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Each rekeying message <span class="bcp14">MUST</span> have Content-Format  "application/ace-groupcomm+cbor" and its payload is formatted as a CBOR map, which <span class="bcp14">MUST</span> include at least the information specified in the Key Distribution Response message (see <a href="#gid-get" class="auto internal xref">Section 4.3.2</a>), i.e., the parameters 'gkty', 'key', and 'num' defined in <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>. The CBOR map <span class="bcp14">SHOULD</span> also include the parameters 'exp' and 'exi'. If the 'exp' parameter is included, the 'exi' parameter <span class="bcp14">MUST</span> also be included. The CBOR map <span class="bcp14">MAY</span> include the parameter 'mgt_key_material' to specify new administrative keying material for the target group members if it is relevant for the used rekeying scheme.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">A rekeying message may include additional information, depending on the rekeying scheme used in the group, the reason that has triggered the rekeying process, and the specific target group members. In particular, if the group rekeying is performed due to one or multiple Clients that have joined the group and the KDC acts as a repository of authentication credentials of the group members, then a rekeying message <span class="bcp14">MAY</span> also include the authentication credentials that those Clients use in the group, together with the roles and node identifier that each of such Clients has in the group. It is <span class="bcp14">RECOMMENDED</span> to specify this information by means of the parameters 'creds', 'peer_roles', and 'peer_identifiers', like it is done in the Join Response message (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">The complete format of a rekeying message, including the encoding and content of the 'mgt_key_material' parameter, has to be defined in separate specifications aimed at profiling the used rekeying scheme in the context of the used application profile of this specification. As a particular case, an application profile of this specification <span class="bcp14">MAY</span> define additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme defined in <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a> (<a href="#opt14" class="internal xref">OPT14</a>).<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">Consistently with the used group rekeying scheme, the actual delivery of rekeying messages can occur through different approaches, as discussed in Sections <a href="#point-to-point-rekeying" class="auto internal xref">6.1</a> and <a href="#one-to-many-rekeying" class="auto internal xref">6.2</a>.<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">The possible, temporary misalignment of the keying material stored by the different group members due to a group rekeying is discussed in <a href="#sec-misalignment-keying-material" class="auto internal xref">Section 6.3</a>. Further security considerations related to the group rekeying process are compiled in <a href="#sec-cons-rekeying" class="auto internal xref">Section 10.2</a>.<a href="#section-6-9" class="pilcrow">¶</a></p>
<div id="point-to-point-rekeying">
<section id="section-6.1">
        <h3 id="name-point-to-point-group-rekeyi">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-point-to-point-group-rekeyi" class="section-name selfRef">Point-to-Point Group Rekeying</a>
        </h3>
<p id="section-6.1-1">A point-to-point group rekeying consists in the KDC sending one individual rekeying message to each target group member. In particular, the rekeying message is protected by means of the secure communication association between the KDC and the target group member in question, as per the used application profile of this specification and the used transport profile of ACE.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">This is the approach taken by the basic "Point-to-Point" group rekeying scheme, which the KDC can explicitly indicate in the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>), through the 'rekeying_scheme' parameter specifying the value 0.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">When taking this approach in the group identified by GROUPNAME, the KDC can practically deliver the rekeying messages to the target group members in different, coexisting ways.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">The KDC <span class="bcp14">SHOULD</span> make the /ace-group/GROUPNAME resource observable <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>. Thus, upon performing a group rekeying, the KDC can distribute the new group keying material through individual notification responses sent to the target group members that are also observing that resource.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-4.1.2">
In case the KDC deletes the group (and thus deletes the /ace-group/GROUPNAME resource), relying on CoAP Observe as discussed above also allows the KDC to send an unsolicited 4.04 (Not Found) response to each observer group member as a notification of group termination. The response <span class="bcp14">MUST</span> have Content-Format "application/concise-problem-details+cbor" and is formatted as defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>. Within the Custom Problem Detail entry 'ace-groupcomm-error', the value of the 'error-id' field  <span class="bcp14">MUST</span> be set to 6 ("Group deleted").<a href="#section-6.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">If a target group member specified a URI in the 'control_uri' parameter of the Join Request upon joining the group (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>), the KDC can provide that group member with the new group keying material by sending a unicast POST request to that URI.<a href="#section-6.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-4.2.2">
A Client that does not plan to observe the /ace-group/GROUPNAME resource at the KDC <span class="bcp14">SHOULD</span> specify a URI in the 'control_uri' parameter of the Join Request upon joining the group.<a href="#section-6.1-4.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-5">If the KDC has to send a rekeying message to a target group member, but this did not include the 'control_uri' parameter in the Join Request and is not a registered observer for the /ace-group/GROUPNAME resource, then that target group member will not be able to participate in the group rekeying. Later on, after having repeatedly failed to successfully exchange secure messages in the group, that group member can retrieve the current group keying material from the KDC, by sending a GET request to the /ace-group/GROUPNAME or /ace-group/GROUPNAME/nodes/NODENAME resource at the KDC (see Sections <a href="#gid-get" class="auto internal xref">4.3.2</a> and <a href="#node-get" class="auto internal xref">4.8.1</a>, respectively).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6"><a href="#fig-rekeying-example-1" class="auto internal xref">Figure 34</a> provides an example of point-to-point group rekeying. In particular, the example makes the following assumptions:<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-7.1">The group currently consists of four group members, namely C1, C2, C3, and C4.<a href="#section-6.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-7.2">Each group member, when joining the group, provided the KDC with a URI in the 'control_uri' parameter with url-path "grp-rek".<a href="#section-6.1-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-7.3">Before the group rekeying is performed, the keying material used in the group has version number num=5.<a href="#section-6.1-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-7.4">The KDC performs the group rekeying in such a way to evict the group member C3, which has been found to be compromised.<a href="#section-6.1-7.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-8">In the example, the KDC individually rekeys the group members intended to remain in the group (i.e., C1, C2, and C4) by means of one rekeying message each.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<span id="name-example-of-message-exchange"></span><div id="fig-rekeying-example-1">
<figure id="figure-34">
          <div id="section-6.1-9.1">
            <div class="alignCenter art-svg artwork" id="section-6.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 700 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 32,32 L 32,64" fill="none" stroke="black"></path>
                <path d="M 40,256 L 40,288" fill="none" stroke="black"></path>
                <path d="M 80,72 L 80,208" fill="none" stroke="black"></path>
                <path d="M 112,256 L 112,288" fill="none" stroke="black"></path>
                <path d="M 184,256 L 184,288" fill="none" stroke="black"></path>
                <path d="M 224,72 L 224,208" fill="none" stroke="black"></path>
                <path d="M 256,256 L 256,288" fill="none" stroke="black"></path>
                <path d="M 328,256 L 328,288" fill="none" stroke="black"></path>
                <path d="M 400,256 L 400,288" fill="none" stroke="black"></path>
                <path d="M 480,256 L 480,288" fill="none" stroke="black"></path>
                <path d="M 520,72 L 520,208" fill="none" stroke="black"></path>
                <path d="M 552,32 L 552,64" fill="none" stroke="black"></path>
                <path d="M 552,256 L 552,288" fill="none" stroke="black"></path>
                <path d="M 32,32 L 552,32" fill="none" stroke="black"></path>
                <path d="M 32,64 L 552,64" fill="none" stroke="black"></path>
                <path d="M 40,256 L 112,256" fill="none" stroke="black"></path>
                <path d="M 184,256 L 256,256" fill="none" stroke="black"></path>
                <path d="M 328,256 L 400,256" fill="none" stroke="black"></path>
                <path d="M 480,256 L 552,256" fill="none" stroke="black"></path>
                <path d="M 40,288 L 112,288" fill="none" stroke="black"></path>
                <path d="M 184,288 L 256,288" fill="none" stroke="black"></path>
                <path d="M 328,288 L 400,288" fill="none" stroke="black"></path>
                <path d="M 480,288 L 552,288" fill="none" stroke="black"></path>
                <path d="M 44,344 L 140,344" fill="none" stroke="black"></path>
                <path d="M 444,344 L 548,344" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,208 516,202.4 516,213.6" fill="black" transform="rotate(90,520,208)"></polygon>
                <polygon class="arrowhead" points="232,208 220,202.4 220,213.6" fill="black" transform="rotate(90,224,208)"></polygon>
                <polygon class="arrowhead" points="88,208 76,202.4 76,213.6" fill="black" transform="rotate(90,80,208)"></polygon>
                <g class="text">
                  <text x="288" y="52">KDC</text>
                  <text x="24" y="100">Group</text>
                  <text x="168" y="100">Group</text>
                  <text x="464" y="100">Group</text>
                  <text x="28" y="116">keying</text>
                  <text x="172" y="116">keying</text>
                  <text x="468" y="116">keying</text>
                  <text x="36" y="132">material</text>
                  <text x="180" y="132">material</text>
                  <text x="476" y="132">material</text>
                  <text x="32" y="148">(num=6)</text>
                  <text x="176" y="148">(num=6)</text>
                  <text x="472" y="148">(num=6)</text>
                  <text x="76" y="244">/grp-rek</text>
                  <text x="220" y="244">/grp-rek</text>
                  <text x="364" y="244">/grp-rek</text>
                  <text x="516" y="244">/grp-rek</text>
                  <text x="76" y="276">C1</text>
                  <text x="220" y="276">C2</text>
                  <text x="364" y="276">C3</text>
                  <text x="516" y="276">C4</text>
                  <text x="320" y="308">[TO</text>
                  <text x="348" y="308">BE</text>
                  <text x="396" y="308">EVICTED]</text>
                  <text x="40" y="324">|</text>
                  <text x="552" y="324">|</text>
                  <text x="40" y="340">\</text>
                  <text x="172" y="340">Stored</text>
                  <text x="224" y="340">group</text>
                  <text x="276" y="340">keying</text>
                  <text x="340" y="340">material</text>
                  <text x="408" y="340">(num=5)</text>
                  <text x="552" y="340">/</text>
                </g>
              </svg><a href="#section-6.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-34" class="selfRef">Figure 34</a>:
<a href="#name-example-of-message-exchange" class="selfRef">Example of Message Exchanges for a Point-to-Point Group Rekeying</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="one-to-many-rekeying">
<section id="section-6.2">
        <h3 id="name-one-to-many-group-rekeying">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-one-to-many-group-rekeying" class="section-name selfRef">One-to-Many Group Rekeying</a>
        </h3>
<p id="section-6.2-1">This section provides high-level recommendations on how the KDC can rekey a group by means of a more efficient and scalable group rekeying scheme, e.g., <span>[<a href="#RFC2093" class="cite xref">RFC2093</a>]</span>, <span>[<a href="#RFC2094" class="cite xref">RFC2094</a>]</span>, and <span>[<a href="#RFC2627" class="cite xref">RFC2627</a>]</span>. That is, each rekeying message might be, and likely is, intended for multiple target group members, and thus can be delivered to the whole group, although possible to decrypt only for the actual target group members.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">This yields an overall lower number of rekeying messages, thus potentially reducing the overall time required to rekey the group. On the other hand, it requires the KDC to provide and use additional administrative keying material to protect the rekeying messages and to additionally sign them to ensure source authentication (see <a href="#one-to-many-rekeying-protection" class="auto internal xref">Section 6.2.1</a>).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Compared to a group rekeying performed in a point-to-point fashion (see <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a>), a one-to-many group rekeying typically pays off in large-scale groups due to the reduced time for completing the rekeying, a more efficient utilization of network resources, and a reduced performance overhead at the KDC. To different extents, it also requires individual group members to locally perform additional operations in order to handle the administrative keying material and verify source authentication of rekeying messages. Therefore, one-to-many group rekeying schemes and their employment ought to ensure that the experienced performance overhead on the group members also remains bearable for resource-constrained devices.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">The exact set of rekeying messages to send, their content and format, the administrative keying material to use to protect them, as well as the set of target group members depend on the specific group rekeying scheme and are typically affected by the reason that has triggered the group rekeying. Details about the data content and format of rekeying messages have to be defined by separate documents profiling the use of the group rekeying scheme in the context of the used application profile of this specification.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">When one of these group rekeying schemes is used, the KDC provides related information to a Client joining the group in the Join Response message (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>). In particular, the 'rekeying_scheme' parameter indicates the rekeying scheme used in the group (if no default scheme can be assumed); the 'control_group_uri' parameter, if present, specifies a URI whose addressing information is, e.g., a multicast IP address where the KDC will send the rekeying messages for that group as intended to reach all the group members; and the 'mgt_key_material' parameter specifies a subset of the administrative keying material intended for that particular joining Client to have, as used to protect the rekeying messages sent to the group when also intended for that joining Client.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">Rekeying messages can be protected at the application layer by using COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and the administrative keying material as prescribed by the specific group rekeying scheme (see <a href="#one-to-many-rekeying-protection" class="auto internal xref">Section 6.2.1</a>). After that, the delivery of protected rekeying messages to the intended target group members can occur in different ways, such as the following ones.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-7">
          <dt id="section-6.2-7.1">Over multicast -</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-7.2">
            <p id="section-6.2-7.2.1">In this case, the KDC simply sends a rekeying message as a CoAP request addressed to the URI specified in the 'control_group_uri' parameter of the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-6.2-7.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-7.2.2">
If a particular rekeying message is intended for a single target group member, the KDC may alternatively protect the message using the secure communication association with that group member and deliver the message like when using the "Point-to-Point" group rekeying scheme (see <a href="#point-to-point-rekeying" class="auto internal xref">Section 6.1</a>).<a href="#section-6.2-7.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-7.3">Through a pub-sub communication model -</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-7.4">
            <p id="section-6.2-7.4.1">In this case, the KDC acts as a publisher and publishes each rekeying message to a specific "rekeying topic", which is associated with the group and is hosted at a Broker server. Following their group joining, the group members subscribe to the rekeying topic at the Broker, thus receiving the group rekeying messages as they are published by the KDC.<a href="#section-6.2-7.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2-7.4.2">
In order to make such message delivery more efficient, the rekeying topic associated with a group can be further organized into subtopics. For instance, the KDC can use a particular subtopic to address a particular set of target group members during the rekeying process as possibly aligned to a similar organization of the administrative keying material (e.g., a key hierarchy).<a href="#section-6.2-7.4.2" class="pilcrow">¶</a></p>
<p id="section-6.2-7.4.3">
The setup of rekeying topics at the Broker as well as the discovery of the topics at the Broker for group members are application specific. A possible way is for the KDC to provide such information in the Join Response message (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>) by means of a new parameter analogous to 'control_group_uri' and specifying the URI(s) of the rekeying topic(s) that a group member has to subscribe to at the Broker.<a href="#section-6.2-7.4.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-8">Regardless of the specifically used delivery method, the group rekeying scheme can perform a possible rollover of the administrative keying material through the same sent rekeying messages. Actually, such a rollover occurs every time a group rekeying is performed upon the leaving of group members, which have to be excluded from future communications in the group.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<p id="section-6.2-9">From a high-level point of view, each group member stores only a subset of the overall administrative keying material, which is obtained upon joining the group. Then, when a group rekeying occurs:<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-10.1">Each rekeying message is protected by using a (most convenient) key from the administrative keying material such that: i) the used key is not stored by any node leaving the group, i.e., the key is safe to use and does not have to be renewed; and ii) the used key is stored by all the target group members that indeed have to be provided with new group keying material to protect communications in the group.<a href="#section-6.2-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-10.2">Each rekeying message includes not only the new group keying material intended for all the rekeyed group members but also any new administrative keys that: i) are pertaining to and supposed to be stored by the target group members; and ii) had to be updated because leaving group members do store the previous version.<a href="#section-6.2-10.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-11">Further details depend on the specific rekeying scheme used in the group.<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<p id="section-6.2-12"><a href="#fig-rekeying-example-2" class="auto internal xref">Figure 35</a> provides an example of a one-to-many group rekeying over multicast. In particular, the example makes the following assumptions:<a href="#section-6.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-13.1">The group currently consists of four group members, namely C1, C2, C3, and C4.<a href="#section-6.2-13.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-13.2">Each group member, when joining the group, provided the KDC with a URI in the 'control_uri' parameter with url-path "grp-rek".<a href="#section-6.2-13.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-13.3">Each group member, when joining the group, received from the KDC a URI in the 'control_group_uri' parameter, specifying the multicast address MULT_ADDR and url-path "grp-mrek".<a href="#section-6.2-13.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-13.4">Before the group rekeying is performed, the keying material used in the group has version number num=5.<a href="#section-6.2-13.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-13.5">The KDC performs the group rekeying in such a way to evict the group member C3, which has been found to be compromised.<a href="#section-6.2-13.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-14">In the example, the KDC determines that the most convenient way to perform a group rekeying that evicts C3 is as follows.<a href="#section-6.2-14" class="pilcrow">¶</a></p>
<p id="section-6.2-15">First, the KDC sends one rekeying message over multicast to the multicast address MULT_ADDR and the url-path "grp-mrek". In the figure, the message is denoted with solid arrows. The message is protected with a non-compromised key from the administrative keying material that only C1 and C2 store. Therefore, even though all the group members receive this message, only C1 and C2 are able to decrypt it. The message includes: the new group keying material with version number num=6 and new keys from the administrative keying material to replace those stored by the group members C1, C2, and C3.<a href="#section-6.2-15" class="pilcrow">¶</a></p>
<p id="section-6.2-16">After that, the KDC sends one rekeying message addressed individually to C4 and with url-path "grp-rek". In the figure, the message is denoted with a dotted arrow. The message is protected with the secure association shared between C4 and the KDC. The message includes: the new group keying material with version number num=6 and new keys from the administrative keying material to replace those stored by both C4 and C3.<a href="#section-6.2-16" class="pilcrow">¶</a></p>
<span id="name-example-of-message-exchanges"></span><div id="fig-rekeying-example-2">
<figure id="figure-35">
          <div id="section-6.2-17.1">
            <div class="alignCenter art-svg artwork" id="section-6.2-17.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 700 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 8,288 L 8,320" fill="none" stroke="black"></path>
                <path d="M 56,192 L 56,240" fill="none" stroke="black"></path>
                <path d="M 80,288 L 80,320" fill="none" stroke="black"></path>
                <path d="M 112,288 L 112,320" fill="none" stroke="black"></path>
                <path d="M 160,192 L 160,240" fill="none" stroke="black"></path>
                <path d="M 184,288 L 184,320" fill="none" stroke="black"></path>
                <path d="M 216,288 L 216,320" fill="none" stroke="black"></path>
                <path d="M 272,72 L 272,240" fill="none" stroke="black"></path>
                <path d="M 312,288 L 312,320" fill="none" stroke="black"></path>
                <path d="M 344,288 L 344,320" fill="none" stroke="black"></path>
                <path d="M 392,192 L 392,240" fill="none" stroke="black"></path>
                <path d="M 568,32 L 568,64" fill="none" stroke="black"></path>
                <path d="M 568,288 L 568,320" fill="none" stroke="black"></path>
                <path d="M 8,32 L 568,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 568,64" fill="none" stroke="black"></path>
                <path d="M 56,192 L 392,192" fill="none" stroke="black"></path>
                <path d="M 8,288 L 80,288" fill="none" stroke="black"></path>
                <path d="M 112,288 L 184,288" fill="none" stroke="black"></path>
                <path d="M 216,288 L 312,288" fill="none" stroke="black"></path>
                <path d="M 344,288 L 568,288" fill="none" stroke="black"></path>
                <path d="M 8,320 L 80,320" fill="none" stroke="black"></path>
                <path d="M 112,320 L 184,320" fill="none" stroke="black"></path>
                <path d="M 216,320 L 312,320" fill="none" stroke="black"></path>
                <path d="M 344,320 L 568,320" fill="none" stroke="black"></path>
                <path d="M 12,376 L 132,376" fill="none" stroke="black"></path>
                <path d="M 436,376 L 564,376" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="400,240 388,234.4 388,245.6" fill="black" transform="rotate(90,392,240)"></polygon>
                <polygon class="arrowhead" points="280,240 268,234.4 268,245.6" fill="black" transform="rotate(90,272,240)"></polygon>
                <polygon class="arrowhead" points="168,240 156,234.4 156,245.6" fill="black" transform="rotate(90,160,240)"></polygon>
                <polygon class="arrowhead" points="64,240 52,234.4 52,245.6" fill="black" transform="rotate(90,56,240)"></polygon>
                <circle cx="8" cy="96" r="6" class="closeddot" fill="black"></circle>
                <circle cx="8" cy="112" r="6" class="closeddot" fill="black"></circle>
                <circle cx="336" cy="96" r="6" class="closeddot" fill="black"></circle>
                <circle cx="336" cy="128" r="6" class="closeddot" fill="black"></circle>
                <g class="text">
                  <text x="272" y="52">KDC</text>
                  <text x="544" y="84">:</text>
                  <text x="40" y="100">Group</text>
                  <text x="92" y="100">keying</text>
                  <text x="156" y="100">material</text>
                  <text x="224" y="100">(num=6)</text>
                  <text x="368" y="100">Group</text>
                  <text x="420" y="100">keying</text>
                  <text x="544" y="100">:</text>
                  <text x="48" y="116">Updated</text>
                  <text x="140" y="116">administrative</text>
                  <text x="380" y="116">material</text>
                  <text x="448" y="116">(num=6)</text>
                  <text x="544" y="116">:</text>
                  <text x="44" y="132">keying</text>
                  <text x="108" y="132">material</text>
                  <text x="160" y="132">for</text>
                  <text x="188" y="132">C1</text>
                  <text x="216" y="132">and</text>
                  <text x="244" y="132">C2</text>
                  <text x="376" y="132">Updated</text>
                  <text x="468" y="132">administrative</text>
                  <text x="544" y="132">:</text>
                  <text x="372" y="148">keying</text>
                  <text x="436" y="148">material</text>
                  <text x="488" y="148">for</text>
                  <text x="516" y="148">C4</text>
                  <text x="544" y="148">:</text>
                  <text x="544" y="164">:</text>
                  <text x="544" y="180">:</text>
                  <text x="544" y="196">:</text>
                  <text x="544" y="212">:</text>
                  <text x="544" y="228">:</text>
                  <text x="544" y="244">v</text>
                  <text x="48" y="276">/grp-mrek</text>
                  <text x="152" y="276">/grp-mrek</text>
                  <text x="256" y="276">/grp-mrek</text>
                  <text x="384" y="276">/grp-mrek</text>
                  <text x="532" y="276">/grp-rek</text>
                  <text x="44" y="308">C1</text>
                  <text x="148" y="308">C2</text>
                  <text x="268" y="308">C3</text>
                  <text x="452" y="308">C4</text>
                  <text x="216" y="340">[TO</text>
                  <text x="244" y="340">BE</text>
                  <text x="292" y="340">EVICTED]</text>
                  <text x="8" y="356">|</text>
                  <text x="568" y="356">|</text>
                  <text x="8" y="372">\</text>
                  <text x="164" y="372">Stored</text>
                  <text x="216" y="372">group</text>
                  <text x="268" y="372">keying</text>
                  <text x="332" y="372">material</text>
                  <text x="400" y="372">(num=5)</text>
                  <text x="568" y="372">/</text>
                </g>
              </svg><a href="#section-6.2-17.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-35" class="selfRef">Figure 35</a>:
<a href="#name-example-of-message-exchanges" class="selfRef">Example of Message Exchanges for a One-to-Many Group Rekeying</a>
          </figcaption></figure>
</div>
<div id="one-to-many-rekeying-protection">
<section id="section-6.2.1">
          <h4 id="name-protection-of-rekeying-mess">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-protection-of-rekeying-mess" class="section-name selfRef">Protection of Rekeying Messages</a>
          </h4>
<p id="section-6.2.1-1">When using a group rekeying scheme relying on one-to-many rekeying messages, the actual data content of each rekeying message is prepared according to what the rekeying scheme prescribes.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">The following describes one possible method for the KDC to protect the rekeying messages when using the administrative keying material.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">The method assumes that the following holds for the administrative keying material specified in the 'mgt_key_material' parameter of the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-4.1">The encryption algorithm <span class="bcp14">SHOULD</span> be the same one used to protect communications in the group.<a href="#section-6.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-4.2">The included symmetric encryption keys are accompanied by a corresponding and unique key identifier assigned by the KDC.<a href="#section-6.2.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-4.3">A Base IV is also included with the same size of the AEAD nonce considered by the encryption algorithm to use.<a href="#section-6.2.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-5">First, the KDC computes a COSE_Encrypt0 object as follows.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.1">The encryption key to use is selected from the administrative keying material, as defined by the rekeying scheme used in the group.<a href="#section-6.2.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-6.2">The plaintext is the actual data content of the current rekeying message.<a href="#section-6.2.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-6.3">The Additional Authenticated Data (AAD) is empty unless otherwise specified by separate documents profiling the use of the group rekeying scheme.<a href="#section-6.2.1-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-6.4">
              <p id="section-6.2.1-6.4.1">Since the KDC is the only sender of rekeying messages, the AEAD nonce can be computed as follows, where NONCE_SIZE is the size in bytes of the AEAD nonce. Separate documents profiling the use of the group rekeying scheme may define alternative ways to compute the AEAD nonce.<a href="#section-6.2.1-6.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6.4.2">
The KDC considers the following values.<a href="#section-6.2.1-6.4.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.4.3.1">COUNT: as a 2-byte unsigned integer associated with the used encryption key. Its value is set to 0 when starting to perform a new group rekeying instance and is incremented after each use of the encryption key.<a href="#section-6.2.1-6.4.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-6.4.3.2">NEW_NUM: as the version number of the new group keying material to distribute in this rekeying instance, left-padded with zeros to exactly NONCE_SIZE - 2 bytes.<a href="#section-6.2.1-6.4.3.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-6.2.1-6.4.4">
Then, the KDC computes a Partial IV as the byte string concatenation of COUNT and NEW_NUM in this order. Finally, the AEAD nonce is computed as the XOR between the Base IV and the Partial IV.<a href="#section-6.2.1-6.4.4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6.4.5">
In order to comply with the security requirements of AEAD encryption algorithms, the KDC <span class="bcp14">MUST NOT</span> reuse the same pair (AEAD encryption key, AEAD nonce). For example, this includes not using the same encryption key from the administrative keying material more than 2<sup>16</sup> times during the same rekeying instance.<a href="#section-6.2.1-6.4.5" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.1-6.5">
              <p id="section-6.2.1-6.5.1">The protected header of the COSE_Encrypt0 object <span class="bcp14">MUST</span> include the following parameters.<a href="#section-6.2.1-6.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-6.5.2.1">'alg': specifying the used encryption algorithm.<a href="#section-6.2.1-6.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-6.2.1-6.5.2.2">'kid': specifying the identifier of the encryption key from the administrative keying material used to protect the current rekeying message.<a href="#section-6.2.1-6.5.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-6.2.1-6.6">The unprotected header of the COSE_Encrypt0 object <span class="bcp14">MUST</span> include the 'Partial IV' parameter with the value of the Partial IV computed above.<a href="#section-6.2.1-6.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-7">In order to ensure source authentication, each rekeying message protected with the administrative keying material <span class="bcp14">MUST</span> be signed by the KDC. To this end, the KDC computes a countersignature of the COSE_Encrypt0 object, as described in Sections <a href="https://rfc-editor.org/rfc/rfc9338#section-3.2" class="relref">3.2</a> and <a href="https://rfc-editor.org/rfc/rfc9338#section-3.3" class="relref">3.3</a> of <span>[<a href="#RFC9338" class="cite xref">RFC9338</a>]</span>. In particular, the following applies when computing the countersignature.<a href="#section-6.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-8.1">The Countersign_structure contains the context text string "CounterSignature0".<a href="#section-6.2.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-8.2">The private key of the KDC is used as the signing key.<a href="#section-6.2.1-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-8.3">The payload is the ciphertext of the COSE_Encrypt0 object.<a href="#section-6.2.1-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-8.4">The Additional Authenticated Data (AAD) is empty, unless otherwise specified by separate documents profiling the use of a group rekeying scheme.<a href="#section-6.2.1-8.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.2.1-8.5">The protected header of the signing object <span class="bcp14">MUST</span> include the parameter 'alg', which specifies the used signature algorithm.<a href="#section-6.2.1-8.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.2.1-9">If the source authentication of messages exchanged in the group is also ensured by means of signatures, then rekeying messages <span class="bcp14">MUST</span> be signed using the same signature algorithm and related parameters. Also, the KDC's authentication credential including the public key to use for signature verification <span class="bcp14">MUST</span> be provided in the Join Response through the 'kdc_cred' parameter, together with the corresponding proof-of-possession (PoP) evidence in the 'kdc_cred_verify' parameter.<a href="#section-6.2.1-9" class="pilcrow">¶</a></p>
<p id="section-6.2.1-10">If source authentication of messages exchanged in the group is not ensured by means of signatures, then the administrative keying material conveyed in the 'mgt_key_material' parameter of the Join Response sent by KDC (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>) <span class="bcp14">MUST</span> also comprise a KDC's authentication credential including the public key to use for signature verification, together with the corresponding PoP evidence. Within the 'mgt_key_material' parameter, it is <span class="bcp14">RECOMMENDED</span> to specify this information by using the same format and encoding used for the parameters 'kdc_cred', 'kdc_nonce', and 'kdc_cred_verify' in the Join Response. It is up to separate documents profiling the use of the group rekeying scheme to specify such details.<a href="#section-6.2.1-10" class="pilcrow">¶</a></p>
<p id="section-6.2.1-11">After that, the KDC specifies the computed countersignature in the 'Countersignature0 version 2' header parameter of the COSE_Encrypt0 object.<a href="#section-6.2.1-11" class="pilcrow">¶</a></p>
<p id="section-6.2.1-12">Finally, the KDC specifies the COSE_Encrypt0 object as payload of a CoAP request, which is sent to the target group members as per the used message delivery method.<a href="#section-6.2.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-misalignment-keying-material">
<section id="section-6.3">
        <h3 id="name-misalignment-of-group-keyin">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-misalignment-of-group-keyin" class="section-name selfRef">Misalignment of Group Keying Material</a>
        </h3>
<p id="section-6.3-1">A group member can receive a message shortly after the group has been rekeyed and new keying material has been distributed by the KDC. In the following two cases, this may result in misaligned keying material between the group members.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">In the first case, the sender protects a message using the old group keying material. However, the recipient receives the message after having received the new group keying material, hence it is not able to correctly process the message. A possible way to limit the impact of this issue is to preserve the old, retained group keying material for a maximum amount of time defined by the application, during which such group keying material is used solely for processing incoming messages. By doing so, the recipient can still temporarily process received messages also by using the old, retained group keying material. Note that a former (compromised) group member can take advantage of this by sending messages protected with the old, retained group keying material. Therefore, a conservative application policy should not admit the storage of old group keying material. Eventually, the sender will have obtained the new group keying material too and can possibly resend the message protected with such keying material.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">In the second case, the sender protects a message using the new group keying material, but the recipient receives that message before having received the new group keying material. Therefore, the recipient will not be able to correctly process the message and hence will discard it. If the recipient receives the new group keying material shortly after that and the application at the sender endpoint performs retransmissions, the former will still be able to receive and correctly process the message. In any case, the recipient should actively ask the KDC for the latest group keying material according to an application-defined policy, for instance, after a given number of unsuccessfully decrypted incoming messages.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-extended-scope">
<section id="section-7">
      <h2 id="name-extended-scope-format">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-extended-scope-format" class="section-name selfRef">Extended Scope Format</a>
      </h2>
<p id="section-7-1">This section defines an extended format of binary-encoded scope, which additionally specifies the semantics used to express the same access control information from the corresponding original scope.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">As also discussed in <a href="#ssec-authorization-response" class="auto internal xref">Section 3.2</a>, this enables a Resource Server to unambiguously process a received access token, also in case the Resource Server runs multiple applications or application profiles that involve different scope semantics.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The extended format is intended only for the 'scope' claim of access tokens for the cases where the claim takes a CBOR byte string as the value. That is, the extended format does not apply to the 'scope' parameter included in ACE messages, i.e., the Authorization Request and Authorization Response exchanged between the Client and the Authorization Server (see Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">5.8.1</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">5.8.2</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), the AS Request Creation Hints message from the Resource Server (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), and the Introspection Response from the Authorization Server (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.2" class="relref">Section 5.9.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The value of the 'scope' claim following the extended format is composed as follows. Given the original scope using semantics SEM and encoded as a CBOR byte string, the corresponding extended scope consists of the same CBOR byte string enclosed by a CBOR tag <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, whose tag number identifies the semantics SEM.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">The resulting tagged CBOR byte string is used as the value of the 'scope' claim of the access token.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">Figures <a href="#cddl-ex-0-ext" class="auto internal xref">36</a> and <a href="#cddl-ex-ext" class="auto internal xref">37</a> build on the examples in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a> and show the corresponding extended scopes.<a href="#section-7-6" class="pilcrow">¶</a></p>
<span id="name-example-of-extended-scope-u"></span><div id="cddl-ex-0-ext">
<figure id="figure-36">
        <div class="lang-cddl sourcecode" id="section-7-7.1">
<pre>
;# include rfc9237

gname = tstr

permissions = uint .bits roles

roles = &amp;(
   Requester: 1,
   Responder: 2,
   Monitor: 3,
   Verifier: 4
)

scope_entries = AIF-Generic&lt;gname, permissions&gt;

scope = bstr .cbor scope_entries

extended_scope = #6.&lt;TAG_FOR_THIS_SEMANTICS&gt;(scope)

TAG_FOR_THIS_SEMANTICS = uint
</pre>
</div>
<figcaption><a href="#figure-36" class="selfRef">Figure 36</a>:
<a href="#name-example-of-extended-scope-u" class="selfRef">Example of Extended scope Using AIF</a>
        </figcaption></figure>
</div>
<span id="name-example-of-extended-scope-us"></span><div id="cddl-ex-ext">
<figure id="figure-37">
        <div class="lang-cddl sourcecode" id="section-7-8.1">
<pre>
gname = tstr

role = tstr

scope_entry = [ gname , ? ( role / [ 2*role ] ) ]

scope_entries = [ * scope_entry ]

scope = bstr .cbor scope_entries

extended_scope = #6.&lt;TAG_FOR_THIS_SEMANTICS&gt;(scope)

TAG_FOR_THIS_SEMANTICS = uint
</pre>
</div>
<figcaption><a href="#figure-37" class="selfRef">Figure 37</a>:
<a href="#name-example-of-extended-scope-us" class="selfRef">Example of Extended scope Using the Textual Format, with the Role Identifiers Encoded as Text Strings</a>
        </figcaption></figure>
</div>
<p id="section-7-9">The usage of the extended scope format is not limited to application profiles of this specification or to applications based on group communication. Rather, it is generally applicable to any application and application profile where access control information in the access token is expressed as a binary-encoded scope.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">Applications and application profiles using the extended format of scope have to specify which CBOR tag from <span>[<a href="#CBOR.Tags" class="cite xref">CBOR.Tags</a>]</span> is used for identifying the scope semantics or to register a new CBOR tag if a suitable one does not exist already (<a href="#req28" class="internal xref">REQ28</a>). In case there is an already existing, suitable CBOR tag, a new CBOR tag should not be registered in order to avoid code point squatting.<a href="#section-7-10" class="pilcrow">¶</a></p>
<p id="section-7-11">If the binary-encoded scope uses semantics associated with a registered CoAP Content-Format <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> <span>[<a href="#CoAP.Content.Formats" class="cite xref">CoAP.Content.Formats</a>]</span>, then a suitable CBOR tag associated with that CoAP Content-Format would already be registered, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9277#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>.<a href="#section-7-11" class="pilcrow">¶</a></p>
<p id="section-7-12">This is especially relevant when the binary encoded scope uses AIF. That is, it is expected that the definition of an AIF-specific data model comes together with the registration of CoAP Content-Formats for the relevant combinations of its Toid and Tperm values. As discussed above, this yields the automatic registration of the CBOR tags associated with those CoAP Content-Formats.<a href="#section-7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="params">
<section id="section-8">
      <h2 id="name-ace-groupcomm-parameters">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ace-groupcomm-parameters" class="section-name selfRef">ACE Groupcomm Parameters</a>
      </h2>
<p id="section-8-1">This specification defines a number of parameters used during the second phase of the key provisioning process, i.e., after the exchange after the exchange of Token Transfer Request and Response. The table below summarizes them and specifies the CBOR map keys to use instead of the full descriptive names.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Note that the media type "application/ace-groupcomm+cbor" <span class="bcp14">MUST</span> be used when these parameters are transported in the respective CBOR map entries.<a href="#section-8-2" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-parameters-2"></span><div id="fig-ACE-Groupcomm-Parameters">
<table class="center" id="table-5">
        <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-ace-groupcomm-parameters-2" class="selfRef">ACE Groupcomm Parameters</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gid</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gname</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">array of tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">guri</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">array of tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">scope</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">get_creds</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">Null or array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">cnonce</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gkty</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">int or tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">key</td>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">See the "ACE Groupcomm Key Types" registry</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">num</td>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ace_groupcomm_profile</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exp</td>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">uint</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exi</td>
            <td class="text-left" rowspan="1" colspan="1">12</td>
            <td class="text-left" rowspan="1" colspan="1">uint</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">creds</td>
            <td class="text-left" rowspan="1" colspan="1">13</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">peer_roles</td>
            <td class="text-left" rowspan="1" colspan="1">14</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">peer_identifiers</td>
            <td class="text-left" rowspan="1" colspan="1">15</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">group_policies</td>
            <td class="text-left" rowspan="1" colspan="1">16</td>
            <td class="text-left" rowspan="1" colspan="1">map</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kdc_cred</td>
            <td class="text-left" rowspan="1" colspan="1">17</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kdc_nonce</td>
            <td class="text-left" rowspan="1" colspan="1">18</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kdc_cred_verify</td>
            <td class="text-left" rowspan="1" colspan="1">19</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">rekeying_scheme</td>
            <td class="text-left" rowspan="1" colspan="1">20</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">client_cred_verify</td>
            <td class="text-left" rowspan="1" colspan="1">24</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">creds_repo</td>
            <td class="text-left" rowspan="1" colspan="1">25</td>
            <td class="text-left" rowspan="1" colspan="1">tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">control_uri</td>
            <td class="text-left" rowspan="1" colspan="1">26</td>
            <td class="text-left" rowspan="1" colspan="1">tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">mgt_key_material</td>
            <td class="text-left" rowspan="1" colspan="1">27</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">control_group_uri</td>
            <td class="text-left" rowspan="1" colspan="1">28</td>
            <td class="text-left" rowspan="1" colspan="1">tstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_info</td>
            <td class="text-left" rowspan="1" colspan="1">29</td>
            <td class="text-left" rowspan="1" colspan="1">Null or array</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594 </td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">kdcchallenge</td>
            <td class="text-left" rowspan="1" colspan="1">30</td>
            <td class="text-left" rowspan="1" colspan="1">bstr</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9594</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-8-4">The KDC is expected to support all the parameters above. Instead, a Client can support only a subset of such parameters, depending on the roles it expects to take in the joined groups or on other conditions defined in application profiles of this specification.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">In the following, the parameters are categorized according to the support expected by Clients. That is, a Client that supports a parameter is able to: i) use and specify it in a request message to the KDC; and ii) understand and process it if specified in a response message from the KDC. It is <span class="bcp14">REQUIRED</span> of application profiles of this specification to sort their newly defined parameters according to the same categorization (<a href="#req29" class="internal xref">REQ29</a>).<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Note that the actual use of a parameter and its inclusion in a message depends on the specific exchange, the specific Client and group involved, as well as what is defined in the used application profile of this specification.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">A Client <span class="bcp14">MUST</span> support the following parameters.<a href="#section-8-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-8.1">'scope'<a href="#section-8-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.2">'cnonce'<a href="#section-8-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.3">'gkty'<a href="#section-8-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.4">'key'<a href="#section-8-8.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.5">'num'<a href="#section-8-8.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.6">'exp'<a href="#section-8-8.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.7">'exi'<a href="#section-8-8.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.8">'gid'<a href="#section-8-8.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.9">'gname'<a href="#section-8-8.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.10">'guri'<a href="#section-8-8.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.11">'creds'<a href="#section-8-8.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.12">'peer_identifiers'<a href="#section-8-8.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.13">'ace_groupcomm_profile'<a href="#section-8-8.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.14">'control_uri'<a href="#section-8-8.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-8.15">'rekeying_scheme'<a href="#section-8-8.15" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-9">A Client <span class="bcp14">SHOULD</span> support the following parameter.<a href="#section-8-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-10.1">'get_creds': That is, not supporting this parameter would yield the inconvenient and undesirable behavior where: i) the Client does not ask for the other group members' authentication credentials upon joining the group (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>); and ii) later on as a group member, the Client only retrieves the authentication credentials of all group members (see <a href="#sec-key-retrieval-all" class="auto internal xref">Section 4.4.2.1</a>).<a href="#section-8-10.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-11">The following conditional parameters are relevant only if specific conditions hold. It is <span class="bcp14">REQUIRED</span> of application profiles of this specification to define whether Clients must, should, or may support these parameters and under which circumstances (<a href="#req30" class="internal xref">REQ30</a>).<a href="#section-8-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-12.1">'client_cred' and 'client_cred_verify': These parameters are relevant for a Client that has an authentication credential to use in a joined group.<a href="#section-8-12.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.2">'kdcchallenge': This parameter is relevant for a Client that has an authentication credential to use in a joined group and that provides the access token to the KDC through a Token Transfer Request (see <a href="#token-post" class="auto internal xref">Section 3.3</a>).<a href="#section-8-12.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.3">'creds_repo': This parameter is relevant for a Client that has an authentication credential to use in a joined group and that makes it available from a key repository different than the KDC.<a href="#section-8-12.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.4">'group_policies': This parameter is relevant for a Client that is interested in the specific policies used in a group, but it does not know them or cannot become aware of them before joining that group.<a href="#section-8-12.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.5">'peer_roles': This parameter is relevant for a Client that has to know about the roles of other group members, especially when retrieving and handling their corresponding authentication credentials.<a href="#section-8-12.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.6">'kdc_nonce', 'kdc_cred', and 'kdc_cred_verify': These parameters are relevant for a Client that joins a group for which, as per the used application profile of this specification, the KDC has an associated authentication credential and this is required for the correct group operation.<a href="#section-8-12.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.7">'mgt_key_material': This parameter is relevant for a Client that supports an advanced rekeying scheme possibly used in the group, such as based on one-to-many rekeying messages sent over IP multicast.<a href="#section-8-12.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-12.8">'control_group_uri': This parameter is relevant for a Client that also acts as a CoAP server supporting: i) the hosting of a dedicated resource for each group that the Client is interested to be a part of; and ii) the reception of one-to-many requests sent to those resources by the KDC (e.g., over IP multicast), as targeting multiple members of the corresponding group. Examples of related management operations that the KDC can perform by this means are the eviction of group members and the execution of a group rekeying process through an advanced rekeying scheme, such as based on one-to-many rekeying messages.<a href="#section-8-12.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="error-types">
<section id="section-9">
      <h2 id="name-ace-groupcomm-error-identif">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-ace-groupcomm-error-identif" class="section-name selfRef">ACE Groupcomm Error Identifiers</a>
      </h2>
<p id="section-9-1">This specification defines a number of values that the KDC can use as error identifiers. These are used in error responses with Content-Format "application/concise-problem-details+cbor", as values of the 'error-id' field within the Custom Problem Detail entry 'ace-groupcomm-error' (see <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>).<a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-ace-groupcomm-error-identifi"></span><div id="fig-ACE-Groupcomm-Error-Identifiers">
<table class="center" id="table-6">
        <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-ace-groupcomm-error-identifi" class="selfRef">ACE Groupcomm Error Identifiers</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Operation permitted only to group members</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">Request inconsistent with the current roles</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">Authentication credential incompatible with the group configuration</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">Invalid proof-of-possession evidence</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">No available individual keying material</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">Group membership terminated</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">Group deleted</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-9-3">If a Client supports the problem-details format <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> and the Custom Problem Detail entry 'ace-groupcomm-error' defined in <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a> of this document and is able to understand the error specified in the 'error-id' field therein, then the Client can use that information to determine what actions to take next. If the Concise Problem Details data item specified in the error response includes the 'detail' entry and the Client supports it, such an entry may provide additional context.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">In particular, the following guidelines apply, and application profiles of this specification can define more detailed actions for the Client to take when learning that a specific error has occurred.<a href="#section-9-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-5.1">In case of error 0, the Client should stop sending the request in question to the KDC. Rather, the Client should first join the targeted group. If it has not happened already, this first requires the Client to obtain an appropriate access token authorizing access to the group and provide it to the KDC.<a href="#section-9-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.2">In case of error 1, the Client as a group member should rejoin the group with all the roles needed to perform the operation in question. This might require the Client to first obtain a new access token and provide it to the KDC, if the current access token does not authorize the Client to take those roles in the group. For operations admitted to a Client that is not a group member (e.g., an external signature verifier), the Client should first obtain a new access token authorizing to also have the missing roles.<a href="#section-9-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.3">In case of error 2, the Client has to obtain or self-generate a different asymmetric key pair, as aligned to the public key algorithm and parameters used in the targeted group. After that, the Client should provide the KDC with its new authentication credential, which is consistent with the format used in the targeted group and including the new public key.<a href="#section-9-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.4">In case of error 3, the Client should ensure to compute its proof-of-possession evidence by correctly using the parameters and procedures defined in the used application profile of this specification. In an unattended setup, it might not be possible for a Client to autonomously diagnose the error and take an effective next action to address it.<a href="#section-9-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.5">In case of error 4, the Client should wait for a certain (pre-configured) amount of time before trying to resend its request to the KDC.<a href="#section-9-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.6">In case of error 5, the Client may try joining the group again. This might require the Client to first obtain a new access token and provide it to the KDC, e.g., if the current access token has expired.<a href="#section-9-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-5.7">In case of error 6, the Client should clean up its state regarding the group, just like if it has left the group with no intention to rejoin it.<a href="#section-9-5.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec-cons">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">Security considerations are inherited from the ACE framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> and from the specific transport profile of ACE used between the Clients and the KDC, e.g., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> and <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">When using the problem-details format defined in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> for error responses, then the privacy and security considerations from Sections <a href="https://rfc-editor.org/rfc/rfc9290#section-4" class="relref">4</a> and <a href="https://rfc-editor.org/rfc/rfc9290#section-5" class="relref">5</a> of <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> also apply.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Furthermore, the following security considerations apply.<a href="#section-10-3" class="pilcrow">¶</a></p>
<div id="sec-cons-communication">
<section id="section-10.1">
        <h3 id="name-secure-communication-in-the">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-secure-communication-in-the" class="section-name selfRef">Secure Communication in the Group</a>
        </h3>
<p id="section-10.1-1">When a group member receives a message from a certain sender for the first time since joining the group, it needs to have a mechanism in place to avoid replayed messages and to assert their freshness, e.g., as described in <span><a href="https://rfc-editor.org/rfc/rfc8613#appendix-B.1.2" class="relref">Appendix B.1.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> or <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-22#section-10" class="relref">Section 10</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="cite xref">GROUP-OSCORE</a>]</span>. Such a mechanism also aids the recipient group member in case it has rebooted and lost the security state used to protect previous group communications with that sender.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">By its nature, the KDC is invested with a large amount of trust, since it acts as a generator and provider of the symmetric keying material used to protect communications in each of its groups. While details depend on the specific communication and security protocols used in the group, the KDC is in the position to decrypt messages exchanged in the group as if it was also a group member, as long as those are protected through commonly shared group keying material.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">A compromised KDC would thus put the attacker in the same position, which also means that:<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-4.1">The attacker can generate and control new group keying material, hence possibly rekeying the group and evicting certain group members as part of a broader attack.<a href="#section-10.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-4.2">The attacker can actively participate in communications in a group, even without having been authorized to join it, and can allow further unauthorized entities to do so.<a href="#section-10.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.1-4.3">The attacker can build erroneous associations between node identifiers and group members' authentication credentials.<a href="#section-10.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.1-5">On the other hand, as long as the security protocol used in the group ensures source authentication of messages (e.g., by means of signatures), the KDC is not able to impersonate group members since it does not have their private keys.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1-6">Further security considerations are specific to the communication and security protocols used in the group, and thus have to be provided by those protocols and complemented by the application profiles of this specification using them.<a href="#section-10.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-rekeying">
<section id="section-10.2">
        <h3 id="name-update-of-group-keying-mate">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-update-of-group-keying-mate" class="section-name selfRef">Update of Group Keying Material</a>
        </h3>
<p id="section-10.2-1">The KDC can generate new group keying material and provide it to the group members (rekeying) through the rekeying scheme used in the group, as discussed in <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">In particular, the KDC must renew the latest group keying material upon its expiration. Before then, the KDC <span class="bcp14">MAY</span> also renew the group keying material on a regular or periodical fashion.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">Unless otherwise defined by an application profile of this specification, the KDC <span class="bcp14">SHOULD</span> renew the group keying material upon a group membership change. As a possible exception, the KDC may not rekey the group upon the joining of a new group member if the application does not require backward security. As another possible exception discussed more in detail later in this section, the KDC may rely on a rekeying policy that reasonably takes into account the expected rate of group membership changes and the duration of a group rekeying.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">Since the minimum number of group members is one, the KDC <span class="bcp14">SHOULD</span> provide even a Client joining an empty group with new keying material never used before in that group. Similarly, the KDC <span class="bcp14">SHOULD</span> also provide new group keying material to a Client that remains the only member in the group after the leaving of other group members.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">Note that the considerations in <a href="#sec-cons-communication" class="auto internal xref">Section 10.1</a> about dealing with replayed messages still hold, even in case the KDC rekeys the group upon every single joining of a new group member. However, if the KDC has renewed the group keying material upon a group member's joining and the time interval between the end of the rekeying process and that member's joining is sufficiently small, then that group member is also on the safe side, since it would not accept replayed messages protected with the old group keying material previous to its joining.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6">Once a joining node has obtained the new, latest keying material through a Join Response from the KDC (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>), the joining node becomes able to read any message that was exchanged in the group and protected with that keying material. This is the case if the KDC provides the current group members with the new, latest keying material before completing the joining procedure. However, the joining node is not able to read messages exchanged in the group and protected with keying material older than the one provided in the Join Response, i.e., having a strictly lower version number NUM.<a href="#section-10.2-6" class="pilcrow">¶</a></p>
<p id="section-10.2-7">A node that has left the group should not expect any of its outgoing messages to be successfully processed if received by other nodes in the group after its leaving due to a possible group rekeying occurring before the message reception.<a href="#section-10.2-7" class="pilcrow">¶</a></p>
<p id="section-10.2-8">The KDC may enforce a rekeying policy that takes into account the overall time required to rekey the group, as well as the expected rate of changes in the group membership. That is, the KDC may not rekey the group at each and every group membership change, for instance, if members' joining and leaving occur frequently and performing a group rekeying takes too long. Instead, the KDC might rekey the group after a minimum number of group members have joined or left within a given time interval, after a maximum amount of time since the last group rekeying was completed, or yet during predictable network inactivity periods.<a href="#section-10.2-8" class="pilcrow">¶</a></p>
<p id="section-10.2-9">However, this would result in the KDC not constantly preserving backward and forward security in the group. That is:<a href="#section-10.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-10.1">Newly joining group members would be able to access the keying material used before their joining, and thus they could access past group communications if they have recorded old exchanged messages. This might still be acceptable for some applications and in situations where the new group members are freshly deployed through strictly controlled procedures.<a href="#section-10.2-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-10.2">The leaving group members would remain able to access upcoming group communications, as protected with the current keying material that has not been updated. This is typically undesirable, especially if the leaving group member is compromised or suspected to be, and it might impact or compromise the security properties of the protocols used in the group to protect messages exchanged among the group members.<a href="#section-10.2-10.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.2-11">The KDC should renew the group keying material in case it has rebooted, even if it stores the whole group keying material in persistent storage. This assumes that the secure communication associations with the current group members as well as any administrative keying material required to rekey the group are also stored in persistent storage.<a href="#section-10.2-11" class="pilcrow">¶</a></p>
<p id="section-10.2-12">However, if the KDC relies on Observe notifications to distribute the new group keying material, the KDC would have lost all the current ongoing Observations with the group members after rebooting, and the group members would continue using the old group keying material. Therefore, the KDC will rely on each group member asking for the new group keying material (see Sections <a href="#ssec-key-material-retrieval" class="auto internal xref">4.3.2.1</a> and <a href="#update-keys" class="auto internal xref">4.8.1.1</a>) or perform a group rekeying by actively sending rekeying messages to group members as discussed in <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>.<a href="#section-10.2-12" class="pilcrow">¶</a></p>
<p id="section-10.2-13">The KDC needs to have a mechanism in place to detect DoS attacks from nodes repeatedly performing actions that might trigger a group rekeying. Such actions can include leaving and/or rejoining the group at high rates or often asking the KDC for new individual keying material. Ultimately, the KDC can resort to removing these nodes from the group and (temporarily) preventing them from joining the group again.<a href="#section-10.2-13" class="pilcrow">¶</a></p>
<p id="section-10.2-14">The KDC also needs to have a congestion control mechanism in place in order to avoid network congestion upon distributing new group keying material. For example, CoAP and Observe give guidance on such mechanisms, see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.7" class="relref">Section 4.7</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>.<a href="#section-10.2-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="block-wise-considerations">
<section id="section-10.3">
        <h3 id="name-block-wise-considerations">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-block-wise-considerations" class="section-name selfRef">Block-Wise Considerations</a>
        </h3>
<p id="section-10.3-1">If the Block-Wise CoAP options <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> are used and the keying material is updated in the middle of a Block-Wise transfer, the sender of the blocks just changes the group keying material to the updated one and continues the transfer. As long as both sides get the new group keying material, updating the group keying material in the middle of a transfer will not cause any issue. Otherwise, the sender will have to transmit the message again when receiving an error message from the recipient.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Compared to a scenario where the transfer does not use Block-Wise, and depending on how fast the group keying material is changed, the group members might consume a larger amount of the network bandwidth by repeatedly resending the same blocks, which might be problematic.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">Per this document, IANA has completed the following actions.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="media-type">
<section id="section-11.1">
        <h3 id="name-media-type-registrations">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-11.1-1">This specification has registered the "application/ace-groupcomm+cbor" media type for messages of the protocols defined in this document following the ACE exchange and carrying parameters encoded in CBOR. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.1-2">
          <dt id="section-11.1-2.1">Type name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.2">application<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.3">Subtype name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.4"> ace-groupcomm+cbor<a href="#section-11.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.5">Required parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.6"> N/A<a href="#section-11.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.7">Optional parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.8"> N/A<a href="#section-11.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.9">Encoding considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.10"> Must be encoded as a CBOR map containing the parameters defined in RFC 9594.<a href="#section-11.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.11">Security considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.12"> See <a href="#sec-cons" class="auto internal xref">Section 10</a> of RFC 9594.<a href="#section-11.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.13">Interoperability considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.14"> N/A<a href="#section-11.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.15">Published specification:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.16"> RFC 9594<a href="#section-11.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.17">Applications that use this media type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.18"> The type is used by Authorization Servers, Clients, and Resource Servers that support the ACE groupcomm framework as specified in RFC 9594.<a href="#section-11.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.19">Fragment identifier considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.20"> N/A<a href="#section-11.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.21">Additional information:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.22"> N/A<a href="#section-11.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.23">Person &amp; email address to contact for further information:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.24"> ACE WG mailing list (ace@ietf.org) or IETF Applications and Real-Time Area (art@ietf.org)<a href="#section-11.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.25">Intended usage:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.26"> COMMON<a href="#section-11.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.27">Restrictions on usage:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.28"> None<a href="#section-11.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.29">Author/Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.30"> IETF<a href="#section-11.1-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.1-2.31">Provisional registration:</dt>
          <dd style="margin-left: 1.5em" id="section-11.1-2.32"> No<a href="#section-11.1-2.32" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="content-type">
<section id="section-11.2">
        <h3 id="name-coap-content-formats">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-coap-content-formats" class="section-name selfRef">CoAP Content-Formats</a>
        </h3>
<p id="section-11.2-1">IANA has registered the following entry in the "CoAP Content-Formats" registry within the "CoRE Parameters" registry group.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.2-2">
          <dt id="section-11.2-2.1">Content Type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.2-2.2"> application/ace-groupcomm+cbor<a href="#section-11.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.2-2.3">Content Coding:</dt>
          <dd style="margin-left: 1.5em" id="section-11.2-2.4"> -<a href="#section-11.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.2-2.5">ID:</dt>
          <dd style="margin-left: 1.5em" id="section-11.2-2.6"> 261<a href="#section-11.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.2-2.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.2-2.8"> RFC 9594<a href="#section-11.2-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-kinfo">
<section id="section-11.3">
        <h3 id="name-oauth-parameters">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-oauth-parameters" class="section-name selfRef">OAuth Parameters</a>
        </h3>
<p id="section-11.3-1">IANA has registered the following entries in the "OAuth Parameters" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-11.2" class="relref">Section 11.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.3-2">
          <dt id="section-11.3-2.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.2"> sign_info<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.3">Parameter Usage Location:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.4"> client-rs request, rs-client response<a href="#section-11.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.5">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.6"> IETF<a href="#section-11.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.8"> RFC 9594<a href="#section-11.3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.3-3">
          <dt id="section-11.3-3.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-3.2"> kdcchallenge<a href="#section-11.3-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-3.3">Parameter Usage Location:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-3.4"> rs-client response<a href="#section-11.3-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-3.5">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-3.6"> IETF<a href="#section-11.3-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-3.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-3.8"> RFC 9594<a href="#section-11.3-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-kinfo-map">
<section id="section-11.4">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings</a>
        </h3>
<p id="section-11.4-1">IANA has registered the following entries in the "OAuth Parameters CBOR
Mappings" registry, following the procedure specified in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-8.10" class="relref">Section 8.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.4-2">
          <dt id="section-11.4-2.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-2.2">sign_info<a href="#section-11.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-2.3">CBOR Key:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-2.4">45<a href="#section-11.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-2.5">Value Type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-2.6">Null or array<a href="#section-11.4-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-2.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-2.8">RFC 9594<a href="#section-11.4-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.4-3">
          <dt id="section-11.4-3.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-3.2">kdcchallenge<a href="#section-11.4-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-3.3">CBOR Key:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-3.4">46<a href="#section-11.4-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-3.5">Value Type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-3.6">byte string<a href="#section-11.4-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.4-3.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.4-3.8">RFC 9594<a href="#section-11.4-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="if-ace-group">
<section id="section-11.5">
        <h3 id="name-interface-description-if-li">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-interface-description-if-li" class="section-name selfRef">Interface Description (if=) Link Target Attribute Values</a>
        </h3>
<p id="section-11.5-1">IANA has registered the following entry in the "Interface Description (if=) Link Target Attribute Values" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.5-2">
          <dt id="section-11.5-2.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-2.2"> ace.groups<a href="#section-11.5-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.5-2.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-2.4"> The KDC interface at the parent resource of group-membership resources is used to retrieve names of security groups using the ACE framework.<a href="#section-11.5-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.5-2.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-2.6">
            <a href="#kdc-if" class="auto internal xref">Section 4.1</a> of RFC 9594<a href="#section-11.5-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.5-3">
          <dt id="section-11.5-3.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-3.2"> ace.group<a href="#section-11.5-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.5-3.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-3.4"> The KDC interface at a group-membership resource is used to provision keying material and related information and policies to members of the corresponding security group using the ACE framework.<a href="#section-11.5-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.5-3.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.5-3.6">
            <a href="#kdc-if" class="auto internal xref">Section 4.1</a> of RFC 9594<a href="#section-11.5-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-custom-problem-details">
<section id="section-11.6">
        <h3 id="name-custom-problem-detail-keys-">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-custom-problem-detail-keys-" class="section-name selfRef">Custom Problem Detail Keys Registry</a>
        </h3>
<p id="section-11.6-1">IANA has registered the following entry in the "Custom Problem Detail Keys" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-11.6-2">
          <dt id="section-11.6-2.1">Key Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.6-2.2">0<a href="#section-11.6-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.6-2.3">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.6-2.4"> ace-groupcomm-error<a href="#section-11.6-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.6-2.5">Brief Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.6-2.6">Carry RFC 9594 problem details in a Concise Problem Details data item.<a href="#section-11.6-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.6-2.7">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-11.6-2.8"> IETF<a href="#section-11.6-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.6-2.9">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.6-2.10">RFC 9594, <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a><a href="#section-11.6-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-reg">
<section id="section-11.7">
        <h3 id="name-ace-groupcomm-parameters-3">
<a href="#section-11.7" class="section-number selfRef">11.7. </a><a href="#name-ace-groupcomm-parameters-3" class="section-name selfRef">ACE Groupcomm Parameters</a>
        </h3>
<p id="section-11.7-1">This specification has established the "ACE Groupcomm Parameters" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.7-1" class="pilcrow">¶</a></p>
<p id="section-11.7-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a><a href="#section-11.7-2" class="pilcrow">¶</a></p>
<p id="section-11.7-3">The columns of this registry are:<a href="#section-11.7-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.7-4">
          <dt id="section-11.7-4.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.7-4.2"> This is a descriptive name that enables easier reference to
the item. The name <span class="bcp14">MUST</span> be unique. It is not used in the encoding.<a href="#section-11.7-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.7-4.3">CBOR Key:</dt>
          <dd style="margin-left: 1.5em" id="section-11.7-4.4"> This is the value used as the CBOR map key of the item. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a text string. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 as well as text strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 as well as text strings of length 2 are designated as "Specification Required". Integer values greater than 65535 as well as text strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.7-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.7-4.5">CBOR Type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.7-4.6"> This field contains the CBOR type of the item or a pointer to the registry that defines its type when that depends on another item.<a href="#section-11.7-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.7-4.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.7-4.8"> This field contains a pointer to the public specification for the item.<a href="#section-11.7-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.7-5">This registry has been initially populated with the values in <a href="#fig-ACE-Groupcomm-Parameters" class="auto internal xref">Table 5</a>.<a href="#section-11.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-key">
<section id="section-11.8">
        <h3 id="name-ace-groupcomm-key-types-2">
<a href="#section-11.8" class="section-number selfRef">11.8. </a><a href="#name-ace-groupcomm-key-types-2" class="section-name selfRef">ACE Groupcomm Key Types</a>
        </h3>
<p id="section-11.8-1">This specification establishes the "ACE Groupcomm Key Types" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.8-1" class="pilcrow">¶</a></p>
<p id="section-11.8-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.8-2" class="pilcrow">¶</a></p>
<p id="section-11.8-3">The columns of this registry are:<a href="#section-11.8-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.8-4">
          <dt id="section-11.8-4.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.8-4.2"> This is a descriptive name that enables easier reference to
the item. The name <span class="bcp14">MUST</span> be unique. It is not used in the encoding.<a href="#section-11.8-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.8-4.3">Key Type Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.8-4.4"> This is the value used to identify the keying material. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a text string. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 as well as text strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 as well as text strings of length 2 are designated as "Specification Required". Integer values greater than 65535 as well as text strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.8-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.8-4.5">Profile:</dt>
          <dd style="margin-left: 1.5em" id="section-11.8-4.6"> This field may contain one or more descriptive strings of application profiles to be used with this item. The values should be taken from the "Name" column of the "ACE Groupcomm Profiles" registry.<a href="#section-11.8-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.8-4.7">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.8-4.8"> This field contains a brief description of the keying material.<a href="#section-11.8-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.8-4.9">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.8-4.10"> This field contains a pointer to the public specification for the format of the keying material, if one exists.<a href="#section-11.8-4.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.8-5">This registry has been initially populated with the value in <a href="#fig-gkty" class="auto internal xref">Table 1</a>.<a href="#section-11.8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace-groupcomm-profiles">
<section id="section-11.9">
        <h3 id="name-ace-groupcomm-profiles-2">
<a href="#section-11.9" class="section-number selfRef">11.9. </a><a href="#name-ace-groupcomm-profiles-2" class="section-name selfRef">ACE Groupcomm Profiles</a>
        </h3>
<p id="section-11.9-1">This specification establishes the "ACE Groupcomm Profiles" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.9-1" class="pilcrow">¶</a></p>
<p id="section-11.9-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.9-2" class="pilcrow">¶</a></p>
<p id="section-11.9-3">The columns of this registry are:<a href="#section-11.9-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.9-4">
          <dt id="section-11.9-4.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.9-4.2"> The name of the application profile.<a href="#section-11.9-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.9-4.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.9-4.4"> Text giving an overview of the application profile and the context it is developed for.<a href="#section-11.9-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.9-4.5">CBOR Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.9-4.6"> CBOR abbreviation for the name of this application profile. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer or a negative integer. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 are designated as "Specification Required". Integer values greater than 65535 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.9-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.9-4.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.9-4.8"> This field contains a pointer to the public specification for this application profile, if one exists.<a href="#section-11.9-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.9-5">This registry has been initially populated with the value in <a href="#ace-groupcomm-profile-0" class="auto internal xref">Table 2</a>.<a href="#section-11.9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace-groupcomm-policies">
<section id="section-11.10">
        <h3 id="name-ace-groupcomm-policies-2">
<a href="#section-11.10" class="section-number selfRef">11.10. </a><a href="#name-ace-groupcomm-policies-2" class="section-name selfRef">ACE Groupcomm Policies</a>
        </h3>
<p id="section-11.10-1">This specification establishes the "ACE Groupcomm Policies" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.10-1" class="pilcrow">¶</a></p>
<p id="section-11.10-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.10-2" class="pilcrow">¶</a></p>
<p id="section-11.10-3">The columns of this registry are:<a href="#section-11.10-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.10-4">
          <dt id="section-11.10-4.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.10-4.2"> The name of the group communication policy.<a href="#section-11.10-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.10-4.3">CBOR Label:</dt>
          <dd style="margin-left: 1.5em" id="section-11.10-4.4"> The value to be used to identify this group communication policy. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a text string. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 as well as text strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 as well as text strings of length 2 are designated as "Specification Required". Integer values greater than 65535 as well as text strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.10-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.10-4.5">CBOR Type:</dt>
          <dd style="margin-left: 1.5em" id="section-11.10-4.6"> The CBOR type used to encode the value of this group communication policy.<a href="#section-11.10-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.10-4.7">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.10-4.8"> This field contains a brief description for this group communication policy.<a href="#section-11.10-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.10-4.9">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.10-4.10"> This field contains a pointer to the public specification for this group communication policy and its format, if one exists.<a href="#section-11.10-4.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.10-5">This registry has been initially populated with the values in <a href="#fig-ACE-Groupcomm-Policies" class="auto internal xref">Table 3</a>.<a href="#section-11.10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sequence-number-synchronization-methods">
<section id="section-11.11">
        <h3 id="name-sequence-number-synchroniza">
<a href="#section-11.11" class="section-number selfRef">11.11. </a><a href="#name-sequence-number-synchroniza" class="section-name selfRef">Sequence Number Synchronization Methods</a>
        </h3>
<p id="section-11.11-1">This specification establishes the "Sequence Number Synchronization Methods" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.11-1" class="pilcrow">¶</a></p>
<p id="section-11.11-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.11-2" class="pilcrow">¶</a></p>
<p id="section-11.11-3">The columns of this registry are:<a href="#section-11.11-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.11-4">
          <dt id="section-11.11-4.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.11-4.2"> The name of the sequence number synchronization method.<a href="#section-11.11-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.11-4.3">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.11-4.4"> The value to be used to identify this sequence number synchronization method. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer, a negative integer, or a text string. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 as well as text strings of length 1 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 as well as text strings of length 2 are designated as "Specification Required". Integer values greater than 65535 as well as text strings of length greater than 2 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.11-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.11-4.5">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.11-4.6"> This field contains a brief description for this sequence number synchronization method.<a href="#section-11.11-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.11-4.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.11-4.8"> This field contains a pointer to the public specification describing the sequence number synchronization method.<a href="#section-11.11-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-ace-groupcomm-errors">
<section id="section-11.12">
        <h3 id="name-ace-groupcomm-errors">
<a href="#section-11.12" class="section-number selfRef">11.12. </a><a href="#name-ace-groupcomm-errors" class="section-name selfRef">ACE Groupcomm Errors</a>
        </h3>
<p id="section-11.12-1">This specification establishes the "ACE Groupcomm Errors" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.12-1" class="pilcrow">¶</a></p>
<p id="section-11.12-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.12-2" class="pilcrow">¶</a></p>
<p id="section-11.12-3">The columns of this registry are:<a href="#section-11.12-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.12-4">
          <dt id="section-11.12-4.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.12-4.2"> The value to be used to identify the error. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer or a negative integer. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 are designated as "Specification Required". Integer values greater than 65535 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.12-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.12-4.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.12-4.4"> This field contains a brief description of the error.<a href="#section-11.12-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.12-4.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.12-4.6"> This field contains a pointer to the public specification defining the error, if one exists.<a href="#section-11.12-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.12-5">This registry has been initially populated with the values in <a href="#fig-ACE-Groupcomm-Error-Identifiers" class="auto internal xref">Table 6</a>. The "Reference" column for all of these entries refers to this document.<a href="#section-11.12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-ace-groupcomm-rekeying-schemes">
<section id="section-11.13">
        <h3 id="name-ace-groupcomm-rekeying-schem">
<a href="#section-11.13" class="section-number selfRef">11.13. </a><a href="#name-ace-groupcomm-rekeying-schem" class="section-name selfRef">ACE Groupcomm Rekeying Schemes</a>
        </h3>
<p id="section-11.13-1">This specification establishes the "ACE Groupcomm Rekeying Schemes" IANA registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-11.13-1" class="pilcrow">¶</a></p>
<p id="section-11.13-2">Values in this registry are covered by different registration policies as indicated below. Some policies require Expert Review; guidelines are provided in <a href="#review" class="auto internal xref">Section 11.14</a>.<a href="#section-11.13-2" class="pilcrow">¶</a></p>
<p id="section-11.13-3">The columns of this registry are:<a href="#section-11.13-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.13-4">
          <dt id="section-11.13-4.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.13-4.2"> The value to be used to identify the group rekeying scheme. These values <span class="bcp14">MUST</span> be unique. The value can be a positive integer or a negative integer. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as "Standards Action With Expert Review". Integer values from -65536 to -257 and from 256 to 65535 are designated as "Specification Required". Integer values greater than 65535 are designated as "Expert Review". Integer values less than -65536 are marked as "Private Use".<a href="#section-11.13-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.13-4.3">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-11.13-4.4"> The name of the group rekeying scheme.<a href="#section-11.13-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.13-4.5">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.13-4.6"> This field contains a brief description of the group rekeying scheme.<a href="#section-11.13-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.13-4.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.13-4.8"> This field contains a pointer to the public specification defining the group rekeying scheme, if one exists.<a href="#section-11.13-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.13-5">This registry has been initially populated with the value in <a href="#rekeying-scheme-0" class="auto internal xref">Table 4</a>.<a href="#section-11.13-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="review">
<section id="section-11.14">
        <h3 id="name-expert-review-instructions">
<a href="#section-11.14" class="section-number selfRef">11.14. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-11.14-1">The IANA registries established in this document are defined as Expert Review.
This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-11.14-1" class="pilcrow">¶</a></p>
<p id="section-11.14-2">Expert Reviewers should take into consideration the following points:<a href="#section-11.14-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.14-3.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as "Private Use" are intended for testing purposes and closed environments; code points in other ranges should not be assigned for testing.<a href="#section-11.14-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.14-3.2">Specifications are required for the Standards Track range of point assignment. Specifications should exist for Specification Required ranges, but early assignment before a specification is available is considered to be permissible. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-11.14-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.14-3.3">Experts should take into account the expected usage of fields when approving point assignments. The fact that there is a range for Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range. The length of the encoded value should be weighed against how many code points of that length are left, the size of the device it will be used on, and the number of code points left that encode to that size.<a href="#section-11.14-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CBOR.Tags">[CBOR.Tags]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cbor-tags/">https://www.iana.org/assignments/cbor-tags/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CoAP.Content.Formats">[CoAP.Content.Formats]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CoAP Content-Formats"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters/">https://www.iana.org/assignments/core-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/">https://www.iana.org/assignments/cose/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/">https://www.iana.org/assignments/cose/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/">https://www.iana.org/assignments/cose/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7967">https://www.rfc-editor.org/info/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9052">https://www.rfc-editor.org/info/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9200">https://www.rfc-editor.org/info/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9237">[RFC9237]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"An Authorization Information Format (AIF) for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9237</span>, <span class="seriesInfo">DOI 10.17487/RFC9237</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9237">https://www.rfc-editor.org/info/rfc9237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9290">[RFC9290]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Problem Details for Constrained Application Protocol (CoAP) APIs"</span>, <span class="seriesInfo">RFC 9290</span>, <span class="seriesInfo">DOI 10.17487/RFC9290</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9290">https://www.rfc-editor.org/info/rfc9290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9338">[RFC9338]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Countersignatures"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9338</span>, <span class="seriesInfo">DOI 10.17487/RFC9338</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9338">https://www.rfc-editor.org/info/rfc9338</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cose-cbor-encoded-cert">[C509-CERT]</dt>
        <dd>
<span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-11</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[CoAP-PUBSUB]</dt>
        <dd>
<span class="refAuthor">Jimenez, J.</span>, <span class="refAuthor">Koster, M.</span>, and <span class="refAuthor">A. Keränen</span>, <span class="refTitle">"A publish-subscribe architecture for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-14</span>, <time datetime="2024-04-18" class="refDate">18 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-14">https://datatracker.ietf.org/doc/html/draft-ietf-core-coap-pubsub-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[GROUP-CoAP]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-11</span>, <time datetime="2024-04-24" class="refDate">24 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-11">https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[GROUP-OSCORE]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Group Object Security for Constrained RESTful Environments (Group OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-22</span>, <time datetime="2024-08-28" class="refDate">28 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-22">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[OSCORE-DISCOVERY]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsüss, C.</span>, and <span class="refAuthor">P. Van der Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-16</span>, <time datetime="2024-09-04" class="refDate">4 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16">https://datatracker.ietf.org/doc/html/draft-tiloca-core-oscore-discovery-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2093">[RFC2093]</dt>
        <dd>
<span class="refAuthor">Harney, H.</span> and <span class="refAuthor">C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Specification"</span>, <span class="seriesInfo">RFC 2093</span>, <span class="seriesInfo">DOI 10.17487/RFC2093</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2093">https://www.rfc-editor.org/info/rfc2093</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2094">[RFC2094]</dt>
        <dd>
<span class="refAuthor">Harney, H.</span> and <span class="refAuthor">C. Muckenhirn</span>, <span class="refTitle">"Group Key Management Protocol (GKMP) Architecture"</span>, <span class="seriesInfo">RFC 2094</span>, <span class="seriesInfo">DOI 10.17487/RFC2094</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2094">https://www.rfc-editor.org/info/rfc2094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2627">[RFC2627]</dt>
        <dd>
<span class="refAuthor">Wallner, D.</span>, <span class="refAuthor">Harder, E.</span>, and <span class="refAuthor">R. Agee</span>, <span class="refTitle">"Key Management for Multicast: Issues and Architectures"</span>, <span class="seriesInfo">RFC 2627</span>, <span class="seriesInfo">DOI 10.17487/RFC2627</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2627">https://www.rfc-editor.org/info/rfc2627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9202">[RFC9202]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9202</span>, <span class="seriesInfo">DOI 10.17487/RFC9202</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9202">https://www.rfc-editor.org/info/rfc9202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9203">https://www.rfc-editor.org/info/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9277">https://www.rfc-editor.org/info/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9431">[RFC9431]</dt>
      <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT) and Transport Layer Security (TLS) Profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9431</span>, <span class="seriesInfo">DOI 10.17487/RFC9431</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9431">https://www.rfc-editor.org/info/rfc9431</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="req">
<section id="appendix-A">
      <h2 id="name-requirements-for-applicatio">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-for-applicatio" class="section-name selfRef">Requirements for Application Profiles</a>
      </h2>
<p id="appendix-A-1">This section lists the requirements for application profiles of this specification for the convenience of application profile designers.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="req-mandatory">
<section id="appendix-A.1">
        <h3 id="name-mandatory-to-address-requir">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-mandatory-to-address-requir" class="section-name selfRef">Mandatory-to-Address Requirements</a>
        </h3>
<span class="break"></span><dl class="olPercent" id="appendix-A.1-1">
          <dt>REQ1:</dt>
<dd id="appendix-A.1-1.1">
<div id="req1">Specify the format and encoding of scope. This includes defining the set of possible roles and their identifiers, as well as the corresponding encoding to use in the scope entries according to the used scope format (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>).<a href="#req1" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ2:</dt>
<dd id="appendix-A.1-1.2">
<div id="req2">If scope uses AIF, register its specific instance of "Toid" and "Tperm" as media type parameters and a corresponding Content-Format, as per the guidelines in <span>[<a href="#RFC9237" class="cite xref">RFC9237</a>]</span>.<a href="#req2" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ3:</dt>
<dd id="appendix-A.1-1.3">
<div id="req3">If used, specify the acceptable values for the 'sign_alg' parameter (see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>).<a href="#req3" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ4:</dt>
<dd id="appendix-A.1-1.4">
<div id="req4">If used, specify the acceptable values and structure for the 'sign_parameters' parameter (see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>).<a href="#req4" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ5:</dt>
<dd id="appendix-A.1-1.5">
<div id="req5">If used, specify the acceptable values and structure for the 'sign_key_parameters' parameter (see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>).<a href="#req5" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ6:</dt>
<dd id="appendix-A.1-1.6">
<div id="req6">Specify the acceptable formats for authentication credentials and, if applicable, the acceptable values for the 'cred_fmt' parameter (see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>).<a href="#req6" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ7:</dt>
<dd id="appendix-A.1-1.7">
<div id="req7">If the value of the GROUPNAME URI path and the group name in the access token scope ('gname' in <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>) are not required to coincide, specify the mechanism to map the GROUPNAME value in the URI to the group name (see <a href="#kdc-if" class="auto internal xref">Section 4.1</a>).<a href="#req7" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ8:</dt>
<dd id="appendix-A.1-1.8">
<div id="req8">Define whether the KDC has an authentication credential as required for the correct group operation and if this has to be provided through the 'kdc_cred' parameter (see Sections <a href="#kdc-if" class="auto internal xref">4.1</a> and <a href="#gid-post" class="auto internal xref">4.3.1</a>).<a href="#req8" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ9:</dt>
<dd id="appendix-A.1-1.9">
<div id="req9">Specify if any part of the KDC interface as defined in this document is not supported by the KDC (see <a href="#kdc-if" class="auto internal xref">Section 4.1</a>).<a href="#req9" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ10:</dt>
<dd id="appendix-A.1-1.10">
<div id="req10">Register a Resource Type for the group-membership resources, which is used to discover the correct URL for sending a Join Request to the KDC (see <a href="#kdc-if" class="auto internal xref">Section 4.1</a>).<a href="#req10" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ11:</dt>
<dd id="appendix-A.1-1.11">
<div id="req11">Define what specific actions (e.g., CoAP methods) are allowed on each resource that are accessible through the KDC interface, depending on: whether the Client is a current group member; the roles that a Client is authorized to take as per the obtained access token (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>); and the roles that the Client has as a current group member.<a href="#req11" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ12:</dt>
<dd id="appendix-A.1-1.12">
<div id="req12">Categorize possible newly defined operations for Clients into primary operations expected to be minimally supported and secondary operations, and provide accompanying considerations (see <a href="#client-operations" class="auto internal xref">Section 4.1.1</a>).<a href="#req12" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ13:</dt>
<dd id="appendix-A.1-1.13">
<div id="req13">Specify the encoding of group identifiers (see <a href="#ace-group-fetch" class="auto internal xref">Section 4.2.1</a>).<a href="#req13" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ14:</dt>
<dd id="appendix-A.1-1.14">
<div id="req14">Specify the approaches used to compute and verify the PoP evidence to include in the 'client_cred_verify' parameter and which of those approaches is used in which case (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#req14" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ15:</dt>
<dd id="appendix-A.1-1.15">
<div id="req15">Specify how the nonce N_S is generated, if the access token is not provided to the KDC through the Token Transfer Request sent to the /authz-info endpoint (e.g., the access token is instead transferred during the establishment of a secure communication association).<a href="#req15" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ16:</dt>
<dd id="appendix-A.1-1.16">
<div id="req16">Define the initial value of the version number for the group keying material (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#req16" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ17:</dt>
<dd id="appendix-A.1-1.17">
<div id="req17">Specify the format of the group keying material that is conveyed in the 'key' parameter (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#req17" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ18:</dt>
<dd id="appendix-A.1-1.18">
<div id="req18">Specify the acceptable values of the 'gkty' parameter (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>). For each of them, register a corresponding entry in the "ACE Groupcomm Key Types" IANA registry if such an entry does not exist already.<a href="#req18" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ19:</dt>
<dd id="appendix-A.1-1.19">
<div id="req19">Specify and register the application profile identifier (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#req19" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ20:</dt>
<dd id="appendix-A.1-1.20">
<div id="req20">If used, specify the format and default values of the entries of the CBOR map to include in the 'group_policies' parameter (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#req20" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ21:</dt>
<dd id="appendix-A.1-1.21">
<div id="req21">Specify the approaches used to compute and verify the PoP evidence to include in the 'kdc_cred_verify' parameter and which of those approaches is used in which case (see Sections <a href="#gid-post" class="auto internal xref">4.3.1</a> and <a href="#kdc-pub-key-get" class="auto internal xref">4.5.1</a>). If external signature verifiers are supported, specify how those provide a nonce to the KDC to be used for computing the PoP evidence (see <a href="#kdc-pub-key-get" class="auto internal xref">Section 4.5.1</a>).<a href="#req21" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ22:</dt>
<dd id="appendix-A.1-1.22">
<div id="req22">Specify the communication protocol that members of the group use to communicate with each other (e.g., CoAP for group communication).<a href="#req22" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ23:</dt>
<dd id="appendix-A.1-1.23">
<div id="req23">Specify the security protocol that members of the group use to protect the group communication (e.g., Group OSCORE). This must provide encryption, integrity, and replay protection.<a href="#req23" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ24:</dt>
<dd id="appendix-A.1-1.24">
<div id="req24">Specify how the communication is secured between the Client and the KDC. Optionally, specify a transport profile of ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> to use between the Client and the KDC (see <a href="#ssec-key-distribution-exchange" class="auto internal xref">Section 4.3.1.1</a>).<a href="#req24" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ25:</dt>
<dd id="appendix-A.1-1.25">
<div id="req25">Specify the format of the node identifiers of group members (see Sections <a href="#gid-post" class="auto internal xref">4.3.1</a> and <a href="#pubkey-fetch" class="auto internal xref">4.4.1</a>).<a href="#req25" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ26:</dt>
<dd id="appendix-A.1-1.26">
<div id="req26">Specify policies at the KDC to handle node identifiers that are included in the 'get_creds' parameter but are not associated with any current group member (see <a href="#pubkey-fetch" class="auto internal xref">Section 4.4.1</a>).<a href="#req26" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ27:</dt>
<dd id="appendix-A.1-1.27">
<div id="req27">Specify the format of (newly generated) individual keying material for group members or of the information to derive such keying material, as well as the corresponding CBOR map key that has to be registered in the "ACE Groupcomm Parameters" registry (see Sections <a href="#node-get" class="auto internal xref">4.8.1</a> and <a href="#node-put" class="auto internal xref">4.8.2</a>).<a href="#req27" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ28:</dt>
<dd id="appendix-A.1-1.28">
<div id="req28">Specify which CBOR tag is used for identifying the semantics of binary scopes, or register a new CBOR tag if a suitable one does not exist already (see <a href="#sec-extended-scope" class="auto internal xref">Section 7</a>).<a href="#req28" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ29:</dt>
<dd id="appendix-A.1-1.29">
<div id="req29">Categorize newly defined parameters according to the same criteria of <a href="#params" class="auto internal xref">Section 8</a>.<a href="#req29" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>REQ30:</dt>
<dd id="appendix-A.1-1.30">
<div id="req30">Define whether Clients must, should, or may support the conditional parameters defined in <a href="#params" class="auto internal xref">Section 8</a> and under which circumstances.<a href="#req30" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-optional">
<section id="appendix-A.2">
        <h3 id="name-optional-to-address-require">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-optional-to-address-require" class="section-name selfRef">Optional-to-Address Requirements</a>
        </h3>
<span class="break"></span><dl class="olPercent" id="appendix-A.2-1">
          <dt>OPT1:</dt>
<dd id="appendix-A.2-1.1">
<div id="opt1">Optionally, if the textual format of scope is used, specify CBOR values to use for abbreviating the role identifiers in the group (see <a href="#ssec-authorization-request" class="auto internal xref">Section 3.1</a>).<a href="#opt1" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT2:</dt>
<dd id="appendix-A.2-1.2">
<div id="opt2">Optionally, specify the additional parameters used in the exchange of Token Transfer Request and Response (see <a href="#token-post" class="auto internal xref">Section 3.3</a>).<a href="#opt2" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT3:</dt>
<dd id="appendix-A.2-1.3">
<div id="opt3">Optionally, specify the negotiation of parameter values for signature algorithm and signature keys, if the 'sign_info' parameter is not used (see <a href="#token-post" class="auto internal xref">Section 3.3</a>).<a href="#opt3" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT4:</dt>
<dd id="appendix-A.2-1.4">
<div id="opt4">Optionally, specify possible or required payload formats for specific error cases (see <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>).<a href="#opt4" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT5:</dt>
<dd id="appendix-A.2-1.5">
<div id="opt5">Optionally, specify additional identifiers of error types as values of the 'error-id' field within the Custom Problem Detail entry 'ace-groupcomm-error' (see <a href="#kdc-if-errors" class="auto internal xref">Section 4.1.2</a>).<a href="#opt5" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT6:</dt>
<dd id="appendix-A.2-1.6">
<div id="opt6">Optionally, specify the encoding of the 'creds_repo' parameter if the default one is not used (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#opt6" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT7:</dt>
<dd id="appendix-A.2-1.7">
<div id="opt7">Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_uri' parameter, including the encoding of exchanged messages and other details (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#opt7" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT8:</dt>
<dd id="appendix-A.2-1.8">
<div id="opt8">Optionally, specify the behavior of the POST handler of group-membership resources, for the case when it fails to retrieve an authentication credential for the specific Client (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#opt8" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT9:</dt>
<dd id="appendix-A.2-1.9">
<div id="opt9">Optionally, define a default group rekeying scheme to refer to in case the 'rekeying_scheme' parameter is not included in the Join Response (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#opt9" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT10:</dt>
<dd id="appendix-A.2-1.10">
<div id="opt10">Optionally, specify the functionalities implemented at the resource hosted by the Client at the URI indicated in the 'control_group_uri' parameter, including the encoding of exchanged messages and other details (see <a href="#gid-post" class="auto internal xref">Section 4.3.1</a>).<a href="#opt10" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT11:</dt>
<dd id="appendix-A.2-1.11">
<div id="opt11">Optionally, specify policies that instruct Clients to retain messages and for how long, if those are unsuccessfully decrypted (see <a href="#update-keys" class="auto internal xref">Section 4.8.1.1</a>). This makes it possible for Clients to decrypt such messages after obtaining updated keying material.<a href="#opt11" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT12:</dt>
<dd id="appendix-A.2-1.12">
<div id="opt12">Optionally, specify for the KDC to perform a group rekeying when receiving a Key Renewal Request, together with or instead of renewing individual keying material (see <a href="#new-keys" class="auto internal xref">Section 4.8.2.1</a>).<a href="#opt12" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT13:</dt>
<dd id="appendix-A.2-1.13">
<div id="opt13">Optionally, specify how the identifier of a group member's authentication credential is included in requests sent to other group members (see <a href="#update-pub-key" class="auto internal xref">Section 4.9.1.1</a>).<a href="#opt13" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt>OPT14:</dt>
<dd id="appendix-A.2-1.14">
<div id="opt14">Optionally, specify additional information to include in rekeying messages for the "Point-to-Point" group rekeying scheme (see <a href="#sec-group-rekeying" class="auto internal xref">Section 6</a>).<a href="#opt14" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-future-cose-algs">
<section id="appendix-B">
      <h2 id="name-extensibility-for-future-co">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-extensibility-for-future-co" class="section-name selfRef">Extensibility for Future COSE Algorithms</a>
      </h2>
<p id="appendix-B-1">As defined in <span><a href="https://rfc-editor.org/rfc/rfc9053#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, future algorithms can be registered in the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span> as specifying none or multiple COSE capabilities.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">To enable the seamless use of such future registered algorithms, this section defines a general, agile format for each 'sign_info_entry' of the 'sign_info' parameter in the Token Transfer Response; see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">If any of the currently registered COSE algorithms are considered, using this general format yields the same structure of 'sign_info_entry' defined in this document, thus ensuring backward compatibility.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div id="sec-future-cose-algs-sign-info-entry">
<section id="appendix-B.1">
        <h3 id="name-format-of-sign_info_entry">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-format-of-sign_info_entry" class="section-name selfRef">Format of 'sign_info_entry'</a>
        </h3>
<p id="appendix-B.1-1">The format of each 'sign_info_entry' (see <a href="#sign-info" class="auto internal xref">Section 3.3.1</a>) is generalized as follows.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">
            <p id="appendix-B.1-2.1.1">'sign_parameters' includes N &gt;= 0 elements, each of which is a COSE capability of the signature algorithm indicated in 'sign_alg'.<a href="#appendix-B.1-2.1.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.1.2">
In particular, 'sign_parameters' has the same format and value of the COSE capabilities array for the signature algorithm indicated in 'sign_alg', as specified for that algorithm in the "Capabilities" column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>.<a href="#appendix-B.1-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.2">
            <p id="appendix-B.1-2.2.1">'sign_key_parameters' is replaced by N elements 'sign_capab', each of which is a CBOR array.<a href="#appendix-B.1-2.2.1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.2">
The i-th 'sign_capab' array (i = 0, ..., N-1) is the array of COSE capabilities for the algorithm capability specified in 'sign_parameters'[i].<a href="#appendix-B.1-2.2.2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.3">
In particular, each 'sign_capab' array has the same format and value of the COSE capabilities array for the algorithm capability specified in 'sign_parameters'[i].<a href="#appendix-B.1-2.2.3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2.2.4">
Such a COSE capabilities array is currently defined for the algorithm capability COSE key type in the "Capabilities" column of the "COSE Key Types" registry <span>[<a href="#COSE.Key.Types" class="cite xref">COSE.Key.Types</a>]</span>.<a href="#appendix-B.1-2.2.4" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-sign_info_entry-with-a-gene"></span><div id="fig-sign-info-entry-general">
<figure id="figure-38">
          <div class="lang-cddl sourcecode" id="appendix-B.1-3.1">
<pre>
sign_info_entry =
[
    id : gname / [+ gname],
    sign_alg : int / tstr,
    sign_parameters : [* alg_capab : any],
  * sign_capab : [* capab : any],
    cred_fmt : int / null
]

gname = tstr
</pre>
</div>
<figcaption><a href="#figure-38" class="selfRef">Figure 38</a>:
<a href="#name-sign_info_entry-with-a-gene" class="selfRef">'sign_info_entry' with a General Format</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The following individuals were helpful in shaping this document: <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Martin Duke</span>, <span class="contact-name">Thomas Fossati</span>, <span class="contact-name">Vidhi Goel</span>, <span class="contact-name">Rikard Höglund</span>, <span class="contact-name">Ben Kaduk</span>, <span class="contact-name">Erik Kline</span>, <span class="contact-name">Warren Kumari</span>, <span class="contact-name">Watson Ladd</span>, <span class="contact-name">Daniel Migault</span>, <span class="contact-name">John Preuß Mattsson</span>, <span class="contact-name">Zaheduzzaman Sarker</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Ludwig Seitz</span>, <span class="contact-name">Göran Selander</span>, <span class="contact-name">Cigdem Sengul</span>, <span class="contact-name">Dave Thaler</span>, <span class="contact-name">Henry Thompson</span>, <span class="contact-name">Peter van der Stok</span>, and <span class="contact-name">Paul Wouters</span>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The work on this document has been partly supported by the Sweden's Innovation Agency VINNOVA and the Celtic-Next project CRITISEC, by the H2020 project SIFIS-Home (Grant agreement 952652), and by the EIT-Digital High Impact Initiative ACTIVE.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
