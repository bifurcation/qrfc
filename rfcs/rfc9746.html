<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9746: BGP EVPN Multihoming Extensions for Split-Horizon Filtering</title>
<meta content="Jorge Rabadan" name="author">
<meta content="Kiran Nagaraj" name="author">
<meta content="Wen Lin" name="author">
<meta content="Ali Sajassi" name="author">
<meta content="
       An Ethernet Virtual Private Network (EVPN) is commonly used with
      Network Virtualization Overlay (NVO) tunnels as well as with MPLS and
      Segment Routing (SR) tunnels. The multihoming procedures in EVPN may
      vary based on the type of tunnel used within the EVPN Broadcast
      Domain. Specifically, there are two multihoming split-horizon procedures
      designed to prevent looped frames on multihomed Customer Edge (CE)
      devices: the Ethernet Segment Identifier (ESI) Label-based procedure and
      the local-bias procedure. The ESI Label-based split-horizon procedure is
      applied to MPLS-based tunnels such as MPLS over UDP (MPLSoUDP), while
      the local-bias procedure is used for other tunnels such as Virtual
      eXtensible Local Area Network (VXLAN) tunnels. 
       Current specifications do not allow operators to choose which split-horizon procedure to use for tunnel encapsulations that support both
      methods. Examples of tunnels that may support both procedures include
      MPLSoUDP, MPLS over GRE (MPLSoGRE), Generic Network Virtualization
      Encapsulation (Geneve), and Segment Routing over IPv6 (SRv6)
      tunnels. This document updates the EVPN multihoming procedures described
      in RFCs 7432 and 8365, enabling operators to select the split-horizon
      procedure that meets their specific requirements. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="EVPN Multihoming" name="keyword">
<meta content="split-horizon filtering" name="keyword">
<meta content="split horizon filtering" name="keyword">
<meta content="local bias" name="keyword">
<meta content="ESI" name="keyword">
<meta content="encapsulations" name="keyword">
<meta content="SHT" name="keyword">
<meta content="9746" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 64.1
-->
<link href="rfc9746.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-mh-split-horizon-11" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9746" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9746</td>
<td class="center">EVPN MH Split-Horizon Extensions</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rabadan, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9746" class="eref">9746</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7432" class="eref">7432</a>, <a href="https://www.rfc-editor.org/rfc/rfc8365" class="eref">8365</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03" class="published">March 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Rabadan, <span class="editor">Ed.</span>
</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">K. Nagaraj</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">W. Lin</div>
<div class="org">Juniper</div>
</div>
<div class="author">
      <div class="author-name">A. Sajassi</div>
<div class="org">Cisco</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9746</h1>
<h1 id="title">BGP EVPN Multihoming Extensions for Split-Horizon Filtering</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">An Ethernet Virtual Private Network (EVPN) is commonly used with
      Network Virtualization Overlay (NVO) tunnels as well as with MPLS and
      Segment Routing (SR) tunnels. The multihoming procedures in EVPN may
      vary based on the type of tunnel used within the EVPN Broadcast
      Domain. Specifically, there are two multihoming split-horizon procedures
      designed to prevent looped frames on multihomed Customer Edge (CE)
      devices: the Ethernet Segment Identifier (ESI) Label-based procedure and
      the local-bias procedure. The ESI Label-based split-horizon procedure is
      applied to MPLS-based tunnels such as MPLS over UDP (MPLSoUDP), while
      the local-bias procedure is used for other tunnels such as Virtual
      eXtensible Local Area Network (VXLAN) tunnels.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Current specifications do not allow operators to choose which split-horizon procedure to use for tunnel encapsulations that support both
      methods. Examples of tunnels that may support both procedures include
      MPLSoUDP, MPLS over GRE (MPLSoGRE), Generic Network Virtualization
      Encapsulation (Geneve), and Segment Routing over IPv6 (SRv6)
      tunnels. This document updates the EVPN multihoming procedures described
      in RFCs 7432 and 8365, enabling operators to select the split-horizon
      procedure that meets their specific requirements.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9746">https://www.rfc-editor.org/info/rfc9746</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-split-horizon-filtering-and" class="internal xref">Split-Horizon Filtering and Tunnel Encapsulations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-bgp-evpn-extensions" class="internal xref">BGP EVPN Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-the-split-horizon-type" class="internal xref">The Split-Horizon Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-use-of-the-split-horizon-ty" class="internal xref">Use of the Split-Horizon Type in A-D per ES Routes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-the-esi-label-value-in-a-d-" class="internal xref">The ESI Label Value in A-D per ES Routes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-backwards-compatibility-wit" class="internal xref">Backwards Compatibility with NVEs from RFC 8365</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-procedures-for-nves-support" class="internal xref">Procedures for NVEs Supporting Multiple Encapsulations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Ethernet Virtual Private Networks (EVPNs) are commonly used with the
      following tunnel encapsulations:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">
          <p id="section-1-2.1.1">Network Virtualization Overlay (NVO) tunnels, where the EVPN
          procedures are specified in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>.  MPLSoGRE <span>[<a href="#RFC4023" class="cite xref">RFC4023</a>]</span>, MPLSoUDP <span>[<a href="#RFC7510" class="cite xref">RFC7510</a>]</span>, Geneve <span>[<a href="#RFC8926" class="cite xref">RFC8926</a>]</span>,
          or VXLAN <span>[<a href="#RFC7348" class="cite xref">RFC7348</a>]</span> tunnels are
          considered NVO tunnels.<a href="#section-1-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.2">
          <p id="section-1-2.2.1">MPLS and Segment Routing over MPLS (SR-MPLS) tunnels, where the
          relevant EVPN procedures are specified in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>. SR-MPLS tunneling is specified in <span>[<a href="#RFC8660" class="cite xref">RFC8660</a>]</span>.<a href="#section-1-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.3">
          <p id="section-1-2.3.1">Segment Routing over IPv6 (SRv6) tunnels, where the relevant EVPN
          procedures are specified in <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>. SRv6 is specified in <span>[<a href="#RFC8402" class="cite xref">RFC8402</a>]</span> and <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>.<a href="#section-1-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-3">In this document, the term "split horizon" follows the definition in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>. Split horizon refers to the EVPN
      multihoming procedure that prevents a Provider Edge (PE) from sending a
      frame back to a multihomed Customer Edge (CE) when that CE originated
      the frame in the first place.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">EVPN multihoming procedures may vary depending on the type of tunnel
      utilized within the EVPN Broadcast Domain. Specifically, there are two
      multihoming split-horizon procedures employed to prevent looped frames
      on multihomed CE devices: the ESI Label-based procedure and the local-bias procedure.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The ESI Label-based split-horizon procedure is used for MPLS or
      MPLS over X (MPLSoX) tunnels, such as MPLSoUDP, and its procedures
      are detailed in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>. Conversely, the local-bias
      procedure is used for IP-based tunnels, such as VXLAN tunnels, and it is
      described in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">AC:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">Attachment Circuit<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">A-D per ES route:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">Auto-Discovery per Ethernet Segment
            route (as defined in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>).<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">Arg.FE2:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">Refers to the ESI filtering argument used for split horizon as
     specified in <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>.<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">BD:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">Broadcast Domain. Refers to an emulated Ethernet, such that
     two systems on the same BD will receive each other's BUM
     traffic. In this document, BD also refers to the instantiation of
     a BD on an EVPN PE. An EVPN PE can be attached to one or multiple
     BDs of the same tenant.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.9">BUM:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.10">Broadcast, Unknown Unicast, and Multicast<a href="#section-1.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.11">CE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.12">Customer Edge<a href="#section-1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.13">DF:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.14">Designated Forwarder. As defined in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, an ES may be multihomed
            (attached to more than one PE). An ES may also contain multiple
            BDs of one or more EVIs.  For each such EVI, one of the PEs
            attached to the segment becomes that EVI's DF for that
            segment. Since a BD may belong to only one EVI, we can speak
            unambiguously of the BD's DF for a given segment.<a href="#section-1.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.15">ES:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.16">Ethernet Segment<a href="#section-1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.17">ESI:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.18">Ethernet Segment Identifier<a href="#section-1.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.19">EVI:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.20">EVPN Instance<a href="#section-1.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.21">EVI-RT:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.22">EVI Route Target. Refers to a group of NVEs attached to the same
            EVI that will share the same EVI-RT.<a href="#section-1.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.23">Geneve:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.24">Generic Network Virtualization Encapsulation
            <span>[<a href="#RFC8926" class="cite xref">RFC8926</a>]</span> (see tunnel type 19 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.25">MPLS tunnels and non-MPLS NVO tunnels:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.26">Refers to
            Multiprotocol Label Switching (or the absence of it) Network
            Virtualization Overlay tunnels. NVO tunnels use an IP
            encapsulation for overlay frames, where the source IP address
            identifies the ingress NVE and the destination IP address identifies the
            egress NVE.<a href="#section-1.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.27">MPLSoUDP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.28">Multiprotocol Label Switching over User
            Datagram Protocol <span>[<a href="#RFC7510" class="cite xref">RFC7510</a>]</span> (see
            tunnel type 13 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.29">MPLSoGRE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.30">Multiprotocol Label Switching over Generic
            Network Encapsulation <span>[<a href="#RFC4023" class="cite xref">RFC4023</a>]</span>
            (see tunnel type 11 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.31">MPLSoX:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.32">Refers to MPLS over any IP encapsulation, for
            example, MPLSoUDP or MPLSoGRE.<a href="#section-1.1-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.33">NVE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.34">Network Virtualization Edge<a href="#section-1.1-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.35">NVGRE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.36">Network Virtualization Using Generic Routing
            Encapsulation <span>[<a href="#RFC7637" class="cite xref">RFC7637</a>]</span> (see
            tunnel type 9 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.37">PE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.38">Provider Edge<a href="#section-1.1-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.39">RTs:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.40">Route Targets<a href="#section-1.1-2.40" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.41">VXLAN:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.42">Virtual eXtensible Local Area Network <span>[<a href="#RFC7348" class="cite xref">RFC7348</a>]</span> (see tunnel type 8 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.42" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.43">VXLAN-GPE:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.44">VXLAN Generic Protocol Extension <span>[<a href="#I-D.ietf-nvo3-vxlan-gpe" class="cite xref">VXLAN-GPE</a>]</span> (see tunnel
            type 12 in <span>[<a href="#TUNNEL-ENCAP" class="cite xref">TUNNEL-ENCAP</a>]</span>).<a href="#section-1.1-2.44" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.45">SHT:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.46">Split-Horizon Type. Refers to the split-horizon method
            that a PE intends to use and advertises in an A-D per ES
            route.<a href="#section-1.1-2.46" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.47">SRv6:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.48">Segment Routing over IPv6 (see <span>[<a href="#RFC8402" class="cite xref">RFC8402</a>]</span> and <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>).<a href="#section-1.1-2.48" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.49">TLV:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.50">Type-Length-Value<a href="#section-1.1-2.50" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-3">This document also assumes familiarity with the terminology of
        <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-1.2">
        <h3 id="name-split-horizon-filtering-and">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-split-horizon-filtering-and" class="section-name selfRef">Split-Horizon Filtering and Tunnel Encapsulations</a>
        </h3>
<p id="section-1.2-1">EVPN supports two split-horizon filtering mechanisms:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-2">
          <li id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">ESI Label-based split-horizon filtering <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>:<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-1.2-2.1.2">When EVPN is employed for MPLS transport tunnels, an MPLS label
    facilitates split-horizon filtering to support All-Active
    multihoming. The ingress NVE device appends a label corresponding to the source ESI
       (the ESI label) during packet encapsulation.  The egress NVE verifies
       the ESI label when attempting to forward a multi-destination frame
       through a local ES interface. If the ESI label matches the site
       identifier (the ESI) associated with that ES interface, then the packet is not forwarded. This mechanism effectively prevents forwarding loops for BUM traffic.<a href="#section-1.2-2.1.2" class="pilcrow">¶</a></p>
<p id="section-1.2-2.1.3">ESI Label split-horizon filtering should also
            be utilized with Single-Active multihoming to prevent transient
            loops for in-flight packets when the egress NVE assumes the role
            of DF for an ES.<a href="#section-1.2-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">Local-bias filtering <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>:<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-1.2-2.2.2">Since IP tunnels such as VXLAN or NVGRE do not
            support the ESI label or any MPLS label, an alternative split-horizon filtering procedure must be implemented for All-Active
            multihoming. This mechanism, known as local bias, relies on the
            source IP address of the tunnel to determine whether to forward
            BUM traffic to a local ES interface at the
            egress NVE.<a href="#section-1.2-2.2.2" class="pilcrow">¶</a></p>
<p id="section-1.2-2.2.3">In summary and as specified in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>, each NVE tracks the IP address(es) of other
            NVEs with which it shares multihomed ESs. Upon receiving a BUM
            frame encapsulated in an IP tunnel, the egress NVE inspects the
            source IP address in the tunnel header, which identifies the
            ingress NVE. The egress NVE then filters out the frame on all
            local interfaces connected to ESs that are shared with the ingress
            NVE.<a href="#section-1.2-2.2.3" class="pilcrow">¶</a></p>
<p id="section-1.2-2.2.4">Due to this behavior at the egress NVE, the ingress NVE is
            required to perform local replication to all directly attached
            ESs, regardless of the DF election state, for all BUM traffic
            ingressing from the access ACs. This local replication at the
            ingress NVE is the basis for the term "local bias".<a href="#section-1.2-2.2.4" class="pilcrow">¶</a></p>
<p id="section-1.2-2.2.5">Local bias is not suitable for Single-Active multihoming, as
            the ingress NVE deactivates the ACs for which it is not the
            DF. Consequently, local replication to non-DF ACs cannot occur,
            leading to transient in-flight BUM packets being looped back to
            the originating site by newly elected DF egress NVEs.<a href="#section-1.2-2.2.5" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.2-3"><span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> specifies that local bias
        is exclusively utilized for IP tunnels, while ESI Label-based split horizon is employed for IP-based MPLS tunnels. However, IP-based MPLS
        tunnels such as MPLSoGRE or MPLSoUDP are also categorized as IP
        tunnels and have the potential to support both procedures. These
        tunnels are capable of carrying ESI labels and also utilize a tunnel
        IP header in which the source IP address identifies the ingress
        NVE.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">Similarly, certain IP tunnels (those that include an identifier for
        the source ES in the tunnel header) may also potentially support either
        procedure. Examples of such tunnels include Geneve and SRv6:<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-5.1">
            <p id="section-1.2-5.1.1">In a Geneve tunnel, the source IP address identifies the
            ingress NVE; therefore, local bias is possible. Also, Section 4.1
            of <span>[<a href="#I-D.ietf-bess-evpn-geneve" class="cite xref">EVPN-GENEVE</a>]</span>
            defines an Ethernet option Type-Length-Value (TLV) to encode an
            ESI label value.<a href="#section-1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-5.2">
            <p id="section-1.2-5.2.1">In an SRv6 tunnel, the source IP address identifies the ingress
            NVE. By default, and as outlined in <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>, the ingress PE adds specific information to
            the SRv6 packet to enable the egress PE to identify the source ES
            of the BUM packet. This information is the ESI filtering argument
            (Arg.FE2) (see <span><a href="https://rfc-editor.org/rfc/rfc9252#section-6.1.1" class="relref">Section 6.1.1</a> of [<a href="#RFC9252" class="cite xref">RFC9252</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.12" class="relref">Section 4.12</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>) of the service Segment Identifier (SID) received
            on an A-D per ES route from the egress PE.<a href="#section-1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-6"><a href="#Tunnel" class="auto internal xref">Table 1</a> presents various tunnel
        encapsulations along with their supported and default split-horizon
        methods. For Geneve, the default SHT is contingent upon the
        negotiation of the Ethernet Option with the Source ID TLV. In the case
        of SRv6, the default SHT is specified as ESI Label filtering in the
        table, as its behavior is analogous to that of ESI Label filtering. In
        this document, "ESI Label filtering" refers to the split-horizon
        filtering based on the presence of a source ES
        identifier in the tunnel header.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">This document classifies the tunnel encapsulations used by EVPN
        into:<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-8">
<li id="section-1.2-8.1">
            <p id="section-1.2-8.1.1">IP-based MPLS tunnels<a href="#section-1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-8.2">
            <p id="section-1.2-8.2.1">MPLS and SR-MPLS tunnels<a href="#section-1.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-8.3">
            <p id="section-1.2-8.3.1">IP tunnels<a href="#section-1.2-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-8.4">
            <p id="section-1.2-8.4.1">SRv6 tunnels<a href="#section-1.2-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-1.2-9"><a href="#Tunnel" class="auto internal xref">Table 1</a> lists the encapsulations
        supported by this document. Any tunnel encapsulation not listed in
        <a href="#Tunnel" class="auto internal xref">Table 1</a> is out of scope. Tunnel
        encapsulations used by EVPN can be categorized into one of the four
        encapsulation groups mentioned above and support split-horizon
        filtering based on the following rules:<a href="#section-1.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-10.1">
            <p id="section-1.2-10.1.1">IP-based MPLS tunnels and SRv6 tunnels are capable of
            supporting both split-horizon filtering methods.<a href="#section-1.2-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-10.2">
            <p id="section-1.2-10.2.1">MPLS and SR-MPLS tunnels only support ESI Label-based split-horizon filtering.<a href="#section-1.2-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-10.3">
            <p id="section-1.2-10.3.1">IP tunnels support local-bias split-horizon filtering and may
            also support ESI Label-based split-horizon filtering, provided
            they incorporate a mechanism to identify the source ESI in the
            header.<a href="#section-1.2-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-tunnel-encapsulations-and-s"></span><div id="Tunnel">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-tunnel-encapsulations-and-s" class="selfRef">Tunnel Encapsulations and Split-Horizon Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tunnel Encapsulation</th>
              <th class="text-left" rowspan="1" colspan="1">Default Split-Horizon Type (SHT)</th>
              <th class="text-left" rowspan="1" colspan="1">Supports Local Bias</th>
              <th class="text-left" rowspan="1" colspan="1">Supports ESI Label</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">MPLSoGRE (IP-based MPLS)</td>
              <td class="text-left" rowspan="1" colspan="1">ESI Label filtering</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">MPLSoUDP (IP-based MPLS)</td>
              <td class="text-left" rowspan="1" colspan="1">ESI Label filtering</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">MPLS and SR-MPLS</td>
              <td class="text-left" rowspan="1" colspan="1">ESI Label filtering</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">VXLAN (IP tunnels)</td>
              <td class="text-left" rowspan="1" colspan="1">Local Bias</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NVGRE (IP tunnels)</td>
              <td class="text-left" rowspan="1" colspan="1">Local Bias</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">VXLAN-GPE (IP tunnels)</td>
              <td class="text-left" rowspan="1" colspan="1">Local Bias</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Geneve (IP tunnels)</td>
              <td class="text-left" rowspan="1" colspan="1">Local Bias (if no ESI Lb), ESI Label (if ESI lb)</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SRv6</td>
              <td class="text-left" rowspan="1" colspan="1">ESI Label filtering</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-1.2-12">The ESI Label method is applicable for both All-Active and
        Single-Active configurations, whereas the local-bias method is
        suitable only for All-Active configurations. Moreover, the ESI Label
        method is effective across different network domains, while local bias
        is constrained to networks where there is no change in the next hop
        between the NVEs attached to the same ES. Nonetheless, some operators
        favor the local-bias method due to its simplification of the
        encapsulation process, reduced resource consumption on NVEs, and the
        fact that the ingress NVE always forwards traffic locally to other
        interfaces, thereby decreasing the delay in reaching multihomed
        hosts.<a href="#section-1.2-12" class="pilcrow">¶</a></p>
<p id="section-1.2-13">This document extends the EVPN multihoming procedures to allow
        operators to select the preferred split-horizon method for a given NVO
        tunnel according to their specific requirements. The choice between
        local bias and ESI Label split horizon is now allowed (by
        configuration) for tunnel encapsulations that support both methods,
        and this selection is advertised along with the EVPN A-D per ES route.
        IP tunnels that do not support both methods, such as VXLAN or NVGRE,
        will continue to adhere to the procedures specified in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>. Note that this document does not
        modify the local bias or the ESI Label split-horizon procedures
        themselves, just focuses on the signaling and selection of the split-horizon method to apply by the multihomed NVEs.<a href="#section-1.2-13" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-bgp-evpn-extensions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-bgp-evpn-extensions" class="section-name selfRef">BGP EVPN Extensions</a>
      </h2>
<p id="section-2-1">Extensions to EVPN are required to enable NVEs to advertise their
      preferred split-horizon method for a given ES. <a href="#esi-label-extended-community" class="auto internal xref">Figure 1</a> illustrates the
      ESI Label extended community (<span><a href="https://rfc-editor.org/rfc/rfc7432#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>), which is consistently advertised alongside the EVPN
      A-D per ES route. All NVEs connected to an ES advertise an A-D per ES
      route for that ES, including the extended community, which communicates
      information regarding the multihoming mode (either All-Active or
      Single-Active) and, if necessary, specifies the ESI Label to be
      utilized.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span id="name-esi-label-extended-communit"></span><div id="esi-label-extended-community">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-2.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Type=0x06     | Sub-Type=0x01 | Flags(1 octet)|  Reserved=0   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Reserved=0   |          ESI Label                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-esi-label-extended-communit" class="selfRef">ESI Label Extended Community</a>
        </figcaption></figure>
</div>
<p id="section-2-3"><span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> defines the low-order bit
      of the Flags octet (bit 0) as the "Single-Active" bit:<a href="#section-2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-4.1">
          <p id="section-2-4.1.1">A value of 0 means that the multihomed ES is operating in
          All-Active multihoming redundancy mode.<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-4.2">
          <p id="section-2-4.2.1">A value of 1 means that the multihomed ES is operating in
          Single-Active multihoming redundancy mode.<a href="#section-2-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-5"><a href="#sect-5" class="auto internal xref">Section 5</a> establishes a registry for the Flags
      octet, designating the "Single-Active" bit as the low-order bit of the
      newly defined Multihoming Redundancy Mode field.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="sect-2.1">
<section id="section-2.1">
        <h3 id="name-the-split-horizon-type">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-the-split-horizon-type" class="section-name selfRef">The Split-Horizon Type</a>
        </h3>
<p id="section-2.1-1"><span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> does not include any
        explicit indication regarding the split-horizon method in the A-D per
        ES route. In this document, the split-horizon procedure defined in
        <span><a href="https://rfc-editor.org/rfc/rfc8365#section-8.3.1" class="relref">Section 8.3.1</a> of [<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> is
        considered the default behavior, presuming that local bias is employed
        exclusively for IP tunnels, while ESI Label-based split horizon is
        used for IP-based MPLS tunnels. This document specifies that the two
        high-order bits in the Flags octet (bits 6 and 7) constitute the "Split-Horizon Type" or "SHT"
        field, where:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-2">
<pre>

 7 6 5 4 3 2 1 0
+-+-+-+-+-+-+-+-+
|SHT|       |RED|
+-+-+-+-+-+-+-+-+
RED = "Multihoming Redundancy Mode" field (see Table 2)

SHT bit 7 6
-----------
        0 0  --&gt; Default SHT
                 Backwards compatible with [RFC8365] and [RFC7432]
        0 1  --&gt; Local Bias
        1 0  --&gt; ESI Label-based filtering
        1 1  --&gt; Unassigned
</pre><a href="#section-2.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">SHT = 00 is backwards compatible with <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>
            and <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, and indicates that the advertising
            NVE intends to use the default or built-in SHT. The default SHT is
            shown in <a href="#Tunnel" class="auto internal xref">Table 1</a> for each encapsulation. An egress
            NVE that follows the <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> behavior and does
            not support this specification will ignore the SHT bits (which is
            equivalent to processing them as a value of 00).<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">SHT = 01 indicates that the advertising NVE intends to use
            local-bias procedures in the ES for which the AD per-ES route is
            advertised.<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.3">
            <p id="section-2.1-3.3.1">SHT = 10 indicates that the advertising NVE intends to use the
            ESI Label-based split-horizon method procedures in the ES for
            which the AD per-ES route is advertised.<a href="#section-2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.4">
            <p id="section-2.1-3.4.1">SHT = 11 is Unassigned.<a href="#section-2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-2.2">
<section id="section-2.2">
        <h3 id="name-use-of-the-split-horizon-ty">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-use-of-the-split-horizon-ty" class="section-name selfRef">Use of the Split-Horizon Type in A-D per ES Routes</a>
        </h3>
<p id="section-2.2-1">The following behavior is observed:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1">An SHT value of 01 or 10 <span class="bcp14">MUST NOT</span> be used with
            encapsulations that support only one SHT in <a href="#Tunnel" class="auto internal xref">Table 1</a>, and <span class="bcp14">MAY</span> be used by
            encapsulations that support the two SHTs in <a href="#Tunnel" class="auto internal xref">Table 1</a>.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1">An SHT value different than 00 expresses the intent to use a
            specific split-horizon method, but does not reflect the actual
            operational SHT used by the advertising NVE, unless all the NVEs
            attached to the ES advertise the same SHT.<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.3">
            <p id="section-2.2-2.3.1">In case of an inconsistency in the SHT value advertised by the
            NVEs attached to the same ES for a given EVI, all the NVEs <span class="bcp14">MUST</span>
            revert to the behavior in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> and use the
            default SHT in <a href="#Tunnel" class="auto internal xref">Table 1</a>, irrespective of the
            advertised SHT.<a href="#section-2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.4">
            <p id="section-2.2-2.4.1">An SHT different than 00 <span class="bcp14">MUST NOT</span> be set if the "Single-Active"
            bit is set. A received A-D per ES route where the "Single-Active" and
            SHT bits are different than zero <span class="bcp14">MUST</span> follow the treat-as-withdraw
            behavior in <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.5">
            <p id="section-2.2-2.5.1">The SHT <span class="bcp14">MUST</span> have the same value in each Ethernet A-D per ES
            route that an NVE advertises for a given ES and a given
            encapsulation (see <a href="#sect-3" class="auto internal xref">Section 3</a> for NVEs supporting
            multiple encapsulations).<a href="#section-2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-3">As an example, egress NVEs that support IP-based MPLS tunnels, such
        as MPLSoGRE or MPLSoUDP, will advertise A-D per ES routes for the ES
        along with the BGP Encapsulation Extended Community, as defined in
        <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>. This extended community indicates the
        encapsulation type (MPLSoGRE or MPLSoUDP) and may use the SHT value of
        01 or 10 to signify the intent to use local bias or the ESI Label,
        respectively.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">An egress NVE <span class="bcp14">MUST NOT</span> use an SHT value other than 00 when
        advertising an A-D per ES route with the following tunnel encapsulation types from <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>: 
        VXLAN (type 8), NVGRE (type 9), MPLS (type 10),
        or no BGP Tunnel Encapsulation Extended Community at all. In all these
        cases, it is presumed that there is no choice for the split-horizon
        method; therefore, the SHT value <span class="bcp14">MUST</span> be set to 00. If a route with
        any of the mentioned encapsulation options is received and has an SHT
        value different than 00, it <span class="bcp14">SHOULD</span> apply the treat-as-withdraw
        behavior, per <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">An egress NVE advertising A-D per ES route(s) for an ES with Geneve
        encapsulation (tunnel encapsulation type 19 in  the BGP Tunnel Encapsulation attribute <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>) <span class="bcp14">MAY</span> use an SHT value of 01 or 10. A
        value of 01 indicates the intent to use local bias, regardless of the
        presence of an Ethernet option TLV with a non-zero Source-ID, as
        described in <span>[<a href="#I-D.ietf-bess-evpn-geneve" class="cite xref">EVPN-GENEVE</a>]</span>.  A value of 10 indicates the intent to use ESI
        Label-based split horizon, and it is only valid if an Ethernet option
        TLV with a non-zero Source-ID is present. A value of 00 indicates the
        default behavior outlined in <a href="#Tunnel" class="auto internal xref">Table 1</a>,
        which is to use local bias if:<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-2.2-6">
   <li id="section-2.2-6.1">no ESI Label is present in the Ethernet option TLV, or<a href="#section-2.2-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-6.2">there is no Ethernet option TLV.<a href="#section-2.2-6.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.2-7">Otherwise, the ESI Label split-horizon method is applied.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">These procedures assume a single encapsulation supported in the
        egress NVE. <a href="#sect-3" class="auto internal xref">Section 3</a> describes additional procedures
        for NVEs supporting multiple encapsulations.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2.3">
<section id="section-2.3">
        <h3 id="name-the-esi-label-value-in-a-d-">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-the-esi-label-value-in-a-d-" class="section-name selfRef">The ESI Label Value in A-D per ES Routes</a>
        </h3>
<p id="section-2.3-1">This document also updates <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> regarding the
        value that is advertised in the ESI Label field of the ESI Label
        extended community, as follows:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1">The A-D per ES route(s) for an ES <span class="bcp14">MAY</span> have an ESI Label value
            of zero if the SHT value is 01. <a href="#sect-2.2" class="auto internal xref">Section 2.2</a>
            specifies the scenarios where the SHT can be 01. An ESI Label
            value of zero eliminates the need to allocate labels in cases
            where they are not utilized, such as in the local-bias method.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1">The A-D per ES route(s) for an ES <span class="bcp14">MAY</span> have an ESI Label value
            of zero for VXLAN or NVGRE encapsulations.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-2.4">
<section id="section-2.4">
        <h3 id="name-backwards-compatibility-wit">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-backwards-compatibility-wit" class="section-name selfRef">Backwards Compatibility with NVEs from RFC 8365</a>
        </h3>
<p id="section-2.4-1">As discussed in <a href="#sect-2.2" class="auto internal xref">Section 2.2</a>, this
        specification is backwards compatible with the split-horizon filtering
        behavior in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> and a
        non-upgraded NVE can be attached to the same ES as other NVEs
        supporting this specification.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">An NVE maintains an administrative SHT value for an ES, which is
        advertised alongside the A-D per ES route, and an operational SHT
        value, which is the one actually used regardless of what the NVE has
        advertised. The administrative SHT matches the operational SHT if all
        the NVEs attached to the ES have the same administrative SHT.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">This document assumes that an implementation of <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> or <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span> that does not support
        the specifications in this document will ignore the values of all the
        Flags in the ESI Label extended community, except for the
        "Single-Active" bit. Based on this assumption, a non-upgraded NVE will
        disregard any SHT value other than 00. If an upgraded NVE receives at
        least one A-D per ES route for the ES with an SHT value of 00, it <span class="bcp14">MUST</span>
        revert its operational SHT to the default split-horizon method, as
        described in <a href="#Tunnel" class="auto internal xref">Table 1</a>, irrespective of its
        administrative SHT.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">For instance, consider an NVE attached to ES N that receives two
        A-D per ES routes for N from different NVEs, NVE1 and NVE2. If the
        route from NVE1 has an SHT value of 00 and the one from NVE2 has an
        SHT value of 01, the NVE <span class="bcp14">MUST</span> use the default split-horizon method
        specified in <a href="#Tunnel" class="auto internal xref">Table 1</a> as its operational SHT,
        regardless of its administrative SHT.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">All NVEs attached to an ES with an operational SHT value of 10 <span class="bcp14">MUST</span>
        advertise a valid, non-zero ESI Label. If the operational SHT value is
        01, the ESI Label <span class="bcp14">MAY</span> be zero. If the operational SHT value is 00, the
        ESI Label may be zero only if the default encapsulation supports local
        bias exclusively, and the NVEs do not require the presence of a valid,
        non-zero ESI Label.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">If an NVE changes its operational SHT value from 01 (Local Bias) to
        00 (Default SHT) due to the presence of a new non-upgraded NVE in the
        ES, and it previously advertised a zero ESI Label, it <span class="bcp14">MUST</span> send an
        update with a valid, non-zero ESI Label, unless all the non-upgraded
        NVEs in the ES support only local bias. For example, consider NVE1 and
        NVE2 using MPLSoUDP as encapsulation, attached to the same Ethernet
        Segment ES1, and advertising an SHT value of 01 (Local Bias) with a
        zero ESI Label value. Suppose NVE3, which does not support this
        specification, joins ES1 and advertises an SHT value of 00 (default).
        Upon receiving NVE3's A-D per ES route, NVE1 and NVE2 <span class="bcp14">MUST</span> update
        their A-D per ES routes for ES1 to include a valid, non-zero ESI Label
        value. The assumption here is that NVE3 only supports the default ESI
        Label-based split-horizon filtering.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-procedures-for-nves-support">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-procedures-for-nves-support" class="section-name selfRef">Procedures for NVEs Supporting Multiple Encapsulations</a>
      </h2>
<p id="section-3-1">As specified in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>, an NVE
      that supports multiple data plane encapsulations (e.g., VXLAN, NVGRE,
      MPLS, MPLSoUDP, Geneve) must indicate all supported encapsulations using
      BGP Encapsulation extended communities as defined in <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span> for all EVPN routes. This section
      provides clarification on the multihoming split-horizon behavior for
      NVEs that advertise and receive multiple BGP Encapsulation extended
      communities along with the A-D per ES routes. This section uses the
      notation {x, y} (more than two encapsulations is possible too) to denote
      the encapsulations advertised in BGP Encapsulation extended communities
      (or the BGP Tunnel Encapsulation Attribute), where x and y represent
      different encapsulation values. When Geneve is one of the
      encapsulations, the tunnel type is indicated in either a BGP
      Encapsulation extended community or a BGP Tunnel Encapsulation
      Attribute.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">It is important to note that an NVE <span class="bcp14">MAY</span> advertise multiple A-D per ES
      routes for the same ES, rather than a single route, with each route
      conveying a set of Route Targets (RTs). The total set of RTs
      associated with a given ES is referred to as the RT-set for that ES.
      Each of the EVIs represented in the RT-set will have its RT included in
      one, and only one, A-D per ES route for the ES. When multiple A-D per ES
      routes are advertised for the same ES, each route must have a distinct
      Route Distinguisher.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">As per <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>, an NVE that advertises multiple
      encapsulations in the A-D per ES route(s) for an ES <span class="bcp14">MUST</span> advertise
      encapsulations that use the same split-horizon filtering method in the
      same route. For example:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">
          <p id="section-3-4.1.1">An A-D per ES route for ES-x may be advertised with {VXLAN,
          NVGRE} encapsulations.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.2">
          <p id="section-3-4.2.1">An A-D per ES route for ES-y may be advertised with {MPLS,
          MPLSoUDP, MPLSoGRE} encapsulations (or a subset).<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-4.3">
          <p id="section-3-4.3.1">However, an A-D per ES route for ES-z <span class="bcp14">MUST NOT</span> be advertised with
          {MPLS, VXLAN} encapsulations.<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-5">This document extends the described behavior as follows:<a href="#section-3-5" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-3-6">
<li id="section-3-6.1">
          <p id="section-3-6.1.1">An A-D per ES route for ES-x may be advertised with multiple
          encapsulations, some of which support a single split-horizon method.
          In this case, the SHT value <span class="bcp14">MUST</span> be 00. For instance,
          encapsulations such as {VXLAN, NVGRE}, {VXLAN, Geneve}, or {MPLS,
          MPLSoGRE, MPLSoUDP} can be advertised in an A-D per ES route.  In
          all these cases, the SHT value <span class="bcp14">MUST</span> be 00 and the
          treat-as-withdraw behavior <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>
          is applied in case of any other value.<a href="#section-3-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-6.2">
          <p id="section-3-6.2.1">An A-D per ES route for ES-y may be advertised with multiple
          encapsulations that all support both split-horizon methods. In this
          case, the SHT value <span class="bcp14">MAY</span> be 01 if the preferred method is local bias,
          or 10 if the ESI Label-based method is desired. For example,
          encapsulations such as {MPLSoGRE, MPLSoUDP, Geneve} (or a subset)
          <span class="bcp14">MAY</span> be advertised in an A-D per ES route with an SHT value of 01.
          The ESI Label value in this case <span class="bcp14">MAY</span> be zero.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-6.3">
          <p id="section-3-6.3.1">If ES-z with an RT-set composed of (RT1, RT2, RT3.. RTn) supports
          multiple encapsulations requiring different split-horizon methods, a
          distinct A-D per ES route (or group of routes) per split-horizon
          method <span class="bcp14">MUST</span> be advertised. For example, consider an ES-z with n RTs, where:<a href="#section-3-6.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-6.3.2.1">
              <p id="section-3-6.3.2.1.1">the EVIs corresponding to (RT1..RTi) support VXLAN,<a href="#section-3-6.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-6.3.2.2">
              <p id="section-3-6.3.2.2.1">the ones for (RTi+1..RTm) (with i&lt;m) support MPLSoUDP with
              local bias, and<a href="#section-3-6.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-6.3.2.3">
              <p id="section-3-6.3.2.3.1">the ones for (RTm+1..RTn) (with m&lt;n) support Geneve
              with ESI Label-based split horizon.<a href="#section-3-6.3.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3-6.3.3">In this scenario, three groups of A-D per ES routes <span class="bcp14">MUST</span> be
          advertised for ES-z:<a href="#section-3-6.3.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-6.3.4.1">
              <p id="section-3-6.3.4.1.1">A-D per ES route group 1, including (RT1..RTi) with
              encapsulation {VXLAN} and an SHT value of 00. The ESI Label <span class="bcp14">MAY</span>
              be zero.<a href="#section-3-6.3.4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-6.3.4.2">
              <p id="section-3-6.3.4.2.1">A-D per ES route group 2, including (RTi+1..RTm) with
              encapsulation {MPLSoUDP} and an SHT value of 01. The ESI Label
              <span class="bcp14">MAY</span> be zero.<a href="#section-3-6.3.4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-6.3.4.3">
              <p id="section-3-6.3.4.3.1">A-D per ES route group 3, including (RTm+1..RTn) with
              encapsulation {Geneve} and an SHT value of 10. The ESI Label
              <span class="bcp14">MUST</span> have a valid, non-zero value, and the Ethernet option as
              defined in <span>[<a href="#RFC8926" class="cite xref">RFC8926</a>]</span> <span class="bcp14">MUST</span> be advertised.<a href="#section-3-6.3.4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ol>
<p id="section-3-7">As per <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>, it is the responsibility of the
      operator of a given EVI to ensure that all of the NVEs within that EVI
      support a common encapsulation. Failure to meet this condition may
      result in service disruption or failure.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">All the security considerations described in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>
      are applicable to this document.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Additionally, this document modifies the procedures for split-horizon
      filtering as outlined in <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>,
      offering operators a choice between local bias and ESI Label-based
      filtering for tunnels that support both methods. Misconfiguration of the
      desired SHT could lead to forwarding behaviors that differ from the
      intended configuration. Apart from this risk, this document describes
      procedures to ensure that all PE devices or NVEs connected to the same
      ES agree on a common SHT method, with a fallback to a default behavior
      in case of a mismatch in the SHT bits being advertised by any two PEs or
      NVEs in the ES. Consequently, unauthorized changes to the SHT
      configuration by an attacker on a single PE or NVE of the ES should not
      cause traffic disruption (as long as the SHT value is valid as per this
      document) but may result in alterations to forwarding behavior.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">Per this document, IANA has created the "EVPN ESI Label Extended Community Flags" registry for the 1-octet Flags field in the ESI Label Extended
      Community <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, as follows:<a href="#section-5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
        <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Bit Position</th>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0-1</td>
            <td class="text-left" rowspan="1" colspan="1">Multihoming Redundancy Mode</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2-5</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">6-7</td>
            <td class="text-left" rowspan="1" colspan="1">Split-Horizon Type</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9746</td>
          </tr>
        </tbody>
      </table>
<p id="section-5-3">IANA has also created the "Multihoming Redundancy
      Mode" registry for the related field of the "EVPN ESI Label Extended Community Flags". The registry has been populated with the following initial values:<a href="#section-5-3" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Multihoming Redundancy Mode</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">00</td>
            <td class="text-left" rowspan="1" colspan="1">All-Active</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">01</td>
            <td class="text-left" rowspan="1" colspan="1">Single-Active</td>
            <td class="text-left" rowspan="1" colspan="1">
              <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<p id="section-5-5">Finally, IANA has created the "Split-Horizon Type" registry for the related field of the
      "EVPN ESI Label Extended Community Flags". The registry has been populated with the following initial values:<a href="#section-5-5" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
        <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Split-Horizon Type Value</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">00</td>
            <td class="text-left" rowspan="1" colspan="1">Default SHT</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9746</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">01</td>
            <td class="text-left" rowspan="1" colspan="1">Local Bias</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9746</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">ESI Label-based filtering</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9746</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
<p id="section-5-7">New registrations in the "EVPN ESI Label Extended Community Flags",
      "Multihoming Redundancy Mode", and "Split-Horizon Type" registries will
      be made through the "IETF Review" procedure defined in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. These registries are located in the
      "Border Gateway Protocol (BGP) Extended Communities" registry group.<a href="#section-5-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Shekhar, R.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9252">[RFC9252]</dt>
      <dd>
<span class="refAuthor">Dawra, G., Ed.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9252</span>, <span class="seriesInfo">DOI 10.17487/RFC9252</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9252">https://www.rfc-editor.org/info/rfc9252</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-bess-evpn-geneve">[EVPN-GENEVE]</dt>
        <dd>
<span class="refAuthor">Boutros, S.</span>, <span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Rabadan, J.</span>, and <span class="refAuthor">S. Aldrin</span>, <span class="refTitle">"EVPN control plane for Geneve"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-geneve-08</span>, <time datetime="2024-07-05" class="refDate">5 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-geneve-08">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-geneve-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4023">[RFC4023]</dt>
        <dd>
<span class="refAuthor">Worster, T.</span>, <span class="refAuthor">Rekhter, Y.</span>, and <span class="refAuthor">E. Rosen, Ed.</span>, <span class="refTitle">"Encapsulating MPLS in IP or Generic Routing Encapsulation (GRE)"</span>, <span class="seriesInfo">RFC 4023</span>, <span class="seriesInfo">DOI 10.17487/RFC4023</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4023">https://www.rfc-editor.org/info/rfc4023</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7348">[RFC7348]</dt>
        <dd>
<span class="refAuthor">Mahalingam, M.</span>, <span class="refAuthor">Dutt, D.</span>, <span class="refAuthor">Duda, K.</span>, <span class="refAuthor">Agarwal, P.</span>, <span class="refAuthor">Kreeger, L.</span>, <span class="refAuthor">Sridhar, T.</span>, <span class="refAuthor">Bursell, M.</span>, and <span class="refAuthor">C. Wright</span>, <span class="refTitle">"Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks"</span>, <span class="seriesInfo">RFC 7348</span>, <span class="seriesInfo">DOI 10.17487/RFC7348</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7348">https://www.rfc-editor.org/info/rfc7348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7510">[RFC7510]</dt>
        <dd>
<span class="refAuthor">Xu, X.</span>, <span class="refAuthor">Sheth, N.</span>, <span class="refAuthor">Yong, L.</span>, <span class="refAuthor">Callon, R.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Encapsulating MPLS in UDP"</span>, <span class="seriesInfo">RFC 7510</span>, <span class="seriesInfo">DOI 10.17487/RFC7510</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7510">https://www.rfc-editor.org/info/rfc7510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7637">[RFC7637]</dt>
        <dd>
<span class="refAuthor">Garg, P., Ed.</span> and <span class="refAuthor">Y. Wang, Ed.</span>, <span class="refTitle">"NVGRE: Network Virtualization Using Generic Routing Encapsulation"</span>, <span class="seriesInfo">RFC 7637</span>, <span class="seriesInfo">DOI 10.17487/RFC7637</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7637">https://www.rfc-editor.org/info/rfc7637</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8660">[RFC8660]</dt>
        <dd>
<span class="refAuthor">Bashandy, A., Ed.</span>, <span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing with the MPLS Data Plane"</span>, <span class="seriesInfo">RFC 8660</span>, <span class="seriesInfo">DOI 10.17487/RFC8660</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8660">https://www.rfc-editor.org/info/rfc8660</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8926">[RFC8926]</dt>
        <dd>
<span class="refAuthor">Gross, J., Ed.</span>, <span class="refAuthor">Ganga, I., Ed.</span>, and <span class="refAuthor">T. Sridhar, Ed.</span>, <span class="refTitle">"Geneve: Generic Network Virtualization Encapsulation"</span>, <span class="seriesInfo">RFC 8926</span>, <span class="seriesInfo">DOI 10.17487/RFC8926</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8926">https://www.rfc-editor.org/info/rfc8926</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9012">[RFC9012]</dt>
        <dd>
<span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Sangli, S.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"The BGP Tunnel Encapsulation Attribute"</span>, <span class="seriesInfo">RFC 9012</span>, <span class="seriesInfo">DOI 10.17487/RFC9012</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9012">https://www.rfc-editor.org/info/rfc9012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TUNNEL-ENCAP">[TUNNEL-ENCAP]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Border Gateway Protocol (BGP) Tunnel Encapsulation"</span>, <span>&lt;<a href="https://www.iana.org/assignments/bgp-tunnel-encapsulation">https://www.iana.org/assignments/bgp-tunnel-encapsulation</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nvo3-vxlan-gpe">[VXLAN-GPE]</dt>
      <dd>
<span class="refAuthor">Maino, F.</span>, <span class="refAuthor">Kreeger, L.</span>, and <span class="refAuthor">U. Elzur</span>, <span class="refTitle">"Generic Protocol Extension for VXLAN (VXLAN-GPE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nvo3-vxlan-gpe-13</span>, <time datetime="2023-11-04" class="refDate">4 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nvo3-vxlan-gpe-13">https://datatracker.ietf.org/doc/html/draft-ietf-nvo3-vxlan-gpe-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank <span class="contact-name">Anoop Ghanwani</span>,
      <span class="contact-name">Gyan Mishra</span>, and <span class="contact-name">Jeffrey       Zhang</span> for their review and useful comments. Thanks to <span class="contact-name">Gunter Van de Velde</span> and <span class="contact-name">Sue Hares</span> as
      well, for their thorough review.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jorge Rabadan (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="street-address">520 Almanor Avenue</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94085</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jorge.rabadan@nokia.com" class="email">jorge.rabadan@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kiran Nagaraj</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="street-address">520 Almanor Avenue</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94085</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kiran.nagaraj@nokia.com" class="email">kiran.nagaraj@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Wen Lin</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wlin@juniper.net" class="email">wlin@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ali Sajassi</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sajassi@cisco.com" class="email">sajassi@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
