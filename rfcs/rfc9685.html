<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9685: Listener Subscription for IPv6 Neighbor Discovery Multicast and Anycast Addresses</title>
<meta content="Pascal Thubert" name="author">
<meta content="
       
    This document updates the 6LoWPAN extensions to IPv6 Neighbor Discovery
    (specified in RFCs 4861 and 8505) to enable a listener to subscribe to an IPv6 anycast
    or multicast address. This document also updates the Routing Protocol for
    Low-Power and Lossy Networks (RPL) (specified in RFCs 6550 and 6553) to add a new Non-Storing
    multicast mode and new support for anycast addresses in Storing and
    Non-Storing modes.  This document extends RFC 9010 to enable a 6LoWPAN
    Router (6LR) to inject the anycast and multicast addresses in RPL.
       
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="9685" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9685.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-6lo-multicast-registration-19" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9685" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9685</td>
<td class="center">Multicast and Anycast Subscription</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9685" class="eref">9685</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc4861" class="eref">4861</a>, <a href="https://www.rfc-editor.org/rfc/rfc6550" class="eref">6550</a>, <a href="https://www.rfc-editor.org/rfc/rfc6553" class="eref">6553</a>, <a href="https://www.rfc-editor.org/rfc/rfc8505" class="eref">8505</a>, <a href="https://www.rfc-editor.org/rfc/rfc9010" class="eref">9010</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11" class="published">November 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9685</h1>
<h1 id="title">Listener Subscription for IPv6 Neighbor Discovery Multicast and Anycast Addresses</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
    This document updates the 6LoWPAN extensions to IPv6 Neighbor Discovery
    (specified in RFCs 4861 and 8505) to enable a listener to subscribe to an IPv6 anycast
    or multicast address. This document also updates the Routing Protocol for
    Low-Power and Lossy Networks (RPL) (specified in RFCs 6550 and 6553) to add a new Non-Storing
    multicast mode and new support for anycast addresses in Storing and
    Non-Storing modes.  This document extends RFC 9010 to enable a 6LoWPAN
    Router (6LR) to inject the anycast and multicast addresses in RPL.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9685">https://www.rfc-editor.org/info/rfc9685</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-terminology-from-relevant-r" class="internal xref">Terminology from Relevant RFCs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-new-terms" class="internal xref">New Terms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-amending-rfc-4861" class="internal xref">Amending RFC 4861</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-extending-rfc-7400" class="internal xref">Extending RFC 7400</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-amending-rfc-6550" class="internal xref">Amending RFC 6550</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-mandating-the-rovr-field" class="internal xref">Mandating the ROVR Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-updating-mop-3" class="internal xref">Updating MOP 3</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-new-non-storing-multicast-m" class="internal xref">New Non-Storing Multicast MOP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-rpl-anycast-operation" class="internal xref">RPL Anycast Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-new-registered-address-type" class="internal xref">New Registered Address Type Indicator P-Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-new-rpl-target-option-p-fie" class="internal xref">New RPL Target Option P-Field</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-extending-rfc-8505" class="internal xref">Extending RFC 8505</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-placing-the-new-p-field-in-" class="internal xref">Placing the New P-Field in the EARO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-placing-the-new-p-field-in-t" class="internal xref">Placing the New P-Field in the EDAR Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-registration-extensions" class="internal xref">Registration Extensions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-extending-rfc-9010" class="internal xref">Extending RFC 9010</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-leveraging-rfc-8928" class="internal xref">Leveraging RFC 8928</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-consistent-uptime-option" class="internal xref">Consistent Uptime Option</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-backward-compatibility" class="internal xref">Backward Compatibility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-new-p-field-values-registry" class="internal xref">New P-Field Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-new-edar-message-flags-regi" class="internal xref">New EDAR Message Flags Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="auto internal xref">14.3</a>.  <a href="#name-new-address-registration-op" class="internal xref">New Address Registration Option Flags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="auto internal xref">14.4</a>.  <a href="#name-new-rpl-target-option-flags" class="internal xref">New RPL Target Option Flags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="auto internal xref">14.5</a>.  <a href="#name-new-rpl-mode-of-operation" class="internal xref">New RPL Mode of Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="auto internal xref">14.6</a>.  <a href="#name-new-6lowpan-capability-bit" class="internal xref">New 6LoWPAN Capability Bit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="auto internal xref">14.7</a>.  <a href="#name-new-address-registration-opti" class="internal xref">New Address Registration Option Status Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#section-14.8" class="auto internal xref">14.8</a>.  <a href="#name-new-ipv6-neighbor-discovery" class="internal xref">New IPv6 Neighbor Discovery Option Format</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The design of Low-Power and Lossy Networks (LLNs) is generally focused on
  saving energy, which is the most constrained resource of all. Other design
  constraints, such as a limited memory capacity, duty cycling of the LLN
  devices, and low-power lossy transmissions, derive from that primary concern.
  The radio (when both transmitting or simply listening) is a major energy drain,
  and the LLN protocols must be adapted to allow the nodes to remain sleeping
  with the radio turned off at most times.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks" <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> provides IPv6 <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> routing
  services within such constraints. To save signaling and routing state in
  constrained networks, the RPL routing is only performed along a
  Destination-Oriented Directed Acyclic Graph (DODAG) that is optimized to
  reach a Root node, as opposed to along the shortest path between two peers,
  which may be a fuzzy concept anyway in a radio LLN.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This stretches the routes between RPL nodes inside the DODAG for a vastly reduced
  amount of control traffic and routing state that would be required to
  operate an any-to-any shortest path protocol. Additionally, broken routes
  may be fixed lazily and on-demand based on data plane inconsistency
  discovery, which avoids wasting energy in the proactive repair of unused
  paths.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">RPL uses Destination Advertisement Object (DAO) messages to
  establish Downward routes.  DAO messages are an optional feature for
  applications that require point-to-multipoint (P2MP) or point-to- point
  (P2P) traffic.  RPL supports two modes of Downward traffic: Storing (fully
  stateful) or Non-Storing (fully source routed); see <span><a href="https://rfc-editor.org/rfc/rfc6550#section-9" class="relref">Section 9</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>. The mode is signaled in the Mode of
  Operation (MOP) field in the DODAG Information Object (DIO) messages and
  applies to the whole RPL Instance.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Any given RPL Instance is either Storing or Non-Storing.  In both cases,
  P2P packets travel Up toward a DODAG root then Down to the final destination
  (unless the destination is on the Upward route).  In the Non-Storing case,
  the packet will travel all the way to a DODAG root before traveling Down.
  In the Storing case, the packet may be directed Down towards the destination
  by a common ancestor of the source and the destination prior to reaching a
  DODAG root. <span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> details
  the Storing Mode of Operation with multicast support with
  source-independent multicast routing in RPL.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The classical Neighbor Discovery (ND) protocol <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span> was defined for serial links and
  shared transit media such as Ethernet at a time when broadcast on
  those media types was cheap, while memory for neighbor cache was expensive.  It was thus
  designed as a reactive protocol that relies on caching and multicast
  operations for the Address Discovery (aka lookup) and Duplicate Address
  Detection (DAD) of IPv6 unicast addresses.  Those multicast operations
  typically impact every node on-link when at most one is really
  targeted. This is a waste of energy and implies that all nodes are awake to
  hear the request, which is inconsistent with power-saving (sleeping)
  modes.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The original specification for 6LoWPAN ND, "Neighbor Discovery Optimization for IPv6 over
  Low-Power Wireless Personal Area Networks (6LoWPANs)" <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>, was introduced to avoid the excessive use of multicast
  messages and enable IPv6 ND for operations over energy-constrained nodes.
  <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> changes the classical IPv6 ND model to proactively
  establish the Neighbor Cache Entry (NCE) associated to the unicast address
  of a 6LoWPAN Node (6LN) in one or more 6LoWPAN Routers (6LRs) that serve it.  To
  that effect, <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> defines a new Address Registration
  Option (ARO) that is placed in unicast Neighbor Solicitation (NS) and
  Neighbor Advertisement (NA) messages between the 6LN and the 6LR.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area
  Network (6LoWPAN) Neighbor Discovery" <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> updates <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> so that a generic Address Registration mechanism can be
  used to access services such as routing and ND proxy and introduces the
  Extended Address Registration Option (EARO) for that purpose. This provides
  a routing-agnostic interface for a host to request that the router injects a
  unicast IPv6 address in the local routing protocol and provides return
  reachability for that address.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">"Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves" <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> provides the
  router counterpart of the mechanism for a host that implements <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> to inject its unicast Unique Local Addresses (ULAs) and
  Global Unicast Addresses (GUAs) in RPL.  Although RPL also provides
  multicast routing, 6LoWPAN ND supports only the registration of unicast
  addresses, and there is no equivalent of <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> to specify
  the 6LR behavior upon the subscription of one or more multicast addresses.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6" <span>[<a href="#RFC3810" class="cite xref">RFC3810</a>]</span> enables the router to learn which node listens to which
  multicast address, but as the classical IPv6 ND protocol, MLD relies on
  multicasting queries to all nodes, which is unfit for low-power operations.
  As for IPv6 ND, it makes sense to let the 6LNs control when and how they
  maintain the state associated to their multicast addresses in the 6LR, e.g.,
  during their own wake time. In the case of a constrained node that already
  implements <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> for unicast reachability, it makes sense
  to extend that support to subscribe the multicast addresses they listen
  to.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">This specification Extends <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> and <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> by adding the capability for the 6LN to subscribe anycast
  and multicast addresses and for the 6LR to inject them in RPL when
  appropriate. Note that due to the unreliable propagation of packets in the
  LLN, it cannot be guaranteed that any given packet is delivered once and
  only once. If a breakage happens along the preferred parent tree that is
  normally used for multicast forwarding, the packet going Up may be rerouted
  to an alternate parent, leading to potential failures and duplications,
  whereas a packet going Down will not be delivered in the subtree. It is up
  to the Upper Layer Protocols (ULPs) to cope with both situations.<a href="#section-1-11" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">In addition, "Extends" and "Amends" are used as more
 specific terms for "Updates" per Section 3 of <span>[<a href="#I-D.kuehlewind-rswg-updates-tag" class="cite xref">UPDATES-TAG</a>]</span> as
 follows:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-3">
          <dt id="section-2.1-3.1">Amends/Amended by:</dt>
          <dd style="margin-left: 3.5em" id="section-2.1-3.2">This tag pair is used with an amending RFC that changes the amended
   RFC. This could include bug fixes, behavior changes, etc. This is
   intended to specify mandatory changes to the protocol. The goal of this
   tag pair is to signal to anyone looking to implement the amended RFC
   that they <span class="bcp14">MUST</span> also implement the amending RFC.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-3.3">Extends/Extended by:</dt>
          <dd style="margin-left: 3.5em" id="section-2.1-3.4">This tag pair is used with an extending RFC that defines an
   optional addition to the extended RFC. This can be used by documents
   that use existing extension points or clarifications that do not change
   existing protocol behavior. This signals to implementers and protocol
   designers that there are changes to the extended RFC that they need to
   consider but not necessarily implement.<a href="#section-2.1-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lo">
<section id="section-2.2">
        <h3 id="name-terminology-from-relevant-r">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-terminology-from-relevant-r" class="section-name selfRef">Terminology from Relevant RFCs</a>
        </h3>
<p id="section-2.2-1">This document uses terms and concepts that are discussed in:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">"Neighbor Discovery for IP version 6 (IPv6)" <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span>,<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.2">"IPv6 Stateless Address Autoconfiguration" <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>,<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.3">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks" <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>,<a href="#section-2.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.4">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)" <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>,<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.5">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery" <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>, and<a href="#section-2.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.6">"Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane" <span>[<a href="#RFC9008" class="cite xref">RFC9008</a>]</span>.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="abbreviations">
<section id="section-2.3">
        <h3 id="name-abbreviations">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<p id="section-2.3-1">This document uses the following abbreviations:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-2">
          <dt id="section-2.3-2.1">6CIO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.2">Capability Indication Option<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">6LBR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.4">6LoWPAN Border Router<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.5">6LN:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.6">6LoWPAN Node<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.7">6LR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.8">6LoWPAN Router<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.9">ARO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.10">Address Registration Option<a href="#section-2.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.11">DAC:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.12">Duplicate Address Confirmation<a href="#section-2.3-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.13">DAD:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.14">Duplicate Address Detection<a href="#section-2.3-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.15">DAO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.16">Destination Advertisement Object<a href="#section-2.3-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.17">DAR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.18">Duplicate Address Request<a href="#section-2.3-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.19">DIO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.20">DODAG Information Object<a href="#section-2.3-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.21">DMB:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.22">Direct MAC Broadcast<a href="#section-2.3-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.23">DODAG:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.24">Destination-Oriented Directed Acyclic Graph<a href="#section-2.3-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.25">EARO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.26">Extended Address Registration Option<a href="#section-2.3-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.27">EDAC:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.28">Extended Duplicate Address Confirmation<a href="#section-2.3-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.29">EDAR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.30">Extended Duplicate Address Request<a href="#section-2.3-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.31">IR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.32">Ingress Replication<a href="#section-2.3-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.33">LLN:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.34">Low-Power and Lossy Network<a href="#section-2.3-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.35">MLD:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.36">Multicast Listener Discovery<a href="#section-2.3-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.37">MOP:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.38">Mode of Operation<a href="#section-2.3-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.39">NA:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.40">Neighbor Advertisement<a href="#section-2.3-2.40" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.41">NCE:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.42">Neighbor Cache Entry<a href="#section-2.3-2.42" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.43">ND:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.44">Neighbor Discovery<a href="#section-2.3-2.44" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.45">NS:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.46">Neighbor Solicitation<a href="#section-2.3-2.46" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.47">RA:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.48">Router Advertisement<a href="#section-2.3-2.48" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.49">RAN:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.50">RPL-Aware Node<a href="#section-2.3-2.50" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.51">ROVR:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.52">Registration Ownership Verifier (pronounced "rover")<a href="#section-2.3-2.52" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.53">RPL:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.54">Routing Protocol for Low-Power and Lossy Networks (pronounced "ripple")<a href="#section-2.3-2.54" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.55">RS:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.56">Router Solicitation<a href="#section-2.3-2.56" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.57">RTO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.58">RPL Target Option<a href="#section-2.3-2.58" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.59">RUL:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.60">RPL-Unaware Leaf<a href="#section-2.3-2.60" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.61">TID:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.62">Transaction ID<a href="#section-2.3-2.62" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.63">TIO:</dt>
          <dd style="margin-left: 3.5em" id="section-2.3-2.64">Transit Information Option<a href="#section-2.3-2.64" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="terms">
<section id="section-2.4">
        <h3 id="name-new-terms">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-new-terms" class="section-name selfRef">New Terms</a>
        </h3>
<p id="section-2.4-1">This document introduces the following terms:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4-2">
          <dt id="section-2.4-2.1">Origin:</dt>
          <dd style="margin-left: 3.5em" id="section-2.4-2.2">The node that issued an anycast or multicast
      advertisement, in the form of either an NS(EARO) or a DAO(TIO,
      RTO) message.<a href="#section-2.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.3">Merge/merging:</dt>
          <dd style="margin-left: 3.5em" id="section-2.4-2.4">The action of receiving multiple anycast or multicast
      advertisements, either internally from self, in the form of an
      NS(EARO) message, or as a DAO(TIO, RTO) message, and generating a single DAO(TIO,
      RTO).  The RPL router maintains a state per origin for each
      advertised address and merges the advertisements for all
      subscriptions for the same address in a single advertisement.  A RPL
      router that merges multicast advertisements from different origins
      becomes the origin of the merged advertisement and uses its own
      values for the Path Sequence and Registration Ownership Verifier (ROVR) fields.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.5">Subscribe/subscription:</dt>
          <dd style="margin-left: 3.5em" id="section-2.4-2.6">The special form of registration that leverages NS(EARO) to
      register (or subscribe to) a multicast or an anycast address.<a href="#section-2.4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">This specification Extends <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> to provide a registration method (called "subscription" in this case) for anycast and multicast addresses. The specification inherits the proof of ownership defined in <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> that already protects the address registration in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> to also protect the new subscription mechanism. <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> is agnostic to the routing protocol in which the address may be redistributed.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">As opposed to unicast addresses, there might be multiple registrations
   from multiple parties for the same address. The router retains one
   registration per party for each multicast or anycast address but injects the
   route into the routing protocol only once for each address. The injection
   happens asynchronously to the registration. On the other hand, the validation
   exchange with the
   registrar (6LBR) is still needed if the router checks the right for the
   host to listen to the anycast or multicast address.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3"><a href="#figSub" class="auto internal xref">Figure 1</a> depicts the registration of an anycast or a
   multicast address.  As shown, the 6LBR receives and accepts multiple
   EDAR messages for the same address, and the address being
   registered by multiple nodes is not treated as a duplication.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-registration-flow-for-an-an"></span><div id="figSub">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-4.1">
<pre>
    6LoWPAN Node           6LR             6LBR
      (host1)           (router)        (registrar)
         |                  |               |
         |   DMB link       |               |
         |                  |               |
         |  ND-Classic RS   |               |
         |-----------------&gt;|               |
         |------------&gt;     |               |
         |------------------------&gt;         |
         |  ND-Classic RA   |               |
         |&lt;-----------------|               |
         |                  |               |
         |  NS(EARO)        |               |
         |-----------------&gt;|               |
         |                  |     EDAR      |
         |                  |--------------&gt;|
         |                  |               |
         |                  |     EDAC      |
         |                  |&lt;--------------|
         |        NA(EARO)  |
         |&lt;-----------------|&lt;inject route&gt; -&gt;
         |                  |
                   ...
      (host2)           (router)           6LBR
         |  NS(EARO)        |               |
         |-----------------&gt;|               |
         |                  |               |
         |                  |     EDAR      |
         |                  |--------------&gt;|
         |                  |               |
         |                  |     EDAC      |
         |                  |&lt;--------------|
         |        NA(EARO)  |               |
         |&lt;-----------------|               |
                   ...
      (host1)           (router)
         |  NS(EARO)        |               |
         |-----------------&gt;|               |
         |                  |               |
         |        NA(EARO)  |               |
         |&lt;-----------------|               |
                   ...
         |                  |&lt;maintain route&gt; -&gt;
                   ...
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-registration-flow-for-an-an" class="selfRef">Registration Flow for an Anycast or Multicast Address</a>
        </figcaption></figure>
</div>
<p id="section-3-5">In classical networks, <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> may be used for an ND
   proxy operation as specified in <span>[<a href="#RFC8929" class="cite xref">RFC8929</a>]</span> or redistributed
   in a full-fledged routing protocol such as what might be done in BGP for
   Ethernet VPN <span>[<a href="#I-D.thubert-bess-secure-evpn-mac-signaling" class="cite xref">MAC-SIGNALING</a>]</span> or
   in the Routing in Fat Trees (RIFT) protocol <span>[<a href="#I-D.ietf-rift-rift" class="cite xref">RIFT</a>]</span>. The device mobility can be gracefully
   supported as long as the routers can exchange and make sense of the
   sequence counter in the TID field of the EARO.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">In the case of LLNs, RPL <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> is the routing
   protocol of choice and <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> specifies how the unicast
   address advertised with <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> is redistributed in
   RPL. This specification also provides RPL extensions for anycast and
   multicast address operation and redistribution. In the RPL case, and unless
   specified otherwise, the behavior is the same as it is for unicast for the 6LBR that acts as RPL Root, the intermediate routers Down the RPL graph, the 6LRs that act as access
   routers, and the 6LNs that are the RPL-unaware destinations. In particular, forwarding a packet happens as specified in
   <span><a href="https://rfc-editor.org/rfc/rfc6550#section-11" class="relref">Section 11</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>, including loop
   avoidance and detection, though in the multicast case, multiple copies
   might be generated.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7"><span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> is a prerequisite to this specification.  A
   node that implements this <span class="bcp14">MUST</span> also implement <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.  This specification modifies existing options and
   updates the associated behaviors to enable the registration for multicast
   addresses as an extension to <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.  As with the registration
   of a unicast
   address, the subscription to anycast and multicast addresses
   between a node and its router(s) is agnostic (meaning it is independent) from the routing protocol in which this information may be
   redistributed or aggregated by the router to other routers. However, protocol
   extensions would be needed in the protocol when multicast services are not
   available.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">This specification also Extends <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> and
   <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> to add multicast ingress replication (IR) in
   Non-Storing mode and anycast support in both Storing and Non-Storing modes in the case of a route-over multilink subnet based
   on the RPL routing protocol.
   A 6LR that implements the RPL extensions specified herein <span class="bcp14">MUST</span> also
   implement <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9"><a href="#figref" class="auto internal xref">Figure 2</a> illustrates the typical scenario of an LLN as
   a single IPv6 subnet, with a 6LBR that acts as Root
   for RPL operations and maintains a registry of the active registrations as
   an abstract data structure called an "Address Registrar" for 6LoWPAN ND.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">The LLN may be a hub-and-spoke access link such as (Low-Power) Wi-Fi
    <span>[<a href="#IEEE80211" class="cite xref">IEEE-802.11</a>]</span> and (Low-Energy) Bluetooth <span>[<a href="#IEEE802151" class="cite xref">IEEE-802.15.1</a>]</span> or a Route-Over LLN such as the Wi-SUN <span>[<a href="#I-D.heile-lpwan-wisun-overview" class="cite xref">Wi-SUN</a>]</span> and IPv6 over the TSCH mode of IEEE 802.15.4 (6TiSCH) <span>[<a href="#RFC9030" class="cite xref">RFC9030</a>]</span> meshes that leverage 6LoWPAN <span>[<a href="#RFC4919" class="cite xref">RFC4919</a>]</span>
        <span>[<a href="#RFC6282" class="cite xref">RFC6282</a>]</span> and RPL <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> over IEEE 802.15.4 <span>[<a href="#IEEE802154" class="cite xref">IEEE-802.15.4</a>]</span>.<a href="#section-3-10" class="pilcrow">¶</a></p>
<span id="name-wireless-mesh"></span><div id="figref">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-3-11.1">
<pre>
                  |
      ----+-------+------------
          |     Wire side
       +------+
       | 6LBR |
       |(Root)|
       +------+
       o  o  o  Wireless side
   o   o o   o  o o
  o  o  o o   o  o  o
 o  o  o   LLN  o   +---+
   o  o   o  o   o  |6LR|
   o o  o o   o     +---+
    o   o   o o o  o    z
   o  o oo o  o        +---+
          o            |6LN|
                       +---+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-wireless-mesh" class="selfRef">Wireless Mesh</a>
        </figcaption></figure>
</div>
<p id="section-3-12">A leaf acting as a 6LN registers its unicast addresses to a RPL
   router acting as a 6LR using a Layer 2 unicast NS message with an EARO as
   specified in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.
   The registration state is periodically renewed by the Registering Node
   before the lifetime indicated in the EARO expires. As for unicast IPv6
   addresses, the 6LR uses an EDAR and then an EDAC exchange with the 6LBR to notify the
   6LBR of the presence of the listeners.<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">This specification updates the EARO with a new 2-bit field, the P-Field,
   as detailed in <a href="#R8505E" class="auto internal xref">Section 7.1</a>.  The existing R flag that requests
   reachability for the Registered Address gets new behavior.  With this
   extension, the 6LNs can now subscribe to the anycast and multicast addresses
   they listen to, using a new P-Field in the EARO to signal that the
   registration is for a multicast address. Multiple 6LNs may subscribe the
   same multicast address to the same 6LR. Note the use of the term
   "subscribe": this means that when using the EARO registration mechanism, a node registers the
   unicast addresses that it owns but subscribes to the multicast addresses
   that it listens to.<a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14">With this specification, the 6LNs can also subscribe the anycast
   addresses they accept using a new P-Field in the EARO to signal that the
   registration is for an anycast address. For multicast addresses, multiple 6LNs may
   subscribe the same anycast address to the same 6LR.<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">If the R flag is set in the subscription of one or more 6LNs for the
   same address, the 6LR injects the anycast addresses and multicast addresses
   of a scope larger than the link-scope in RPL, based on the longest subscription
   lifetime across the active subscriptions for the address.<a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16">In the RPL Storing Mode of Operation with multicast support (<span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>), the DAO
   messages for the multicast address percolate along the RPL-preferred parent
   tree and mark a subtree that becomes the multicast tree for that multicast
   address, with 6LNs that subscribed to the address as the leaves.  As
   prescribed in <span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>, the 6LR forwards a
   multicast packet as an individual unicast Medium Access Control (MAC) frame to each peer along the
   multicast tree, except to the node it received the packet from.<a href="#section-3-16" class="pilcrow">¶</a></p>
<p id="section-3-17">In the new RPL Non-Storing Mode of Operation with ingress replication multicast support
   that is introduced here, the DAO messages announce the multicast addresses
   as Targets, and never as Transits. The multicast distribution is an
   IR whereby the Root encapsulates the multicast packets to
   all the 6LRs that are transit for the multicast address, using the same
   source-routing header as for unicast targets attached to the respective
   6LRs.<a href="#section-3-17" class="pilcrow">¶</a></p>
<p id="section-3-18">LLN links are typically Direct MAC Broadcast (DMB) (see more in <span>[<a href="#I-D.ietf-6man-ipv6-over-wireless" class="cite xref">IPv6-OVER-WIRELESS</a>]</span>) with no emulation to increase
   range (over multiple radio hops) or reliability.  In such links,
   broadcasting is unreliable and asynchronous transmissions force a listener
   to remain awake, so asynchronous broadcasting is generally inefficient.
   Thus, the expectation is that whenever possible, the 6LRs deliver the
   multicast packets as individual unicast MAC frames to each of the 6LNs that
   subscribed to the multicast address.  On the other hand, in a network where
   nodes do not sleep, asynchronous broadcasting may still help recovering
   faster when state is lost.<a href="#section-3-18" class="pilcrow">¶</a></p>
<p id="section-3-19">With this specification, anycast addresses can be injected in RPL in
   both Storing and Non-Storing modes. In Storing mode, the RPL router accepts
   DAO messages from multiple children for the same anycast address, but it only forwards
   a packet to one of the children.  In Non-Storing mode, the Root maintains
   the list of all the RPL nodes that announced the anycast address as Target,
   but it forwards a given packet to only one of them.<a href="#section-3-19" class="pilcrow">¶</a></p>
<p id="section-3-20">Operationally speaking, deploying a new MOP means that one cannot update
   a live network. The network administrator must create a new instance with
   MOP 5 and migrate nodes to that instance by allowing them to join it.<a href="#section-3-20" class="pilcrow">¶</a></p>
<p id="section-3-21">For backward compatibility, this specification allows building a single
   DODAG signaled as MOP 1 that conveys anycast, unicast, and multicast
   packets using the same source-routing mechanism; see more in <a href="#deploy" class="auto internal xref">Section 11</a>.<a href="#section-3-21" class="pilcrow">¶</a></p>
<p id="section-3-22">It is also possible to leverage this specification between the 6LN and
   the 6LR for the registration of unicast, anycast, and multicast IPv6
   addresses in networks that are not necessarily LLNs and/or where the
   routing protocol between the 6LR and its peer routers is not necessarily RPL. In that
   case, the distribution of packets between the 6LR and the 6LNs may
   effectively rely on a broadcast or multicast support at the lower layer
   (e.g., using this specification as a replacement to MLD in an Ethernet-bridged domain and still using either a plain MAC-layer broadcast or snooping of
   this protocol to control the flooding). It may also rely on overlay services
   to optimize the impact of Broadcast, Unknown, and Multicast (BUM) traffic over a
   fabric, e.g., registering with <span>[<a href="#I-D.thubert-bess-secure-evpn-mac-signaling" class="cite xref">MAC-SIGNALING</a>]</span> and forwarding with
   <span>[<a href="#RFC9574" class="cite xref">RFC9574</a>]</span>.<a href="#section-3-22" class="pilcrow">¶</a></p>
<p id="section-3-23">For instance, it is possible to operate a RPL Instance in the new
   Non-Storing Mode of Operation with ingress replication multicast support (while possibly
   signaling a MOP of 1) and use "Multicast Protocol for Low-Power and Lossy
   Networks (MPL)" <span>[<a href="#RFC7731" class="cite xref">RFC7731</a>]</span> for the multicast operation.  MPL
   floods the DODAG with the multicast messages independently of the RPL DODAG
   topologies. Two variations are possible:<a href="#section-3-23" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-24.1">In one possible variation, all the 6LNs set the R flag in the EARO
     for a multicast target, upon which the 6LRs send a unicast DAO message to
     the Root; the Root filters out the multicast messages for which there is
     no listener and only floods when a listener exists.<a href="#section-3-24.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-24.2">In a simpler variation, the 6LNs do not set the R flag and the Root
     floods all the multicast packets over the whole DODAG. Using a
     configuration mechanism, it is also possible to control the behavior of the 6LR to
     ignore the R flag. It can be configured to either always or never send the DAO message and/or to control the Root and specify which groups it should flood or not
     flood.<a href="#section-3-24.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-25">Note that if the configuration instructs the 6LR not to send the DAO message,
   then MPL can be used in conjunction with the RPL Storing mode as
   well.<a href="#section-3-25" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tgt4861">
<section id="section-4">
      <h2 id="name-amending-rfc-4861">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-amending-rfc-4861" class="section-name selfRef">Amending RFC 4861</a>
      </h2>
<p id="section-4-1"><span><a href="https://rfc-editor.org/rfc/rfc4861#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> requires silently discarding NS and NA packets when the Target Address is a multicast
   address. This specification Amends <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> by allowing the advertisement of multicast and anycast addresses in the Target Address field when
   the NS message is used for a registration, per <span><a href="https://rfc-editor.org/rfc/rfc8505#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CIO">
<section id="section-5">
      <h2 id="name-extending-rfc-7400">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-extending-rfc-7400" class="section-name selfRef">Extending RFC 7400</a>
      </h2>
<p id="section-5-1">This specification Extends "6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)" <span>[<a href="#RFC7400" class="cite xref">RFC7400</a>]</span> by defining a new capability bit for use in
    the 6CIO.  <span>[<a href="#RFC7400" class="cite xref">RFC7400</a>]</span> was already extended by <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> for use in IPv6 ND messages.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The new "Registration for Unicast, Multicast, and Anycast
      Addresses Supported" X flag indicates
    to the 6LN that the 6LR accepts unicast, multicast, and anycast address
    registrations as specified in this document and will ensure that packets
    for the Registered Address will be routed to the 6LNs that registered with
    the R flag set appropriately.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"><a href="#fig6CIO" class="auto internal xref">Figure 3</a> illustrates the X flag in its
    position (8, counting 0 to 15 in network order in the 16-bit array); see
    <a href="#New_Cap_Bits" class="auto internal xref">Section 14.6</a> for the IANA registration of capability bits.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-new-capability-bits-in-the-"></span><div id="fig6CIO">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-5-4.1">
<pre>

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |    Reserved   |X|A|D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-new-capability-bits-in-the-" class="selfRef">New Capability Bits in the 6CIO</a>
        </figcaption></figure>
</div>
<p id="section-5-5">New Option Field:<a href="#section-5-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-6">
        <dt id="section-5-6.1">X:</dt>
        <dd style="margin-left: 1.5em" id="section-5-6.2">This is a 1-bit flag for "Registration for Unicast, Multicast, and Anycast
   Addresses Supported".<a href="#section-5-6.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="coex">
<section id="section-6">
      <h2 id="name-amending-rfc-6550">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-amending-rfc-6550" class="section-name selfRef">Amending RFC 6550</a>
      </h2>
<p id="section-6-1">This specification Amends <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> to mandate the use of
   the ROVR field as the indication of the origin of a Target advertisement in
   RPL DAO messages, as specified as an option in <span><a href="https://rfc-editor.org/rfc/rfc9010#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This specification Extends <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> with a new P-Field in the RPL Target Option (RTO).<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The specification also Amends the behaviors of the Modes of Operation
   MOP 1 and MOP 3 and Extends <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> with a new MOP 5.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="mrovr">
<section id="section-6.1">
        <h3 id="name-mandating-the-rovr-field">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-mandating-the-rovr-field" class="section-name selfRef">Mandating the ROVR Field</a>
        </h3>
<p id="section-6.1-1">For anycast and multicast advertisements (in NS or DAO messages),
   multiple origins may subscribe to the same address, in which case the
   multiple advertisements from the different or unknown origins are merged by
   the common parent; in that case, the common parent becomes the origin of
   the merged advertisements and uses its own ROVR value. On the other hand, a
   parent that propagates an advertisement from a single origin uses the
   original ROVR in the propagated RTO, as it does for unicast address
   advertisements, so the origin is recognized across multiple hops.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2"><span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> uses the Path Sequence in the Transit
   Information Option (TIO) to retain only the freshest unicast route and
   remove the stale ones, e.g., in the case of mobility. <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>
   copies the Transaction ID (TID) from the EARO into the Path Sequence and the ROVR field
   into the associated RTO.  This way, it is possible to
   identify both the Registering Node and the order of registration in RPL for
   each individual advertisement, so the most recent path and lifetime values
   are used.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">This specification Extends <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> for anycast and
   multicast advertisements to require that the Path Sequence be used
   between, and only between, advertisements for the same Target and from the
   same origin (i.e., with the same ROVR value). In that case, only the
   freshest advertisement is retained, but the freshness comparison cannot
   apply if the origin is not determined (i.e., the origin did not support
   this specification).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4"><span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> uses the Path Lifetime in the TIO to indicate
   the remaining time for which the advertisement is valid for unicast route
   determination, and a Path Lifetime value of 0 invalidates that route.
   <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> maps the Address Registration lifetime in the EARO
   and the Path Lifetime in the TIO so they are comparable when both forms of
   advertisements are received.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">The RPL router that merges multiple advertisements for the same anycast
   or multicast addresses <span class="bcp14">MUST</span> use and advertise the longest
   remaining lifetime across all the origins of the advertisements for that
   address.  When the lifetime expires, the router sends a no-path DAO message (i.e.,
   the lifetime is 0) using the same value for the ROVR value as for the previous
   advertisements. This value refers to either the single descendant that
   advertised the Target if there is only one or the router itself if there is more than one.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">Note that the Registration Lifetime, TID, and ROVR fields are also placed
   in the EDAR message so the state created by the EDAR is also comparable with
   that created upon an NS(EARO) or a DAO message. For simplicity, the text
   below mentions only NS(EARO) but it also applies to EDAR.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mop3">
<section id="section-6.2">
        <h3 id="name-updating-mop-3">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-updating-mop-3" class="section-name selfRef">Updating MOP 3</a>
        </h3>
<p id="section-6.2-1">RPL supports multicast operations in the Storing Mode of Operation with
   multicast support (MOP 3), which provides source-independent multicast
   routing in RPL, as prescribed in <span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>.
   MOP 3 is a Storing Mode of Operation. This operation builds a multicast
   tree within the RPL DODAG for each multicast address. This specification
   provides additional details for the MOP 3.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The expectation in MOP 3 is that the unicast traffic also follows the
   Storing Mode of Operation. However, this is rarely the case in LLN deployments
   of RPL where the Non-Storing Mode of Operation (MOP 1) is the norm.
   Though it is preferred to build separate RPL Instances, one in MOP 1 and
   one in MOP 3, this specification allows hybrid use of the Storing mode for
   multicast and the Non-Storing mode for unicast in the same RPL Instance, as is
   elaborated in more detail in <a href="#deploy" class="auto internal xref">Section 11</a>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">For anycast and multicast advertisements, including MOP 3, the ROVR
   field is placed in the RTO as specified in <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> for both MOP 3 and MOP 5 as it is for unicast
   advertisements.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Though it was implicit with <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>, this specification
   clarifies that the freshness comparison based on the Path Sequence is not
   used when the origin cannot be determined, which occurs in the case of multiple subscriptions of a multicast or unicast address.  The
   comparison is to be used only between advertisements from the same origin,
   which is either an individual subscriber or a descendant that merged
   multiple advertisements.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">A RPL router maintains a remaining Path Lifetime for each DAO message that it
   receives for a multicast target and sends its own DAO message for that target with
   the longest remaining lifetime across its listening children. If the router
   has only one descendant listening, it propagates the TID and ROVR as
   received. Conversely, if the router merges multiple advertisements
   (possibly including one for itself as a listener), the router uses its own
   ROVR and TID values. This implies a possible transition of ROVR and TID
   values when the number of listening children changes from one to more or
   back to one, which should not be considered as an error or a change of
   ownership by the parents above.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mop5">
<section id="section-6.3">
        <h3 id="name-new-non-storing-multicast-m">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-new-non-storing-multicast-m" class="section-name selfRef">New Non-Storing Multicast MOP</a>
        </h3>
<p id="section-6.3-1">This specification adds a Non-Storing Mode of Operation with ingress
replication multicast support RPL (as assigned by IANA; see <a href="#RPL_Mode_Op" class="auto internal xref">Section 14.5</a>) whereby the
Non-Storing Mode DAO to the Root may advertise a multicast address in the RTO, whereas the TIO cannot.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">In that mode, the RPL Root performs an IR operation
on the multicast packets. This means that it transmits one copy of each multicast
packet to each 6LR that is a transit for the multicast target, using the same
source-routing header and encapsulation as it would for a unicast packet for a
RPL-Unaware Leaf (RUL) attached to that 6LR.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">For the intermediate routers, the packet appears as any source-routed
unicast packet. The difference shows only at the 6LR, which terminates the
source-routed path and forwards the multicast packet to all 6LNs that
registered for the multicast address.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">For a packet that is generated by the Root, the Root builds
a source-routing header as shown in <span><a href="https://rfc-editor.org/rfc/rfc9008#section-8.1.3" class="relref">Section 8.1.3</a> of [<a href="#RFC9008" class="cite xref">RFC9008</a>]</span>, but for which the last and only the last address is
multicast.  For a packet that is not generated by the Root, the Root
encapsulates the multicast packet as per <span><a href="https://rfc-editor.org/rfc/rfc9008#section-8.2.4" class="relref">Section 8.2.4</a> of [<a href="#RFC9008" class="cite xref">RFC9008</a>]</span>. In that case, the outer header is purely
unicast, and the encapsulated packet is purely multicast.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">For anycast and multicast advertisements in NA messages (at the 6LR) and DAO messages (at the
Root), as discussed in <a href="#mop3" class="auto internal xref">Section 6.2</a>, the freshness
comparison based on the TID field is applied only between messages from the
same origin, as determined by the same value in the ROVR field.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">The Root maintains a remaining Path Lifetime for each advertisement it
receives, and a 6LR generates the DAO message for multicast addresses with the
longest remaining lifetime across its registered 6LNs, using its own ROVR and
TID when multiple 6LNs have subscribed or when the 6LR is a subscriber.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7">This specification allows enabling the
operation in a MOP 1 brown field for this new mode as well; see more in <a href="#deploy" class="auto internal xref">Section 11</a>.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="anic">
<section id="section-6.4">
        <h3 id="name-rpl-anycast-operation">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-rpl-anycast-operation" class="section-name selfRef">RPL Anycast Operation</a>
        </h3>
<p id="section-6.4-1">With multicast, the address has a recognizable format, and a multicast
   packet is to be delivered to all the active subscribers.  In contrast, the
   format of an anycast address is not distinguishable from that of a unicast address. A
   legacy node may issue a DAO message without setting the P-Field to 2; the
   unicast behavior may apply to anycast traffic within a portion of the
   network, but the packets will still be delivered.  That message will be
   undistinguishable from a unicast advertisement, and the anycast behavior in
   the data plane can only happen if all the nodes that advertise the same
   anycast address are synchronized with the same TID. That way, the multiple
   paths can remain in the RPL DODAG.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">With the P-Field set to 2, this specification alleviates the issue of
   synchronizing the TIDs and ROVR fields. As for multicast, the freshness
   comparison based on the TID (in the EARO) and the Path Sequence (in the TIO) is
   ignored unless the messages have the same origin; this is inferred by the same
   ROVR in the RTO and/or the EARO, and the latest value of the lifetime is retained
   for each origin.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">A RPL router that propagates an advertisement from a single origin uses the
   ROVR and Path Sequence from that origin, whereas a router that merges
   multiple subscriptions uses its own ROVR and Path Sequence and the longest
   lifetime over the different advertisements.  A target is routed as anycast
   by a parent (or the Root) that received at least one DAO message for that
   target with the P-Field set to 2.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">As opposed to multicast, the anycast operation described herein applies
   to both addresses and prefixes, and the P-Field can be set to 2 for both.
   An external destination (such as an address or prefix) that may be injected as a RPL
   Target from multiple border routers should be injected as anycast in RPL to
   enable load balancing. In contrast, a mobile target that is multihomed should
   be advertised as unicast over the multiple interfaces to favor the
   TID comparison instead of multipath load balancing.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">For either multicast or anycast, there can be multiple subscriptions
   from multiple origins, each using a different value of the ROVR field that
   identifies the individual subscription.

   The 6LR maintains a subscription
   state per value of the ROVR for each multicast or anycast address, but it injects
   the route into RPL only once for each address. In the case of a
   multicast address, this occurs only if its scope is larger than the link-scope (three or more).
   Since the subscriptions are considered separate, the check on the TID that
   acts as the subscription sequence only applies to the subscription with the
   same ROVR.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">Like the 6LR, a RPL router in Storing mode propagates the merged
   advertisement to its parent(s) in DAO messages once and only once for each
   address, but it retains a routing table entry for each of the children that
   advertised the address.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">When forwarding multicast packets Down the DODAG, the RPL router copies
   all the children that advertised the address in their DAO messages. In
   contrast, when forwarding anycast packets Down the DODAG, the RPL router
   <span class="bcp14">MUST</span> copy one and only one of the children that advertised
   the address in their DAO messages and forward it to one parent if there is no
   such child.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="newpf">
<section id="section-6.5">
        <h3 id="name-new-registered-address-type">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-new-registered-address-type" class="section-name selfRef">New Registered Address Type Indicator P-Field</a>
        </h3>
<p id="section-6.5-1">The new Registered Address Type Indicator (RATInd) is created for use in the
  RTO, the EARO, and the header of EDAR messages.  The RATInd
  indicates whether an address is unicast, multicast, or anycast.  The new
  2-bit P-Field is defined to transport the RATInd in different protocols.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The P-Field can take the values shown in <a href="#AM2" class="auto internal xref">Table 2</a>.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">The intent for the value of 3 is a prefix registration (see <span>[<a href="#I-D.ietf-6lo-prefix-registration" class="cite xref">REGISTRATION</a>]</span>), which is expected to be
  published after this specification. At the time of this writing,
  RPL already advertises prefixes, and treats unicast addresses as
  prefixes with a length of 128, so it does not need that new
  value. On the other hand, 6LoWPAN ND does not, so the value of 3
  (meaning prefix registration) will not be processed adequately. As a
  result:<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-4.1">When the value of 3 is received in an RTO (see <a href="#newrtoflg" class="auto internal xref">Section 6.6</a>), this value <span class="bcp14">MUST</span> be ignored by
    the receiver (meaning it is treated as a value of 0) but the message is
    processed normally (as per <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> and <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>).<a href="#section-6.5-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.5-4.2">In the case of an EARO (see <a href="#R8505E" class="auto internal xref">Section 7.1</a>) or an EDAR
    (see <a href="#R8505D" class="auto internal xref">Section 7.2</a>), the message <span class="bcp14">MUST</span> be
    dropped, and the receiving node <span class="bcp14">MAY</span> either reply
    with a status of 12 "Invalid Registration" or remain silent.<a href="#section-6.5-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="newrtoflg">
<section id="section-6.6">
        <h3 id="name-new-rpl-target-option-p-fie">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-new-rpl-target-option-p-fie" class="section-name selfRef">New RPL Target Option P-Field</a>
        </h3>
<p id="section-6.6-1"><span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> recognizes a multicast address by its format (as
specified in <span><a href="https://rfc-editor.org/rfc/rfc4291#section-2.7" class="relref">Section 2.7</a> of [<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>) and
applies the specified multicast operation if the address is recognized as
multicast.  This specification updates <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> to add the
2-bit P-Field (see <a href="#newpf" class="auto internal xref">Section 6.5</a>) to the RTO to indicate that the
Target Address is to be processed as unicast, multicast, or anycast.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6-2.1">An RTO that has the P-Field set to 0 is called a unicast RTO.<a href="#section-6.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-2.2">An RTO that has the P-Field set to 1 is called a multicast RTO.<a href="#section-6.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.6-2.3">An RTO that has the P-Field set to 2 is called an anycast RTO.<a href="#section-6.6-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.6-3">The suggested position for the P-Field is 2 counting from 0 to 7 in network
order as shown in <a href="#rto-fmt" class="auto internal xref">Figure 4</a>, based on Figure 4 of <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>, which defines the flags in positions 0 and 1:<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<span id="name-format-of-the-rpl-target-op"></span><div id="rto-fmt">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-6.6-4.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type = 0x05 | Option Length |F|X| P |ROVRsz | Prefix Length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                Target Prefix (Variable Length)                |
  .                                                               .
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...            Registration Ownership Verifier (ROVR)           ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-format-of-the-rpl-target-op" class="selfRef">Format of the RPL Target Option (RTO)</a>
          </figcaption></figure>
</div>
<p id="section-6.6-5">New and updated Option Field:<a href="#section-6.6-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.6-6">
          <dt id="section-6.6-6.1">P:</dt>
          <dd style="margin-left: 1.5em" id="section-6.6-6.2">This is a 2-bit field; see <a href="#newpf" class="auto internal xref">Section 6.5</a>.<a href="#section-6.6-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="updating">
<section id="section-7">
      <h2 id="name-extending-rfc-8505">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-extending-rfc-8505" class="section-name selfRef">Extending RFC 8505</a>
      </h2>
<p id="section-7-1">This specification Extends <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> by adding the concept
of a subscription for anycast and multicast addresses and creating a new field
called the P-Field in the EARO and in the EDAR and EDAC messages to signal the type
of registration.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="R8505E">
<section id="section-7.1">
        <h3 id="name-placing-the-new-p-field-in-">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-placing-the-new-p-field-in-" class="section-name selfRef">Placing the New P-Field in the EARO</a>
        </h3>
<p id="section-7.1-1"><span><a href="https://rfc-editor.org/rfc/rfc8505#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> defines the EARO
as an extension to the ARO defined in <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>.  This
specification adds a new P-Field that is placed in the EARO flags and is set as
follows:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">The P-Field is set to 1 to signal that the Registered Address is a
  multicast address. When the P-Field is 1 and the R flag is set to 1 as well,
  the 6LR that conforms to this specification joins the multicast stream
  (e.g., by injecting the address in the RPL multicast support that is extended
  in this specification for the Non-Storing mode).<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-2.2">The P-Field is set to 2 to signal that the Registered Address is an
  anycast address. When the P-Field is 2 and the R flag is 1, the 6LR that
  conforms to this specification injects the anycast address in the routing
  protocol(s) that it participates in (e.g., in the RPL anycast support that
  is introduced in this specification for both the Storing and Non-Storing
  modes).<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.1-3"><a href="#EARO" class="auto internal xref">Figure 5</a> illustrates the P-Field in its position
(2, counting 0 to 7 in network order in the 8-bit array); see <a href="#PF" class="auto internal xref">Section 14.1</a> for the IANA registration of P-Field values.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<span id="name-extended-address-registrati"></span><div id="EARO">
<figure id="figure-5">
          <div class="alignCenter art-text artwork" id="section-7.1-4.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |Rsv| P | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...          Registration Ownership Verifier (ROVR)              ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-extended-address-registrati" class="selfRef">Extended Address Registration Option (EARO) Format</a>
          </figcaption></figure>
</div>
<p id="section-7.1-5">New and updated Option Fields:<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.1-6">
          <dt id="section-7.1-6.1">Rsv:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-6.2">This is a 2-bit field. It is reserved and <span class="bcp14">MUST</span> be
   set to 0 and ignored by the receiver.<a href="#section-7.1-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-6.3">P:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-6.4">This is a 2-bit P-Field; see <a href="#newpf" class="auto internal xref">Section 6.5</a>.<a href="#section-7.1-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="R8505D">
<section id="section-7.2">
        <h3 id="name-placing-the-new-p-field-in-t">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-placing-the-new-p-field-in-t" class="section-name selfRef">Placing the New P-Field in the EDAR Message</a>
        </h3>
<p id="section-7.2-1"><span><a href="https://rfc-editor.org/rfc/rfc6775#section-4" class="relref">Section 4</a> of [<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> provides the same
  format for DAR and DAC messages but the Status field is only used in DAC
  messages and has to be set to 0 in DAR messages. <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>
  extends the DAC message as an EDAC but does not change the Status field in
  the EDAR.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">This specification repurposes the Status field in the EDAR as a Flags
  field.  It adds a new P-Field to the EDAR flags field to match the P-Field in
  the EARO and signal the new types of registration. The EDAC message is not
  modified.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3"><a href="#EDAR" class="auto internal xref">Figure 6</a> illustrates the P-Field in its position (0,
  counting 0 to 7 in network order in the 8-bit array); see <a href="#EDAR_Message_Flags" class="auto internal xref">Section 14.2</a> for the IANA registration of EDAR message flags.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<span id="name-extended-duplicate-address-"></span><div id="EDAR">
<figure id="figure-6">
          <div class="alignCenter art-text artwork" id="section-7.2-4.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |CodePfx|CodeSfx|          Checksum             |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | P | Reserved  |     TID       |     Registration Lifetime     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
...            Registration Ownership Verifier (ROVR)           ...
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 +                                                               +
 |                                                               |
 +                       Registered Address                      +
 |                                                               |
 +                                                               +
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-extended-duplicate-address-" class="selfRef">Extended Duplicate Address Request (EDAR) Message Format</a>
          </figcaption></figure>
</div>
<p id="section-7.2-5">New and updated Option Fields:<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.2-6">
          <dt id="section-7.2-6.1">Reserved:</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-6.2">This is a 6-bit field. It is reserved and <span class="bcp14">MUST</span> be set to 0 and ignored by the receiver.<a href="#section-7.2-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-6.3">P:</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-6.4">This is a 2-bit field; see <a href="#newpf" class="auto internal xref">Section 6.5</a>.<a href="#section-7.2-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="multireg">
<section id="section-7.3">
        <h3 id="name-registration-extensions">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-registration-extensions" class="section-name selfRef">Registration Extensions</a>
        </h3>
<p id="section-7.3-1"><span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> specifies the following behaviors:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">A router that expects to reboot may send a final RA message, upon which
   nodes should subscribe elsewhere or redo the subscription to the same
   router upon reboot.  In all other cases, a node reboot is silent.  When the
   node comes back to life, existing registration state might be lost if it
   was not persisted, e.g., in persistent memory.<a href="#section-7.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.2">The registration method is specified only for unicast addresses.<a href="#section-7.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.3">The 6LN must register all its ULAs and GUAs with an NS(EARO) message.<a href="#section-7.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.4">The 6LN may set the R flag in the EARO to obtain return reachability
   services by the 6LR, e.g., through ND proxy operations or by injecting the
   route in a route-over subnet.<a href="#section-7.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.5">the 6LR maintains a registration state per Registered Address, including an
   NCE with the Link-Layer Address (LLA) of the Registered Node (the 6LN here).<a href="#section-7.3-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.3-3">This specification Amends the above behaviors and Extends them with the
   following behaviors:<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-4.1">The concept of subscription is introduced for anycast and multicast
     addresses as an extension to the registration of a unicast address.  The
     respective operations are similar from the perspective of the 6LN, but
     they show important differences on the router side, which maintains a separate
     state for each origin and merges them in its own advertisements.<a href="#section-7.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.2">
            <p id="section-7.3-4.2.1">New ARO Statuses are introduced to indicate a "Registration Refresh
       Request" and an "Invalid Registration" (see <a href="#AROstat" class="auto internal xref">Table 8</a>).<a href="#section-7.3-4.2.1" class="pilcrow">¶</a></p>
<p id="section-7.3-4.2.2">The former status is used in asynchronous NA(EARO) messages to
       indicate to peer 6LNs that they are requested to reregister all
       addresses that were previously registered to the originating node. The
       NA message may be sent to a unicast or a multicast link-scope address
       and should be contained within the L2 range where nodes may have
       effectively registered or, respectively, subscribed to this router (e.g., a radio
       broadcast domain). The latter is generic to any error in the EARO and
       is used, for example, to report that the P-Field is not consistent with the
       Registered Address in NS(EARO) and EDAR messages.<a href="#section-7.3-4.2.2" class="pilcrow">¶</a></p>
<p id="section-7.3-4.2.3">A router that wishes to refresh its state (e.g., upon reboot or in
       any situation where it may have missed a registration or lost a
       registration state) <span class="bcp14">SHOULD</span> send an asynchronous NA(EARO)
       with this new status value. Failure to do so will delay the recovery of
       the network until the next periodic registration by the attached 6LNs
       and packets may be lost until then.  That asynchronous multicast
       NA(EARO) <span class="bcp14">MUST</span> be sent to the all-nodes link-scope
       multicast address (ff02::1), and the Target <span class="bcp14">MUST</span> be set to
       the link-local address that was exposed previously by this node to
       accept registrations.<a href="#section-7.3-4.2.3" class="pilcrow">¶</a></p>
<p id="section-7.3-4.2.4">The TID field in the multicast NA(EARO) message is the one associated to the
       Target and follows the same rules as the TID in the NS(EARO) message for the
       same Target; see <span><a href="https://rfc-editor.org/rfc/rfc8505#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>, which points to <span><a href="https://rfc-editor.org/rfc/rfc6550#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> for the lollipop mechanism used in
       the TID operation. It is incremented by the sender each time it sends a
       new series of NS and/or NA messages with the EARO about the Target.  The TID
       indicates a reboot when it is in the "straight" part of the lollipop,
       between the initial value and 255. After that, the TID remains below 128
       as long as the device is alive. An asynchronous multicast NA(EARO) with
       a TID below 128 <span class="bcp14">MUST NOT</span> be considered as indicating a
       reboot.<a href="#section-7.3-4.2.4" class="pilcrow">¶</a></p>
<p id="section-7.3-4.2.5">The asynchronous multicast NA(EARO) indicating a "Registration Refresh
     Request" <span class="bcp14">MAY</span> be reissued a few times within a short
     period, to increase the chances that the message is received by all
     registered nodes despite the unreliable transmissions within the LLN; the
     TID <span class="bcp14">MUST</span> be incremented each time.  The receiver 6LN
     <span class="bcp14">MUST</span> consider that multiple NA(EARO) messages indicating a
     "Registration Refresh Request" from the same 6LR received within that
     short period with comparable and increasing TID values (i.e., their absolute difference is less than the
     SEQUENCE_WINDOW; see <span><a href="https://rfc-editor.org/rfc/rfc6550#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>)  are in fact indicative of the same request. The 6LN <span class="bcp14">MUST</span> process one and only one of the
     series of messages. If the TIDs are desynchronized (not comparable) or
     decreased, then the NA(EARO) is considered as a new request and it
     <span class="bcp14">MUST</span> be processed.<a href="#section-7.3-4.2.5" class="pilcrow">¶</a></p>
<p id="section-7.3-4.2.6">The multicast NA(EARO) <span class="bcp14">SHOULD</span> be resent enough times
     for the TID to be issued with the value of 255 so the next NA(EARO) after
     the initial series is outside the lollipop and is not confused with a
     reboot.  By default, the TID initial setting after boot is 252, the
     SEQUENCE_WINDOW is 4, the duration of the short period is 10 seconds, the
     interval between retries is 1 second, and the number of retries is 3. To
     reach 255 at boot time, the sender <span class="bcp14">MAY</span> either issue at
     least 4 NA messages, skip a TID value, or start with a value that is more
     than 252.  The best values for the short period, the number of retries,
     and the TID initial setting depend on the environment and
     <span class="bcp14">SHOULD</span> be configurable.<a href="#section-7.3-4.2.6" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.3">
            <p id="section-7.3-4.3.1">A new IPv6 ND Consistent Uptime Option (CUO) is introduced to be
     placed in IPv6 ND messages. The CUO allows figuring out the state
     consistency between the sender and the receiver. For instance, a node
     that rebooted needs to reset its uptime to 0.  A router that changed
     information like a prefix information option has to advertise an
     incremented state sequence. To that effect, the CUO carries a Node State
     Sequence Information (NSSI) and a Consistent Uptime.  See <a href="#CUO" class="auto internal xref">Section 10</a> for the option details.<a href="#section-7.3-4.3.1" class="pilcrow">¶</a></p>
<p id="section-7.3-4.3.2">A node that receives the CUO checks whether it is indicative of a
     desynchronization between peers. A peer that discovers that a router has
     changed should reassess which addresses it formed based on the new PIOs
     from that router and resync the state that it installed in the router
     (e.g., the registration state for its addresses).  In the process, the peer
     may attempt to:<a href="#section-7.3-4.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-4.3.3.1">form new addresses and register them,<a href="#section-7.3-4.3.3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.3-4.3.3.2">deprecate old addresses and deregister them using a Lifetime of 0, and<a href="#section-7.3-4.3.3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.3-4.3.3.3">reform any potentially lost state (e.g., by registering again an
       existing address that it will keep using).<a href="#section-7.3-4.3.3.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.3-4.3.4">A loss of state is inferred if the Consistent Uptime of the peer is
     less than the time since the state was installed, or if the NSSI is
     incremented for a Consistent Uptime.<a href="#section-7.3-4.3.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.4">
            <p id="section-7.3-4.4.1">Registration for multicast and anycast addresses is now supported. The
     P-Field is added to the EARO to signal when the Registered Address is
     anycast or multicast. The value of the P-Field is not consistent with
     the Registered Address if:<a href="#section-7.3-4.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-4.4.2.1">the Registered Address is a multicast address (<span><a href="https://rfc-editor.org/rfc/rfc4291#section-2.4" class="relref">Section 2.4</a> of [<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>) and the P-Field indicates a value
     that is not 1, or<a href="#section-7.3-4.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.3-4.4.2.2">the Registered Address is not a multicast address and the P-Field
     indicates a value that is 1.<a href="#section-7.3-4.4.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.3-4.4.3">If this occurs, then the message, NS(EARO) or EDAR, <span class="bcp14">MUST</span> be dropped, and
   the receiving node <span class="bcp14">MAY</span> either reply with a status of 12
   "Invalid Registration" or remain silent.<a href="#section-7.3-4.4.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-4.5">The Status field in the EDAR message that was reserved and not used in
   <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> is repurposed to transport the flags to signal
   multicast and anycast.<a href="#section-7.3-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.6">The 6LN <span class="bcp14">MUST</span> also subscribe all the IPv6 multicast
   addresses that it listens to, and it <span class="bcp14">MUST</span> set the P-Field to
   1 in the EARO for those addresses.  The one exception is the all-nodes
   link-scope multicast address ff02::1 <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>, which is
   implicitly registered by all nodes, meaning that all nodes are expected to
   accept messages sent to ff02::1 but are not expected to register it.<a href="#section-7.3-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.7">The 6LN <span class="bcp14">MAY</span> set the R flag in the EARO to obtain the
   delivery of the multicast packets by the 6LR (e.g., by MLD proxy
   operations, or by injecting the address in a route-over subnet or in the
   Protocol Independent Multicast <span>[<a href="#RFC7761" class="cite xref">RFC7761</a>]</span> protocol).<a href="#section-7.3-4.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.8">The 6LN <span class="bcp14">MUST</span> also subscribe all the IPv6 anycast
   addresses that it supports, and it <span class="bcp14">MUST</span> set the P-Field in
   the EARO to 2 for those addresses.<a href="#section-7.3-4.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.9">The 6LR and the 6LBR are extended to accept more than one subscription
   for the same address when it is anycast or multicast, since multiple 6LNs
   may subscribe to the same address of these types. In both cases, the ROVR
   in the EARO uniquely identifies a registration within the namespace of the
   Registered Address.<a href="#section-7.3-4.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.10">The 6LR <span class="bcp14">MUST</span> also consider that all the nodes that
   registered an address to it (as known by the Source Link-Layer Address
   Option (SLLAO)) also registered ff02::1 <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span> to the all-nodes link-scope multicast address.<a href="#section-7.3-4.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-4.11">The 6LR <span class="bcp14">MUST</span> maintain a subscription state per tuple
   (IPv6 address, ROVR) for both anycast and multicast types of addresses. It
   <span class="bcp14">SHOULD</span> notify the 6LBR with an EDAR message, unless it
   determined that the 6LBR is legacy and does not support this
   specification. In turn, the 6LBR <span class="bcp14">MUST</span> maintain a
   subscription state per tuple (IPv6 address, ROVR) for both anycast and
   multicast types of address.<a href="#section-7.3-4.11" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="updating2">
<section id="section-8">
      <h2 id="name-extending-rfc-9010">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-extending-rfc-9010" class="section-name selfRef">Extending RFC 9010</a>
      </h2>
<p id="section-8-1"><span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> specifies the following behaviors:<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">The 6LR has no specified procedure to inject multicast and anycast routes in RPL even though RPL supports multicast.<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.2">Upon a registration with the R flag set to 1 in the EARO, the 6LR injects the address in the RPL unicast support.<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-2.3">Upon receiving a packet directed to a unicast address for which it has an
     active registration, the 6LR delivers the packet as a unicast Layer 2 frame
     to the LLA of the node that registered the unicast address.<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-3">This specification Extends <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> by adding the following behavior:<a href="#section-8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-4.1">Upon a subscription with the R flag and the P-Field both set to 1 in the EARO,
     if the scope of the multicast address is above link-scope <span>[<a href="#RFC7346" class="cite xref">RFC7346</a>]</span>,
     then the 6LR injects the address in the RPL multicast support and sets the P-Field in the RTO to 1 as well.<a href="#section-8-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-4.2">Upon a subscription with the R flag set to 1 and the P-Field set to 2 in the EARO,
     the 6LR injects the address in the new RPL anycast support and sets the P-Field
     to 2 in the RTO.<a href="#section-8-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-4.3">Upon receiving a packet directed to a multicast address for which it has at
     least one subscription, the 6LR delivers a copy of the packet as a unicast
     Layer 2 frame to the LLA of each of the nodes that registered to that
     multicast address.<a href="#section-8-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-4.4">Upon receiving a packet directed to an anycast address for which it has at
     least one subscription, the 6LR delivers a copy of the packet as a unicast
     Layer 2 frame to the LLA of exactly one of the nodes that registered to that
     multicast address.<a href="#section-8-4.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec8928">
<section id="section-9">
      <h2 id="name-leveraging-rfc-8928">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-leveraging-rfc-8928" class="section-name selfRef">Leveraging RFC 8928</a>
      </h2>
<p id="section-9-1">"Address-Protected Neighbor Discovery for Low-Power
  and Lossy Networks" <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> was defined to protect the ownership of unicast
  IPv6 addresses that are registered with <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">With <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span>, it is possible for a node to autoconfigure a
  pair of public and private keys and use them to sign the registration of
  addresses that are either autoconfigured or obtained through other
  methods.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">The first hop router (the 6LR) may then validate a registration and perform
  source address validation on packets coming from the sender node (the 6LN).<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Anycast and multicast addresses are not owned by one node. Multiple nodes
  may subscribe to the same address.  In that context, the method specified in
  <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> cannot be used with autoconfigured key pairs to
  protect a single ownership.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">For an anycast or a multicast address, it is still possible to leverage
  <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> to enforce the right to subscribe.  If <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> is used, a key pair <span class="bcp14">MUST</span> be associated with
  the address before it is deployed, and a ROVR <span class="bcp14">MUST</span> be generated
  from that key pair as specified in <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span>.  The address and
  the ROVR <span class="bcp14">MUST</span> then be installed in the 6LBR so it can recognize
  the address and compare the ROVR on the first subscription.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">The key pair <span class="bcp14">MUST</span> then be provisioned in each node that needs
  to subscribe to the anycast or multicast address, so the node can follow the
  steps in <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> to subscribe to the address.<a href="#section-9-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CUO">
<section id="section-10">
      <h2 id="name-consistent-uptime-option">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-consistent-uptime-option" class="section-name selfRef">Consistent Uptime Option</a>
      </h2>
<p id="section-10-1">This specification introduces a new option that characterizes the uptime
  of the sender. The option may be used by routers in RA messages and by any
  node in NS, NA, and RS messages. It is used by the receiver to infer whether
  some state synchronization might be lost (e.g., due to reboot).<a href="#section-10-1" class="pilcrow">¶</a></p>
<span id="name-consistent-uptime-option-cu"></span><div id="CUOF">
<figure id="figure-7">
        <div class="alignCenter art-text artwork" id="section-10-2.1">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |     Length    | Exponent  |  Uptime Mantissa  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |S|U|   flags   |          NSSI         |     Peer NSSI         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-consistent-uptime-option-cu" class="selfRef">Consistent Uptime Option (CUO) Format</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-10-3">
        <dt id="section-10-3.1">Type:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.2">Assigned by IANA; see <a href="#NDOpt" class="auto internal xref">Table 9</a>.<a href="#section-10-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.3">Length:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.4">1<a href="#section-10-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.5">Uptime Exponent:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.6">A 6-bit unsigned integer and the Exponent to the base 2 of the uptime unit.<a href="#section-10-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.7">Uptime Mantissa:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.8">A 10-bit unsigned integer and the mantissa of the uptime value.<a href="#section-10-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.9">S:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.10">A 1-bit flag set to 1 to indicate that the sender is low-power
  and may sleep.<a href="#section-10-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.11">U:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.12">A 1-bit flag set to 1 to indicate that the Peer NSSI field is
  valid; it <span class="bcp14">MUST</span> be set to 0 when the message is not unicast and
  <span class="bcp14">MUST</span> be set to 1 when the message is unicast and the sender has
  an NSSI state for the intended receiver.<a href="#section-10-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.13">flags:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.14">6-bit flags that are reserved and that <span class="bcp14">MUST</span> be
  set to 0 by the sender and ignored by the receiver.<a href="#section-10-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.15">NSSI:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.16">A 12-bit unsigned integer that represents the Node State Sequence Information (NSSI). It
  <span class="bcp14">MUST</span> be stored by the receiver if it has a dependency on
  information advertised or stored at the sender.<a href="#section-10-3.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.17">Peer NSSI:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.18">A 12-bit unsigned integer that echoes the last known NSSI from the peer.<a href="#section-10-3.18" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-10-4">The Consistent Uptime indicates how long the sender has been continuously
up and running (though possibly sleeping) without loss of state.  It is
expressed by the Uptime Mantissa in units of 2 to the power of the Uptime
Exponent in milliseconds. The receiver derives the boot time of the sender as the
current time minus the sender's Consistent Uptime.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">If the boot time of the sender is updated to a newer time, any state that
the receiver installed in the sender before the reboot is probably lost. The
receiver <span class="bcp14">MUST</span> reassess all the state it installed in the server
(e.g., any registration) and reinstall if it is still needed.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">The U flag not set in a unicast message indicates that
the sender has lost all state from this node.  If the U flag is set, then the Peer NSSI
field can be used to assess which changes the sender missed. For the other way
around, any state that was installed in the receiver from information by the
sender before it rebooted <span class="bcp14">MUST</span> be removed and may or may not be
reinstalled later.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">The value of the uptime is reset to 0 at some point of the sender's reboot
sequence, but it may not still be 0 when the first message is sent, so the
receiver must not expect a value of 0 as the signal of a reboot.<a href="#section-10-7" class="pilcrow">¶</a></p>
<span id="name-consistent-uptime-rough-val"></span><div id="timex">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-consistent-uptime-rough-val" class="selfRef">Consistent Uptime Rough Values</a>
        </caption>
<thead>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Mantissa</td>
            <td class="text-left" rowspan="1" colspan="1">Exponent</td>
            <td class="text-left" rowspan="1" colspan="1">Resolution</td>
            <td class="text-left" rowspan="1" colspan="1">Uptime</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">1 ms</td>
            <td class="text-left" rowspan="1" colspan="1">1 ms</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">1 s</td>
            <td class="text-left" rowspan="1" colspan="1">5 s</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">15</td>
            <td class="text-left" rowspan="1" colspan="1">30 s</td>
            <td class="text-left" rowspan="1" colspan="1">1 min</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">21</td>
            <td class="text-left" rowspan="1" colspan="1">33 min</td>
            <td class="text-left" rowspan="1" colspan="1">1 hour</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-10-9">The NSSI <span class="bcp14">SHOULD</span> be stored in persistent memory by the sender
and incremented when it may have missed or lost state about a peer, or when it has
updated some state in a fashion that will impact a peer (e.g., a host formed a
new address or a router advertises a new prefix).  When persisting is not
possible, then the NSSI is randomly generated.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">As long as the NSSI remains constant, the cross-dependent state (such as
addresses in a host that depend on a prefix in a router) can remain stable,
meaning less checks in the receiver.  Any change in the value of the NSSI is
an indication that the sender updated some state and that the dependent state
in the receiver should be reassessed (e.g., addresses that were formed based
on an RA with a previous NSSI should be checked, or new addresses may be
formed and registered).<a href="#section-10-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deploy">
<section id="section-11">
      <h2 id="name-operational-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-11-1">With this specification, a RPL DODAG forms a realm, and multiple RPL
  DODAGs may be federated in a single RPL Instance administratively. This
  means that a multicast address that needs to span a RPL DODAG
  <span class="bcp14">MUST</span> use a scope of Realm-Local whereas a multicast address
  that needs to span a RPL Instance <span class="bcp14">MUST</span> use a scope of
  Admin-Local as discussed in <span><a href="https://rfc-editor.org/rfc/rfc7346#section-3" class="relref">Section 3</a> of [<a href="#RFC7346" class="cite xref">RFC7346</a>]</span>, "IPv6 Multicast Address Scopes".<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">"IPv6 Addressing of IPv4/IPv6 Translators" <span>[<a href="#RFC6052" class="cite xref">RFC6052</a>]</span>
  enables embedding IPv4 addresses in IPv6 addresses. The Root of a DODAG may
  leverage that technique to translate IPv4 traffic in IPv6 and route along
  the RPL domain. When encapsulating a packet with an IPv4 multicast
  Destination Address, it <span class="bcp14">MUST</span> use a multicast address with the
  appropriate scope, Realm-Local or Admin-Local.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">"Unicast-Prefix-based IPv6 Multicast Addresses" <span>[<a href="#RFC3306" class="cite xref">RFC3306</a>]</span>
  enables forming 2<sup>32</sup> multicast addresses from a single /64 prefix.
  If an IPv6 prefix is associated to an Instance or a RPL DODAG, this provides
  a namespace that can be used in any desired fashion. For instance, it is
  possible for a standard defining organization to form its own registry and
  allocate 32-bit values from that namespace to network functions or device
  types. When used within a RPL deployment that is associated with a /64
  prefix, the IPv6 multicast addresses can be automatically derived from the
  prefix and the 32-bit value for either a Realm-Local or an Admin-Local
  multicast address as needed in the configuration.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">This specification introduces the new RPL MOP 5.  Operationally speaking,
  deploying a new RPL MOP means that one cannot update a live network. The
  network administrator must create a new instance with MOP 5 and migrate
  nodes to that instance by allowing them to join it.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">In a "green field" deployment where all nodes support this specification,
  it is possible to deploy a single RPL Instance using a multicast MOP for
  unicast, multicast, and anycast addresses.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">In a "brown field" where legacy devices that do not support this
  specification coexist with upgraded devices, it is
  <span class="bcp14">RECOMMENDED</span> to deploy one RPL Instance in any MOP
  (typically MOP 1) for unicast that legacy nodes can join and a
  separate RPL Instance dedicated to multicast and anycast operations using a
  multicast MOP.<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">To deploy a Storing mode multicast operation using MOP 3 in a RPL domain,
  it is required that the RPL routers that support MOP 3 have enough density
  to build a DODAG that covers all the potential listeners and includes the
  spanning multicast trees that are needed to distribute the multicast flows.
  This might not be the case when extending the capabilities of an existing
  network.<a href="#section-11-7" class="pilcrow">¶</a></p>
<p id="section-11-8">In the case of the new Non-Storing multicast MOP, arguably the new
  support is only needed at the 6LRs that will accept multicast listeners. It
  is still required that each listener be able to reach at least one such 6LR, so the
  upgraded 6LRs must be deployed to cover all the 6LNs that need multicast
  services.<a href="#section-11-8" class="pilcrow">¶</a></p>
<p id="section-11-9">Using separate RPL Instances for unicast traffic on the one hand and for
  anycast and multicast traffic on the other hand allows for the use of different
  objective functions; one favors the link quality Up for unicast collection
  and the other favors Downwards link quality for multicast distribution.<a href="#section-11-9" class="pilcrow">¶</a></p>
<p id="section-11-10">However, this might be impractical in some use cases where the signaling and
  the state to be installed in the devices are very constrained, the upgraded
  devices are too sparse, or the devices do not support more multiple
  instances.<a href="#section-11-10" class="pilcrow">¶</a></p>
<p id="section-11-11">When using a single RPL Instance, MOP 3 expects the Storing Mode of
  Operation for both unicast and multicast, which is an issue in constrained
  networks that typically use MOP 1 for unicast. This specification allows a
  mixed mode that is signaled as MOP 1 in the DIO messages for backward
  compatibility, where limited multicast and/or anycast is available, under
  the following conditions:<a href="#section-11-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-12.1">There <span class="bcp14">MUST</span> be enough density of the 6LRs that support the
    mixed mode to cover all the 6LNs that require multicast or anycast
    services.  In Storing mode, there <span class="bcp14">MUST</span> be enough density of
    the 6LRs that support the mixed mode to also form a DODAG to the Root.<a href="#section-11-12.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-12.2">The RPL routers that support the mixed mode are configured to operate
    in accordance with the desired operation in the network.<a href="#section-11-12.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-12.3">The MOP signaled in the RPL DIO messages is MOP 1 to enable the legacy
    nodes to operate as leaves.<a href="#section-11-12.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-12.4">The support of multicast and/or anycast in the RPL Instance
    <span class="bcp14">SHOULD</span> be signaled by the 6LRs to the 6LN using a 6CIO; see
    <a href="#CIO" class="auto internal xref">Section 5</a>.<a href="#section-11-12.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-12.5">Alternatively, the support of multicast in the RPL domain can be
    globally known by other means including configuration or external information such as  
    support of a version of an industry standard that mandates it. In
    that case, all the routers <span class="bcp14">MUST</span> support the mixed mode.<a href="#section-11-12.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="sec">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">This specification Extends <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> and <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span> and leverages <span>[<a href="#RFC9008" class="cite xref">RFC9008</a>]</span>.  The security
  sections in these documents also apply to this document.  In particular, the
  link layer <span class="bcp14">SHOULD</span> be sufficiently protected to prevent rogue
  access.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2"><span><a href="#RFC6550" class="internal xref">RPL</a> [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span> already supports routing on multicast
  addresses, whereby the endpoint that subscribes to the group by injecting 
  the multicast address participates as a RPL-Aware Node (RAN) in the RPL.
  Using an extension of <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> as opposed to RPL to
  subscribe the address allows a RPL-Unaware Leaf (RUL) to subscribe as well.
  As noted in <span>[<a href="#RFC9010" class="cite xref">RFC9010</a>]</span>, this provides a better security
  posture for the RPL network, since the nodes that do not really need to
  speak RPL, or are not trusted enough to inject RPL messages, can be
  forbidden from doing so, which bars a number of attack vectors from within
  RPL. Acting as an RUL, those nodes may still leverage the RPL network through
  the capabilities that are opened via ND operations. With this specification, a node
  that needs multicast delivery can now obtain the service in a RPL domain
  while not being allowed to inject RPL messages.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">Compared to <span>[<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>, this specification enables tracking the
  origin of the multicast subscription inside the RPL network.  This is a
  first step to enable a form of Route Ownership Validation (ROV) (see <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>) in RPL using the ROVR field in the EARO as proof of
  ownership.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4"><a href="#sec8928" class="auto internal xref">Section 9</a> leverages <span>[<a href="#RFC8928" class="cite xref">RFC8928</a>]</span> to prevent a
  rogue node from registering a unicast address that it does not own.  The
  mechanism could be extended to anycast and multicast addresses if the values
  of the ROVR they use are known in advance, but how this is done is not in
  scope for this specification.  One way would be to authorize the
  ROVR of the valid users in advance.  A less preferred way would be to synchronize the
  ROVR and TID values across the valid subscribers as preshared key
  material.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">In the latter case, it could be possible to update the keys associated to
  an address in all the 6LNs, but the flow is not clearly documented and may
  not complete in due time for all nodes in LLN use cases. It may be simpler
  to install an all-new address with new keys over a period of time, and
  switch the traffic to that address when the migration is complete.<a href="#section-12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="back">
<section id="section-13">
      <h2 id="name-backward-compatibility">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-backward-compatibility" class="section-name selfRef">Backward Compatibility</a>
      </h2>
<p id="section-13-1">A legacy 6LN will not subscribe multicast addresses, and the service will
  be the same when the network is upgraded. A legacy 6LR will not set the X
  flag in the 6CIO, and an upgraded 6LN will not subscribe multicast
  addresses.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Upon receiving an EDAR message, a legacy 6LBR may not realize that the address
  being registered is anycast or multicast and will return that it is a duplicate in
  the EDAC status. The 6LR <span class="bcp14">MUST</span> ignore a duplicate status in
  the EDAC for anycast and multicast addresses.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">As detailed in <a href="#deploy" class="auto internal xref">Section 11</a>, it is possible to add multicast on
  an existing MOP 1 deployment.<a href="#section-13-3" class="pilcrow">¶</a></p>
<p id="section-13-4">The combination of a multicast address and the P-Field set to 0 in an RTO
  in a MOP 3 RPL Instance is an indication to the receiver that supports this
  specification (the parent) that the sender (child) does not support this specification.
  However, the RTO is accepted and processed as if the P-Field was set to 1 for backward compatibility.<a href="#section-13-4" class="pilcrow">¶</a></p>
<p id="section-13-5">When the DODAG is operated in MOP 3, a legacy node will not set the P-Field
  and still expect multicast service as specified in <span><a href="https://rfc-editor.org/rfc/rfc6550#section-12" class="relref">Section 12</a> of [<a href="#RFC6550" class="cite xref">RFC6550</a>]</span>.  In MOP 3, an RTO that is received with a
  target that is multicast and the P-Field set to 0 <span class="bcp14">MUST</span> be
  considered as multicast and <span class="bcp14">MUST</span> be processed as if the P-Field
  is set to 1.<a href="#section-13-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">IANA has made changes under the "Internet Control Message
  Protocol version 6 (ICMPv6) Parameters" <span>[<a href="#IANA.ICMP" class="cite xref">IANA.ICMP</a>]</span> and
  "Routing Protocol for Low Power and Lossy Networks (RPL)" <span>[<a href="#IANA.RPL" class="cite xref">IANA.RPL</a>]</span> registry groupings; see details in the subsections that follow.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="PF">
<section id="section-14.1">
        <h3 id="name-new-p-field-values-registry">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-new-p-field-values-registry" class="section-name selfRef">New P-Field Values Registry</a>
        </h3>
<p id="section-14.1-1">IANA has created a new "P-Field Values" registry under the
      "Internet Control Message Protocol version 6 (ICMPv6)
      Parameters" registry group to store the expression of the RATInd as a P-Field.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">The registration procedure is Standards Action <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial allocations are as indicated in <a href="#AM2" class="auto internal xref">Table 2</a>:<a href="#section-14.1-2" class="pilcrow">¶</a></p>
<span id="name-p-field-values-registry"></span><div id="AM2">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-p-field-values-registry" class="selfRef">P-Field Values Registry</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Registered Address Type Indicator</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Registration for a Unicast Address</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Registration for a Multicast Address</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Registration for an Anycast Address</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="EDAR_Message_Flags">
<section id="section-14.2">
        <h3 id="name-new-edar-message-flags-regi">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-new-edar-message-flags-regi" class="section-name selfRef">New EDAR Message Flags Registry</a>
        </h3>
<p id="section-14.2-1">IANA has created a new "EDAR Message Flags" registry under
      the "Internet Control Message Protocol version 6 (ICMPv6)
      Parameters" registry group.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">The registration procedure is IETF Review or IESG Approval <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. The initial allocations are as indicated in <a href="#EDARflags" class="auto internal xref">Table 3</a>:<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<span id="name-edar-message-flags-registry"></span><div id="EDARflags">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-edar-message-flags-registry" class="selfRef">EDAR Message Flags Registry</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Meaning</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0-1</td>
              <td class="text-left" rowspan="1" colspan="1">P-Field (2 bits)</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685, <a href="#PF" class="auto internal xref">Section 14.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-7</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<section id="section-14.3">
        <h3 id="name-new-address-registration-op">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-new-address-registration-op" class="section-name selfRef">New Address Registration Option Flags</a>
        </h3>
<p id="section-14.3-1">IANA has made an addition to the "Address Registration
      Option Flags" registry <span>[<a href="#IANA.ICMP.ARO.FLG" class="cite xref">IANA.ICMP.ARO.FLG</a>]</span> under the
      "Internet Control Message Protocol version 6 (ICMPv6)
      Parameters" registry group as indicated in <a href="#AROflags" class="auto internal xref">Table 4</a>:<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<span id="name-new-address-registration-opt"></span><div id="AROflags">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-new-address-registration-opt" class="selfRef">New Address Registration Option Flags</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-3</td>
              <td class="text-left" rowspan="1" colspan="1">P-Field (2 bits)</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685, <a href="#PF" class="auto internal xref">Section 14.1</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-14.4">
        <h3 id="name-new-rpl-target-option-flags">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-new-rpl-target-option-flags" class="section-name selfRef">New RPL Target Option Flags</a>
        </h3>
<p id="section-14.4-1">IANA has made an addition to the "RPL Target Option Flags"
      registry <span>[<a href="#IANA.RPL.RTO.FLG" class="cite xref">IANA.RPL.RTO.FLG</a>]</span> under the "Routing
      Protocol for Low Power and Lossy Networks (RPL)" registry group as indicated in <a href="#RTOflags" class="auto internal xref">Table 5</a>:<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<span id="name-new-rpl-target-option-flags-2"></span><div id="RTOflags">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-new-rpl-target-option-flags-2" class="selfRef">New RPL Target Option Flags</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit Number</td>
              <td class="text-left" rowspan="1" colspan="1">Capability Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-3</td>
              <td class="text-left" rowspan="1" colspan="1">P-Field (2 bits)</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685, <a href="#PF" class="auto internal xref">Section 14.1</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<div id="RPL_Mode_Op">
<section id="section-14.5">
        <h3 id="name-new-rpl-mode-of-operation">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-new-rpl-mode-of-operation" class="section-name selfRef">New RPL Mode of Operation</a>
        </h3>
<p id="section-14.5-1">IANA has made an addition to the "Mode of Operation"
    registry <span>[<a href="#IANA.RPL.MOP" class="cite xref">IANA.RPL.MOP</a>]</span> under the "Routing Protocol for
    Low Power and Lossy Networks (RPL)" registry group as indicated in <a href="#RMOP" class="auto internal xref">Table 6</a>:<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<span id="name-new-rpl-mode-of-operation-2"></span><div id="RMOP">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-new-rpl-mode-of-operation-2" class="selfRef">New RPL Mode of Operation</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Non-Storing Mode of Operation with ingress
 replication multicast support</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="New_Cap_Bits">
<section id="section-14.6">
        <h3 id="name-new-6lowpan-capability-bit">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-new-6lowpan-capability-bit" class="section-name selfRef">New 6LoWPAN Capability Bit</a>
        </h3>
<p id="section-14.6-1">IANA has made an addition to the "6LoWPAN Capability
      Bits" registry <span>[<a href="#IANA.ICMP.6CIO" class="cite xref">IANA.ICMP.6CIO</a>]</span> under the 
      "Internet Control Message Protocol version 6 (ICMPv6) Parameters" registry group as
      indicated in <a href="#CIOdat" class="auto internal xref">Table 7</a>:<a href="#section-14.6-1" class="pilcrow">¶</a></p>
<span id="name-new-6lowpan-capability-bit-2"></span><div id="CIOdat">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-new-6lowpan-capability-bit-2" class="selfRef">New 6LoWPAN Capability Bit</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Bit</td>
              <td class="text-left" rowspan="1" colspan="1">Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">X flag: Registration for Unicast, Multicast, and Anycast Addresses Supported</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<section id="section-14.7">
        <h3 id="name-new-address-registration-opti">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-new-address-registration-opti" class="section-name selfRef">New Address Registration Option Status Values</a>
        </h3>
<p id="section-14.7-1">IANA has made additions to the "Address Registration
      Option Status Values" registry <span>[<a href="#IANA.ICMP.ARO.STAT" class="cite xref">IANA.ICMP.ARO.STAT</a>]</span> under
      the "Internet Control Message Protocol version 6 (ICMPv6)
      Parameters" registry group as indicated in <a href="#AROstat" class="auto internal xref">Table 8</a>:<a href="#section-14.7-1" class="pilcrow">¶</a></p>
<span id="name-new-address-registration-optio"></span><div id="AROstat">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-new-address-registration-optio" class="selfRef">New Address Registration Option Status Values</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Value</td>
              <td class="text-left" rowspan="1" colspan="1">Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">Registration Refresh Request</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">Invalid Registration</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-14.8">
        <h3 id="name-new-ipv6-neighbor-discovery">
<a href="#section-14.8" class="section-number selfRef">14.8. </a><a href="#name-new-ipv6-neighbor-discovery" class="section-name selfRef">New IPv6 Neighbor Discovery Option Format</a>
        </h3>
<p id="section-14.8-1">IANA has made an addition to the "IPv6 Neighbor Discovery
 Option Formats" registry under the "Internet Control Message
 Protocol version 6 (ICMPv6) Parameters" registry group as indicated in <a href="#NDOpt" class="auto internal xref">Table 9</a>:<a href="#section-14.8-1" class="pilcrow">¶</a></p>
<span id="name-new-ipv6-neighbor-discovery-"></span><div id="NDOpt">
<table class="center" id="table-9">
          <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-new-ipv6-neighbor-discovery-" class="selfRef">New IPv6 Neighbor Discovery Option Format</a>
          </caption>
<thead>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Type</td>
              <td class="text-left" rowspan="1" colspan="1">Description</td>
              <td class="text-left" rowspan="1" colspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">42</td>
              <td class="text-left" rowspan="1" colspan="1">Consistent Uptime Option</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9685</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</section>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA.ICMP">[IANA.ICMP]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Internet Control Message Protocol version 6 (ICMPv6) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters">https://www.iana.org/assignments/icmpv6-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.ICMP.6CIO">[IANA.ICMP.6CIO]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"6LoWPAN Capability Bits"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters">https://www.iana.org/assignments/icmpv6-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.ICMP.ARO.FLG">[IANA.ICMP.ARO.FLG]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Address Registration Option Flags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters">https://www.iana.org/assignments/icmpv6-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.ICMP.ARO.STAT">[IANA.ICMP.ARO.STAT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Address Registration Option Status Values"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters">https://www.iana.org/assignments/icmpv6-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.RPL">[IANA.RPL]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Routing Protocol for Low Power and Lossy Networks (RPL)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/rpl">https://www.iana.org/assignments/rpl</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.RPL.MOP">[IANA.RPL.MOP]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Mode of Operation"</span>, <span>&lt;<a href="https://www.iana.org/assignments/rpl">https://www.iana.org/assignments/rpl</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.RPL.RTO.FLG">[IANA.RPL.RTO.FLG]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"RPL Target Option Flags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/rpl">https://www.iana.org/assignments/rpl</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3306">[RFC3306]</dt>
        <dd>
<span class="refAuthor">Haberman, B.</span> and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Unicast-Prefix-based IPv6 Multicast Addresses"</span>, <span class="seriesInfo">RFC 3306</span>, <span class="seriesInfo">DOI 10.17487/RFC3306</span>, <time datetime="2002-08" class="refDate">August 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3306">https://www.rfc-editor.org/info/rfc3306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
        <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
        <dd>
<span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7346">[RFC7346]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"IPv6 Multicast Address Scopes"</span>, <span class="seriesInfo">RFC 7346</span>, <span class="seriesInfo">DOI 10.17487/RFC7346</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7346">https://www.rfc-editor.org/info/rfc7346</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7400">[RFC7400]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 7400</span>, <span class="seriesInfo">DOI 10.17487/RFC7400</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7400">https://www.rfc-editor.org/info/rfc7400</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8928">[RFC8928]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Sarikaya, B.</span>, <span class="refAuthor">Sethi, M.</span>, and <span class="refAuthor">R. Struik</span>, <span class="refTitle">"Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 8928</span>, <span class="seriesInfo">DOI 10.17487/RFC8928</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8928">https://www.rfc-editor.org/info/rfc8928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9010">[RFC9010]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves"</span>, <span class="seriesInfo">RFC 9010</span>, <span class="seriesInfo">DOI 10.17487/RFC9010</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9010">https://www.rfc-editor.org/info/rfc9010</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9030">[RFC9030]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refTitle">"An Architecture for IPv6 over the Time-Slotted Channel Hopping Mode of IEEE 802.15.4 (6TiSCH)"</span>, <span class="seriesInfo">RFC 9030</span>, <span class="seriesInfo">DOI 10.17487/RFC9030</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9030">https://www.rfc-editor.org/info/rfc9030</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IEEE80211">[IEEE-802.11]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Information Technology--Telecommunications and Information Exchange between Systems - Local and Metropolitan Area Networks--Specific Requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications"</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2021.9363693</span>, <span class="seriesInfo">IEEE Std 802.11-2020</span>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/9363693">https://ieeexplore.ieee.org/document/9363693</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE802151">[IEEE-802.15.1]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Information technology - Local and metropolitan area networks - Specific requirements - Part 15.1a: Wireless Medium Access Control (MAC) and Physical Layer (PHY) specifications for Wireless Personal Area Networks (WPAN)"</span>, <span class="seriesInfo">IEEE Std 802.15.1-2005</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2005.96290</span>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/1490827">https://ieeexplore.ieee.org/document/1490827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE802154">[IEEE-802.15.4]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Low-Rate Wireless Networks"</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2020.9144691</span>, <span class="seriesInfo">IEEE Std 802.15.4-2020</span>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/9144691">https://ieeexplore.ieee.org/document/9144691</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-6man-ipv6-over-wireless">[IPv6-OVER-WIRELESS]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Architecture and Framework for IPv6 over Non-Broadcast Access"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6man-ipv6-over-wireless-06</span>, <time datetime="2024-05-23" class="refDate">23 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-6man-ipv6-over-wireless-06">https://datatracker.ietf.org/doc/html/draft-ietf-6man-ipv6-over-wireless-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thubert-bess-secure-evpn-mac-signaling">[MAC-SIGNALING]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Przygienda, T.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"Secure EVPN MAC Signaling"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thubert-bess-secure-evpn-mac-signaling-04</span>, <time datetime="2023-09-13" class="refDate">13 September 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-thubert-bess-secure-evpn-mac-signaling-04">https://datatracker.ietf.org/doc/html/draft-thubert-bess-secure-evpn-mac-signaling-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-6lo-prefix-registration">[REGISTRATION]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refTitle">"IPv6 Neighbor Discovery Prefix Registration"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6lo-prefix-registration-06</span>, <time datetime="2024-11-09" class="refDate">9 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-6lo-prefix-registration-06">https://datatracker.ietf.org/doc/html/draft-ietf-6lo-prefix-registration-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
        <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4919">[RFC4919]</dt>
        <dd>
<span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6052">[RFC6052]</dt>
        <dd>
<span class="refAuthor">Bao, C.</span>, <span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Boucadair, M.</span>, and <span class="refAuthor">X. Li</span>, <span class="refTitle">"IPv6 Addressing of IPv4/IPv6 Translators"</span>, <span class="seriesInfo">RFC 6052</span>, <span class="seriesInfo">DOI 10.17487/RFC6052</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6052">https://www.rfc-editor.org/info/rfc6052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
        <dd>
<span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7731">[RFC7731]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span> and <span class="refAuthor">R. Kelsey</span>, <span class="refTitle">"Multicast Protocol for Low-Power and Lossy Networks (MPL)"</span>, <span class="seriesInfo">RFC 7731</span>, <span class="seriesInfo">DOI 10.17487/RFC7731</span>, <time datetime="2016-02" class="refDate">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7731">https://www.rfc-editor.org/info/rfc7731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7761">[RFC7761]</dt>
        <dd>
<span class="refAuthor">Fenner, B.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Holbrook, H.</span>, <span class="refAuthor">Kouvelas, I.</span>, <span class="refAuthor">Parekh, R.</span>, <span class="refAuthor">Zhang, Z.</span>, and <span class="refAuthor">L. Zheng</span>, <span class="refTitle">"Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)"</span>, <span class="seriesInfo">STD 83</span>, <span class="seriesInfo">RFC 7761</span>, <span class="seriesInfo">DOI 10.17487/RFC7761</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7761">https://www.rfc-editor.org/info/rfc7761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8929">[RFC8929]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Perkins, C.E.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9008">[RFC9008]</dt>
        <dd>
<span class="refAuthor">Robles, M.I.</span>, <span class="refAuthor">Richardson, M.</span>, and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane"</span>, <span class="seriesInfo">RFC 9008</span>, <span class="seriesInfo">DOI 10.17487/RFC9008</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9008">https://www.rfc-editor.org/info/rfc9008</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9574">[RFC9574]</dt>
        <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Sathappan, S.</span>, <span class="refAuthor">Lin, W.</span>, <span class="refAuthor">Katiyar, M.</span>, and <span class="refAuthor">A. Sajassi</span>, <span class="refTitle">"Optimized Ingress Replication Solution for Ethernet VPNs (EVPNs)"</span>, <span class="seriesInfo">RFC 9574</span>, <span class="seriesInfo">DOI 10.17487/RFC9574</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9574">https://www.rfc-editor.org/info/rfc9574</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rift-rift">[RIFT]</dt>
        <dd>
<span class="refAuthor">Przygienda, A., Ed.</span>, <span class="refAuthor">Head, J., Ed.</span>, <span class="refAuthor">Sharma, A.</span>, <span class="refAuthor">Thubert, P.</span>, <span class="refAuthor">Rijsman, B.</span>, and <span class="refAuthor">D. Afanasiev</span>, <span class="refTitle">"RIFT: Routing in Fat Trees"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rift-rift-24</span>, <time datetime="2024-05-23" class="refDate">23 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rift-rift-24">https://datatracker.ietf.org/doc/html/draft-ietf-rift-rift-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.kuehlewind-rswg-updates-tag">[UPDATES-TAG]</dt>
        <dd>
<span class="refAuthor">Kühlewind, M.</span> and <span class="refAuthor">S. Krishnan</span>, <span class="refTitle">"Definition of new tags for relations between RFCs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kuehlewind-rswg-updates-tag-02</span>, <time datetime="2024-07-08" class="refDate">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kuehlewind-rswg-updates-tag-02">https://datatracker.ietf.org/doc/html/draft-kuehlewind-rswg-updates-tag-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.heile-lpwan-wisun-overview">[Wi-SUN]</dt>
      <dd>
<span class="refAuthor">Robert, H.</span>, <span class="refAuthor">Liu, B.</span>, <span class="refAuthor">Zhang, M.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Wi-SUN FAN Overview"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-heile-lpwan-wisun-overview-00</span>, <time datetime="2017-07-03" class="refDate">3 July 2017</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-heile-lpwan-wisun-overview-00">https://datatracker.ietf.org/doc/html/draft-heile-lpwan-wisun-overview-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">This work is a production of an effective collaboration between the IETF
  6lo WG and the Wi-Sun FAN WG. Thanks to all in both WGs who contributed
  reviews and productive suggestions, in particular: <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Paul Duffy, Klaus   Hueske</span>, <span class="contact-name">Adnan Rashid</span>, <span class="contact-name">Rahul   Jadhav</span>, <span class="contact-name">Gene Falendysz</span>, <span class="contact-name">Don   Sturek</span>, <span class="contact-name">Dario Tedeschi</span>, <span class="contact-name">Saurabh   Jain</span>, <span class="contact-name">and Chris Hett</span>, with special thanks to
  <span class="contact-name">Esko Dijk</span> for his useful WGLC reviews and proposed
  changes. Also many thanks to <span class="contact-name">Éric Vyncke</span>, <span class="contact-name">Sandy Ginoza</span>, <span class="contact-name">Zaheduzzaman Sarker</span>,
  <span class="contact-name">Paul Wouters</span>, <span class="contact-name">Roman Danyliw</span>,
  <span class="contact-name">John Scudder</span>, <span class="contact-name">Dirk Von Hugo</span>,
  <span class="contact-name">Murray Kucherawy</span>, <span class="contact-name">Kyle Rose</span>,
  <span class="contact-name">Scott Kelly</span>, and <span class="contact-name">Dan Romascanu</span>
  for their suggestions and comments during the IETF last call and IESG review
  cycle.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left">
<span class="postal-code">06330</span> <span class="locality">Roquefort-les-Pins</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pascal.thubert@gmail.com" class="email">pascal.thubert@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
