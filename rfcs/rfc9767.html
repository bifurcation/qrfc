<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9767: Grant Negotiation and Authorization Protocol Resource Server Connections</title>
<meta content="Justin Richer" name="author">
<meta content="Fabien Imbault" name="author">
<meta content="
       The Grant Negotiation and Authorization Protocol (GNAP) defines a mechanism for delegating authorization to a piece of
software (the client) and conveying the results and artifacts of that delegation
to the software. This extension defines methods for resource servers (RSs) to connect with authorization servers (ASs) in an interoperable fashion. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="9767" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9767.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-gnap-resource-servers-09" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9767" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9767</td>
<td class="center">GNAP RS Connections</td>
<td class="right">April 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Richer &amp; Imbault</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9767" class="eref">9767</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-04" class="published">April 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Richer, <span class="editor">Ed.</span>
</div>
<div class="org">Bespoke Engineering</div>
</div>
<div class="author">
      <div class="author-name">F. Imbault</div>
<div class="org">acert.io</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9767</h1>
<h1 id="title">Grant Negotiation and Authorization Protocol Resource Server Connections</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Grant Negotiation and Authorization Protocol (GNAP) defines a mechanism for delegating authorization to a piece of
software (the client) and conveying the results and artifacts of that delegation
to the software. This extension defines methods for resource servers (RSs) to connect with authorization servers (ASs) in an interoperable fashion.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9767">https://www.rfc-editor.org/info/rfc9767</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-access-tokens" class="internal xref">Access Tokens</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-general-purpose-access-toke" class="internal xref">General-Purpose Access Token Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-value" class="internal xref">Value</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-issuer" class="internal xref">Issuer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref">2.1.3</a>.  <a href="#name-audience" class="internal xref">Audience</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="auto internal xref">2.1.4</a>.  <a href="#name-key-binding" class="internal xref">Key Binding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.5">
                    <p id="section-toc.1-1.2.2.1.2.5.1"><a href="#section-2.1.5" class="auto internal xref">2.1.5</a>.  <a href="#name-flags" class="internal xref">Flags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.6">
                    <p id="section-toc.1-1.2.2.1.2.6.1"><a href="#section-2.1.6" class="auto internal xref">2.1.6</a>.  <a href="#name-access-rights" class="internal xref">Access Rights</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.7">
                    <p id="section-toc.1-1.2.2.1.2.7.1"><a href="#section-2.1.7" class="auto internal xref">2.1.7</a>.  <a href="#name-time-validity-window" class="internal xref">Time Validity Window</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.8">
                    <p id="section-toc.1-1.2.2.1.2.8.1"><a href="#section-2.1.8" class="auto internal xref">2.1.8</a>.  <a href="#name-token-identifier" class="internal xref">Token Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.9">
                    <p id="section-toc.1-1.2.2.1.2.9.1"><a href="#section-2.1.9" class="auto internal xref">2.1.9</a>.  <a href="#name-authorizing-resource-owner" class="internal xref">Authorizing Resource Owner</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.10">
                    <p id="section-toc.1-1.2.2.1.2.10.1"><a href="#section-2.1.10" class="auto internal xref">2.1.10</a>. <a href="#name-end-user" class="internal xref">End User</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.11">
                    <p id="section-toc.1-1.2.2.1.2.11.1"><a href="#section-2.1.11" class="auto internal xref">2.1.11</a>. <a href="#name-client-instance" class="internal xref">Client Instance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.12">
                    <p id="section-toc.1-1.2.2.1.2.12.1"><a href="#section-2.1.12" class="auto internal xref">2.1.12</a>. <a href="#name-label" class="internal xref">Label</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.13">
                    <p id="section-toc.1-1.2.2.1.2.13.1"><a href="#section-2.1.13" class="auto internal xref">2.1.13</a>. <a href="#name-parent-grant-request" class="internal xref">Parent Grant Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.14">
                    <p id="section-toc.1-1.2.2.1.2.14.1"><a href="#section-2.1.14" class="auto internal xref">2.1.14</a>. <a href="#name-as-specific-access-tokens" class="internal xref">AS-Specific Access Tokens</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-access-token-formats" class="internal xref">Access Token Formats</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-resource-server-facing-api" class="internal xref">Resource-Server-Facing API</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-rs-facing-as-discovery" class="internal xref">RS-Facing AS Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-protecting-rs-requests-to-t" class="internal xref">Protecting RS Requests to the AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-token-introspection" class="internal xref">Token Introspection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-registering-a-resource-set" class="internal xref">Registering a Resource Set</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-error-responses" class="internal xref">Error Responses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-deriving-a-downstream-token" class="internal xref">Deriving a Downstream Token</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-well-known-uris" class="internal xref">Well-Known URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-gnap-grant-request-paramete" class="internal xref">GNAP Grant Request Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-gnap-token-formats" class="internal xref">GNAP Token Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-registry-template" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-initial-registry-contents" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-gnap-token-introspection-re" class="internal xref">GNAP Token Introspection Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-registry-template-2" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-initial-registry-contents-2" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-gnap-token-introspection-res" class="internal xref">GNAP Token Introspection Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="auto internal xref">5.5.1</a>.  <a href="#name-registry-template-3" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="auto internal xref">5.5.2</a>.  <a href="#name-initial-registry-contents-3" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-gnap-resource-set-registrat" class="internal xref">GNAP Resource Set Registration Request Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="auto internal xref">5.6.1</a>.  <a href="#name-registry-template-4" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a href="#section-5.6.2" class="auto internal xref">5.6.2</a>.  <a href="#name-initial-registry-contents-4" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="auto internal xref">5.7</a>.  <a href="#name-gnap-resource-set-registrati" class="internal xref">GNAP Resource Set Registration Response Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7.2.1">
                    <p id="section-toc.1-1.5.2.7.2.1.1"><a href="#section-5.7.1" class="auto internal xref">5.7.1</a>.  <a href="#name-registry-template-5" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7.2.2">
                    <p id="section-toc.1-1.5.2.7.2.2.1"><a href="#section-5.7.2" class="auto internal xref">5.7.2</a>.  <a href="#name-initial-registry-contents-5" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="auto internal xref">5.8</a>.  <a href="#name-gnap-rs-facing-discovery-do" class="internal xref">GNAP RS-Facing Discovery Document Fields</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8.2.1">
                    <p id="section-toc.1-1.5.2.8.2.1.1"><a href="#section-5.8.1" class="auto internal xref">5.8.1</a>.  <a href="#name-registry-template-6" class="internal xref">Registry Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8.2.2">
                    <p id="section-toc.1-1.5.2.8.2.2.1"><a href="#section-5.8.2" class="auto internal xref">5.8.2</a>.  <a href="#name-initial-registry-contents-6" class="internal xref">Initial Registry Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="auto internal xref">5.9</a>.  <a href="#name-gnap-rs-facing-error-codes" class="internal xref">GNAP RS-Facing Error Codes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9.2.1">
                    <p id="section-toc.1-1.5.2.9.2.1.1"><a href="#section-5.9.1" class="auto internal xref">5.9.1</a>.  <a href="#name-registration-template" class="internal xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9.2.2">
                    <p id="section-toc.1-1.5.2.9.2.2.1"><a href="#section-5.9.2" class="auto internal xref">5.9.2</a>.  <a href="#name-initial-contents" class="internal xref">Initial Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-tls-protection-in-transit" class="internal xref">TLS Protection in Transit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-token-validation" class="internal xref">Token Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-caching-token-validation-re" class="internal xref">Caching Token Validation Result</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-key-proof-validation" class="internal xref">Key Proof Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-token-exfiltration" class="internal xref">Token Exfiltration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-token-reuse-by-an-rs" class="internal xref">Token Reuse by an RS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-token-format-considerations" class="internal xref">Token Format Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-oversharing-token-contents" class="internal xref">Oversharing Token Contents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-resource-references" class="internal xref">Resource References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a href="#section-6.10" class="auto internal xref">6.10</a>. <a href="#name-token-reissuance-from-an-un" class="internal xref">Token Reissuance from an Untrusted AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.11">
                <p id="section-toc.1-1.6.2.11.1"><a href="#section-6.11" class="auto internal xref">6.11</a>. <a href="#name-introspection-of-token-keys" class="internal xref">Introspection of Token Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.12">
                <p id="section-toc.1-1.6.2.12.1"><a href="#section-6.12" class="auto internal xref">6.12</a>. <a href="#name-rs-registration-and-managem" class="internal xref">RS Registration and Management</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-token-contents" class="internal xref">Token Contents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-token-use-disclosure-throug" class="internal xref">Token Use Disclosure through Introspection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-mapping-a-user-to-an-as" class="internal xref">Mapping a User to an AS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The core GNAP specification <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span> defines distinct roles for the authorization
server (AS) and the resource server (RS). However, the core specification
does not define how the RS gets answers to important questions, such as whether
a given access token is still valid or what set of access rights the access
token is approved for.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">While it's possible for the AS and RS to be tightly coupled, such as a single
deployed server with a shared storage system, GNAP does not presume or require
such a tight coupling. It is increasingly common for the AS and RS to be run
and managed separately, particularly in cases where a single AS protects multiple
RSs simultaneously.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This specification defines a set of RS-facing APIs that an AS can make
available for advanced loosely coupled deployments. Additionally, this document
defines a general-purpose model for access tokens, which can be used in
structured, formatted access tokens or in token introspection responses.
This specification also defines a method
for an RS to derive a downstream token for calling another chained RS.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The means for the authorization server to issue the
access token to the client instance and the means for the client instance
to present the access token to the resource server are subjects of the
core GNAP specification <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document contains non-normative examples of partial and complete HTTP messages, JSON structures, URLs, query components, keys, and other elements. Some examples use a single trailing backslash <code>\</code> to indicate line wrapping for long values, as per <span>[<a href="#RFC8792" class="cite xref">RFC8792</a>]</span>. The <code>\</code> character and leading spaces on wrapped lines are not part of the value.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Terminology specific to GNAP is defined in the terminology
        section of the core specification; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-1.1" class="relref">Section 1.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. The following protocol roles are defined:
        authorization server, client, end user, resource owner, and resource server. The following protocol
        elements are defined: access token, attribute, grant,
        privilege, protected resource, right, subject, and subject
        information. The same definitions are used in this
        document.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="structure">
<section id="section-2">
      <h2 id="name-access-tokens">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-access-tokens" class="section-name selfRef">Access Tokens</a>
      </h2>
<p id="section-2-1">Access tokens are used as a mechanism for an AS to provide a
      client instance limited access to an RS.  These access tokens
      are artifacts representing a particular set of access rights
      granted to the client instance to act on behalf of the RO. While
      the format of access tokens varies in different systems (see
      discussion in <a href="#token-format" class="auto internal xref">Section 2.2</a>), the concept of an
      access token is consistent across all GNAP systems.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="general-purpose-access-token-model">
<section id="section-2.1">
        <h3 id="name-general-purpose-access-toke">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-general-purpose-access-toke" class="section-name selfRef">General-Purpose Access Token Model</a>
        </h3>
<p id="section-2.1-1">The core GNAP specification <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>
        focuses on the relationship between the client and the
        AS. Since the access token is opaque to the client, the core
        specification does not define a token model. However, the AS
        will need to create tokens, and the RS will need to understand
        tokens. To facilitate a level of structural interoperability,
        a common access token model is presented here.  Access tokens
        represent a common set of aspects across different GNAP
        deployments. This list is not intended to be universal or
        comprehensive but rather serves as guidance to implementers in
        developing data structures and associated systems across a
        GNAP deployment. These data structures are communicated
        between the AS and RS by using either a structured token or an
        API-like mechanism such as token introspection (see <a href="#introspection" class="auto internal xref">Section 3.3</a>).<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">This general-purpose data model does not assume either
        approach; in fact, both approaches can be used together to
        convey different pieces of information. Where possible,
        mappings to the JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span>
        standard format are provided for each item in the model.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<div id="value">
<section id="section-2.1.1">
          <h4 id="name-value">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-value" class="section-name selfRef">Value</a>
          </h4>
<p id="section-2.1.1-1">All access tokens have a <em>value</em>, which is the string that is passed on the wire between parties.
In order for different access tokens to be differentiated at runtime, the value of a token needs to be unique
within a security domain (such as all systems controlled by an AS). Otherwise, two separate tokens would be confused for each other, which would lead to security issues.
The AS chooses the value, which can be structured (see <a href="#token-format" class="auto internal xref">Section 2.2</a>) or unstructured. When the token is
structured, the token value also has a <em>format</em> known to the AS and RS, and the other items
in this token model are contained within the token's value in some fashion.
When the token is unstructured, the values are usually retrieved by the RS using a service
   such as token introspection described in <a href="#introspection" class="auto internal xref">Section 3.3</a>.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">The access token value is conveyed in the <code>value</code> field of an <code>access_token</code> response; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1-3">The format and content of the access token value is opaque to the client software.
While the client software needs to be able to carry and present the access token
value, the client software is never expected nor intended to be able to understand
the token value itself.<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1.1-4">If structured tokens like those in <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> are used, the value of the token might not be stored by the AS. Instead,
a token identifier can be used along with protection by an AS-generated signature to validate and
identify an individual token.<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer">
<section id="section-2.1.2">
          <h4 id="name-issuer">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-issuer" class="section-name selfRef">Issuer</a>
          </h4>
<p id="section-2.1.2-1">The access token is issued by the AS as defined in <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. The AS will
need to identify itself in order to allow an RS to recognize tokens that the AS has issued, particularly
in cases where tokens from multiple different ASs could be presented to the same RS.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">This information is not usually conveyed directly to the client instance, since the client instance should know this information based on where it receives the token from.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">In the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response, this corresponds to the <code>iss</code> claim.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="audience">
<section id="section-2.1.3">
          <h4 id="name-audience">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-audience" class="section-name selfRef">Audience</a>
          </h4>
<p id="section-2.1.3-1">The access token is intended for use at one or more RSs. The AS can list a token's intended RSs to allow each RS to ensure that the RS is not receiving a token intended for someone else.
The AS and RS have to agree on the nature of any audience identifiers represented by the token,
but the URIs of the RS are a common pattern.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">In the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or token introspection response, this corresponds to the <code>aud</code> claim.<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.1.3-3">In cases where more complex access is required, the <code>location</code> field of objects in the <code>access</code>
array can also convey audience information.
In such cases, the client instance might need to know the audience information in order to differentiate between
possible RSs to present the token to.<a href="#section-2.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-binding">
<section id="section-2.1.4">
          <h4 id="name-key-binding">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-key-binding" class="section-name selfRef">Key Binding</a>
          </h4>
<p id="section-2.1.4-1">Access tokens in GNAP are bound to the client instance's registered or presented key, except in
cases where the access token is a bearer token. For all tokens bound to a key, the AS and RS need to
be able to identify which key the token is bound to; otherwise, an attacker could substitute their
own key during presentation of the token. In the case of an asymmetric algorithm, the
AS and RS need to know only the public key, while the client instance will also need to know the private
key in order to present the token. In the case of a symmetric algorithm, all parties
will need to either know or be able to derive the shared key.<a href="#section-2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-2.1.4-2">The source of this key information can vary depending on deployment decisions. For example, an AS
could decide that all tokens issued to a client instance are always bound to that client instance's current key.
When the key needs to be dereferenced, the AS looks up the client instance to which the token was issued
and finds the key information there. Alternatively, the AS could bind each token to a specific key that is managed separately from client instance
information. In such a case, the AS determines the key information directly. This approach allows the client
instance to use a different key for each request or allows the AS to issue a key for the client instance
to use with the particular token.<a href="#section-2.1.4-2" class="pilcrow">¶</a></p>
<p id="section-2.1.4-3">In all cases, the key binding also includes a proofing mechanism, along with any parameters needed for that
mechanism such as a signing or digest algorithm. If such information is not included with the proofing key, an attacker could
present a token with a seemingly valid key using an insecure and incorrect proofing mechanism.<a href="#section-2.1.4-3" class="pilcrow">¶</a></p>
<p id="section-2.1.4-4">This value is conveyed to the client instance in the <code>key</code> field of the <code>access_token</code> response in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
Since the common case is that the token is bound to the client instance's registered key, this field can be omitted in this case
since the client will be aware of its own key.<a href="#section-2.1.4-4" class="pilcrow">¶</a></p>
<p id="section-2.1.4-5">In the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span>, this corresponds to the <code>cnf</code> (confirmation) claim. In a token introspection response, this corresponds to the <code>key</code> claim.<a href="#section-2.1.4-5" class="pilcrow">¶</a></p>
<p id="section-2.1.4-6">In the case of a bearer token, all parties need to know that a token has no key bound to it and will therefore reject any attempts to use the bearer token with a key in an undefined way.<a href="#section-2.1.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flags">
<section id="section-2.1.5">
          <h4 id="name-flags">
<a href="#section-2.1.5" class="section-number selfRef">2.1.5. </a><a href="#name-flags" class="section-name selfRef">Flags</a>
          </h4>
<p id="section-2.1.5-1">GNAP access tokens can have multiple associated data
          flags that indicate special processing or considerations for
          a token. For example, the data flags can indicate whether
          a token is a bearer token or should be expected to be
          durable across grant updates.<a href="#section-2.1.5-1" class="pilcrow">¶</a></p>
<p id="section-2.1.5-2">The client can request a set of flags using the <code>flags</code> field of the <code>access_token</code> grant request parameter in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.5-2" class="pilcrow">¶</a></p>
<p id="section-2.1.5-3">These flags are conveyed from the AS to the client in the <code>flags</code> field of the <code>access_token</code> section of the grant response in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.5-3" class="pilcrow">¶</a></p>
<p id="section-2.1.5-4">For token introspection, flags are returned in the <code>flags</code> field of the response.<a href="#section-2.1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-rights">
<section id="section-2.1.6">
          <h4 id="name-access-rights">
<a href="#section-2.1.6" class="section-number selfRef">2.1.6. </a><a href="#name-access-rights" class="section-name selfRef">Access Rights</a>
          </h4>
<p id="section-2.1.6-1">Access tokens are tied to a limited set of access rights. These rights specify in some detail what the token
can be used for, how it can be used, and where it can be used. The internal structure of access rights is detailed in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-8" class="relref">Section 8</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.6-1" class="pilcrow">¶</a></p>
<p id="section-2.1.6-2">The access rights associated with an access token are calculated from the rights available to the client
instance making the request, the rights available to be approved by the RO, the rights actually approved
by the RO, and the rights corresponding to the RS in question. The rights for a specific access token
are a subset of the overall rights in a grant request.<a href="#section-2.1.6-2" class="pilcrow">¶</a></p>
<p id="section-2.1.6-3">These rights are requested by the client instance in the <code>access</code> field of the <code>access_token</code> request; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.6-3" class="pilcrow">¶</a></p>
<p id="section-2.1.6-4">The rights associated with an issued access token are conveyed to the client instance in the <code>access</code> field of the <code>access_token</code> response in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.6-4" class="pilcrow">¶</a></p>
<p id="section-2.1.6-5">In token introspection responses, access rights correspond to the <code>access</code> claim.<a href="#section-2.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="time-validity-window">
<section id="section-2.1.7">
          <h4 id="name-time-validity-window">
<a href="#section-2.1.7" class="section-number selfRef">2.1.7. </a><a href="#name-time-validity-window" class="section-name selfRef">Time Validity Window</a>
          </h4>
<p id="section-2.1.7-1">The access token can be limited to a certain time window outside of which it is no longer
valid for use at an RS. This window can be explicitly bounded by an expiration time and a
not-before time, or it could be calculated based on the issuance time of the token. For example,
an RS could decide that it will accept tokens for most calls within an hour of a token's
issuance, but only within five minutes of the token's issuance for certain high-value calls.<a href="#section-2.1.7-1" class="pilcrow">¶</a></p>
<p id="section-2.1.7-2">Since access tokens could be revoked at any time for any reason outside of a client instance's control,
the client instance often does not know or concern itself with the validity time window of
an access token. However, this information can be made available to it by using the <code>expires_in</code> field
of an access token response; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.7-2" class="pilcrow">¶</a></p>
<p id="section-2.1.7-3">The issuance time of the token is conveyed in the <code>iat</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response.<a href="#section-2.1.7-3" class="pilcrow">¶</a></p>
<p id="section-2.1.7-4">The expiration time of a token, after which it is to be rejected, is conveyed in the <code>exp</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response.<a href="#section-2.1.7-4" class="pilcrow">¶</a></p>
<p id="section-2.1.7-5">The starting time of a token's validity window, before which it is to be rejected, is conveyed in the <code>nbf</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response.<a href="#section-2.1.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-identifier">
<section id="section-2.1.8">
          <h4 id="name-token-identifier">
<a href="#section-2.1.8" class="section-number selfRef">2.1.8. </a><a href="#name-token-identifier" class="section-name selfRef">Token Identifier</a>
          </h4>
<p id="section-2.1.8-1">Individual access tokens often need a unique internal identifier to allow the AS to differentiate
between multiple separate tokens. This value of the token can often be used as the
identifier, but in some cases, a separate identifier is used.<a href="#section-2.1.8-1" class="pilcrow">¶</a></p>
<p id="section-2.1.8-2">This separate identifier can be conveyed in the <code>jti</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response.<a href="#section-2.1.8-2" class="pilcrow">¶</a></p>
<p id="section-2.1.8-3">This identifier is not usually exposed to the client instance using the token, because the client
instance only needs to use the token by value.<a href="#section-2.1.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorizing-resource-owner">
<section id="section-2.1.9">
          <h4 id="name-authorizing-resource-owner">
<a href="#section-2.1.9" class="section-number selfRef">2.1.9. </a><a href="#name-authorizing-resource-owner" class="section-name selfRef">Authorizing Resource Owner</a>
          </h4>
<p id="section-2.1.9-1">Access tokens are approved on behalf of a resource owner (RO). The identity of this RO can be used by
the RS to determine exactly which resource to access or which kinds of access to allow. For example,
an access token used to access identity information can hold a user identifier to allow the RS to
determine which profile information to return. The nature of this information is subject to agreement
by the AS and RS.<a href="#section-2.1.9-1" class="pilcrow">¶</a></p>
<p id="section-2.1.9-2">This corresponds to the <code>sub</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or a token introspection response.<a href="#section-2.1.9-2" class="pilcrow">¶</a></p>
<p id="section-2.1.9-3">Detailed RO information is not returned to the client instance
when an access token is requested alone, and in many cases, returning
this information to the client instance would be a privacy violation on the part of the AS. Since the
access token represents a specific delegated access, the client instance needs only to use the token
at its target RS. Following the profile example, the client instance does not need to know
the account identifier to get specific attributes about the account represented by the token.<a href="#section-2.1.9-3" class="pilcrow">¶</a></p>
<p id="section-2.1.9-4">GNAP does allow for the return of subject information separately from the access token, in the form
of identifiers and assertions. These values are returned directly to the client separately from any
access tokens that are requested, though it's common that they represent the same party.<a href="#section-2.1.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="end-user">
<section id="section-2.1.10">
          <h4 id="name-end-user">
<a href="#section-2.1.10" class="section-number selfRef">2.1.10. </a><a href="#name-end-user" class="section-name selfRef">End User</a>
          </h4>
<p id="section-2.1.10-1">The end user is the party operating the client software. The client instance can facilitate the end user
interacting with the AS in order to determine the end user's identity, gather authorization, and provide
the results of that information back to the client instance.<a href="#section-2.1.10-1" class="pilcrow">¶</a></p>
<p id="section-2.1.10-2">In many instances, the end user is the same party as the resource owner. However, in some cases,
the two roles can be fulfilled by different people, where the RO is consulted asynchronously.
The token model should be able to reflect these kinds of situations by representing the end user
and RO separately.
For example, an end user can request a financial payment, but the RO is the holder of the account
that the payment would be withdrawn from. The RO would be consulted for approval by the AS outside
of the flow of the GNAP request. A token in such circumstances would need to show both the
RO and end user as separate entities.<a href="#section-2.1.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-instance">
<section id="section-2.1.11">
          <h4 id="name-client-instance">
<a href="#section-2.1.11" class="section-number selfRef">2.1.11. </a><a href="#name-client-instance" class="section-name selfRef">Client Instance</a>
          </h4>
<p id="section-2.1.11-1">Access tokens are issued to a specific client instance by the AS. The identity of this instance can
be used by the RS to allow specific kinds of access or other attributes about the access token.
For example, an AS that binds all access tokens issued to a particular client instance to that
client instance's most recent key rotation would need to be able to look up the client instance
in order to find the key binding detail.<a href="#section-2.1.11-1" class="pilcrow">¶</a></p>
<p id="section-2.1.11-2">This corresponds to the <code>client_id</code> claim in the payload of a JSON Web Token <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span> or the <code>instance_id</code> field of a token introspection response.<a href="#section-2.1.11-2" class="pilcrow">¶</a></p>
<p id="section-2.1.11-3">The client is not normally informed of this information separately, since a client instance can
usually correctly assume that it is the client instance to which a token that
it receives was issued.<a href="#section-2.1.11-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="label">
<section id="section-2.1.12">
          <h4 id="name-label">
<a href="#section-2.1.12" class="section-number selfRef">2.1.12. </a><a href="#name-label" class="section-name selfRef">Label</a>
          </h4>
<p id="section-2.1.12-1">When multiple access tokens are requested or a client instance uses token labels, the parties
will need to keep track of which labels were applied to each individual token. Since labels can
be reused across different grant requests, the token label alone is not sufficient to
uniquely identify a given access token in a system. However, within the context of a grant
request, these labels are required to be unique.<a href="#section-2.1.12-1" class="pilcrow">¶</a></p>
<p id="section-2.1.12-2">A client instance can request a specific label using the <code>label</code> field of an <code>access_token</code> request; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.12-2" class="pilcrow">¶</a></p>
<p id="section-2.1.12-3">The AS can inform the client instance of a token's label using the <code>label</code> field of an <code>access_token</code> response; see <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-2.1.12-3" class="pilcrow">¶</a></p>
<p id="section-2.1.12-4">This corresponds to the <code>label</code> field of a token introspection response.<a href="#section-2.1.12-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parent-grant-request">
<section id="section-2.1.13">
          <h4 id="name-parent-grant-request">
<a href="#section-2.1.13" class="section-number selfRef">2.1.13. </a><a href="#name-parent-grant-request" class="section-name selfRef">Parent Grant Request</a>
          </h4>
<p id="section-2.1.13-1">All access tokens are issued in the context of a specific grant request from a client instance. The
grant request itself represents a unique tuple of:<a href="#section-2.1.13-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.13-2.1">
              <p id="section-2.1.13-2.1.1">The AS processing the grant request<a href="#section-2.1.13-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.13-2.2">
              <p id="section-2.1.13-2.2.1">The client instance making the grant request<a href="#section-2.1.13-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.13-2.3">
              <p id="section-2.1.13-2.3.1">The RO (or set of ROs) approving the grant request (or needing to approve it)<a href="#section-2.1.13-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.13-2.4">
              <p id="section-2.1.13-2.4.1">The access rights granted by the RO<a href="#section-2.1.13-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.13-2.5">
              <p id="section-2.1.13-2.5.1">The current state of the grant request, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-1.5" class="relref">Section 1.5</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span><a href="#section-2.1.13-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.13-3">The AS can use this information to tie common information to a specific token. For instance,
instead of specifying a client instance for every issued access token for a grant, the AS
can store the client information in the grant itself and look it up by reference from the
access token.<a href="#section-2.1.13-3" class="pilcrow">¶</a></p>
<p id="section-2.1.13-4">The AS can also use this information when a grant request is updated. For example, if the client
instance asks for a new access token from an existing grant, the AS can use this link to revoke
older non-durable access tokens that had been previously issued under the grant.<a href="#section-2.1.13-4" class="pilcrow">¶</a></p>
<p id="section-2.1.13-5">A client instance will have its own model of an ongoing grant request, especially if that
grant request can be continued using the API defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-5" class="relref">Section 5</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span> where several
pieces of statefulness need to be kept in hand. The client instance might need to keep an
association with the grant request that issued the token in case the access token expires or
does not have sufficient access rights, so that the client instance can get a new access
token without having to restart the grant request process from scratch.<a href="#section-2.1.13-5" class="pilcrow">¶</a></p>
<p id="section-2.1.13-6">Since the grant itself does not need to be identified in any of the protocol messages, GNAP
does not define a specific grant identifier to be conveyed between any parties in the protocol.
Only the AS needs to keep an explicit connection between an issued access token and the
parent grant that issued it.<a href="#section-2.1.13-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-specific-access-tokens">
<section id="section-2.1.14">
          <h4 id="name-as-specific-access-tokens">
<a href="#section-2.1.14" class="section-number selfRef">2.1.14. </a><a href="#name-as-specific-access-tokens" class="section-name selfRef">AS-Specific Access Tokens</a>
          </h4>
<p id="section-2.1.14-1">When an access token is used for the grant continuation API defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-5" class="relref">Section 5</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span> (the continuation access token),
the token management API defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-6" class="relref">Section 6</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span> (the token management access token),
or the RS-facing API defined in <a href="#rs-facing-api" class="auto internal xref">Section 3</a> (the resource server management access token),
the AS <span class="bcp14">MUST</span> separate these access tokens from other access tokens used at one or more RSs. The AS can
do this through the use of a flag on the access token data structure, by using a special internal
access right, or any other means at its disposal. Just like other access tokens in GNAP,
the contents of these AS-specific access tokens are opaque to the software presenting the token.
   Unlike other access tokens, the contents of these AS-specific access tokens are also opaque to the RS.<a href="#section-2.1.14-1" class="pilcrow">¶</a></p>
<p id="section-2.1.14-2">The client instance is given continuation access tokens only as part of the <code>continue</code> field
of the grant response in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
The client instance is given token management access tokens only as part of the <code>manage</code> field
of the grant response in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
The means by which the RS is given resource server management access tokens is out of
scope of this specification, but methods could include preconfiguration of the token value with
   the RS software or granting the access token through a standard GNAP process.<a href="#section-2.1.14-2" class="pilcrow">¶</a></p>
<p id="section-2.1.14-3">For continuation access tokens and token management access tokens,
a client instance <span class="bcp14">MUST</span> take steps to differentiate these special-purpose access tokens from
access tokens used at one or more RSs.
To facilitate this, a client instance can store AS-specific access tokens separately from
other access tokens in order to keep them from being confused with each other and used at the
wrong endpoints.<a href="#section-2.1.14-3" class="pilcrow">¶</a></p>
<p id="section-2.1.14-4">An RS should never see an AS-specific access token presented, so any attempts to process one <span class="bcp14">MUST</span>
fail. When introspection is used, the AS <span class="bcp14">MUST NOT</span> return an <code>active</code> value of <code>true</code> for
AS-specific access tokens to the RS. If an AS implements its protected endpoints in such a way
that it uses token introspection internally, the AS <span class="bcp14">MUST</span> differentiate these AS-specific access tokens
from those issued for use at an external RS.<a href="#section-2.1.14-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-format">
<section id="section-2.2">
        <h3 id="name-access-token-formats">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-access-token-formats" class="section-name selfRef">Access Token Formats</a>
        </h3>
<p id="section-2.2-1">When the AS issues an access token for use at an RS, the RS
needs to have some means of understanding what the access token is for
in order to determine how to respond to the request. The core GNAP
protocol makes neither assumptions nor demands on the format or contents
of the access token, and in fact, the token format and contents are opaque
to the client instance. However, such token formats can be the topic of agreements
between the AS and RS.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Self-contained structured token formats allow for the conveyance
of information between the AS and RS without requiring the RS to
call the AS at runtime as described in <a href="#introspection" class="auto internal xref">Section 3.3</a>. Structured tokens
can also be used in combination with introspection, allowing the token itself
to carry one class of information and the introspection response to carry
another.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Some token formats, such as Macaroons <span>[<a href="#MACAROON" class="cite xref">MACAROON</a>]</span> and Biscuits <span>[<a href="#BISCUIT" class="cite xref">BISCUIT</a>]</span>, allow for
the RS to derive sub-tokens without having to call the AS
as described in <a href="#token-chaining" class="auto internal xref">Section 4</a>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The supported token formats can be communicated dynamically at runtime
between the AS and RS in several places:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-5.1">
            <p id="section-2.2-5.1.1">The AS can declare its supported token formats as part of RS-facing discovery (<a href="#discovery" class="auto internal xref">Section 3.1</a>).<a href="#section-2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-5.2">
            <p id="section-2.2-5.2.1">The RS can require a specific token format be used to access a registered resource set (<a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a>).<a href="#section-2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-5.3">
            <p id="section-2.2-5.3.1">The AS can return the token's format in an introspection response (<a href="#introspection" class="auto internal xref">Section 3.3</a>).<a href="#section-2.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-6">In all places where the token format is listed explicitly, it <span class="bcp14">MUST</span> be one of the registered
values in the "GNAP Token Formats" registry <a href="#IANA-token-format" class="auto internal xref">Section 5.3</a>.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rs-facing-api">
<section id="section-3">
      <h2 id="name-resource-server-facing-api">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-resource-server-facing-api" class="section-name selfRef">Resource-Server-Facing API</a>
      </h2>
<p id="section-3-1">To facilitate runtime and dynamic connections with an RS, the AS can offer an
RS-facing API consisting of one or more of the following optional
pieces:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1">Discovery<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.2">
          <p id="section-3-2.2.1">Introspection<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.3">
          <p id="section-3-2.3.1">Token chaining<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-2.4">
          <p id="section-3-2.4.1">Resource reference registration<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="discovery">
<section id="section-3.1">
        <h3 id="name-rs-facing-as-discovery">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rs-facing-as-discovery" class="section-name selfRef">RS-Facing AS Discovery</a>
        </h3>
<p id="section-3.1-1">A GNAP AS offering RS-facing services can publish its features
on a well-known discovery document at the URL with the same
schema and authority as the grant request endpoint URL, at
the path <code>/.well-known/gnap-as-rs</code>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The discovery response is a JSON document <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> consisting of a single JSON
 object with the following fields:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-3">
          <dt id="section-3.1-3.1">grant_request_endpoint (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">The location of the AS's grant request endpoint defined by <span><a href="https://rfc-editor.org/rfc/rfc9635#section-9" class="relref">Section 9</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
  This URL <span class="bcp14">MUST</span> be the same URL used by client instances in support of GNAP requests.
  The RS can use this to derive downstream access tokens, if supported by the AS.
  The location <span class="bcp14">MUST</span> be a URL <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>
  with a scheme component that <span class="bcp14">MUST</span> be https, a host component, and (optionally)
  port, path, and query components and no fragment components.
  <span class="bcp14">REQUIRED</span>.
  See <a href="#token-chaining" class="auto internal xref">Section 4</a>.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.3">introspection_endpoint (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.4">
            <p id="section-3.1-3.4.1">The URL of the endpoint offering introspection.
  The location <span class="bcp14">MUST</span> be a URL <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>
  with a scheme component that <span class="bcp14">MUST</span> be https, a host component, and (optionally)
  port, path, and query components and no fragment components.
  <span class="bcp14">REQUIRED</span> if the AS supports introspection. An absent value indicates that the AS does not support introspection.
  See <a href="#introspection" class="auto internal xref">Section 3.3</a>.<a href="#section-3.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.5">token_formats_supported (array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.6">
            <p id="section-3.1-3.6.1">A list of token formats supported by this AS. The values in this list
  <span class="bcp14">MUST</span> be registered in the "GNAP Token Formats" registry per <a href="#IANA-token-format" class="auto internal xref">Section 5.3</a>.
  <span class="bcp14">OPTIONAL</span>.<a href="#section-3.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.7">resource_registration_endpoint (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.8">
            <p id="section-3.1-3.8.1">The URL of the endpoint offering resource registration.
  The location <span class="bcp14">MUST</span> be a URL <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>
  with a scheme component that <span class="bcp14">MUST</span> be https, a host component, and (optionally)
  port, path, and query components and no fragment components.
  <span class="bcp14">REQUIRED</span> if the AS supports dynamic resource registration. An absent value indicates that the AS does not support this feature.
  See <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a>.<a href="#section-3.1-3.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.9">key_proofs_supported (array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-3.10">
            <p id="section-3.1-3.10.1">A list of the AS's supported key
  proofing mechanisms. The values of this list correspond to possible
  values of the <code>proof</code> field of the key section of the request.
  Values <span class="bcp14">MUST</span> be registered in the "GNAP Key Proofing Methods" registry established by <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
  <span class="bcp14">OPTIONAL</span>.<a href="#section-3.1-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-4">Additional fields are defined in the "GNAP RS-Facing Discovery Document Fields" registry; see <a href="#IANA-rs-discovery" class="auto internal xref">Section 5.8</a>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication">
<section id="section-3.2">
        <h3 id="name-protecting-rs-requests-to-t">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-protecting-rs-requests-to-t" class="section-name selfRef">Protecting RS Requests to the AS</a>
        </h3>
<p id="section-3.2-1">Unless otherwise specified, the RS <span class="bcp14">MUST</span> protect its calls to the AS using any of the signature
methods defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-7" class="relref">Section 7</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The RS <span class="bcp14">MAY</span> present its keys by reference or by value in
a similar fashion to a client instance calling the AS in the core protocol
of GNAP, as described in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-7.1" class="relref">Section 7.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. In the protocols defined here,
this takes the form of the resource server identifying itself by using a <code>key</code> field or
by passing an instance identifier directly.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.2-3">
<pre>
POST /continue HTTP/1.1
Host: server.example.com
Authorization: GNAP 80UPRY5NM33OMUKMKSKU
Signature-Input: sig1=...
Signature: sig1=...
Content-Type: application/json

"resource_server": {
    "key": {
        "proof": "httpsig",
        "jwk": {
            "kty": "EC",
            "crv": "secp256k1",
            "kid": "2021-07-06T20:22:03Z",
            "x": "-J9OJIZj4nmopZbQN7T8xv3sbeS5-f_vBNSy_EHnBZc",
            "y": "sjrS51pLtu3P4LUTVvyAIxRfDV_be2RYpI5_f-Yjivw"
        }
    }
}
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">or by reference:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.2-5">
<pre>
POST /continue HTTP/1.1
Host: server.example.com
Signature-Input: sig1=...
Signature: sig1=...
Content-Type: application/json

{
    "resource_server": "7C7C4AZ9KHRS6X63AJAO"
}
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">The means by which an RS's keys are made known to the AS are out
of the scope of this specification.
The AS <span class="bcp14">MAY</span> require an RS to preregister its keys,
or it could allow calls from arbitrary keys in a trust-on-first-use
model.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">The AS <span class="bcp14">MAY</span> issue access tokens, called "resource server management access tokens", to the RS to protect the RS-facing API endpoints.
If such tokens are issued, the RS <span class="bcp14">MUST</span> present them
to the RS-facing API endpoints along with the RS authentication.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.2-8">
<pre>
POST /continue HTTP/1.1
Host: server.example.com
Authorization: GNAP 80UPRY5NM33OMUKMKSKU
Signature-Input: sig1=...
Signature: sig1=...
Content-Type: application/json

{
    "resource_server": "7C7C4AZ9KHRS6X63AJAO"
}
</pre><a href="#section-3.2-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="introspection">
<section id="section-3.3">
        <h3 id="name-token-introspection">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-token-introspection" class="section-name selfRef">Token Introspection</a>
        </h3>
<p id="section-3.3-1">The AS issues access tokens representing a set of delegated access rights
to be used at one or more RSs. The AS can offer an introspection service
to allow an RS to validate that a given access token:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">has been issued by the AS<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.2">
            <p id="section-3.3-2.2.1">is valid at the current time<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.3">
            <p id="section-3.3-2.3.1">has not been revoked<a href="#section-3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.4">
            <p id="section-3.3-2.4.1">is appropriate for the RS identified in the call<a href="#section-3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-3">When the RS receives an access token, it can call the introspection
endpoint at the AS to get token information.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<div id="section-3.3-4">
          <div class="alignLeft art-svg artwork" id="section-3.3-4.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="328" viewBox="0 0 328 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,144" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,144" fill="none" stroke="black"></path>
              <path d="M 144,32 L 144,144" fill="none" stroke="black"></path>
              <path d="M 200,32 L 200,144" fill="none" stroke="black"></path>
              <path d="M 264,32 L 264,112" fill="none" stroke="black"></path>
              <path d="M 320,32 L 320,112" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 144,32 L 200,32" fill="none" stroke="black"></path>
              <path d="M 264,32 L 320,32" fill="none" stroke="black"></path>
              <path d="M 80,48 L 104,48" fill="none" stroke="black"></path>
              <path d="M 120,48 L 136,48" fill="none" stroke="black"></path>
              <path d="M 200,64 L 224,64" fill="none" stroke="black"></path>
              <path d="M 240,64 L 256,64" fill="none" stroke="black"></path>
              <path d="M 208,96 L 224,96" fill="none" stroke="black"></path>
              <path d="M 240,96 L 264,96" fill="none" stroke="black"></path>
              <path d="M 264,112 L 320,112" fill="none" stroke="black"></path>
              <path d="M 88,128 L 104,128" fill="none" stroke="black"></path>
              <path d="M 120,128 L 144,128" fill="none" stroke="black"></path>
              <path d="M 8,144 L 80,144" fill="none" stroke="black"></path>
              <path d="M 144,144 L 200,144" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="264,64 252,58.4 252,69.6" fill="black" transform="rotate(0,256,64)"></polygon>
              <polygon class="arrowhead" points="216,96 204,90.4 204,101.6" fill="black" transform="rotate(180,208,96)"></polygon>
              <polygon class="arrowhead" points="144,48 132,42.4 132,53.6" fill="black" transform="rotate(0,136,48)"></polygon>
              <polygon class="arrowhead" points="96,128 84,122.4 84,133.6" fill="black" transform="rotate(180,88,128)"></polygon>
              <g class="text">
                <text x="44" y="52">Client</text>
                <text x="112" y="52">1</text>
                <text x="172" y="52">RS</text>
                <text x="292" y="52">AS</text>
                <text x="44" y="68">Instance</text>
                <text x="232" y="68">2</text>
                <text x="232" y="100">3</text>
                <text x="112" y="132">4</text>
              </g>
            </svg><a href="#section-3.3-4.1" class="pilcrow">¶</a>
</div>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.3-5">
<li id="section-3.3-5.1">
            <p id="section-3.3-5.1.1">The client instance calls the RS with its access token.<a href="#section-3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-5.2">
            <p id="section-3.3-5.2.1">The RS introspects the access token value at the AS.
 The RS signs the request with its own key (not the client instance's
 key or the token's key).<a href="#section-3.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-5.3">
            <p id="section-3.3-5.3.1">The AS validates the access token value and the RS's request
 and returns the introspection response for the token.<a href="#section-3.3-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-5.4">
            <p id="section-3.3-5.4.1">The RS fulfills the request from the client instance.<a href="#section-3.3-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.3-6">The RS signs the request with its own key and sends the value of the access
token in the body of the request as a JSON object with the following members:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-7">
          <dt id="section-3.3-7.1">access_token (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-7.2">
            <p id="section-3.3-7.2.1">The access token value presented to the RS by the client instance. <span class="bcp14">REQUIRED</span>.<a href="#section-3.3-7.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-7.3">proof (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-7.4">
            <p id="section-3.3-7.4.1">The proofing method used by the client instance to bind the token to the RS request.
  The value <span class="bcp14">MUST</span> be registered in the "GNAP Key Proofing Methods" registry. <span class="bcp14">RECOMMENDED</span>.<a href="#section-3.3-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-7.5">resource_server (object/string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-7.6">
            <p id="section-3.3-7.6.1">The identification used to authenticate the resource server making this call, either
  by value or by reference as described in <a href="#authentication" class="auto internal xref">Section 3.2</a>. <span class="bcp14">REQUIRED</span>.<a href="#section-3.3-7.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-7.7">access (array of strings/objects):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-7.8">
            <p id="section-3.3-7.8.1">The minimum access rights required to fulfill the request. This <span class="bcp14">MUST</span> be in the
  format described in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-8" class="relref">Section 8</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-7.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-8">Additional fields are defined in the "GNAP Token Introspection Request" registry (<a href="#IANA-token-introspection-request" class="auto internal xref">Section 5.4</a>).<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.3-9">
<pre>
POST /introspect HTTP/1.1
Host: server.example.com
Content-Type: application/json
Signature-Input: sig1=...
Signature: sig1=...
Digest: sha256=...

{
    "access_token": "OS9M2PMHKUR64TB8N6BW7OZB8CDFONP219RP1LT0",
    "proof": "httpsig",
    "resource_server": "7C7C4AZ9KHRS6X63AJAO"
}
</pre><a href="#section-3.3-9" class="pilcrow">¶</a>
</div>
<p id="section-3.3-10">The AS <span class="bcp14">MUST</span> validate the access token value and determine if the token is active.
The parameters of the request provide a context for the AS to evaluate the access token,
and the AS <span class="bcp14">MUST</span> take all provided parameters into account when evaluating if the token is active.
If the AS is unable to process part of the request, such as not understanding part of
the <code>access</code> field presented, the AS <span class="bcp14">MUST NOT</span> indicate the token as active.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">An active access token is defined as a token that is all of the following:<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-12.1">
            <p id="section-3.3-12.1.1">was issued by the processing AS,<a href="#section-3.3-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-12.2">
            <p id="section-3.3-12.2.1">has not been revoked,<a href="#section-3.3-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-12.3">
            <p id="section-3.3-12.3.1">has not expired,<a href="#section-3.3-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-12.4">
            <p id="section-3.3-12.4.1">is bound using the <code>proof</code> method indicated,<a href="#section-3.3-12.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-12.5">
            <p id="section-3.3-12.5.1">is appropriate for presentation at the identified RS, and<a href="#section-3.3-12.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-12.6">
            <p id="section-3.3-12.6.1">is appropriate for the <code>access</code> indicated (if present).<a href="#section-3.3-12.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-13">The AS responds with a data structure describing the token's
current state and any information the RS would need to validate the
token's presentation, such as its intended proofing mechanism and key
material.<a href="#section-3.3-13" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-14">
          <dt id="section-3.3-14.1">active (boolean):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-14.2">
            <p id="section-3.3-14.2.1">If <code>true</code>, the access token presented is active,
  as defined above. If any of the criteria for an active token
  are not true, or if the AS is unable to make a
  determination (such as the token is not found), the value is
  set to <code>false</code> and other fields are omitted. <span class="bcp14">REQUIRED</span>.<a href="#section-3.3-14.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-15">If the access token is active, additional fields from the single access token
response structure defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span> are included. In
particular, these include the following:<a href="#section-3.3-15" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-16">
          <dt id="section-3.3-16.1">access (array of strings/objects):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.2">
            <p id="section-3.3-16.2.1">The access rights associated with this access token. This <span class="bcp14">MUST</span> be in the
  format described in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-8" class="relref">Section 8</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.
  This array <span class="bcp14">MAY</span> be filtered or otherwise limited for consumption by the identified RS, including
  being an empty array, which indicates that the token has no explicit access rights that
  can be disclosed to the RS. <span class="bcp14">REQUIRED</span>.<a href="#section-3.3-16.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.3">key (object/string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.4">
            <p id="section-3.3-16.4.1">if the token is bound. The key bound to the access token, to allow the RS
  to validate the signature of the request from the client instance. If the access
  token is a bearer token, this <span class="bcp14">MUST NOT</span> be included. <span class="bcp14">REQUIRED</span><a href="#section-3.3-16.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.5">flags (array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.6">
            <p id="section-3.3-16.6.1">The set of flags associated with the access token. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.7">exp (integer):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.8">
            <p id="section-3.3-16.8.1">The timestamp after which this token is no longer valid.
  Expressed as integer seconds from UNIX Epoch. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.9">iat (integer):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.10">
            <p id="section-3.3-16.10.1">The timestamp at which this token was issued by the AS.
  Expressed as integer seconds from UNIX Epoch. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.11">nbf (integer):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.12">
            <p id="section-3.3-16.12.1">The timestamp before which this token is not valid.
  Expressed as integer seconds from UNIX Epoch. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.13">aud (string or array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.14">
            <p id="section-3.3-16.14.1">Identifiers for the resource servers this token can be accepted at. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.15">sub (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.16">
            <p id="section-3.3-16.16.1">Identifier of the resource owner who authorized this token. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.17">iss (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.18">
            <p id="section-3.3-16.18.1">Grant endpoint URL of the AS that issued this token. <span class="bcp14">REQUIRED</span>.<a href="#section-3.3-16.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-16.19">instance_id (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-16.20">
            <p id="section-3.3-16.20.1">The instance identifier of the client instance that the token was issued to. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.3-16.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-17">Additional fields are defined in the "GNAP Token Introspection Response" registry (<a href="#IANA-token-introspection" class="auto internal xref">Section 5.5</a>).<a href="#section-3.3-17" class="pilcrow">¶</a></p>
<p id="section-3.3-18">The response <span class="bcp14">MAY</span> include any additional fields defined in an access
token response and <span class="bcp14">MUST NOT</span> include the access token <code>value</code> itself.<a href="#section-3.3-18" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.3-19">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
    "active": true,
    "access": [
        "dolphin-metadata", "some other thing"
    ],
    "key": {
        "proof": "httpsig",
        "jwk": {
                "kty": "RSA",
                "e": "AQAB",
                "kid": "xyz-1",
                "alg": "RS256",
                "n": "kOB5rR4Jv0GMeL...."
        }
    }
}
</pre><a href="#section-3.3-19" class="pilcrow">¶</a>
</div>
<p id="section-3.3-20">When processing the results of the introspection response, the RS <span class="bcp14">MUST</span> determine the
appropriate course of action. For instance, if the RS determines that the access token's
access rights are not sufficient for the request to which the token was attached, the RS
can return an error or a public resource, as appropriate for the RS.
In all cases, the final determination of the response is at the discretion of the RS.<a href="#section-3.3-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rs-register-resource-handle">
<section id="section-3.4">
        <h3 id="name-registering-a-resource-set">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-registering-a-resource-set" class="section-name selfRef">Registering a Resource Set</a>
        </h3>
<p id="section-3.4-1">If the RS needs to, it can post a set of resources, as described in Section <a href="https://rfc-editor.org/rfc/rfc9635#section-8" class="relref">8</a> ("Resource Access Rights") of <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>, to the AS's resource registration endpoint along with information about
what the RS will need to validate the request.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-2">
          <dt id="section-3.4-2.1">access (array of objects/strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The list of access rights associated with the request in the format described
  in Section <a href="https://rfc-editor.org/rfc/rfc9635#section-8" class="relref">8</a> ("Resource Access Rights") of <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. <span class="bcp14">REQUIRED</span>.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.3">resource_server (object/string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.4">
            <p id="section-3.4-2.4.1"> The identification used to authenticate the resource server making this call, either
  by value or by reference as described in <a href="#authentication" class="auto internal xref">Section 3.2</a>. <span class="bcp14">REQUIRED</span>.<a href="#section-3.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.5">token_formats_supported (array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.6">
            <p id="section-3.4-2.6.1">The list of token formats that the RS is able to process.
  The values in this array <span class="bcp14">MUST</span> be registered in the "GNAP Token Formats" registry per <a href="#IANA-token-format" class="auto internal xref">Section 5.3</a>.
  If the field is omitted, the token format is at the discretion of the AS.
  If the AS does not support any of the requested
  token formats, the AS <span class="bcp14">MUST</span> return an error to the RS. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.7">token_introspection_required (boolean):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.8">
            <p id="section-3.4-2.8.1"> If present and set to <code>true</code>, the RS expects to make a token introspection request as
  described in <a href="#introspection" class="auto internal xref">Section 3.3</a>. If absent or set to <code>false</code>, the RS does not anticipate needing
  to make an introspection request for tokens relating to this resource set. If the AS does not
  support token introspection for this RS, the AS <span class="bcp14">MUST</span> return an error to the RS. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.4-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-3">Additional fields are defined in the "GNAP Resource Set Registration Request Parameters" registry (<a href="#IANA-resource-registration-request" class="auto internal xref">Section 5.6</a>).<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">The RS <span class="bcp14">MUST</span> identify itself with its own key and sign the
request.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.4-5">
<pre>
POST /resource HTTP/1.1
Host: server.example.com
Content-Type: application/json
Signature-Input: sig1=...
Signature: sig1=...
Digest: ...

{
    "access": [
        {
            "actions": [
                "read",
                "write",
                "dolphin"
            ],
            "locations": [
                "https://server.example.net/",
                "https://resource.local/other"
            ],
            "datatypes": [
                "metadata",
                "images"
            ]
        },
        "dolphin-metadata"
    ],
    "resource_server": "7C7C4AZ9KHRS6X63AJAO"

}
</pre><a href="#section-3.4-5" class="pilcrow">¶</a>
</div>
<p id="section-3.4-6">The AS responds with a reference appropriate to represent the
resources list that the RS presented in its request as well as
any additional information the RS might need in future requests.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-7">
          <dt id="section-3.4-7.1">resource_reference (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-7.2">
            <p id="section-3.4-7.2.1">A single string representing the list of resources registered in the request.
  The RS <span class="bcp14">MAY</span> make this handle available to a client instance as part of a
  discovery response as described in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span> or as
  documentation to client software developers. <span class="bcp14">REQUIRED</span>.<a href="#section-3.4-7.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-7.3">instance_id (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-7.4">
            <p id="section-3.4-7.4.1">An instance identifier that the RS can use to refer to itself in future calls to
  the AS, in lieu of sending its key by value. See <a href="#authentication" class="auto internal xref">Section 3.2</a>. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.4-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-7.5">introspection_endpoint (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-7.6">
            <p id="section-3.4-7.6.1">The introspection endpoint of this AS that is used to allow the RS to perform token introspection. See <a href="#introspection" class="auto internal xref">Section 3.3</a>. <span class="bcp14">OPTIONAL</span>.<a href="#section-3.4-7.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-8">Additional fields are defined in the "GNAP Resource Set Registration Response Parameters" registry (<a href="#IANA-resource-registration-response" class="auto internal xref">Section 5.7</a>).<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.4-9">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
    "resource_reference": "FWWIKYBQ6U56NL1"
}
</pre><a href="#section-3.4-9" class="pilcrow">¶</a>
</div>
<p id="section-3.4-10">If a resource was previously registered, the AS <span class="bcp14">MAY</span> return the same resource reference
 value as in previous responses.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<p id="section-3.4-11">If the registration fails, the AS returns HTTP status code 400 (Bad Request) to the
RS, indicating that the registration was not successful.<a href="#section-3.4-11" class="pilcrow">¶</a></p>
<p id="section-3.4-12">The client instance can then use the <code>resource_reference</code> value as a string-type access
reference as defined in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. This value <span class="bcp14">MAY</span> be combined with any other
additional access rights requested by the client instance.<a href="#section-3.4-12" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-3.4-13">
<pre>
{
    "access_token": {
        "access": [
            "FWWIKYBQ6U56NL1",
            {
                "type": "photo-api",
                "actions": [
                    "read",
                    "write",
                    "dolphin"
                ],
                "locations": [
                    "https://server.example.net/",
                    "https://resource.local/other"
                ],
                "datatypes": [
                    "metadata",
                    "images"
                ]
            },
            "dolphin-metadata"
        ]
    },
    "client": "client-12351.bdxqf"
}
</pre><a href="#section-3.4-13" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="response-error">
<section id="section-3.5">
        <h3 id="name-error-responses">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
        </h3>
<p id="section-3.5-1">In the case of an error from the RS-facing API, the AS responds to the RS with HTTP status code 400 (Bad Request) and a JSON object consisting of a single <code>error</code> field, which is either an object or a string.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">When returned as a string, the error value is the error code:<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-3.5-3">
<pre>
{
    error: "invalid_access"
}
</pre><a href="#section-3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-3.5-4">When returned as an object, the error object contains the following fields:<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-5">
          <dt id="section-3.5-5.1">
<code>code</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-5.2">
            <p id="section-3.5-5.2.1">A single ASCII error code defining the error.
<span class="bcp14">REQUIRED</span>.<a href="#section-3.5-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-5.3">
<code>description</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-5.4">
            <p id="section-3.5-5.4.1">A human-readable string description of the error intended for the
developer of the client.
<span class="bcp14">OPTIONAL</span>.<a href="#section-3.5-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div class="lang-json sourcecode" id="section-3.5-6">
<pre>
{
  "error": {
    "code": "invalid_access",
    "description": "Access to 'foo' is not permitted for this RS."
  }
}
</pre><a href="#section-3.5-6" class="pilcrow">¶</a>
</div>
<p id="section-3.5-7">This specification defines the following error code values:<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-8">
          <dt id="section-3.5-8.1">
<code>"invalid_request"</code>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-8.2">
            <p id="section-3.5-8.2.1">The request is missing a required parameter, includes an
  invalid parameter value, or is otherwise malformed.<a href="#section-3.5-8.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-8.3">
<code>"invalid_resource_server"</code>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-8.4">
            <p id="section-3.5-8.4.1">The request was made from an RS that was not recognized
  or allowed by the AS, or the RS's signature validation failed.<a href="#section-3.5-8.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-8.5"><code>"invalid_access"</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.5-8.6">
            <p id="section-3.5-8.6.1">The RS is not permitted to register or introspect for the requested "access" value.<a href="#section-3.5-8.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-9">Additional error codes can be defined in the "GNAP RS-Facing Error Codes" registry (<a href="#IANA-error-code" class="auto internal xref">Section 5.9</a>).<a href="#section-3.5-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-chaining">
<section id="section-4">
      <h2 id="name-deriving-a-downstream-token">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-deriving-a-downstream-token" class="section-name selfRef">Deriving a Downstream Token</a>
      </h2>
<p id="section-4-1">Some architectures require an RS to act as a client instance and use a derived access
token for a secondary RS. Since the RS is not the same entity that made the initial grant
request, the RS is not capable of referencing or modifying the existing grant. As such,
the RS needs to request or generate a new access token for its use at the secondary RS.
This internal secondary token is issued in the context of the incoming access token.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">While it is possible to use a <span><a href="#structure" class="internal xref">token format</a> (<a href="#structure" class="auto internal xref">Section 2</a>)</span> that allows for the
RS to generate its own secondary token,
the AS can allow the RS to request this secondary access token using the same
process used by the original client instance to request the primary access token. Since the
RS is acting as its own client instance from the perspective of GNAP, this process
uses the same grant endpoint, request structure, and response structure as a client
instance's request.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="section-4-3">
        <div class="alignLeft art-svg artwork" id="section-4-3.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="464" viewBox="0 0 464 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
            <path d="M 8,32 L 8,176" fill="none" stroke="black"></path>
            <path d="M 80,32 L 80,176" fill="none" stroke="black"></path>
            <path d="M 144,32 L 144,176" fill="none" stroke="black"></path>
            <path d="M 208,32 L 208,176" fill="none" stroke="black"></path>
            <path d="M 272,32 L 272,96" fill="none" stroke="black"></path>
            <path d="M 328,32 L 328,96" fill="none" stroke="black"></path>
            <path d="M 392,32 L 392,176" fill="none" stroke="black"></path>
            <path d="M 456,32 L 456,176" fill="none" stroke="black"></path>
            <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
            <path d="M 144,32 L 208,32" fill="none" stroke="black"></path>
            <path d="M 272,32 L 328,32" fill="none" stroke="black"></path>
            <path d="M 392,32 L 456,32" fill="none" stroke="black"></path>
            <path d="M 80,48 L 104,48" fill="none" stroke="black"></path>
            <path d="M 120,48 L 136,48" fill="none" stroke="black"></path>
            <path d="M 208,64 L 232,64" fill="none" stroke="black"></path>
            <path d="M 248,64 L 264,64" fill="none" stroke="black"></path>
            <path d="M 216,80 L 232,80" fill="none" stroke="black"></path>
            <path d="M 248,80 L 272,80" fill="none" stroke="black"></path>
            <path d="M 272,96 L 328,96" fill="none" stroke="black"></path>
            <path d="M 208,128 L 304,128" fill="none" stroke="black"></path>
            <path d="M 320,128 L 384,128" fill="none" stroke="black"></path>
            <path d="M 216,144 L 304,144" fill="none" stroke="black"></path>
            <path d="M 320,144 L 392,144" fill="none" stroke="black"></path>
            <path d="M 88,160 L 104,160" fill="none" stroke="black"></path>
            <path d="M 120,160 L 144,160" fill="none" stroke="black"></path>
            <path d="M 8,176 L 80,176" fill="none" stroke="black"></path>
            <path d="M 144,176 L 208,176" fill="none" stroke="black"></path>
            <path d="M 392,176 L 456,176" fill="none" stroke="black"></path>
            <polygon class="arrowhead" points="392,128 380,122.4 380,133.6" fill="black" transform="rotate(0,384,128)"></polygon>
            <polygon class="arrowhead" points="272,64 260,58.4 260,69.6" fill="black" transform="rotate(0,264,64)"></polygon>
            <polygon class="arrowhead" points="224,144 212,138.4 212,149.6" fill="black" transform="rotate(180,216,144)"></polygon>
            <polygon class="arrowhead" points="224,80 212,74.4 212,85.6" fill="black" transform="rotate(180,216,80)"></polygon>
            <polygon class="arrowhead" points="144,48 132,42.4 132,53.6" fill="black" transform="rotate(0,136,48)"></polygon>
            <polygon class="arrowhead" points="96,160 84,154.4 84,165.6" fill="black" transform="rotate(180,88,160)"></polygon>
            <g class="text">
              <text x="44" y="52">Client</text>
              <text x="112" y="52">1</text>
              <text x="176" y="52">RS1</text>
              <text x="300" y="52">AS</text>
              <text x="424" y="52">RS2</text>
              <text x="44" y="68">Instance</text>
              <text x="240" y="68">2</text>
              <text x="240" y="84">3</text>
              <text x="312" y="132">4</text>
              <text x="312" y="148">5</text>
              <text x="112" y="164">6</text>
            </g>
          </svg><a href="#section-4-3.1" class="pilcrow">¶</a>
</div>
</div>
<ol start="1" type="1" class="normal type-1" id="section-4-4">
<li id="section-4-4.1">
          <p id="section-4-4.1.1">The client instance calls RS1 with an access token.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-4.2">
          <p id="section-4-4.2.1">RS1 presents that token to the AS to get a derived token
 for use at RS2. RS1 indicates that it has no ability
 to interact with the RO. Note that
 RS1 signs its request with its own key, not the token's
 key or the client instance's key.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-4.3">
          <p id="section-4-4.3.1">The AS returns a derived token to RS1 for use at RS2.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-4.4">
          <p id="section-4-4.4.1">RS1 calls RS2 with the token from (3).<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-4.5">
          <p id="section-4-4.5.1">RS2 fulfills the call from RS1.<a href="#section-4-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-4.6">
          <p id="section-4-4.6.1">RS1 fulfills the call from the original client instance.<a href="#section-4-4.6.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-5">If the RS needs to derive a token from one presented to it, it can
request one from the AS by making a token request as described in
<span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span> and presenting the existing access token's
value in the "existing_access_token" field.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Since the RS is acting as a client instance,
the RS <span class="bcp14">MUST</span> identify itself with its own key in the <code>client</code> field and sign the
request just as any client instance would, as described in <a href="#authentication" class="auto internal xref">Section 3.2</a>.
The AS <span class="bcp14">MUST</span> determine that the token being presented is appropriate for use
at the RS making the token chaining request.<a href="#section-4-6" class="pilcrow">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4-7">
<pre>
POST /tx HTTP/1.1
Host: server.example.com
Content-Type: application/json
Detached-JWS: ejy0...

{
  "access_token": {
      "access": [
          {
              "actions": [
                  "read",
                  "write",
                  "dolphin"
              ],
              "locations": [
                  "https://server.example.net/",
                  "https://resource.local/other"
              ],
              "datatypes": [
                  "metadata",
                  "images"
              ]
          },
          "dolphin-metadata"
      ]
  },
  "client": "7C7C4AZ9KHRS6X63AJAO",
  "existing_access_token": "OS9M2PMHKUR64TB8N6BW7OZB8CDFONP219RP1LT0"
}
</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
<p id="section-4-8">The AS responds with a token for the downstream RS2 as described in
<span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>. The downstream RS2 could
repeat this process as necessary for calling further RSs.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">IANA has added values to existing registries and created five registries under the "Grant Negotiation and Authorization Protocol (GNAP)" registry group.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="IANA-well-known">
<section id="section-5.1">
        <h3 id="name-well-known-uris">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-well-known-uris" class="section-name selfRef">Well-Known URIs</a>
        </h3>
<p id="section-5.1-1">The "gnap-as-rs" URI suffix is registered in the "Well-Known URIs" registry to support RS-facing discovery of the AS.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">URI Suffix:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">gnap-as-rs<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.4">IETF<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">Specification Document:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.6">
            <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767<a href="#section-5.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.7">Status:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.8">Permanent<a href="#section-5.1-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-grant-request">
<section id="section-5.2">
        <h3 id="name-gnap-grant-request-paramete">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-gnap-grant-request-paramete" class="section-name selfRef">GNAP Grant Request Parameters</a>
        </h3>
<p id="section-5.2-1">The following parameter is registered in the "GNAP Grant Request Parameters" registry:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.2-2">
          <dt id="section-5.2-2.1">Name:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.2">
            <code>existing_access_token</code><a href="#section-5.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.4">
            string<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.6">
            <a href="#token-chaining" class="auto internal xref">Section 4</a> of RFC 9767<a href="#section-5.2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-token-format">
<section id="section-5.3">
        <h3 id="name-gnap-token-formats">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-gnap-token-formats" class="section-name selfRef">GNAP Token Formats</a>
        </h3>
<p id="section-5.3-1">This document defines a GNAP token format, for which IANA has created and maintains a new registry titled "GNAP Token Formats". Initial values for this registry are given in <a href="#IANA-token-format-contents" class="auto internal xref">Section 5.3.2</a>. Future assignments and modifications to existing assignment are to be made through the Specification Required registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The designated expert (DE) is expected to ensure that:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">
            <p id="section-5.3-3.1.1">all registrations follow the template presented in <a href="#IANA-token-format-template" class="auto internal xref">Section 5.3.1</a>.<a href="#section-5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-3.2">
            <p id="section-5.3-3.2.1">the format's definition is sufficiently unique from other formats provided by existing parameters.<a href="#section-5.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-3.3">
            <p id="section-5.3-3.3.1">the format's definition specifies the format of the access token in sufficient detail to allow for the AS and RS to be able to communicate the token information.<a href="#section-5.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-token-format-template">
<section id="section-5.3.1">
          <h4 id="name-registry-template">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-registry-template" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.3.1-1">
            <dt id="section-5.3.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-1.2">
              The name of the format.<a href="#section-5.3.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-1.3">Status:</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-1.4">
              Whether or not the format is in active use. Possible values are Active and Deprecated.<a href="#section-5.3.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-1.5">Description:</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-1.6">
              The human-readable description of the access token format.<a href="#section-5.3.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.1-1.7">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.3.1-1.8">
              The specification that defines the token format.<a href="#section-5.3.1-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-token-format-contents">
<section id="section-5.3.2">
          <h4 id="name-initial-registry-contents">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-initial-registry-contents" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<span id="name-initial-contents-of-the-gna"></span><table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-initial-contents-of-the-gna" class="selfRef">Initial Contents of the GNAP Token Formats Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>jwt-signed</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">JSON Web Token, signed with JWS</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>jwt-encrypted</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">JSON Web Token, encrypted with JWE</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC7519" class="cite xref">JWT</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>macaroon</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Macaroon</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#MACAROON" class="cite xref">MACAROON</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>biscuit</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">Biscuit</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#BISCUIT" class="cite xref">BISCUIT</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>zcap</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Active</td>
                <td class="text-left" rowspan="1" colspan="1">ZCAP</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#ZCAPLD" class="cite xref">ZCAPLD</a>]</span>
</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-token-introspection-request">
<section id="section-5.4">
        <h3 id="name-gnap-token-introspection-re">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-gnap-token-introspection-re" class="section-name selfRef">GNAP Token Introspection Request</a>
        </h3>
<p id="section-5.4-1">This document defines GNAP token introspection, for which IANA has created and maintains a new registry titled "GNAP Token Introspection Request". Initial values for this registry are given in <a href="#IANA-token-introspection-request-contents" class="auto internal xref">Section 5.4.2</a>. Future assignments and modifications to existing assignment are to be made through the Specification Required registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The DE is expected to ensure that:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.1">
            <p id="section-5.4-3.1.1">all registrations follow the template presented in <a href="#IANA-token-introspection-request-template" class="auto internal xref">Section 5.4.1</a>.<a href="#section-5.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.2">
            <p id="section-5.4-3.2.1">the claim's definition is sufficiently orthogonal to other claims defined in the registry so as avoid overlapping functionality.<a href="#section-5.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.3">
            <p id="section-5.4-3.3.1">the claim's definition specifies the syntax and semantics of the claim in sufficient detail to allow for the AS and RS to be able to communicate the token values.<a href="#section-5.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-token-introspection-request-template">
<section id="section-5.4.1">
          <h4 id="name-registry-template-2">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-registry-template-2" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.4.1-1">
            <dt id="section-5.4.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.1-1.2">
              The name of the claim.<a href="#section-5.4.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.1-1.3">Type:</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.1-1.4">
              The JSON data type of the claim value.<a href="#section-5.4.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.4.1-1.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.4.1-1.6">
              The specification that defines the claim.<a href="#section-5.4.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-token-introspection-request-contents">
<section id="section-5.4.2">
          <h4 id="name-initial-registry-contents-2">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-initial-registry-contents-2" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-5.4.2-1">The table below contains the initial contents of the "GNAP Token Introspection Request" registry.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-gnap"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-contents-of-the-gnap" class="selfRef">Initial Contents of the GNAP Token Introspection Request Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">access_token</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">proof</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">resource_server</td>
                <td class="text-left" rowspan="1" colspan="1">object/string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">access</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings/objects</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-token-introspection">
<section id="section-5.5">
        <h3 id="name-gnap-token-introspection-res">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-gnap-token-introspection-res" class="section-name selfRef">GNAP Token Introspection Response</a>
        </h3>
<p id="section-5.5-1">This document defines GNAP token introspection, for which IANA has created and maintains a new registry titled "GNAP Token Introspection Response". Initial values for this registry are given in <a href="#IANA-token-introspection-contents" class="auto internal xref">Section 5.5.2</a>. Future assignments and modifications to existing assignment are to be made through the Specification Required registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">The DE is expected to ensure that:<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-3.1">
            <p id="section-5.5-3.1.1">all registrations follow the template presented in <a href="#IANA-token-introspection-template" class="auto internal xref">Section 5.5.1</a>.<a href="#section-5.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-3.2">
            <p id="section-5.5-3.2.1">the claim's definition is sufficiently orthogonal to other claims defined in the registry so as avoid overlapping functionality.<a href="#section-5.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-3.3">
            <p id="section-5.5-3.3.1">the claim's definition specifies the syntax and semantics of the claim in sufficient detail to allow for the AS and RS to be able to communicate the token values.<a href="#section-5.5-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-token-introspection-template">
<section id="section-5.5.1">
          <h4 id="name-registry-template-3">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-registry-template-3" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.5.1-1">
            <dt id="section-5.5.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.5.1-1.2">
              The name of the claim.<a href="#section-5.5.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.5.1-1.3">Type:</dt>
            <dd style="margin-left: 1.5em" id="section-5.5.1-1.4">
              The JSON data type of the claim value.<a href="#section-5.5.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.5.1-1.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.5.1-1.6">
              The specification that defines the claim.<a href="#section-5.5.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-token-introspection-contents">
<section id="section-5.5.2">
          <h4 id="name-initial-registry-contents-3">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-initial-registry-contents-3" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-5.5.2-1">The table below contains the initial contents of the "GNAP Token Introspection Response" registry.<a href="#section-5.5.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-gnap-"></span><table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-initial-contents-of-the-gnap-" class="selfRef">Initial Contents of the GNAP Token Introspection Response Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">active</td>
                <td class="text-left" rowspan="1" colspan="1">boolean</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">access</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings/objects</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">key</td>
                <td class="text-left" rowspan="1" colspan="1">object/string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">flags</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">exp</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">iat</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">nbf</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">aud</td>
                <td class="text-left" rowspan="1" colspan="1">string or array of strings</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sub</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">iss</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">instance_id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#introspection" class="auto internal xref">Section 3.3</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-resource-registration-request">
<section id="section-5.6">
        <h3 id="name-gnap-resource-set-registrat">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-gnap-resource-set-registrat" class="section-name selfRef">GNAP Resource Set Registration Request Parameters</a>
        </h3>
<p id="section-5.6-1">This document defines a means to register a resource set for a GNAP AS, for which IANA has created and maintains a new registry titled "GNAP Resource Set Registration Request Parameters". Initial values for this registry are given in <a href="#IANA-resource-registration-request-contents" class="auto internal xref">Section 5.6.2</a>. Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">The DE is expected to ensure that:<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-3.1">
            <p id="section-5.6-3.1.1">all registrations follow the template presented in <a href="#IANA-resource-registration-request-template" class="auto internal xref">Section 5.6.1</a>.<a href="#section-5.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.2">
            <p id="section-5.6-3.2.1">the parameter's definition is sufficiently orthogonal to other parameters defined in the registry so as avoid overlapping functionality.<a href="#section-5.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.3">
            <p id="section-5.6-3.3.1">the parameter's definition specifies the syntax and semantics of the parameter in sufficient detail to allow for the AS and RS to be able to communicate the resource set.<a href="#section-5.6-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-resource-registration-request-template">
<section id="section-5.6.1">
          <h4 id="name-registry-template-4">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-registry-template-4" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.6.1-1">
            <dt id="section-5.6.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.6.1-1.2">
              The name of the parameter.<a href="#section-5.6.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.6.1-1.3">Type:</dt>
            <dd style="margin-left: 1.5em" id="section-5.6.1-1.4">
              The JSON data type of the parameter value.<a href="#section-5.6.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.6.1-1.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.6.1-1.6">
              The specification that defines the token.<a href="#section-5.6.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-resource-registration-request-contents">
<section id="section-5.6.2">
          <h4 id="name-initial-registry-contents-4">
<a href="#section-5.6.2" class="section-number selfRef">5.6.2. </a><a href="#name-initial-registry-contents-4" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-5.6.2-1">The table below contains the initial contents of the "GNAP Resource Set Registration Request Parameters" registry.<a href="#section-5.6.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-gnap-r"></span><table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-initial-contents-of-the-gnap-r" class="selfRef">Initial Contents of the GNAP Resource Set Registration Request Parameters Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">access</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings/objects</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">resource_server</td>
                <td class="text-left" rowspan="1" colspan="1">object/string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">token_formats_supported</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">token_introspection_required</td>
                <td class="text-left" rowspan="1" colspan="1">boolean</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-resource-registration-response">
<section id="section-5.7">
        <h3 id="name-gnap-resource-set-registrati">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-gnap-resource-set-registrati" class="section-name selfRef">GNAP Resource Set Registration Response Parameters</a>
        </h3>
<p id="section-5.7-1">This document defines a means to register a resource set for a GNAP AS, for which IANA has created and maintains a new registry titled "GNAP Resource Set Registration Response Parameters". Initial values for this registry are given in <a href="#IANA-resource-registration-response-contents" class="auto internal xref">Section 5.7.2</a>. Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">The DE is expected to ensure that:<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-3.1">
            <p id="section-5.7-3.1.1">all registrations follow the template presented in <a href="#IANA-resource-registration-response-template" class="auto internal xref">Section 5.7.1</a>.<a href="#section-5.7-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.7-3.2">
            <p id="section-5.7-3.2.1">the parameter's definition is sufficiently orthogonal to other claims defined in the registry so as avoid overlapping functionality.<a href="#section-5.7-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.7-3.3">
            <p id="section-5.7-3.3.1">the parameter's definition specifies the syntax and semantics of the claim in sufficient detail to allow for the AS and RS to be able to communicate the resource set.<a href="#section-5.7-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-resource-registration-response-template">
<section id="section-5.7.1">
          <h4 id="name-registry-template-5">
<a href="#section-5.7.1" class="section-number selfRef">5.7.1. </a><a href="#name-registry-template-5" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.7.1-1">
            <dt id="section-5.7.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.7.1-1.2">
              The name of the parameter.<a href="#section-5.7.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.7.1-1.3">Type:</dt>
            <dd style="margin-left: 1.5em" id="section-5.7.1-1.4">
              The JSON data type of the parameter value.<a href="#section-5.7.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.7.1-1.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.7.1-1.6">
              The specification that defines the parameter.<a href="#section-5.7.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-resource-registration-response-contents">
<section id="section-5.7.2">
          <h4 id="name-initial-registry-contents-5">
<a href="#section-5.7.2" class="section-number selfRef">5.7.2. </a><a href="#name-initial-registry-contents-5" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-5.7.2-1">The table below contains the initial contents of the "GNAP Resource Set Registration Response Parameters" registry.<a href="#section-5.7.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-gnap-re"></span><table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-initial-contents-of-the-gnap-re" class="selfRef">Initial Contents of the GNAP Resource Set Registration Response Parameters Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">resource_reference</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">instance_id</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">introspection_endpoint</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-rs-discovery">
<section id="section-5.8">
        <h3 id="name-gnap-rs-facing-discovery-do">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-gnap-rs-facing-discovery-do" class="section-name selfRef">GNAP RS-Facing Discovery Document Fields</a>
        </h3>
<p id="section-5.8-1">This document defines a means to for a GNAP AS to be discovered by a GNAP RS, for which IANA has created and maintains a new registry titled "GNAP RS-Facing Discovery Document Fields". Initial values for this registry are given in <a href="#IANA-rs-discovery-contents" class="auto internal xref">Section 5.8.2</a>. Future assignments and modifications to existing assignment are to be made through the Expert Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">The DE is expected to ensure that:<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.8-3.1">
            <p id="section-5.8-3.1.1">all registrations follow the template presented in <a href="#IANA-rs-discovery-template" class="auto internal xref">Section 5.8.1</a>.<a href="#section-5.8-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.8-3.2">
            <p id="section-5.8-3.2.1">the field's definition is sufficiently orthogonal to other fields defined in the registry so as avoid overlapping functionality.<a href="#section-5.8-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.8-3.3">
            <p id="section-5.8-3.3.1">the field's definition specifies the syntax and semantics of the fields in sufficient detail to allow for the RS to be able to communicate with the AS.<a href="#section-5.8-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-rs-discovery-template">
<section id="section-5.8.1">
          <h4 id="name-registry-template-6">
<a href="#section-5.8.1" class="section-number selfRef">5.8.1. </a><a href="#name-registry-template-6" class="section-name selfRef">Registry Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.8.1-1">
            <dt id="section-5.8.1-1.1">Name:</dt>
            <dd style="margin-left: 1.5em" id="section-5.8.1-1.2">
              The name of the field.<a href="#section-5.8.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.8.1-1.3">Type:</dt>
            <dd style="margin-left: 1.5em" id="section-5.8.1-1.4">
              The JSON data type of the field value.<a href="#section-5.8.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.8.1-1.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.8.1-1.6">
              The specification that defines the field.<a href="#section-5.8.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-rs-discovery-contents">
<section id="section-5.8.2">
          <h4 id="name-initial-registry-contents-6">
<a href="#section-5.8.2" class="section-number selfRef">5.8.2. </a><a href="#name-initial-registry-contents-6" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<p id="section-5.8.2-1">The table below contains the initial contents of the "GNAP RS-Facing Discovery Document Fields" registry.<a href="#section-5.8.2-1" class="pilcrow">¶</a></p>
<span id="name-initial-contents-of-the-gnap-rs"></span><table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-initial-contents-of-the-gnap-rs" class="selfRef">Initial Contents of the GNAP RS-Facing Discovery Document Fields Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">introspection_endpoint</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">token_formats_supported</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">resource_registration_endpoint</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">grant_request_endpoint</td>
                <td class="text-left" rowspan="1" colspan="1">string</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">key_proofs_supported</td>
                <td class="text-left" rowspan="1" colspan="1">array of strings</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#discovery" class="auto internal xref">Section 3.1</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="IANA-error-code">
<section id="section-5.9">
        <h3 id="name-gnap-rs-facing-error-codes">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-gnap-rs-facing-error-codes" class="section-name selfRef">GNAP RS-Facing Error Codes</a>
        </h3>
<p id="section-5.9-1">This document defines a set of errors that the AS can return to the RS, for which IANA has created and maintains a new registry titled "GNAP RS-Facing Error Codes". Initial values for this registry are given in <a href="#IANA-error-code-contents" class="auto internal xref">Section 5.9.2</a>. Future assignments and modifications to existing assignments are to be made through the Specification Required registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<p id="section-5.9-2">The DE is expected to ensure that:<a href="#section-5.9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-3.1">
            <p id="section-5.9-3.1.1">all registrations follow the template presented in <a href="#IANA-error-code-template" class="auto internal xref">Section 5.9.1</a>.<a href="#section-5.9-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.9-3.2">
            <p id="section-5.9-3.2.1">the error response is sufficiently unique from other errors to provide actionable information to the client instance.<a href="#section-5.9-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.9-3.3">
            <p id="section-5.9-3.3.1">the definition of the error response specifies all conditions in which the error response is returned and what the client instance's expected action is.<a href="#section-5.9-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="IANA-error-code-template">
<section id="section-5.9.1">
          <h4 id="name-registration-template">
<a href="#section-5.9.1" class="section-number selfRef">5.9.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.9.1-1">
            <dt id="section-5.9.1-1.1">Error:</dt>
            <dd style="margin-left: 1.5em" id="section-5.9.1-1.2">
              A unique string code for the error.<a href="#section-5.9.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.9.1-1.3">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-5.9.1-1.4">
              Reference to the document(s) that specifies the
  value, preferably including a URI that can be used
  to retrieve a copy of the document(s). An indication of the
  relevant sections may also be included but is not required.<a href="#section-5.9.1-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA-error-code-contents">
<section id="section-5.9.2">
          <h4 id="name-initial-contents">
<a href="#section-5.9.2" class="section-number selfRef">5.9.2. </a><a href="#name-initial-contents" class="section-name selfRef">Initial Contents</a>
          </h4>
<span id="name-initial-contents-of-the-gnap-rs-"></span><table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-initial-contents-of-the-gnap-rs-" class="selfRef">Initial Contents of the GNAP RS-Facing Error Codes Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Error</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">invalid_request</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#response-error" class="auto internal xref">Section 3.5</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">invalid_resource_server</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#response-error" class="auto internal xref">Section 3.5</a> of RFC 9767</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">invalid_access</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#response-error" class="auto internal xref">Section 3.5</a> of RFC 9767</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">In addition to the normative requirements in this document and in <span>[<a href="#RFC9635" class="cite xref">GNAP</a>]</span>, implementers are
strongly encouraged to consider the following additional security considerations in implementations
and deployments of GNAP.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="security-tls">
<section id="section-6.1">
        <h3 id="name-tls-protection-in-transit">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-tls-protection-in-transit" class="section-name selfRef">TLS Protection in Transit</a>
        </h3>
<p id="section-6.1-1">All requests in GNAP made over untrusted network connections have to be made over TLS as outlined in <span>[<a href="#BCP195" class="cite xref">BCP195</a>]</span>
to protect the contents of the request and response from manipulation and interception by an attacker.
This includes all requests from a client instance to the RS and all requests from the RS to an AS.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-token-validation">
<section id="section-6.2">
        <h3 id="name-token-validation">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-token-validation" class="section-name selfRef">Token Validation</a>
        </h3>
<p id="section-6.2-1">The RS has a responsibility to validate the incoming access token in a manner consistent with its deployment.
For self-contained stateless tokens such as those described in <a href="#token-format" class="auto internal xref">Section 2.2</a>, this consists of actions such
as validating the token's signature and ensuring the relevant fields and results are appropriate for the
request being made. For reference-style tokens or tokens that are otherwise opaque to the RS, the token introspection
RS-facing API can be used to provide updated information about the state of the token, as described in <a href="#introspection" class="auto internal xref">Section 3.3</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The RS needs to validate that a token:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">is intended for this RS (audience restriction)<a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">is presented using the appropriate key for the token (see also <a href="#security-key-proof" class="auto internal xref">Section 6.4</a>)<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">identifies an appropriate subject to access the resource (usually this is the resource owner who authorized the token's issuance)<a href="#section-6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">is issued by a trusted AS for this resource<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-4">Even though key proofing mechanisms have to cover the value of the token, validating the key proofing alone
is not sufficient to protect a request to an RS.
If an RS validates only the presentation method as described in <a href="#security-key-proof" class="auto internal xref">Section 6.4</a> without validating the
token itself, an attacker could use a compromised key or a confused deputy to make arbitrary calls to the RS
beyond what has been authorized by the RO.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-token-cache">
<section id="section-6.3">
        <h3 id="name-caching-token-validation-re">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-caching-token-validation-re" class="section-name selfRef">Caching Token Validation Result</a>
        </h3>
<p id="section-6.3-1">Since token validation can be an expensive process, requiring either cryptographic operations or network calls to an introspection
service as described in <a href="#introspection" class="auto internal xref">Section 3.3</a>, an RS could cache the results of token validation for a particular token.
The trade-off for using a cached validation for a token presents an important decision space for implementers: relying on a cached validation result
increases performance and lowers processing overhead, but it comes at the expense of the liveness and accuracy of the information
in the cache. While a cached value is in use at the RS, an attacker could present a revoked token and have it accepted by the RS.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">As with any cache, the consistency of this cache can be managed in a variety of ways. One of the most simple
methods is managing the lifetime of the cache in order to balance the performance and security properties.
If the cache is too long, an attacker has a larger window in which to use a revoked token. If the window is too short, the benefits of using the cache are diminished.
It is also possible that an AS could send a proactive signal to the RS to invalidate revoked access tokens, though such a mechanism
is outside the scope of this specification.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-key-proof">
<section id="section-6.4">
        <h3 id="name-key-proof-validation">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-key-proof-validation" class="section-name selfRef">Key Proof Validation</a>
        </h3>
<p id="section-6.4-1">For key-bound access tokens, the proofing method needs to be validated alongside the value of the token itself, as described in <a href="#security-token-validation" class="auto internal xref">Section 6.2</a>.
The process of validation is defined by the key proofing method, as described in <span><a href="https://rfc-editor.org/rfc/rfc9635#section-7.3" class="relref">Section 7.3</a> of [<a href="#RFC9635" class="cite xref">GNAP</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">If the proofing method is not validated, an attacker could use a compromised token without access to the token's bound key.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">The RS also needs to ensure that the proofing method is appropriate for the key associated with the token, including any choice of algorithm or identifiers.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">The proofing should be validated independently on each request to the RS, particularly as aspects of the call could vary.
As such, the RS should never cache the results of a proof validation from one message and apply it to a subsequent message.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-exfiltration">
<section id="section-6.5">
        <h3 id="name-token-exfiltration">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-token-exfiltration" class="section-name selfRef">Token Exfiltration</a>
        </h3>
<p id="section-6.5-1">Since the RS sees the token value, it is possible for a compromised RS to leak that value to an attacker.
As such, the RS needs to protect token values as sensitive information and protect them from exfiltration.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">This is especially problematic with bearer tokens and tokens bound to a shared key, since an RS has access
to all information necessary to create a new, valid request using the token in question.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-token-reuse-by-rs">
<section id="section-6.6">
        <h3 id="name-token-reuse-by-an-rs">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-token-reuse-by-an-rs" class="section-name selfRef">Token Reuse by an RS</a>
        </h3>
<p id="section-6.6-1">If the access token is a bearer token, or the RS has access to the key material needed to present the token,
the RS could be tricked into reusing an access token presented to it by a client. While it is possible to build
a system that makes use of this artifact as a feature, it is safer to exchange the incoming access token for
another contextual token for use by the RS, as described in <a href="#token-chaining" class="auto internal xref">Section 4</a>. This access token can be bound
to the RS's own keys and limited to access needed by the RS, instead of the full set of rights associated with
the token issued to the client instance.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-format-considerations">
<section id="section-6.7">
        <h3 id="name-token-format-considerations">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-token-format-considerations" class="section-name selfRef">Token Format Considerations</a>
        </h3>
<p id="section-6.7-1">With formatted tokens, the format of the token is likely to have its own considerations, and the RS needs
to follow any such considerations during the token validation process. The application and scope of
these considerations is specific to the format and outside the scope of this specification.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="over-sharing-token-contents">
<section id="section-6.8">
        <h3 id="name-oversharing-token-contents">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-oversharing-token-contents" class="section-name selfRef">Oversharing Token Contents</a>
        </h3>
<p id="section-6.8-1">The contents of the access token model divulge information about the access token's context and rights to the RS.
This is true whether the contents are parsed from the token itself or sent in an introspection response.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">It's likely that every RS does not need to know all details of the token model, especially in systems where
a single access token is usable across multiple RSs. An attacker could use this to gain information about
the larger system by compromising only one RS. By limiting the information available to only
that which is relevant to a specific RS, such as using a limited introspection reply as defined in <a href="#introspection" class="auto internal xref">Section 3.3</a>,
a system can follow the principle of least disclosure to each RS.<a href="#section-6.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resource-references">
<section id="section-6.9">
        <h3 id="name-resource-references">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-resource-references" class="section-name selfRef">Resource References</a>
        </h3>
<p id="section-6.9-1">Resource references, as returned by the protocol in <a href="#rs-register-resource-handle" class="auto internal xref">Section 3.4</a>, are intended to be opaque to
both the RS and the client. However, since they are under the control of the AS, the AS can put whatever content
it wants into the reference value. This value could unintentionally disclose system structure or other internal
details if it was processed by an unintended party. Furthermore, such patterns could lead to the client software and
RS depending on certain structures being present in the reference value, which diminishes the separation of concerns
of the different roles in a GNAP system.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<p id="section-6.9-2">To mitigate this, the AS should only use fully random or encrypted values for resource references.<a href="#section-6.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-re-issuance-from-an-untrusted-as">
<section id="section-6.10">
        <h3 id="name-token-reissuance-from-an-un">
<a href="#section-6.10" class="section-number selfRef">6.10. </a><a href="#name-token-reissuance-from-an-un" class="section-name selfRef">Token Reissuance from an Untrusted AS</a>
        </h3>
<p id="section-6.10-1">It is possible for an attacker's client instance to issue its own tokens to another client instance, acting as
an AS that the second client instance has chosen to trust. If the token is a bearer token or the reissuance
is bound using an AS-provided key, the target client instance will not be able to tell that the token was originally
issued by the valid AS. This process allows an attacker to insert their own session and rights into an unsuspecting
client instance in the guise of a valid token for the attacker that appears to have been issued to the target
client instance on behalf of its own RO.<a href="#section-6.10-1" class="pilcrow">¶</a></p>
<p id="section-6.10-2">This attack is predicated on a misconfiguration with the targeted client, as it has been configured to get tokens
from the attacker's AS and use those tokens with the target RS, which has no association with the attacker's AS.
However, since the token is ultimately coming from the trusted AS and is being presented with a valid key,
the RS has no way of telling that the token was passed through an intermediary.<a href="#section-6.10-2" class="pilcrow">¶</a></p>
<p id="section-6.10-3">To mitigate this, the RS can publish its association with the trusted AS through either discovery or documentation.
Therefore, a client properly following this association would only go directly to the trusted RS for
 access tokens for the RS.<a href="#section-6.10-3" class="pilcrow">¶</a></p>
<p id="section-6.10-4">Furthermore, limiting the use of bearer tokens and AS-provided keys to only highly trusted ASs in certain circumstances prevents the attacker from being able to willingly exfiltrate their token to an unsuspecting client instance.<a href="#section-6.10-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="introspection-of-token-keys">
<section id="section-6.11">
        <h3 id="name-introspection-of-token-keys">
<a href="#section-6.11" class="section-number selfRef">6.11. </a><a href="#name-introspection-of-token-keys" class="section-name selfRef">Introspection of Token Keys</a>
        </h3>
<p id="section-6.11-1">The introspection response defined in <a href="#introspection" class="auto internal xref">Section 3.3</a> provides a means for the AS to tell the RS what key material is needed to validate the key proof of the request. Capture of the introspection response can expose
these security keys to an attacker. In the case of asymmetric cryptography, only the public key is exposed,
and the token cannot be reused by the attacker based on this result alone. This could potentially divulge
information about the client instance that was unknown otherwise.<a href="#section-6.11-1" class="pilcrow">¶</a></p>
<p id="section-6.11-2">If an access token is bound to a symmetric key, the RS will need access to the full key value in order to validate
the key proof of the request, as described in <a href="#security-key-proof" class="auto internal xref">Section 6.4</a>. However, divulging the key
material to the RS also gives the RS the ability to create a new request with the token.
In this circumstance, the RS is under similar risk of token exfiltration and
reuse as a bearer token, as described in <a href="#security-token-reuse-by-rs" class="auto internal xref">Section 6.6</a>. Consequently, symmetric
keys should only be used in systems where the RS can be fully trusted to not create a new request with
tokens presented to it.<a href="#section-6.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-rs-registration">
<section id="section-6.12">
        <h3 id="name-rs-registration-and-managem">
<a href="#section-6.12" class="section-number selfRef">6.12. </a><a href="#name-rs-registration-and-managem" class="section-name selfRef">RS Registration and Management</a>
        </h3>
<p id="section-6.12-1">Most functions of the RS-facing API in <a href="#rs-facing-api" class="auto internal xref">Section 3</a> are protected by requiring the RS to
present proof of a signing key along with the request, in order to identify the RS making the
call, potentially coupled with an AS-specific access token.
This practice allows the AS to differentially respond to API calls to different RSs, such as
answering introspection calls with only the access rights relevant to a given RS instead of
all access rights an access token could be good for.<a href="#section-6.12-1" class="pilcrow">¶</a></p>
<p id="section-6.12-2">While the means by which an RS and its keys become known to the AS is out of scope for this
specification, it is anticipated that common practice will be to statically register an
RS, allowing it to protect specific resources or certain classes of resources.
Fundamentally, the RS can only offer the resources that it serves. However, a rogue AS could
attempt to register a set of resources that mimics a different RS in order to solicit an access
token that is usable at the target RS. If the access token is a bearer token or is bound to a symmetric
key that is known to the RS, then the attacker's RS gains the ability and knowledge needed
to use that token elsewhere.<a href="#section-6.12-2" class="pilcrow">¶</a></p>
<p id="section-6.12-3">In some ecosystems, dynamic registration of an RS and its associated resources is feasible.
In such systems, the identity of the RS could be conveyed by a URI passed in the <code>location</code> field
of an access rights request, thereby allowing the AS to limit the view the RS has into the
larger system.<a href="#section-6.12-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Privacy">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="token-contents">
<section id="section-7.1">
        <h3 id="name-token-contents">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-token-contents" class="section-name selfRef">Token Contents</a>
        </h3>
<p id="section-7.1-1">The contents of the access token could potentially contain personal information about the end user, RO, or other parties.
This is true whether the contents are parsed from the token itself or sent in an introspection response.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">While an RS will sometimes need this information for processing, it's often the case that an RS is exposed to these
details only in passing, and not intentionally. For example, consider a client that has been issued an access token that is
usable for both medical and non-medical APIs. If this access token contains a medical record number to facilitate the
RS serving the medical API, then any RS for a non-medical API would also learn the user's medical record number
in the process, even though that API has no need to make such a correlation.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">To mitigate this, a formatted token could contain separate sections targeted to different RSs to segregate data.
Alternatively, token introspection can be used to limit the data returned to each RS, as defined in <a href="#introspection" class="auto internal xref">Section 3.3</a>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-use-disclosure-through-introspection">
<section id="section-7.2">
        <h3 id="name-token-use-disclosure-throug">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-token-use-disclosure-throug" class="section-name selfRef">Token Use Disclosure through Introspection</a>
        </h3>
<p id="section-7.2-1">When introspection is used by an RS, the AS is made aware of a particular token being used at a particular RS.
When the RS is a separate system, the AS would not otherwise have insight into this action. This can potentially
lead to the AS learning about patterns and actions of particular end users by watching which RSs are accessed
and when.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mapping-a-user-to-an-as">
<section id="section-7.3">
        <h3 id="name-mapping-a-user-to-an-as">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-mapping-a-user-to-an-as" class="section-name selfRef">Mapping a User to an AS</a>
        </h3>
<p id="section-7.3-1">When the client instance receives information about the protecting AS from an RS, it can be used to
derive information about the resources being protected without releasing the resources themselves. For example,
if a medical record is protected by a personal AS, an untrusted client could call an RS to discover the location
of the AS protecting the record. Since the AS is tied strongly to a single RO, the untrusted and unauthorized client
software can gain information about the resource being protected without accessing the record itself.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd>
<div class="refInstance">Best Current Practice 195, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC8996">
            <span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </div>
<div class="refInstance" id="RFC9325">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9325">https://www.rfc-editor.org/info/rfc9325</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="RFC9635">[GNAP]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span> and <span class="refAuthor">F. Imbault</span>, <span class="refTitle">"Grant Negotiation and Authorization Protocol (GNAP)"</span>, <span class="seriesInfo">RFC 9635</span>, <span class="seriesInfo">DOI 10.17487/RFC9635</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9635">https://www.rfc-editor.org/info/rfc9635</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[JWT]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BISCUIT">[BISCUIT]</dt>
        <dd>
<span class="refAuthor">Biscuit</span>, <span class="refTitle">"Biscuit Authorization"</span>, <span>&lt;<a href="https://www.biscuitsec.org/">https://www.biscuitsec.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MACAROON">[MACAROON]</dt>
        <dd>
<span class="refAuthor">Birgisson, A.</span>, <span class="refAuthor">Politz, J. G.</span>, <span class="refAuthor">Erlingsson, U.</span>, <span class="refAuthor">Taly, A.</span>, <span class="refAuthor">Vrable, M.</span>, and <span class="refAuthor">M. Lentczner</span>, <span class="refTitle">"Macaroons: Cookies with Contextual Caveats for Decentralized Authorization in the Cloud"</span>, <span class="refContent">NDSS Symposium 2014</span>, <span class="seriesInfo">DOI 10.14722/ndss.2014.23212</span>, <time datetime="2014-02" class="refDate">February 2014</time>, <span>&lt;<a href="https://www.ndss-symposium.org/ndss2014/%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ndss-2014-programme/macaroons-cookies-contextual-caveats-%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20decentralized-authorization-cloud/">https://www.ndss-symposium.org/ndss2014/               ndss-2014-programme/macaroons-cookies-contextual-caveats-               decentralized-authorization-cloud/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZCAPLD">[ZCAPLD]</dt>
      <dd>
<span class="refAuthor">Lemmer-Webber, C., Ed.</span> and <span class="refAuthor">M. Sporny, Ed.</span>, <span class="refTitle">"Authorization Capabilities for Linked Data v0.3"</span>, <span class="refContent">W3C Draft Community Group Report</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://w3c-ccg.github.io/zcap-spec/">https://w3c-ccg.github.io/zcap-spec/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The editors would like to thank the following
      individuals for their reviews, feedback, implementations, and contributions:
      <span class="contact-name">Aaron Parecki</span>, <span class="contact-name">Adrian       Gropper</span>, <span class="contact-name">Andrii Deinega</span>, <span class="contact-name">Annabelle Backman</span>, <span class="contact-name">Dmitry Barinov</span>,
      <span class="contact-name">Fabien Imbault</span>, <span class="contact-name">Florian       Helmschmidt</span>, <span class="contact-name">George Fletcher</span>, <span class="contact-name">Justin Richer</span>, <span class="contact-name">Kathleen Moriarty</span>,
      <span class="contact-name">Leif Johansson</span>, <span class="contact-name">Mike Varley</span>,
      <span class="contact-name">Nat Sakimura</span>, <span class="contact-name">Takahiko       Kawasaki</span>, and <span class="contact-name">Yaron Sheffer</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Additionally, the editors want to acknowledge the immense contributions of
      <span class="contact-name">Aaron Parecki</span> to the content of this document. We
      thank him for his insight, input, and hard work, without which GNAP
      would not have grown to what it is.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Justin Richer (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Bespoke Engineering</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@justin.richer.org" class="email">ietf@justin.richer.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://bspk.io/" class="url">https://bspk.io/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fabien Imbault</span></div>
<div dir="auto" class="left"><span class="org">acert.io</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fabien.imbault@acert.io" class="email">fabien.imbault@acert.io</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://acert.io/" class="url">https://acert.io/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
