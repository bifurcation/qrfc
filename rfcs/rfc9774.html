<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9774: Deprecation of AS_SET and AS_CONFED_SET in BGP</title>
<meta content="Warren Kumari" name="author">
<meta content="Kotikalapudi Sriram" name="author">
<meta content="Lilia Hannachi" name="author">
<meta content="Jeffrey Haas" name="author">
<meta content="
       BCP 172 (i.e., RFC 6472) recommends not using AS_SET and AS_CONFED_SET
      AS_PATH segment types in the Border Gateway Protocol (BGP). This document
      advances that recommendation to a standards requirement in BGP; it
      prohibits the use of the AS_SET and AS_CONFED_SET path segment types
      in the AS_PATH.  This is done to simplify the design and implementation
      of BGP and to make the semantics of the originator of a BGP route clearer.
      This will also simplify the design, implementation, and deployment of
      various BGP security mechanisms. This document updates RFC 4271 by
      deprecating the origination of BGP routes with AS_SET (Type 1 AS_PATH segment) and
      updates RFC 5065 by deprecating the origination of BGP
      routes with AS_CONFED_SET (Type 4 AS_PATH segment).
      Finally, it obsoletes RFC 6472. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="9774" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9774.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-idr-deprecate-as-set-confed-set-18" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9774" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9774</td>
<td class="center">Deprecation of AS_SET and AS_CONFED_SET</td>
<td class="right">May 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kumari, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9774" class="eref">9774</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6472" class="eref">6472</a> </dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc4271" class="eref">4271</a>, <a href="https://www.rfc-editor.org/rfc/rfc5065" class="eref">5065</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-05" class="published">May 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Kumari</div>
<div class="org">Google, Inc.</div>
</div>
<div class="author">
      <div class="author-name">K. Sriram</div>
<div class="org">USA NIST</div>
</div>
<div class="author">
      <div class="author-name">L. Hannachi</div>
<div class="org">USA NIST</div>
</div>
<div class="author">
      <div class="author-name">J. Haas</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9774</h1>
<h1 id="title">Deprecation of AS_SET and AS_CONFED_SET in BGP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BCP 172 (i.e., RFC 6472) recommends not using AS_SET and AS_CONFED_SET
      AS_PATH segment types in the Border Gateway Protocol (BGP). This document
      advances that recommendation to a standards requirement in BGP; it
      prohibits the use of the AS_SET and AS_CONFED_SET path segment types
      in the AS_PATH.  This is done to simplify the design and implementation
      of BGP and to make the semantics of the originator of a BGP route clearer.
      This will also simplify the design, implementation, and deployment of
      various BGP security mechanisms. This document updates RFC 4271 by
      deprecating the origination of BGP routes with AS_SET (Type 1 AS_PATH segment) and
      updates RFC 5065 by deprecating the origination of BGP
      routes with AS_CONFED_SET (Type 4 AS_PATH segment).
      Finally, it obsoletes RFC 6472.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9774">https://www.rfc-editor.org/info/rfc9774</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-updates-to-the-requirements" class="internal xref">Updates to the Requirements of RFCs 4271 and 5065</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-treatment-of-routes-with-as" class="internal xref">Treatment of Routes with AS_SET in RPKI-Based BGP Security</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-bgp-as_path-brief-aggregati" class="internal xref">BGP AS_PATH "Brief" Aggregation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-issues-with-brief-as_path-a" class="internal xref">Issues with "Brief" AS_PATH Aggregation and RPKI-ROV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-recommendations-to-mitigate" class="internal xref">Recommendations to Mitigate Unpredictable AS_PATH Origins for RPKI-ROV Purposes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-implementing-consistent-bri" class="internal xref">Implementing Consistent Brief Aggregation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-not-advertising-aggregate-r" class="internal xref">Not Advertising Aggregate Routes to Contributing ASes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-mitigating-forwarding-loops" class="internal xref">Mitigating Forwarding Loops</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-example-of-route-filtering-" class="internal xref">Example of Route Filtering for Aggregate Routes and Their Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-examples-of-consistent-and-" class="internal xref">Examples of Consistent and Inconsistent BGP Origin AS Generated by Brief Aggregation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-scenario-1-first-one-route-" class="internal xref">Scenario 1: First one route, then another, each with a fully disjoint AS_PATH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-scenario-2-first-one-route-" class="internal xref">Scenario 2: First one route, then another, and the AS_PATHs overlap at the origin AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-scenario-3-first-one-route-" class="internal xref">Scenario 3: First one route, then another, and the AS_PATHs overlap at the neighbor AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-achieving-consistent-origin" class="internal xref">Achieving Consistent Origin AS During Aggregation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-discussion-on-forwarding-lo" class="internal xref">Discussion on Forwarding Loops and AS_SETs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#BCP172" class="cite xref">BCP172</a>]</span> recommends not
      using AS_SET <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and AS_CONFED_SET <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>]</span> AS_PATH path segment types in the Border
      Gateway Protocol (BGP).  This document advances the BCP recommendation to
      a standards requirement in BGP; it prohibits the use of the AS_SET and
      AS_CONFED_SET types of path segments in the AS_PATH. The purpose is to
      simplify the design and implementation of BGP and to make the semantics
      of the originator of a BGP route clearer. This will also simplify the design,
      implementation, and deployment of various BGP security mechanisms. In
      particular, the prohibition of AS_SETs and AS_CONFED_SETs removes any
      ambiguity about the origin AS in RPKI-based Route Origin
      Validation (RPKI-ROV)
      <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span> <span>[<a href="#RFC6907" class="cite xref">RFC6907</a>]</span>
        <span>[<a href="#RFC9319" class="cite xref">RFC9319</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"> The AS_SET path segment in the AS_PATH attribute (Sections <a href="https://rfc-editor.org/rfc/rfc4271#section-4.3" class="relref">4.3</a> and <a href="https://rfc-editor.org/rfc/rfc4271#section-5.1.2" class="relref">5.1.2</a> of <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>) is created by a router that is
      performing route aggregation and contains an unordered set of Autonomous
      Systems (ASes) that contributing prefixes in the aggregate have
      traversed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The AS_CONFED_SET path segment <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>]</span> in
      the AS_PATH attribute is created by a router that is performing route
      aggregation and contains an unordered set of Member AS Numbers in the
      local confederation that contributing prefixes in the aggregate have
      traversed. It is very similar to an AS_SET but is used within a
      confederation.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">By performing aggregation, a router is combining multiple BGP routes
      for more specific destinations into a new route for a less specific
      destination (see <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-9.1.2.2" class="relref">Section 9.1.2.2</a></span>). Aggregation
      may blur the semantics of the origin AS for the prefix being announced by
      producing an AS_SET or AS_CONFED_SET.  Such sets can cause operational
      issues, such as not being able to authenticate a route origin for the
      aggregate prefix in new BGP security technologies such as those that take
      advantage of X.509 extensions for IP addresses and AS identifiers
      (see <span>[<a href="#RFC6480" class="cite xref">RFC6480</a>]</span>, <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>, <span>[<a href="#RFC6907" class="cite xref">RFC6907</a>]</span>, 
      <span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span>, and <span>[<a href="#RFC9319" class="cite xref">RFC9319</a>]</span>).
      This could result in reachability problems for the destinations
      covered by the aggregated prefix.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">From analysis of historical Internet routing data, it is apparent that
      aggregation that involves AS_SETs is very seldom used in practice on the
      public Internet (see <span>[<a href="#Analysis" class="cite xref">Analysis</a>]</span>).  When it is used, it
      is often used incorrectly; only a single AS in the AS_SET is
      the most common case <span>[<a href="#Analysis" class="cite xref">Analysis</a>]</span>. Also, very often the same AS appears in the
      AS_SEQUENCE and the AS_SET in the BGP update. The occurrence of reserved
      AS numbers <span>[<a href="#IANA-SP-ASN" class="cite xref">IANA-SP-ASN</a>]</span> is also somewhat frequent.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
<div id="recs">
<section id="section-3">
      <h2 id="name-updates-to-the-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-updates-to-the-requirements" class="section-name selfRef">Updates to the Requirements of RFCs 4271 and 5065</a>
      </h2>
<p id="section-3-1">Unless explicitly configured by a network operator to do otherwise
         (e.g., during a transition phase), BGP speakers:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <span class="bcp14">MUST NOT</span> advertise BGP UPDATE messages containing AS_SETs or AS_CONFED_SETs and<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">
          <span class="bcp14">MUST</span> use the "treat-as-withdraw" error handling
              behavior per <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span> upon reception of BGP UPDATE messages containing AS_SETs or AS_CONFED_SETs in the AS_PATH or AS4_PATH <span>[<a href="#RFC6793" class="cite xref">RFC6793</a>]</span>.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">Per the above specifications, this document updates <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>]</span>
      by deprecating AS_SET (see <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-4.3" class="relref">Section 4.3</a></span>)
      and AS_CONFED_SET (see <span>[<a href="#RFC5065" class="cite xref">RFC5065</a>], <a href="https://rfc-editor.org/rfc/rfc5065#section-3" class="relref">Section 3</a></span>), respectively.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4">
      <h2 id="name-treatment-of-routes-with-as">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-treatment-of-routes-with-as" class="section-name selfRef">Treatment of Routes with AS_SET in RPKI-Based BGP Security</a>
      </h2>
<p id="section-4-1">Resource Public Key Infrastructure (RPKI) <span>[<a href="#RFC6480" class="cite xref">RFC6480</a>]</span> uses X.509
      extensions for IP addresses and AS identifiers <span>[<a href="#RFC3779" class="cite xref">RFC3779</a>]</span>.
      RPKI-ROV <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span> <span>[<a href="#RFC6907" class="cite xref">RFC6907</a>]</span>
      is a BGP security technology that never allows a route with AS_SET to be considered Valid.
      BGPsec <span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> and Autonomous System Provider Authorization (ASPA)
      <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">ASPA-VERIFICATION</a>]</span> are also BGP security technologies
      based on RPKI. BGPsec does not support AS_SETs. In ASPA-based AS_PATH verification,
      a route with AS_SET is always considered Invalid and hence ineligible for route selection.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-bgp-as_path-brief-aggregati">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-bgp-as_path-brief-aggregati" class="section-name selfRef">BGP AS_PATH "Brief" Aggregation</a>
      </h2>
<p id="section-5-1">Sections <a href="https://rfc-editor.org/rfc/rfc4271#section-9.1.4" class="relref">9.1.4</a> and <a href="https://rfc-editor.org/rfc/rfc4271#section-9.2.2.2" class="relref">9.2.2.2</a> of <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>
      describe BGP aggregation procedures.  <span><a href="https://rfc-editor.org/rfc/rfc4271#appendix-F.6" class="relref">Appendix F.6</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> describes a generally less utilized
      "Complex AS_PATH Aggregation" procedure.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-5.1.6" class="relref">Section 5.1.6</a></span>
        describes the ATOMIC_AGGREGATE Path Attribute and notes that:<a href="#section-5-2" class="pilcrow">¶</a></p>
<blockquote id="section-5-3">
        <p id="section-5-3.1">When a BGP speaker aggregates several routes for the purpose of
          advertisement to a particular peer, the AS_PATH of the aggregated
          route normally includes an AS_SET formed from the set of ASes from
          which the aggregate was formed.  In many cases, the network
          administrator can determine if the aggregate can safely be advertised
          without the AS_SET, and without forming route loops.<a href="#section-5-3.1" class="pilcrow">¶</a></p>
<p id="section-5-3.2">If an aggregate excludes at least some of the AS numbers present in
          the AS_PATH of the routes that are aggregated as a result of dropping
          the AS_SET, the aggregated route, when advertised to the peer, <span class="bcp14">SHOULD</span>
          include the ATOMIC_AGGREGATE attribute.<a href="#section-5-3.2" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-5-4">When BGP AS_PATH aggregation is done according to the procedures in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-9.2.2.2" class="relref">Section 9.2.2.2</a></span>,
        and any resulting AS_SETs are discarded, it is typically
        referred to as "brief" aggregation in implementations. That terminology is adopted here: In this document, brief aggregation refers to what is described in this section, in contrast to consistent brief aggregation as described in <a href="#consistent-brief" class="auto internal xref">Section 5.2</a>.
        Brief aggregation results in an AS_PATH that has the following property (from
        <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-9.2.2.2" class="relref">Section 9.2.2.2</a></span>):<a href="#section-5-4" class="pilcrow">¶</a></p>
<blockquote id="section-5-5">
        <p id="section-5-5.1">[D]etermine the longest leading sequence of tuples (as defined above)
          common to all the AS_PATH attributes of the routes to be aggregated.
          Make this sequence the leading sequence of the aggregated AS_PATH
          attribute.<a href="#section-5-5.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-5-6">The ATOMIC_AGGREGATE Path Attribute is subsequently attached to the
        BGP route, if AS_SETs are dropped.<a href="#section-5-6" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-issues-with-brief-as_path-a">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-issues-with-brief-as_path-a" class="section-name selfRef">Issues with "Brief" AS_PATH Aggregation and RPKI-ROV</a>
        </h3>
<p id="section-5.1-1">While brief AS_PATH aggregation has the desirable property of not
        containing AS_SETs, the resulting aggregated AS_PATH may contain an
        unpredictable origin AS.
        This is because the aggregating AS may be different from the purported origin AS (for the aggregate), which may vary as explained below.
        Such unpredictable origin ASes may result
        in RPKI-ROV validation issues:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">Depending on the contributing routes to the aggregate route, the
          resulting origin AS may vary.<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">The presence of expected contributing routes may be unpredictable
          due to route availability from BGP neighbors.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">In the presence of such varying origin ASes, it would be necessary
          for the resource holder to register ROAs <span>[<a href="#RFC9582" class="cite xref">RFC9582</a>]</span> for each potential origin AS that
          may result from the expected aggregated AS_PATHs.<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<div id="consistent-brief">
<section id="section-5.2">
        <h3 id="name-recommendations-to-mitigate">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-recommendations-to-mitigate" class="section-name selfRef">Recommendations to Mitigate Unpredictable AS_PATH Origins for RPKI-ROV Purposes</a>
        </h3>
<p id="section-5.2-1">To ensure a consistent BGP origin AS is announced for
        aggregate BGP routes for implementations of "brief" BGP aggregation, the
        implementation <span class="bcp14">MUST</span> be configured to truncate the AS_PATH after the
        right-most instance of the desired origin AS for the aggregate.
        The desired origin AS could be the aggregating AS itself.
        A ROA would be necessary for the aggregate prefix with the desired origin AS.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">This form of brief aggregation is referred to as "consistent
        brief" BGP aggregation.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">If the resulting AS_PATH would be truncated from the otherwise
        expected result of BGP AS_PATH aggregation (an AS_SET would not be
        generated and possibly some ASes are removed from the "longest leading sequence" of
        ASes), the ATOMIC_AGGREGATE Path Attribute <span class="bcp14">SHOULD</span> be attached.  This is
        consistent with the intent of <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>], <a href="https://rfc-editor.org/rfc/rfc4271#section-5.1.6" class="relref">Section 5.1.6</a></span>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-6">
      <h2 id="name-operational-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-6-1">This section provides advice to operators regarding deployment and configuration.<a href="#section-6-1" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-implementing-consistent-bri">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-implementing-consistent-bri" class="section-name selfRef">Implementing Consistent Brief Aggregation</a>
        </h3>
<p id="section-6.1-1">When aggregating prefixes, network operators <span class="bcp14">MUST</span> use
        consistent brief aggregation as described in
        <a href="#consistent-brief" class="auto internal xref">Section 5.2</a>.
        In consistent brief aggregation, the AGGREGATOR and ATOMIC_AGGREGATE
        Path Attributes are included, but the AS_PATH does not have AS_SET or
        AS_CONFED_SET path segment types.
        See <a href="#brief-agg-example" class="auto internal xref">Appendix B</a> for examples of
        brief aggregation while keeping the origin AS unambiguous
        and generating appropriate ROAs.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
<div id="filtering-to-contributors">
<section id="section-6.2">
        <h3 id="name-not-advertising-aggregate-r">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-not-advertising-aggregate-r" class="section-name selfRef">Not Advertising Aggregate Routes to Contributing ASes</a>
        </h3>
<p id="section-6.2-1">An aggregate prefix
        <span class="bcp14">SHOULD NOT</span> be announced to the contributing ASes. Instead, more specific
        prefixes (from the aggregate) <span class="bcp14">SHOULD</span> be announced to each contributing AS,
        excluding any that were learned from the contributing AS in
        consideration.  See <a href="#filter-example" class="auto internal xref">Appendix A</a> for an example of
        this filtering policy.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.3">
        <h3 id="name-mitigating-forwarding-loops">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-mitigating-forwarding-loops" class="section-name selfRef">Mitigating Forwarding Loops</a>
        </h3>
<p id="section-6.3-1">When both less specific and more specific destinations are present,
        it's possible to create forwarding loops between networks, as discussed in <span><a href="https://rfc-editor.org/rfc/rfc4632#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC4632" class="cite xref">RFC4632</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">As a reminder, Rule #2 in <span><a href="https://rfc-editor.org/rfc/rfc4632#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC4632" class="cite xref">RFC4632</a>]</span>
        requires that BGP implementations performing aggregation discard
        packets that match the aggregate route but do not match any of the
        more specific routes.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">Further discussion of forwarding loops and their relationship to
        AS_SETs can be found in <a href="#forwarding-loop-discussion" class="auto internal xref">Appendix C</a>.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This document deprecates the use of aggregation techniques that create
      AS_SETs or AS_CONFED_SETs. Obsoleting these path segment types from BGP
      and the removal of the related code from implementations would potentially
      decrease the attack surface for BGP. Deployments of new BGP security
      technologies
      (e.g., <span>[<a href="#RFC6480" class="cite xref">RFC6480</a>]</span>, <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>, and 
      <span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span>) benefit greatly if AS_SETs and AS_CONFED_SETs are not used in BGP.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP172">[BCP172]</dt>
        <dd>
<div class="refInstance">Best Current Practice 172, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp172">https://www.rfc-editor.org/info/bcp172</a>&gt;</span>.<br><span>At the time of writing, this BCP comprises the following:</span>
</div>
<div class="refInstance" id="RFC6472">
            <span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"Recommendation for Not Using AS_SET and AS_CONFED_SET in BGP"</span>, <span class="seriesInfo">BCP 172</span>, <span class="seriesInfo">RFC 6472</span>, <span class="seriesInfo">DOI 10.17487/RFC6472</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6472">https://www.rfc-editor.org/info/rfc6472</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4632">[RFC4632]</dt>
        <dd>
<span class="refAuthor">Fuller, V.</span> and <span class="refAuthor">T. Li</span>, <span class="refTitle">"Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan"</span>, <span class="seriesInfo">BCP 122</span>, <span class="seriesInfo">RFC 4632</span>, <span class="seriesInfo">DOI 10.17487/RFC4632</span>, <time datetime="2006-08" class="refDate">August 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4632">https://www.rfc-editor.org/info/rfc4632</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5065">[RFC5065]</dt>
        <dd>
<span class="refAuthor">Traina, P.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Autonomous System Confederations for BGP"</span>, <span class="seriesInfo">RFC 5065</span>, <span class="seriesInfo">DOI 10.17487/RFC5065</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5065">https://www.rfc-editor.org/info/rfc5065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6793">[RFC6793]</dt>
        <dd>
<span class="refAuthor">Vohra, Q.</span> and <span class="refAuthor">E. Chen</span>, <span class="refTitle">"BGP Support for Four-Octet Autonomous System (AS) Number Space"</span>, <span class="seriesInfo">RFC 6793</span>, <span class="seriesInfo">DOI 10.17487/RFC6793</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6793">https://www.rfc-editor.org/info/rfc6793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Analysis">[Analysis]</dt>
        <dd>
<span class="refTitle">"Detailed analysis of AS_SETs in BGP updates"</span>, <span class="refContent">commit ef3f4a9</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://github.com/ksriram25/IETF/blob/main/Detailed-AS_SET-analysis.txt">https://github.com/ksriram25/IETF/blob/main/Detailed-AS_SET-analysis.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-sidrops-aspa-verification">[ASPA-VERIFICATION]</dt>
        <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Bogomazov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"BGP AS_PATH Verification Based on Autonomous System Provider Authorization (ASPA) Objects"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sidrops-aspa-verification-22</span>, <time datetime="2025-03-23" class="refDate">23 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification-22">https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-SP-ASN">[IANA-SP-ASN]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Special-Purpose Autonomous System (AS) Numbers"</span>, <span>&lt;<a href="https://www.iana.org/assignments/iana-as-numbers-special-registry">https://www.iana.org/assignments/iana-as-numbers-special-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3779">[RFC3779]</dt>
        <dd>
<span class="refAuthor">Lynn, C.</span>, <span class="refAuthor">Kent, S.</span>, and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"X.509 Extensions for IP Addresses and AS Identifiers"</span>, <span class="seriesInfo">RFC 3779</span>, <span class="seriesInfo">DOI 10.17487/RFC3779</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3779">https://www.rfc-editor.org/info/rfc3779</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6480">[RFC6480]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span> and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"An Infrastructure to Support Secure Internet Routing"</span>, <span class="seriesInfo">RFC 6480</span>, <span class="seriesInfo">DOI 10.17487/RFC6480</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6480">https://www.rfc-editor.org/info/rfc6480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6907">[RFC6907]</dt>
        <dd>
<span class="refAuthor">Manderson, T.</span>, <span class="refAuthor">Sriram, K.</span>, and <span class="refAuthor">R. White</span>, <span class="refTitle">"Use Cases and Interpretations of Resource Public Key Infrastructure (RPKI) Objects for Issuers and Relying Parties"</span>, <span class="seriesInfo">RFC 6907</span>, <span class="seriesInfo">DOI 10.17487/RFC6907</span>, <time datetime="2013-03" class="refDate">March 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6907">https://www.rfc-editor.org/info/rfc6907</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9319">[RFC9319]</dt>
        <dd>
<span class="refAuthor">Gilad, Y.</span>, <span class="refAuthor">Goldberg, S.</span>, <span class="refAuthor">Sriram, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">B. Maddison</span>, <span class="refTitle">"The Use of maxLength in the Resource Public Key Infrastructure (RPKI)"</span>, <span class="seriesInfo">BCP 185</span>, <span class="seriesInfo">RFC 9319</span>, <span class="seriesInfo">DOI 10.17487/RFC9319</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9319">https://www.rfc-editor.org/info/rfc9319</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9582">[RFC9582]</dt>
      <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refAuthor">Maddison, B.</span>, <span class="refAuthor">Lepinski, M.</span>, <span class="refAuthor">Kong, D.</span>, and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"A Profile for Route Origin Authorizations (ROAs)"</span>, <span class="seriesInfo">RFC 9582</span>, <span class="seriesInfo">DOI 10.17487/RFC9582</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9582">https://www.rfc-editor.org/info/rfc9582</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="filter-example">
<section id="appendix-A">
      <h2 id="name-example-of-route-filtering-">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-of-route-filtering-" class="section-name selfRef">Example of Route Filtering for Aggregate Routes and Their Contributors</a>
      </h2>
<p id="appendix-A-1"> 
       The illustration presented below shows how an AS_SET is not used when
       aggregating and how data plane route loops are avoided.
       Consider that p1/24 (from AS 64501), p2/24 (from AS 64502), p3/24 (from AS 64503),
       and p4/24 (from AS 64504) are aggregated by AS 64505 to p/22.
       AS_SET is not used with the aggregate p/22 but AGGREGATOR and ATOMIC AGGREGATE are used.
       Data plane route loops are avoided by not announcing the aggregate p/22
       to the contributing ASes, i.e., AS 64501, AS 64502, AS 64503, and AS 64504.
       Instead, as further illustrated, p1/24, p2/24, and p4/24 are announced to AS 64503.
       The routing tables (post aggregation) of each of the ASes are depicted in the diagram below.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="alignCenter art-ascii-art art-text artwork" id="appendix-A-2">
<pre>
 (       )     (       )           (       )     (       )
( AS64501 )   ( AS64502 )         ( AS64503 )   ( AS64504 )
 (       )     (       )           (       )     (       )
   p1/24         p2/24               p3/24         p4/24
     |             |                   |             |
     |             +--&gt;  (       )  &lt;--+             |
     |                  ( AS64505 )                  |
     +----------------&gt;  (       )  &lt;----------------+
                            p/22
                             |
                             V

AS 64501                      AS 64502
==========================    ==========================
p1/24 AS_PATH ""              p1/24 AS_PATH "64505 64501"
p2/24 AS_PATH "64505 64502"   p2/24 AS_PATH ""
p3/24 AS_PATH "64505 64503"   p3/24 AS_PATH "64505 64503"
p4/24 AS_PATH "64505 64504"   p4/24 AS_PATH "64505 64504"


AS 64503                      AS 64504
==========================    ==========================
p1/24 AS_PATH "64505 64501"   p1/24 AS_PATH "64505 64501"
p2/24 AS_PATH "64505 64502"   p2/24 AS_PATH "64505 64502"
p3/24 AS_PATH ""              p3/24 AS_PATH "64505 64503"
p4/24 AS_PATH "64505 64504"   p4/24 AS_PATH ""

AS 64505
==========================
p/22  AS_PATH "" AGGREGATOR 64505 ATOMIC_AGGREGATE
p1/24 AS_PATH "64501"
p2/24 AS_PATH "64502"
p3/24 AS_PATH "64503"
p4/24 AS_PATH "64504"</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="brief-agg-example">
<section id="appendix-B">
      <h2 id="name-examples-of-consistent-and-">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-examples-of-consistent-and-" class="section-name selfRef">Examples of Consistent and Inconsistent BGP Origin AS Generated by Brief Aggregation</a>
      </h2>
<p id="appendix-B-1">
      The examples below illustrate how brief aggregation
      may result in an inconsistent origin AS.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">AS 64500 aggregates more specific routes into 192.0.2.0/24.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Consider the following scenarios where brief aggregation is done
      by AS 64500 and what the resultant origin ASes would be.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="appendix-B-4">
<pre>
Routes:
R1 - 192.0.2.0/26   AS_PATH "64501"
R2 - 192.0.2.64/26  AS_PATH "64502"
R3 - 192.0.2.128/26 AS_PATH "64504 64502"
R4 - 192.0.2.192/26 AS_PATH "64504 64501"

           (       )                        (       )
          ( AS64501 )                      ( AS64502 )
           (       )                        (       )
192.0.2.0/26    192.0.2.192/26    192.0.2.128/26  192.0.2.64/26
     |                      |      |                 |
     |                      |      |                 |
     |                      \/    \/                 |
     |                     (        )                |
     |                    (  AS64504 )               |
     |                     (        )                |
     |                      |      |                 |
     |                   R4 |      | R3              |
     |                      |      |                 |
     |                      \/    \/                 |
     |             R1      (         )      R2       |
     +-------------------&gt;(  AS64500  )&lt;-------------+
                           (         )
                                |
                                | (announcing
                                |  aggregate 192.0.2.0/24)
                               \/</pre><a href="#appendix-B-4" class="pilcrow">¶</a>
</div>
<section id="appendix-B.1">
        <h3 id="name-scenario-1-first-one-route-">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-scenario-1-first-one-route-" class="section-name selfRef">Scenario 1: First one route, then another, each with a fully disjoint AS_PATH</a>
        </h3>
<p id="appendix-B.1-1">Receive R1. Aggregate 192.0.2.0/24 AS_PATH "64501"<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">Alternate "bug?": Aggregate 192.0.2.0/24 AS_PATH "[ 64501 ]"<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">(Note: AS numbers within square brackets represent an AS_SET.)<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4">Receive R2.  Aggregate 192.0.2.0/24 AS_PATH "[ 64501 64502 ]"<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1-5">If brief aggregation is in use, the AS_PATH would be truncated to
        the empty AS_PATH, "".<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.1-6">The resulting AS_PATH is thus not stable and depends on the presence
        of specific routes.<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.2">
        <h3 id="name-scenario-2-first-one-route-">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-scenario-2-first-one-route-" class="section-name selfRef">Scenario 2: First one route, then another, and the AS_PATHs overlap at the origin AS</a>
        </h3>
<p id="appendix-B.2-1">Receive R1.  Aggregate 192.0.2.0/24 AS_PATH "64501"<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">Receive R4.  Aggregate 192.0.2.0/24 AS_PATH "[ 64504 64501 ]"<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">If brief aggregation is in use,  the AS_PATH is truncated to "".<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<p id="appendix-B.2-4">The resulting AS_PATH is thus not stable and depends on the presence
        of specific routes.<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.3">
        <h3 id="name-scenario-3-first-one-route-">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-scenario-3-first-one-route-" class="section-name selfRef">Scenario 3: First one route, then another, and the AS_PATHs overlap at the neighbor AS</a>
        </h3>
<p id="appendix-B.3-1">Receive R3.  Aggregate 192.0.2.0/24 AS_PATH "64504 64501"<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">Receive R4.  Aggregate 192.0.2.0/24 AS_PATH "64504 [ 64501 64502 ]"<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3-3">If brief aggregation is in use, the AS_PATH is truncated to "64504".<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3-4">The resulting AS_PATH is thus not stable and depends on the presence
        of specific routes.<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.4">
        <h3 id="name-achieving-consistent-origin">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-achieving-consistent-origin" class="section-name selfRef">Achieving Consistent Origin AS During Aggregation</a>
        </h3>
<p id="appendix-B.4-1">In the three scenarios above, the aggregating AS 64500 is using
        brief aggregation.  This results in inconsistent
        origin ASes as the contributing routes are learned.  This motivates the
        "consistent brief" BGP aggregation mentioned in
        <a href="#consistent-brief" class="auto internal xref">Section 5.2</a> and discussed further
        with examples below.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4-2">The trivial solution to addressing the issue is to simply discard
        all of the ASes for the contributing routes. In simple BGP aggregation
        topologies, this is likely the correct thing to do.  The AS originating
        the aggregate, 192.0.2.0/24 in this example, is likely the resource
        holder for the route in question.  In such a case, simply originating
        the route to its BGP upstream neighbors in the Internet with its own
        AS, 64500, means that a consistent ROA
        could be registered in the RPKI for this prefix.  This satisfies the
        need for a consistent (unambiguous) origin AS.<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
<p id="appendix-B.4-3">If the contributing ASes are themselves multihomed to the Internet
        outside of their connections to AS 64500, then additional ROAs would
        need to be created for each of the more specific prefixes.<a href="#appendix-B.4-3" class="pilcrow">¶</a></p>
<p id="appendix-B.4-4">In more complex proxy aggregation scenarios, there may be a desire
        to permit some stable (i.e., common) portion of the contributing AS_PATHs to be kept in the
        aggregate route.  Consider the case for Scenario 3, where the neighbor
        AS is the same for both R3 and R4 -- AS 64504.  In such a case, an
        implementation may permit the aggregate's brief AS_PATH to be "64504", and
        a ROA would be created for the aggregate prefix with 64504 as the origin AS.<a href="#appendix-B.4-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="forwarding-loop-discussion">
<section id="appendix-C">
      <h2 id="name-discussion-on-forwarding-lo">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-discussion-on-forwarding-lo" class="section-name selfRef">Discussion on Forwarding Loops and AS_SETs</a>
      </h2>
<p id="appendix-C-1">Although BGP-4 was designed to carry Classless Inter-Domain Routing (CIDR) routes,
      <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> does not discuss the installation of "discard"
      or "null" routes when implementing its aggregation procedures.  Implementations
      could originate an aggregate prefix without a covering route
      for a more specific prefix (subsumed by the aggregate prefix) present in the local
      routing table.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">When aggregating more specific routes according to
      the aggregation procedures of <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, the aggregating BGP
      speaker will place contributing routes into the generated AS_PATH, perhaps
      using AS_SETs.  As a result, a contributing AS will not install the
      aggregated route into its RIB since the route is an AS_PATH loop.  This
      provides a form of protection against forwarding loops created by BGP
      aggregation.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">When brief aggregation methods are used, a BGP speaker may receive a
      route containing a less specific destination covering a local more specific
      destination and install it in its routing table since it is not
      prevented from doing so by BGP AS_PATH loop detection. This gives rise to
      the possibility of forwarding loops. To help prevent forwarding loops,
      it is critical to adhere to the following:<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-C-4">
          <li id="appendix-C-4.1">Rule #2 in <span><a href="https://rfc-editor.org/rfc/rfc4632#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC4632" class="cite xref">RFC4632</a>]</span>:<a href="#appendix-C-4.1" class="pilcrow">¶</a>
</li>
      </ol>
<blockquote id="appendix-C-5">
          A router that generates an aggregate route for multiple,
          more-specific routes must discard packets that match the
          aggregate route, but not any of the more-specific routes.  In other
          words, the "next hop" for the aggregate route should be the null
        destination.<a href="#appendix-C-5" class="pilcrow">¶</a>
</blockquote>
<ol start="2" type="1" class="normal type-1" id="appendix-C-6">
        <li id="appendix-C-6.1">Not advertising aggregate routes to contributing ASes
          as specified in <a href="#filtering-to-contributors" class="auto internal xref">Section 6.2</a>
          of this document (also see <a href="#filter-example" class="auto internal xref">Appendix A</a>).<a href="#appendix-C-6.1" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">The authors would like to thank <span class="contact-name">Alvaro Retana</span>,
      <span class="contact-name">John Scudder</span>, <span class="contact-name">Ketan       Talaulikar</span>, <span class="contact-name">Keyur Patel</span>, <span class="contact-name">Susan Hares</span>, <span class="contact-name">Claudio Jeker</span>, <span class="contact-name">Nick Hilliard</span>, <span class="contact-name">Robert Raszuk</span>,
      <span class="contact-name">John Heasley</span>, <span class="contact-name">Job Snijders</span>,
      <span class="contact-name">Jared Mauch</span>, <span class="contact-name">Jakob Heitz</span>,
      <span class="contact-name">Tony Przygienda</span>, <span class="contact-name">Douglas       Montgomery</span>, <span class="contact-name">Randy Bush</span>, <span class="contact-name">Curtis Villamizar</span>, <span class="contact-name">Danny McPherson</span>,
      <span class="contact-name">Chris Morrow</span>, <span class="contact-name">Tom Petch</span>,
      <span class="contact-name">Ilya Varlashkin</span>, <span class="contact-name">Enke Chen</span>,
      <span class="contact-name">Tony Li</span>, <span class="contact-name">Florian Weimer</span>,
      <span class="contact-name">John Leslie</span>, <span class="contact-name">Paul Jakma</span>,
      <span class="contact-name">Rob Austein</span>, <span class="contact-name">Russ Housley</span>,
      <span class="contact-name">Sandra Murphy</span>, <span class="contact-name">Steven M.       Bellovin</span>, <span class="contact-name">Steve Kent</span>, <span class="contact-name">Steve       Padgett</span>, and <span class="contact-name">Alfred Hoenes</span> for comments and
      suggestions. The comments and suggestions received from the IESG
      reviewers are also much appreciated.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Warren Kumari</span></div>
<div dir="auto" class="left"><span class="org">Google, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20571%20748%204373" class="tel">+1 571 748 4373</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:warren@kumari.net" class="email">warren@kumari.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kotikalapudi Sriram</span></div>
<div dir="auto" class="left"><span class="org">USA NIST</span></div>
<div dir="auto" class="left"><span class="street-address">100 Bureau Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Gaithersburg</span>, <span class="region">MD</span> <span class="postal-code">20899</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20301%20975%203973" class="tel">+1 301 975 3973</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:ksriram@nist.gov" class="email">ksriram@nist.gov</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Lilia Hannachi</span></div>
<div dir="auto" class="left"><span class="org">USA NIST</span></div>
<div dir="auto" class="left"><span class="street-address">100 Bureau Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Gaithersburg</span>, <span class="region">MD</span> <span class="postal-code">20899</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20301%20975%203259" class="tel">+1 301 975 3259</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:lilia.hannachi@nist.gov" class="email">lilia.hannachi@nist.gov</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeffrey Haas</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jhaas@juniper.net" class="email">jhaas@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
