<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9783: Arm's Platform Security Architecture (PSA) Attestation Token</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Simon Frost" name="author">
<meta content="Mathias Brossard" name="author">
<meta content="Adrian Shaw" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="
       Arm's Platform Security Architecture (PSA) is a family of hardware and
firmware security specifications, along with open-source reference
implementations, aimed at helping device makers and chip manufacturers
integrate best-practice security into their products. Devices that
comply with PSA can generate attestation tokens as described in this
document, which serve as the foundation for various protocols, including
secure provisioning and network access control. This document specifies
the structure and semantics of the PSA attestation token. 
       The PSA attestation token is a profile of the Entity Attestation Token
(EAT). This specification describes the claims used in an attestation
token generated by PSA-compliant systems, how these claims are
serialized for transmission, and how they are cryptographically
protected. 
       This Informational document is published as an Independent Submission to improve
interoperability with Arm's architecture. It is not a standard nor
a product of the IETF. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Remote Attestation" name="keyword">
<meta content="EAT profile" name="keyword">
<meta content="Evidence" name="keyword">
<meta content="RATS" name="keyword">
<meta content="IoT" name="keyword">
<meta content="9783" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9783.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-tschofenig-rats-psa-token-24" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9783" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9783</td>
<td class="center">Arm's PSA Attestation Token</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Independent Submission</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9783" class="eref">9783</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06" class="published">June 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">S. Frost</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">M. Brossard</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">A. Shaw</div>
<div class="org">HP Labs</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9783</h1>
<h1 id="title">Arm's Platform Security Architecture (PSA) Attestation Token</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Arm's Platform Security Architecture (PSA) is a family of hardware and
firmware security specifications, along with open-source reference
implementations, aimed at helping device makers and chip manufacturers
integrate best-practice security into their products. Devices that
comply with PSA can generate attestation tokens as described in this
document, which serve as the foundation for various protocols, including
secure provisioning and network access control. This document specifies
the structure and semantics of the PSA attestation token.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The PSA attestation token is a profile of the Entity Attestation Token
(EAT). This specification describes the claims used in an attestation
token generated by PSA-compliant systems, how these claims are
serialized for transmission, and how they are cryptographically
protected.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This Informational document is published as an Independent Submission to improve
interoperability with Arm's architecture. It is not a standard nor
a product of the IETF.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9783">https://www.rfc-editor.org/info/rfc9783</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-psa-attester-model" class="internal xref">PSA Attester Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-psa-claims" class="internal xref">PSA Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-caller-claims" class="internal xref">Caller Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-nonce" class="internal xref">Nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-client-id" class="internal xref">Client ID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-target-identification-claim" class="internal xref">Target Identification Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-instance-id" class="internal xref">Instance ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-implementation-id" class="internal xref">Implementation ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-certification-reference" class="internal xref">Certification Reference</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-target-state-claims" class="internal xref">Target State Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-security-lifecycle" class="internal xref">Security Lifecycle</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-boot-seed" class="internal xref">Boot Seed</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-software-inventory-claims" class="internal xref">Software Inventory Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-software-components" class="internal xref">Software Components</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-verification-claims" class="internal xref">Verification Claims</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-verification-service-indica" class="internal xref">Verification Service Indicator</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="auto internal xref">4.5.2</a>.  <a href="#name-profile-definition" class="internal xref">Profile Definition</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-backwards-compatibility-con" class="internal xref">Backwards Compatibility Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-profiles" class="internal xref">Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-baseline-profile" class="internal xref">Baseline Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-token-encoding-and-signing" class="internal xref">Token Encoding and Signing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-freshness-model" class="internal xref">Freshness Model</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-synopsis" class="internal xref">Synopsis</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-profile-tfm" class="internal xref">Profile TFM</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-collated-cddl" class="internal xref">Collated CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-scalability-considerations" class="internal xref">Scalability Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-psa-token-verification" class="internal xref">PSA Token Verification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-ar4si-trustworthiness-claim" class="internal xref">AR4SI Trustworthiness Claims Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-endorsements-reference-valu" class="internal xref">Endorsements, Reference Values, and Verification Key Material</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-and-privacy-consid" class="internal xref">Security and Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-cbor-web-token-claims-regis" class="internal xref">CBOR Web Token Claims Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-client-id-claim" class="internal xref">Client ID Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.  <a href="#name-security-lifecycle-claim" class="internal xref">Security Lifecycle Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="auto internal xref">10.1.3</a>.  <a href="#name-implementation-id-claim" class="internal xref">Implementation ID Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.4">
                    <p id="section-toc.1-1.10.2.1.2.4.1"><a href="#section-10.1.4" class="auto internal xref">10.1.4</a>.  <a href="#name-certification-reference-cla" class="internal xref">Certification Reference Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.5">
                    <p id="section-toc.1-1.10.2.1.2.5.1"><a href="#section-10.1.5" class="auto internal xref">10.1.5</a>.  <a href="#name-software-components-claim" class="internal xref">Software Components Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.6">
                    <p id="section-toc.1-1.10.2.1.2.6.1"><a href="#section-10.1.6" class="auto internal xref">10.1.6</a>.  <a href="#name-verification-service-indicat" class="internal xref">Verification Service Indicator Claim</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-media-types" class="internal xref">Media Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a href="#section-10.3.1" class="auto internal xref">10.3.1</a>.  <a href="#name-registry-contents" class="internal xref">Registry Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-cose-sign1-token" class="internal xref">COSE Sign1 Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-cose-mac0-token" class="internal xref">COSE Mac0 Token</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Platform Security Architecture (PSA) <span>[<a href="#PSA" class="cite xref">PSA</a>]</span> is a set of hardware and firmware
specifications backed by reference implementations and a security
certification program <span>[<a href="#PSACertified" class="cite xref">PSACertified</a>]</span>.  The security specifications have been published by Arm,
while the certification program and reference implementations are the result of
a collaborative effort by companies from multiple sectors, including evaluation
laboratories, IP semiconductor vendors, and security consultancies.  The main objective of
the PSA initiative is to assist device manufacturers and chip makers in
incorporating best-practice security measures into their products.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Many devices now have Trusted Execution Environments (TEEs) that provide a safe
space for security-sensitive code, such as cryptography, secure boot, secure
storage, and other essential security functions.  These security
functions are typically exposed through a narrow and well-defined interface,
and can be used by operating system libraries and applications.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">As outlined in the Remote ATtestation procedureS (RATS) Architecture
      <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, an Attester produces a signed collection of
      Claims that constitutes Evidence about its Target Environment. This
      document focuses on the output provided by PSA's Initial Attestation API
      <span>[<a href="#PSA-API" class="cite xref">PSA-API</a>]</span>. This output corresponds to Evidence in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and, as a design decision, the PSA attestation token
      is a profile of the Entity Attestation Token (EAT) <span>[<a href="#RFC9711" class="cite xref">EAT</a>]</span>. Note that there are other profiles of EAT available
      for use with different use cases and by different attestation
      technologies, such as <span>[<a href="#I-D.kdyxy-rats-tdx-eat-profile" class="cite xref">RATS-TDX</a>]</span>
      and <span>[<a href="#I-D.mandyam-rats-qwestoken" class="cite xref">RATS-QWESTOKEN</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Since the PSA tokens are also consumed by services outside the device, there is an actual
need to ensure interoperability. Interoperability needs are addressed here by
describing the exact syntax and semantics of the attestation claims, and
defining the way these claims are encoded and cryptographically protected.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Further details on concepts expressed below can be found in the PSA Security
Model documentation <span>[<a href="#PSA-SM" class="cite xref">PSA-SM</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">As mentioned in the abstract, this memo documents a vendor extension
to the RATS architecture and is not a standard.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The terms Attester, Relying Party, Verifier, Attestation Result, Target Environment, Attesting Environment, and Evidence
are defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. We use the term "receiver" to refer to Relying Parties
and Verifiers.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">We use the terms Evidence, "PSA attestation token", and "PSA token" interchangeably.
The terms "sender" and Attester are used interchangeably. Likewise, we use the terms
Verifier and "verification service" interchangeably.<a href="#section-2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-4">
        <dt id="section-2-4.1">Root of Trust (RoT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.2">The minimal set of software, hardware, and data that has to be
        implicitly trusted in the platform; there is no software or hardware
        at a deeper level that can verify that the RoT is authentic and
        unmodified.  An example of RoT is an initial bootloader in ROM, which
        contains cryptographic functions and credentials, running on a
        specific hardware platform.<a href="#section-2-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.3">Secure Processing Environment (SPE):</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.4">A platform's processing environment for software that provides
        confidentiality and integrity for its runtime state, from software and
        hardware, outside of the SPE. Contains trusted code and trusted
        hardware.  (Equivalent to a TEE, "secure world", or "secure
        enclave".)<a href="#section-2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-4.5">Non-Secure Processing Environment (NSPE):</dt>
        <dd style="margin-left: 1.5em" id="section-2-4.6">The security domain (Application domain) outside of the SPE that typically contains the application firmware, real-time operating systems, applications, and general hardware. (Equivalent to Rich Execution Environment (REE), or "normal
        world".)<a href="#section-2-4.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-5">In this document, the structure of data is specified in Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-psa-attester-model">
<section id="section-3">
      <h2 id="name-psa-attester-model">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-psa-attester-model" class="section-name selfRef">PSA Attester Model</a>
      </h2>
<p id="section-3-1"><a href="#fig-psa-attester" class="auto internal xref">Figure 1</a> outlines the structure of the PSA Attester according to
the conceptual model described in <span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-psa-attester"></span><div id="fig-psa-attester">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="560" viewBox="0 0 560 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,144 L 8,432" fill="none" stroke="black"></path>
              <path d="M 24,160 L 24,272" fill="none" stroke="black"></path>
              <path d="M 24,304 L 24,416" fill="none" stroke="black"></path>
              <path d="M 40,336 L 40,384" fill="none" stroke="black"></path>
              <path d="M 96,304 L 96,336" fill="none" stroke="black"></path>
              <path d="M 144,336 L 144,384" fill="none" stroke="black"></path>
              <path d="M 160,192 L 160,256" fill="none" stroke="black"></path>
              <path d="M 160,336 L 160,384" fill="none" stroke="black"></path>
              <path d="M 208,256 L 208,336" fill="none" stroke="black"></path>
              <path d="M 264,192 L 264,256" fill="none" stroke="black"></path>
              <path d="M 272,336 L 272,384" fill="none" stroke="black"></path>
              <path d="M 288,336 L 288,384" fill="none" stroke="black"></path>
              <path d="M 304,208 L 304,240" fill="none" stroke="black"></path>
              <path d="M 328,288 L 328,336" fill="none" stroke="black"></path>
              <path d="M 368,208 L 368,240" fill="none" stroke="black"></path>
              <path d="M 400,336 L 400,384" fill="none" stroke="black"></path>
              <path d="M 408,192 L 408,256" fill="none" stroke="black"></path>
              <path d="M 416,336 L 416,384" fill="none" stroke="black"></path>
              <path d="M 424,32 L 424,64" fill="none" stroke="black"></path>
              <path d="M 464,72 L 464,192" fill="none" stroke="black"></path>
              <path d="M 464,304 L 464,336" fill="none" stroke="black"></path>
              <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
              <path d="M 520,192 L 520,256" fill="none" stroke="black"></path>
              <path d="M 520,336 L 520,384" fill="none" stroke="black"></path>
              <path d="M 536,160 L 536,272" fill="none" stroke="black"></path>
              <path d="M 536,304 L 536,416" fill="none" stroke="black"></path>
              <path d="M 552,144 L 552,432" fill="none" stroke="black"></path>
              <path d="M 424,32 L 512,32" fill="none" stroke="black"></path>
              <path d="M 424,64 L 512,64" fill="none" stroke="black"></path>
              <path d="M 8,144 L 456,144" fill="none" stroke="black"></path>
              <path d="M 472,144 L 552,144" fill="none" stroke="black"></path>
              <path d="M 24,160 L 456,160" fill="none" stroke="black"></path>
              <path d="M 472,160 L 536,160" fill="none" stroke="black"></path>
              <path d="M 160,192 L 264,192" fill="none" stroke="black"></path>
              <path d="M 320,192 L 352,192" fill="none" stroke="black"></path>
              <path d="M 408,192 L 520,192" fill="none" stroke="black"></path>
              <path d="M 264,224 L 296,224" fill="none" stroke="black"></path>
              <path d="M 376,224 L 408,224" fill="none" stroke="black"></path>
              <path d="M 160,256 L 264,256" fill="none" stroke="black"></path>
              <path d="M 320,256 L 352,256" fill="none" stroke="black"></path>
              <path d="M 408,256 L 520,256" fill="none" stroke="black"></path>
              <path d="M 24,272 L 200,272" fill="none" stroke="black"></path>
              <path d="M 216,272 L 536,272" fill="none" stroke="black"></path>
              <path d="M 112,288 L 448,288" fill="none" stroke="black"></path>
              <path d="M 24,304 L 88,304" fill="none" stroke="black"></path>
              <path d="M 104,304 L 200,304" fill="none" stroke="black"></path>
              <path d="M 216,304 L 320,304" fill="none" stroke="black"></path>
              <path d="M 336,304 L 456,304" fill="none" stroke="black"></path>
              <path d="M 472,304 L 536,304" fill="none" stroke="black"></path>
              <path d="M 40,336 L 88,336" fill="none" stroke="black"></path>
              <path d="M 104,336 L 144,336" fill="none" stroke="black"></path>
              <path d="M 160,336 L 200,336" fill="none" stroke="black"></path>
              <path d="M 216,336 L 272,336" fill="none" stroke="black"></path>
              <path d="M 288,336 L 320,336" fill="none" stroke="black"></path>
              <path d="M 336,336 L 400,336" fill="none" stroke="black"></path>
              <path d="M 416,336 L 456,336" fill="none" stroke="black"></path>
              <path d="M 472,336 L 520,336" fill="none" stroke="black"></path>
              <path d="M 40,384 L 144,384" fill="none" stroke="black"></path>
              <path d="M 160,384 L 272,384" fill="none" stroke="black"></path>
              <path d="M 288,384 L 400,384" fill="none" stroke="black"></path>
              <path d="M 416,384 L 520,384" fill="none" stroke="black"></path>
              <path d="M 24,416 L 536,416" fill="none" stroke="black"></path>
              <path d="M 8,432 L 552,432" fill="none" stroke="black"></path>
              <path d="M 112,464 L 136,464" fill="none" stroke="black"></path>
              <path d="M 216,464 L 240,464" fill="none" stroke="black"></path>
              <path d="M 328,464 L 344,464" fill="none" stroke="black"></path>
              <path d="M 320,192 C 311.16936,192 304,199.16936 304,208" fill="none" stroke="black"></path>
              <path d="M 352,192 C 360.83064,192 368,199.16936 368,208" fill="none" stroke="black"></path>
              <path d="M 320,256 C 311.16936,256 304,248.83064 304,240" fill="none" stroke="black"></path>
              <path d="M 352,256 C 360.83064,256 368,248.83064 368,240" fill="none" stroke="black"></path>
              <path d="M 112,288 C 103.16936,288 96,295.16936 96,304" fill="none" stroke="black"></path>
              <path d="M 448,288 C 456.83064,288 464,295.16936 464,304" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="472,72 460,66.4 460,77.6" fill="black" transform="rotate(270,464,72)"></polygon>
              <polygon class="arrowhead" points="384,224 372,218.4 372,229.6" fill="black" transform="rotate(180,376,224)"></polygon>
              <polygon class="arrowhead" points="304,224 292,218.4 292,229.6" fill="black" transform="rotate(0,296,224)"></polygon>
              <polygon class="arrowhead" points="248,464 236,458.4 236,469.6" fill="black" transform="rotate(0,240,464)"></polygon>
              <polygon class="arrowhead" points="144,464 132,458.4 132,469.6" fill="black" transform="rotate(0,136,464)"></polygon>
              <circle cx="96" cy="336" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="208" cy="336" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="328" cy="336" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="352" cy="464" r="6" class="opendot" fill="white" stroke="black"></circle>
              <circle cx="464" cy="336" r="6" class="opendot" fill="white" stroke="black"></circle>
              <g class="text">
                <text x="468" y="52">Verifier</text>
                <text x="392" y="116">PSA</text>
                <text x="432" y="116">Token</text>
                <text x="72" y="180">Attesting</text>
                <text x="160" y="180">Environment</text>
                <text x="188" y="212">Main</text>
                <text x="332" y="212">Main</text>
                <text x="448" y="212">Initial</text>
                <text x="212" y="228">Bootloader</text>
                <text x="332" y="228">Boot</text>
                <text x="464" y="228">Attestation</text>
                <text x="280" y="244">W</text>
                <text x="336" y="244">State</text>
                <text x="392" y="244">R</text>
                <text x="448" y="244">Service</text>
                <text x="92" y="356">Updateable</text>
                <text x="216" y="356">Application</text>
                <text x="344" y="356">Application</text>
                <text x="440" y="356">PSA</text>
                <text x="472" y="356">RoT</text>
                <text x="64" y="372">PSA</text>
                <text x="96" y="372">RoT</text>
                <text x="184" y="372">RoT</text>
                <text x="324" y="372">Loader</text>
                <text x="468" y="372">Parameters</text>
                <text x="60" y="404">Target</text>
                <text x="136" y="404">Environment</text>
                <text x="32" y="452">Legend:</text>
                <text x="164" y="468">read</text>
                <text x="272" y="468">write</text>
                <text x="392" y="468">measure</text>
                <text x="120" y="484">R</text>
                <text x="224" y="484">W</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-psa-attester" class="selfRef">PSA Attester</a>
        </figcaption></figure>
</div>
<p id="section-3-3">The PSA Attester is a relatively straightforward embodiment of the RATS
Attester with exactly one Attesting Environment and one or more Target Environments.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The Attesting Environment is responsible for collecting the
  information to be represented in PSA claims and to assemble them into
  Evidence.  The Attesting Environment is made of two cooperating
  components:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <p id="section-3-5.1.1">Executing at boot-time, the Main Bootloader measures the Target Environments (i.e., loaded software
components and all the relevant PSA RoT parameters) and stores the recorded
information in secure memory (Main Boot State). See <a href="#fig-psa-attester-boot" class="auto internal xref">Figure 2</a>.<a href="#section-3-5.1.1" class="pilcrow">¶</a></p>
<span id="name-psa-attester-boot-phase"></span><div id="fig-psa-attester-boot">
<figure id="figure-2">
            <div id="section-3-5.1.2.1">
              <div class="alignCenter art-svg artwork" id="section-3-5.1.2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="352" viewBox="0 0 352 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,80 L 8,192" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 80,208" fill="none" stroke="black"></path>
                  <path d="M 192,64 L 192,208" fill="none" stroke="black"></path>
                  <path d="M 304,64 L 304,208" fill="none" stroke="black"></path>
                  <path d="M 344,80 L 344,192" fill="none" stroke="black"></path>
                  <path d="M 8,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 88,80 L 184,80" fill="none" stroke="black"></path>
                  <path d="M 200,80 L 296,80" fill="none" stroke="black"></path>
                  <path d="M 312,80 L 344,80" fill="none" stroke="black"></path>
                  <path d="M 96,128 L 192,128" fill="none" stroke="black"></path>
                  <path d="M 192,176 L 296,176" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 72,192" fill="none" stroke="black"></path>
                  <path d="M 88,192 L 184,192" fill="none" stroke="black"></path>
                  <path d="M 200,192 L 296,192" fill="none" stroke="black"></path>
                  <path d="M 312,192 L 344,192" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="304,176 292,170.4 292,181.6" fill="black" transform="rotate(0,296,176)"></polygon>
                  <circle cx="88" cy="128" r="6" class="opendot" fill="white" stroke="black"></circle>
                  <g class="text">
                    <text x="52" y="36">i-th</text>
                    <text x="100" y="36">Target</text>
                    <text x="172" y="36">Main</text>
                    <text x="212" y="36">Boot</text>
                    <text x="284" y="36">Main</text>
                    <text x="324" y="36">Boot</text>
                    <text x="80" y="52">Environment</text>
                    <text x="196" y="52">Loader</text>
                    <text x="304" y="52">State</text>
                    <text x="36" y="100">loop</text>
                    <text x="64" y="100">i</text>
                    <text x="120" y="116">measure</text>
                    <text x="224" y="148">write</text>
                    <text x="248" y="164">measurement</text>
                  </g>
                </svg><a href="#section-3-5.1.2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-psa-attester-boot-phase" class="selfRef">PSA Attester Boot Phase</a>
            </figcaption></figure>
</div>
</li>
        <li class="normal" id="section-3-5.2">The Initial Attestation Service (executing at run-time in SPE)
        answers requests coming from NSPE via the PSA attestation API <span>[<a href="#PSA-API" class="cite xref">PSA-API</a>]</span>, collects and formats the claims from Main Boot
        State, and uses the Initial Attestation Key (IAK) to sign them and
        produce Evidence. See <a href="#fig-psa-attester-runtime" class="auto internal xref">Figure 3</a>.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">The word "Initial" in "Initial Attestation Service" refers to a limited set of
Target Environments, namely those representing the first foundational stages
establishing the chain of trust of a PSA device.
Collecting measurements from Target Environments after this initial phase is outside the scope of this specification. Extensions of this specification could collect up-to-date measurements from additional Target Environments and define additional claims for use within those environments, but these are, by definition, custom.<a href="#section-3-6" class="pilcrow">¶</a></p>
<span id="name-psa-attester-run-time-phase"></span><div id="fig-psa-attester-runtime">
<figure id="figure-3">
        <div id="section-3-7.1">
          <div class="alignCenter art-svg artwork" id="section-3-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="304" width="360" viewBox="0 0 360 304" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,96 L 8,192" fill="none" stroke="black"></path>
              <path d="M 80,80 L 80,288" fill="none" stroke="black"></path>
              <path d="M 184,208 L 184,240" fill="none" stroke="black"></path>
              <path d="M 216,80 L 216,288" fill="none" stroke="black"></path>
              <path d="M 312,80 L 312,288" fill="none" stroke="black"></path>
              <path d="M 352,96 L 352,192" fill="none" stroke="black"></path>
              <path d="M 8,96 L 72,96" fill="none" stroke="black"></path>
              <path d="M 88,96 L 208,96" fill="none" stroke="black"></path>
              <path d="M 224,96 L 304,96" fill="none" stroke="black"></path>
              <path d="M 320,96 L 352,96" fill="none" stroke="black"></path>
              <path d="M 88,176 L 216,176" fill="none" stroke="black"></path>
              <path d="M 8,192 L 72,192" fill="none" stroke="black"></path>
              <path d="M 88,192 L 208,192" fill="none" stroke="black"></path>
              <path d="M 224,192 L 304,192" fill="none" stroke="black"></path>
              <path d="M 320,192 L 352,192" fill="none" stroke="black"></path>
              <path d="M 184,208 L 216,208" fill="none" stroke="black"></path>
              <path d="M 184,240 L 208,240" fill="none" stroke="black"></path>
              <path d="M 216,272 L 304,272" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="312,272 300,266.4 300,277.6" fill="black" transform="rotate(0,304,272)"></polygon>
              <polygon class="arrowhead" points="216,240 204,234.4 204,245.6" fill="black" transform="rotate(0,208,240)"></polygon>
              <polygon class="arrowhead" points="96,176 84,170.4 84,181.6" fill="black" transform="rotate(180,88,176)"></polygon>
              <g class="text">
                <text x="216" y="36">Initial</text>
                <text x="60" y="52">Main</text>
                <text x="100" y="52">Boot</text>
                <text x="216" y="52">Attestation</text>
                <text x="80" y="68">State</text>
                <text x="216" y="68">Service</text>
                <text x="316" y="68">Verifier</text>
                <text x="36" y="116">loop</text>
                <text x="64" y="116">i</text>
                <text x="108" y="116">read</text>
                <text x="136" y="132">measurement</text>
                <text x="196" y="132">of</text>
                <text x="108" y="148">i-th</text>
                <text x="156" y="148">Target</text>
                <text x="136" y="164">Environment</text>
                <text x="156" y="228">sign</text>
                <text x="240" y="260">PSA</text>
                <text x="280" y="260">Token</text>
              </g>
            </svg><a href="#section-3-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-psa-attester-run-time-phase" class="selfRef">PSA Attester Run-Time Phase</a>
        </figcaption></figure>
</div>
<p id="section-3-8">The Target Environments can be of four types, some of
which may or may not be present depending on the device architecture:<a href="#section-3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-9.1">(A subset of) the PSA RoT parameters, including Instance and
        Implementation IDs.<a href="#section-3-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.2">The updateable PSA RoT, including the Secure Partition Manager and
        all PSA RoT services.<a href="#section-3-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.3">The (optional) Application RoT, that is any application-defined
        security service possibly making use of the PSA RoT services.<a href="#section-3-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.4">The loader of the application software running in NSPE.<a href="#section-3-9.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-10">A reference implementation of the PSA Attester is provided by <span>[<a href="#TF-M" class="cite xref">TF-M</a>]</span>.<a href="#section-3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-psa-claims">
<section id="section-4">
      <h2 id="name-psa-claims">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-psa-claims" class="section-name selfRef">PSA Claims</a>
      </h2>
<p id="section-4-1">This section describes the claims to be used in a PSA attestation token.
A more comprehensive treatment of the EAT profiles defined by PSA is found in <a href="#sec-profiles" class="auto internal xref">Section 5</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> along with text descriptions is used to define each claim
independent of encoding.  The following CDDL types are reused by different
claims:<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4-3">
<pre>
psa-hash-type = bytes .size 32 / bytes .size 48 / bytes .size 64</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">Two conventions are used to encode the Right-Hand-Side (RHS) of a claim. The postfix <code>-label</code> is used for EAT-defined claims and the postfix <code>-key</code> is used for PSA-originated claims.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="caller-claims">
<section id="section-4.1">
        <h3 id="name-caller-claims">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-caller-claims" class="section-name selfRef">Caller Claims</a>
        </h3>
<div id="sec-nonce-claim">
<section id="section-4.1.1">
          <h4 id="name-nonce">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-nonce" class="section-name selfRef">Nonce</a>
          </h4>
<p id="section-4.1.1-1">The EAT <span>[<a href="#RFC9711" class="cite xref">EAT</a>]</span> "nonce" (claim key 10) is used to carry the challenge provided by the caller to demonstrate freshness of the generated token.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Since the EAT nonce claim offers flexibility for different
attestation technologies, this specification applies the following constraints
 to the <code>nonce-type</code>:<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1">The length <span class="bcp14">MUST</span> be either 32, 48, or 64 bytes.<a href="#section-4.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.2">Only a single nonce value is conveyed. The array notation
            <span class="bcp14">MUST NOT</span> be used for encoding the nonce value.<a href="#section-4.1.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-4">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.1-5">
<pre>
psa-nonce = (
    nonce-label =&gt; psa-hash-type
)</pre><a href="#section-4.1.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-client-id">
<section id="section-4.1.2">
          <h4 id="name-client-id">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-client-id" class="section-name selfRef">Client ID</a>
          </h4>
<p id="section-4.1.2-1">The Client ID claim represents the security domain of the caller.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">In PSA, a security domain is represented by a signed
integer whereby negative values represent callers from the NSPE and where
positive IDs represent callers from the SPE. The value 0 is not permitted.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">For an example definition of client IDs, see the PSA Firmware Framework <span>[<a href="#PSA-FF" class="cite xref">PSA-FF</a>]</span>.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">It is essential that this claim is checked in the verification process to
ensure that a security domain, i.e., an attestation endpoint, cannot spoof a
report from another security domain.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.1.2-6">
<pre>
psa-client-id-nspe-type = -2147483648...0
psa-client-id-spe-type = 1..2147483647

psa-client-id-type = psa-client-id-nspe-type / psa-client-id-spe-type

psa-client-id = (
    psa-client-id-key =&gt; psa-client-id-type
)</pre><a href="#section-4.1.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="target-identification-claims">
<section id="section-4.2">
        <h3 id="name-target-identification-claim">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-target-identification-claim" class="section-name selfRef">Target Identification Claims</a>
        </h3>
<div id="sec-instance-id-claim">
<section id="section-4.2.1">
          <h4 id="name-instance-id">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-instance-id" class="section-name selfRef">Instance ID</a>
          </h4>
<p id="section-4.2.1-1">The Instance ID claim represents the unique identifier of the IAK.  The full definition is in <span>[<a href="#PSA-SM" class="cite xref">PSA-SM</a>]</span>.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">The EAT <code>ueid</code> (claim key 256) of type RAND is used.  The following constraints
apply to the <code>ueid-type</code>:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">The length <span class="bcp14">MUST</span> be 33 bytes.<a href="#section-4.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-3.2">The first byte <span class="bcp14">MUST</span> be 0x01 (RAND) followed by
            the 32-byte unique identifier of the IAK. <span>[<a href="#PSA-API" class="cite xref">PSA-API</a>]</span>
            provides implementation options for deriving the IAK unique
            identifier from the IAK itself.<a href="#section-4.2.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.2.1-4">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.2.1-5">
<pre>
psa-instance-id-type = bytes .size 33

psa-instance-id = (
    ueid-label =&gt; psa-instance-id-type
)</pre><a href="#section-4.2.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-implementation-id">
<section id="section-4.2.2">
          <h4 id="name-implementation-id">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-implementation-id" class="section-name selfRef">Implementation ID</a>
          </h4>
<p id="section-4.2.2-1">The Implementation ID claim uniquely identifies the hardware assembly of the
immutable PSA RoT. A verification service uses this claim to locate the
details of the PSA RoT implementation from an Endorser or manufacturer.
Such details are used by a verification service to determine the security properties
or certification status of the PSA RoT implementation.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The value and format of the ID is decided by
the manufacturer or a particular certification scheme. For example, the ID
could take the form of a product serial number,
database ID, or other appropriate identifier.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">Note that this identifies the PSA RoT implementation, not a particular instance.
To uniquely identify an instance, see the Instance ID claim <a href="#sec-instance-id-claim" class="auto internal xref">Section 4.2.1</a>.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.2.2-5">
<pre>
psa-implementation-id-type = bytes .size 32

psa-implementation-id = (
    psa-implementation-id-key =&gt; psa-implementation-id-type
)</pre><a href="#section-4.2.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-certification-reference">
<section id="section-4.2.3">
          <h4 id="name-certification-reference">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-certification-reference" class="section-name selfRef">Certification Reference</a>
          </h4>
<p id="section-4.2.3-1">The Certification Reference claim is used to link the class of chip and PSA RoT
of the attesting device to an associated entry in the PSA Certification
database. 
The Certification Reference claim <span class="bcp14">MUST</span> be represented as a
string made of nineteen numeric characters: a thirteen-digit EAN-13 <span>[<a href="#EAN-13" class="cite xref">EAN-13</a>]</span> followed by a dash "-" and the five-digit versioning
information described in <span>[<a href="#PSA-Cert-Guide" class="cite xref">PSA-Cert-Guide</a>]</span>.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">Linking to the PSA Certification entry can still be achieved if this claim is
not present in the token by making an association at a Verifier between the
reference value and other token claim values, for example, the Implementation
ID.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">This claim <span class="bcp14">MAY</span> be present in a PSA attestation token.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.2.3-4">
<pre>
psa-certification-reference-type = text .regexp "[0-9]{13}-[0-9]{5}"

psa-certification-reference = (
    ? psa-certification-reference-key =&gt;
        psa-certification-reference-type
)</pre><a href="#section-4.2.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="target-state-claims">
<section id="section-4.3">
        <h3 id="name-target-state-claims">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-target-state-claims" class="section-name selfRef">Target State Claims</a>
        </h3>
<div id="sec-security-lifecycle">
<section id="section-4.3.1">
          <h4 id="name-security-lifecycle">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-security-lifecycle" class="section-name selfRef">Security Lifecycle</a>
          </h4>
<p id="section-4.3.1-1">The Security Lifecycle claim represents the current lifecycle state of the PSA
RoT. The state is represented by an integer that is divided to convey a major
state and a minor state. A major state is mandatory and defined by <span>[<a href="#PSA-SM" class="cite xref">PSA-SM</a>]</span>.
A minor state is optional and 'IMPLEMENTATION DEFINED'. The PSA security
lifecycle state and implementation state are encoded as follows:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-2.1">major[15:8] - PSA security lifecycle state, and<a href="#section-4.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.3.1-2.2">minor[7:0] - IMPLEMENTATION DEFINED state.<a href="#section-4.3.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.1-3">The PSA lifecycle states are illustrated in <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a>. For PSA,
a Verifier can only trust reports from the PSA RoT when it is in SECURED or
NON_PSA_ROT_DEBUG major states.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-4">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<span id="name-psa-lifecycle-states"></span><div id="fig-lifecycle-states">
<figure id="figure-4">
            <div id="section-4.3.1-5.1">
              <div class="alignLeft art-svg artwork" id="section-4.3.1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="528" width="472" viewBox="0 0 472 528" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,272 L 24,416" fill="none" stroke="black"></path>
                  <path d="M 24,448 L 24,480" fill="none" stroke="black"></path>
                  <path d="M 104,48 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 112,144 L 112,160" fill="none" stroke="black"></path>
                  <path d="M 128,352 L 128,400" fill="none" stroke="black"></path>
                  <path d="M 144,240 L 144,272" fill="none" stroke="black"></path>
                  <path d="M 144,480 L 144,512" fill="none" stroke="black"></path>
                  <path d="M 160,272 L 160,288" fill="none" stroke="black"></path>
                  <path d="M 160,320 L 160,344" fill="none" stroke="black"></path>
                  <path d="M 208,64 L 208,120" fill="none" stroke="black"></path>
                  <path d="M 208,160 L 208,232" fill="none" stroke="black"></path>
                  <path d="M 208,400 L 208,416" fill="none" stroke="black"></path>
                  <path d="M 208,448 L 208,472" fill="none" stroke="black"></path>
                  <path d="M 232,208 L 232,232" fill="none" stroke="black"></path>
                  <path d="M 264,280 L 264,304" fill="none" stroke="black"></path>
                  <path d="M 264,336 L 264,352" fill="none" stroke="black"></path>
                  <path d="M 280,240 L 280,272" fill="none" stroke="black"></path>
                  <path d="M 280,480 L 280,512" fill="none" stroke="black"></path>
                  <path d="M 288,352 L 288,400" fill="none" stroke="black"></path>
                  <path d="M 304,128 L 304,144" fill="none" stroke="black"></path>
                  <path d="M 312,352 L 312,400" fill="none" stroke="black"></path>
                  <path d="M 320,32 L 320,48" fill="none" stroke="black"></path>
                  <path d="M 352,304 L 352,344" fill="none" stroke="black"></path>
                  <path d="M 368,400 L 368,416" fill="none" stroke="black"></path>
                  <path d="M 368,448 L 368,480" fill="none" stroke="black"></path>
                  <path d="M 400,208 L 400,304" fill="none" stroke="black"></path>
                  <path d="M 400,336 L 400,352" fill="none" stroke="black"></path>
                  <path d="M 440,352 L 440,400" fill="none" stroke="black"></path>
                  <path d="M 120,32 L 320,32" fill="none" stroke="black"></path>
                  <path d="M 104,64 L 304,64" fill="none" stroke="black"></path>
                  <path d="M 128,128 L 304,128" fill="none" stroke="black"></path>
                  <path d="M 112,160 L 288,160" fill="none" stroke="black"></path>
                  <path d="M 248,192 L 384,192" fill="none" stroke="black"></path>
                  <path d="M 144,240 L 280,240" fill="none" stroke="black"></path>
                  <path d="M 40,256 L 144,256" fill="none" stroke="black"></path>
                  <path d="M 280,256 L 336,256" fill="none" stroke="black"></path>
                  <path d="M 144,272 L 280,272" fill="none" stroke="black"></path>
                  <path d="M 128,352 L 288,352" fill="none" stroke="black"></path>
                  <path d="M 312,352 L 440,352" fill="none" stroke="black"></path>
                  <path d="M 128,400 L 288,400" fill="none" stroke="black"></path>
                  <path d="M 312,400 L 440,400" fill="none" stroke="black"></path>
                  <path d="M 144,480 L 280,480" fill="none" stroke="black"></path>
                  <path d="M 40,496 L 136,496" fill="none" stroke="black"></path>
                  <path d="M 288,496 L 352,496" fill="none" stroke="black"></path>
                  <path d="M 144,512 L 280,512" fill="none" stroke="black"></path>
                  <path d="M 120,32 C 111.16936,32 104,39.16936 104,48" fill="none" stroke="black"></path>
                  <path d="M 304,64 C 312.83064,64 320,56.83064 320,48" fill="none" stroke="black"></path>
                  <path d="M 128,128 C 119.16936,128 112,135.16936 112,144" fill="none" stroke="black"></path>
                  <path d="M 288,160 C 296.83064,160 304,152.83064 304,144" fill="none" stroke="black"></path>
                  <path d="M 248,192 C 239.16936,192 232,199.16936 232,208" fill="none" stroke="black"></path>
                  <path d="M 384,192 C 392.83064,192 400,199.16936 400,208" fill="none" stroke="black"></path>
                  <path d="M 40,256 C 31.16936,256 24,263.16936 24,272" fill="none" stroke="black"></path>
                  <path d="M 336,256 C 344.83064,256 352,263.16936 352,272" fill="none" stroke="black"></path>
                  <path d="M 40,496 C 31.16936,496 24,488.83064 24,480" fill="none" stroke="black"></path>
                  <path d="M 352,496 C 360.83064,496 368,488.83064 368,480" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="360,344 348,338.4 348,349.6" fill="black" transform="rotate(90,352,344)"></polygon>
                  <polygon class="arrowhead" points="296,496 284,490.4 284,501.6" fill="black" transform="rotate(180,288,496)"></polygon>
                  <polygon class="arrowhead" points="272,280 260,274.4 260,285.6" fill="black" transform="rotate(270,264,280)"></polygon>
                  <polygon class="arrowhead" points="240,232 228,226.4 228,237.6" fill="black" transform="rotate(90,232,232)"></polygon>
                  <polygon class="arrowhead" points="216,472 204,466.4 204,477.6" fill="black" transform="rotate(90,208,472)"></polygon>
                  <polygon class="arrowhead" points="216,232 204,226.4 204,237.6" fill="black" transform="rotate(90,208,232)"></polygon>
                  <polygon class="arrowhead" points="216,120 204,114.4 204,125.6" fill="black" transform="rotate(90,208,120)"></polygon>
                  <polygon class="arrowhead" points="168,344 156,338.4 156,349.6" fill="black" transform="rotate(90,160,344)"></polygon>
                  <polygon class="arrowhead" points="144,496 132,490.4 132,501.6" fill="black" transform="rotate(0,136,496)"></polygon>
                  <g class="text">
                    <text x="140" y="52">Device</text>
                    <text x="204" y="52">Assembly</text>
                    <text x="256" y="52">and</text>
                    <text x="292" y="52">Test</text>
                    <text x="244" y="84">Device</text>
                    <text x="252" y="100">Lockdown</text>
                    <text x="136" y="148">PSA</text>
                    <text x="168" y="148">RoT</text>
                    <text x="236" y="148">Provisioning</text>
                    <text x="148" y="196">Provisioning</text>
                    <text x="148" y="212">Lockdown</text>
                    <text x="208" y="260">Secured</text>
                    <text x="352" y="292">Debug</text>
                    <text x="160" y="308">Debug</text>
                    <text x="272" y="324">Recoverable</text>
                    <text x="416" y="324">Recoverable</text>
                    <text x="208" y="372">(Non-Recoverable)</text>
                    <text x="368" y="372">Recoverable</text>
                    <text x="168" y="388">Non-PSA</text>
                    <text x="216" y="388">RoT</text>
                    <text x="256" y="388">Debug</text>
                    <text x="336" y="388">PSA</text>
                    <text x="368" y="388">RoT</text>
                    <text x="408" y="388">Debug</text>
                    <text x="40" y="436">Terminate</text>
                    <text x="208" y="436">Non-Recoverable</text>
                    <text x="328" y="436">PSA</text>
                    <text x="360" y="436">RoT</text>
                    <text x="424" y="436">Compromised</text>
                    <text x="212" y="500">Decommissioned</text>
                  </g>
                </svg><a href="#section-4.3.1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-psa-lifecycle-states" class="selfRef">PSA Lifecycle States</a>
            </figcaption></figure>
</div>
<p id="section-4.3.1-6">The CDDL representation is shown below.
<a href="#tab-states-map" class="auto internal xref">Table 1</a> provides the mappings between <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a> and the data model.<a href="#section-4.3.1-6" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.3.1-7">
<pre>
psa-lifecycle-unknown-type = 0x0000..0x00ff
psa-lifecycle-assembly-and-test-type = 0x1000..0x10ff
psa-lifecycle-psa-rot-provisioning-type = 0x2000..0x20ff
psa-lifecycle-secured-type = 0x3000..0x30ff
psa-lifecycle-non-psa-rot-debug-type = 0x4000..0x40ff
psa-lifecycle-recoverable-psa-rot-debug-type = 0x5000..0x50ff
psa-lifecycle-decommissioned-type = 0x6000..0x60ff

psa-lifecycle-type =
    psa-lifecycle-unknown-type /
    psa-lifecycle-assembly-and-test-type /
    psa-lifecycle-psa-rot-provisioning-type /
    psa-lifecycle-secured-type /
    psa-lifecycle-non-psa-rot-debug-type /
    psa-lifecycle-recoverable-psa-rot-debug-type /
    psa-lifecycle-decommissioned-type

psa-lifecycle = (
    psa-lifecycle-key =&gt; psa-lifecycle-type
)</pre><a href="#section-4.3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-8"><code>psa-lifecycle-unknown-type</code> is not shown in <a href="#fig-lifecycle-states" class="auto internal xref">Figure 4</a>; it represents an invalid state that must not occur in a system.<a href="#section-4.3.1-8" class="pilcrow">¶</a></p>
<span id="name-lifecycle-states-mappings"></span><div id="tab-states-map">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-lifecycle-states-mappings" class="selfRef">Lifecycle States Mappings</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">CDDL</th>
                <th class="text-left" rowspan="1" colspan="1">Lifecycle States</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-unknown-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-assembly-and-test-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Assembly and Test</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-psa-rot-provisioning-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">PSA RoT Provisioning</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-secured-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Secured</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-non-psa-rot-debug-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Non-Recoverable PSA RoT Debug</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-recoverable-psa-rot-debug-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Recoverable PSA RoT Debug</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>psa-lifecycle-decommissioned-type</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Decommissioned</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="sec-boot-seed">
<section id="section-4.3.2">
          <h4 id="name-boot-seed">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-boot-seed" class="section-name selfRef">Boot Seed</a>
          </h4>
<p id="section-4.3.2-1">The "bootseed" claim contains a value created at system boot time
that allows differentiation of attestation reports from different
boot sessions of a particular entity (i.e., a certain Instance ID).<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The EAT "bootseed" (claim key 268) is used.
The following constraints apply to the <code>binary-data</code> type:<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2-3.1">The length <span class="bcp14">MUST</span> be between 8 and 32 bytes.<a href="#section-4.3.2-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.3.2-4">This claim <span class="bcp14">MAY</span> be present in a PSA attestation token.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.3.2-5">
<pre>
psa-boot-seed-type = bytes .size (8..32)

psa-boot-seed = (
    boot-seed-label =&gt; psa-boot-seed-type
)</pre><a href="#section-4.3.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="software-inventory-claims">
<section id="section-4.4">
        <h3 id="name-software-inventory-claims">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-software-inventory-claims" class="section-name selfRef">Software Inventory Claims</a>
        </h3>
<div id="sec-sw-components">
<section id="section-4.4.1">
          <h4 id="name-software-components">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-software-components" class="section-name selfRef">Software Components</a>
          </h4>
<p id="section-4.4.1-1">The Software Components claim is a list of software components that includes
all the software (both code and configuration) loaded by the PSA RoT.  This
claim <span class="bcp14">MUST</span> be included in attestation tokens produced by an implementation
conformant with <span>[<a href="#PSA-SM" class="cite xref">PSA-SM</a>]</span>.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">Each entry in the Software Components list describes one software component
using the attributes described in the following subsections.  Unless explicitly
stated, the presence of an attribute is <span class="bcp14">OPTIONAL</span>.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">Note that a Relying Party will typically see the
result of the appraisal process from the Verifier in form of an Attestation
Result rather than the PSA token from the attesting endpoint as described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
Therefore, a Relying Party is not expected to understand the Software
Components claim.  Instead, it is for the Verifier to check this claim against
the available Reference Values and provide an answer in form of a "high-level"
Attestation Result, which may or may not include the original Software
Components claim.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.4.1-4">
<pre>
psa-software-component = {
  ? &amp;(measurement-type: 1) =&gt; text
    &amp;(measurement-value: 2) =&gt; psa-hash-type
  ? &amp;(version: 4) =&gt; text
    &amp;(signer-id: 5) =&gt; psa-hash-type
  ? &amp;(measurement-desc: 6) =&gt; text
}

psa-software-components = (
    psa-software-components-key =&gt; [ + psa-software-component ]
)</pre><a href="#section-4.4.1-4" class="pilcrow">¶</a>
</div>
<div id="measurement-type">
<section id="section-4.4.1.1">
            <h5 id="name-measurement-type">
<a href="#section-4.4.1.1" class="section-number selfRef">4.4.1.1. </a><a href="#name-measurement-type" class="section-name selfRef">Measurement Type</a>
            </h5>
<p id="section-4.4.1.1-1">The Measurement Type attribute (key=1) is a short string representing the role of
this software component.<a href="#section-4.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1.1-2">The following measurement types <span class="bcp14">MAY</span> be used for code measurements:<a href="#section-4.4.1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.1.1-3">
              <dt id="section-4.4.1.1-3.1">"BL":</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.1.1-3.2">a Boot Loader<a href="#section-4.4.1.1-3.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.4.1.1-3.3">"PRoT":</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.1.1-3.4">a component of the PSA Root of Trust<a href="#section-4.4.1.1-3.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.4.1.1-3.5">"ARoT":</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.1.1-3.6">a component of the Application Root of Trust<a href="#section-4.4.1.1-3.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.4.1.1-3.7">"App":</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.1.1-3.8">a component of the NSPE application<a href="#section-4.4.1.1-3.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.4.1.1-3.9">"TS":</dt>
              <dd style="margin-left: 1.5em" id="section-4.4.1.1-3.10">a component of a Trusted Subsystem<a href="#section-4.4.1.1-3.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-4.4.1.1-4">The same labels with a "_CONFIG" postfix (e.g., "PRoT_CONFIG") <span class="bcp14">MAY</span> be used for
configuration measurements.<a href="#section-4.4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.4.1.1-5">This attribute <span class="bcp14">SHOULD</span> be present in a PSA software component unless
there is a very good reason to leave it out, for example, in networks
with severely constrained bandwidth where sparing a few bytes really
makes a difference.<a href="#section-4.4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="measurement-value">
<section id="section-4.4.1.2">
            <h5 id="name-measurement-value">
<a href="#section-4.4.1.2" class="section-number selfRef">4.4.1.2. </a><a href="#name-measurement-value" class="section-name selfRef">Measurement Value</a>
            </h5>
<p id="section-4.4.1.2-1">The Measurement Value attribute (key=2) represents a hash of the invariant
software component in memory at startup time. The value <span class="bcp14">MUST</span> be a cryptographic
hash of 256 bits or stronger.<a href="#section-4.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1.2-2">This attribute <span class="bcp14">MUST</span> be present in a PSA software component.<a href="#section-4.4.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="version">
<section id="section-4.4.1.3">
            <h5 id="name-version">
<a href="#section-4.4.1.3" class="section-number selfRef">4.4.1.3. </a><a href="#name-version" class="section-name selfRef">Version</a>
            </h5>
<p id="section-4.4.1.3-1">The Version attribute (key=4) is the issued software version in the form of a
text string. The value of this attribute will correspond to the entry in the
original signed manifest of the component.<a href="#section-4.4.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signer-id">
<section id="section-4.4.1.4">
            <h5 id="name-signer-id">
<a href="#section-4.4.1.4" class="section-number selfRef">4.4.1.4. </a><a href="#name-signer-id" class="section-name selfRef">Signer ID</a>
            </h5>
<p id="section-4.4.1.4-1">The Signer ID attribute (key=5) uniquely identifies the signer of the software component. The identification is typically accomplished by hashing the signer's public key.
The value of this attribute will correspond to the
entry in the original manifest for the component. This can be used by a
Verifier to ensure the components were signed by an expected trusted source.<a href="#section-4.4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1.4-2">This attribute <span class="bcp14">MUST</span> be present in a PSA software component to be compliant with
<span>[<a href="#PSA-SM" class="cite xref">PSA-SM</a>]</span>.<a href="#section-4.4.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="measurement-description">
<section id="section-4.4.1.5">
            <h5 id="name-measurement-description">
<a href="#section-4.4.1.5" class="section-number selfRef">4.4.1.5. </a><a href="#name-measurement-description" class="section-name selfRef">Measurement Description</a>
            </h5>
<p id="section-4.4.1.5-1">The Measurement Description attribute (key=6) contains a string identifying the
hash algorithm used to compute the corresponding Measurement Value.  The string
<span class="bcp14">SHOULD</span> be encoded according to "Hash Name String" in the "Named Information Hash Algorithm Registry" <span>[<a href="#NAMED-INFO" class="cite xref">NAMED-INFO</a>]</span>.<a href="#section-4.4.1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="verification-claims">
<section id="section-4.5">
        <h3 id="name-verification-claims">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-verification-claims" class="section-name selfRef">Verification Claims</a>
        </h3>
<p id="section-4.5-1">  The following claims, although part of Evidence, do not reflect the
  internal state of the Attester. Instead, they aim to help receivers,
  including Relying Parties, in processing the received attestation
  Evidence.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="sec-verification-service-indicator">
<section id="section-4.5.1">
          <h4 id="name-verification-service-indica">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-verification-service-indica" class="section-name selfRef">Verification Service Indicator</a>
          </h4>
<p id="section-4.5.1-1">The Verification Service Indicator claim is a hint used by a Relying Party to
locate a verification service for the token. The value is a text string that
can be used to locate the service (typically, a URL specifying the address of
the verification service API). A Relying Party may choose to ignore this claim
in favor of other information.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.5.1-2">
<pre>
psa-verification-service-indicator-type = text

psa-verification-service-indicator = (
    ? psa-verification-service-indicator-key =&gt;
        psa-verification-service-indicator-type
)</pre><a href="#section-4.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.5.1-3">It is assumed that the Relying Party is pre-configured with a list of trusted
verification services and that the contents of this hint can be used to look
up the correct one. Under no circumstances must the Relying Party be tricked
into contacting an unknown and untrusted verification service since the
returned Attestation Result cannot be relied on.<a href="#section-4.5.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.1-4">Note: This hint requires the Relying Party to parse the content of the
PSA token. Since the Relying Party may not be in possession of a trust
anchor to verify the digital signature, it uses the hint in the same way
as it would treat any other information provided by an external party,
which includes attacker-provided data.<a href="#section-4.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-profile-definition-claim">
<section id="section-4.5.2">
          <h4 id="name-profile-definition">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-profile-definition" class="section-name selfRef">Profile Definition</a>
          </h4>
<p id="section-4.5.2-1">The Profile Definition claim encodes the unique identifier that corresponds to
the EAT profile described by this document.  This allows a receiver to assign
the intended semantics to the rest of the claims found in the token.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">The EAT <code>eat_profile</code> (claim key 265) is used.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">The URI encoding <span class="bcp14">MUST</span> be used.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
<p id="section-4.5.2-4">The value <span class="bcp14">MUST</span> be <code>tag:psacertified.org,2023:psa#tfm</code> for the profile defined in <a href="#sec-tfm-profile" class="auto internal xref">Section 5.2</a>.<a href="#section-4.5.2-4" class="pilcrow">¶</a></p>
<p id="section-4.5.2-5">Future profiles derived from the baseline PSA profile <span class="bcp14">SHALL</span> create their unique value as described in <a href="#sec-profile-uri-structure" class="auto internal xref">Section 4.5.2.1</a>.<a href="#section-4.5.2-5" class="pilcrow">¶</a></p>
<p id="section-4.5.2-6">This claim <span class="bcp14">MUST</span> be present in a PSA attestation token.<a href="#section-4.5.2-6" class="pilcrow">¶</a></p>
<p id="section-4.5.2-7">See <a href="#sec-backwards-compat" class="auto internal xref">Section 4.6</a> for considerations about backwards compatibility
with previous versions of the PSA attestation token format.<a href="#section-4.5.2-7" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-4.5.2-8">
<pre>
psa-profile-type = "tag:psacertified.org,2023:psa#tfm"

psa-profile = (
    profile-label =&gt; psa-profile-type
)</pre><a href="#section-4.5.2-8" class="pilcrow">¶</a>
</div>
<div id="sec-profile-uri-structure">
<section id="section-4.5.2.1">
            <h5 id="name-uri-structure-for-the-deriv">
<a href="#section-4.5.2.1" class="section-number selfRef">4.5.2.1. </a><a href="#name-uri-structure-for-the-deriv" class="section-name selfRef">URI Structure for the Derived Profile Identifiers</a>
            </h5>
<p id="section-4.5.2.1-1">A new profile is associated with a unique string.<a href="#section-4.5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-2">The string <span class="bcp14">MUST</span> use the URI fragment syntax defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-3.5" class="relref">Section 3.5</a> of [<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.<a href="#section-4.5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-3">The string <span class="bcp14">SHOULD</span> be short to avoid unnecessary overhead.<a href="#section-4.5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-4">To avoid collisions, profile authors <span class="bcp14">SHOULD</span> communicate their intent upfront to use a certain string that uses the inquiry form on the website <span>[<a href="#PSACertified" class="cite xref">PSACertified</a>]</span>.<a href="#section-4.5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-5">To derive the value to be used for the <code>eat_profile</code> claim, the string is added as a fragment to the <code>tag:psacertified.org,2023:psa</code> tag URI <span>[<a href="#RFC4151" class="cite xref">RFC4151</a>]</span>.<a href="#section-4.5.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.5.2.1-6">For example, a hypothetical profile using only COSE_Mac0 with the AES Message Authentication Code (AES-MAC) may decide to use the string "aes-mac".  The <code>eat_profile</code> value would then be <code>tag:psacertified.org,2023:psa#aes-mac</code>.<a href="#section-4.5.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-backwards-compat">
<section id="section-4.6">
        <h3 id="name-backwards-compatibility-con">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-backwards-compatibility-con" class="section-name selfRef">Backwards Compatibility Considerations</a>
        </h3>
<p id="section-4.6-1">An earlier draft of this document <span>[<a href="#I-D.tschofenig-rats-psa-token" class="cite xref">PSA-OLD</a>]</span> identified by the <code>PSA_IOT_PROFILE_1</code>
profile, used claim key values from the "private use range" of the CWT Claims
registry.  These claim keys have now been deprecated.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2"><a href="#tab-claim-map" class="auto internal xref">Table 2</a> provides the mappings between the deprecated and new claim
keys.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<span id="name-claim-key-mappings"></span><div id="tab-claim-map">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-claim-key-mappings" class="selfRef">Claim Key Mappings</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"> </th>
              <th class="text-left" rowspan="1" colspan="1">PSA_IOT_PROFILE_1</th>
              <th class="text-left" rowspan="1" colspan="1">tag:psacertified.org,2023:psa#tfm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Nonce</td>
              <td class="text-left" rowspan="1" colspan="1">-75008</td>
              <td class="text-left" rowspan="1" colspan="1">10 (EAT nonce)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Instance ID</td>
              <td class="text-left" rowspan="1" colspan="1">-75009</td>
              <td class="text-left" rowspan="1" colspan="1">256 (EAT euid)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Profile Definition</td>
              <td class="text-left" rowspan="1" colspan="1">-75000</td>
              <td class="text-left" rowspan="1" colspan="1">265 (EAT eat_profile)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Client ID</td>
              <td class="text-left" rowspan="1" colspan="1">-75001</td>
              <td class="text-left" rowspan="1" colspan="1">2394</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Security Lifecycle</td>
              <td class="text-left" rowspan="1" colspan="1">-75002</td>
              <td class="text-left" rowspan="1" colspan="1">2395</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Implementation ID</td>
              <td class="text-left" rowspan="1" colspan="1">-75003</td>
              <td class="text-left" rowspan="1" colspan="1">2396</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Boot Seed</td>
              <td class="text-left" rowspan="1" colspan="1">-75004</td>
              <td class="text-left" rowspan="1" colspan="1">268 (EAT bootseed)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Certification Reference</td>
              <td class="text-left" rowspan="1" colspan="1">-75005</td>
              <td class="text-left" rowspan="1" colspan="1">2398</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Software Components</td>
              <td class="text-left" rowspan="1" colspan="1">-75006</td>
              <td class="text-left" rowspan="1" colspan="1">2399</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Verification Service Indicator</td>
              <td class="text-left" rowspan="1" colspan="1">-75010</td>
              <td class="text-left" rowspan="1" colspan="1">2400</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.6-4">The new profile introduces three further changes:<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-5.1">The "bootseed" claim is now optional and of variable length
          (see <a href="#sec-boot-seed" class="auto internal xref">Section 4.3.2</a>).<a href="#section-4.6-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.6-5.2">The "No Software Measurements" claim has been retired.<a href="#section-4.6-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.6-5.3">The "Certification Reference" claim syntax changed from EAN-13
          to EAN-13+5 (see <a href="#sec-certification-reference" class="auto internal xref">Section 4.2.3</a>).<a href="#section-4.6-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.6-6">To simplify the transition to the token format described in this
document, it is <span class="bcp14">RECOMMENDED</span> that Verifiers
accept tokens encoded according to the old profile (<code>PSA_IOT_PROFILE_1</code>) as well as
to the profile defined in this document (<code>tag:psacertified.org,2023:psa#tfm</code>), at least for the time needed to
their devices to upgrade.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-profiles">
<section id="section-5">
      <h2 id="name-profiles">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-profiles" class="section-name selfRef">Profiles</a>
      </h2>
<p id="section-5-1">This document defines a baseline with common requirements that all PSA profiles must satisfy.
(Note that this does not apply to <span>[<a href="#I-D.tschofenig-rats-psa-token" class="cite xref">PSA-OLD</a>]</span>.)<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This document also defines a "TFM" profile (<a href="#sec-tfm-profile" class="auto internal xref">Section 5.2</a>) that builds on the baseline while constraining the use of COSE algorithms to improve interoperability between Attesters and Verifiers.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Baseline and TFM are what the EAT calls a "partial" and "full" profile, respectively. See <span><a href="https://rfc-editor.org/rfc/rfc9711#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9711" class="cite xref">EAT</a>]</span> for further details regarding profiles.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="baseline-profile">
<section id="section-5.1">
        <h3 id="name-baseline-profile">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-baseline-profile" class="section-name selfRef">Baseline Profile</a>
        </h3>
<div id="sec-token-encoding-and-signing">
<section id="section-5.1.1">
          <h4 id="name-token-encoding-and-signing">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-token-encoding-and-signing" class="section-name selfRef">Token Encoding and Signing</a>
          </h4>
<p id="section-5.1.1-1">The PSA attestation token is encoded in CBOR <span>[<a href="#STD94" class="cite xref">STD94</a>]</span> format.
The CBOR representation of a PSA token <span class="bcp14">MUST</span> be "valid" according to the definition in Section <a href="https://rfc-editor.org/rfc/rfc8949#section-1.2" class="relref">1.2</a> of RFC 8949 <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>.
Besides, only definite-length string, arrays, and maps are allowed.
Given that a PSA Attester is typically found in a constrained device, it <span class="bcp14">MAY</span>
NOT emit CBOR preferred serializations (Section <a href="https://rfc-editor.org/rfc/rfc8949#section-4.1" class="relref">4.1</a> of RFC 8949 <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>).
Therefore, the Verifier <span class="bcp14">MUST</span> be a variation-tolerant CBOR decoder.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">Cryptographic protection is obtained by wrapping the <code>psa-token</code> claims set in a COSE
Web Token (CWT) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.  For asymmetric key algorithms, the signature
structure <span class="bcp14">MUST</span> be a tagged (18) COSE_Sign1.  For symmetric key algorithms, the signature
structure <span class="bcp14">MUST</span> be a tagged (17) COSE_Mac0.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">Acknowledging the variety of markets, regulations, and use cases in which the
PSA attestation token can be used, the baseline profile does not impose any
strong requirement on the cryptographic algorithms that need to be supported by
Attesters and Verifiers.  The flexibility provided by the COSE format should be
sufficient to deal with the level of cryptographic agility needed to adapt to
specific use cases.  It is <span class="bcp14">RECOMMENDED</span> that commonly adopted algorithms are
used, such as those discussed in <span>[<a href="#RFC9053" class="cite xref">COSE-ALGS</a>]</span>.  It is expected that receivers
will accept a wider range of algorithms while Attesters would produce PSA tokens
using only one such algorithm.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">The CWT CBOR tag (61) is not used.  An application that needs to exchange PSA
attestation tokens can wrap the serialized COSE_Sign1 or COSE_Mac0 in the media
type defined in <a href="#sec-iana-media-types" class="auto internal xref">Section 10.2</a> or the CoAP Content-Format defined in
<a href="#sec-iana-coap-content-format" class="auto internal xref">Section 10.3</a>.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">A PSA token is always directly signed by the PSA RoT.  Therefore,
          a PSA-token claims set (<a href="#sec-psa-claims" class="auto internal xref">Section 4</a>) is never
          carried in a Detached EAT bundle (<span><a href="https://rfc-editor.org/rfc/rfc9711#section-5" class="relref">Section 5</a> of [<a href="#RFC9711" class="cite xref">EAT</a>]</span>).<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="freshness-model">
<section id="section-5.1.2">
          <h4 id="name-freshness-model">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-freshness-model" class="section-name selfRef">Freshness Model</a>
          </h4>
<p id="section-5.1.2-1">The PSA token supports the freshness models for attestation Evidence based on
nonces and epoch handles (Section <a href="https://rfc-editor.org/rfc/rfc9334#section-10.2" class="relref">10.2</a> and Section <a href="https://rfc-editor.org/rfc/rfc9334#section-10.3" class="relref">10.3</a> of <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) using
the "nonce" claim to convey the nonce or epoch handle supplied by the Verifier.
No further assumption on the specific remote attestation protocol is made.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">Note that use of epoch handles is constrained by the type restrictions imposed by the <code>eat_nonce</code> syntax.
For use in PSA tokens, it must be possible to encode the epoch handle as an opaque binary string between 8 and 64 octets.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="synopsis">
<section id="section-5.1.3">
          <h4 id="name-synopsis">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-synopsis" class="section-name selfRef">Synopsis</a>
          </h4>
<p id="section-5.1.3-1"><a href="#tbl-baseline-profile" class="auto internal xref">Table 3</a> presents a concise view of the requirements described in the preceding sections.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<span id="name-baseline-profile-2"></span><div id="tbl-baseline-profile">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-baseline-profile-2" class="selfRef">Baseline Profile</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Issue</th>
                <th class="text-left" rowspan="1" colspan="1">Profile Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR/JSON</td>
                <td class="text-left" rowspan="1" colspan="1">CBOR <span class="bcp14">MUST</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
                <td class="text-left" rowspan="1" colspan="1">Definite length maps and arrays <span class="bcp14">MUST</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
                <td class="text-left" rowspan="1" colspan="1">Definite length strings <span class="bcp14">MUST</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CBOR Serialization</td>
                <td class="text-left" rowspan="1" colspan="1">Variant serialization <span class="bcp14">MAY</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">COSE Protection</td>
                <td class="text-left" rowspan="1" colspan="1">COSE_Sign1 and/or COSE_Mac0 <span class="bcp14">MUST</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Algorithms</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC9053" class="cite xref">COSE-ALGS</a>]</span> <span class="bcp14">SHOULD</span> be used.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Detached EAT Bundle Usage</td>
                <td class="text-left" rowspan="1" colspan="1">Detached EAT bundles <span class="bcp14">MUST NOT</span> be sent.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Verification Key Identification</td>
                <td class="text-left" rowspan="1" colspan="1">Any identification method listed in <span><a href="https://rfc-editor.org/rfc/rfc9711#appendix-F.1" class="relref">Appendix F.1</a> of [<a href="#RFC9711" class="cite xref">EAT</a>]</span>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Endorsements</td>
                <td class="text-left" rowspan="1" colspan="1">See <a href="#sec-psa-endorsements" class="auto internal xref">Section 8.2</a>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Freshness</td>
                <td class="text-left" rowspan="1" colspan="1">Nonce or epoch ID-based.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Claims</td>
                <td class="text-left" rowspan="1" colspan="1">Those defined in <a href="#sec-psa-claims" class="auto internal xref">Section 4</a>. As per general EAT rules, the receiver <span class="bcp14">MUST NOT</span> error out on claims it does not understand.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-tfm-profile">
<section id="section-5.2">
        <h3 id="name-profile-tfm">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-profile-tfm" class="section-name selfRef">Profile TFM</a>
        </h3>
<p id="section-5.2-1">The TFM profile is appropriate for the code base implemented in <span>[<a href="#TF-M" class="cite xref">TF-M</a>]</span> and should apply for most derivative implementations. If an implementation changes the requirements described below, then a different profile value should be used (<a href="#sec-profile-uri-structure" class="auto internal xref">Section 4.5.2.1</a>) to ensure interoperability. This includes a restriction of the profile to a subset of the COSE Protection scheme requirements.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2"><a href="#tbl-tfm-profile" class="auto internal xref">Table 4</a> presents a concise view of the requirements.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The value of the <code>eat_profile</code> <span class="bcp14">MUST</span> be <code>tag:psacertified.org,2023:psa#tfm</code>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<span id="name-tf-m-profile"></span><div id="tbl-tfm-profile">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-tf-m-profile" class="selfRef">TF-M Profile</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Issue</th>
              <th class="text-left" rowspan="1" colspan="1">Profile Definition</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CBOR/JSON</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CBOR Encoding</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CBOR Serialization</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">COSE Protection</td>
              <td class="text-left" rowspan="1" colspan="1">COSE_Sign1 or COSE_Mac0 <span class="bcp14">MUST</span> be used.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Algorithms</td>
              <td class="text-left" rowspan="1" colspan="1">The receiver <span class="bcp14">MUST</span> accept ES256, ES384, and ES512 with COSE_Sign1 and HMAC256/256, HMAC384/384, and HMAC512/512 with COSE_Mac0; the sender <span class="bcp14">MUST</span> send one of these.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Detached EAT Bundle Usage</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Verification Key Identification</td>
              <td class="text-left" rowspan="1" colspan="1">Claim-Based Key Identification (<span><a href="https://rfc-editor.org/rfc/rfc9711#appendix-F.1.4" class="relref">Appendix F.1.4</a> of [<a href="#RFC9711" class="cite xref">EAT</a>]</span>) using Instance ID.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Endorsements</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#sec-psa-endorsements" class="auto internal xref">Section 8.2</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Freshness</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Claims</td>
              <td class="text-left" rowspan="1" colspan="1">See <a href="#baseline-profile" class="auto internal xref">Section 5.1</a>.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="collated-cddl">
<section id="section-6">
      <h2 id="name-collated-cddl">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-collated-cddl" class="section-name selfRef">Collated CDDL</a>
      </h2>
<div class="breakable lang-cddl sourcecode" id="section-6-1">
<pre>
psa-token = {
    psa-nonce
    psa-instance-id
    psa-verification-service-indicator
    psa-profile
    psa-implementation-id
    psa-client-id
    psa-lifecycle
    psa-certification-reference
    ? psa-boot-seed
    psa-software-components
}

psa-client-id-key = 2394
psa-lifecycle-key = 2395
psa-implementation-id-key = 2396
psa-certification-reference-key = 2398
psa-software-components-key = 2399
psa-verification-service-indicator-key = 2400

nonce-label = 10
ueid-label = 256
boot-seed-label = 268
profile-label = 265

psa-hash-type = bytes .size 32 / bytes .size 48 / bytes .size 64

psa-boot-seed-type = bytes .size (8..32)

psa-boot-seed = (
    boot-seed-label =&gt; psa-boot-seed-type
)

psa-client-id-nspe-type = -2147483648...0
psa-client-id-spe-type = 1..2147483647

psa-client-id-type = psa-client-id-nspe-type / psa-client-id-spe-type

psa-client-id = (
    psa-client-id-key =&gt; psa-client-id-type
)

psa-certification-reference-type = text .regexp "[0-9]{13}-[0-9]{5}"

psa-certification-reference = (
    ? psa-certification-reference-key =&gt;
        psa-certification-reference-type
)

psa-implementation-id-type = bytes .size 32

psa-implementation-id = (
    psa-implementation-id-key =&gt; psa-implementation-id-type
)

psa-instance-id-type = bytes .size 33

psa-instance-id = (
    ueid-label =&gt; psa-instance-id-type
)

psa-nonce = (
    nonce-label =&gt; psa-hash-type
)

psa-profile-type = "tag:psacertified.org,2023:psa#tfm"

psa-profile = (
    profile-label =&gt; psa-profile-type
)

psa-lifecycle-unknown-type = 0x0000..0x00ff
psa-lifecycle-assembly-and-test-type = 0x1000..0x10ff
psa-lifecycle-psa-rot-provisioning-type = 0x2000..0x20ff
psa-lifecycle-secured-type = 0x3000..0x30ff
psa-lifecycle-non-psa-rot-debug-type = 0x4000..0x40ff
psa-lifecycle-recoverable-psa-rot-debug-type = 0x5000..0x50ff
psa-lifecycle-decommissioned-type = 0x6000..0x60ff

psa-lifecycle-type =
    psa-lifecycle-unknown-type /
    psa-lifecycle-assembly-and-test-type /
    psa-lifecycle-psa-rot-provisioning-type /
    psa-lifecycle-secured-type /
    psa-lifecycle-non-psa-rot-debug-type /
    psa-lifecycle-recoverable-psa-rot-debug-type /
    psa-lifecycle-decommissioned-type

psa-lifecycle = (
    psa-lifecycle-key =&gt; psa-lifecycle-type
)

psa-software-component = {
  ? &amp;(measurement-type: 1) =&gt; text
    &amp;(measurement-value: 2) =&gt; psa-hash-type
  ? &amp;(version: 4) =&gt; text
    &amp;(signer-id: 5) =&gt; psa-hash-type
  ? &amp;(measurement-desc: 6) =&gt; text
}

psa-software-components = (
    psa-software-components-key =&gt; [ + psa-software-component ]
)

psa-verification-service-indicator-type = text

psa-verification-service-indicator = (
    ? psa-verification-service-indicator-key =&gt;
        psa-verification-service-indicator-type
)</pre><a href="#section-6-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-scalability">
<section id="section-7">
      <h2 id="name-scalability-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-scalability-considerations" class="section-name selfRef">Scalability Considerations</a>
      </h2>
<p id="section-7-1">IAKs (see <a href="#sec-psa-attester-model" class="auto internal xref">Section 3</a>) can be either raw public keys or certified public keys.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Certified public keys require the manufacturer to run the certification
authority (CA) that issues X.509 certificates for the IAKs.  (Note that operating a CA
is a complex and expensive task that may be unaffordable to certain
manufacturers.)<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Using certified public keys offers better scalability properties when compared to using raw public keys, namely:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">Storage requirements for the Verifier are minimized; the same
        manufacturer's trust anchor is used for any number of devices.<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-4.2">The provisioning model is simpler and more robust since there is no
 need to notify the Verifier about each newly manufactured device.<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-5">Furthermore, existing and well-understood revocation mechanisms can be readily used.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">The IAK's X.509 certificates can be inlined in the PSA token using the <code>x5chain</code> COSE
header parameter <span>[<a href="#RFC9360" class="cite xref">COSE-X509</a>]</span> at the cost of an increase in the PSA token
size.  <span><a href="https://rfc-editor.org/rfc/rfc7925#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC7925" class="cite xref">TLS12-IoT</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-14#section-15" class="relref">Section 15</a> of [<a href="#I-D.ietf-uta-tls13-iot-profile" class="cite xref">TLS13-IoT</a>]</span> provide
guidance for profiling X.509 certificates used in IoT deployments.
Note that the exact split between pre-provisioned and inlined certificates may vary
depending on the specific deployment.  In that respect, <code>x5chain</code> is quite
flexible. It can contain the end entity (EE) certification only, the EE and a partial
chain, or the EE and the full chain up to the trust anchor (see <span><a href="https://rfc-editor.org/rfc/rfc9360#section-2" class="relref">Section 2</a> of [<a href="#RFC9360" class="cite xref">COSE-X509</a>]</span> for the details).
Constraints around network bandwidth and computing resources available to endpoints, such as network buffers, may dictate a reasonable split point.<a href="#section-7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="psa-token-verification">
<section id="section-8">
      <h2 id="name-psa-token-verification">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-psa-token-verification" class="section-name selfRef">PSA Token Verification</a>
      </h2>
<p id="section-8-1">To verify the token, the primary need is to check correct encoding and signing
as detailed in <a href="#sec-token-encoding-and-signing" class="auto internal xref">Section 5.1.1</a>.
The key used for verification is either supplied to the Verifier by an
authorized Endorser along with the corresponding Attester's Instance ID or
inlined in the token using the <code>x5chain</code> header parameter as described in
<a href="#sec-scalability" class="auto internal xref">Section 7</a>.
If the IAK is a raw public key and the Instance ID claim is
used to assist in
locating the key used to verify the signature covering the CWT token.
If the IAK is a certified public key, X.509 path construction and validation
(<span><a href="https://rfc-editor.org/rfc/rfc5280#section-6" class="relref">Section 6</a> of [<a href="#RFC5280" class="cite xref">X509</a>]</span>) up to a trusted CA <span class="bcp14">MUST</span> be successful before the key is
used to verify the token signature.  This also includes revocation checking.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The Verifier typically has a policy where it compares some claims in
  this profile to reference values registered with it for a given
  deployment.  This verification process serves to confirm that the
  device is endorsed by the manufacturer supply chain. The policy may require that the
relevant claims must have a match to a registered reference value.  All claims
may be worthy of additional appraisal.  It is likely that most deployments
would include a policy with appraisal for the following claims:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">Implementation ID: The value of the Implementation ID can be used
        to identify the verification requirements of the deployment.<a href="#section-8-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-3.2">Software Component, Measurement Value: This value can uniquely
        identify a firmware release from the supply chain. In some cases, a
        Verifier may maintain a record for a series of firmware releases
        being patches to an original baseline release. A verification policy
        may then allow this value to match any point on that release sequence
        or expect some minimum level of maturity related to the sequence.<a href="#section-8-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-3.3">Software Component, Signer ID: Where present in a deployment, this
        could allow a Verifier to operate a more general policy than that for
        Measurement Value as above by allowing a token to contain any
        firmware entries signed by a known Signer ID without checking for a
        uniquely registered version.<a href="#section-8-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-3.4">Certification Reference: If present, this value could be used as a
        hint to locate security certification information associated with the
        attesting device. An example could be a reference to a <span>[<a href="#PSACertified" class="cite xref">PSACertified</a>]</span> certificate.<a href="#section-8-3.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="ar4si-trustworthiness-claims-mappings">
<section id="section-8.1">
        <h3 id="name-ar4si-trustworthiness-claim">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-ar4si-trustworthiness-claim" class="section-name selfRef">AR4SI Trustworthiness Claims Mappings</a>
        </h3>
<p id="section-8.1-1"><span>[<a href="#I-D.ietf-rats-ar4si" class="cite xref">RATS-AR4SI</a>]</span> defines an information model that Verifiers can employ to
produce Attestation Results.
AR4SI provides a set of standardized appraisal categories and tiers that
greatly simplifies the task of writing Relying Party policies in Multi-Attester
environments.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The contents of <a href="#tab-ar4si-map" class="auto internal xref">Table 5</a> are intended as guidance for implementing a
PSA Verifier that computes its results using AR4SI.
The table describes which PSA Evidence claims (if any) are related to which
AR4SI trustworthiness claim, and therefore what the Verifier must consider when
deciding if and how to appraise a certain feature associated with the PSA
Attester.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<span id="name-ar4si-claims-mappings"></span><div id="tab-ar4si-map">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-ar4si-claims-mappings" class="selfRef">AR4SI Claims mappings</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Trustworthiness Vector claims</th>
              <th class="text-left" rowspan="1" colspan="1">Related PSA claims</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "configuration"</td>
              <td class="text-left" rowspan="1" colspan="1">Software Components (<a href="#sec-sw-components" class="auto internal xref">Section 4.4.1</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "executables"</td>
              <td class="text-left" rowspan="1" colspan="1">ditto</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "file-system"</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "hardware"</td>
              <td class="text-left" rowspan="1" colspan="1">Implementation ID (<a href="#sec-implementation-id" class="auto internal xref">Section 4.2.2</a>)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "instance-identity"</td>
              <td class="text-left" rowspan="1" colspan="1">Instance ID (<a href="#sec-instance-id-claim" class="auto internal xref">Section 4.2.1</a>).  The Security Lifecycle (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.3.1</a>) can also impact the derived identity.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "runtime-opaque"</td>
              <td class="text-left" rowspan="1" colspan="1">Indirectly derived from "executables", "hardware", and "instance-identity".  The Security Lifecycle (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.3.1</a>) can also be relevant, e.g., any debug state will expose otherwise protected memory.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "sourced-data"</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                "storage-opaque"</td>
              <td class="text-left" rowspan="1" colspan="1">Indirectly derived from "executables", "hardware", and "instance-identity".</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.1-4">This document does not prescribe what value must be chosen based on each
possible situation. When assigning specific Trustworthiness Claim values, an
implementation is expected to follow the algorithm described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-08#section-2.3.3" class="relref">Section 2.3.3</a> of [<a href="#I-D.ietf-rats-ar4si" class="cite xref">RATS-AR4SI</a>]</span>.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-psa-endorsements">
<section id="section-8.2">
        <h3 id="name-endorsements-reference-valu">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-endorsements-reference-valu" class="section-name selfRef">Endorsements, Reference Values, and Verification Key Material</a>
        </h3>
<p id="section-8.2-1"><span>[<a href="#I-D.fdb-rats-psa-endorsements" class="cite xref">PSA-Endorsements</a>]</span> defines a protocol based on the <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">RATS-CoRIM</a>]</span> data model
that can be used to convey PSA Endorsements, Reference Values, and verification
key material to the Verifier.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-and-privacy-considerations">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-9-1">This specification reuses the EAT specification and therefore the CWT specification.
Hence, the security and privacy considerations of those specifications apply here as well.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Since CWTs offer different ways to protect the token, this specification
profiles those options and allows signatures using public key cryptography as
well as message authentication codes (MACs). COSE_Sign1 is used for digital
signatures and COSE_Mac0 for MACs as defined in the COSE specification <span>[<a href="#STD96" class="cite xref">STD96</a>]</span>.
Note, however, that the use of MAC authentication is <span class="bcp14">NOT RECOMMENDED</span> due to the associated
infrastructure costs for key management and protocol complexities.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">A PSA Attester <span class="bcp14">MUST NOT</span> provide Evidence to an untrusted
challenger, as it may allow attackers to interpose and trick the Verifier into
believing the attacker is a legitimate Attester.
This is especially relevant to protocols that use PSA attestation tokens to authenticate the attester to a Relying Party.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Attestation tokens contain information that may be unique to a device. Therefore, they may allow to single out an individual device for tracking
purposes.  Deployments that have privacy requirements must take appropriate
measures to ensure that the token is only used to provision anonymous/pseudonym
keys.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cbor-web-token-claims-registration">
<section id="section-10.1">
        <h3 id="name-cbor-web-token-claims-regis">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-cbor-web-token-claims-regis" class="section-name selfRef">CBOR Web Token Claims Registration</a>
        </h3>
<p id="section-10.1-1">IANA has registered the following claims 
in the "CBOR Web Token (CWT) Claims" registry
<span>[<a href="#CWT" class="cite xref">CWT</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<div id="client-id-claim">
<section id="section-10.1.1">
          <h4 id="name-client-id-claim">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-client-id-claim" class="section-name selfRef">Client ID Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.1-1">
            <dt id="section-10.1.1-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.2">psa-client-id<a href="#section-10.1.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.4">PSA Client ID<a href="#section-10.1.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.6">N/A<a href="#section-10.1.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.8">2394<a href="#section-10.1.1-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.10">signed integer<a href="#section-10.1.1-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.12">Hannes Tschofenig<a href="#section-10.1.1-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.1-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.1-1.14">
              <a href="#sec-client-id" class="auto internal xref">Section 4.1.2</a> of RFC 9783<a href="#section-10.1.1-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="security-lifecycle-claim">
<section id="section-10.1.2">
          <h4 id="name-security-lifecycle-claim">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-security-lifecycle-claim" class="section-name selfRef">Security Lifecycle Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.2-1">
            <dt id="section-10.1.2-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.2">psa-security-lifecycle<a href="#section-10.1.2-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.4">PSA Security Lifecycle<a href="#section-10.1.2-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.6">N/A<a href="#section-10.1.2-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.8">2395<a href="#section-10.1.2-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.10">unsigned integer<a href="#section-10.1.2-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.12">Hannes Tschofenig<a href="#section-10.1.2-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.2-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.2-1.14">
              <a href="#sec-security-lifecycle" class="auto internal xref">Section 4.3.1</a> of RFC 9783<a href="#section-10.1.2-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="implementation-id-claim">
<section id="section-10.1.3">
          <h4 id="name-implementation-id-claim">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-implementation-id-claim" class="section-name selfRef">Implementation ID Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.3-1">
            <dt id="section-10.1.3-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.2">psa-implementation-id<a href="#section-10.1.3-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.4">PSA Implementation ID<a href="#section-10.1.3-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.6">N/A<a href="#section-10.1.3-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.8">2396<a href="#section-10.1.3-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.10">byte string<a href="#section-10.1.3-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.12">Hannes Tschofenig<a href="#section-10.1.3-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.3-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.3-1.14">
              <a href="#sec-implementation-id" class="auto internal xref">Section 4.2.2</a> of RFC 9783<a href="#section-10.1.3-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="certification-reference-claim">
<section id="section-10.1.4">
          <h4 id="name-certification-reference-cla">
<a href="#section-10.1.4" class="section-number selfRef">10.1.4. </a><a href="#name-certification-reference-cla" class="section-name selfRef">Certification Reference Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.4-1">
            <dt id="section-10.1.4-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.2">psa-certification-reference<a href="#section-10.1.4-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.4">PSA Certification Reference<a href="#section-10.1.4-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.6">N/A<a href="#section-10.1.4-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.8">2398<a href="#section-10.1.4-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.10">text string<a href="#section-10.1.4-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.12">Hannes Tschofenig<a href="#section-10.1.4-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.4-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.4-1.14">
              <a href="#sec-certification-reference" class="auto internal xref">Section 4.2.3</a> of RFC 9783<a href="#section-10.1.4-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="software-components-claim">
<section id="section-10.1.5">
          <h4 id="name-software-components-claim">
<a href="#section-10.1.5" class="section-number selfRef">10.1.5. </a><a href="#name-software-components-claim" class="section-name selfRef">Software Components Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.5-1">
            <dt id="section-10.1.5-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.2">psa-software-components<a href="#section-10.1.5-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.4">PSA Software Components<a href="#section-10.1.5-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.6">N/A<a href="#section-10.1.5-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.8">2399<a href="#section-10.1.5-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.10">array<a href="#section-10.1.5-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.12">Hannes Tschofenig<a href="#section-10.1.5-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.5-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.5-1.14">
              <a href="#sec-sw-components" class="auto internal xref">Section 4.4.1</a> of RFC 9783<a href="#section-10.1.5-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="verification-service-indicator-claim">
<section id="section-10.1.6">
          <h4 id="name-verification-service-indicat">
<a href="#section-10.1.6" class="section-number selfRef">10.1.6. </a><a href="#name-verification-service-indicat" class="section-name selfRef">Verification Service Indicator Claim</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.1.6-1">
            <dt id="section-10.1.6-1.1">Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.2">psa-verification-service-indicator<a href="#section-10.1.6-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.3">Claim Description:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.4">PSA Verification Service Indicator<a href="#section-10.1.6-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.5">JWT Claim Name:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.6">N/A<a href="#section-10.1.6-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.7">Claim Key:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.8">2400<a href="#section-10.1.6-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.9">Claim Value Type(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.10">text string<a href="#section-10.1.6-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.11">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.12">Hannes Tschofenig<a href="#section-10.1.6-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.1.6-1.13">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-10.1.6-1.14">
              <a href="#sec-verification-service-indicator" class="auto internal xref">Section 4.5.1</a> of RFC 9783<a href="#section-10.1.6-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-iana-media-types">
<section id="section-10.2">
        <h3 id="name-media-types">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-media-types" class="section-name selfRef">Media Types</a>
        </h3>
<p id="section-10.2-1">This document does not register any new media types. 
To indicate that the transmitted content is a PSA attestation token,
applications can use the <code>application/eat+cwt</code> media type defined in
<span>[<a href="#RFC9782" class="cite xref">EAT-MEDIATYPES</a>]</span> with the <code>eat_profile</code> parameter set to
<code>tag:psacertified.org,2023:psa#tfm</code> (or <code>tag:psacertified.org,2019:psa#legacy</code> if the token is encoded
according to the old profile; see <a href="#sec-backwards-compat" class="auto internal xref">Section 4.6</a>).<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-iana-coap-content-format">
<section id="section-10.3">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registration</a>
        </h3>
<p id="section-10.3-1">IANA has registered two CoAP Content-Format IDs in the First Come First Served range of the "CoAP
Content-Formats" registry <span>[<a href="#Content-Formats" class="cite xref">Content-Formats</a>]</span>:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">One for the <code>application/eat+cwt</code> media type with the <code>eat_profile</code> parameter 
   equal to <code>tag:psacertified.org,2023:psa#tfm</code>.<a href="#section-10.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.2">Another for the <code>application/eat+cwt</code> media type with the <code>eat_profile</code>
   parameter equal to <code>tag:psacertified.org,2019:psa#legacy</code>.<a href="#section-10.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="registry-contents">
<section id="section-10.3.1">
          <h4 id="name-registry-contents">
<a href="#section-10.3.1" class="section-number selfRef">10.3.1. </a><a href="#name-registry-contents" class="section-name selfRef">Registry Contents</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.3.1-1">
            <dt id="section-10.3.1-1.1">Media Type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-1.2">
              <code>application/eat+cwt; eat_profile="tag:psacertified.org,2023:psa#tfm"</code><a href="#section-10.3.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-1.3">Encoding:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-1.4">-<a href="#section-10.3.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-1.5">ID:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-1.6">10003<a href="#section-10.3.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-1.7">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-1.8">RFC 9783<a href="#section-10.3.1-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-10.3.1-2">
            <dt id="section-10.3.1-2.1">Media Type:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-2.2">
              <code>application/eat+cwt; eat_profile="tag:psacertified.org,2019:psa#legacy"</code><a href="#section-10.3.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-2.3">Encoding:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-2.4">-<a href="#section-10.3.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-2.5">ID:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-2.6">10004<a href="#section-10.3.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.3.1-2.7">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-10.3.1-2.8">RFC 9783<a href="#section-10.3.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9053">[COSE-ALGS]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CWT">[CWT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cwt">https://www.iana.org/assignments/cwt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAN-13">[EAN-13]</dt>
        <dd>
<span class="refAuthor">GS1</span>, <span class="refTitle">"EAN/UPC barcodes"</span>, <span>&lt;<a href="https://www.gs1.org/standards/barcodes/ean-upc">https://www.gs1.org/standards/barcodes/ean-upc</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[EAT]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9711">https://www.rfc-editor.org/info/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9782">[EAT-MEDIATYPES]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Entity Attestation Token (EAT) Media Types"</span>, <span class="seriesInfo">RFC 9782</span>, <span class="seriesInfo">DOI 10.17487/RFC9782</span>, <time datetime="2025-05" class="refDate">May 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9782">https://www.rfc-editor.org/info/rfc9782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NAMED-INFO">[NAMED-INFO]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Named Information Hash Algorithm Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/named-information">https://www.iana.org/assignments/named-information</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSA-Cert-Guide">[PSA-Cert-Guide]</dt>
        <dd>
<span class="refAuthor">PSA Certified</span>, <span class="refTitle">"PSA Certified Level 2 Step by Step Guide Version 1.1"</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://www.psacertified.org/app/uploads/2020/07/JSADEN011-PSA_Certified_Level_2_Step-by-Step-1.1-20200403.pdf">https://www.psacertified.org/app/uploads/2020/07/JSADEN011-PSA_Certified_Level_2_Step-by-Step-1.1-20200403.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSA-FF">[PSA-FF]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Arm PSA Firmware Framework 1.0"</span>, <span>&lt;<a href="https://developer.arm.com/documentation/den0063/a">https://developer.arm.com/documentation/den0063/a</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSA-SM">[PSA-SM]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Platform Security Model 1.1"</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.psacertified.org/app/uploads/2021/12/JSADEN014_PSA_Certified_SM_V1.1_BET0.pdf">https://www.psacertified.org/app/uploads/2021/12/JSADEN014_PSA_Certified_SM_V1.1_BET0.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4151">[RFC4151]</dt>
        <dd>
<span class="refAuthor">Kindberg, T.</span> and <span class="refAuthor">S. Hawke</span>, <span class="refTitle">"The 'tag' URI Scheme"</span>, <span class="seriesInfo">RFC 4151</span>, <span class="seriesInfo">DOI 10.17487/RFC4151</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4151">https://www.rfc-editor.org/info/rfc4151</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
        <dd>
<div class="refInstance">Internet Standard 94, <span>&lt;<a href="https://www.rfc-editor.org/info/std94">https://www.rfc-editor.org/info/std94</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC8949">
            <span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="STD96">[STD96]</dt>
        <dd>
<div class="refInstance">Internet Standard 96, <span>&lt;<a href="https://www.rfc-editor.org/info/std96">https://www.rfc-editor.org/info/std96</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC9052">
            <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9052">https://www.rfc-editor.org/info/rfc9052</a>&gt;</span>. </div>
<div class="refInstance" id="RFC9338">
            <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Countersignatures"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9338</span>, <span class="seriesInfo">DOI 10.17487/RFC9338</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9338">https://www.rfc-editor.org/info/rfc9338</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="RFC5280">[X509]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Content-Formats">[Content-Formats]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"CoAP Content-Formats"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[COSE-X509]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9360">https://www.rfc-editor.org/info/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IAT-VERIFIER">[IAT-VERIFIER]</dt>
        <dd>
<span class="refAuthor">Trusted Firmware</span>, <span class="refTitle">"iat-verifier"</span>, <span class="refContent">commit: 0b49b00195b7733d6fe74e8f42ed4d7b81242801</span>, <time datetime="2023-08-18" class="refDate">18 August 2023</time>, <span>&lt;<a href="https://git.trustedfirmware.org/plugins/gitiles/TF-M/tf-m-tools/+/refs/heads/main/iat-verifier/">https://git.trustedfirmware.org/plugins/gitiles/TF-M/tf-m-tools/+/refs/heads/main/iat-verifier/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSA">[PSA]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Security - Platform Security Architecture"</span>, <span>&lt;<a href="https://developer.arm.com/documentation/101892/0100/Security---Platform-Security-Architecture?lang=en">https://developer.arm.com/documentation/101892/0100/Security---Platform-Security-Architecture?lang=en</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSA-API">[PSA-API]</dt>
        <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"PSA Certified Attestation API 1.0"</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://arm-software.github.io/psa-api/attestation/1.0/IHI0085-PSA_Certified_Attestation_API-1.0.3.pdf">https://arm-software.github.io/psa-api/attestation/1.0/IHI0085-PSA_Certified_Attestation_API-1.0.3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fdb-rats-psa-endorsements">[PSA-Endorsements]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"A CoRIM Profile for Arm's Platform Security Architecture (PSA)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fdb-rats-psa-endorsements-06</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fdb-rats-psa-endorsements-06">https://datatracker.ietf.org/doc/html/draft-fdb-rats-psa-endorsements-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tschofenig-rats-psa-token">[PSA-OLD]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Frost, S.</span>, <span class="refAuthor">Brossard, M.</span>, <span class="refAuthor">Shaw, A. L.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Arm's Platform Security Architecture (PSA) Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tschofenig-rats-psa-token-07</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-07">https://datatracker.ietf.org/doc/html/draft-tschofenig-rats-psa-token-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSACertified">[PSACertified]</dt>
        <dd>
<span class="refAuthor">PSA Certified</span>, <span class="refTitle">"PSA Certified: IoT Security Framework and Certification"</span>, <span>&lt;<a href="https://psacertified.org">https://psacertified.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-ar4si">[RATS-AR4SI]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Hardjono, T.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">V. Scarlata</span>, <span class="refTitle">"Attestation Results for Secure Interactions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-ar4si-08</span>, <time datetime="2025-02-06" class="refDate">6 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-08">https://datatracker.ietf.org/doc/html/draft-ietf-rats-ar4si-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-corim">[RATS-CoRIM]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Concise Reference Integrity Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-corim-07</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-07">https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mandyam-rats-qwestoken">[RATS-QWESTOKEN]</dt>
        <dd>
<span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">Sekhar, V.</span>, and <span class="refAuthor">S. Mohammed</span>, <span class="refTitle">"The Qualcomm Wireless Edge Services (QWES) Attestation Token"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mandyam-rats-qwestoken-00</span>, <time datetime="2019-11-01" class="refDate">1 November 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mandyam-rats-qwestoken-00">https://datatracker.ietf.org/doc/html/draft-mandyam-rats-qwestoken-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.kdyxy-rats-tdx-eat-profile">[RATS-TDX]</dt>
        <dd>
<span class="refAuthor">Kostal, G.</span>, <span class="refAuthor">Dittakavi, S.</span>, <span class="refAuthor">Yeluri, R.</span>, <span class="refAuthor">Xia, H.</span>, and <span class="refAuthor">J. Yu</span>, <span class="refTitle">"EAT profile for Intel(r) Trust Domain Extensions (TDX) attestation result"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kdyxy-rats-tdx-eat-profile-02</span>, <time datetime="2024-12-13" class="refDate">13 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kdyxy-rats-tdx-eat-profile-02">https://datatracker.ietf.org/doc/html/draft-kdyxy-rats-tdx-eat-profile-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TF-M">[TF-M]</dt>
        <dd>
<span class="refAuthor">Trusted Firmware</span>, <span class="refTitle">"Trusted Firmware-M"</span>, <span>&lt;<a href="https://www.trustedfirmware.org/projects/tf-m/">https://www.trustedfirmware.org/projects/tf-m/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[TLS12-IoT]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-uta-tls13-iot-profile">[TLS13-IoT]</dt>
      <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"TLS/DTLS 1.3 Profiles for the Internet of Things"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-tls13-iot-profile-14</span>, <time datetime="2025-05-05" class="refDate">5 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-14">https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">The following examples show PSA attestation tokens for a hypothetical system
comprising a single measured software component.
The attesting device is in a lifecycle state (<a href="#sec-security-lifecycle" class="auto internal xref">Section 4.3.1</a>) of
SECURED.  The attestation has been requested from a client residing in the
SPE.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The example in <a href="#ex-sign1" class="auto internal xref">Appendix A.1</a> illustrates the case where the IAK is an asymmetric key.  A COSE Sign1 envelope is used to wrap the PSA-token claims set.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3"><a href="#ex-mac0" class="auto internal xref">Appendix A.2</a> illustrates the case where the IAK is a symmetric key and a COSE Mac0 envelope is used instead.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">The claims sets are identical, except for the Instance ID which is synthesized from the key material.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">The examples have been created using the <code>iat-verifier</code> tool <span>[<a href="#IAT-VERIFIER" class="cite xref">IAT-VERIFIER</a>]</span>.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<div id="ex-sign1">
<section id="appendix-A.1">
        <h3 id="name-cose-sign1-token">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-cose-sign1-token" class="section-name selfRef">COSE Sign1 Token</a>
        </h3>
<div class="sourcecode" id="appendix-A.1-1">
<pre>
{
  / ueid /                     256: h'01020202020202020202020202
0202020202020202020202020202020202020202',
  / psa-implementation-id /   2396: h'00000000000000000000000000
00000000000000000000000000000000000000',
  / eat_nonce /                 10: h'01010101010101010101010101
01010101010101010101010101010101010101',
  / psa-client-id /           2394: 2147483647,
  / psa-security-lifecycle /  2395: 12288,
  / eat_profile /           265: "tag:psacertified.org,2023:psa#tfm",
  / bootseed /                 268: h'0000000000000000',
  / psa-software-components / 2399: [
    {
      / signer ID /         5: h'0404040404040404040404040404040
404040404040404040404040404040404',
      / measurement value / 2: h'0303030303030303030303030303030
303030303030303030303030303030303',
      / measurement type /  1: "PRoT"
    }
  ]
}</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-2">The JWK representation of the IAK used for creating the COSE Sign1 signature
over the PSA token is:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.1-3">
<pre>
{
  "kty": "EC",
  "crv": "P-256",
  "alg": "ES256",
  "x": "Tl4iCZ47zrRbRG0TVf0dw7VFlHtv18HInYhnmMNybo8",
  "y": "gNcLhAslaqw0pi7eEEM2TwRAlfADR0uR4Bggkq-xPy4",
  "d": "Q__-y5X4CFp8QOHT6nkL7063jN131YUDpkwWAPkbM-c"
}</pre><a href="#appendix-A.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-4">The resulting COSE object is:<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.1-5">
<pre>
18([
  h'A10126',
  {},
  h'A81901005821010202020202020202020202020202020202020202020202
02020202020202020219095C5820000000000000000000000000000000000000
00000000000000000000000000000A5820010101010101010101010101010101
010101010101010101010101010101010119095A1A7FFFFFFF19095B19300019
010978217461673A7073616365727469666965642E6F72672C323032333A7073
612374666D19010C48000000000000000019095F81A305582004040404040404
0404040404040404040404040404040404040404040404040402582003030303
0303030303030303030303030303030303030303030303030303030301645052
6F54',
  h'786E937A4C42667AF3847399319CA95C7E7DBABDC9B50FDB8DE3F6BFF4AB
82FF80C42140E2A488000219E3E10663193DA69C75F52B798EA10B2F7041A90E
8E5A'
])</pre><a href="#appendix-A.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-6">which has the following base16 encoding:<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.1-7">
<pre>
d28443a10126a0590100a819010058210102020202020202020202020202
0202020202020202020202020202020202020219095c5820000000000000
00000000000000000000000000000000000000000000000000000a582001
010101010101010101010101010101010101010101010101010101010101
0119095a1a7fffffff19095b19300019010978217461673a707361636572
7469666965642e6f72672c323032333a7073612374666d19010c48000000
000000000019095f81a30558200404040404040404040404040404040404
040404040404040404040404040404025820030303030303030303030303
0303030303030303030303030303030303030303016450526f545840786e
937a4c42667af3847399319ca95c7e7dbabdc9b50fdb8de3f6bff4ab82ff
80c42140e2a488000219e3e10663193da69c75f52b798ea10b2f7041a90e
8e5a</pre><a href="#appendix-A.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ex-mac0">
<section id="appendix-A.2">
        <h3 id="name-cose-mac0-token">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-cose-mac0-token" class="section-name selfRef">COSE Mac0 Token</a>
        </h3>
<div class="sourcecode" id="appendix-A.2-1">
<pre>
{
  / ueid /                     256: h'01C557BD4FADC83F756FCA2CD5
EA2DCC8B82159BB4E7453D6A744D4EECD6D0AC60',
  / psa-implementation-id /   2396: h'00000000000000000000000000
00000000000000000000000000000000000000',
  / eat_nonce /                 10: h'01010101010101010101010101
01010101010101010101010101010101010101',
  / psa-client-id /           2394: 2147483647,
  / psa-security-lifecycle /  2395: 12288,
  / eat_profile /           265: "tag:psacertified.org,2023:psa#tfm",
  / psa-boot-seed /            268: h'0000000000000000',
  / psa-software-components / 2399: [
    {
      / signer ID /         5: h'0404040404040404040404040404040
404040404040404040404040404040404',
      / measurement value / 2: h'0303030303030303030303030303030
303030303030303030303030303030303',
      / measurement type /  1: "PRoT"
    }
  ]
}</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-2">The JWK representation of the IAK used for creating the COSE Mac0 signature
over the PSA token is:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.2-3">
<pre>
========== NOTE: '\\' line wrapping per RFC 8792 ==========

{
  "kty": "oct",
  "alg": "HS256",
  "k": "3gOLNKyhJXaMXjNXq40Gs2e5qw1-i-Ek7cpH_gM6W7epPTB_8imqNv8k\
       \bBKVlk-s9xq3qm7E_WECt7OYMlWtkg"
}</pre><a href="#appendix-A.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-4">The resulting COSE object is:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.2-5">
<pre>
17([
  h'A10105',
  {},
  h'A8190100582101C557BD4FADC83F756FCA2CD5EA2DCC8B82159BB4E7453D
6A744D4EECD6D0AC6019095C5820000000000000000000000000000000000000
00000000000000000000000000000A5820010101010101010101010101010101
010101010101010101010101010101010119095A1A7FFFFFFF19095B19300019
010978217461673A7073616365727469666965642E6F72672C323032333A7073
612374666D19010C48000000000000000019095F81A305582004040404040404
0404040404040404040404040404040404040404040404040402582003030303
0303030303030303030303030303030303030303030303030303030301645052
6F54',
  h'CF88D330E7A5366A95CF744A4DBF0D50304D405EDD8B2530E243EDDBD317
7820'
])</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-6">which has the following base16 encoding:<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<div class="sourcecode" id="appendix-A.2-7">
<pre>
d18443a10105a0590100a8190100582101c557bd4fadc83f756fca2cd5ea
2dcc8b82159bb4e7453d6a744d4eecd6d0ac6019095c5820000000000000
00000000000000000000000000000000000000000000000000000a582001
010101010101010101010101010101010101010101010101010101010101
0119095a1a7fffffff19095b19300019010978217461673a707361636572
7469666965642e6f72672c323032333a7073612374666d19010c48000000
000000000019095f81a30558200404040404040404040404040404040404
040404040404040404040404040404025820030303030303030303030303
0303030303030303030303030303030303030303016450526f545820cf88
d330e7a5366a95cf744a4dbf0d50304d405edd8b2530e243eddbd3177820</pre><a href="#appendix-A.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">Thank you <span class="contact-name">Carsten Bormann</span> for help with the
      CDDL.  Thanks to <span class="contact-name">Nicholas Wood</span>, <span class="contact-name">Eliot Lear</span>, <span class="contact-name">Yaron Sheffer</span>, <span class="contact-name">Kathleen Moriarty</span>, and <span class="contact-name">Ned Smith</span> for
      ideas, comments, and suggestions.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Laurence Lundblade</span></div>
<div dir="auto" class="left"><span class="org">Security Theory LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lgl@securitytheory.com" class="email">lgl@securitytheory.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tamas Ban</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Tamas.Ban@arm.com" class="email">Tamas.Ban@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sergei Trofimov</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Sergei.Trofimov@arm.com" class="email">Sergei.Trofimov@arm.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Simon Frost</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Simon.Frost@arm.com" class="email">Simon.Frost@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mathias Brossard</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Mathias.Brossard@arm.com" class="email">Mathias.Brossard@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adrian Shaw</span></div>
<div dir="auto" class="left"><span class="org">HP Labs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adrianlshaw@acm.org" class="email">adrianlshaw@acm.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
