<!DOCTYPE html>
<html lang="en" class="BCP RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9726: Operational Considerations for Use of DNS in Internet of Things (IoT) Devices</title>
<meta content="Michael Richardson" name="author">
<meta content="Wei Pan" name="author">
<meta content="
       This document details considerations about how Internet of Things
      (IoT) devices use IP addresses and DNS names.  These concerns become
      acute as network operators begin deploying Manufacturer Usage
      Descriptions (MUD), as specified in RFC 8520, to control device access. 
       Also, this document makes recommendations on when and how to use DNS
      names in MUD files. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="DNS" name="keyword">
<meta content="MUD" name="keyword">
<meta content="round-robin" name="keyword">
<meta content="tailored response" name="keyword">
<meta content="DNSSEC" name="keyword">
<meta content="IoT security" name="keyword">
<meta content="Device Identity" name="keyword">
<meta content="9726" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 64.1
-->
<link href="rfc9726.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-opsawg-mud-iot-dns-considerations-19" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9726" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9726</td>
<td class="center">DNS in IoT Devices</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Richardson &amp; Pan</td>
<td class="center">Best Current Practice</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9726" class="eref">9726</a></dd>
<dt class="label-bcp">BCP:</dt>
<dd class="bcp">241</dd>
<dt class="label-category">Category:</dt>
<dd class="category">Best Current Practice</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03" class="published">March 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
<div class="author">
      <div class="author-name">W. Pan</div>
<div class="org">Huawei Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9726</h1>
<h1 id="title">Operational Considerations for Use of DNS in Internet of Things (IoT) Devices</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document details considerations about how Internet of Things
      (IoT) devices use IP addresses and DNS names.  These concerns become
      acute as network operators begin deploying Manufacturer Usage
      Descriptions (MUD), as specified in RFC 8520, to control device access.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Also, this document makes recommendations on when and how to use DNS
      names in MUD files.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This memo documents an Internet Best Current Practice.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further information
            on BCPs is available in Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9726">https://www.rfc-editor.org/info/rfc9726</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-a-model-for-mud-controller-" class="internal xref">A Model for MUD Controller Mapping of DNS Names to Addresses</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-non-deterministic-mappings" class="internal xref">Non-Deterministic Mappings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-dns-and-ip-anti-patterns-fo" class="internal xref">DNS and IP Anti-Patterns for IoT Device Manufacturers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-use-of-ip-address-literals" class="internal xref">Use of IP Address Literals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-use-of-non-deterministic-dn" class="internal xref">Use of Non-Deterministic DNS Names in Protocols</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-use-of-a-too-generic-dns-na" class="internal xref">Use of a Too Generic DNS Name</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dns-privacy-and-outsourcing" class="internal xref">DNS Privacy and Outsourcing versus MUD Controllers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-recommendations-to-iot-devi" class="internal xref">Recommendations to IoT Device Manufacturers on MUD and DNS Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-consistently-use-dns" class="internal xref">Consistently Use DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-use-primary-dns-names-contr" class="internal xref">Use Primary DNS Names Controlled by the Manufacturer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-use-a-content-distribution-" class="internal xref">Use a Content Distribution Network with Stable DNS Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-do-not-use-tailored-respons" class="internal xref">Do Not Use Tailored Responses to Answer DNS Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-prefer-dns-servers-learned-" class="internal xref">Prefer DNS Servers Learned from DHCP/Router Advertisements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-interactions-with-mdns-and-" class="internal xref">Interactions with mDNS and DNS-SD</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-a-failing-strategy-anti-pat" class="internal xref">A Failing Strategy: Anti-Patterns</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-too-slow" class="internal xref">Too Slow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-reveals-patterns-of-usage" class="internal xref">Reveals Patterns of Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-mappings-are-often-incomple" class="internal xref">Mappings Are Often Incomplete</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-forward-dns-names-can-have-" class="internal xref">Forward DNS Names Can Have Wildcards</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span> provides a standardized way to describe how
      a device with a specific purpose makes use of Internet resources.  Access
      Control Lists (ACLs) can be defined in a Manufacturer Usage Description
      (MUD) file <span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span> that permits a
      device to access Internet resources by their DNS names or IP
      addresses.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The use of a DNS name rather than an IP address in an ACL has many
      advantages: Not only does the layer of indirection permit the mapping of
      a name to IP addresses to be changed over time, but it also generalizes
      automatically to IPv4 and IPv6 addresses as well as permits a
      variety of load-balancing strategies, including multi-CDN deployments
      wherein load-balancing can account for geography and load.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">However, the use of DNS names has implications on how ACLs are
      executed at the MUD policy enforcement point (typically, a firewall).
      Concretely, the firewall has access only to the Layer 3 headers of the
      packet.  This includes the source and destination IP addresses and, if not
      encrypted by IPsec, the destination UDP or TCP port number present in
      the transport header.  The DNS name is not present!<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">So, in order to implement these name-based ACLs, there must be a
      mapping between the names in the ACLs and IP addresses.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">In order for manufacturers to understand how to configure DNS
      associated with name-based ACLs, a model of how the DNS resolution will
      be done by MUD controllers is necessary.  <a href="#mapping" class="auto internal xref">Section 3</a>
      models some good strategies that could be used.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This model is non-normative but is included so that IoT device
      manufacturers can understand how the DNS will be used to resolve the
      names they use.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">There are some ways of using DNS that will present problems for MUD
      controllers, which <a href="#dns-anti-p" class="auto internal xref">Section 4</a> explains.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><a href="#sec-priv-out" class="auto internal xref">Section 5</a> details how current trends in DNS
      resolution such as public DNS servers, DNS over TLS (DoT) <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>, DNS over HTTPS (DoH) <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>, or
      DNS over QUIC (DoQ) <span>[<a href="#RFC9250" class="cite xref">RFC9250</a>]</span> can cause problems with the
      strategies employed.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The core of this document is <a href="#sec-reco" class="auto internal xref">Section 6</a>, which makes a
      series of recommendations ("best current practices") for manufacturers
      on how to use DNS and IP addresses with IoT devices described by MUD.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10"><a href="#sec-privacy" class="auto internal xref">Section 9</a> discusses a set of privacy issues that
      encrypted DNS (for example, DoT and DoH) are frequently used to deal
      with.  How these concerns apply to IoT devices located within a
      residence or enterprise is a key concern.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11"><a href="#sec-security" class="auto internal xref">Section 10</a> also covers some of the negative outcomes should MUD/firewall managers and IoT manufacturers choose not to cooperate.<a href="#section-1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This document makes use of terms defined in <span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span>
      and <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The term "anti-pattern" comes from agile software design literature,
      as per <span>[<a href="#antipattern" class="cite xref">antipattern</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">"CDNs" refers to Content Distribution Networks, such as those described in
      <span>[<a href="#RFC6707" class="cite xref">RFC6707</a>], <a href="https://rfc-editor.org/rfc/rfc6707#section-1.1" class="relref">Section 1.1</a></span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mapping">
<section id="section-3">
      <h2 id="name-a-model-for-mud-controller-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-a-model-for-mud-controller-" class="section-name selfRef">A Model for MUD Controller Mapping of DNS Names to Addresses</a>
      </h2>
<p id="section-3-1">This section details a strategy that a MUD controller could take.
      Within the limits of the DNS use detailed in <a href="#sec-reco" class="auto internal xref">Section 6</a>,
      this process could work.  The methods detailed in <a href="#failingstrategy" class="auto internal xref">Appendix A</a> just will not work.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The simplest successful strategy for a MUD controller to translate
      DNS names is to do a DNS lookup on the name (a forward lookup) and then
      use the resulting IP addresses to populate the actual ACLs.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">There are a number of possible failures, and the goal of this section is
      to explain how some common DNS usages may fail.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="non-deterministic-mappings">
<section id="section-3.1">
        <h3 id="name-non-deterministic-mappings">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-non-deterministic-mappings" class="section-name selfRef">Non-Deterministic Mappings</a>
        </h3>
<p id="section-3.1-1">Most importantly, the mapping of the DNS names to IP addresses
        could be non-deterministic.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2"><span>[<a href="#RFC1794" class="cite xref">RFC1794</a>]</span> describes the very common mechanism that
        returns DNS A (or reasonably AAAA) records in a permuted order.  This
        is known as "round-robin DNS" and has been used for many decades.  The
        historical intent is that the requestor will tend to use the first IP
        address that is returned.  As each query results in addresses being in a
        different order, the effect is to split the load among many
        servers.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">This situation does not result in failures as long as all possible
        A/AAAA records are returned.  The MUD controller and the device get a
        matching set, and the ACLs that are set up cover all
        possibilities.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">There are a number of circumstances in which the list is not
        exhaustive.  The simplest is when the round-robin DNS does not return
        all addresses.  This is routinely done by geographical DNS
        load-balancing systems: Only the addresses that the balancing system
        wishes to be used are returned.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Failure can also occur if there are more addresses than what will
        conveniently fit into a DNS reply.  The reply will be marked as
        truncated.  (If DNSSEC resolution will be done, then the entire RR
        must be retrieved over TCP (or using a larger EDNS(0) size) before
        being validated.)<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">However, in a geographical DNS load-balancing system, different
        answers are given based upon the locality of the system asking.  There
        may also be further layers of round-robin indirection.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">Aside from the list of records being incomplete, the list may have
        changed between the time that the MUD controller did the lookup and
        the time that the IoT device did the lookup, and this change can
        result in a failure for the ACL to match.  If the IoT device did not
        use the same recursive servers as the MUD controller, then tailored
        DNS replies and/or truncated round-robin results could return a
        different and non-overlapping set of addresses.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">In order to compensate for this, the MUD controller performs
        regular DNS lookups in order to never have stale data.  These lookups
        must be rate-limited to avoid excessive load on the DNS servers, and
        it may be necessary to avoid local recursive resolvers.  A MUD
        controller that incorporates its own recursive caching DNS client will
        be able to observe the TTL on the entries and cause them to expire
        appropriately.  This cache will last for at least some number of
        minutes and up to some number of days (respecting the TTL), while the
        underlying DNS data can change at a higher frequency, providing
        different answers to different queries!<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">A MUD controller that is aware of which recursive DNS server the
        IoT device will use can instead query that server on a periodic basis.
        Doing so provides three advantages:<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-10">
   <li id="section-3.1-10.1">
            <p id="section-3.1-10.1.1">Any geographic load-balancing will base the decision on the
            geolocation of the recursive DNS server, and the recursive name
            server will provide the same answer to the MUD controller as to
            the IoT device.<a href="#section-3.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-10.2">
            <p id="section-3.1-10.2.1">The resulting mapping (of name to IP address) in the recursive
            name server will be cached and will remain the same for the entire
            advertised TTL reported in the DNS query return.  This
            also allows the MUD controller to avoid doing unnecessary
            queries.<a href="#section-3.1-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-10.3">
            <p id="section-3.1-10.3.1">If any addresses have been omitted in a round-robin DNS
            process, the cache will have the same set of addresses that were
            returned.<a href="#section-3.1-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.1-11">The solution of using the same caching recursive resolver as the
        target device is very simple when the MUD controller is located in a
        residential Customer Premises Equipment (CPE) device.  The device is usually also the
        policy-enforcement point for the ACLs, and a caching resolver is
        typically located on the same device.  In addition to convenience,
        there is a shared fate advantage: As all three components are running
        on the same device, if the device is rebooted (which clears the cache),
        then all three components will get restarted when the device is
        restarted.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">The solution is more complex and sometimes more fragile when the
        MUD controller is located elsewhere in an enterprise or remotely in a
        cloud, such as when a Software-Defined Network (SDN) is used to manage
        the ACLs.  The DNS servers for a particular device may not be known to
        the MUD controller, and the MUD controller may not even be permitted
        to make recursive queries to that server if it is known.  In this
        case, additional installation-specific mechanisms are probably needed
        to get the right view of the DNS.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">A critical failure can occur when the device makes a new DNS
        request and receives a new set of IP addresses, but the MUD
        controller's copy of the addresses has not yet reached their TTL.  In that case, the MUD controller still has the old addresses
        implemented in the ACLs, but the IoT device has a new address not
        previously returned to the MUD controller.  This can result in a
        connectivity failure.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dns-anti-p">
<section id="section-4">
      <h2 id="name-dns-and-ip-anti-patterns-fo">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-dns-and-ip-anti-patterns-fo" class="section-name selfRef">DNS and IP Anti-Patterns for IoT Device Manufacturers</a>
      </h2>
<p id="section-4-1">In many design fields, there are good patterns that should be
      emulated, and often there are patterns that should not be emulated.  The
      latter are called anti-patterns, as per <span>[<a href="#antipattern" class="cite xref">antipattern</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This section describes a number of things that IoT manufacturers have
      been observed to do in the field, each of which presents difficulties for
      MUD enforcement points.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="inprotocol">
<section id="section-4.1">
        <h3 id="name-use-of-ip-address-literals">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-use-of-ip-address-literals" class="section-name selfRef">Use of IP Address Literals</a>
        </h3>
<p id="section-4.1-1">A common pattern for a number of devices is to look for firmware
        updates in a two-step process.  An initial query is made (often over
        HTTPS, sometimes with a POST, but the method is immaterial) to a
        vendor system that knows whether an update is required.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">The current firmware model of the device is sometimes provided, and
        then the vendor's authoritative server provides a determination if a
        new version is required and, if so, what version.  In simpler cases,
        an HTTPS endpoint is queried, which provides the name and URL of the
        most recent firmware.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The authoritative upgrade server then responds with a URL of a
        firmware blob that the device should download and install.  Best
        practice is that either firmware is signed internally <span>[<a href="#RFC9019" class="cite xref">RFC9019</a>]</span> so that it can be verified, or a hash of the blob
        is provided.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">An authoritative server might be tempted to provide an IP address
        literal inside the protocol.  An argument for doing this is that it
        eliminates problems with firmware updates that might be caused by a
        lack of DNS or by incompatibilities with DNS.  For instance, a bug
        that causes interoperability issues with some recursive servers would
        become unpatchable for devices that were forced to use that recursive
        resolver type.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">But, there are several problems with the use of IP address literals
        for the location of the firmware.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The first is that the update service server must decide whether to
        provide an IPv4 or an IPv6 literal, assuming that only one URL can be
        provided.  A DNS name can contain both kinds of addresses and can
        also contain many different IP addresses of each kind.  An update
        server might believe that if the connection were on IPv4, then an IPv4
        literal would be acceptable. However, due to NAT64 <span>[<a href="#RFC6146" class="cite xref">RFC6146</a>]</span>, a device with only IPv6 connectivity will often be
        able to reach an IPv4 firmware update server by name (through DNS64
        <span>[<a href="#RFC6147" class="cite xref">RFC6147</a>]</span>) but not be able to reach an arbitrary IPv4
        address.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">A MUD file for this access would need to resolve to the
        set of IP addresses that might be returned by the update server.  This
        can be done with IP address literals in the MUD file, but this may
        require continuing updates to the MUD file if the addresses change
        frequently.  A DNS name in the MUD could resolve to the set of all
        possible IPv4 and IPv6 addresses that would be used, with DNS
        providing a level of indirection that obviates the need to update the
        MUD file itself.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">A third problem involves the use of HTTPS.  It is often more
        difficult to get TLS certificates for an IP address, and so it is less
        likely that the firmware download will be protected by TLS.  Even if an IP address literal was placed in the TLS ServerNameIndicator
   <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span>, against the advice of that document, it still would not provide enough
   context for a web server to distinguish which of the (potentially
   many) tenants the client wishes to reach.
   This drives the use of an IP address per tenant, and for
        IPv4 (at least), this is no longer a sustainable use of IP
        addresses.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">Finally, it is common in some CDNs
        to use multiple layers of DNS CNAMEs in order to isolate the content
        owner's naming system from changes in how the distribution network is
        organized.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">When a name or address is returned within an update protocol for
        which a MUD rule cannot be written, then the MUD controller is unable
        to authorize the connection.  In order for the connection to be
        authorized, the set of names returned within the update protocol needs
        to be known ahead of time and must be from a finite set of
        possibilities.  Such a set of names or addresses can be placed into
        the MUD file as an ACL in advance, and the connections can be
        authorized.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-non-deterministic-dns-names-in-protocols">
<section id="section-4.2">
        <h3 id="name-use-of-non-deterministic-dn">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-use-of-non-deterministic-dn" class="section-name selfRef">Use of Non-Deterministic DNS Names in Protocols</a>
        </h3>
<p id="section-4.2-1">A second pattern is for a control protocol to connect to a known
        HTTP endpoint.  This is easily described in MUD.  References within
        that control protocol are made to additional content at other URLs.
        The values of those URLs do not fit any easily described pattern and
        may point to arbitrary DNS names.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Those DNS names are often within some third-party CDN system or may
        be arbitrary DNS names in a cloud-provider storage system (e.g., <span>[<a href="#AmazonS3" class="cite xref">AmazonS3</a>]</span> or <span>[<a href="#Akamai" class="cite xref">Akamai</a>]</span>).  Some of the name
        components may be specified by the third-party CDN provider.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Such DNS names may be unpredictably chosen by the CDN and not the
        device manufacturer and therefore impossible to insert into a MUD
        file.  Implementation of the CDN system may also involve HTTP
        redirections to downstream CDN systems.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Even if the CDN provider's chosen DNS names are deterministic, they
        may change at a rate much faster than MUD files can be updated.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">This situation applies to firmware updates but also applies to many
        other kinds of content: video content, in-game content, etc.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">A solution may be to use a deterministic DNS name within the
        control of the device manufacturer.  The device manufacturer is asked
        to point a CNAME to the CDN, to a name that might look like
        "g7.a.example", with the expectation that the CDN provider's DNS will do
        all the appropriate work to geolocate the transfer.  This can be fine
        for a MUD file, as the MUD controller, if located in the same
        geography as the IoT device, can follow the CNAME and collect the set
        of resulting IP addresses along with the TTL for each.  Then, the MUD
        controller can take charge of refreshing that mapping at intervals
        driven by the TTL.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">In some cases, a complete set of geographically distributed servers
        may be known ahead of time (or that it changes very slowly), and the
        device manufacturer can list all those IP addresses in the DNS for the
        name that it lists in the MUD file.  As long as the active set of
        addresses used by the CDN is a strict subset of that list, then the
        geolocated name can be used for the content download itself.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-a-too-generic-dns-name">
<section id="section-4.3">
        <h3 id="name-use-of-a-too-generic-dns-na">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-use-of-a-too-generic-dns-na" class="section-name selfRef">Use of a Too Generic DNS Name</a>
        </h3>
<p id="section-4.3-1">Some CDNs make all customer content available at a single URL (such
        as "s3.example.com").  This seems to be ideal from a MUD point of
        view: a completely predictable URL.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The problem is that a compromised device could then connect to the
        contents of any bucket, potentially attacking the data from other
        customers.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Exactly what the risk is depends upon what the other customers are
        doing: It could be limited to simply causing a distributed
        denial-of-service attack resulting in high costs to those customers,
        or such an attack could potentially include writing
        content.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">Amazon has recognized the problems associated with this practice
        and aims to change it to a virtual hosting model, as per <span>[<a href="#awss3virtualhosting" class="cite xref">awss3virtualhosting</a>]</span>.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">The MUD ACLs provide only for permitting endpoints (hostnames and
        ports) but do not filter URLs (nor could filtering be enforced within
        HTTPS).<a href="#section-4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-priv-out">
<section id="section-5">
      <h2 id="name-dns-privacy-and-outsourcing">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dns-privacy-and-outsourcing" class="section-name selfRef">DNS Privacy and Outsourcing versus MUD Controllers</a>
      </h2>
<p id="section-5-1"><span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span> and <span>[<a href="#RFC8094" class="cite xref">RFC8094</a>]</span> provide for DoT
      and DoH.  <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>]</span> details the terms.  But, even with
      the unencrypted DNS (a.k.a. Do53), it is possible to outsource DNS
      queries to other public services, such as those operated by Google,
      CloudFlare, Verisign, etc.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For some users and classes of devices, revealing the DNS queries to
      those outside entities may constitute a privacy concern.  For other
      users, the use of an insecure local resolver may constitute a privacy
      concern.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">As described in <a href="#mapping" class="auto internal xref">Section 3</a>, the MUD controller
      needs to have access to the same resolver or resolvers as the IoT device.  If the
      IoT device does not use the DNS servers provided to it via DHCP or
      Router Advertisements, then the MUD controller will need to be told
      which servers will in fact be used.  As yet, there is no protocol to do
      this, but future work could provide this as an extension to MUD.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Until such time as such a protocol exists, the best practice is for
      the IoT device to always use the DNS servers provided by DHCP or Router
      Advertisements.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-reco">
<section id="section-6">
      <h2 id="name-recommendations-to-iot-devi">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-recommendations-to-iot-devi" class="section-name selfRef">Recommendations to IoT Device Manufacturers on MUD and DNS Usage</a>
      </h2>
<p id="section-6-1">Inclusion of a MUD file with IoT devices is operationally quite
      simple.  It requires only a few small changes to the DHCP client code to
      express the MUD URL.  It can even be done without code changes via the
      use of a QR code affixed to the packaging (see <span>[<a href="#RFC9238" class="cite xref">RFC9238</a>]</span>).<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The difficult part is determining what to put into the MUD file
      itself.  There are currently tools that help with the definition and
      analysis of MUD files; see <span>[<a href="#mudmaker" class="cite xref">mudmaker</a>]</span>.  The remaining
      difficulty is the actual list of expected connections to put in the
      MUD file.  An IoT manufacturer must spend some time reviewing the
      network communications by their device.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">This document discusses a number of challenges that occur relating to
      how DNS requests are made and resolved, and the goal of this section is
      to make recommendations on how to modify IoT systems to work well with
      MUD.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="consistently-use-dns">
<section id="section-6.1">
        <h3 id="name-consistently-use-dns">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-consistently-use-dns" class="section-name selfRef">Consistently Use DNS</a>
        </h3>
<p id="section-6.1-1">For the reasons explained in <a href="#inprotocol" class="auto internal xref">Section 4.1</a>, the most
        important recommendation is to avoid using IP address literals in any
        protocol.  DNS names should always be used.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-primary-dns-names-controlled-by-the-manufacturer">
<section id="section-6.2">
        <h3 id="name-use-primary-dns-names-contr">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-use-primary-dns-names-contr" class="section-name selfRef">Use Primary DNS Names Controlled by the Manufacturer</a>
        </h3>
<p id="section-6.2-1">The second recommendation is to allocate and use DNS names within
        zones controlled by the manufacturer.  These DNS names can be
        populated with an alias (see <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>], <a href="https://rfc-editor.org/rfc/rfc9499#section-2" class="relref">Section 2</a></span>) that points to the production system.
        Ideally, a different name is used for each logical function, allowing
        different rules in the MUD file to be enabled and disabled.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">While it used to be costly to have a large number of aliases in a
        web server certificate, this is no longer the case.  Wildcard
        certificates are also commonly available; they allow for an infinite
        number of possible DNS names.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-content-distribution-network-with-stable-dns-names">
<section id="section-6.3">
        <h3 id="name-use-a-content-distribution-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-use-a-content-distribution-" class="section-name selfRef">Use a Content Distribution Network with Stable DNS Names</a>
        </h3>
<p id="section-6.3-1">When aliases point to a CDN, give preference to stable DNS names
        that point to appropriately load-balanced targets.  CDNs that employ
        very low TTL values for DNS make it harder for the MUD
        controller to get the same answer as the IoT device.  A CDN that
        always returns the same set of A and AAAA records, but permutes them to
        provide the best one first, provides a more reliable answer.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tailorednames">
<section id="section-6.4">
        <h3 id="name-do-not-use-tailored-respons">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-do-not-use-tailored-respons" class="section-name selfRef">Do Not Use Tailored Responses to Answer DNS Names</a>
        </h3>
<p id="section-6.4-1"><span>[<a href="#RFC7871" class="cite xref">RFC7871</a>]</span> defines the edns-client-subnet (ECS) EDNS0
        option and explains how authoritative servers sometimes answer queries
        differently based upon the IP address of the end system making the
        request.  Ultimately, the decision is based upon some topological
        notion of closeness.  This is often used to provide tailored responses
        to clients, providing them with a geographically advantageous
        answer.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">When the MUD controller makes its DNS query, it is critical that it
        receives an answer that is based upon the same topological decision as
        when the IoT device makes its query.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">There are probably ways in which the MUD controller could use the
        edns-client-subnet option to make a query that would get the same
        treatment as when the IoT device makes its query.  If this worked,
        then it would receive the same answer as the IoT device.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">In practice it could be quite difficult if the IoT device uses a
        different Internet connection, a different firewall, or a different
        recursive DNS server.  The edns-client-subnet option might be ignored or
        overridden by any of the DNS infrastructure.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">Some tailored responses might only reorder the replies so that the
        most preferred address is first.  Such a system would be acceptable if
        the MUD controller had a way to know that the list was complete.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">But, due to the above problems, a strong recommendation is to avoid
        using tailored responses as part of the DNS names in the MUD file.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prefer-dns-servers-learned-from-dhcprouter-advertisements">
<section id="section-6.5">
        <h3 id="name-prefer-dns-servers-learned-">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-prefer-dns-servers-learned-" class="section-name selfRef">Prefer DNS Servers Learned from DHCP/Router Advertisements</a>
        </h3>
<p id="section-6.5-1">The best practice is for IoT devices to do DNS with the
        DHCP-provided DNS servers or with DNS servers learned from Router
        Advertisements <span>[<a href="#RFC8106" class="cite xref">RFC8106</a>]</span>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The Adaptive DNS Discovery (ADD) Working Group has written <span>[<a href="#RFC9462" class="cite xref">RFC9462</a>]</span> and <span>[<a href="#RFC9463" class="cite xref">RFC9463</a>]</span> to provide information to end devices on how to
        find locally provisioned secure/private DNS servers.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">Use of public resolvers instead of the locally provided DNS
        resolver, whether Do53, DoQ, DoT, or DoH, is discouraged.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">Some manufacturers would like to have a fallback to using a public
        resolver to mitigate against local misconfiguration.  There are a
        number of reasons to avoid this, detailed in <a href="#tailorednames" class="auto internal xref">Section 6.4</a>.  The public resolver might not return the
        same tailored names that the MUD controller would get.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<p id="section-6.5-5">It is recommended that non-local resolvers are only used when
        the locally provided resolvers provide no answers to any queries at
        all and do so repeatedly.  The status of the operator-provided
        resolvers needs to be re-evaluated on a periodic basis.<a href="#section-6.5-5" class="pilcrow">¶</a></p>
<p id="section-6.5-6">Finally, if a device will ever attempt to use non-local resolvers,
        then the addresses of those resolvers need to be listed in the MUD
        file as destinations that are to be permitted. This needs to include
        the port numbers (i.e., 53, 853 for DoT, 443 for DoH) that will be
        used as well.<a href="#section-6.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="interactions-with-mdns-and-dnssd">
<section id="section-7">
      <h2 id="name-interactions-with-mdns-and-">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-interactions-with-mdns-and-" class="section-name selfRef">Interactions with mDNS and DNS-SD</a>
      </h2>
<p id="section-7-1">Unicast DNS requests are not the only way to map names to IP
      addresses.  IoT devices might also use Multicast DNS (mDNS) <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>,
      both to be discovered by other devices and also to discover other
      devices.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">mDNS replies include A and AAAA records, and it is conceivable that
      these replies contain addresses that are not local to the link on which
      they are made.  This could be the result of another device that contains
      malware.  An unsuspecting IoT device could be led to contact some
      external host as a result.  Protecting against such things is one of the
      benefits of MUD.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">In the unlikely case that the external host has been listed as a
      legitimate destination in a MUD file, communication will
      continue as expected.  As an example, an IoT device might look
      for a name like "update.local" in order to find a source of firmware
      updates.  It could be led to connect to some external host that was
      listed as "update.example" in the MUD file.  This should work fine if
      the name "update.example" does not require any kind of tailored
      reply.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">In residential networks, there has typically not been more than one
      network (although this is changing through work like <span>[<a href="#I-D.ietf-snac-simple" class="cite xref">AUTO-STUB-NETWORKS</a>]</span>), but on campus or enterprise networks,
      having more than one network is not unusual.  In such networks, mDNS is
      being replaced with DNS-based Service Discovery (DNS-SD) <span>[<a href="#RFC8882" class="cite xref">RFC8882</a>]</span>, and in such a
      situation, connections could be initiated to other parts of the network.
      Such connections might traverse the MUD policy enforcement point (an
      intra-department firewall) and could very well be rejected because the
      MUD controller did not know about that interaction.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5"><span>[<a href="#RFC8250" class="cite xref">RFC8250</a>]</span> includes a number of provisions for
      controlling internal communications, including complex communications
      like same manufacturer ACLs.  To date, this aspect of MUD has been
      difficult to describe.  This document does not consider internal
      communications to be in scope.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-privacy">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">The use of non-local DNS servers exposes the list of DNS names
      resolved to a third party, including passive eavesdroppers.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The use of DoT and DoH eliminates the threat from passive
      eavesdropping but still exposes the list to the operator of the DoT or
      DoH server.  There are additional methods to help preserve privacy, such
      as that described by <span>[<a href="#RFC9230" class="cite xref">RFC9230</a>]</span>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">The use of unencrypted (Do53) requests to a local DNS server exposes
      the list to any internal passive eavesdroppers. For some situations,
      that may be significant, particularly if unencrypted WiFi is used.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Use of an encrypted DNS connection to a local DNS recursive resolver
      is the preferred choice.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">IoT devices that reach out to the manufacturer at regular intervals
      to check for firmware updates are informing passive eavesdroppers of the
      existence of a specific manufacturer's device being present at the
      origin location.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Identifying the IoT device type empowers the attacker to launch
      targeted attacks to the IoT device (e.g., the attacker can take
      advantage of any known vulnerability on the device).<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">While possession of a "large kitchen appliance" at a residence may be
      uninteresting to most, possession of intimate personal devices (e.g.,
      "sex toys") may be a cause for embarrassment.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">IoT device manufacturers are encouraged to find ways to anonymize
      their update queries.  For instance, contracting out the update
      notification service to a third party that deals with a large variety of
      devices would provide a level of defense against passive eavesdropping.
      Other update mechanisms should be investigated, including use of
      DNSSEC-signed TXT records with current version information.  This would
      permit DoT or DoH to convey the update notification in a private
      fashion.  This is particularly powerful if a local recursive DoT server
      is used, which then communicates using DoT over the Internet.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">The more complex case of <a href="#inprotocol" class="auto internal xref">Section 4.1</a> postulates that
      the version number needs to be provided to an intelligent agent that can
      decide the correct route to do upgrades.  <span>[<a href="#RFC9019" class="cite xref">RFC9019</a>]</span>
      provides a wide variety of ways to accomplish the same thing without
      having to divulge the current version number.<a href="#section-9-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This document deals with conflicting security requirements:<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-2.1">
          <p id="section-10-2.1.1">devices that an operator wants to manage using <span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span><a href="#section-10-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-2.2">
          <p id="section-10-2.2.1">requirements for the devices to get access to network resources
          that may be critical to their continued safe operation<a href="#section-10-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-3">This document takes the view that the two requirements do not need to
      be in conflict, but resolving the conflict requires careful planning on
      how the DNS can be safely and effectively be used by MUD controllers and
      IoT devices.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">When an IoT device with an inaccurate MUD file is deployed into a
      network that uses MUD, there is a significant possibility that the
      device will cause a spurious security exception to be raised.  There is
      significant evidence that such spurious exceptions can cause significant
      overhead to personnel.  In particular, repeated spurious exceptions are
      likely to cause the entire exception process to be turned off.  When MUD
      alerts are turned off, then even legitimate exceptions are ignored.
      This is very much a Boy Who Calls Wolf <span>[<a href="#boywhocriedwolf" class="cite xref">boywhocriedwolf</a>]</span>
      situation.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">In order to avoid this situation, and for MUD alerts to be given
      appropriate attention, it is key that IoT device manufacturers create
      accurate MUD files.  This may require some significant thought and even
      rework of key systems so that all network access required by the IoT
      device can be described by a MUD file.  This level of informed
      cooperation within the IoT device vendor and with MUD controller
      manufacturers is key to getting significant return on investment from
      MUD.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">Manufacturers are encouraged to write MUD files that are good enough
      rather than perfect.  If in doubt, they should write MUD files that are
      somewhat more permissive if the files result in no spurious alerts.<a href="#section-10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1794">[RFC1794]</dt>
        <dd>
<span class="refAuthor">Brisco, T.</span>, <span class="refTitle">"DNS Support for Load Balancing"</span>, <span class="seriesInfo">RFC 1794</span>, <span class="seriesInfo">DOI 10.17487/RFC1794</span>, <time datetime="1995-04" class="refDate">April 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1794">https://www.rfc-editor.org/info/rfc1794</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8094">[RFC8094]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">P. Patil</span>, <span class="refTitle">"DNS over Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 8094</span>, <span class="seriesInfo">DOI 10.17487/RFC8094</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8094">https://www.rfc-editor.org/info/rfc8094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8250">[RFC8250]</dt>
        <dd>
<span class="refAuthor">Elkins, N.</span>, <span class="refAuthor">Hamilton, R.</span>, and <span class="refAuthor">M. Ackermann</span>, <span class="refTitle">"IPv6 Performance and Diagnostic Metrics (PDM) Destination Option"</span>, <span class="seriesInfo">RFC 8250</span>, <span class="seriesInfo">DOI 10.17487/RFC8250</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8250">https://www.rfc-editor.org/info/rfc8250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8520">[RFC8520]</dt>
        <dd>
<span class="refAuthor">Lear, E.</span>, <span class="refAuthor">Droms, R.</span>, and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"Manufacturer Usage Description Specification"</span>, <span class="seriesInfo">RFC 8520</span>, <span class="seriesInfo">DOI 10.17487/RFC8520</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8520">https://www.rfc-editor.org/info/rfc8520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9019">https://www.rfc-editor.org/info/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9499">[RFC9499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 9499</span>, <span class="seriesInfo">DOI 10.17487/RFC9499</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9499">https://www.rfc-editor.org/info/rfc9499</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Akamai">[Akamai]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Akamai Technologies"</span>, <time datetime="2025-02-26" class="refDate">26 February 2025</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Akamai_Technologies&amp;oldid=1277665363">https://en.wikipedia.org/w/index.php?title=Akamai_Technologies&amp;oldid=1277665363</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AmazonS3">[AmazonS3]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Amazon S3"</span>, <time datetime="2025-03-14" class="refDate">14 March 2025</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Amazon_S3&amp;oldid=1280379498">https://en.wikipedia.org/w/index.php?title=Amazon_S3&amp;oldid=1280379498</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="antipattern">[antipattern]</dt>
        <dd>
<span class="refAuthor">Agile Alliance</span>, <span class="refTitle">"AntiPattern"</span>, <span>&lt;<a href="https://www.agilealliance.org/glossary/antipattern">https://www.agilealliance.org/glossary/antipattern</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-snac-simple">[AUTO-STUB-NETWORKS]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">J. Hui</span>, <span class="refTitle">"Automatically Connecting Stub Networks to Unmanaged Infrastructure"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-snac-simple-06</span>, <time datetime="2024-11-04" class="refDate">4 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-snac-simple-06">https://datatracker.ietf.org/doc/html/draft-ietf-snac-simple-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="awss3virtualhosting">[awss3virtualhosting]</dt>
        <dd>
<span class="refAuthor">Tech Monitor</span>, <span class="refTitle">"Down to the Wire: AWS Delays 'Path-Style' S3 Deprecation at Last Minute"</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://techmonitor.ai/techonology/cloud/aws-s3-path-deprecation">https://techmonitor.ai/techonology/cloud/aws-s3-path-deprecation</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="boywhocriedwolf">[boywhocriedwolf]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"The Boy Who Cried Wolf"</span>, <time datetime="2025-02-06" class="refDate">6 February 2025</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=The_Boy_Who_Cried_Wolf&amp;oldid=1274257821">https://en.wikipedia.org/w/index.php?title=The_Boy_Who_Cried_Wolf&amp;oldid=1274257821</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="mudmaker">[mudmaker]</dt>
        <dd>
<span class="refTitle">"MUD Maker"</span>, <span>&lt;<a href="https://mudmaker.org">https://mudmaker.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6146">[RFC6146]</dt>
        <dd>
<span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Matthews, P.</span>, and <span class="refAuthor">I. van Beijnum</span>, <span class="refTitle">"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"</span>, <span class="seriesInfo">RFC 6146</span>, <span class="seriesInfo">DOI 10.17487/RFC6146</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6146">https://www.rfc-editor.org/info/rfc6146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6147">[RFC6147]</dt>
        <dd>
<span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Sullivan, A.</span>, <span class="refAuthor">Matthews, P.</span>, and <span class="refAuthor">I. van Beijnum</span>, <span class="refTitle">"DNS64: DNS Extensions for Network Address Translation from IPv6 Clients to IPv4 Servers"</span>, <span class="seriesInfo">RFC 6147</span>, <span class="seriesInfo">DOI 10.17487/RFC6147</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6147">https://www.rfc-editor.org/info/rfc6147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6707">[RFC6707]</dt>
        <dd>
<span class="refAuthor">Niven-Jenkins, B.</span>, <span class="refAuthor">Le Faucheur, F.</span>, and <span class="refAuthor">N. Bitar</span>, <span class="refTitle">"Content Distribution Network Interconnection (CDNI) Problem Statement"</span>, <span class="seriesInfo">RFC 6707</span>, <span class="seriesInfo">DOI 10.17487/RFC6707</span>, <time datetime="2012-09" class="refDate">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6707">https://www.rfc-editor.org/info/rfc6707</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7871">[RFC7871]</dt>
        <dd>
<span class="refAuthor">Contavalli, C.</span>, <span class="refAuthor">van der Gaast, W.</span>, <span class="refAuthor">Lawrence, D.</span>, and <span class="refAuthor">W. Kumari</span>, <span class="refTitle">"Client Subnet in DNS Queries"</span>, <span class="seriesInfo">RFC 7871</span>, <span class="seriesInfo">DOI 10.17487/RFC7871</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7871">https://www.rfc-editor.org/info/rfc7871</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8106">[RFC8106]</dt>
        <dd>
<span class="refAuthor">Jeong, J.</span>, <span class="refAuthor">Park, S.</span>, <span class="refAuthor">Beloeil, L.</span>, and <span class="refAuthor">S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8882">[RFC8882]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span> and <span class="refAuthor">D. Kaiser</span>, <span class="refTitle">"DNS-Based Service Discovery (DNS-SD) Privacy and Security Requirements"</span>, <span class="seriesInfo">RFC 8882</span>, <span class="seriesInfo">DOI 10.17487/RFC8882</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8882">https://www.rfc-editor.org/info/rfc8882</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9230">[RFC9230]</dt>
        <dd>
<span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">McManus, P.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Verma, T.</span>, and <span class="refAuthor">C.A. Wood</span>, <span class="refTitle">"Oblivious DNS over HTTPS"</span>, <span class="seriesInfo">RFC 9230</span>, <span class="seriesInfo">DOI 10.17487/RFC9230</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9230">https://www.rfc-editor.org/info/rfc9230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9238">[RFC9238]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Latour, J.</span>, and <span class="refAuthor">H. Habibi Gharakheili</span>, <span class="refTitle">"Loading Manufacturer Usage Description (MUD) URLs from QR Codes"</span>, <span class="seriesInfo">RFC 9238</span>, <span class="seriesInfo">DOI 10.17487/RFC9238</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9238">https://www.rfc-editor.org/info/rfc9238</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9250">https://www.rfc-editor.org/info/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9462">[RFC9462]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="seriesInfo">RFC 9462</span>, <span class="seriesInfo">DOI 10.17487/RFC9462</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9462">https://www.rfc-editor.org/info/rfc9462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9463">[RFC9463]</dt>
      <dd>
<span class="refAuthor">Boucadair, M., Ed.</span>, <span class="refAuthor">Reddy.K, T., Ed.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Cook, N.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)"</span>, <span class="seriesInfo">RFC 9463</span>, <span class="seriesInfo">DOI 10.17487/RFC9463</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9463">https://www.rfc-editor.org/info/rfc9463</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="failingstrategy">
<section id="appendix-A">
      <h2 id="name-a-failing-strategy-anti-pat">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-a-failing-strategy-anti-pat" class="section-name selfRef">A Failing Strategy: Anti-Patterns</a>
      </h2>
<p id="appendix-A-1">Attempts to map IP addresses to DNS names in real time often fail for a number of reasons:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A-2">
 <li id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">It can not be done fast enough.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">It reveals usage patterns of the devices.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">The mappings are often incomplete.<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="appendix-A-2.4">
          <p id="appendix-A-2.4.1">Even if the mapping is present, due to virtual hosting, it may
          not map back to the name used in the ACL.<a href="#appendix-A-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="appendix-A-3">This is not a successful strategy for the reasons explained below.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="too-slow">
<section id="appendix-A.1">
        <h3 id="name-too-slow">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-too-slow" class="section-name selfRef">Too Slow</a>
        </h3>
<p id="appendix-A.1-1">Mappings of IP addresses to DNS names require a DNS lookup in the
        in-addr.arpa or ip6.arpa space.  For a cold DNS cache, this will
        typically require 2 to 3 NS record lookups to locate the DNS server
        that holds the information required.  At 20 to 100 ms per round trip,
        this easily adds up to a significant amount of time before the packet
        that caused the lookup can be released.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">While subsequent connections to the same site (and subsequent
        packets in the same flow) will not be affected if the results are
        cached, the effects will be felt.  The ACL results can be cached for a
        period of time given by the TTL of the DNS results, but the DNS lookup
        must be repeated, e.g., in a few hours or days, when the cached binding (of IP
        address to name) expires.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reveals-patterns-of-usage">
<section id="appendix-A.2">
        <h3 id="name-reveals-patterns-of-usage">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-reveals-patterns-of-usage" class="section-name selfRef">Reveals Patterns of Usage</a>
        </h3>
<p id="appendix-A.2-1">By doing the DNS lookups when the traffic occurs, then a passive
        attacker can see when the device is active and may be able to derive
        usage patterns.  They could determine when a home was occupied or not.
        This does not require access to all on-path data, just to the DNS
        requests to the bottom level of the DNS tree.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mappings-are-often-incomplete">
<section id="appendix-A.3">
        <h3 id="name-mappings-are-often-incomple">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-mappings-are-often-incomple" class="section-name selfRef">Mappings Are Often Incomplete</a>
        </h3>
<p id="appendix-A.3-1">An IoT manufacturer with a cloud service provider that fails to
        include an A or AAAA record as part of their forward name publication
        will find that the new server is simply not used.  The operational
        feedback for that mistake is immediate.  The same is not true for
        reverse DNS mappings: They can often be incomplete or incorrect for
        months or even years without a visible effect on operations.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">IoT manufacturer cloud service providers often find it difficult to
        update reverse DNS maps in a timely fashion, assuming that they can do
        it at all.  Many cloud-based solutions dynamically assign IP addresses
        to services, often as the service grows and shrinks, reassigning those
        IP addresses to other services quickly.  The use of HTTP 1.1 Virtual
        Hosting may allow addresses and entire front-end systems to be reused
        dynamically without even reassigning the IP addresses.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3-3">In some cases, there are multiple layers of CNAME between the
        original name and the target service name.  This is often due to a
        load-balancing layer in the DNS followed by a load-balancing layer at
        the HTTP level.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3-4">The reverse DNS mapping for the IP address of the load balancer
        usually does not change.  If hundreds of web services are funneled
        through the load balancer, it would require hundreds of PTR records to
        be deployed.  This would easily exceed the UDP/DNS and EDNS0 limits
        and require all queries to use TCP, which would further slow
        down loading of the records.<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3-5">The enumeration of all services/sites that have been at that
        load balancer might also constitute a security concern.  To limit
        the churn of DNS PTR records and reduce failures of the MUD ACLs,
        operators would want to add all possible DNS names for each reverse
        DNS mapping, whether or not the DNS load-balancing in the forward DNS
        space lists that endpoint at that moment.<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forward-dns-names-can-have-wildcards">
<section id="appendix-A.4">
        <h3 id="name-forward-dns-names-can-have-">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-forward-dns-names-can-have-" class="section-name selfRef">Forward DNS Names Can Have Wildcards</a>
        </h3>
<p id="appendix-A.4-1">In some large hosting providers, content is hosted through a domain
        name that is published as a DNS wildcard (and uses a wildcard
        certificate).  For instance, github.io, which is used for hosting
        content, including the Editors' copy of Internet-Drafts stored on
        GitHub, does not actually publish any DNS names.  Instead, a wildcard
        exists to answer all potential DNS names: Requests are routed
        appropriately once they are received.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">This kind of system works well for self-managed hosted content.
        However, while it is possible to insert up to a few dozen PTR records,
        many thousands of entries are not possible, nor is it possible to deal
        with the unlimited (infinite) number of possibilities that a wildcard
        supports.<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3">Therefore, it would be impossible for the PTR reverse lookup to
        ever work with these wildcard DNS names.<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy.K</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Wei Pan</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:william.panwei@huawei.com" class="email">william.panwei@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
