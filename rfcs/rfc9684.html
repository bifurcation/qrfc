<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9684: A YANG Data Model for Challenge-Response-Based Remote Attestation (CHARRA) Procedures Using Trusted Platform Modules (TPMs)</title>
<meta content="Henk Birkholz" name="author">
<meta content="Michael Eckel" name="author">
<meta content="Shwetha Bhandari" name="author">
<meta content="Eric Voit" name="author">
<meta content="Bill Sulzen" name="author">
<meta content="Liang Xia (Frank)" name="author">
<meta content="Tom Laffey" name="author">
<meta content="Guy C. Fedorkow" name="author">
<meta content='
       This document defines the YANG Remote Procedure Calls (RPCs) and configuration nodes that are required to retrieve attestation evidence about integrity measurements from a device, following the operational context defined in RFC 9683 "TPM-based Network Device Remote Integrity Verification". Complementary measurement logs originating from one or more Roots of Trust for Measurement (RTMs) are also provided by the YANG RPCs.  The defined module requires the inclusion of the following in the device components of the composite device on which the YANG server is running: at least one Trusted Platform Module (TPM) of either version 1.2 or 2.0 as well as a corresponding TPM Software Stack (TSS), or an equivalent hardware implementation that includes the protected capabilities as provided by TPMs as well as a corresponding software stack. 
    ' name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="TPM" name="keyword">
<meta content="9684" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9684.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-rats-yang-tpm-charra-21" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9684" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9684</td>
<td class="center">YANG Data Model for CHARRA Procedures</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Birkholz, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9684" class="eref">9684</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12" class="published">December 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT | ATHENE</div>
</div>
<div class="author">
      <div class="author-name">M. Eckel</div>
<div class="org">Fraunhofer SIT | ATHENE</div>
</div>
<div class="author">
      <div class="author-name">S. Bhandari</div>
<div class="org">ThoughtSpot</div>
</div>
<div class="author">
      <div class="author-name">E. Voit</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">B. Sulzen</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">L. Xia</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">T. Laffey</div>
<div class="org">HPE</div>
</div>
<div class="author">
      <div class="author-name">G. C. Fedorkow</div>
<div class="org">Juniper</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9684</h1>
<h1 id="title">A YANG Data Model for Challenge-Response-Based Remote Attestation (CHARRA) Procedures Using Trusted Platform Modules (TPMs)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the YANG Remote Procedure Calls (RPCs) and configuration nodes that are required to retrieve attestation evidence about integrity measurements from a device, following the operational context defined in RFC 9683 "TPM-based Network Device Remote Integrity Verification". Complementary measurement logs originating from one or more Roots of Trust for Measurement (RTMs) are also provided by the YANG RPCs.  The defined module requires the inclusion of the following in the device components of the composite device on which the YANG server is running: at least one Trusted Platform Module (TPM) of either version 1.2 or 2.0 as well as a corresponding TPM Software Stack (TSS), or an equivalent hardware implementation that includes the protected capabilities as provided by TPMs as well as a corresponding software stack.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9684">https://www.rfc-editor.org/info/rfc9684</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation" class="internal xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-yang-module-for-basic-r" class="internal xref">The YANG Module for Basic Remote Attestation Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-yang-modules" class="internal xref">YANG Modules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-ietf-tpm-remote-attestation" class="internal xref">ietf-tpm-remote-attestation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-ietf-tcg-algs" class="internal xref">ietf-tcg-algs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-integrity-measurement-archi" class="internal xref">Integrity Measurement Architecture (IMA)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-ima-for-network-equipment-b" class="internal xref">IMA for Network Equipment Boot Logs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document is based on the general terminology defined in Remote ATtestation procedureS (RATS) architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and uses the operational context defined in <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> as well as the interaction model and information elements defined in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">RATS-Interaction-Models</a>]</span>. The currently supported hardware security modules (HSMs) are the Trusted Platform Modules (TPMs) <span>[<a href="#TPM1.2" class="cite xref">TPM1.2</a>]</span> <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span> as specified by the Trusted Computing Group (TCG). One TPM, or multiple TPMs in the case of a composite device, is required in order to use the YANG module defined in this document. Each TPM is used as a Root of Trust for Storage (RTS) in order to store system security measurement Evidence.  And each TPM is used as a Root of Trust for Reporting (RTR) in order to retrieve attestation Evidence.  This is done by using a YANG RPC to request a quote that exposes a rolling hash of the security measurements held internally within the TPM.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Specific terms imported from <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and used in this document include Attester, composite device, and Evidence.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Specific terms imported from <span>[<a href="#TPM2.0-Key" class="cite xref">TPM2.0-Key</a>]</span> and used in this document include Endorsement Key (EK), Initial Attestation Key (IAK), Attestation Identity Key (AIK), and Local Attestation Key (LAK).<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="requirements-notation">
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-yang-module-for-basic-remote-attestation-procedures">
<section id="section-2">
      <h2 id="name-the-yang-module-for-basic-r">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-yang-module-for-basic-r" class="section-name selfRef">The YANG Module for Basic Remote Attestation Procedures</a>
      </h2>
<p id="section-2-1">One or more TPMs <span class="bcp14">MUST</span> be embedded in a composite device that provides attestation Evidence via the YANG module defined in this document. The ietf-tpm-remote-attestation YANG module enables a composite device to take on the role of an Attester, in accordance with the RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and the corresponding challenge-response interaction model defined in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">RATS-Interaction-Models</a>]</span>. A fresh nonce with an appropriate amount of entropy <span>[<a href="#NIST-915121" class="cite xref">NIST-915121</a>]</span> <span class="bcp14">MUST</span> be supplied by the YANG client in order to enable a proof-of-freshness with respect to the attestation Evidence provided by the Attester running the YANG datastore. Further, this nonce is used to prevent replay attacks. The method for communicating the relationship of each individual TPM to the specific measured component within the composite device is out of the scope of this document.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="yang-modules">
<section id="section-2.1">
        <h3 id="name-yang-modules">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-yang-modules" class="section-name selfRef">YANG Modules</a>
        </h3>
<p id="section-2.1-1">In this section, the two YANG modules are defined.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="ietf-tpm-remote-attestation">
<section id="section-2.1.1">
          <h4 id="name-ietf-tpm-remote-attestation">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-ietf-tpm-remote-attestation" class="section-name selfRef">ietf-tpm-remote-attestation</a>
          </h4>
<p id="section-2.1.1-1">This YANG module imports modules from <span>[<a href="#RFC6991" class="cite xref">RFC6991</a>]</span> with prefix 'yang', <span>[<a href="#RFC8348" class="cite xref">RFC8348</a>]</span> with prefix 'hw', <span>[<a href="#RFC9642" class="cite xref">RFC9642</a>]</span> with prefix 'ks', and ietf-tcg-algs.yang <a href="#ref-ietf-tcg-algs" class="auto internal xref">Section 2.1.2.3</a> with prefix 'taa'.  Additionally, references are made to <span>[<a href="#RFC6933" class="cite xref">RFC6933</a>]</span>, <span>[<a href="#TPM1.2-Commands" class="cite xref">TPM1.2-Commands</a>]</span>, <span>[<a href="#TPM2.0-Arch" class="cite xref">TPM2.0-Arch</a>]</span>, <span>[<a href="#TPM2.0-Structures" class="cite xref">TPM2.0-Structures</a>]</span>, <span>[<a href="#TPM2.0-Key" class="cite xref">TPM2.0-Key</a>]</span>, <span>[<a href="#TPM1.2-Structures" class="cite xref">TPM1.2-Structures</a>]</span>, <span>[<a href="#BIOS-Log" class="cite xref">BIOS-Log</a>]</span>, and <span>[<a href="#CEL" class="cite xref">CEL</a>]</span>, as well as <a href="#netequip-boot-log" class="auto internal xref">Appendix B</a>.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div id="features">
<section id="section-2.1.1.1">
            <h5 id="name-features">
<a href="#section-2.1.1.1" class="section-number selfRef">2.1.1.1. </a><a href="#name-features" class="section-name selfRef">Features</a>
            </h5>
<p id="section-2.1.1.1-1">This module supports the following features:<a href="#section-2.1.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1.1-2">
              <dt id="section-2.1.1.1-2.1">'mtpm':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.1-2.2">Indicates that multiple TPMs on the device can support remote attestation. For example, this feature could be used in cases where multiple line cards are present, each with its own TPM.<a href="#section-2.1.1.1-2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.1-2.3">'bios':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.1-2.4">Indicates that the device supports the retrieval of BIOS and Unified Extensible Firmware Interface (UEFI) event logs <span>[<a href="#BIOS-Log" class="cite xref">BIOS-Log</a>]</span>.<a href="#section-2.1.1.1-2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.1-2.5">'ima':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.1-2.6">Indicates that the device supports the retrieval of event logs from the Linux Integrity Measurement Architecture (IMA, see <a href="#ima" class="auto internal xref">Appendix A</a>).<a href="#section-2.1.1.1-2.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.1-2.7">'netequip_boot':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.1-2.8">Indicates that the device supports the retrieval of netequip boot event logs. See Appendixes <a href="#ima" class="auto internal xref">A</a> and <a href="#netequip-boot-log" class="auto internal xref">B</a>.<a href="#section-2.1.1.1-2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="identities">
<section id="section-2.1.1.2">
            <h5 id="name-identities">
<a href="#section-2.1.1.2" class="section-number selfRef">2.1.1.2. </a><a href="#name-identities" class="section-name selfRef">Identities</a>
            </h5>
<p id="section-2.1.1.2-1">This module supports the following types of attestation event logs: 'bios', 'ima', and 'netequip_boot'.<a href="#section-2.1.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remote-procedure-calls-rpcs">
<section id="section-2.1.1.3">
            <h5 id="name-remote-procedure-calls-rpcs">
<a href="#section-2.1.1.3" class="section-number selfRef">2.1.1.3. </a><a href="#name-remote-procedure-calls-rpcs" class="section-name selfRef">Remote Procedure Calls (RPCs)</a>
            </h5>
<p id="section-2.1.1.3-1">In the following sections, RPCs for attestation procedures for both TPM 1.2 and TPM 2.0 are defined.<a href="#section-2.1.1.3-1" class="pilcrow">¶</a></p>
<div id="tpm12-challenge-response-attestation">
<section id="section-2.1.1.3.1">
              <h6 id="name-tpm12-challenge-response-at">
<a href="#section-2.1.1.3.1" class="section-number selfRef">2.1.1.3.1. </a><a href="#name-tpm12-challenge-response-at" class="section-name selfRef">tpm12-challenge-response-attestation</a>
              </h6>
<p id="section-2.1.1.3.1-1">This RPC allows a Verifier to request via the <em>TPM Quote</em> operation, signed TPM Platform Configuration Registers (PCRs) from a cryptoprocessor compliant with TPM 1.2. Where the feature 'mtpm' is active, and one or more 'certificate-name' is not provided, all cryptoprocessors compliant with TPM 1.2 will respond.  The YANG tree diagram of this RPC is as follows:<a href="#section-2.1.1.3.1-1" class="pilcrow">¶</a></p>
<div class="lang-yangtree sourcecode" id="section-2.1.1.3.1-2">
<pre>
+---x tpm12-challenge-response-attestation {taa:tpm12}?
   +---w input
   |  +---w tpm12-attestation-challenge
   |     +---w pcr-index*          pcr
   |     +---w nonce-value         binary
   |     +---w certificate-name*   certificate-name-ref
   |             {tpm:mtpm}?
   +--ro output
      +--ro tpm12-attestation-response* []
         +--ro certificate-name    certificate-name-ref
         +--ro up-time?            uint32
         +--ro TPM_QUOTE2?         binary
</pre><a href="#section-2.1.1.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tpm20-challenge-response-attestation">
<section id="section-2.1.1.3.2">
              <h6 id="name-tpm20-challenge-response-at">
<a href="#section-2.1.1.3.2" class="section-number selfRef">2.1.1.3.2. </a><a href="#name-tpm20-challenge-response-at" class="section-name selfRef">tpm20-challenge-response-attestation</a>
              </h6>
<p id="section-2.1.1.3.2-1">This RPC allows a Verifier to request signed TPM PCRs (<em>TPM Quote</em> operation) from a cryptoprocessor compliant with TPM 2.0. Where the feature 'mtpm' is active, and one or more 'certificate-name' is not provided, all cryptoprocessors compliant with TPM 2.0 will respond. The YANG tree diagram of this RPC is as follows:<a href="#section-2.1.1.3.2-1" class="pilcrow">¶</a></p>
<div class="lang-yangtree sourcecode" id="section-2.1.1.3.2-2">
<pre>
+---x tpm20-challenge-response-attestation {taa:tpm20}?
   +---w input
   |  +---w tpm20-attestation-challenge
   |     +---w nonce-value            binary
   |     +---w tpm20-pcr-selection* []
   |     |  +---w tpm20-hash-algo?   identityref
   |     |  +---w pcr-index*         pcr
   |     +---w certificate-name*      certificate-name-ref
   |             {tpm:mtpm}?
   +--ro output
      +--ro tpm20-attestation-response* []
         +--ro certificate-name       certificate-name-ref
         +--ro TPMS_QUOTE_INFO        binary
         +--ro quote-signature?       binary
         +--ro up-time?               uint32
         +--ro unsigned-pcr-values* []
            +--ro tpm20-hash-algo?   identityref
            +--ro pcr-values* [pcr-index]
               +--ro pcr-index    pcr
               +--ro pcr-value?   binary
</pre><a href="#section-2.1.1.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.3.2-3">An example of an RPC challenge requesting PCRs 0-7 from a SHA-256 bank could look like the following:<a href="#section-2.1.1.3.2-3" class="pilcrow">¶</a></p>
<div class="lang-xml sourcecode" id="section-2.1.1.3.2-4">
<pre>
&lt;rpc message-id="101"
  xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
  &lt;tpm20-attestation-challenge
    xmlns="urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation"&gt;
    &lt;certificate-name&gt;
        (identifier of a TPM signature key with which the Attester is
        supposed to sign the attestation data)
    &lt;/certificate-name&gt;
    &lt;nonce&gt;
    0xe041307208d9f78f5b1bbecd19e2d152ad49de2fc5a7d8dbf769f6b8ffdeab9
    &lt;/nonce&gt;
    &lt;tpm20-pcr-selection&gt;
      &lt;tpm20-hash-algo
          xmlns="urn:ietf:params:xml:ns:yang:ietf-tcg-algs"&gt;
        TPM_ALG_SHA256
      &lt;/tpm20-hash-algo&gt;
      &lt;pcr-index&gt;0&lt;/pcr-index&gt;
      &lt;pcr-index&gt;1&lt;/pcr-index&gt;
      &lt;pcr-index&gt;2&lt;/pcr-index&gt;
      &lt;pcr-index&gt;3&lt;/pcr-index&gt;
      &lt;pcr-index&gt;4&lt;/pcr-index&gt;
      &lt;pcr-index&gt;5&lt;/pcr-index&gt;
      &lt;pcr-index&gt;6&lt;/pcr-index&gt;
      &lt;pcr-index&gt;7&lt;/pcr-index&gt;
    &lt;/tpm20-pcr-selection&gt;
  &lt;/tpm20-attestation-challenge&gt;
&lt;/rpc&gt;
</pre><a href="#section-2.1.1.3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.3.2-5">A successful response could be formatted as follows:<a href="#section-2.1.1.3.2-5" class="pilcrow">¶</a></p>
<div class="lang-xml sourcecode" id="section-2.1.1.3.2-6">
<pre>
&lt;rpc-reply message-id="101"
  xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
  &lt;tpm20-attestation-response
    xmlns="urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation"&gt;
    &lt;certificate-name
        xmlns="urn:ietf:params:xml:ns:yang:ietf-keystore"&gt;
        (instance of certificate name in the keystore)
    &lt;/certificate-name&gt;
    &lt;attestation-data&gt;
       (raw attestation data, i.e., the TPM quote; this includes,
       among other information, a composite digest of requested PCRs,
       the nonce, and TPM 2.0 clock information.)
    &lt;/attestation-data&gt;
    &lt;quote-signature&gt;
        (signature over attestation-data using the TPM key
        identified by sig-key-id)
    &lt;/quote-signature&gt;
  &lt;/tpm20-attestation-response&gt;
&lt;/rpc-reply&gt;
</pre><a href="#section-2.1.1.3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="log-retrieval">
<section id="section-2.1.1.4">
            <h5 id="name-log-retrieval">
<a href="#section-2.1.1.4" class="section-number selfRef">2.1.1.4. </a><a href="#name-log-retrieval" class="section-name selfRef">log-retrieval</a>
            </h5>
<p id="section-2.1.1.4-1">This RPC allows a Verifier to acquire the Evidence that was extended into specific TPM PCRs. The YANG tree diagram of this RPC is as follows:<a href="#section-2.1.1.4-1" class="pilcrow">¶</a></p>
<div class="breakable lang-yangtree sourcecode" id="section-2.1.1.4-2">
<pre>
+---x log-retrieval
   +---w input
   |  +---w log-type        identityref
   |  +---w log-selector* []
   |     +---w name*                      string
   |     +---w (index-type)?
   |     |  +--:(last-entry)
   |     |  |  +---w last-entry-value?    binary
   |     |  +--:(index)
   |     |  |  +---w last-index-number?   uint64
   |     |  +--:(timestamp)
   |     |     +---w timestamp?           yang:date-and-time
   |     +---w log-entry-quantity?        uint16
   +--ro output
      +--ro system-event-logs
         +--ro node-data* []
            +--ro name?         string
            +--ro up-time?      uint32
            +--ro log-result
               +--ro (attested_event_log_type)
                  +--:(bios) {bios}?
                  |  +--ro bios-event-logs
                  |     +--ro bios-event-entry* [event-number]
                  |        +--ro event-number    uint32
                  |        +--ro event-type?     uint32
                  |        +--ro pcr-index?      pcr
                  |        +--ro digest-list* []
                  |        |  +--ro hash-algo?   identityref
                  |        |  +--ro digest*      binary
                  |        +--ro event-size?     uint32
                  |        +--ro event-data*     binary
                  +--:(ima) {ima}?
                  |  +--ro ima-event-logs
                  |     +--ro ima-event-entry* [event-number]
                  |        +--ro event-number              uint64
                  |        +--ro ima-template?             string
                  |        +--ro filename-hint?            string
                  |        +--ro filedata-hash?            binary
                  |        +--ro filedata-hash-algorithm?  string
                  |        +--ro template-hash-algorithm?  string
                  |        +--ro template-hash?            binary
                  |        +--ro pcr-index?                pcr
                  |        +--ro signature?                binary
                  +--:(netequip_boot) {netequip_boot}?
                     +--ro boot-event-logs
                        +--ro boot-event-entry* [event-number]
                           +--ro event-number              uint64
                           +--ro ima-template?             string
                           +--ro filename-hint?            string
                           +--ro filedata-hash?            binary
                           +--ro filedata-hash-algorithm?  string
                           +--ro template-hash-algorithm?  string
                           +--ro template-hash?            binary
                           +--ro pcr-index?                pcr
                           +--ro signature?                binary
</pre><a href="#section-2.1.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="data-nodes">
<section id="section-2.1.1.5">
            <h5 id="name-data-nodes">
<a href="#section-2.1.1.5" class="section-number selfRef">2.1.1.5. </a><a href="#name-data-nodes" class="section-name selfRef">Data Nodes</a>
            </h5>
<p id="section-2.1.1.5-1">This section provides a high-level description of the data nodes that contain the configuration and operational objects within the YANG data model. For more details, please see the YANG module itself in <a href="#ref-ietf-tpm-remote-attestation" class="auto internal xref">Figure 1</a>.<a href="#section-2.1.1.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1.5-2">
              <dt id="section-2.1.1.5-2.1">Container 'rats-support-structures':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.5-2.2">
                <p id="section-2.1.1.5-2.2.1">This houses the set of information relating to remote attestation for a device.  This includes specific device TPM(s), the compute nodes (such as line cards) on which the TPM(s) reside, and the algorithms supported across the platform.<a href="#section-2.1.1.5-2.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-2.1.1.5-2.3">Container 'tpms':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.5-2.4">
                <p id="section-2.1.1.5-2.4.1">This provides configuration and operational details for each supported TPM, including the tpm-firmware-version, PCRs that may be quoted, certificates that are associated with that TPM, and the current operational status. Of note are the certificates that are associated with that TPM. As a certificate is associated with a particular TPM Attestation Key, knowledge of the certificate allows a specific TPM to be identified.<a href="#section-2.1.1.5-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<div class="lang-yangtree sourcecode" id="section-2.1.1.5-3">
<pre>
+--rw tpms
   +--rw tpm* [name]
      +--rw name                string
      +--ro hardware-based      boolean
      +--ro physical-index?     int32 {hw:entity-mib}?
      +--ro path?               string
      +--ro compute-node        compute-node-ref {tpm:mtpm}?
      +--ro manufacturer?       string
      +--rw firmware-version    identityref
      +--rw tpm12-hash-algo?    identityref {taa:tpm12}?
      +--rw tpm12-pcrs*         pcr
      +--rw tpm20-pcr-bank* [tpm20-hash-algo]  {taa:tpm20}?
      |  +--rw tpm20-hash-algo    identityref
      |  +--rw pcr-index*         tpm:pcr
      +--ro status              enumeration
      +--rw certificates
         +--rw certificate* [name]
            +--rw name            string
            +--rw keystore-ref?   leafref {ks:asymmetric-keys}?
            +--rw type?           enumeration
</pre><a href="#section-2.1.1.5-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1.5-4">
              <dt id="section-2.1.1.5-4.1">Container 'attester-supported-algos':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.5-4.2">
                <p id="section-2.1.1.5-4.2.1">This identifies which TCG hash algorithms are available for use on the Attesting platform. An operator will use this information to limit algorithms available for use by RPCs to just a desired set from the universe of all hash algorithms allowed by the TCG.<a href="#section-2.1.1.5-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<div class="lang-yangtree sourcecode" id="section-2.1.1.5-5">
<pre>
+--rw attester-supported-algos
   +--rw tpm12-asymmetric-signing*   identityref {taa:tpm12}?
   +--rw tpm12-hash*                 identityref {taa:tpm12}?
   +--rw tpm20-asymmetric-signing*   identityref {taa:tpm20}?
   +--rw tpm20-hash*                 identityref {taa:tpm20}?
</pre><a href="#section-2.1.1.5-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1.5-6">
              <dt id="section-2.1.1.5-6.1">Container 'compute-nodes':</dt>
              <dd style="margin-left: 1.5em" id="section-2.1.1.5-6.2">
                <p id="section-2.1.1.5-6.2.1">When there is more than one TPM supported, this container maintains the set of information related to the compute node associated with a specific TPM. This allows each specific TPM to identify to which 'compute-node' it belongs.<a href="#section-2.1.1.5-6.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
<div class="lang-yangtree sourcecode" id="section-2.1.1.5-7">
<pre>
+--rw compute-nodes {tpm:mtpm}?
   +--ro compute-node* [node-id]
      +--ro node-id                string
      +--ro node-physical-index?   int32 {hw:entity-mib}?
      +--ro node-name?             string
      +--ro node-location?         string
</pre><a href="#section-2.1.1.5-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="yang-module">
<section id="section-2.1.1.6">
            <h5 id="name-yang-module">
<a href="#section-2.1.1.6" class="section-number selfRef">2.1.1.6. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
            </h5>
<div id="ref-ietf-tpm-remote-attestation">
<figure id="figure-1">
              <div class="breakable lang-yang sourcecode" id="section-2.1.1.6-1.1">
<pre>&lt;CODE BEGINS&gt; file "ietf-tpm-remote-attestation@2024-12-05.yang"

module ietf-tpm-remote-attestation {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang"
          + ":ietf-tpm-remote-attestation";
  prefix tpm;

  import ietf-yang-types {
    prefix yang;
  }
  import ietf-hardware {
    prefix hw;
  }
  import ietf-keystore {
    prefix ks;
  }
  import ietf-tcg-algs {
    prefix taa;
  }

  organization
    "IETF RATS (Remote ATtestation procedureS) Working Group";
  contact
    "WG Web  : &lt;https://datatracker.ietf.org/wg/rats/&gt;
     WG List : &lt;mailto:rats@ietf.org&gt;
     Author  : Eric Voit &lt;evoit@cisco.com&gt;
     Author  : Henk Birkholz &lt;henk.birkholz@ietf.contact&gt;
     Author  : Michael Eckel &lt;michael.eckel@sit.fraunhofer.de&gt;
     Author  : Shwetha Bhandari &lt;shwetha.bhandari@thoughtspot.com&gt;
     Author  : Bill Sulzen &lt;bsulzen@cisco.com&gt;
     Author  : Liang Xia (Frank) &lt;frank.xialiang@huawei.com&gt;
     Author  : Tom Laffey &lt;tom.laffey@hpe.com&gt;
     Author  : Guy C. Fedorkow &lt;gfedorkow@juniper.net&gt;";
  description
    "A YANG module to enable remote attestation procedures based
     on TPM 1.2 and TPM 2.0 using a challenge-response
     interaction model and the Quote primitive operations defined
     by TPM 1.2 and TPM 2.0.

     The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL
     NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'NOT RECOMMENDED',
     'MAY', and 'OPTIONAL' in this document are to be interpreted as
     described in BCP 14 (RFC 2119) (RFC 8174) when, and only when,
     they appear in all capitals, as shown here.

     Copyright (c) 2024 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject to
     the license terms contained in, the Revised BSD License set
     forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 9684; see the
     RFC itself for full legal notices.";

  revision 2024-12-05 {
    description
      "Initial version";
    reference
      "RFC 9684: A YANG Data Model for Challenge-Response-Based
       Remote Attestation (CHARRA) Procedures Using Trusted Platform
       Modules (TPMs)";
  }

  /*****************/
  /*   Features    */
  /*****************/

  feature mtpm {
    description
      "The device supports the remote attestation of multiple
       TPM-based cryptoprocessors.";
  }

  feature bios {
    description
      "The device supports the BIOS logs.";
    reference
      "BIOS-Log:
       TCG PC Client Platform Firmware Profile Specification,
       https://trustedcomputinggroup.org/wp-content/uploads/
       TCG-PC-Client-Platform-Firmware-Profile-Version-1.06-
       Revision-52_pub-2.pdf, Section 10.4.5.2";
  }

  feature ima {
    description
      "The device supports Integrity Measurement Architecture logs.
       Many variants of IMA logs exist in the deployment.  Each
       encodes the log entry contents as the specific measurements
       that get hashed into a PCRs as Evidence.  See the reference
       below for one example of such an encoding.";
    reference
      "CEL:
       Canonical Event Log Format,
       https://www.trustedcomputinggroup.org/wp-content/uploads/
       TCG_IWG_CEL_v1_r0p41_pub.pdf, Section 5.1.6";
  }

  feature netequip_boot {
    description
      "The device supports the netequip_boot logs.";
    reference
      "RFC 9684: A YANG Data Model for Challenge-Response-Based
       Remote Attestation (CHARRA) Procedures Using Trusted Platform
       Modules (TPMs), Appendix B";
  }

  /*****************/
  /*   Typedefs    */
  /*****************/

  typedef pcr {
    type uint8 {
      range "0..31";
    }
    description
      "Valid index number for a PCR.  A PCR index compliant with
       TPM 2.0 extends from 0-31.  At this time, a typical TPM would
       have no more than 32 PCRs.";
  }

  typedef compute-node-ref {
    type leafref {
      path "/tpm:rats-support-structures/tpm:compute-nodes"
         + "/tpm:compute-node/tpm:node-id";
    }
    description
      "This type is used to reference a hardware node.  Note that an
       implementer might include an alternative leafref pointing to a
       different YANG module node specifying hardware structures.";
  }

  typedef certificate-name-ref {
    type leafref {
      path "/tpm:rats-support-structures/tpm:tpms/tpm:tpm"
         + "/tpm:certificates/tpm:certificate/tpm:name";
    }
    description
      "A type that allows identification of a TPM-based
       certificate.";
  }

  /******************/
  /*   Identities   */
  /******************/

  identity attested_event_log_type {
    description
      "Base identity allowing categorization of the reasons why an
       attested measurement has been taken on an Attester.";
  }

  identity ima {
    base attested_event_log_type;
    description
      "An event type recorded in IMA.";
  }

  identity bios {
    base attested_event_log_type;
    description
      "An event type associated with BIOS/UEFI.";
  }

  identity netequip_boot {
    base attested_event_log_type;
    description
      "An event type associated with Network Equipment Boot.";
  }

  /*****************/
  /*   Groupings   */
  /*****************/

  grouping tpm20-hash-algo {
    description
      "The cryptographic algorithm used to hash the PCRs compliant
       with TPM 2.0.  This must be from the list of platform-
       supported options.";
    leaf tpm20-hash-algo {
      type identityref {
        base taa:hash;
      }
      must '. = /tpm:rats-support-structures'
         + '/tpm:attester-supported-algos/tpm:tpm20-hash' {
        error-message "This platform does not support "
                    + "tpm20-hash-algo";
      }
      description
        "The hash scheme that is used to hash a PCR compliant with
         TPM 2.0.  This must be one of those supported by a platform.
         Where this object does not appear, the default value of
         'taa:TPM_ALG_SHA256' will apply.";
    }
  }

  grouping tpm12-hash-algo {
    description
      "The cryptographic algorithm used to hash the PCRs compliant
       with TPM 1.2.";
    leaf tpm12-hash-algo {
      type identityref {
        base taa:hash;
      }
      must '. = /tpm:rats-support-structures'
         + '/tpm:attester-supported-algos/tpm:tpm12-hash' {
        error-message "This platform does not support "
                    + "tpm12-hash-algo";
      }
      description
        "The hash scheme that is used to hash a PCR compliant with
         TPM 1.2.  This MUST be one of those supported by a platform.
         Where this object does not appear, the default value of
         'taa:TPM_ALG_SHA1' will apply.";
    }
  }

  grouping nonce {
    description
      "A random number intended to guarantee freshness and for use
       as part of a replay-detection mechanism.";
    leaf nonce-value {
      type binary;
      mandatory true;
      description
        "A cryptographically generated random number that should
         not be predictable prior to its issuance from a random
         number generation function.  The random number MUST be
         derived from an entropy source external to the Attester.

         Note that a nonce sent into a TPM will typically be 160 or
         256 binary digits long.  (This is 20 or 32 bytes.)  So if
         fewer binary digits are sent, this nonce object will be
         padded with leading zeros within Quotes returned from the
         TPM.  Additionally, if more bytes are sent, the nonce will
         be trimmed to the most significant binary digits.";
    }
  }

  grouping tpm12-pcr-selection {
    description
      "A Verifier can request one or more PCR values using its
       individually created Attestation Key Certificate (AC).
       The corresponding selection filter is represented in this
       grouping.";
    leaf-list pcr-index {
      type pcr;
      description
        "The numbers/indexes of the PCRs.  In addition, any selection
         of PCRs MUST verify that the set of PCRs requested are a
         subset of the set of PCRs exposed in the leaf-list
         /tpm:rats-support-structures
         /tpm:tpms/tpm:tpm[name=current()]/tpm:tpm12-pcrs";
    }
  }

  grouping tpm20-pcr-selection {
    description
      "A Verifier can acquire one or more PCR values, which are
       hashed together in a TPM2B_DIGEST coming from the TPM2.
       The selection list of desired PCRs and the hash algorithm
       is represented in this grouping.";
    list tpm20-pcr-selection {
      unique "tpm20-hash-algo";
      description
        "Specifies the list of PCRs and hash algorithms that can be
         returned within a TPM2B_DIGEST.";
      reference
        "TPM2.0-Structures:
         Trusted Platform Module Library Part 2:  Structures,
         Revision 01.83, https://trustedcomputinggroup.org/
         wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
         Section 10.9.7";
      uses tpm20-hash-algo;
      leaf-list pcr-index {
        type pcr;
        description
          "The numbers of the PCRs that are being tracked
           with a hash based on the tpm20-hash-algo.  In addition,
           any selection of PCRs MUST verify that the set of PCRs
           requested are a subset of the set of selected PCR indexes
           available for that specific TPM.";
      }
    }
  }

  grouping certificate-name-ref {
    description
      "Identifies a certificate in a keystore.";
    leaf certificate-name {
      type certificate-name-ref;
      mandatory true;
      description
        "Identifies a certificate in a keystore.";
    }
  }

  grouping tpm-name {
    description
      "A unique TPM on a device.";
    leaf name {
      type string;
      description
        "Unique system-generated name for a TPM on a device.";
    }
  }

  grouping node-uptime {
    description
      "Uptime in seconds of the node.";
    leaf up-time {
      type uint32;
      description
        "Uptime in seconds of this node reporting its data.";
    }
  }

  grouping tpm12-attestation {
    description
      "Contains an instance of cryptoprocessor measurements signed
       according to TPM 1.2.  It is supplemented by unsigned
       Attester information.";
    uses node-uptime;
    leaf pcr-data {
      type binary;
      description
        "The value created and signed for the quote
         (type TPM_PCR_INFO_SHORT), i.e., the 'pcrData' part of
          a TPM1.2 Quote2 operation result.";
      reference
        "TPM1.2-Commands:
         TPM Main Part 3 Commands, Rev116,
         https://trustedcomputinggroup.org/wp-content/uploads
         /TPM-Main-Part-3-Commands_v1.2_rev116_01032011.pdf,
         Section 16.5";
    }
    leaf version-info {
      type binary;
      description
        "The version info (type TPM_CAP_VERSION_INFO),
         i.e., the 'versionInfo' part of a TPM1.2 Quote2
         operation result.";
      reference
        "TPM1.2-Commands:
         TPM Main Part 3 Commands, Rev116,
         https://trustedcomputinggroup.org/wp-content/uploads
         /TPM-Main-Part-3-Commands_v1.2_rev116_01032011.pdf,
         Section 16.5";
    }
    leaf sig {
      type binary;
      description
        "The signature generated across the signed data,
         i.e., the 'sig' part of a TPM1.2 Quote2 operation
         result.";
      reference
        "TPM1.2-Commands:
         TPM Main Part 3 Commands, Rev116,
         https://trustedcomputinggroup.org/wp-content/uploads
         /TPM-Main-Part-3-Commands_v1.2_rev116_01032011.pdf,
         Section 16.5";
    }
  }

  grouping tpm20-attestation {
    description
      "Contains an instance of cryptoprocessor measurements signed
       according to TPM 2.0.  It is supplemented by unsigned
       Attester information.";
    leaf quote-data {
      type binary;
      mandatory true;
      description
        "A hash of the latest PCR values (and the hash algorithm
         used) that have been returned from an Attester for the
         selected PCRs and hash algorithms.";
      reference
        "TPM2.0-Structures:
         Trusted Platform Module Library Part 2:  Structures,
         Revision 01.83, https://trustedcomputinggroup.org/
         wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
         Section 10.12.1";
    }
    leaf quote-signature {
      type binary;
      description
        "Quote signature returned by TPM Quote.  The signature was
         generated using the key associated with the
         certificate 'name'.";
      reference
        "TPM2.0-Structures:
         Trusted Platform Module Library Part 2:  Structures,
         Revision 01.83, https://trustedcomputinggroup.org/
         wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
         Section 11.2.1";
    }
    uses node-uptime;
    list unsigned-pcr-values {
      description
        "PCR values in each PCR bank.  This might appear redundant
         with the TPM2B_DIGEST, but that digest is calculated across
         multiple PCRs.  Having to verify across multiple PCRs does
         not necessarily make it easy for a Verifier to appraise just
         the minimum set of PCR information that has changed since
         the last received TPM2B_DIGEST.  Put another way, why should
         a Verifier reconstruct the proper value of all PCR Quotes
         when only a single PCR has changed?
         To help this happen, if the Attester does know specific PCR
         values, the Attester can provide these individual values via
         'unsigned-pcr-values'.  By comparing this information to
         what has previously been validated, it is possible for a
         Verifier to confirm the Attester's signature while
         eliminating significant processing.  Note that there should
         never be a result where an unsigned PCR value differs from
         what may be reconstructed from within the PCR quote and
         the event logs.
         If there is a difference, a signed result that has been
         verified from retrieved logs is considered definitive.";
      uses tpm20-hash-algo;
      list pcr-values {
        key "pcr-index";
        description
          "List of one PCR bank.";
        leaf pcr-index {
          type pcr;
          description
            "PCR index number.";
        }
        leaf pcr-value {
          type binary;
          description
            "PCR value.";
          reference
            "TPM2.0-Structures:
             Trusted Platform Module Library Part 2:  Structures,
             Revision 01.83, https://trustedcomputinggroup.org/
             wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
             Section 10.9.7";
        }
      }
    }
  }

  grouping log-identifier {
    description
      "Identifier for type of log to be retrieved.";
    leaf log-type {
      type identityref {
        base attested_event_log_type;
      }
      mandatory true;
      description
        "The corresponding identity of the measurement log type.";
    }
  }

  grouping boot-event-log {
    description
      "Defines a specific instance of an event log entry
       and corresponding to the information used to
       extend the PCR.";
    leaf event-number {
      type uint32;
      description
        "Unique event number of this event, which monotonically
         increases within a given event log.  The maximum event
         number should not be reached, nor is wrapping back to
         an earlier number supported.";
    }
    leaf event-type {
      type uint32;
      description
        "BIOS log event type.";
      reference
        "BIOS-Log:
         TCG PC Client Platform Firmware Profile Specification,
         https://trustedcomputinggroup.org/wp-content/uploads/
         TCG-PC-Client-Platform-Firmware-Profile-Version-1.06-
         Revision-52_pub-2.pdf, Section 10.4.1";
    }
    leaf pcr-index {
      type pcr;
      description
        "Defines the PCR index that this event extended.";
    }
    list digest-list {
      description
        "Hash of event data.";
      leaf hash-algo {
        type identityref {
          base taa:hash;
        }
        description
          "The hash scheme that is used to compress the event data in
           each of the leaf-list digest items.";
      }
      leaf-list digest {
        type binary;
        description
          "The hash of the event data using the algorithm of the
           'hash-algo' against 'event data'.";
      }
    }
    leaf event-size {
      type uint32;
      description
        "Size of the event data.";
    }
    leaf-list event-data {
      type binary;
      description
        "The event data.  This is a binary structure
         of size 'event-size'. For more on what
         might be recorded within this object
         see BIOS-Log, Section 10, which details
         viable events that might be recorded.";
      reference
        "BIOS-Log:
         TCG PC Client Platform Firmware Profile Specification,
         https://trustedcomputinggroup.org/wp-content/uploads/
         TCG-PC-Client-Platform-Firmware-Profile-Version-1.06-
         Revision-52_pub-2.pdf, Section 10";
    }
  }

  grouping bios-event-log {
    description
      "Measurement log created by the BIOS/UEFI.";
    list bios-event-entry {
      key "event-number";
      description
        "Ordered list of the TCG-described event log
         that extended the PCRs in the order they
         were logged.";
      uses boot-event-log;
    }
  }

  grouping ima-event {
    description
      "Defines a hash log extend event for IMA measurements.";
    reference
      "CEL:
       Canonical Event Log Format,
       https://www.trustedcomputinggroup.org/wp-content/uploads/
       TCG_IWG_CEL_v1_r0p41_pub.pdf, Section 4.3";
    leaf event-number {
      type uint64;
      description
        "Unique event number of this event, which monotonically
         increases.  The maximum event number should not be
         reached, nor is wrapping back to an earlier number
         supported.";
    }
    leaf ima-template {
      type string;
      description
        "Name of the template used for event logs,
         e.g., ima, ima-ng, ima-sig.";
    }
    leaf filename-hint {
      type string;
      description
        "File name (including the path) that was measured.";
    }
    leaf filedata-hash {
      type binary;
      description
        "Hash of filedata as updated based upon the
         filedata-hash-algorithm.";
    }
    leaf filedata-hash-algorithm {
      type string;
      description
        "Algorithm used for filedata-hash.";
    }
    leaf template-hash-algorithm {
      type string;
      description
        "Algorithm used for template-hash.";
    }
    leaf template-hash {
      type binary;
      description
        "hash(filedata-hash, filename-hint)";
    }
    leaf pcr-index {
      type pcr;
      description
        "Defines the PCR index that this event extended.";
    }
    leaf signature {
      type binary;
      description
        "Digital file signature that provides a
         fingerprint for the file being measured.";
    }
  }

  grouping ima-event-log {
    description
      "Measurement log created by IMA.";
    list ima-event-entry {
      key "event-number";
      description
        "Ordered list of IMA event logs by event-number.";
      uses ima-event;
    }
  }

  grouping network-equipment-boot-event-log {
    description
      "Measurement log created by Network Equipment Boot.  The
       Network Equipment Boot format is identical to the IMA
       format.  In contrast to the IMA log, the Network Equipment
       Boot log includes every measurable event from an Attester,
       including the boot stages of BIOS, Bootloader, etc. In
       essence, the scope of events represented in this format
       combines the scope of BIOS events and IMA events.";
    list boot-event-entry {
      key "event-number";
      description
        "Ordered list of Network Equipment Boot event logs
         by event-number, using the IMA event format.";
      uses ima-event;
    }
  }

  grouping event-logs {
    description
      "A selector for the log and its type.";
    choice attested_event_log_type {
      mandatory true;
      description
        "Event log type determines the event log's content.";
      case bios {
        if-feature "bios";
        description
          "BIOS/UEFI event logs.";
        container bios-event-logs {
          description
            "BIOS/UEFI event logs.";
          uses bios-event-log;
        }
      }
      case ima {
        if-feature "ima";
        description
          "IMA event logs.";
        container ima-event-logs {
          description
            "IMA event logs.";
          uses ima-event-log;
        }
      }
      case netequip_boot {
        if-feature "netequip_boot";
        description
          "Network Equipment Boot event logs.";
        container boot-event-logs {
          description
            "Network Equipment Boot event logs.";
          uses network-equipment-boot-event-log;
        }
      }
    }
  }

  /**********************/
  /*   RPC operations   */
  /**********************/

  rpc tpm12-challenge-response-attestation {
    if-feature "taa:tpm12";
    description
      "This RPC accepts the input for TSS TPM 1.2 commands made to
       the attesting device.";
    input {
      container tpm12-attestation-challenge {
        description
          "This container includes every information element defined
           in the reference challenge-response interaction model for
           remote attestation.  Corresponding values are based on
           TPM 1.2 structure definitions";
        uses tpm12-pcr-selection;
        uses nonce;
        leaf-list certificate-name {
          if-feature "tpm:mtpm";
          type certificate-name-ref;
          must "/tpm:rats-support-structures/tpm:tpms"
             + "/tpm:tpm[tpm:firmware-version='taa:tpm12']"
             + "/tpm:certificates/"
             + "/tpm:certificate[name=current()]" {
            error-message "Not an available TPM1.2 AIK certificate.";
          }
          description
            "When populated, the RPC will only get a Quote for the
             TPMs associated with these certificate(s).";
        }
      }
    }
    output {
      list tpm12-attestation-response {
        unique "certificate-name";
        description
          "The binary output of TPM 1.2 TPM_Quote/TPM_Quote2,
           including the PCR selection and other associated
           attestation evidence metadata.";
        uses certificate-name-ref {
          description
            "Certificate associated with this tpm12-attestation.";
        }
        uses tpm12-attestation;
      }
    }
  }

  rpc tpm20-challenge-response-attestation {
    if-feature "taa:tpm20";
    description
      "This RPC accepts the input for TSS TPM 2.0 commands of the
       managed device.  Composite devices may contain several TPMs;
       /hardware/component/physical-index from the hardware
       management YANG module is used to refer to dedicated TPMs in
       composite devices; however, devices without TPMs are not
       covered.";
    input {
      container tpm20-attestation-challenge {
        description
          "This container includes every information element defined
           in the reference challenge-response interaction model for
           remote attestation.  Corresponding values are based on
           TPM 2.0 structure definitions.";
        uses nonce;
        uses tpm20-pcr-selection;
        leaf-list certificate-name {
          if-feature "tpm:mtpm";
          type certificate-name-ref;
          must "/tpm:rats-support-structures/tpm:tpms"
             + "/tpm:tpm[tpm:firmware-version='taa:tpm20']"
             + "/tpm:certificates/"
             + "/tpm:certificate[name=current()]" {
            error-message "Not an available TPM2.0 AIK certificate.";
          }
          description
            "When populated, the RPC will only get a Quote for the
             TPMs associated with the certificates.";
        }
      }
    }
    output {
      list tpm20-attestation-response {
        unique "certificate-name";
        description
          "The binary output of TPM2_Quote from one TPM of the
           node which is identified by node-id:  an attestation
           structure (TPMS_ATTEST), including a length, and a
           signature (TPMT_SIGNATURE) over that structure.";
        reference
          "TPM2.0-Structures:
           Trusted Platform Module Library Part 2:  Structures,
           Revision 01.83, https://trustedcomputinggroup.org/
           wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
           Section 10.12.12";
        uses certificate-name-ref {
          description
            "Certificate associated with this tpm20-attestation.";
        }
        uses tpm20-attestation;
      }
    }
  }

  rpc log-retrieval {
    description
      "Log entries are identified either via indices or by providing
       the last line received.  The number of lines returned can be
       limited.  The type of log is a choice that can be augmented.";
    input {
      uses log-identifier;
      list log-selector {
        description
          "Only log entries that meet all of the provided selection
           criteria are to be returned by the RPC output.";
        leaf-list name {
          type string;
          description
            "Name of one or more unique TPMs on a device.  If this
             object exists, a selection should pull only the objects
             related to these TPM(s).  If it does not exist, all
             qualifying TPMs that are 'hardware-based' equals true
             on the device are selected.  When this selection
             criteria is provided, it will be considered as a logical
             AND with any other selection criteria provided.";
        }
        choice index-type {
          description
            "Last log entry received, log index number, or
             timestamp.";
          case last-entry {
            description
              "The last entry of the log already retrieved.";
            leaf last-entry-value {
              type binary;
              description
                "Content of a log event that matches 1:1 with a
                 unique event record contained within the log.  Log
                 entries after this will be passed to the
                 requester.  Note: if log entry values are not
                 unique, this MUST return an error.";
            }
          }
          case index {
            description
              "Numeric index of the last log entry retrieved, or
               zero.";
            leaf last-index-number {
              type uint64;
              description
                "The last numeric index number of a log entry.
                 Zero means to start at the beginning of the log.
                 Entries after this will be passed to the
                 requester.";
            }
          }
          case timestamp {
            leaf timestamp {
              type yang:date-and-time;
              description
                "Timestamp from which to start the extraction.  The
                 next log entry after this timestamp is to
                 be sent.";
            }
            description
              "Timestamp from which to start the extraction.";
          }
        }
        leaf log-entry-quantity {
          type uint16;
          description
            "The number of log entries to be returned. If omitted, it
             means all of them.";
        }
      }
    }
    output {
      container system-event-logs {
        description
          "The requested data of the measurement event logs.";
        list node-data {
          unique "name";
          description
            "Event logs of a node in a distributed system
             identified by the node name.";
          uses tpm-name;
          uses node-uptime;
          container log-result {
            description
              "The requested entries of the corresponding log.";
            uses event-logs;
          }
        }
      }
    }
  }

  /****************************************/
  /*   Config and Oper accessible nodes   */
  /****************************************/

  container rats-support-structures {
    description
      "The datastore definition enabling Verifiers or Relying
       Parties to discover the information necessary to use the
       remote attestation RPCs appropriately.";
    container compute-nodes {
      if-feature "tpm:mtpm";
      description
        "Holds the set of device subsystems/components in this
         composite device that support TPM operations.";
      list compute-node {
        key "node-id";
        unique "node-name";
        config false;
        min-elements 2;
        description
          "A component within this composite device that
           supports TPM operations.";
        leaf node-id {
          type string;
          description
            "ID of the compute node, such as Board Serial Number.";
        }
        leaf node-physical-index {
          if-feature "hw:entity-mib";
          type int32 {
            range "1..2147483647";
          }
          config false;
          description
            "The entPhysicalIndex for the compute node.";
          reference
            "RFC 6933: Entity MIB (Version 4) - entPhysicalIndex";
        }
        leaf node-name {
          type string;
          description
            "Name of the compute node.";
        }
        leaf node-location {
          type string;
          description
            "Location of the compute node, such as slot number.";
        }
      }
    }
    container tpms {
      description
        "Holds the set of TPMs within an Attester.";
      list tpm {
        key "name";
        unique "path";
        description
          "A list of TPMs in this composite device that RATS
           can be conducted with.";
        uses tpm-name;
        leaf hardware-based {
          type boolean;
          config false;
          mandatory true;
          description
            "System-generated indication of whether this is a
             hardware-based TPM.";
        }
        leaf physical-index {
          if-feature "hw:entity-mib";
          type int32 {
            range "1..2147483647";
          }
          config false;
          description
            "The entPhysicalIndex for the TPM.";
          reference
            "RFC 6933: Entity MIB (Version 4) - entPhysicalIndex";
        }
        leaf path {
          type string;
          config false;
          description
            "Device path to a unique TPM on a device.  This can
             change across reboots.";
        }
        leaf compute-node {
          if-feature "tpm:mtpm";
          type compute-node-ref;
          config false;
          mandatory true;
          description
            "Indicates the compute node measured by this TPM.";
        }
        leaf manufacturer {
          type string;
          config false;
          description
            "TPM manufacturer name.";
        }
        leaf firmware-version {
          type identityref {
            base taa:cryptoprocessor;
          }
          mandatory true;
          description
            "Identifies the cryptoprocessor API set supported.  This
             is automatically configured by the device and should not
             be changed.";
        }
        uses tpm12-hash-algo {
          when "derived-from-or-self(firmware-version, 'taa:tpm12')";
          if-feature "taa:tpm12";
          refine "tpm12-hash-algo" {
            description
              "The hash algorithm overwrites the default used for
               PCRs on this TPM1.2-compliant cryptoprocessor.";
          }
        }
        leaf-list tpm12-pcrs {
          when "derived-from-or-self(../firmware-version, "
             + "'taa:tpm12')";
          if-feature "taa:tpm12";
          type pcr;
          description
            "The PCRs that may be extracted from this TPM1.2-
             compliant cryptoprocessor.";
        }
        list tpm20-pcr-bank {
          when "derived-from-or-self(../firmware-version, "
             + "'taa:tpm20')";
          if-feature "taa:tpm20";
          key "tpm20-hash-algo";
          description
            "Specifies the list of PCRs that may be extracted for
             a specific hash algorithm on this TPM2-compliant
             cryptoprocessor.  A bank is a set of PCRs that are
             extended using a particular hash algorithm.";
          reference
            "TPM2.0-Structures:
             Trusted Platform Module Library Part 2:  Structures,
             Revision 01.83, https://trustedcomputinggroup.org/
             wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf,
             Section 10.9.7";
          leaf tpm20-hash-algo {
            type identityref {
              base taa:hash;
            }
            must '/tpm:rats-support-structures'
               + '/tpm:attester-supported-algos'
               + '/tpm:tpm20-hash' {
              error-message "This platform does not support "
                          + "tpm20-hash-algo";
            }
            description
              "The hash scheme actively being used to hash
               one or more TPM2.0 PCRs.";
          }
          leaf-list pcr-index {
            type tpm:pcr;
            description
              "Defines which TPM2.0 PCRs are available to be
               extracted.";
          }
        }
        leaf status {
          type enumeration {
            enum operational {
              value 0;
              description
                "The TPM currently is running normally and
                 is ready to accept and process TPM quotes.";
              reference
                "TPM2.0-Arch: Trusted Platform Module Library
                 Part 1:  Architecture,
                 https://trustedcomputinggroup.org/wp-content/
                 uploads/TPM-2.0-1.83-Part-1-Architecture.pdf,
                 Section 12";
            }
            enum non-operational {
              value 1;
              description
                "TPM is in a state such as startup or shutdown, which
                 precludes the processing of TPM quotes.";
            }
          }
          config false;
          mandatory true;
          description
            "TPM chip self-test status.";
        }
        container certificates {
          description
            "The TPM's certificates, including EK Certificates
             and Attestation Key Certificates.";
          list certificate {
            key "name";
            description
              "Three types of certificates can be accessed via
               this statement, including Initial Attestation
               Key Certificate, Local Attestation Key Certificate, or
               Endorsement Key Certificate.";
            leaf name {
              type string;
              description
                "An arbitrary name uniquely identifying a certificate
                 associated with a key within a TPM.";
            }
            leaf keystore-ref {
              if-feature "ks:central-keystore-supported";
              if-feature "ks:asymmetric-keys";
              type leafref {
                path "/ks:keystore/ks:asymmetric-keys"
                   + "/ks:asymmetric-key/ks:name";
              }
              description
                "A reference to a specific certificate of an
                 asymmetric key in the keystore.";
            }
            leaf type {
              type enumeration {
                enum endorsement-certificate {
                  value 0;
                  description
                    "Endorsement Key (EK) Certificate type.";
                  reference
                    "TPM2.0-Key:
                     TPM 2.0 Keys for Device Identity and Attestation
                     https://trustedcomputinggroup.org/wp-content/
                     uploads/TPM-2p0-Keys-for-Device-Identity-
                     and-Attestation_v1_r12_pub10082021.pdf,
                     Section 3.11";
                }
                enum initial-attestation-certificate {
                  value 1;
                  description
                    "Initial Attestation Key (IAK) Certificate
                     type.";
                  reference
                    "TPM2.0-Key:
                     TPM 2.0 Keys for Device Identity and Attestation
                     https://trustedcomputinggroup.org/wp-content/
                     uploads/TPM-2p0-Keys-for-Device-Identity-
                     and-Attestation_v1_r12_pub10082021.pdf,
                     Section 3.2";
                }
                enum local-attestation-certificate {
                  value 2;
                  description
                    "Local Attestation Key (LAK) Certificate type.";
                  reference
                    "TPM2.0-Key:
                     TPM 2.0 Keys for Device Identity and Attestation
                     https://trustedcomputinggroup.org/wp-content/
                     uploads/TPM-2p0-Keys-for-Device-Identity-
                     and-Attestation_v1_r12_pub10082021.pdf,
                     Section 3.2";
                }
              }
              description
                "Function supported by this certificate from within
                 the TPM.";
            }
          }
        }
      }
    }
    container attester-supported-algos {
      description
        "Identifies which TPM algorithms are available for use on an
         attesting platform.";
      leaf-list tpm12-asymmetric-signing {
        when "../../tpm:tpms"
           + "/tpm:tpm[tpm:firmware-version='taa:tpm12']";
        if-feature "taa:tpm12";
        type identityref {
          base taa:asymmetric;
        }
        description
          "Platform-supported TPM1.2 asymmetric algorithms.";
      }
      leaf-list tpm12-hash {
        when "../../tpm:tpms"
           + "/tpm:tpm[tpm:firmware-version='taa:tpm12']";
        if-feature "taa:tpm12";
        type identityref {
          base taa:hash;
        }
        description
          "Platform-supported TPM1.2 hash algorithms.";
      }
      leaf-list tpm20-asymmetric-signing {
        when "../../tpm:tpms"
           + "/tpm:tpm[tpm:firmware-version='taa:tpm20']";
        if-feature "taa:tpm20";
        type identityref {
          base taa:asymmetric;
        }
        description
          "Platform-supported TPM2.0 asymmetric algorithms.";
      }
      leaf-list tpm20-hash {
        when "../../tpm:tpms"
           + "/tpm:tpm[tpm:firmware-version='taa:tpm20']";
        if-feature "taa:tpm20";
        type identityref {
          base taa:hash;
        }
        description
          "Platform-supported TPM2.0 hash algorithms.";
      }
    }
  }
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="ietf-tcg-algs">
<section id="section-2.1.2">
          <h4 id="name-ietf-tcg-algs">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-ietf-tcg-algs" class="section-name selfRef">ietf-tcg-algs</a>
          </h4>
<p id="section-2.1.2-1">This document has encoded the TCG Algorithm definitions of Table 3 of <span>[<a href="#TCG-Algos" class="cite xref">TCG-Algos</a>]</span>, revision 1.32. By including this full table as a separate YANG file within this document, it is possible for other YANG modules to leverage the contents of this module.  Specific references to <span>[<a href="#TPM1.2-Structures" class="cite xref">TPM1.2-Structures</a>]</span>, <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span>, <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span>, <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>, <span>[<a href="#ISO-IEC-9797-1" class="cite xref">ISO-IEC-9797-1</a>]</span>, <span>[<a href="#ISO-IEC-9797-2" class="cite xref">ISO-IEC-9797-2</a>]</span>, <span>[<a href="#ISO-IEC-10116" class="cite xref">ISO-IEC-10116</a>]</span>, <span>[<a href="#ISO-IEC-10118-3" class="cite xref">ISO-IEC-10118-3</a>]</span>, <span>[<a href="#ISO-IEC-14888-3" class="cite xref">ISO-IEC-14888-3</a>]</span>, <span>[<a href="#ISO-IEC-15946-1" class="cite xref">ISO-IEC-15946-1</a>]</span>, <span>[<a href="#ISO-IEC-18033-3" class="cite xref">ISO-IEC-18033-3</a>]</span>, <span>[<a href="#IEEE-Std-1363-2000" class="cite xref">IEEE-Std-1363-2000</a>]</span>, <span>[<a href="#IEEE-Std-1363a-2004" class="cite xref">IEEE-Std-1363a-2004</a>]</span>, <span>[<a href="#NIST-FIPS-202" class="cite xref">NIST-FIPS-202</a>]</span>, <span>[<a href="#NIST-SP800-38C" class="cite xref">NIST-SP800-38C</a>]</span>, <span>[<a href="#NIST-SP800-38D" class="cite xref">NIST-SP800-38D</a>]</span>, <span>[<a href="#NIST-SP800-38F" class="cite xref">NIST-SP800-38F</a>]</span>, <span>[<a href="#NIST-SP800-56A" class="cite xref">NIST-SP800-56A</a>]</span>, and <span>[<a href="#NIST-SP800-108" class="cite xref">NIST-SP800-108</a>]</span> exist within the YANG module.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<div id="features-1">
<section id="section-2.1.2.1">
            <h5 id="name-features-2">
<a href="#section-2.1.2.1" class="section-number selfRef">2.1.2.1. </a><a href="#name-features-2" class="section-name selfRef">Features</a>
            </h5>
<p id="section-2.1.2.1-1">There are two types of features supported: 'tpm12' and 'tpm20'. Support for either of these features indicates that a cryptoprocessor supporting the corresponding type of TCG TPM API is present on an Attester. Most commonly, only one type of cryptoprocessor will be available on an Attester.<a href="#section-2.1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identities-1">
<section id="section-2.1.2.2">
            <h5 id="name-identities-2">
<a href="#section-2.1.2.2" class="section-number selfRef">2.1.2.2. </a><a href="#name-identities-2" class="section-name selfRef">Identities</a>
            </h5>
<p id="section-2.1.2.2-1">There are three types of identities in this model:<a href="#section-2.1.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1.2.2-2">
              <li id="section-2.1.2.2-2.1">Cryptographic functions supported by a TPM algorithm; these include 'asymmetric', 'symmetric', 'hash', 'signing', 'anonymous_signing', 'encryption_mode', 'method', and 'object_type'. The definitions of each of these are in Table 2 of <span>[<a href="#TCG-Algos" class="cite xref">TCG-Algos</a>]</span>.<a href="#section-2.1.2.2-2.1" class="pilcrow">¶</a>
</li>
              <li id="section-2.1.2.2-2.2">API specifications for TPM types: 'tpm12' and 'tpm20'<a href="#section-2.1.2.2-2.2" class="pilcrow">¶</a>
</li>
              <li id="section-2.1.2.2-2.3">Specific algorithm types: Each algorithm type defines which cryptographic functions may be supported, and on which type of API specification. It is not required that an implementation of a specific TPM will support all algorithm types. The contents of each specific algorithm mirrors the contents of Table 3 of <span>[<a href="#TCG-Algos" class="cite xref">TCG-Algos</a>]</span>.<a href="#section-2.1.2.2-2.3" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
<div id="ref-ietf-tcg-algs">
<section id="section-2.1.2.3">
            <h5 id="name-yang-module-2">
<a href="#section-2.1.2.3" class="section-number selfRef">2.1.2.3. </a><a href="#name-yang-module-2" class="section-name selfRef">YANG Module</a>
            </h5>
<div class="breakable lang-yang sourcecode" id="section-2.1.2.3-1">
<pre>&lt;CODE BEGINS&gt; file "ietf-tcg-algs@2024-12-05.yang"

module ietf-tcg-algs {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-tcg-algs";
  prefix taa;

  organization
    "IETF RATS (Remote ATtestation procedureS) Working Group";
  contact
    "WG Web:   &lt;https://datatracker.ietf.org/wg/rats/&gt;
     WG List:  &lt;mailto:rats@ietf.org&gt;
     Author:   Eric Voit &lt;mailto:evoit@cisco.com&gt;";
  description
    "This module defines identities for asymmetric algorithms.

     The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL
     NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'NOT RECOMMENDED',
     'MAY', and 'OPTIONAL' in this document are to be interpreted as
     described in BCP 14 (RFC 2119) (RFC 8174) when, and only when,
     they appear in all capitals, as shown here.

     Copyright (c) 2024 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject to
     the license terms contained in, the Revised BSD License set
     forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 9684; see the
     RFC itself for full legal notices.";

  revision 2024-12-05 {
    description
      "Initial version";
    reference
      "RFC 9684: A YANG Data Model for Challenge-Response-Based
       Remote Attestation (CHARRA) Procedures Using Trusted Platform
       Modules (TPMs)";
  }

  /*****************/
  /*   Features    */
  /*****************/

  feature tpm12 {
    description
      "This feature indicates algorithm support for the TPM 1.2 API
       per Section 4.8 of TPM1.2-Structures.";
    reference
      "TPM1.2-Structures: TPM Main Part 2 TPM Structures,
       https://trustedcomputinggroup.org/wp-content/uploads/
       TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf
       TPM_ALGORITHM_ID values, Section 4.8";
  }

  feature tpm20 {
    description
      "This feature indicates algorithm support for the TPM 2.0 API
       per Section 11.4 of Trusted Platform Module Library Part 1:
       Architecture.";
    reference
      "TPM2.0-Arch: Trusted Platform Module Library Part 1:
       Architecture, https://trustedcomputinggroup.org/wp-content/
       uploads/TPM-2.0-1.83-Part-1-Architecture.pdf, Section 11.4";
  }

  /*****************/
  /*  Identities   */
  /*****************/

  identity asymmetric {
    description
      "A TCG-recognized asymmetric algorithm with a public and
       private key.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2,
       https://trustedcomputinggroup.org/resource/
       tcg-algorithm-registry/TCG-_Algorithm_Registry_r1p32_pub";
  }

  identity symmetric {
    description
      "A TCG-recognized symmetric algorithm with only a private
       key.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity hash {
    description
      "A TCG-recognized hash algorithm that compresses input data to
       a digest value or indicates a method that uses a hash.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity signing {
    description
      "A TCG-recognized signing algorithm";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity anonymous_signing {
    description
      "A TCG-recognized anonymous signing algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity encryption_mode {
    description
      "A TCG-recognized encryption mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity method {
    description
      "A TCG-recognized method such as a mask generation function.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity object_type {
    description
      "A TCG-recognized object type.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 2";
  }

  identity cryptoprocessor {
    description
      "Base identity identifying a crytoprocessor.";
  }

  identity tpm12 {
    if-feature "tpm12";
    base cryptoprocessor;
    description
      "Supportable by a TPM 1.2.";
    reference
      "TPM1.2-Structures:
       TPM Main Part 2 TPM Structures,
       https://trustedcomputinggroup.org/wp-content/uploads/
       TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf
       TPM_ALGORITHM_ID values, Section 4.8";
  }

  identity tpm20 {
    if-feature "tpm20";
    base cryptoprocessor;
    description
      "Supportable by a TPM 2.0";
    reference
      "TPM2.0-Structures:
       Trusted Platform Module Library Part 2:  Structures,
       Revision 01.83, https://trustedcomputinggroup.org/
       wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf";
  }

  identity TPM_ALG_RSA {
    if-feature "tpm12 or tpm20";
    base tpm12;
    base tpm20;
    base asymmetric;
    base object_type;
    description
      "RSA algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8017. ALG_ID: 0x0001";
  }

  identity TPM_ALG_TDES {
    if-feature "tpm12";
    base tpm12;
    base symmetric;
    description
      "Block cipher with various key sizes (Triple Data Encryption
       Algorithm, commonly called Triple Data Encryption Standard)
       Note: Was banned in TPM 1.2, v94";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 18033-3. ALG_ID: 0x0003";
  }

  identity TPM_ALG_SHA1 {
    if-feature "tpm12 or tpm20";
    base hash;
    base tpm12;
    base tpm20;
    description
      "SHA1 algorithm - Deprecated due to insufficient cryptographic
       protection.  However, it is still useful for hash algorithms
       where protection is not required.";
    reference
      "TCG-Algos: TCG Algorithm Registry Rev1.34, Table 3, and
       ISO/IEC 10118-3. ALG_ID: 0x0004";
  }

  identity TPM_ALG_HMAC {
    if-feature "tpm12 or tpm20";
    base tpm12;
    base tpm20;
    base hash;
    base signing;
    description
      "Hash Message Authentication Code (HMAC) algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 9797-2, and
       RFC 2104. ALG_ID: 0x0005";
  }

  identity TPM_ALG_AES {
    if-feature "tpm12";
    base tpm12;
    base symmetric;
    description
      "The AES algorithm with various key sizes.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 18033-3. ALG_ID: 0x0006";
  }

  identity TPM_ALG_MGF1 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    base method;
    description
      "Hash-based mask-generation function.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       IEEE Std 1363-2000, and
       IEEE Std 1363a-2004.
       ALG_ID: 0x0007";
  }

  identity TPM_ALG_KEYEDHASH {
    if-feature "tpm20";
    base tpm20;
    base hash;
    base object_type;
    description
      "An encryption or signing algorithm using a keyed hash.  These
       may use XOR for encryption or an HMAC for signing and may
       also refer to a data object that is neither signing nor
       encrypting.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x0008";
  }

  identity TPM_ALG_XOR {
    if-feature "tpm12 or tpm20";
    base tpm12;
    base tpm20;
    base hash;
    base symmetric;
    description
      "The XOR encryption algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x000A";
  }

  identity TPM_ALG_SHA256 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The SHA-256 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10118-3. ALG_ID: 0x000B";
  }

  identity TPM_ALG_SHA384 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The SHA-384 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10118-3. ALG_ID: 0x000C";
  }

  identity TPM_ALG_SHA512 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The SHA-512 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10118-3. ALG_ID: 0x000D";
  }

  identity TPM_ALG_NULL {
    if-feature "tpm20";
    base tpm20;
    description
      "Null algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x0010";
  }

  identity TPM_ALG_SM3_256 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The ShangMi 3 (SM3) hash algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10118-3:2018. ALG_ID: 0x0012";
  }

  identity TPM_ALG_SM4 {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    description
      "ShangMi 4 (SM4) symmetric block cipher.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x0013";
  }

  identity TPM_ALG_RSASSA {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    description
      "Signature algorithm defined in Section 8.2
       (RSASSA-PKCS1-v1_5) of RFC 8017.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8017.  ALG_ID: 0x0014";
  }

  identity TPM_ALG_RSAES {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base encryption_mode;
    description
      "Signature algorithm defined in Section 7.2
       (RSAES-PKCS1-v1_5) of RFC 8017.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8017. ALG_ID: 0x0015";
  }

  identity TPM_ALG_RSAPSS {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    description
      "Padding algorithm defined in Section 8.1 (RSASSA-PSS)
       of RFC 8017.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8017. ALG_ID: 0x0016";
  }

  identity TPM_ALG_OAEP {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base encryption_mode;
    description
      "Padding algorithm defined in Section 7.1 (RSAES-OAEP)
       of RFC 8017.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8017. ALG_ID: 0x0017";
  }

  identity TPM_ALG_ECDSA {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    description
      "Signature algorithm using elliptic curve cryptography (ECC).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 14888-3. ALG_ID: 0x0018";
  }

  identity TPM_ALG_ECDH {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base method;
    description
      "Secret sharing using ECC.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-56A. ALG_ID: 0x0019";
  }

  identity TPM_ALG_ECDAA {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    base anonymous_signing;
    description
      "Elliptic-curve-based, anonymous signing scheme.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       TCG TPM 2.0 Library. ALG_ID: 0x001A";
  }

  identity TPM_ALG_SM2 {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    base encryption_mode;
    base method;
    description
      "SM2 - depending on context, either an elliptic-curve based,
       signature algorithm, an encryption scheme, or a key exchange
       protocol.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x001B";
  }

  identity TPM_ALG_ECSCHNORR {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    description
      "Elliptic-curve-based Schnorr signature.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3.
       ALG_ID: 0x001C";
  }

  identity TPM_ALG_ECMQV {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base method;
    description
      "Two-phase elliptic-curve key.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-56A. ALG_ID: 0x001D";
  }

  identity TPM_ALG_KDF1_SP800_56A {
    if-feature "tpm20";
    base tpm20;
    base hash;
    base method;
    description
      "Concatenation key derivation function.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-56A  (approved alternative1) Section 5.8.1.
       ALG_ID: 0x0020";
  }

  identity TPM_ALG_KDF2 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    base method;
    description
      "Key derivation function.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       IEEE 1363a-2004, KDF2, Section 13.2. ALG_ID: 0x0021";
  }

  identity TPM_ALG_KDF1_SP800_108 {
    base TPM_ALG_KDF2;
    description
      "A key derivation method.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3 and
       NIST SP800-108, Section 4.1, KDF. ALG_ID: 0x0022";
  }

  identity TPM_ALG_ECC {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base object_type;
    description
      "Prime field ECC.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 15946-1. ALG_ID: 0x0023";
  }

  identity TPM_ALG_SYMCIPHER {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base object_type;
    description
      "Object type for a symmetric block cipher.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       TCG TPM 2.0 Library. ALG_ID: 0x0025";
  }

  identity TPM_ALG_CAMELLIA {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    description
      "The Camellia algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 18033-3. ALG_ID: 0x0026";
  }

  identity TPM_ALG_SHA3_256 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "ISO/IEC 10118-3 - the SHA-256 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST FIPS 202. ALG_ID: 0x0027";
  }

  identity TPM_ALG_SHA3_384 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The SHA-384 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST FIPS 202. ALG_ID: 0x0028";
  }

  identity TPM_ALG_SHA3_512 {
    if-feature "tpm20";
    base tpm20;
    base hash;
    description
      "The SHA-512 algorithm.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST FIPS 202. ALG_ID: 0x0029";
  }

  identity TPM_ALG_CMAC {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    description
      "Block Cipher-based Message Authentication Code (CMAC).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 9797-1:2011, Algorithm 5. ALG_ID: 0x003F";
  }

  identity TPM_ALG_CTR {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base encryption_mode;
    description
      "Counter mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10116. ALG_ID: 0x0040";
  }

  identity TPM_ALG_OFB {
    base tpm20;
    base symmetric;
    base encryption_mode;
    description
      "Output Feedback mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10116. ALG_ID: 0x0041";
  }

  identity TPM_ALG_CBC {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base encryption_mode;
    description
      "Cipher Block Chaining mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10116. ALG_ID: 0x0042";
  }

  identity TPM_ALG_CFB {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base encryption_mode;
    description
      "Cipher Feedback mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10116. ALG_ID: 0x0043";
  }

  identity TPM_ALG_ECB {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base encryption_mode;
    description
      "Electronic Codebook mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       ISO/IEC 10116. ALG_ID: 0x0044";
  }

  identity TPM_ALG_CCM {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    base encryption_mode;
    description
      "Counter with Cipher Block Chaining--Message Authentication
       Code (CCM).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-38C. ALG_ID: 0x0050";
  }

  identity TPM_ALG_GCM {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    base encryption_mode;
    description
      "Galois/Counter Mode (GCM).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-38D. ALG_ID: 0x0051";
  }

  identity TPM_ALG_KW {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    base encryption_mode;
    description
      "AES Key Wrap (KW).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-38F. ALG_ID: 0x0052";
  }

  identity TPM_ALG_KWP {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    base encryption_mode;
    description
      "AES Key Wrap with Padding (KWP).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-38F. ALG_ID: 0x0053";
  }

  identity TPM_ALG_EAX {
    if-feature "tpm20";
    base tpm20;
    base symmetric;
    base signing;
    base encryption_mode;
    description
      "Authenticated-Encryption Mode.";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       NIST SP800-38F. ALG_ID: 0x0054";
  }

  identity TPM_ALG_EDDSA {
    if-feature "tpm20";
    base tpm20;
    base asymmetric;
    base signing;
    description
      "Edwards-curve Digital Signature Algorithm (PureEdDSA).";
    reference
      "TCG-Algos: TCG Algorithm Registry, Rev1.34, Table 3, and
       RFC 8032. ALG_ID: 0x0060";
  }
}

&lt;CODE ENDS&gt;</pre><a href="#section-2.1.2.3-1" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2.3-2">Note that not all cryptographic functions are required for use by ietf-tpm-remote-attestation.yang. However, the full definition of Table 3 of <span>[<a href="#TCG-Algos" class="cite xref">TCG-Algos</a>]</span> will allow use by additional YANG specifications.<a href="#section-2.1.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-3">
      <h2 id="name-iana-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-3-1">This document registers the following namespace URIs in the
<span>[<a href="#XML-Registry" class="cite xref">XML-Registry</a>]</span> per <span>[<a href="#RFC3688" class="cite xref">RFC3688</a>]</span>:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-2">
        <dt id="section-3-2.1">URI:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
          urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation<a href="#section-3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Registrant Contact:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">
              The IESG.<a href="#section-3-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">XML:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">
              N/A; the requested URI is an XML namespace.<a href="#section-3-2.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-3">
        <dt id="section-3-3.1">URI:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.2">
          urn:ietf:params:xml:ns:yang:ietf-tcg-algs<a href="#section-3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.3">Registrant Contact:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.4">
              The IESG.<a href="#section-3-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.5">XML:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.6">
              N/A; the requested URI is an XML namespace.<a href="#section-3-3.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-4">This document registers the following YANG modules in the
registry <span>[<a href="#YANG-Parameters" class="cite xref">YANG-Parameters</a>]</span> per <span><a href="https://rfc-editor.org/rfc/rfc6020#section-14" class="relref">Section 14</a> of [<a href="#RFC6020" class="cite xref">RFC6020</a>]</span>:<a href="#section-3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-5">
        <dt id="section-3-5.1">Name:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.2">
          ietf-tpm-remote-attestation<a href="#section-3-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.3">Namespace:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.4">
              urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation<a href="#section-3-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.5">Prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.6">
              tpm<a href="#section-3-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-5.7">Reference:</dt>
        <dd style="margin-left: 1.5em" id="section-3-5.8">
              draft-ietf-rats-yang-tpm-charra (RFC form)<a href="#section-3-5.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-6">
        <dt id="section-3-6.1">Name:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.2">
          ietf-tcg-algs<a href="#section-3-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.3">Namespace:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.4">
              urn:ietf:params:xml:ns:yang:ietf-tcg-algs<a href="#section-3-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.5">Prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.6">
              taa<a href="#section-3-6.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.7">Reference:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.8">
              draft-ietf-rats-yang-tpm-charra (RFC form)<a href="#section-3-6.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">The YANG module ietf-tpm-remote-attestation.yang specified in this document defines a schema for data that is designed to be accessed via network management protocols such as NETCONF <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span> or RESTCONF <span>[<a href="#RFC8040" class="cite xref">RFC8040</a>]</span>.  The lowest NETCONF layer is the secure transport layer, and the mandatory-to-implement secure transport is Secure Shell (SSH) <span>[<a href="#RFC6242" class="cite xref">RFC6242</a>]</span>.  The lowest RESTCONF layer is HTTPS, and the mandatory-to-implement secure transport is TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"> The Network Configuration Access Control Model (NACM) <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span> provides the means to restrict access for particular NETCONF or RESTCONF users to a preconfigured subset of all available NETCONF or RESTCONF protocol operations and content.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Of special consideration are the following nodes:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">In the 'tpms' container, the 'certificates' will expose certificates used for attestation, potentially allowing selection of a certificate that might be compromised. The 'type' could also be misconfigured to represent a different type of key, which might alter how a Verifier might evaluate the results.<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-4.2">Within the 'attester-supported-algos' container, each leaf-list will expose and potentially allow changing of the encryption algorithms supported by a device.<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-5">There are a number of data nodes defined in this YANG module that are writable/creatable/deletable (i.e., <em>config true</em>, which is the default).  These data nodes may be considered sensitive or vulnerable in some network environments.  Write operations (e.g., <em>edit-config</em>) to these data nodes without proper protection can have a negative effect on network operations.  These are the subtrees and data nodes as well as their sensitivity/vulnerability:<a href="#section-4-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-6">
        <dt id="section-4-6.1">Container '/rats-support-structures/attester-supported-algos':</dt>
        <dd style="margin-left: 1.5em" id="section-4-6.2">
          <p id="section-4-6.2.1">'tpm12-asymmetric-signing', 'tpm12-hash', 'tpm20-asymmetric-signing', and 'tpm20-hash'. All could be populated with algorithms that are not supported by the underlying physical TPM installed by the equipment vendor.  A vendor should restrict the ability to configure unsupported algorithms.<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.3">Container: '/rats-support-structures/tpms':</dt>
        <dd style="margin-left: 1.5em" id="section-4-6.4">
          <p id="section-4-6.4.1">'name': Although shown as 'rw', it is system generated. Therefore, it should not be possible for an operator to add or remove a TPM from the configuration.<a href="#section-4-6.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.5"></dt>
        <dd style="margin-left: 1.5em" id="section-4-6.6">
          <p id="section-4-6.6.1">'tpm20-pcr-bank': It is possible to configure PCRs that are not being extended by system software for extraction.  This could unnecessarily use TPM resources.<a href="#section-4-6.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.7"></dt>
        <dd style="margin-left: 1.5em" id="section-4-6.8">
          <p id="section-4-6.8.1">'certificates': It is possible to provision a certificate that does not correspond to an AIK within the TPM 1.2, or to an Attestation Key (AK) within the TPM 2.0, respectively. In such a case, calls to an RPC requesting this specific certificate could result in either no response or a response from an unexpected TPM.<a href="#section-4-6.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.9">RPC 'tpm12-challenge-response-attestation':</dt>
        <dd style="margin-left: 1.5em" id="section-4-6.10">
          <p id="section-4-6.10.1">The receiver of the RPC response must verify that the certificate is for an active AIK, i.e., the certificate has been confirmed by a third party as being able to support Attestation on the targeted TPM 1.2.<a href="#section-4-6.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.11">RPC 'tpm20-challenge-response-attestation':</dt>
        <dd style="margin-left: 1.5em" id="section-4-6.12">
          <p id="section-4-6.12.1">The receiver of the RPC response must verify that the certificate is for an active AK, i.e., the private key confirmation of the quote signature within the RPC response has been confirmed by a third party to belong to an entity legitimately able to perform Attestation on the targeted TPM 2.0.<a href="#section-4-6.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.13">RPC 'log-retrieval':</dt>
        <dd style="margin-left: 1.5em" id="section-4-6.14">
          <p id="section-4-6.14.1">Requesting a large volume of logs from the Attester could require significant system resources and create a denial of service.<a href="#section-4-6.14.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-7">Information collected through the RPCs above could reveal specific versions of software and configurations of endpoints that could identify vulnerabilities on those systems.  Therefore, RPCs should be protected by NACM <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span> with a default setting of deny-all to limit the extraction of attestation data by only authorized Verifiers.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">For the YANG module ietf-tcg-algs.yang, please use care when selecting specific algorithms.  The introductory section of <span>[<a href="#TCG-Algos" class="cite xref">TCG-Algos</a>]</span> highlights that some algorithms should be considered legacy, and recommends implementers and adopters diligently evaluate available information such as governmental, industrial, and academic research before selecting an algorithm for use.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">Some of the readable data nodes in this YANG module may be considered sensitive or vulnerable in some network environments. It is thus important to control read access (e.g., via get, get-config, or notification) to these data nodes. These are the subtrees and data nodes and their sensitivity/vulnerability:<a href="#section-4-9" class="pilcrow">¶</a></p>
<p id="section-4-10">Event logs (bios-log, ima-log, netequip-boot-log) typically contain hash values (digests) of running boot and OS software. Passive attackers can use these hash values to identify software versions and thus launch targeted attacks on known vulnerabilities. Hence, bios-log, ima-log, and netequip-boot-log are considered sensitive.<a href="#section-4-10" class="pilcrow">¶</a></p>
<p id="section-4-11">Some of the RPC operations in this YANG module may be considered sensitive or vulnerable in some network environments. It is thus important to control access to these operations. These are the operations and their sensitivity/vulnerability:<a href="#section-4-11" class="pilcrow">¶</a></p>
<p id="section-4-12">The 'log-retrieval' RPC operation is considered sensitive since it enables retrieval of logs (bios-log, ima-log, netequip-boot-log) that typically contain hash values (digests) of running boot and OS software.  This allows specifics of loaded software including BIOS and operating system software to be understood externally.<a href="#section-4-12" class="pilcrow">¶</a></p>
<p id="section-4-13">The other two RPC operations, 'tpm20-challenge-response-attestation' and 'tpm12-challenge-response-attestation', will expose values indicating the internal operational state of the device. These values could also be correlated to specifics of running software as well.<a href="#section-4-13" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BIOS-Log">[BIOS-Log]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG PC Client Platform Firmware Profile Specification"</span>, <span class="refContent">Family "2.0" Level 00 Revision 1.03 Version 51</span>, <time datetime="2017-05-01" class="refDate">1 May 2017</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/PC-ClientSpecific_Platform_Profile_for_TPM_2p0_Systems_v51.pdf">https://trustedcomputinggroup.org/wp-content/uploads/PC-ClientSpecific_Platform_Profile_for_TPM_2p0_Systems_v51.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CEL">[CEL]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Canonical Event Log Format"</span>, <span class="refContent">Version 1.0 Revision 0.41</span>, <time datetime="2022-02-25" class="refDate">25 February 2022</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_CEL_v1_r0p41_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_CEL_v1_r0p41_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-Std-1363-2000">[IEEE-Std-1363-2000]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard Specifications for Public-Key Cryptography"</span>, <span class="seriesInfo">IEEE Std 1363-2000</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2000.92292</span>, <time datetime="2000-08" class="refDate">August 2000</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/891000">https://ieeexplore.ieee.org/document/891000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-Std-1363a-2004">[IEEE-Std-1363a-2004]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard Specifications for Public-Key Cryptography - Amendment 1: Additional Techniques"</span>, <span class="seriesInfo">IEEE Std 1363a-2004</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2004.94612</span>, <time datetime="2004-09" class="refDate">September 2004</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/1335427">https://ieeexplore.ieee.org/document/1335427</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-10116">[ISO-IEC-10116]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Security techniques - Modes of operation for an n-bit block cipher"</span>, <span class="refContent">Edition 4</span>, <span class="seriesInfo">ISO/IEC 10116:2017</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.iso.org/standard/64575.html">https://www.iso.org/standard/64575.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-10118-3">[ISO-IEC-10118-3]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"IT Security techniques - Hash-functions - Part 3: Dedicated hash-functions"</span>, <span class="refContent">Edition 4</span>, <span class="seriesInfo">ISO/IEC 10118-3:2018</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.iso.org/standard/67116.html">https://www.iso.org/standard/67116.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-14888-3">[ISO-IEC-14888-3]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Security techniques - Digital signatures with appendix - Part 3: Discrete logarithm based mechanisms"</span>, <span class="refContent">Edition 4</span>, <span class="seriesInfo">ISO/IEC 14888-3:2018</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.iso.org/standard/76382.html">https://www.iso.org/standard/76382.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-15946-1">[ISO-IEC-15946-1]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Security techniques - Cryptographic techniques based on elliptic curves - Part 1: General"</span>, <span class="refContent">Edition 3</span>, <span class="seriesInfo">ISO/IEC 15946-1:2016</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.iso.org/standard/65480.html">https://www.iso.org/standard/65480.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-18033-3">[ISO-IEC-18033-3]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Security techniques - Encryption algorithms - Part 3: Block ciphers"</span>, <span class="refContent">Edition 2</span>, <span class="seriesInfo">ISO/IEC 18033-3:2010</span>, <time datetime="2010-12" class="refDate">December 2010</time>, <span>&lt;<a href="https://www.iso.org/standard/54531.html">https://www.iso.org/standard/54531.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-9797-1">[ISO-IEC-9797-1]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - Security techniques - Message Authentication Codes (MACs) - Part 1: Mechanisms using a block cipher"</span>, <span class="refContent">Edition 2</span>, <span class="seriesInfo">ISO/IEC 9797-1:2011</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.iso.org/standard/50375.html">https://www.iso.org/standard/50375.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO-IEC-9797-2">[ISO-IEC-9797-2]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information security - Message authentication codes (MACs) - Part 2: Mechanisms using a dedicated hash-function"</span>, <span class="refContent">Edition 3</span>, <span class="seriesInfo">ISO/IEC 9797-2:2021</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.iso.org/standard/75296.html">https://www.iso.org/standard/75296.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-FIPS-202">[NIST-FIPS-202]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <span class="seriesInfo">NIST FIPS 202</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.202</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/202/final">https://csrc.nist.gov/publications/detail/fips/202/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP800-108">[NIST-SP800-108]</dt>
        <dd>
<span class="refAuthor">Chen, L.</span>, <span class="refTitle">"Recommendation for Key Derivation Using Pseudorandom Functions"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-108r1-upd1</span>, <span class="seriesInfo">NIST SP 800-108r1-upd1</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://csrc.nist.gov/pubs/sp/800/108/r1/upd1/final">https://csrc.nist.gov/pubs/sp/800/108/r1/upd1/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP800-38C">[NIST-SP800-38C]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: the CCM Mode for Authentication and Confidentiality"</span>, <span class="seriesInfo">NIST SP 800-38C</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38C</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-38c/final">https://csrc.nist.gov/publications/detail/sp/800-38c/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP800-38D">[NIST-SP800-38D]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST SP 800-38D</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38D</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-38d/final">https://csrc.nist.gov/publications/detail/sp/800-38d/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP800-38F">[NIST-SP800-38F]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods for Key Wrapping"</span>, <span class="seriesInfo">NIST SP 800-38F</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38F</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-38f/final">https://csrc.nist.gov/publications/detail/sp/800-38f/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP800-56A">[NIST-SP800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST SP 800-56A Rev. 3</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-56Ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final">https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3688">https://www.rfc-editor.org/info/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6020">https://www.rfc-editor.org/info/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6242">[RFC6242]</dt>
        <dd>
<span class="refAuthor">Wasserman, M.</span>, <span class="refTitle">"Using the NETCONF Protocol over Secure Shell (SSH)"</span>, <span class="seriesInfo">RFC 6242</span>, <span class="seriesInfo">DOI 10.17487/RFC6242</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6242">https://www.rfc-editor.org/info/rfc6242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6933">[RFC6933]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Romascanu, D.</span>, <span class="refAuthor">Quittek, J.</span>, and <span class="refAuthor">M. Chandramouli</span>, <span class="refTitle">"Entity MIB (Version 4)"</span>, <span class="seriesInfo">RFC 6933</span>, <span class="seriesInfo">DOI 10.17487/RFC6933</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6933">https://www.rfc-editor.org/info/rfc6933</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6991">[RFC6991]</dt>
        <dd>
<span class="refAuthor">Schoenwaelder, J., Ed.</span>, <span class="refTitle">"Common YANG Data Types"</span>, <span class="seriesInfo">RFC 6991</span>, <span class="seriesInfo">DOI 10.17487/RFC6991</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6991">https://www.rfc-editor.org/info/rfc6991</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8341">[RFC8341]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span> and <span class="refAuthor">M. Bjorklund</span>, <span class="refTitle">"Network Configuration Access Control Model"</span>, <span class="seriesInfo">STD 91</span>, <span class="seriesInfo">RFC 8341</span>, <span class="seriesInfo">DOI 10.17487/RFC8341</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8341">https://www.rfc-editor.org/info/rfc8341</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8348">[RFC8348]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, <span class="refAuthor">Dong, J.</span>, and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"A YANG Data Model for Hardware Management"</span>, <span class="seriesInfo">RFC 8348</span>, <span class="seriesInfo">DOI 10.17487/RFC8348</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8348">https://www.rfc-editor.org/info/rfc8348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9642">[RFC9642]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refTitle">"A YANG Data Model for a Keystore"</span>, <span class="seriesInfo">RFC 9642</span>, <span class="seriesInfo">DOI 10.17487/RFC9642</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9642">https://www.rfc-editor.org/info/rfc9642</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9683">[RFC9683]</dt>
        <dd>
<span class="refAuthor">Fedorkow, G. C., Ed.</span>, <span class="refAuthor">Voit, E.</span>, and <span class="refAuthor">J. Fitzgerald-McKay</span>, <span class="refTitle">"Remote Integrity Verification of Network Devices Containing Trusted Platform Modules"</span>, <span class="seriesInfo">RFC 9683</span>, <span class="seriesInfo">DOI 10.17487/RFC9683</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9683">https://www.rfc-editor.org/info/rfc9683</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCG-Algos">[TCG-Algos]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Algorithm Registry"</span>, <span class="refContent">Family "2.0" Level 00 Revision 01.34</span>, <time datetime="2023-08-24" class="refDate">24 August 2023</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG-Algorithm-Registry-Revision-1.34_pub-1.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG-Algorithm-Registry-Revision-1.34_pub-1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2">[TPM1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM 1.2 Main Specification"</span>, <span class="refContent">TPM Main Specification Level 2 Version 1.2, Revision 116</span>, <time datetime="2011-03-01" class="refDate">1 March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-main-specification/">https://trustedcomputinggroup.org/resource/tpm-main-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2-Commands">[TPM1.2-Commands]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM Main Part 3 Commands"</span>, <span class="refContent">TPM Main Specification Level 2 Version 1.2, Revision 116</span>, <time datetime="2011-03-01" class="refDate">1 March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-3-Commands_v1.2_rev116_01032011.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-3-Commands_v1.2_rev116_01032011.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2-Structures">[TPM1.2-Structures]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM Main Part 2 TPM Structures"</span>, <span class="refContent">TPM Main Specification Level 2 Version 1.2, Revision 116</span>, <time datetime="2011-03-01" class="refDate">1 March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0">[TPM2.0]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM 2.0 Library"</span>, <span class="refContent">Trusted Platform Module Library Specification, Family "2.0", Level 00, Revision 01.83</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0-Arch">[TPM2.0-Arch]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Part 1: Architecture"</span>, <span class="refContent">Family "2.0", Level 00, Revision 01.83</span>, <time datetime="2024-01-25" class="refDate">25 January 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-1-Architecture.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-1-Architecture.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0-Key">[TPM2.0-Key]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM 2.0 Keys for Device Identity and Attestation"</span>, <span class="refContent">Version 1.00, Revision 12</span>, <time datetime="2021-10-08" class="refDate">8 October 2021</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TPM-2p0-Keys-for-Device-Identity-and-Attestation_v1_r12_pub10082021.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TPM-2p0-Keys-for-Device-Identity-and-Attestation_v1_r12_pub10082021.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0-Structures">[TPM2.0-Structures]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Part 2: Structures"</span>, <span class="refContent">Family "2.0", Level 00, Revision 01.83</span>, <time datetime="2024-01-25" class="refDate">25 January 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TPM-2.0-1.83-Part-2-Structures.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UEFI-Secure-Boot">[UEFI-Secure-Boot]</dt>
      <dd>
<span class="refAuthor">Unified Extensible Firmware Interface (UEFI) Forum, Inc.</span>, <span class="refTitle">"Unified Extensible Firmware Interface (UEFI) Specification"</span>, <span class="refContent">Section 32.1: Secure Boot</span>, <span class="refContent">Version 2.10</span>, <time datetime="2022-08-29" class="refDate">29 August 2022</time>, <span>&lt;<a href="https://uefi.org/sites/default/files/resources/UEFI_Spec_2_10_Aug29.pdf">https://uefi.org/sites/default/files/resources/UEFI_Spec_2_10_Aug29.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IMA-Template-Management">[IMA-Template-Management]</dt>
        <dd>
<span class="refAuthor">The kernel development community</span>, <span class="refTitle">"IMA Template Management Mechanism"</span>, <span class="refContent">Linux Kernel 6.11</span>, <time datetime="2024-09-15" class="refDate">15 September 2024</time>, <span>&lt;<a href="https://www.kernel.org/doc/html/v6.11/security/IMA-templates.html">https://www.kernel.org/doc/html/v6.11/security/IMA-templates.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-915121">[NIST-915121]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"True Randomness Can't be Left to Chance: Why entropy is important for information security"</span>, <span>&lt;<a href="https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=915121">https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=915121</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-reference-interaction-models">[RATS-Interaction-Models]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Pan, W.</span>, and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-reference-interaction-models-11</span>, <time datetime="2024-07-22" class="refDate">22 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-11">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XML-Registry">[XML-Registry]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IETF XML Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/xml-registry/">https://www.iana.org/assignments/xml-registry/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="YANG-Parameters">[YANG-Parameters]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"YANG Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/yang-parameters/">https://www.iana.org/assignments/yang-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="ima">
<section id="appendix-A">
      <h2 id="name-integrity-measurement-archi">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-integrity-measurement-archi" class="section-name selfRef">Integrity Measurement Architecture (IMA)</a>
      </h2>
<p id="appendix-A-1">IMA extends the principles of Measured Boot <span>[<a href="#TPM2.0-Arch" class="cite xref">TPM2.0-Arch</a>]</span> and Secure Boot <span>[<a href="#UEFI-Secure-Boot" class="cite xref">UEFI-Secure-Boot</a>]</span> to the Linux operating system, applying it to operating system applications and files.
IMA has been part of the Linux integrity subsystem of the Linux kernel since 2009 (kernel version 2.6.30). The IMA mechanism represented by the YANG module in this specification is rooted in the kernel version 5.16 <span>[<a href="#IMA-Template-Management" class="cite xref">IMA-Template-Management</a>]</span>.
IMA enables the protection of system integrity by collecting (commonly referred to as measuring) and storing measurements (called Claims in the context of IETF RATS) of files before execution so that these measurements can be used later, at system runtime, in remote attestation procedures.
IMA acts in support of the Appraisal of Evidence (which includes measurement Claims) by leveraging Reference Values stored in extended file attributes.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">In support of the Appraisal of Evidence, IMA maintains an ordered list (with no duplicates) of measurements in kernel space, the Stored Measurement Log (SML), for all files that have been measured before execution since the operating system was started.
Although IMA can be used without a TPM, it is typically used in conjunction with a TPM to anchor the integrity of the SML in a hardware-protected secure storage location, i.e., PCRs provided by TPMs.
IMA provides the SML in both binary and ASCII representations in the Linux security file system <em>securityfs</em> (<code>/sys/kernel/security/ima/</code>).<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">IMA templates define the format of the SML, i.e., which fields are included in a log record.
Examples are file path, file hash, user ID, group ID, file signature, and extended file attributes.
IMA comes with a set of predefined template formats and also allows a custom format, i.e., a format consisting of template fields supported by IMA.
Template usage is typically determined by boot arguments passed to the kernel.
Alternatively, the format can also be hard-coded into custom kernels.
IMA templates and fields are extensible in the kernel source code. As a result, more template fields can be added in the future.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">IMA policies define which files are measured using the IMA policy language.
Built-in policies can be passed as boot arguments to the kernel.
Custom IMA policies can be defined once during runtime or be hard-coded into a custom kernel.
If no policy is defined, no measurements are taken and IMA is effectively disabled.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">A comprehensive description of the content fields of the Linux IMA TLV format can be found in Table 16 of the Canonical Event Log (CEL) specification <span>[<a href="#CEL" class="cite xref">CEL</a>]</span>. The CEL specification also illustrates the use of templates to enable extended or customized IMA TLV formats in Section 5.1.6.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="netequip-boot-log">
<section id="appendix-B">
      <h2 id="name-ima-for-network-equipment-b">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-ima-for-network-equipment-b" class="section-name selfRef">IMA for Network Equipment Boot Logs</a>
      </h2>
<p id="appendix-B-1">Network equipment can generally implement similar IMA-protected functions to generate measurements (Claims) about the boot process of a device and enable corresponding remote attestation.
Network Equipment Boot Logs combine the measurement and logging of boot components and operating system components (executables and files) into a single log file in a format identical to the IMA format.
Note that the format used for logging measurement of boot components in this scheme differs from the boot logging strategy described elsewhere in this document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">During the boot process of the network device, i.e., from BIOS to the end of the operating system and user-space, all files executed can be measured and logged in the order of their execution.
When the Verifier initiates a remote attestation process (e.g., challenge-response remote attestation as defined in this document), the network equipment takes on the role of an Attester and can convey to the Verifier Claims that comprise the measurement log as well as the corresponding PCR values (Evidence) of a TPM.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">The Verifier can appraise the integrity (compliance with the Reference Values) of each executed file by comparing its measured value with the Reference Value.
Based on the execution order, the Verifier can compute a PCR Reference Value (by replaying the log) and compare it to the measurement log Claims obtained in conjunction with the PCR Evidence to assess their trustworthiness with respect to an intended operational state.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">Network equipment usually executes multiple components in parallel.  This holds not only during the operating system loading phase, but also even during the BIOS boot phase.
With this measurement log mechanism, network equipment can assume the role of an Attester, proving to the Verifier the trustworthiness of its boot process.
Using the measurement log, Verifiers can precisely identify mismatching log entries to infer potentially tampered components.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">This mechanism also supports scenarios that modify files on the Attester that are subsequently executed during the boot phase (e.g., updating/patching) by simply updating the appropriate Reference Values in Reference Integrity Manifests that inform Verifiers about how an Attester is composed.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT | ATHENE Center</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Eckel</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT | ATHENE Center</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael.eckel@sit.fraunhofer.de" class="email">michael.eckel@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shwetha Bhandari</span></div>
<div dir="auto" class="left"><span class="org">ThoughtSpot</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shwetha.bhandari@thoughtspot.com" class="email">shwetha.bhandari@thoughtspot.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Voit</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:evoit@cisco.com" class="email">evoit@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bill Sulzen</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bsulzen@cisco.com" class="email">bsulzen@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Liang Xia (Frank)</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div dir="auto" class="left"><span class="extended-address">Yuhuatai District</span></div>
<div dir="auto" class="left"><span class="street-address">101 Software Avenue</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left">
<span class="region">Jiangsu</span>, <span class="postal-code">210012</span>
</div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Frank.Xialiang@huawei.com" class="email">Frank.Xialiang@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tom Laffey</span></div>
<div dir="auto" class="left"><span class="org">Hewlett Packard Enterprise</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tom.laffey@hpe.com" class="email">tom.laffey@hpe.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guy C. Fedorkow</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks</span></div>
<div dir="auto" class="left"><span class="street-address">10 Technology Park Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Westford</span>, <span class="region">Massachusetts</span> <span class="postal-code">01886</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gfedorkow@juniper.net" class="email">gfedorkow@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
