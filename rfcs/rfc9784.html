<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9784: Virtual Ethernet Segments for EVPN and Provider Backbone Bridge EVPN</title>
<meta content="Ali Sajassi" name="author">
<meta content="Patrice Brissette" name="author">
<meta content="Rick Schell" name="author">
<meta content="John E. Drake" name="author">
<meta content="Jorge Rabadan" name="author">
<meta content="
       
   Ethernet VPN (EVPN) and Provider Backbone Bridge EVPN (PBB-EVPN) introduce a 
   comprehensive suite of solutions for delivering Ethernet services over 
   MPLS/IP networks. These solutions offer advanced  
   multihoming capabilities. Specifically, they support Single-Active and 
   All-Active redundancy modes for an Ethernet Segment (ES), which is defined 
   as a collection of physical links connecting a multihomed device or network 
   to a set of Provider Edge (PE) devices. This document extends the concept of 
   an ES by allowing an ES to be associated with a set of Ethernet 
   Virtual Circuits (EVCs), such as VLANs, or other entities, including MPLS Label 
   Switched Paths (LSPs) or pseudowires (PWs). This extended concept is referred 
   to as virtual Ethernet Segments (vESes). This document lists the requirements 
   and specifies the necessary extensions to support vES in both EVPN and PBB-EVPN.    
       
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="9784" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9784.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-virtual-eth-segment-19" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9784" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9784</td>
<td class="center">EVPN Virtual Ethernet Segments</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sajassi, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9784" class="eref">9784</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06" class="published">June 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Sajassi</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">P. Brissette</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">R. Schell</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">J. Drake</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">J. Rabadan</div>
<div class="org">Nokia</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9784</h1>
<h1 id="title">Virtual Ethernet Segments for EVPN and Provider Backbone Bridge EVPN</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   Ethernet VPN (EVPN) and Provider Backbone Bridge EVPN (PBB-EVPN) introduce a 
   comprehensive suite of solutions for delivering Ethernet services over 
   MPLS/IP networks. These solutions offer advanced  
   multihoming capabilities. Specifically, they support Single-Active and 
   All-Active redundancy modes for an Ethernet Segment (ES), which is defined 
   as a collection of physical links connecting a multihomed device or network 
   to a set of Provider Edge (PE) devices. This document extends the concept of 
   an ES by allowing an ES to be associated with a set of Ethernet 
   Virtual Circuits (EVCs), such as VLANs, or other entities, including MPLS Label 
   Switched Paths (LSPs) or pseudowires (PWs). This extended concept is referred 
   to as virtual Ethernet Segments (vESes). This document lists the requirements 
   and specifies the necessary extensions to support vES in both EVPN and PBB-EVPN.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9784">https://www.rfc-editor.org/info/rfc9784</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-veses-in-access-ethernet-ne" class="internal xref">vESes in Access Ethernet Networks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-veses-in-access-mpls-networ" class="internal xref">vESes in Access MPLS Networks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-requirements" class="internal xref">Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-single-homed-and-multihomed" class="internal xref">Single-Homed and Multihomed vES</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-local-switching" class="internal xref">Local Switching</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-evc-service-types" class="internal xref">EVC Service Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-designated-forwarder-df-ele" class="internal xref">Designated Forwarder (DF) Election</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-evc-monitoring" class="internal xref">EVC Monitoring</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-failure-and-recovery" class="internal xref">Failure and Recovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-fast-convergence" class="internal xref">Fast Convergence</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-solution-overview" class="internal xref">Solution Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-evpn-df-election-for-ves" class="internal xref">EVPN DF Election for vES</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-grouping-and-route-coloring" class="internal xref">Grouping and Route Coloring for vES</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-evpn-route-coloring-for-ves" class="internal xref">EVPN Route Coloring for vES</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-pbb-evpn-route-coloring-for" class="internal xref">PBB-EVPN Route Coloring for vES</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-failure-handling-and-recove" class="internal xref">Failure Handling and Recovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-evc-failure-handling-for-si" class="internal xref">EVC Failure Handling for Single-Active vES in EVPN</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-evc-failure-handling-for-a-" class="internal xref">EVC Failure Handling for a Single-Active vES in PBB-EVPN</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-port-failure-handling-for-s" class="internal xref">Port Failure Handling for Single-Active vESes in EVPN</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-port-failure-handling-for-si" class="internal xref">Port Failure Handling for Single-Active vESes in PBB-EVPN</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-fast-convergence-in-evpn-an" class="internal xref">Fast Convergence in EVPN and PBB-EVPN</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"> Ethernet VPN (EVPN) <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and Provider Backbone Bridge EVPN 
   (PBB-EVPN) <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> introduce 
   a comprehensive suite of solutions for delivering Ethernet services 
   over MPLS/IP networks. These solutions offer advanced 
   multihoming capabilities. Specifically, they support Single-Active and 
   All-Active redundancy modes for an Ethernet Segment (ES). As defined in 
   <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, an ES represents a collection of 
   Ethernet links that connect a customer site to one or more Provider Edge (PE) devices.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"> This document extends the concept of an ES by allowing an ES to be 
   associated with a set of Ethernet Virtual Circuits (EVCs) (such as VLANs) or other 
   entities, including MPLS Label Switched Paths (LSPs) or pseudowires (PWs). This 
   extended concept is referred to as virtual Ethernet Segments (vESes). This document 
   lists the requirements and specifies the necessary extensions to support vES in both EVPN 
   and PBB-EVPN. The scope of this document includes PBB-EVPN <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>, 
   EVPN over MPLS <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, and EVPN over IP <span>[<a href="#RFC8365" class="cite xref">RFC8365</a>]</span>;
   however, it excludes EVPN over SRv6 <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-veses-in-access-ethernet-ne">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-veses-in-access-ethernet-ne" class="section-name selfRef">vESes in Access Ethernet Networks</a>
        </h3>
<p id="section-1.2-1"> Some service providers (SPs) seek to extend the concept of physical 
   Ethernet links in an ES to encompass EVCs, 
   wherein multiple EVCs (such as VLANs) can be aggregated onto a single 
   physical External Network-Network Interface (ENNI). An ES composed 
   of a set of EVCs rather than physical links is referred to as a vES. 
   <a href="#fig-1" class="auto internal xref">Figure 1</a> illustrates two PE devices (PE1 and PE2), each with 
   an ENNI aggregating several EVCs. Some of these EVCs on a given ENNI 
   can be associated with vESes. For instance, the multihomed vES depicted 
   in <a href="#fig-1" class="auto internal xref">Figure 1</a> consists of EVC4 on ENNI1 and EVC5 on ENNI2.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span id="name-single-homed-devices-and-a-"></span><div id="fig-1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-1.2-2.1">
<pre>
                  Third-Party
    +-----+       EAP
    | CE11|EVC1  +---------+
    +-----+   \  |         |       +---+
    Cust. A    \-0=========0--ENNI1|   |
    +-----+      |         |  ENNI1|   |   +-------+   +---+
    | CE12|EVC2--0=========0--ENNI1|PE1|---|       |   |   |
    +-----+      |         |  ENNI1|   |   |SP     |---|PE3|-
                 |       ==0--ENNI1|   |   |IP/MPLS|   |   | \  +---+
    +-----+      |      /  |       +---+   |Core   |   +---+  \-|   |
    | CE22|EVC3--0==== /   |               |Network|            |CE4|
    +-----+      |    X    |               |       |   +---+    |   |
    Cust. B      |   / \   |       +---+   |       |   |   |  /-|   |
    +-----+     -0===   ===0--ENNI2|   |   |       |---|PE4|-/  +---+
    | CE3 |EVC4/ |         |  ENNI2|PE2|---|       |   |   |
    |     |EVC5--0=========0--ENNI2|   |   +-------+   +---+
    +-----+      |         |       +---+
    Cust. C      +---------+   /\
           /\                  ||
           ||                  ENNI
           EVCs             Interface
    &lt;--------802.1Q----------&gt;  &lt;---- EVPN Network -----&gt; &lt;-802.1Q-&gt;</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-single-homed-devices-and-a-" class="selfRef">Single-Homed Devices and a Dual-Homed Device/Network on the Same ENNI</a>
          </figcaption></figure>
</div>
<p id="section-1.2-3"> ENNIs are commonly used to reach remote
   customer sites via independent Ethernet access networks or third-party
   Ethernet Access Providers (EAPs). ENNIs can
   aggregate traffic from many vESes (e.g., hundreds to thousands), 
   where each vES is represented by its associated EVC on that ENNI. As a result,
   ENNIs and their associated EVCs are key elements of SP external boundaries
   that are carefully designed and closely monitored. As a reminder, 
   the ENNI is the demarcation between the SP (IP/MPLS core network) and the 
   third-party Ethernet Access Provider.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4"> To meet customers' Service Level Agreements (SLAs), SPs build
   redundancy via multiple EVPN PEs and across multiple ENNIs (as shown
   in <a href="#fig-1" class="auto internal xref">Figure 1</a>), where a given vES can be multihomed to two or
   more EVPN
   PE devices (on two or more ENNIs) via their associated EVCs. Just
   like physical ESs in the solutions described in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>, these vESes
   can be single-homed or multihomed ESs, and when multihomed, they
   can operate in either Single-Active or All-Active redundancy modes.
   In a typical SP external-boundary scenario (e.g., with an EAP), an ENNI can be associated with
   several thousands of single-homed vESes, several hundreds of Single-Active
   vESes, and tens or hundreds of All-Active vESes. The specific figures used throughout 
   this document reflect the relative quantities (hundreds, thousands, etc.) of various elements as understood at the time of writing.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-veses-in-access-mpls-networ">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-veses-in-access-mpls-networ" class="section-name selfRef">vESes in Access MPLS Networks</a>
        </h3>
<p id="section-1.3-1"> Other SPs want to extend the concept of
   physical links in an ES to individual PWs or to MPLS
   LSPs in Access MPLS networks, i.e., a vES
   consisting of a set of PWs or a set of LSPs. <a href="#fig-2" class="auto internal xref">Figure 2</a> illustrates this concept.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<span id="name-a-dual-homed-and-single-hom"></span><div id="fig-2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-1.3-2.1">
<pre>
                 MPLS Aggregation
                 Network
   +-----+      +-----------------+
   | CE11|EVC1  |                 |
   +-----+   \ +AG1-+  PW1      +-+---+
   Cust. A    -0----|===========|     |
   +-----+     | ---+===========|     |   +-------+   +---+
   | CE12|EVC2-0/   |  PW2   /\ | PE1 +---+       |   |   |
   +-----+     ++---+      /=||=|     |   |       +---+PE3+-
                |         //=||=|     |   |IP/MPLS|   |   | \  +---+
                |        //  \/ +-+---+   |Core   |   +---+  \-+   |
   +-----+EVC3  |    PW3//  LSP1  |       |Network|            |CE4|
   | CE13|    \+AG2-+==//         |       |       |   +---+    |   |
   +-----+     0    |==/PW4  /\ +-+---+   |       |   |   |  /-+   |
               0    |==PW5===||=|     |   |       +---+PE4+-/  +---+
   +-----+    /++---+==PW6===||=| PE2 +---+       |   |   |
   | CE14|EVC4  |            \/ |     |   +-------+   +---+
   +-----+      |           LSP2+-+---+
   Cust. C      +-----------------+
          /\
          ||
          EVCs
   &lt;--802.1Q--&gt; &lt;-----MPLS Agg----&gt; &lt;--- EVPN Network ---&gt; &lt;-802.1Q-&gt;</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-a-dual-homed-and-single-hom" class="selfRef">A Dual-Homed and Single-Homed Network on MPLS Aggregation Networks</a>
          </figcaption></figure>
</div>
<p id="section-1.3-3"> In certain scenarios, SPs utilize MPLS Aggregation Networks 
   that are managed by separate administrative entities or third-party organizations 
   to gain access to their own IP/MPLS core network infrastructure. This situation 
   is depicted in <a href="#fig-2" class="auto internal xref">Figure 2</a>.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4"> In such scenarios, a vES is defined as a set of individual PWs 
 when aggregation is not feasible. If aggregation is possible, the vES can be 
 associated with a group of PWs that share the same unidirectional LSP pair, 
 where the LSP pair consists of the ingress and egress LSPs between the same 
 endpoints.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5"> In <a href="#fig-2" class="auto internal xref">Figure 2</a>, EVC3 is connected to
   a VPWS instance in AG2 that is connected to PE1 and PE2 via PW3 and
   PW5, respectively.  EVC4 is connected to another VPWS instance on
   AG2 that is connected to PE1 and PE2 via PW4 and PW6,
   respectively.  Since the PWs for the two VPWS instances can be
   aggregated into the same LSP pair going to and coming from the MPLS
   network, a common vES can be defined for the four mentioned
   PWs. In <a href="#fig-2" class="auto internal xref">Figure 2</a>, LSP1 and LSP2 represent the two LSP pairs between PE1
   and AG2 and between PE2 and AG2, respectively. The vES consists of these two LSP
   pairs (LSP1 and LSP2), and each LSP pair has two PWs. This vES will be
   shared by two separate EVPN instances (e.g., EVI-1 and EVI-2) in 
   the EVPN network. PW3 and PW4 are associated with EVI-1 and EVI-2, respectively, 
   on PE1, and PW5 and PW6 are associated with EVI-1 and EVI-2, respectively, on PE2.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6"> In some cases, the aggregation of PWs that share the same LSP pair
   may not be possible. For instance, if PW3 were terminated into a third PE, e.g.,
   PE3, instead of PE1, the vES would need to be defined on each PW on each PE.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7"> For MPLS/IP access networks where a vES represents a set of LSP 
   pairs or a set of PWs, this document extends the Single-Active multihoming 
   procedures defined in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> to
   accommodate vES. The extension of vES to support All-Active multihoming in 
   MPLS/IP access networks is beyond the scope of this document.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8"> This document defines the concept of a vES and specifies the additional extensions 
   necessary to support a vES in accordance with <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and 
   <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>. <a href="#requirements" class="auto internal xref">Section 3</a> enumerates the set of 
   requirements for a vES. <a href="#overview" class="auto internal xref">Section 4</a> details the extensions for a 
   vES applicable to EVPN solutions, including those specified in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> 
   and <span>[<a href="#RFC7209" class="cite xref">RFC7209</a>]</span>. These extensions are designed to meet the requirements 
   listed in <a href="#requirements" class="auto internal xref">Section 3</a>. <a href="#overview" class="auto internal xref">Section 4</a> also provides 
   an overview of the solution, while <a href="#failure" class="auto internal xref">Section 5</a> addresses failure handling, 
   recovery, scalability, and fast convergence of <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and 
   <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> for vESes.<a href="#section-1.3-8" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">AC:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.2">Attachment Circuit<a href="#section-2-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">B-MAC:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.4">Backbone MAC Address<a href="#section-2-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">CE:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.6">Customer Edge<a href="#section-2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">C-MAC:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.8">Customer/Client MAC Address<a href="#section-2-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">DF:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.10">Designated Forwarder<a href="#section-2-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">ENNI:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.12">External Network-Network Interface<a href="#section-2-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">ES:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.14">Ethernet Segment<a href="#section-2-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.15">ESI:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.16">Ethernet Segment Identifier<a href="#section-2-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.17">Ethernet A-D:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.18">Ethernet Auto-Discovery<a href="#section-2-1.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.19">EVC:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.20">Ethernet Virtual Circuit <span>[<a href="#MEF63" class="cite xref">MEF63</a>]</span><a href="#section-2-1.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.21">EVI:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.22">EVPN Instance<a href="#section-2-1.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.23">EVPN:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.24">Ethernet VPN<a href="#section-2-1.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.25">I-SID:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.26">Service Instance Identifier (24 bits and global within a PBB
   network; see <span>[<a href="#RFC7080" class="cite xref">RFC7080</a>]</span>).<a href="#section-2-1.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.27">MAC:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.28">Media Access Control<a href="#section-2-1.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.29">PBB:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.30">Provider Backbone Bridge<a href="#section-2-1.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.31">PBB-EVPN:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.32">Provider Backbone Bridge EVPN<a href="#section-2-1.32" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.33">PE:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.34">Provider Edge<a href="#section-2-1.34" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.35">VPWS:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.36">Virtual Private Wire Service<a href="#section-2-1.36" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.37">Single-Active (SA) Redundancy Mode:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.38">When only a single PE, among a
   group of PEs attached to an ES, is allowed to forward
   traffic to/from that ES, the ES is
   defined as operating in Single-Active redundancy mode.<a href="#section-2-1.38" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.39">All-Active (AA) Redundancy Mode:</dt>
        <dd style="margin-left: 5.0em" id="section-2-1.40">When all PEs attached to an ES are allowed to forward traffic to/from that ES,
   the ES is defined as operating in All-Active
   redundancy mode.<a href="#section-2-1.40" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
<div id="requirements">
<section id="section-3">
      <h2 id="name-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-3-1"> This section describes the requirements specific to vES for EVPN and PBB-EVPN solutions. These requirements are in
   addition to the ones described in <span>[<a href="#RFC8214" class="cite xref">RFC8214</a>]</span>, <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, and
   <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-single-homed-and-multihomed">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-single-homed-and-multihomed" class="section-name selfRef">Single-Homed and Multihomed vES</a>
        </h3>
<p id="section-3.1-1"> A PE device <span class="bcp14">MUST</span> support the following types of vESes:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.1-2">
        <dt>(R1a)</dt>
<dd style="margin-left: 3.5em" id="section-3.1-2.1">The PE <span class="bcp14">MUST</span> handle single-homed vESes on a
        single physical port, such as a single ENNI.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R1b)</dt>
<dd style="margin-left: 3.5em" id="section-3.1-2.2">The PE <span class="bcp14">MUST</span> support a combination of
        single-homed vESes and Single-Active multihomed vESes simultaneously
        on a single physical port, such as a single ENNI.  Throughout this
        document, Single-Active multihomed vESes will be referred to as
        "Single-Active vESes".<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R1c)</dt>
<dd style="margin-left: 3.5em" id="section-3.1-2.3">The PE <span class="bcp14">MAY</span> support All-Active multihomed
        vESes on a single physical port.  Throughout this document, All-Active
        multihomed vESes will be referred to as "All-Active vESes".<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R1d)</dt>
<dd style="margin-left: 3.5em" id="section-3.1-2.4">The PE <span class="bcp14">MAY</span> support a combination of
        All-Active vESes along with other types of vESes on a single physical
        port.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R1e)</dt>
<dd style="margin-left: 3.5em" id="section-3.1-2.5">A multihomed vES, whether Single-Active or All-Active, can
        span across two or more ENNIs on any two or more PEs.<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.2">
        <h3 id="name-local-switching">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-local-switching" class="section-name selfRef">Local Switching</a>
        </h3>
<p id="section-3.2-1"> Many vESes of different types can be aggregated on a single physical
   port on a PE device and some of these vESes can belong to the same
   service instance (e.g., EVI). This translates into the need for
   supporting local switching among the vESes for the same service
   instance on the same physical port (e.g., ENNI) of the PE.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2-2">
        <dt>(R2a)</dt>
<dd style="margin-left: 3.5em" id="section-3.2-2.1">A PE device that supports the vES function <span class="bcp14">MUST</span> support local switching among different vESes associated with the same service instance on a single physical port. For instance, in <a href="#fig-1" class="auto internal xref">Figure 1</a>, PE1 must support local switching between CE11 and CE12, which are mapped to two single-homed vESes on ENNI1. In the case of Single-Active vESes, the local switching is performed among active EVCs associated with the same service 
   instance on the same ENNI.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.3">
        <h3 id="name-evc-service-types">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-evc-service-types" class="section-name selfRef">EVC Service Types</a>
        </h3>
<p id="section-3.3-1"> A physical port, such as an ENNI of a PE device, can aggregate numerous 
   EVCs, each associated with a vES. An EVC may carry one or more VLANs. Typically, 
   an EVC carries a single VLAN and is therefore associated with a single broadcast 
   domain. However, there are no restrictions preventing an EVC from carrying 
   multiple VLANs.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3-2">
        <dt>(R3a)</dt>
<dd style="margin-left: 3.5em" id="section-3.3-2.1">An EVC can be associated with a single broadcast domain, such as in 
   a VLAN-based service or a VLAN bundle service.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R3b)</dt>
<dd style="margin-left: 3.5em" id="section-3.3-2.2">An EVC <span class="bcp14">MAY</span> be associated with several broadcast domains, such as in
   a VLAN-aware bundle service.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-3"> Similarly, a PE can aggregate multiple LSPs and PWs. In the case of individual 
   PWs per vES, a PW is typically associated with a single broadcast domain, although 
   there are no restrictions preventing a PW from carrying multiple VLANs if the PW 
   is configured in Raw mode.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.3-4">
        <dt>(R3c)</dt>
<dd style="margin-left: 3.5em" id="section-3.3-4.1">A PW can be associated with a single broadcast domain, such as in a 
   VLAN-based service or a VLAN bundle service.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R3d)</dt>
<dd style="margin-left: 3.5em" id="section-3.3-4.2">A PW <span class="bcp14">MAY</span> be associated with several broadcast domains, such as in a
   VLAN-aware bundle service.<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.4">
        <h3 id="name-designated-forwarder-df-ele">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-designated-forwarder-df-ele" class="section-name selfRef">Designated Forwarder (DF) Election</a>
        </h3>
<p id="section-3.4-1"><span><a href="https://rfc-editor.org/rfc/rfc7432#section-8.5" class="relref">Section 8.5</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> specifies the default procedure for DF 
   election in EVPN, which is also applied in <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> and 
   <span>[<a href="#RFC8214" class="cite xref">RFC8214</a>]</span>. <span>[<a href="#RFC8584" class="cite xref">RFC8584</a>]</span> elaborates on additional 
   procedures for DF election in EVPN. These DF election procedures are performed at 
   the granularity of (ESI, Ethernet Tag). In the context of a vES, the same EVPN default 
   procedure for DF election is applicable but at the granularity of (vESI, Ethernet Tag). 
   In this context, the Ethernet Tag is represented by an I-SID in PBB-EVPN and by a 
   VLAN ID (VID) in EVPN.

   As described in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, this default procedure for DF election at 
   the granularity of (vESI, Ethernet Tag) is also known as "service carving." The goal 
   of service carving is to evenly distribute the DFs for different vESes among various PEs, 
   thereby ensuring an even distribution of traffic across the PEs. The following 
   requirements are applicable to the DF election of vESes for EVPN and PBB-EVPN.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.4-2">
        <dt>(R4a)</dt>
<dd style="margin-left: 3.5em" id="section-3.4-2.1">A PE that supports vES function <span class="bcp14">MUST</span> support a vES with m EVCs among
   n ENNIs belonging to p PEs in any arbitrary order, where n &gt;= p &gt;= m &gt;=2.
   For example, if there is a vES with 2 EVCs and there are 5 ENNIs on 5 PEs 
   (PE1 through PE5), then vES can be dual-homed to PE2 and PE4, and the DF 
   election must be performed between PE2 and PE4.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R4b)</dt>
<dd style="margin-left: 3.5em" id="section-3.4-2.2">Each vES <span class="bcp14">MUST</span> be identified by its own virtual ESI (vESI).<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.5">
        <h3 id="name-evc-monitoring">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-evc-monitoring" class="section-name selfRef">EVC Monitoring</a>
        </h3>
<p id="section-3.5-1"> To detect the failure of an individual EVC and subsequently perform DF 
   election for its associated vES as a result of this failure, each EVC should 
   be monitored independently.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.5-2">
        <dt>(R5a)</dt>
<dd style="margin-left: 3.5em" id="section-3.5-2.1">Each EVC <span class="bcp14">SHOULD</span> be independently monitored for its operational health.<a href="#section-3.5-2.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R5b)</dt>
<dd style="margin-left: 3.5em" id="section-3.5-2.2">A failure in a single EVC, among many aggregated on a single physical 
   port or ENNI, <span class="bcp14">MUST</span> trigger a DF election for its associated vES.<a href="#section-3.5-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.6">
        <h3 id="name-failure-and-recovery">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-failure-and-recovery" class="section-name selfRef">Failure and Recovery</a>
        </h3>
<span class="break"></span><dl class="olPercent" id="section-3.6-1">
        <dt>(R6a)</dt>
<dd style="margin-left: 3.5em" id="section-3.6-1.1">Failure and failure recovery of an EVC for a single-homed vES
   <span class="bcp14">SHALL NOT</span> impact any other EVCs within its service instance or any
   other service instances. In other words, for PBB-EVPN, it <span class="bcp14">SHALL NOT</span>
   trigger any MAC flushing within both its own I-SID and other
   I-SIDs.<a href="#section-3.6-1.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R6b)</dt>
<dd style="margin-left: 3.5em" id="section-3.6-1.2">In case of All-Active vES, failure and failure
   recovery of an EVC for that vES <span class="bcp14">SHALL NOT</span> impact any other EVCs within
   its service instance or any other service instances. In other
   words, for PBB-EVPN, it <span class="bcp14">SHALL NOT</span> trigger any MAC flushing
   within both its own I-SID and other I-SIDs.<a href="#section-3.6-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R6c)</dt>
<dd style="margin-left: 3.5em" id="section-3.6-1.3">Failure and failure recovery of an EVC for a Single-Active vES
   <span class="bcp14">SHALL</span> impact only its own service instance. In other words, for PBB-EVPN,
   MAC flushing <span class="bcp14">SHALL</span> be limited to the associated I-SID only and
   <span class="bcp14">SHALL NOT</span> impact any other I-SIDs.<a href="#section-3.6-1.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(R6d)</dt>
<dd style="margin-left: 3.5em" id="section-3.6-1.4">Failure and failure recovery of an EVC for a Single-Active vES
   <span class="bcp14">MUST</span> only impact C-MACs associated with a multihomed device/network for that service
   instance. In other words, MAC flushing <span class="bcp14">MUST</span> be limited to a single
   service instance (I-SID in the case of PBB-EVPN) and only C-MACs for a
   Single-Active multihomed device/network.<a href="#section-3.6-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.7">
        <h3 id="name-fast-convergence">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-fast-convergence" class="section-name selfRef">Fast Convergence</a>
        </h3>
<p id="section-3.7-1"> Since many EVCs (and their associated vESes) are
   aggregated via a single physical port (e.g., ENNI), when there is a failure
   of that physical port, it impacts many vESes and equally triggers
   many ES route withdrawals. Formulating, sending,
   receiving, and processing such large numbers of BGP messages can
   introduce delay in DF election and convergence time. As such, it is
   highly desirable to have a mass-withdraw mechanism similar to the one
   in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> for withdrawing many Ethernet A-D per ES routes.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.7-2">
     <dt>(R7a)</dt>
<dd style="margin-left: 3.5em" id="section-3.7-2.1">There <span class="bcp14">SHOULD</span> be a mechanism equivalent to EVPN mass withdraw
 such that upon an ENNI failure, only a single BGP message to the PEs is needed to trigger DF election for all impacted vESes associated with that ENNI.<a href="#section-3.7-2.1" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-solution-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-solution-overview" class="section-name selfRef">Solution Overview</a>
      </h2>
<p id="section-4-1"> The solutions described in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>
      are leveraged         
   as is, with the modification that the ESI assignment is
   performed for an EVC or a group of EVCs or LSPs/PWs instead of a link or a group of
   physical links. In other words, the ESI is associated with a vES (hereby referred to as the "vESI").<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"> In the EVPN solution, the overall procedures remain consistent, 
   with the primary difference being the handling of physical port failures 
   that can affect multiple vESes. Sections <a href="#fail_evc_sa_evpn" class="auto internal xref">5.1</a> 
   and <a href="#fail_port_sa_evpn" class="auto internal xref">5.3</a> describe the 
   procedures for managing physical port or link failures in the context of EVPN. 
   In a typical multihomed setup, MAC addresses learned behind a vES are 
   advertised using the ESI associated with the vES (i.e., the vESI). 
   EVPN aliasing and mass-withdraw operations are conducted with respect to the 
   vES identifier. Specifically, the Ethernet A-D routes for these 
      operations are advertised using the vESI instead of the ESI.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3"> For the PBB-EVPN solution, the main change is with respect to the B-MAC
   address assignment, which is performed in a similar way to what is described in
   <span><a href="https://rfc-editor.org/rfc/rfc7623#section-6.2.1.1" class="relref">Section 6.2.1.1</a> of [<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>, with the following refinements:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1"> One shared B-MAC address <span class="bcp14">SHOULD</span> be used per PE for the single-homed
   vESes. In other words, a single B-MAC is shared for all single-homed
   vESes on that PE.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1"> One shared B-MAC address <span class="bcp14">SHOULD</span> be used per PE, per physical port
   (e.g., ENNI) for the Single-Active vESes. In other words, a single
   B-MAC is shared for all Single-Active vESes that share the same ENNI.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1"> One shared B-MAC address <span class="bcp14">MAY</span> be used for all Single-Active vESes on
   that PE.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.4">
          <p id="section-4-4.4.1"> One B-MAC address <span class="bcp14">SHOULD</span> be used per set of EVCs representing an
   All-Active vES.  In other words, a single B-MAC address is
   used per vES for All-Active scenarios.<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.5">
          <p id="section-4-4.5.1"> A single B-MAC address <span class="bcp14">MAY</span> also be used per vES, per PE for Single-Active scenarios.<a href="#section-4-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="df_election">
<section id="section-4.1">
        <h3 id="name-evpn-df-election-for-ves">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-evpn-df-election-for-ves" class="section-name selfRef">EVPN DF Election for vES</a>
        </h3>
<p id="section-4.1-1">
   The service carving procedures for vESes are
   almost the same as the procedures outlined in <span><a href="https://rfc-editor.org/rfc/rfc7432#section-8.5" class="relref">Section 8.5</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>
   and in <span>[<a href="#RFC8584" class="cite xref">RFC8584</a>]</span>, except that ES is replaced with vES.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">For the sake of clarity and completeness, the default DF election
   procedure of <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> is repeated below with the necessary 
   changes:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-3">
   <li id="section-4.1-3.1">
            <p id="section-4.1-3.1.1"> When a PE discovers the vESI or is configured with the vESI
            associated with its attached vES, it advertises an ES route with the associated ES-Import Route Target extended community
            attribute.<a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-3.2">
            <p id="section-4.1-3.2.1"> The PE then starts a timer (default value = 3 seconds) to
            allow the reception of ES routes from other PE nodes
            connected to the same vES. This timer value <span class="bcp14">MUST</span> be
            the same across all PEs connected to the same vES.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-3.3">
            <p id="section-4.1-3.3.1"> When the timer expires, each PE builds an ordered list of the
            IP addresses of all the PE nodes connected to the vES (including
            itself), in increasing numeric value. Each IP address in this list
            is extracted from the "Originator Router's IP address" field of
            the advertised ES route. Every PE is then given an
            ordinal indicating its position in the ordered list, starting with
            0 as the ordinal for the PE with the numerically lowest IP
            address. The ordinals are used to determine which PE node will be
            the DF for a given EVPN instance on the vES using the following
            rule: Assuming a redundancy group of N PE nodes, the PE with
            ordinal i is the DF for an EVPN instance with an associated
            Ethernet Tag value of V when (V mod N) = i.  It should be noted
            that using the "Originator Router's IP address" field in the ES
            route to get the PE IP address needed for the ordered
            list allows a CE to be multihomed across different ASes, if
            such need ever arises.<a href="#section-4.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-3.4">
            <p id="section-4.1-3.4.1"> The PE that is elected as a DF for a given EVPN instance will
            unblock traffic for that EVPN instance. Note that the DF PE
            unblocks all traffic in both ingress and egress directions for
            Single-Active vESes and unblocks multi-destination in the egress
            direction for All-Active multihomed vESes. All non-DF PEs block all
            traffic in both ingress and egress directions for Single-Active
            vESes and block multi-destination traffic in the egress direction
            for All-Active vESes.<a href="#section-4.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.1-4"> In case of an EVC failure, the affected PE withdraws its corresponding ES route if there are no more EVCs associated to the vES in the
   PE. This will re-trigger the DF election procedure on all the PEs in
   the redundancy group. For PE node failure, or upon PE commissioning
   or decommissioning, the PEs re-trigger the DF election procedure
   across all affected vESes.
   In case of a Single-Active scenario,
   when a service moves from one PE in the redundancy group to another
   PE because of DF re-election, the PE (which ends up being the
   elected DF for the service) <span class="bcp14">MUST</span> trigger a MAC address flush
   notification towards the associated vES if the multihoming device is a bridge
   or the multihoming network is an Ethernet bridged network.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5"> For LSP-based and PW-based vES, the non-DF PE <span class="bcp14">SHOULD</span> signal PW-status
   'standby' to the Aggregation PE (e.g., AG1 and AG2 in <a href="#fig-2" class="auto internal xref">Figure 2</a>),
   and a new DF PE <span class="bcp14">MAY</span> send a Label Distribution Protocol (LDP) MAC withdraw message as a MAC
   address flush notification. It should be noted that the PW-status is
   signaled for the scenarios where there is a one-to-one mapping
   between EVI (EVPN instance) and the PW.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="grouping">
<section id="section-4.2">
        <h3 id="name-grouping-and-route-coloring">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-grouping-and-route-coloring" class="section-name selfRef">Grouping and Route Coloring for vES</a>
        </h3>
<p id="section-4.2-1">Physical ports (e.g., ENNI) that aggregate many EVCs
        are 'colored' to enable the grouping schemes described below.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">By default, the MAC address of the corresponding port (e.g., ENNI)
        is used to represent the 'color' of the port, and the
        EVPN Router's MAC Extended Community defined
        in <span>[<a href="#RFC9135" class="cite xref">RFC9135</a>]</span> is used to signal this color.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The difference between coloring mechanisms for EVPN and PBB-EVPN is that 
        the extended community is advertised with the Ethernet A-D per ES
        route for EVPN, whereas the extended community is advertised
        with the B-MAC route for PBB-EVPN.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4"> The subsequent sections detailing Grouping of Ethernet A-D 
     per ES routes and Grouping of B-MAC addresses will be essential for addressing port 
     failure handling, as discussed in Sections <a href="#fail_port_sa_evpn" class="auto internal xref">5.3</a>, 
     <a href="#fail_port_sa_pbbevpn" class="auto internal xref">5.4</a>, and <a href="#convergence" class="auto internal xref">5.5</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div id="grouping_evpn">
<section id="section-4.2.1">
          <h4 id="name-evpn-route-coloring-for-ves">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-evpn-route-coloring-for-ves" class="section-name selfRef">EVPN Route Coloring for vES</a>
          </h4>
<p id="section-4.2.1-1">When a PE discovers the vESI or is configured with the vESI associated
            with its attached vES, an ES route and Ethernet A-D per ES
            route are generated using the vESI identifier.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">These ES and Ethernet A-D per ES routes specific to each
            vES are colored with an attribute representing their association
            to a physical port (e.g., ENNI).<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">The corresponding port 'color' is encoded in the 
            EVPN Router's MAC Extended Community defined in <span>[<a href="#RFC9135" class="cite xref">RFC9135</a>]</span> 
            and advertised along with the ES and Ethernet A-D per ES 
            routes for this vES. The color (which is the MAC address of the port) <span class="bcp14">MUST</span>
            be unique.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The PE also constructs a special Grouping Ethernet A-D per ES route
            that represents all the vESes associated with the port (e.g., ENNI). 
            The corresponding port 'color' is encoded in the ESI field.
            For this encoding, Type 3 ESI (<span><a href="https://rfc-editor.org/rfc/rfc7432#section-5" class="relref">Section 5</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>) is used
            with the MAC field set to the color (MAC address) of the port
            and the 3-octet local discriminator field set to 0xFFFFFF.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">The ESI label extended community (<span><a href="https://rfc-editor.org/rfc/rfc7432#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>)
            is not relevant to Grouping Ethernet A-D per ES route. The label value is not
            used for encapsulating Broadcast, Unknown Unicast, and Multicast (BUM) packets
            for any split-horizon function. The ESI
            label extended community <span class="bcp14">MUST NOT</span> be added to Grouping Ethernet A-D per ES route and
            <span class="bcp14">MUST</span> be ignored on receiving the PE.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6"> The Grouping Ethernet A-D per ES route is advertised with a 
         list of Route Targets corresponding to the affected service instances. If the 
         number of associated Route Targets exceeds the capacity of a single route, 
         multiple Grouping Ethernet A-D per ES routes are advertised accordingly as
         specified in <span><a href="https://rfc-editor.org/rfc/rfc7432#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>.<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="grouping_pbbevpn">
<section id="section-4.2.2">
          <h4 id="name-pbb-evpn-route-coloring-for">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-pbb-evpn-route-coloring-for" class="section-name selfRef">PBB-EVPN Route Coloring for vES</a>
          </h4>
<p id="section-4.2.2-1"> In PBB-EVPN, particularly when there are large numbers of service instances 
         (i.e., I-SIDs) associated with each EVC, the PE device <span class="bcp14">MAY</span> assign a color attribute 
         to each vES B-MAC route, indicating their association with a physical port 
         (e.g., an ENNI).<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The corresponding port 'color' is encoded in the 
            EVPN Router's MAC Extended Community defined
            in <span>[<a href="#RFC9135" class="cite xref">RFC9135</a>]</span> and advertised
            along with the B-MAC for this vES in PBB-EVPN.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">The PE <span class="bcp14">MAY</span> also construct a special Grouping B-MAC route
            that represents all the vESes associated with the port (e.g., ENNI).
            The corresponding port 'color' is encoded directly into this
            special Grouping B-MAC route.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="failure">
<section id="section-5">
      <h2 id="name-failure-handling-and-recove">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-failure-handling-and-recove" class="section-name selfRef">Failure Handling and Recovery</a>
      </h2>
<p id="section-5-1"> There are several failure scenarios to consider such as:<a href="#section-5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5-2">
        <dt id="section-5-2.1">A:</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.2">CE uplink port failure<a href="#section-5-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-2.3">B:</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.4">Ethernet Access Network failure<a href="#section-5-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-2.5">C:</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.6">PE access-facing port or link failure<a href="#section-5-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-2.7">D:</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.8">PE node failure<a href="#section-5-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-2.9">E:</dt>
        <dd style="margin-left: 1.5em" id="section-5-2.10">PE isolation from IP/MPLS network<a href="#section-5-2.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-3">
   The solutions specified in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span>, 
   and <span>[<a href="#RFC8214" class="cite xref">RFC8214</a>]</span> provide protection against failures as described in 
   these respective references. In the context of these solutions, the presence of vESes 
   introduces an additional failure scenario beyond those already considered, specifically 
   the failure of individual EVCs. Addressing vES failure scenarios necessitates the 
   independent monitoring of EVCs or PWs. Upon detection of failure or service restoration, 
   appropriate DF election and failure recovery mechanisms must be executed.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4"> <span>[<a href="#RFC7023" class="cite xref">RFC7023</a>]</span> is used for monitoring EVCs, and upon failure detection of a
   given EVC, the DF election procedure per <a href="#df_election" class="auto internal xref">Section 4.1</a> is executed. For
   PBB-EVPN, some extensions are needed to handle the failure and
   recovery procedures of <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> to meet the above
   requirements. These extensions are described in the next section.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5"> <span>[<a href="#RFC4377" class="cite xref">RFC4377</a>]</span> and <span>[<a href="#RFC6310" class="cite xref">RFC6310</a>]</span> are used for monitoring the status of LSPs
   and/or PWs associated to vES.<a href="#section-5-5" class="pilcrow">¶</a></p>
<span id="name-failure-scenarios-a-b-c-d-a"></span><div id="fig-3">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-5-6.1">
<pre>
                      B            D
                      ||           ||
                      \/           \/
                    +-----+
       +-----+      |     |       +---+
       | CE1 |EVC2--0=====0--ENNI1|   |   +-------+
       +-----+      |    =0--ENNI1|PE1|---|       |  +---+  +---+
       Cust. A      |   / |       |   |   |IP/MPLS|--|PE3|--|CE4|
       +-----+      |  /  |       +---+   |Network|  |   |  +---+
       |     |EVC2--0==   |               |       |  +---+
       | CE2 |      |     |       +---+   |       |
       |     |EVC3--0=====0--ENNI2|PE2|---|       |
       +-----+      |     |       |   |   +-------+
                    +-----+       +---+
              /\                /\     /\
              ||                ||     ||
              A                 C      E</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-failure-scenarios-a-b-c-d-a" class="selfRef">Failure Scenarios A, B, C, D, and E</a>
        </figcaption></figure>
</div>
<div id="fail_evc_sa_evpn">
<section id="section-5.1">
        <h3 id="name-evc-failure-handling-for-si">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-evc-failure-handling-for-si" class="section-name selfRef">EVC Failure Handling for Single-Active vES in EVPN</a>
        </h3>
<p id="section-5.1-1">
   In <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, when a DF PE connected to a Single-Active multihomed ES loses connectivity to the segment, due to link or port
   failure, it signals the remote PEs to invalidate all MAC addresses
   associated with that ES. This is done by means of a
   mass-withdraw message, by withdrawing the Ethernet A-D per ES route.
   It should be
   noted that for dual-homing use cases where there is only a single
   backup path, MAC invalidating can be avoided by the remote PEs as they
   can update their next hop associated with the affected MAC
   entries to the backup path per the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc7432#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
   In case of an EVC failure that impacts a single vES, this same
   EVPN procedure is used. In this case, the mass withdraw is conveyed
   by withdrawing the Ethernet A-D per vES route carrying the vESI representing
   the failed EVC. Upon receiving this
   message, the remote PEs perform the same procedures outlined in <span><a href="https://rfc-editor.org/rfc/rfc7432#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fail_evc_sa_pbbevpn">
<section id="section-5.2">
        <h3 id="name-evc-failure-handling-for-a-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-evc-failure-handling-for-a-" class="section-name selfRef">EVC Failure Handling for a Single-Active vES in PBB-EVPN</a>
        </h3>
<p id="section-5.2-1"> In <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>, when a PE connected to a Single-Active ES
   loses connectivity to the segment, due to link or port failure, it
   signals the remote PE to flush all C-MAC addresses associated with
   that ES. This is done by updating the advertised B-MAC route's 
   MAC Mobility extended community.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2"> In case of an EVC failure that impacts a single vES, if the above
   PBB-EVPN procedure is used, it results in excessive C-MAC flushing
   because a single physical port can support a large number of EVCs (and
   their associated vESes); therefore, updating the advertised B-MAC corresponding to
   the physical port, with MAC Mobility extended community, will result in
   flushing C-MAC addresses not just for the impacted EVC but for all
   other EVCs on that port.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3"> To reduce the scope of C-MAC flushing to only the impacted
   service instances (the service instance(s) impacted by the EVC
   failure), the PBB-EVPN C-MAC flushing needs to be adapted on a per-service-instance
   basis (i.e., per I-SID).

   <span>[<a href="#RFC9541" class="cite xref">RFC9541</a>]</span> introduces a B-MAC/I-SID route where the 
   existing PBB-EVPN B-MAC route is modified to carry an I-SID, instead of a NULL value, in the "Ethernet Tag ID" field. To the receiving PE, this field indicates flushing all 
   C-MAC addresses associated with that I-SID for that B-MAC. This C-MAC flushing mechanism per I-SID 
   <span class="bcp14">SHOULD</span> be used in case of an EVC failure impacting a vES. Since an EVC typically maps to a single
   broadcast domain and thus a single service instance, the affected PE only needs to 
   advertise a single B-MAC/I-SID route.
   However, if the failed EVC carries multiple
   VLANs each with its own broadcast domain, then the affected PE needs to advertise multiple
   B-MAC/I-SID routes, i.e., one route for each VLAN (broadcast domain), meaning one route for each I-SID.
   Each B‑MAC/I-SID route basically instructs the remote PEs to perform flushing for
   C-MACs corresponding to the advertised B-MAC only for the advertised I-SID.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4"> The C-MAC flushing based on a B-MAC/I-SID route works fine when there are only a few
   VLANs (e.g., I-SIDs) per EVC. However, if the number of I-SIDs associated with a 
   failed EVC is large, then it is <span class="bcp14">RECOMMENDED</span> to assign a B-MAC per vES, and upon EVC failure, 
   the affected PE simply withdraws this B-MAC message to other PEs.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fail_port_sa_evpn">
<section id="section-5.3">
        <h3 id="name-port-failure-handling-for-s">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-port-failure-handling-for-s" class="section-name selfRef">Port Failure Handling for Single-Active vESes in EVPN</a>
        </h3>
<p id="section-5.3-1"> When many EVCs are aggregated via a single physical port
   on a PE, where each EVC corresponds to a vES, then the port failure
   impacts all the associated EVCs and their corresponding vESes. If the
   number of EVCs corresponding to the Single-Active vESes for that
   physical port is in the thousands, then thousands of service instances
   are impacted. Therefore, the propagation of failure in BGP needs
   to address all these impacted service instances. In order to achieve this,
   the following extensions are added to the baseline EVPN mechanism:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">
            <p id="section-5.3-2.1.1"> The PE <span class="bcp14">MAY</span> color each Ethernet A-D per ES route
            for a given vES, as described in <a href="#grouping_evpn" class="auto internal xref">Section 4.2.1</a>. The PE <span class="bcp14">SHOULD</span> use the
            MAC physical port by default.  The receiving PEs take note of this
            color and create a list of vESes for this color.<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">The PE <span class="bcp14">MAY</span> advertise a special Grouping
            Ethernet A-D per ES route for that color, which represents all the
            vESes associated with the port.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.3">
            <p id="section-5.3-2.3.1"> Upon a port failure (e.g., an ENNI failure), the PE
            <span class="bcp14">MAY</span> send a mass-withdraw message by withdrawing the
            Grouping Ethernet A-D per ES route.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.4">
            <p id="section-5.3-2.4.1"> When this message is received, the remote PE
            <span class="bcp14">MAY</span> detect the special vES mass-withdraw message by
            identifying the Grouping Ethernet A-D per ES route. The remote PEs
            <span class="bcp14">MAY</span> then access the list of vESes created
            per item 1 for the specified color and locally initiate MAC address
            invalidating procedures for each of the vESes in the list.<a href="#section-5.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.3-3">

   In scenarios where a logical ENNI is used, the above procedure equally
   applies. The logical ENNI is represented by a Grouping Ethernet A-D per ES
   route where the Type 3 ESI and the 6 bytes used in the ENNI's ESI MAC address
   field are used as a color for the vESes as described above
   and in <a href="#grouping_evpn" class="auto internal xref">Section 4.2.1</a>.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fail_port_sa_pbbevpn">
<section id="section-5.4">
        <h3 id="name-port-failure-handling-for-si">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-port-failure-handling-for-si" class="section-name selfRef">Port Failure Handling for Single-Active vESes in PBB-EVPN</a>
        </h3>
<p id="section-5.4-1">When many EVCs are aggregated via a single physical port
   on a PE, where each EVC corresponds to a vES, then the port failure
   impacts all the associated EVCs and their corresponding vESes. If the
   number of EVCs corresponding to the Single-Active vESes for that
   physical port is in the thousands, then thousands of service instances (I-SIDs) are impacted. In such failure scenarios, the following two
   MAC flushing mechanisms per <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> can be performed.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-2">
<li id="section-5.4-2.1">
            <p id="section-5.4-2.1.1"> If the MAC address of the physical port is used for PBB
            encapsulation as B-MAC SA, then upon the port failure, the PE
            <span class="bcp14">MUST</span> use the EVPN MAC route withdrawal message to
            signal the flush.<a href="#section-5.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-2.2">
            <p id="section-5.4-2.2.1"> If the PE's shared MAC address is used for PBB encapsulation as
            B-MAC SA, then upon the port failure, the PE <span class="bcp14">MUST</span>
            re-advertise this MAC route with the MAC Mobility extended
            community to signal the flush.<a href="#section-5.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.4-3">

   The first method is recommended because it reduces the scope of
   flushing the most.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">As noted above, the
   advertisement of the extended community along with the B-MAC route for coloring purposes is optional
   and only recommended when there are many vESes per physical port and each vES is associated with
   a very large number of service instances (i.e., a large number of I-SIDs).<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5"> If there are large numbers of service instances (i.e., I-SIDs)
   associated with each EVC, and if there is a B-MAC assigned per vES 
   as recommended in the above section, then in order to handle
   port failure efficiently, the following extensions are added
   to the baseline PBB-EVPN mechanism:<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-6">
   <li id="section-5.4-6.1">
            <p id="section-5.4-6.1.1">Each vES <span class="bcp14">MAY</span> be colored with a MAC address representing the
   physical port like the coloring mechanism for EVPN.
   In other words, each B-MAC representing a vES is advertised
   with the 'color' of the physical port per <a href="#grouping_pbbevpn" class="auto internal xref">Section 4.2.2</a>.
   
   The receiving PEs take note of this color being advertised
   along with the B-MAC route, and for each such color, they
   create a list of vESes associated with this color.<a href="#section-5.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-6.2">
            <p id="section-5.4-6.2.1">The PE <span class="bcp14">MAY</span> advertise a special Grouping B-MAC route
   for that color (consisting of a port MAC address by default),
   which represents all the vESes associated with the port.<a href="#section-5.4-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-6.3">
            <p id="section-5.4-6.3.1"> Upon a port failure (e.g., ENNI failure), the PE <span class="bcp14">MAY</span> send a mass-withdraw
   message by withdrawing the Grouping B-MAC route.<a href="#section-5.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-6.4">
            <p id="section-5.4-6.4.1"> When this message is received, the remote PE <span class="bcp14">MAY</span> 
   detect the special vES mass-withdraw message by identifying the
   Grouping B-MAC route. The remote PEs <span class="bcp14">MAY</span> then access the list created 
   in (1) above for the specified color and flush all C-MACs associated with the failed physical port.<a href="#section-5.4-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="convergence">
<section id="section-5.5">
        <h3 id="name-fast-convergence-in-evpn-an">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-fast-convergence-in-evpn-an" class="section-name selfRef">Fast Convergence in EVPN and PBB-EVPN</a>
        </h3>
<p id="section-5.5-1">As described above, when many EVCs are aggregated via a
   physical port on a PE, and where each EVC corresponds to a vES, the
   port failure impacts all the associated EVCs and their corresponding
   vESes. Two actions must be taken as the result of such a port failure:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">
            <p id="section-5.5-2.1.1"> For EVPN, initiate the mass-withdraw procedure for all vESes associated with 
   the failed port to invalidate MACs and for PBB-EVPN to flush all C-MACs associated with 
   the failed port across all vESes and the impacted I-SIDs<a href="#section-5.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-2.2">
            <p id="section-5.5-2.2.1"> Use DF election for all impacted vESes associated with the failed port<a href="#section-5.5-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.5-3">

   <a href="#fail_port_sa_evpn" class="auto internal xref">Section 5.3</a> already describes how to perform a mass withdraw
   for all affected vESes and invalidate MACs using a single BGP withdrawal
   of the Grouping Ethernet A-D per ES route.
   <a href="#fail_port_sa_pbbevpn" class="auto internal xref">Section 5.4</a> describes how to only flush C-MAC addresses 
   associated with the failed physical port (e.g., optimum C-MAC flushing)
   as well as, optionally, the withdrawal of a Grouping B-MAC route.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">This section describes how to perform DF election in the most
   optimal way, e.g., by triggering DF election for all impacted vESes
   (which can be very large) among the participating PEs via a single
   BGP message as opposed to sending a large number of BGP messages (one per
   vES). This section assumes that the MAC flushing mechanism described in
   <a href="#fail_port_sa_pbbevpn" class="auto internal xref">Section 5.4</a> and route coloring are used.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<span id="name-fast-convergence-upon-enni-"></span><div id="fig-4">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-5.5-5.1">
<pre>
                  +-----+
       +----+     |     |       +---+
       | CE1|AC1--0=====0--ENNI1|   |  +-------+
       |    |AC2--0     |       |PE1|--|       |
       +----+     |\  ==0--ENNI2|   |  |       |
                  | \/  |       +---+  |       |
                  | /\  |              |IP/MPLS|
       +----+     |/  \ |       +---+  |Network|   +---+  +---+
       | CE2|AC4--0    =0--ENNI3|   |  |       |---|PE4|--|CE4|
       |    |AC4--0=====0--ENNI3|PE2|--|       |   +---+  +---+
       +----+     | ====0--ENNI3|   |  |       |
                  |/    |       +---+  |       |
                  0     |              |       |
       +----+    /|     |       +---+  |       |
       | CE3|AC5- |     |       |PE3|--|       |
       |    |AC6--0=====0--ENNI4|   |  +-------+
       +----+     |     |       +---+
                  +-----+</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-fast-convergence-upon-enni-" class="selfRef">Fast Convergence Upon ENNI Failure</a>
          </figcaption></figure>
</div>
<p id="section-5.5-6">
   As discussed in <a href="#grouping" class="auto internal xref">Section 4.2</a>, it is highly desirable to have a
   mass-withdraw mechanism similar to the one in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span>. Although
   such an optimization is desirable, it is <span class="bcp14">OPTIONAL</span>. If the optimization is 
   implemented, the following procedures are used:<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5-7">
   <li id="section-5.5-7.1">
            <p id="section-5.5-7.1.1"> When a vES is configured, the PE advertises the ES route 
   for this vES with a color that corresponds to the associated physical port.<a href="#section-5.5-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-7.2">
            <p id="section-5.5-7.2.1"> All receiving PEs within the redundancy group record this color and 
   compile a list of vESes associated with it.<a href="#section-5.5-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-7.3">
            <p id="section-5.5-7.3.1"> Additionally, the PE advertises a Grouping Ethernet A-D per ES route for EVPN, 
   and a Grouping B-MAC route for PBB-EVPN, which corresponds to the color and vES grouping.<a href="#section-5.5-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-7.4">
            <p id="section-5.5-7.4.1"> In the event of a port failure, such as an ENNI failure, the PE withdraws 
   the previously advertised Grouping Ethernet A-D per ES route or Grouping B-MAC route associated 
   with the failed port. The PE should prioritize sending these Grouping route withdrawal 
   messages over the withdrawal of individual vES routes affected by the failure. For 
   instance, as depicted in <a href="#fig-4" class="auto internal xref">Figure 4</a>, when the physical port associated with ENNI3 fails 
   on PE2, it withdraws the previously advertised Grouping Ethernet A-D per ES route. 
   Upon receiving this withdrawal message, other multihoming PEs (such as PE1 and PE3) 
   recognize that the vESes associated with CE1 and CE3 are impacted, based on the associated 
   color, and thus initiate the DF election procedure for these vESes. Furthermore, upon receiving this withdrawal message, remote PEs (such as PE4) initiate the failover procedure 
   for the vESes associated with CE1 and CE3 and switch to the other PE for each vES 
   redundancy group.<a href="#section-5.5-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-7.5">
            <p id="section-5.5-7.5.1"> On reception of Grouping Ethernet A-D per ES route or Grouping B-MAC route withdrawal,
   other PEs in the redundancy group initiate DF election procedures
   across all their affected vESes.<a href="#section-5.5-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.5-7.6">
            <p id="section-5.5-7.6.1"> The PE with the physical port failure (ENNI failure) sends a
   vES route withdrawal for every impacted vES. Upon
   receiving these messages, the other PEs clear up their BGP tables. It should be
   noted that the vES route withdrawal messages are not used for executing DF
   election procedures by the receiving PEs when Grouping Ethernet A-D per ES
   route or Grouping B-MAC route withdrawal has been previously received.<a href="#section-5.5-7.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
   All the security considerations in <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> apply
   directly to this document because this document leverages the control
   and data plane procedures described in those documents.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
   This document does not introduce any new security considerations
   beyond that of <span>[<a href="#RFC7432" class="cite xref">RFC7432</a>]</span> and <span>[<a href="#RFC7623" class="cite xref">RFC7623</a>]</span> because advertisements and the
   processing of ES routes for vES in this document follow
   that of physical ES in those RFCs.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">
    This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7623">[RFC7623]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Salam, S.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"Provider Backbone Bridging Combined with Ethernet VPN (PBB-EVPN)"</span>, <span class="seriesInfo">RFC 7623</span>, <span class="seriesInfo">DOI 10.17487/RFC7623</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7623">https://www.rfc-editor.org/info/rfc7623</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8214">[RFC8214]</dt>
        <dd>
<span class="refAuthor">Boutros, S.</span>, <span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Salam, S.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"Virtual Private Wire Service Support in Ethernet VPN"</span>, <span class="seriesInfo">RFC 8214</span>, <span class="seriesInfo">DOI 10.17487/RFC8214</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8214">https://www.rfc-editor.org/info/rfc8214</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Shekhar, R.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9135">[RFC9135]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Salam, S.</span>, <span class="refAuthor">Thoria, S.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"Integrated Routing and Bridging in Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 9135</span>, <span class="seriesInfo">DOI 10.17487/RFC9135</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9135">https://www.rfc-editor.org/info/rfc9135</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9541">[RFC9541]</dt>
      <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Sathappan, S.</span>, <span class="refAuthor">Nagaraj, K.</span>, <span class="refAuthor">Miyake, M.</span>, and <span class="refAuthor">T. Matsuda</span>, <span class="refTitle">"Flush Mechanism for Customer MAC Addresses Based on Service Instance Identifier (I-SID) in Provider Backbone Bridging EVPN (PBB-EVPN)"</span>, <span class="seriesInfo">RFC 9541</span>, <span class="seriesInfo">DOI 10.17487/RFC9541</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9541">https://www.rfc-editor.org/info/rfc9541</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="MEF63">[MEF63]</dt>
        <dd>
<span class="refAuthor">Metro Ethernet Forum</span>, <span class="refTitle">"Subscriber Ethernet Services Definitions"</span>, <span class="refContent">MEF Standard</span>, <span class="seriesInfo">MEF 6.3</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://www.mef.net/resources/mef-6-3-subscriber-ethernet-service-definitions">https://www.mef.net/resources/mef-6-3-subscriber-ethernet-service-definitions</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4377">[RFC4377]</dt>
        <dd>
<span class="refAuthor">Nadeau, T.</span>, <span class="refAuthor">Morrow, M.</span>, <span class="refAuthor">Swallow, G.</span>, <span class="refAuthor">Allan, D.</span>, and <span class="refAuthor">S. Matsushima</span>, <span class="refTitle">"Operations and Management (OAM) Requirements for Multi-Protocol Label Switched (MPLS) Networks"</span>, <span class="seriesInfo">RFC 4377</span>, <span class="seriesInfo">DOI 10.17487/RFC4377</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4377">https://www.rfc-editor.org/info/rfc4377</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6310">[RFC6310]</dt>
        <dd>
<span class="refAuthor">Aissaoui, M.</span>, <span class="refAuthor">Busschbach, P.</span>, <span class="refAuthor">Martini, L.</span>, <span class="refAuthor">Morrow, M.</span>, <span class="refAuthor">Nadeau, T.</span>, and <span class="refAuthor">Y. Stein</span>, <span class="refTitle">"Pseudowire (PW) Operations, Administration, and Maintenance (OAM) Message Mapping"</span>, <span class="seriesInfo">RFC 6310</span>, <span class="seriesInfo">DOI 10.17487/RFC6310</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6310">https://www.rfc-editor.org/info/rfc6310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7023">[RFC7023]</dt>
        <dd>
<span class="refAuthor">Mohan, D., Ed.</span>, <span class="refAuthor">Bitar, N., Ed.</span>, <span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">DeLord, S.</span>, <span class="refAuthor">Niger, P.</span>, and <span class="refAuthor">R. Qiu</span>, <span class="refTitle">"MPLS and Ethernet Operations, Administration, and Maintenance (OAM) Interworking"</span>, <span class="seriesInfo">RFC 7023</span>, <span class="seriesInfo">DOI 10.17487/RFC7023</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7023">https://www.rfc-editor.org/info/rfc7023</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7080">[RFC7080]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Salam, S.</span>, <span class="refAuthor">Bitar, N.</span>, and <span class="refAuthor">F. Balus</span>, <span class="refTitle">"Virtual Private LAN Service (VPLS) Interoperability with Provider Backbone Bridges"</span>, <span class="seriesInfo">RFC 7080</span>, <span class="seriesInfo">DOI 10.17487/RFC7080</span>, <time datetime="2013-12" class="refDate">December 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7080">https://www.rfc-editor.org/info/rfc7080</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7209">[RFC7209]</dt>
        <dd>
<span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">A. Isaac</span>, <span class="refTitle">"Requirements for Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 7209</span>, <span class="seriesInfo">DOI 10.17487/RFC7209</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7209">https://www.rfc-editor.org/info/rfc7209</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8584">[RFC8584]</dt>
        <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Mohanty, S., Ed.</span>, <span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Nagaraj, K.</span>, and <span class="refAuthor">S. Sathappan</span>, <span class="refTitle">"Framework for Ethernet VPN Designated Forwarder Election Extensibility"</span>, <span class="seriesInfo">RFC 8584</span>, <span class="seriesInfo">DOI 10.17487/RFC8584</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8584">https://www.rfc-editor.org/info/rfc8584</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9252">[RFC9252]</dt>
      <dd>
<span class="refAuthor">Dawra, G., Ed.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9252</span>, <span class="seriesInfo">DOI 10.17487/RFC9252</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9252">https://www.rfc-editor.org/info/rfc9252</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
   The authors would like to thank <span class="contact-name">Mei Zhang</span>, <span class="contact-name">Jose Liste</span>, and <span class="contact-name">Luc André Burdet</span> for
   their reviews of this document and their feedback.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ali Sajassi</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sajassi@cisco.com" class="email">sajassi@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Patrice Brissette</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pbrisset@cisco.com" class="email">pbrisset@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rick Schell</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rick_schell@outlook.com" class="email">rick_schell@outlook.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John E. Drake</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:je_drake@yahoo.com" class="email">je_drake@yahoo.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jorge Rabadan</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jorge.rabadan@nokia.com" class="email">jorge.rabadan@nokia.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
