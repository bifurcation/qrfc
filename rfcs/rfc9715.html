<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9715: IP Fragmentation Avoidance in DNS over UDP</title>
<meta content="Kazunori Fujiwara" name="author">
<meta content="Paul Vixie" name="author">
<meta content="
       The widely
deployed Extension Mechanisms for DNS (EDNS(0)) feature in the DNS enables a DNS receiver to indicate
its received UDP message size capacity, which supports the sending of
large UDP responses by a DNS server.
Large DNS/UDP messages are more likely to be fragmented,
and IP fragmentation has exposed weaknesses in application protocols.
It is possible to avoid IP fragmentation in DNS by limiting the response
size where possible and signaling the need to upgrade from UDP to TCP
transport where necessary.
This document describes techniques to avoid IP fragmentation in DNS. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="DNS" name="keyword">
<meta content="IP Fragmentation" name="keyword">
<meta content="attack" name="keyword">
<meta content="9715" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9715.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-avoid-fragmentation-20" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9715" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9715</td>
<td class="center">Avoid IP Fragmentation</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fujiwara &amp; Vixie</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9715" class="eref">9715</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01" class="published">January 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Fujiwara</div>
<div class="org">JPRS</div>
</div>
<div class="author">
      <div class="author-name">P. Vixie</div>
<div class="org">AWS Security</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9715</h1>
<h1 id="title">IP Fragmentation Avoidance in DNS over UDP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The widely
deployed Extension Mechanisms for DNS (EDNS(0)) feature in the DNS enables a DNS receiver to indicate
its received UDP message size capacity, which supports the sending of
large UDP responses by a DNS server.
Large DNS/UDP messages are more likely to be fragmented,
and IP fragmentation has exposed weaknesses in application protocols.
It is possible to avoid IP fragmentation in DNS by limiting the response
size where possible and signaling the need to upgrade from UDP to TCP
transport where necessary.
This document describes techniques to avoid IP fragmentation in DNS.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9715">https://www.rfc-editor.org/info/rfc9715</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-how-to-avoid-ip-fragmentati" class="internal xref">How to Avoid IP Fragmentation in DNS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-proposed-recommendations-fo" class="internal xref">Proposed Recommendations for UDP Responders</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-proposed-recommendations-for" class="internal xref">Proposed Recommendations for UDP Requestors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-proposed-recommendations-for-" class="internal xref">Proposed Recommendations for DNS Operators</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protocol-compliance-conside" class="internal xref">Protocol Compliance Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-on-path-fragmentation-on-ip" class="internal xref">On-Path Fragmentation on IPv4</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-small-mtu-network" class="internal xref">Small MTU Network</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-weaknesses-of-ip-fragmentat" class="internal xref">Weaknesses of IP Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-dns-security-protections" class="internal xref">DNS Security Protections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-possible-actions-for-resolv" class="internal xref">Possible Actions for Resolver Operators</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-details-of-requestors-maxim" class="internal xref">Details of Requestor's Maximum UDP Payload Size Discussions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-minimal-responses" class="internal xref">Minimal Responses</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-known-implementations" class="internal xref">Known Implementations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-bind-9" class="internal xref">BIND 9</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-knot-dns-and-knot-resolver" class="internal xref">Knot DNS and Knot Resolver</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-powerdns-authoritative-serv" class="internal xref">PowerDNS Authoritative Server, PowerDNS Recursor, and PowerDNS dnsdist</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-powerdns-authoritative-serve" class="internal xref">PowerDNS Authoritative Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-unbound" class="internal xref">Unbound</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#appendix-C.6" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document was originally intended to be a Best Current Practice, but due to
operating system and socket option limitations, some of the
recommendations have not yet gained real-world experience;
therefore, this document is Informational.
It is expected that, as operating systems and implementations evolve,
we will gain more experience with the recommendations and will publish an
updated document as a Best Current Practice in the future.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">DNS has an EDNS(0) mechanism <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>.
The widely deployed EDNS(0) feature in the DNS enables a DNS receiver to indicate
its received UDP message size capacity, which supports the sending of
large UDP responses by a DNS server.
DNS over UDP invites IP fragmentation when a packet is larger than the
Maximum Transmission Unit (MTU) of some network in the packet's path.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Fragmented DNS UDP responses have systemic weaknesses, which expose
the requestor to DNS cache poisoning from off-path attackers (see <a href="#ProblemOfFragmentation" class="auto internal xref">Section 7.3</a> for references and details).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><span>[<a href="#RFC8900" class="cite xref">RFC8900</a>]</span> states that IP fragmentation
introduces fragility to Internet communication.
The transport of DNS messages
over UDP should take account of the observations stated in that document.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">TCP avoids fragmentation by segmenting data into packets that are smaller
      than or equal to the Maximum Segment Size (MSS). For each transmitted segment, the size of the IP and TCP headers is known,
and the IP packet size can be chosen to keep it within the estimated MTU and the MSS. This takes advantage of the elasticity of the TCP's
packetizing process, depending on how much queued data will fit into the next
segment. In contrast, DNS over UDP has little datagram size elasticity and
lacks insight into IP header and option size, so we must make more
conservative estimates about available UDP payload space.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><span>[<a href="#RFC7766" class="cite xref">RFC7766</a>]</span> states that all general-purpose DNS
      implementations <span class="bcp14">MUST</span> support both UDP and TCP transport.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">DNS transaction security <span>[<a href="#RFC8945" class="cite xref">RFC8945</a>]</span> <span>[<a href="#RFC2931" class="cite xref">RFC2931</a>]</span> does protect
against the security risks of fragmentation, and it protects
delegation responses. But <span>[<a href="#RFC8945" class="cite xref">RFC8945</a>]</span> has limited applicability due
to key distribution requirements, and there is little if any deployment
of <span>[<a href="#RFC2931" class="cite xref">RFC2931</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This document describes various techniques to avoid IP fragmentation
of UDP packets in DNS.
This document is primarily applicable to DNS use on the global Internet.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">In contrast, a path MTU that deviates from the
recommended value might be obtained through static configuration, server
routing hints, or a future discovery protocol.  However, addressing
this falls outside the scope of this document and may be the subject
of future specifications.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The definitions of "requestor" and "responder" are per <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>:<a href="#section-2-2" class="pilcrow">¶</a></p>
<blockquote id="section-2-3">
  "Requestor" refers to the side that sends a request.  "Responder"
refers to an authoritative, recursive resolver or other DNS component
that responds to questions.<a href="#section-2-3" class="pilcrow">¶</a>
</blockquote>
<p id="section-2-4">The definition of "path MTU" is per <span>[<a href="#RFC8201" class="cite xref">RFC8201</a>]</span>:<a href="#section-2-4" class="pilcrow">¶</a></p>
<blockquote id="section-2-5">path MTU [is] the minimum link MTU of all the links in a path
      between a source node and a destination node.<a href="#section-2-5" class="pilcrow">¶</a>
</blockquote>
<p id="section-2-6">In this document, the term "Path MTU Discovery" includes
both Classical Path MTU Discovery <span>[<a href="#RFC1191" class="cite xref">RFC1191</a>]</span> <span>[<a href="#RFC8201" class="cite xref">RFC8201</a>]</span> and
Packetization Layer Path MTU Discovery <span>[<a href="#RFC8899" class="cite xref">RFC8899</a>]</span>.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Many of the specialized terms used in this document are defined in
"DNS Terminology" <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recommendation">
<section id="section-3">
      <h2 id="name-how-to-avoid-ip-fragmentati">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-how-to-avoid-ip-fragmentati" class="section-name selfRef">How to Avoid IP Fragmentation in DNS</a>
      </h2>
<p id="section-3-1">These recommendations are intended
for nodes with global IP addresses on the Internet.
Private networks or local networks are out of the scope of this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The methods to avoid IP fragmentation in DNS are described below:<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="RecommendationsResponders">
<section id="section-3.1">
        <h3 id="name-proposed-recommendations-fo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-proposed-recommendations-fo" class="section-name selfRef">Proposed Recommendations for UDP Responders</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.1-1">
          <dt id="section-3.1-1.1">R1.</dt>
          <dd style="margin-left: 3.5em" id="section-3.1-1.2">UDP responders should not use IPv6 fragmentation
          <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-3.1-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.3">R2.</dt>
          <dd style="margin-left: 3.5em" id="section-3.1-1.4">
            <p id="section-3.1-1.4.1">UDP responders should configure their systems to
          prevent fragmentation of UDP packets when sending replies, provided
          it can be done safely. The mechanisms to achieve this vary across
          different operating systems.<a href="#section-3.1-1.4.1" class="pilcrow">¶</a></p>
<p id="section-3.1-1.4.2">For BSD-like operating systems, the IP Don't Fragment (DF) flag
          bit <span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span> can be used to prevent
          fragmentation. In contrast, Linux systems do not expose a direct API
          for this purpose and require the use of Path MTU socket options
          (IP_MTU_DISCOVER) to manage fragmentation settings. However, it is
          important to note that enabling IPv4 Path MTU Discovery for UDP in
          current Linux versions is considered harmful and dangerous. For more
          details, see <a href="#impl" class="auto internal xref">Appendix C</a>.<a href="#section-3.1-1.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.5">R3.</dt>
          <dd style="margin-left: 3.5em" id="section-3.1-1.6">UDP responders should compose response packets that
          fit in the minimum of the offered requestor's maximum UDP payload
          size <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>, the interface MTU, the network MTU
          value configured by the knowledge of the network operators, and the
          <span class="bcp14">RECOMMENDED</span> maximum DNS/UDP payload size 1400. For more details, see
          <a href="#details" class="auto internal xref">Appendix A</a>.<a href="#section-3.1-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.7">R4.</dt>
          <dd style="margin-left: 3.5em" id="section-3.1-1.8">If the UDP responder detects an immediate error
          indicating that the UDP packet exceeds the path MTU size, the UDP
          responder may recreate response packets that fit in the path MTU
          size or with the TC bit set.<a href="#section-3.1-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-2">The cause and effect of the TC bit are unchanged <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RecommendationsRequestors">
<section id="section-3.2">
        <h3 id="name-proposed-recommendations-for">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-proposed-recommendations-for" class="section-name selfRef">Proposed Recommendations for UDP Requestors</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.2-1">
          <dt id="section-3.2-1.1">R5.</dt>
          <dd style="margin-left: 3.5em" id="section-3.2-1.2">UDP requestors should limit the requestor's maximum
          UDP payload size to fit in the minimum of the interface MTU, the
          network MTU value configured by the network operators, and the
          <span class="bcp14">RECOMMENDED</span> maximum DNS/UDP payload size 1400.  A
          smaller limit may be allowed. For more details, see <a href="#details" class="auto internal xref">Appendix A</a>.<a href="#section-3.2-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-1.3">R6.</dt>
          <dd style="margin-left: 3.5em" id="section-3.2-1.4">UDP requestors should drop fragmented DNS/UDP
          responses without IP reassembly to avoid cache poisoning attacks (at
          the firewall function).<a href="#section-3.2-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-1.5">R7.</dt>
          <dd style="margin-left: 3.5em" id="section-3.2-1.6">DNS responses may be dropped by IP fragmentation.
          It is recommended that requestors eventually try alternative transport protocols.<a href="#section-3.2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="RecommendationOperators">
<section id="section-4">
      <h2 id="name-proposed-recommendations-for-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-proposed-recommendations-for-" class="section-name selfRef">Proposed Recommendations for DNS Operators</a>
      </h2>
<p id="section-4-1">Large DNS responses are typically the result of zone configuration.
      People who publish information in the DNS should seek configurations
      resulting in small responses.  For example:<a href="#section-4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-2">
        <dt id="section-4-2.1">R8.</dt>
        <dd style="margin-left: 3.5em" id="section-4-2.2">Use a smaller number of name servers.<a href="#section-4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3">R9.</dt>
        <dd style="margin-left: 3.5em" id="section-4-2.4">Use a smaller number of A/AAAA RRs for a domain name.<a href="#section-4-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">R10.</dt>
        <dd style="margin-left: 3.5em" id="section-4-2.6">Use minimal-responses configuration: Some
 implementations have a 'minimal responses' configuration option that
 causes DNS servers to make response packets smaller by containing only
 mandatory and required data (<a href="#minimal-responses" class="auto internal xref">Appendix B</a>).<a href="#section-4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.7">R11.</dt>
        <dd style="margin-left: 3.5em" id="section-4-2.8">Use a smaller signature / public key size algorithm
 for DNSSEC.  Notably, the signature sizes of the Elliptic Curve Digital Signature Algorithm (ECDSA)  and Edwards-curve Digital Signature Algorithm (EdDSA) are
 smaller than those of equivalent cryptographic strength using RSA.<a href="#section-4-2.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-3">It is difficult to determine a specific upper limit for R8, R9, and
R11, but it is sufficient if all responses from the DNS servers are
below the size of R3 and R5.<a href="#section-4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-5">
      <h2 id="name-protocol-compliance-conside">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-compliance-conside" class="section-name selfRef">Protocol Compliance Considerations</a>
      </h2>
<p id="section-5-1">Some authoritative servers deviate from the DNS standard as follows:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">Some authoritative servers ignore the EDNS(0) requestor's maximum UDP payload size and return large UDP responses <span>[<a href="#Fujiwara2018" class="cite xref">Fujiwara2018</a>]</span>.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">Some authoritative servers do not support TCP transport.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">Such non-compliant behavior cannot become implementation or configuration
constraints for the rest of the DNS. If failure is the result, then that
failure must be localized to the non-compliant servers.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="securitycons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="on-path-fragmentation-on-ipv4">
<section id="section-7.1">
        <h3 id="name-on-path-fragmentation-on-ip">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-on-path-fragmentation-on-ip" class="section-name selfRef">On-Path Fragmentation on IPv4</a>
        </h3>
<p id="section-7.1-1">If the Don't Fragment (DF) flag bit is not set,
on-path fragmentation may happen on IPv4,
and it can lead to vulnerabilities as shown in <a href="#ProblemOfFragmentation" class="auto internal xref">Section 7.3</a>.
To avoid this, R6 needs to be used to discard the fragmented responses and retry using TCP.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="small-mtu-network">
<section id="section-7.2">
        <h3 id="name-small-mtu-network">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-small-mtu-network" class="section-name selfRef">Small MTU Network</a>
        </h3>
<p id="section-7.2-1">When avoiding fragmentation,
a DNS/UDP requestor behind a small MTU network may experience
UDP timeouts, which would reduce performance
and may lead to TCP fallback.
This would indicate prior reliance upon IP fragmentation,
which is considered to be harmful
to both the performance and stability of applications, endpoints, and gateways.
Avoiding IP fragmentation will improve operating conditions overall,
and the performance of DNS/TCP has increased and will continue to increase.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">If a UDP response packet is dropped in transit,
up to and including the network stack of the initiator,
it increases the attack window for poisoning the requestor's cache.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ProblemOfFragmentation">
<section id="section-7.3">
        <h3 id="name-weaknesses-of-ip-fragmentat">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-weaknesses-of-ip-fragmentat" class="section-name selfRef">Weaknesses of IP Fragmentation</a>
        </h3>
<p id="section-7.3-1">"Fragmentation Considered Poisonous" <span>[<a href="#Herzberg2013" class="cite xref">Herzberg2013</a>]</span> notes effective
off-path DNS cache poisoning attack vectors using IP fragmentation.
"IP fragmentation attack on DNS" <span>[<a href="#Hlavacek2013" class="cite xref">Hlavacek2013</a>]</span> and "Domain Validation++
For MitM-Resilient PKI" <span>[<a href="#Brandt2018" class="cite xref">Brandt2018</a>]</span> note that off-path attackers
can intervene in the Path MTU Discovery <span>[<a href="#RFC1191" class="cite xref">RFC1191</a>]</span>
to cause authoritative servers to produce fragmented responses.
<span>[<a href="#RFC7739" class="cite xref">RFC7739</a>]</span> states the
 security implications of predictable fragment identification values.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2"><span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8085" class="cite xref">RFC8085</a>]</span> states that
"an application <span class="bcp14">SHOULD NOT</span> send UDP datagrams
that result in IP packets that exceed the Maximum Transmission Unit (MTU)
along the path to the destination".<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">A DNS message receiver cannot trust fragmented UDP datagrams primarily due to
the small amount of entropy provided by UDP port numbers and DNS message
identifiers, each of which is only 16 bits in size, and both are likely
to be in the first fragment of a packet if fragmentation occurs.
By comparison, the TCP protocol stack controls packet size and avoids IP fragmentation under ICMP NEEDFRAG attacks.
In TCP, fragmentation should be avoided for performance reasons, whereas for
UDP, fragmentation should be avoided for resiliency and authenticity reasons.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dns-security-protections">
<section id="section-7.4">
        <h3 id="name-dns-security-protections">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-dns-security-protections" class="section-name selfRef">DNS Security Protections</a>
        </h3>
<p id="section-7.4-1">DNSSEC is a countermeasure against cache poisoning attacks that use
IP fragmentation.
However, DNS delegation responses are not signed with DNSSEC,
and DNSSEC does not have a mechanism to get the correct response if
an incorrect delegation is injected. This is a denial-of-service
vulnerability that can yield failed name resolutions.
If cache poisoning attacks can be avoided,
DNSSEC validation failures will be avoided.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="possible-actions-for-resolver-operators">
<section id="section-7.5">
        <h3 id="name-possible-actions-for-resolv">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-possible-actions-for-resolv" class="section-name selfRef">Possible Actions for Resolver Operators</a>
        </h3>
<p id="section-7.5-1">Because this document is published as Informational
rather than a Best Current Practice,
this section presents steps that resolver operators can take
to avoid vulnerabilities related to IP fragmentation.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">To avoid vulnerabilities related to IP fragmentation,
 implement R5 and R6.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">Specifically, configure the firewall functions protecting the full-service resolver
to discard incoming DNS response packets
with a non-zero Fragment Offset (FO) or a More Fragments (MF) flag bit of 1 on IPv4,
and discard packets with IPv6 Fragment Headers.
(If the resolver's IP address is not dedicated to the DNS resolver
and uses UDP communication that relies on IP Fragmentation for purposes
other than DNS, discard only the first fragment that contains the UDP header
from port 53.)<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">The most recent resolver software is believed to implement R7.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<p id="section-7.5-5">Even if R7 is not implemented, it will only result in a name resolution error,
preventing attacks from leading to malicious sites.<a href="#section-7.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time datetime="1990-11" class="refDate">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2931">[RFC2931]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"DNS Request and Transaction Signatures ( SIG(0)s )"</span>, <span class="seriesInfo">RFC 2931</span>, <span class="seriesInfo">DOI 10.17487/RFC2931</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2931">https://www.rfc-editor.org/info/rfc2931</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6891">https://www.rfc-editor.org/info/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7739">[RFC7739]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of Predictable Fragment Identification Values"</span>, <span class="seriesInfo">RFC 7739</span>, <span class="seriesInfo">DOI 10.17487/RFC7739</span>, <time datetime="2016-02" class="refDate">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7739">https://www.rfc-editor.org/info/rfc7739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Bellis, R.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">Tüxen, M.</span>, <span class="refAuthor">Rüngeler, I.</span>, and <span class="refAuthor">T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8945">[RFC8945]</dt>
        <dd>
<span class="refAuthor">Dupont, F.</span>, <span class="refAuthor">Morris, S.</span>, <span class="refAuthor">Vixie, P.</span>, <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">STD 93</span>, <span class="seriesInfo">RFC 8945</span>, <span class="seriesInfo">DOI 10.17487/RFC8945</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8945">https://www.rfc-editor.org/info/rfc8945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9499">[RFC9499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 9499</span>, <span class="seriesInfo">DOI 10.17487/RFC9499</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9499">https://www.rfc-editor.org/info/rfc9499</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Brandt2018">[Brandt2018]</dt>
        <dd>
<span class="refAuthor">Brandt, M.</span>, <span class="refAuthor">Dai, T.</span>, <span class="refAuthor">Klein, A.</span>, <span class="refAuthor">Shulman, H.</span>, and <span class="refAuthor">M. Waidner</span>, <span class="refTitle">"Domain Validation++ For MitM-Resilient PKI"</span>, <span class="refContent">Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security, pp. 2060-2076</span>, <span class="seriesInfo">DOI 10.1145/3243734.3243790</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3243734.3243790">https://dl.acm.org/doi/10.1145/3243734.3243790</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNSFlagDay2020">[DNSFlagDay2020]</dt>
        <dd>
<span class="refTitle">"DNS flag day 2020"</span>, <span>&lt;<a href="https://dnsflagday.net/2020/">https://dnsflagday.net/2020/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fujiwara2018">[Fujiwara2018]</dt>
        <dd>
<span class="refAuthor">Fujiwara, K.</span>, <span class="refTitle">"Measures against DNS cache poisoning attacks using IP fragmentation"</span>, <span class="refContent">OARC 30 Workshop</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://indico.dns-oarc.net/event/31/contributions/692/attachments/660/1115/fujiwara-5.pdf">https://indico.dns-oarc.net/event/31/contributions/692/attachments/660/1115/fujiwara-5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Herzberg2013">[Herzberg2013]</dt>
        <dd>
<span class="refAuthor">Herzberg, A.</span> and <span class="refAuthor">H. Shulman</span>, <span class="refTitle">"Fragmentation Considered Poisonous, or: One-domain-to-rule-them-all.org"</span>, <span class="refContent">IEEE Conference on Communications and Network Security (CNS)</span>, <span class="seriesInfo">DOI 10.1109/CNS.2013.6682711</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/6682711">https://ieeexplore.ieee.org/document/6682711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Hlavacek2013">[Hlavacek2013]</dt>
        <dd>
<span class="refAuthor">Hlavacek, T.</span>, <span class="refTitle">"IP fragmentation attack on DNS"</span>, <span class="refContent">RIPE 67 Meeting</span>, <time datetime="2013" class="refDate">2013</time>, <span>&lt;<a href="https://ripe67.ripe.net/presentations/240-ipfragattack.pdf">https://ripe67.ripe.net/presentations/240-ipfragattack.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Huston2021">[Huston2021]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span> and <span class="refAuthor">J. Damas</span>, <span class="refTitle">"Measuring DNS Flag Day 2020"</span>, <span class="refContent">OARC 34 Workshop</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://indico.dns-oarc.net/event/37/contributions/806/attachments/782/1366/2021-02-04-dns-flag.pdf">https://indico.dns-oarc.net/event/37/contributions/806/attachments/782/1366/2021-02-04-dns-flag.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2308">[RFC2308]</dt>
        <dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Negative Caching of DNS Queries (DNS NCACHE)"</span>, <span class="seriesInfo">RFC 2308</span>, <span class="seriesInfo">DOI 10.17487/RFC2308</span>, <time datetime="1998-03" class="refDate">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2308">https://www.rfc-editor.org/info/rfc2308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2671">[RFC2671]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS0)"</span>, <span class="seriesInfo">RFC 2671</span>, <span class="seriesInfo">DOI 10.17487/RFC2671</span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2671">https://www.rfc-editor.org/info/rfc2671</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5155">[RFC5155]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Sisson, G.</span>, <span class="refAuthor">Arends, R.</span>, and <span class="refAuthor">D. Blacka</span>, <span class="refTitle">"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"</span>, <span class="seriesInfo">RFC 5155</span>, <span class="seriesInfo">DOI 10.17487/RFC5155</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5155">https://www.rfc-editor.org/info/rfc5155</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8900">[RFC8900]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Baker, F.</span>, <span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Hinden, R.</span>, <span class="refAuthor">Troan, O.</span>, and <span class="refAuthor">F. Gont</span>, <span class="refTitle">"IP Fragmentation Considered Fragile"</span>, <span class="seriesInfo">BCP 230</span>, <span class="seriesInfo">RFC 8900</span>, <span class="seriesInfo">DOI 10.17487/RFC8900</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8900">https://www.rfc-editor.org/info/rfc8900</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9460">https://www.rfc-editor.org/info/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9471">[RFC9471]</dt>
      <dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refAuthor">Huque, S.</span>, <span class="refAuthor">Wouters, P.</span>, and <span class="refAuthor">D. Wessels</span>, <span class="refTitle">"DNS Glue Requirements in Referral Responses"</span>, <span class="seriesInfo">RFC 9471</span>, <span class="seriesInfo">DOI 10.17487/RFC9471</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9471">https://www.rfc-editor.org/info/rfc9471</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="details">
<section id="appendix-A">
      <h2 id="name-details-of-requestors-maxim">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-details-of-requestors-maxim" class="section-name selfRef">Details of Requestor's Maximum UDP Payload Size Discussions</a>
      </h2>
<p id="appendix-A-1">There are many discussions about default path MTU size and a requestor's maximum UDP payload size.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">The minimum MTU for an IPv6 interface is 1280 octets
(see <span><a href="https://rfc-editor.org/rfc/rfc8200#section-5" class="relref">Section 5</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>).
So, it can be used as the default path MTU value for IPv6.
The corresponding minimum MTU for an IPv4 interface is 68 (60 + 8)
<span>[<a href="#RFC0791" class="cite xref">RFC0791</a>]</span>.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1"><span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> states that "A security-aware name server <span class="bcp14">MUST</span> support the EDNS0 (<span>[<a href="#RFC2671" class="cite xref">RFC2671</a>]</span>) message size extension, [and it] <span class="bcp14">MUST</span> support a message size of at least 1220 octets". Then, the smallest number of
the maximum DNS/UDP payload size is 1220.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">In order to avoid IP fragmentation,
<span>[<a href="#DNSFlagDay2020" class="cite xref">DNSFlagDay2020</a>]</span> proposes that UDP requestors set the requestor's
payload size to 1232 and UDP responders compose UDP responses so they fit
in 1232 octets.
The size 1232 is based on an MTU of 1280, which is required
by the IPv6 specification <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>,
minus 48 octets for the IPv6 and UDP headers.<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.4">
          <p id="appendix-A-2.4.1">Most of the Internet, especially the inner core, has an MTU of at least 
1500 octets.
Maximum DNS/UDP payload size for IPv6 on an MTU 1500 Ethernet is
1452 (1500 minus 40 (IPv6 header size) minus 8 (UDP header size)).
To allow for possible IP options and distant tunnel overhead,
the recommendation of default maximum DNS/UDP payload size is 1400.<a href="#appendix-A-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.5">
          <p id="appendix-A-2.5.1"><span>[<a href="#Huston2021" class="cite xref">Huston2021</a>]</span> analyzes the result of <span>[<a href="#DNSFlagDay2020" class="cite xref">DNSFlagDay2020</a>]</span> and reports that
their measurements suggest that in the interior of the Internet
between recursive resolvers and authoritative servers, the prevailing MTU is 1500
and there is no measurable signal of use of smaller MTUs
in this part of the Internet. They propose that
their measurements suggest setting the EDNS(0) requestor's UDP payload size to
1472 octets for IPv4 and 1452 octets for IPv6.<a href="#appendix-A-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">As a result of these discussions,
this document recommends a value of 1400,
with smaller values also allowed.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="minimal-responses">
<section id="appendix-B">
      <h2 id="name-minimal-responses">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-minimal-responses" class="section-name selfRef">Minimal Responses</a>
      </h2>
<p id="appendix-B-1">Some implementations have a "minimal responses" configuration setting/option that causes
a DNS server to make response packets smaller, containing only mandatory and
      required data.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Under the minimal-responses configuration,
a DNS server composes responses containing only necessary Resource Records (RRs).
For delegations, see <span>[<a href="#RFC9471" class="cite xref">RFC9471</a>]</span>.
In case of a non-existent domain name or non-existent type, 
the authority section will contain an SOA record, and the answer section is empty
(see <span><a href="https://rfc-editor.org/rfc/rfc2308#section-2" class="relref">Section 2</a> of [<a href="#RFC2308" class="cite xref">RFC2308</a>]</span>).<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Some resource records (MX, SRV, SVCB, and HTTPS) require
additional A, AAAA, and Service Binding (SVCB) records
in the Additional section
defined in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>, <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>, and <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">In addition, if the zone is DNSSEC signed and a query has the DNSSEC OK bit,
signatures are added in the answer section,
or the corresponding DS RRSet and signatures are added in the authority section.
Details are defined in <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span> and <span>[<a href="#RFC5155" class="cite xref">RFC5155</a>]</span>.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impl">
<section id="appendix-C">
      <h2 id="name-known-implementations">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-known-implementations" class="section-name selfRef">Known Implementations</a>
      </h2>
<p id="appendix-C-1">This section records the status of known implementations of the proposed recommendations described in <a href="#recommendation" class="auto internal xref">Section 3</a>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Please note that the listing of any individual implementation here does not
imply endorsement by the IETF. Furthermore, no effort has been made to
verify the information that was supplied by IETF contributors and presented here.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<div id="bind-9">
<section id="appendix-C.1">
        <h3 id="name-bind-9">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-bind-9" class="section-name selfRef">BIND 9</a>
        </h3>
<p id="appendix-C.1-1">BIND 9 does not implement R1 and R2.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">BIND 9 on Linux sets IP_MTU_DISCOVER to IP_PMTUDISC_OMIT with a fallback to
 IP_PMTUDISC_DONT.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">When BIND 9 is on systems with IP_DONTFRAG (such as FreeBSD), IP_DONTFRAG is disabled.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<p id="appendix-C.1-4">Accepting Path MTU Discovery for UDP is considered harmful and dangerous.
BIND 9's settings avoid attacks to Path MTU Discovery.<a href="#appendix-C.1-4" class="pilcrow">¶</a></p>
<p id="appendix-C.1-5">For R3, BIND 9 will honor the requestor's size up to the
configured limit (<code>max-udp-size</code>). The UDP response packet is bound to be
between 512 and 4096 bytes, with the default set to 1232. BIND 9 supports the
requestor's size up to the configured limit (<code>max-udp-size</code>).<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
<p id="appendix-C.1-6">In the case of R4 and the send fails with EMSGSIZE, BIND 9
sets the TC bit and tries to send a minimal answer again.<a href="#appendix-C.1-6" class="pilcrow">¶</a></p>
<p id="appendix-C.1-7">For R5, BIND 9 uses the <code>edns-buf-size</code>
option, with the default of 1232.<a href="#appendix-C.1-7" class="pilcrow">¶</a></p>
<p id="appendix-C.1-8">For R7, after two UDP timeouts, BIND 9 will fall back to TCP.<a href="#appendix-C.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="knot-dns-and-knot-resolver">
<section id="appendix-C.2">
        <h3 id="name-knot-dns-and-knot-resolver">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-knot-dns-and-knot-resolver" class="section-name selfRef">Knot DNS and Knot Resolver</a>
        </h3>
<p id="appendix-C.2-1">Both Knot servers set IP_PMTUDISC_OMIT to avoid path MTU spoofing. The UDP size limit is 1232 by default.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">Fragments are ignored if they arrive over a Linux XDP interface.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<p id="appendix-C.2-3">TCP is attempted after repeated UDP timeouts.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<p id="appendix-C.2-4">Minimal responses are returned and are currently not configurable.<a href="#appendix-C.2-4" class="pilcrow">¶</a></p>
<p id="appendix-C.2-5">Smaller signatures are used, with ecdsap256sha256 as the default.<a href="#appendix-C.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="powerdns-authoritative-server-powerdns-recursor-powerdns-dnsdist">
<section id="appendix-C.3">
        <h3 id="name-powerdns-authoritative-serv">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-powerdns-authoritative-serv" class="section-name selfRef">PowerDNS Authoritative Server, PowerDNS Recursor, and PowerDNS dnsdist</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1">Use IP_PMTUDISC_OMIT with a fallback to IP_PMTUDISC_DONT.<a href="#appendix-C.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1">The default EDNS buffer size of 1232; no probing for smaller sizes.<a href="#appendix-C.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1">There is no handling of EMSGSIZE.<a href="#appendix-C.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.4">
            <p id="appendix-C.3-1.4.1">Recursor: UDP timeouts do not cause a switch to TCP, but "spoofing near misses" may.<a href="#appendix-C.3-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="powerdns-authoritative-server">
<section id="appendix-C.4">
        <h3 id="name-powerdns-authoritative-serve">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-powerdns-authoritative-serve" class="section-name selfRef">PowerDNS Authoritative Server</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">
            <p id="appendix-C.4-1.1.1">The default DNSSEC algorithm is 13.<a href="#appendix-C.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.2">
            <p id="appendix-C.4-1.2.1">Responses are minimal; this is not configurable.<a href="#appendix-C.4-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="unbound">
<section id="appendix-C.5">
        <h3 id="name-unbound">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-unbound" class="section-name selfRef">Unbound</a>
        </h3>
<p id="appendix-C.5-1">Unbound sets IP_MTU_DISCOVER to IP_PMTUDISC_OMIT with fallback to
IP_PMTUDISC_DONT. It also disables IP_DONTFRAG on systems that have
it, but not on Apple systems. On systems that support it, Unbound sets
IPV6_USE_MIN_MTU, with a fallback to IPV6_MTU at 1280, with a fallback
to IPV6_USER_MTU. It also sets IPV6_MTU_DISCOVER to IPV6_PMTUDISC_OMIT,
with a fallback to IPV6_PMTUDISC_DONT.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5-2">Unbound requests a UDP size of 1232 from peers, by default. The requestor's
 size is limited to a max of 1232.<a href="#appendix-C.5-2" class="pilcrow">¶</a></p>
<p id="appendix-C.5-3">After some timeouts, Unbound retries with a smaller size, if applicable, or at
size 1232 for IPv6 and 1472 for IPv4. This does not cause any negative effects due to
 the "flag day" <span>[<a href="#DNSFlagDay2020" class="cite xref">DNSFlagDay2020</a>]</span> change to 1232.<a href="#appendix-C.5-3" class="pilcrow">¶</a></p>
<p id="appendix-C.5-4">Unbound has the "minimal responses" configuration option; set default on.<a href="#appendix-C.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C.6">
        <h3 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
        </h3>
<p id="appendix-C.6-1">The authors would like to specifically thank <span class="contact-name">Paul       Wouters</span>, <span class="contact-name">Mukund Sivaraman</span>, <span class="contact-name">Tony Finch</span>, <span class="contact-name">Hugo Salgado</span>, <span class="contact-name">Peter van Dijk</span>, <span class="contact-name">Brian Dickson</span>,
      <span class="contact-name">Puneet Sood</span>, <span class="contact-name">Jim Reid</span>,
      <span class="contact-name">Petr Spacek</span>, <span class="contact-name">Andrew       McConachie</span>, <span class="contact-name">Joe Abley</span>, <span class="contact-name">Daisuke Higashi</span>, <span class="contact-name">Joe Touch</span>, <span class="contact-name">Wouter Wijngaards</span>, <span class="contact-name">Vladimir Cunat</span>,
      <span class="contact-name">Benno Overeinder</span>, and <span class="contact-name">Štěpán       Němec</span> for their extensive reviews and comments.<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kazunori Fujiwara</span></div>
<div dir="auto" class="left"><span class="org">Japan Registry Services Co., Ltd.</span></div>
<div dir="auto" class="left">
<span class="street-address">Chiyoda First Bldg. East 13F<br>3-8-1 Nishi-Kanda</span>, <span class="region">Chiyoda-ku, Tokyo</span>
</div>
<div dir="auto" class="left"><span class="postal-code">101-0065</span></div>
<div dir="auto" class="left"><span class="country-name">Japan</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+81%203%205215%208451" class="tel">+81 3 5215 8451</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:fujiwara@jprs.co.jp" class="email">fujiwara@jprs.co.jp</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Vixie</span></div>
<div dir="auto" class="left"><span class="org">AWS Security</span></div>
<div dir="auto" class="left"><span class="street-address">11400 La Honda Road</span></div>
<div dir="auto" class="left">
<span class="locality">Woodside</span>, <span class="region">CA</span> <span class="postal-code">94062</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20650%20393%203994" class="tel">+1 650 393 3994</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul@redbarn.org" class="email">paul@redbarn.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
