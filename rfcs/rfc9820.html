<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9820: Authentication Service Based on the Extensible Authentication Protocol (EAP) for Use with the Constrained Application Protocol (CoAP)</title>
<meta content="Rafa Marin-Lopez" name="author">
<meta content="Dan Garcia-Carrillo" name="author">
<meta content='
       This document specifies an authentication service that uses the Constrained Application Protocol (CoAP) as a transport method to carry the Extensible Authentication Protocol (EAP). As such, it defines an EAP lower layer based on CoAP called "CoAP-EAP". One of the main goals is to authenticate a CoAP-enabled Internet of Things (IoT) device (EAP peer) that intends to join a security domain managed by a Controller (EAP authenticator). Secondly, it allows deriving key material to protect CoAP messages exchanged between them based on Object Security for Constrained RESTful Environments (OSCORE), enabling the establishment of a security association between them. 
    ' name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="CoAP" name="keyword">
<meta content="EAP" name="keyword">
<meta content="EAP lower layer" name="keyword">
<meta content="Internet of Things" name="keyword">
<meta content="IoT" name="keyword">
<meta content="Constrained Node" name="keyword">
<meta content="Smart Object" name="keyword">
<meta content="9820" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9820.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-ace-wg-coap-eap-15" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9820" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9820</td>
<td class="center">CoAP-EAP</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Marin-Lopez &amp; Garcia-Carrillo</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9820" class="eref">9820</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09" class="published">September 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Marin-Lopez</div>
<div class="org">University of Murcia</div>
</div>
<div class="author">
      <div class="author-name">D. Garcia-Carrillo</div>
<div class="org">University of Oviedo</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9820</h1>
<h1 id="title">Authentication Service Based on the Extensible Authentication Protocol (EAP) for Use with the Constrained Application Protocol (CoAP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies an authentication service that uses the Constrained Application Protocol (CoAP) as a transport method to carry the Extensible Authentication Protocol (EAP). As such, it defines an EAP lower layer based on CoAP called "CoAP-EAP". One of the main goals is to authenticate a CoAP-enabled Internet of Things (IoT) device (EAP peer) that intends to join a security domain managed by a Controller (EAP authenticator). Secondly, it allows deriving key material to protect CoAP messages exchanged between them based on Object Security for Constrained RESTful Environments (OSCORE), enabling the establishment of a security association between them.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9820">https://www.rfc-editor.org/info/rfc9820</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-general-architecture" class="internal xref">General Architecture</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-coap-eap-operation" class="internal xref">CoAP-EAP Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-discovery" class="internal xref">Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-flow-of-operation-oscore-es" class="internal xref">Flow of Operation (OSCORE Establishment)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-re-authentication" class="internal xref">Re-Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-managing-the-state-of-the-s" class="internal xref">Managing the State of the Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-eap-authentication-failure" class="internal xref">EAP Authentication Failure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-non-responsive-endpoint" class="internal xref">Non-Responsive Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-duplicated-message-with-wel" class="internal xref">Duplicated Message with /.well-known/coap-eap</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-proxy-operation-in-coap-eap" class="internal xref">Proxy Operation in CoAP-EAP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-coap-eap-media-type-format" class="internal xref">CoAP-EAP Media Type Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-cbor-objects-in-coap-eap" class="internal xref">CBOR Objects in CoAP-EAP</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-cipher-suite-negotiation-an" class="internal xref">Cipher Suite Negotiation and Key Derivation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-cipher-suite-negotiation" class="internal xref">Cipher Suite Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-deriving-the-oscore-securit" class="internal xref">Deriving the OSCORE Security Context</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-discussion" class="internal xref">Discussion</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-coap-as-the-eap-lower-layer" class="internal xref">CoAP as the EAP Lower Layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-size-of-the-eap-lower-layer" class="internal xref">Size of the EAP Lower Layer vs. EAP Method Size</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-use-of-eap-methods" class="internal xref">Use of EAP Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-authorization" class="internal xref">Authorization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-allowing-coap-eap-traffic-t" class="internal xref">Allowing CoAP-EAP Traffic to Perform Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-freshness-of-the-key-materi" class="internal xref">Freshness of the Key Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-channel-binding-support" class="internal xref">Channel-Binding Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-additional-security-conside" class="internal xref">Additional Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-coap-eap-cipher-suites" class="internal xref">CoAP-EAP Cipher Suites</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-cddl-in-coap-eap-informatio" class="internal xref">CDDL in CoAP-EAP Information Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-the-well-known-uris-registr" class="internal xref">The Well-Known URIs Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-the-eap-lower-layers-regist" class="internal xref">The EAP Lower Layers Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-media-types-registry" class="internal xref">Media Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="auto internal xref">9.7</a>.  <a href="#name-resource-type-rt-link-targe" class="internal xref">Resource Type (rt=) Link Target Attribute Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="auto internal xref">9.8</a>.  <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-flow-of-operation-dtls-esta" class="internal xref">Flow of Operation (DTLS Establishment)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-deriving-dtls_psk-and-ident" class="internal xref">Deriving DTLS_PSK and Identity</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-using-coap-eap-for-distribu" class="internal xref">Using CoAP-EAP for Distributing Key Material for IoT Networks</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-example-use-case-scenarios" class="internal xref">Example Use Case Scenarios</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-example-1-coap-eap-using-ac" class="internal xref">Example 1:  CoAP-EAP Using ACE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-example-2-multiple-domains-" class="internal xref">Example 2: Multiple Domains with AAA Infrastructures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-example-3-single-domain-wit" class="internal xref">Example 3: Single Domain with a AAA Infrastructure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-example-4-single-domain-wit" class="internal xref">Example 4: Single Domain Without a AAA Infrastructure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-other-use-cases" class="internal xref">Other Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5.2.1">
                    <p id="section-toc.1-1.13.2.5.2.1.1"><a href="#appendix-C.5.1" class="auto internal xref">C.5.1</a>.  <a href="#name-coap-eap-for-network-access" class="internal xref">CoAP-EAP for Network Access Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5.2.2">
                    <p id="section-toc.1-1.13.2.5.2.2.1"><a href="#appendix-C.5.2" class="auto internal xref">C.5.2</a>.  <a href="#name-coap-eap-for-service-authen" class="internal xref">CoAP-EAP for Service Authentication</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies an authentication service (application) that uses the Extensible Authentication Protocol (EAP) <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> and is built on top of the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>; it is called "CoAP-EAP". CoAP-EAP is an application that allows authenticating two CoAP endpoints by using EAP and establishing an Object Security for Constrained RESTful Environments (OSCORE) security association between them.
More specifically, this document specifies how CoAP can be used as a constrained, link-layer-independent, reliable EAP lower layer <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> to transport EAP messages between a CoAP server (acting as an EAP peer) and a CoAP client (acting as an EAP authenticator) using CoAP messages. The CoAP client has the option of contacting a backend Authentication, Authorization, and Accounting (AAA) infrastructure to complete the EAP negotiation, as described in the EAP specification <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In the case of this specification, the EAP methods that can be transported with CoAP-EAP <span class="bcp14">MUST</span> export cryptographic material <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>. Examples of such methods are the EAP Generalized Pre-Shared Key (EAP-GPSK) <span>[<a href="#RFC5433" class="cite xref">RFC5433</a>]</span>, the EAP Method for Global System for Mobile Communications (GSM)
Subscriber Identity Modules (EAP-SIM) <span>[<a href="#RFC4186" class="cite xref">RFC4186</a>]</span>, the EAP Method for 3rd Generation Authentication and Key Agreement (EAP-AKA') <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span>,
EAP-TLS 1.3 <span>[<a href="#RFC9190" class="cite xref">RFC9190</a>]</span>, EAP with Ephemeral Diffie-Hellman over
CBOR Object Signing and Encryption (EAP-EDHOC) <span>[<a href="#I-D.ietf-emu-eap-edhoc" class="cite xref">EAP-EDHOC</a>]</span>, etc. ("CBOR" stands for "Concise Binary Object Representation".) In general, any EAP method
designed in the EAP Method Update (EMU) Working Group that exports the Master Session Key (MSK) can be used with CoAP-EAP. The MSK is used as the basis for further cryptographic derivations. This way, CoAP messages are protected after authentication. After the CoAP-EAP operation, an OSCORE security association is established between the endpoints of the service. Using the keying material from the authentication, other security associations could be generated. <a href="#flow-of-operation-dtls" class="auto internal xref">Appendix A</a> shows how to establish a (D)TLS security association using the keying material from the EAP authentication.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">One of the main applications of CoAP-EAP involves Internet of Things (IoT) networks, where we can find very constrained links (e.g., limited bandwidth) and devices with limited capabilities. In these IoT scenarios, we identify the IoT device as the entity that wants to be authenticated by using EAP to join a domain that is managed by a Controller. In these cases, the IoT device is the EAP peer and the Controller is the entity steering the authentication (i.e., the EAP authenticator); from now on, the IoT device will be referred to as the EAP peer and the Controller will be referred to as the EAP authenticator. In these cases, EAP methods with fewer exchanges, shorter messages, and cryptographic algorithms suitable for constrained devices are preferable. The benefits of the EAP framework in IoT networks are highlighted in <span>[<a href="#EAP-Framework-IoT" class="cite xref">EAP-Framework-IoT</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts described in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, EAP <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>, and OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-architecture">
<section id="section-2">
      <h2 id="name-general-architecture">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-general-architecture" class="section-name selfRef">General Architecture</a>
      </h2>
<p id="section-2-1"><a href="#arch" class="auto internal xref">Figure 1</a> illustrates the architecture defined in this document.  In this architecture, the EAP peer will act as a CoAP server for this
service and the domain EAP authenticator will act as a CoAP client. The rationale behind this decision is that EAP Requests will always travel from the EAP server to the EAP peer. Accordingly, EAP Responses will always travel from the EAP peer to the EAP server.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">It is worth noting that the EAP authenticator <span class="bcp14">MAY</span> interact with a backend AAA infrastructure when EAP pass-through mode is used, which will place the EAP server in the AAA server that contains the information required to authenticate the EAP peer.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The protocol stack is described in <a href="#stack" class="auto internal xref">Figure 2</a>. CoAP-EAP is an application built on top of CoAP. On top of the application, there is an EAP state machine that can run any EAP method. In the case of this specification, the EAP method <span class="bcp14">MUST</span> support key derivation and export as specified in <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>: an MSK of at least 64 octets and an Extended Master Session Key (EMSK) of at least 64 octets. CoAP-EAP also relies on CoAP reliability mechanisms to transport EAP: CoAP over UDP with Confirmable messages <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> or CoAP over TCP, TLS, or WebSockets <span>[<a href="#RFC8323" class="cite xref">RFC8323</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<span id="name-coap-eap-architecture"></span><div id="arch">
<figure id="figure-1">
        <div id="section-2-4.1">
          <div class="alignCenter art-svg artwork" id="section-2-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="480" viewBox="0 0 480 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,80" fill="none" stroke="black"></path>
              <path d="M 152,32 L 152,80" fill="none" stroke="black"></path>
              <path d="M 272,32 L 272,80" fill="none" stroke="black"></path>
              <path d="M 384,32 L 384,80" fill="none" stroke="black"></path>
              <path d="M 472,32 L 472,80" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 152,32 L 272,32" fill="none" stroke="black"></path>
              <path d="M 384,32 L 472,32" fill="none" stroke="black"></path>
              <path d="M 88,64 L 144,64" fill="none" stroke="black"></path>
              <path d="M 280,64 L 376,64" fill="none" stroke="black"></path>
              <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
              <path d="M 152,80 L 272,80" fill="none" stroke="black"></path>
              <path d="M 384,80 L 472,80" fill="none" stroke="black"></path>
              <path d="M 8,112 L 40,112" fill="none" stroke="black"></path>
              <path d="M 240,112 L 272,112" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="384,64 372,58.4 372,69.6" fill="black" transform="rotate(0,376,64)"></polygon>
              <polygon class="arrowhead" points="288,64 276,58.4 276,69.6" fill="black" transform="rotate(180,280,64)"></polygon>
              <polygon class="arrowhead" points="280,112 268,106.4 268,117.6" fill="black" transform="rotate(0,272,112)"></polygon>
              <polygon class="arrowhead" points="152,64 140,58.4 140,69.6" fill="black" transform="rotate(0,144,64)"></polygon>
              <polygon class="arrowhead" points="96,64 84,58.4 84,69.6" fill="black" transform="rotate(180,88,64)"></polygon>
              <polygon class="arrowhead" points="16,112 4,106.4 4,117.6" fill="black" transform="rotate(180,8,112)"></polygon>
              <g class="text">
                <text x="40" y="52">EAP</text>
                <text x="192" y="52">EAP</text>
                <text x="428" y="52">AAA/</text>
                <text x="44" y="68">peer</text>
                <text x="216" y="68">authenticator</text>
                <text x="400" y="68">EAP</text>
                <text x="444" y="68">server</text>
                <text x="116" y="84">CoAP</text>
                <text x="328" y="84">AAA</text>
                <text x="332" y="100">(optional)</text>
                <text x="72" y="116">SCOPE</text>
                <text x="108" y="116">OF</text>
                <text x="140" y="116">THIS</text>
                <text x="196" y="116">DOCUMENT</text>
              </g>
            </svg><a href="#section-2-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-coap-eap-architecture" class="selfRef">CoAP-EAP Architecture</a>
        </figcaption></figure>
</div>
<span id="name-coap-eap-stack"></span><div id="stack">
<figure id="figure-2">
        <div id="section-2-5.1">
          <div class="alignCenter art-svg artwork" id="section-2-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="464" viewBox="0 0 464 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,192" fill="none" stroke="black"></path>
              <path d="M 296,32 L 296,192" fill="none" stroke="black"></path>
              <path d="M 8,32 L 296,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 296,64" fill="none" stroke="black"></path>
              <path d="M 312,80 L 328,80" fill="none" stroke="black"></path>
              <path d="M 8,96 L 296,96" fill="none" stroke="black"></path>
              <path d="M 8,128 L 296,128" fill="none" stroke="black"></path>
              <path d="M 8,160 L 296,160" fill="none" stroke="black"></path>
              <path d="M 8,192 L 296,192" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="320,80 308,74.4 308,85.6" fill="black" transform="rotate(180,312,80)"></polygon>
              <g class="text">
                <text x="96" y="52">EAP</text>
                <text x="136" y="52">State</text>
                <text x="192" y="52">Machine</text>
                <text x="112" y="84">Application</text>
                <text x="204" y="84">(CoAP-EAP)</text>
                <text x="356" y="84">This</text>
                <text x="412" y="84">Document</text>
                <text x="52" y="116">Requests</text>
                <text x="96" y="116">/</text>
                <text x="144" y="116">Responses</text>
                <text x="192" y="116">/</text>
                <text x="240" y="116">Signaling</text>
                <text x="320" y="116">RFC</text>
                <text x="356" y="116">7252</text>
                <text x="384" y="116">/</text>
                <text x="408" y="116">RFC</text>
                <text x="444" y="116">8323</text>
                <text x="80" y="148">Message</text>
                <text x="120" y="148">/</text>
                <text x="160" y="148">Message</text>
                <text x="224" y="148">Framing</text>
                <text x="320" y="148">RFC</text>
                <text x="356" y="148">7252</text>
                <text x="384" y="148">/</text>
                <text x="408" y="148">RFC</text>
                <text x="444" y="148">8323</text>
                <text x="68" y="180">Unreliable</text>
                <text x="120" y="180">/</text>
                <text x="164" y="180">Reliable</text>
                <text x="240" y="180">Transport</text>
                <text x="320" y="180">RFC</text>
                <text x="356" y="180">7252</text>
                <text x="384" y="180">/</text>
                <text x="408" y="180">RFC</text>
                <text x="444" y="180">8323</text>
              </g>
            </svg><a href="#section-2-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-coap-eap-stack" class="selfRef">CoAP-EAP Stack</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec_coap-eap-operation">
<section id="section-3">
      <h2 id="name-coap-eap-operation">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-coap-eap-operation" class="section-name selfRef">CoAP-EAP Operation</a>
      </h2>
<p id="section-3-1">Because CoAP-EAP uses reliable delivery as defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> <span>[<a href="#RFC8323" class="cite xref">RFC8323</a>]</span>, EAP retransmission time is set to an infinite value, as mentioned in <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>. To maintain ordering guarantees, CoAP-EAP uses Hypermedia as the Engine of Application State (HATEOAS). Each step during the EAP authentication accesses a new resource in the CoAP server (EAP peer). The previous resource is removed once the new resource is created, indicating the resource that will process the next step of the EAP authentication.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">One of the benefits of using EAP is that we can choose from a large variety of authentication methods.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">In CoAP-EAP, the EAP peer will only have one authentication session with a specific EAP authenticator, and it will not process any other EAP authentication in parallel (with the same EAP authenticator). That is, a single ongoing EAP authentication is permitted for the same EAP peer and the same EAP authenticator. It may be worth noting that the EAP authenticator may have parallel EAP sessions with multiple EAP peers.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">To access the authentication service, this document defines the well-known URI "coap-eap" (see <a href="#wellknown" class="auto internal xref">Section 9.3</a>).  The /.well-known/coap-eap URI is used with "coap", "coap+tcp", or "coap+ws".<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="discovery-section">
<section id="section-3.1">
        <h3 id="name-discovery">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
        </h3>
<p id="section-3.1-1">Before the CoAP-EAP exchange takes place, the EAP peer needs to discover the EAP authenticator or the entity that will enable the CoAP-EAP exchange (i.e., an intermediary). The discovery process is outside the scope of this document.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The CoAP-EAP application can be accessed through the URI "coap-eap" for the trigger message (see <a href="#flow-of-operation" class="auto internal xref">Section 3.2</a>, Step 0). The CoAP-EAP service can be discovered by asking directly about the services offered. This information can also be available in the resource directory <span>[<a href="#RFC9176" class="cite xref">RFC9176</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Implementation notes: There are different methods for discovering the IPv6 address of the EAP authenticator or intermediary entity. For example, in a 6LoWPAN network, the Border Router will typically act as the EAP authenticator. Hence, after receiving the Router Advertisement (RA) messages from the Border Router, the EAP peer may engage in the CoAP-EAP exchange.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-of-operation">
<section id="section-3.2">
        <h3 id="name-flow-of-operation-oscore-es">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-flow-of-operation-oscore-es" class="section-name selfRef">Flow of Operation (OSCORE Establishment)</a>
        </h3>
<p id="section-3.2-1"><a href="#figure3" class="auto internal xref">Figure 3</a> shows the general flow of operation for CoAP-EAP to authenticate using EAP and establish an OSCORE Security Context. The flow does not show a specific EAP method. Instead, the chosen EAP method is represented by using a generic name (EAP-X).  The flow assumes that the EAP peer knows the EAP authenticator implements the CoAP-EAP service. A CoAP-EAP message has the media type "application/coap-eap". See <a href="#mediatypes" class="auto internal xref">Section 9.5</a>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The steps for this flow of operation are as follows:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Step 0. The EAP peer <span class="bcp14">MUST</span> start the CoAP-EAP
          process by sending a "POST /.well-known/coap-eap" request (trigger
          message). This message carries the 'No-Response' CoAP option <span>[<a href="#RFC7967" class="cite xref">RFC7967</a>]</span> to avoid waiting for a response that
          is not needed. This is the only message where the EAP authenticator
          acts as a CoAP server and the EAP peer acts as a CoAP client. The message
          also includes a URI in the payload of the message to indicate the
          resource where the EAP authenticator <span class="bcp14">MUST</span> send the
          next message. The name of the resource is selected by the CoAP
          server.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-4">Implementation notes: When generating the URI for a resource during a
          step of the authentication, the resource could have the following
          format as an example "path/eap/counter", where:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-5.1">"path" is some local path on the device to make the path unique.  This could be omitted if desired.<a href="#section-3.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.2">"eap" is the name that indicates that the URI is for the EAP peer.
            This has no meaning for the protocol but helps with
            debugging.<a href="#section-3.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-5.3">"counter" is an incrementing unique number for every new EAP Request.<a href="#section-3.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-6">So, per <a href="#figure3" class="auto internal xref">Figure 3</a>, the URI for the first resource would be "/a/eap/1".<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">Step 1. The EAP authenticator sends a POST message to the
          resource indicated in Step 0 (e.g., "/a/eap/1"). The payload in this
          message contains the first EAP message (EAP-Request/Identity, or EAP-Req/Id) and the
          Recipient ID of the EAP authenticator (RID-C) for OSCORE, and
          <span class="bcp14">MAY</span> contain a CBOR array with a list of proposed
          cipher suites (CS-C) for OSCORE. If the cipher suite list is not
          included, the default cipher suite for OSCORE is used. The details
          of the cipher suite negotiation are discussed in <a href="#crypto-negotiation" class="auto internal xref">Section 6.1</a>.<a href="#section-3.2-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-7.2">Step 2. The EAP peer processes the POST message sending the EAP
          Request (EAP-Req/Id) to the EAP peer state machine, which returns an
          EAP Response (EAP-Response/Identity, or EAP-Resp/Id). Then, the CoAP-EAP application assigns a new resource to the
          ongoing authentication process (e.g., "/a/eap/2") and deletes the
          previous one ("/a/eap/1"). Finally, the CoAP-EAP application sends a '2.01 Created' response
          with the new resource identifier in the Location-Path (and/or
          Location-Query) Options for the next step. The EAP Response, the
          Recipient ID of the EAP peer (RID-I), and the selected cipher suite
          for OSCORE (CS-I) are included in the payload. In this step, the EAP
          peer may create an OSCORE Security Context (see <a href="#OSCORE" class="auto internal xref">Section 6.2</a>). The required MSK will be
          available once the EAP authentication is successful (Step 7).<a href="#section-3.2-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-7.3">Steps 3-6. From now on, the EAP authenticator and the EAP peer
          will exchange EAP packets related to the EAP method (EAP-X),
          transported in the CoAP message payload. The EAP authenticator will
          use the POST method to send EAP Requests to the EAP peer. The EAP
          peer will use a CoAP response to carry the EAP Response in the
          payload. EAP Requests and responses are represented in <a href="#figure3" class="auto internal xref">Figure 3</a> using the nomenclature "EAP-X-Req" and "EAP-X-Resp",
          respectively.  When a POST message arrives (e.g., "/a/eap/1")
          carrying an EAP Request message, if processed correctly by the EAP
          peer state machine, it returns an EAP Response. Along with each EAP
          Response, a new resource is created (e.g., "/a/eap/3") for
          processing the next EAP Request and the ongoing resource (e.g.,
          "/a/eap/2") is erased. This way, ordering guarantees are
          achieved. Finally, an EAP Response is sent in the payload of a CoAP
          response that will also indicate the new resource in the
          Location-Path (and/or Location-Query) Options. If an
          error occurs while processing a legitimate message, the server will return a
          '4.00 Bad Request'. Error handling is discussed in
          <a href="#error-handling" class="auto internal xref">Section 3.5</a>.<a href="#section-3.2-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-7.4">Step 7. When the EAP authentication ends successfully, the EAP
          authenticator obtains the MSK exported by the
          EAP method, an EAP Success message, and some authorization
          information <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span> (e.g., Session-Lifetime). The
          EAP authenticator creates the OSCORE Security Context using the MSK
          and Recipient ID of both entities exchanged in Steps 1 and 2. The
          establishment of the OSCORE Security Context is defined in <a href="#OSCORE" class="auto internal xref">Section 6.2</a>. Then, the EAP authenticator sends the POST
          message protected with OSCORE for key confirmation, including the EAP
          Success. The EAP authenticator <span class="bcp14">MAY</span> also send a
          Session-Lifetime, in seconds, which is represented by an unsigned
          integer in a CBOR Object (see <a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>). If
          this Session-Lifetime is not sent, the EAP peer assumes a default
          value of 8 hours, as <span class="bcp14">RECOMMENDED</span> in <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>. The reception of the OSCORE-protected POST
          message is considered by the EAP peer as an alternate indication of
          success <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>. The EAP peer state machine in
          the EAP peer interprets the alternate indication of success
          (similarly to the arrival of an EAP Success) and returns the MSK,
          which is used to create the OSCORE Security Context in the EAP peer
          to process the protected POST message received from the EAP
          authenticator.<a href="#section-3.2-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-7.5">Step 8. If the EAP authentication and the verification of the
          OSCORE-protected POST (Step 7) are successful, then the EAP peer
          answers with an OSCORE-protected '2.04 Changed'.  From this point
          on, communication with the last resource (e.g., "/a/eap/(n)")
          <span class="bcp14">MUST</span> be protected with OSCORE.  If allowed by
          application policy, the same OSCORE Security Context
          <span class="bcp14">MAY</span> be used to protect communication to other
          resources between the same endpoints.<a href="#section-3.2-7.5" class="pilcrow">¶</a>
</li>
        </ul>
<span id="name-coap-eap-flow-of-operation-"></span><div id="figure3">
<figure id="figure-3">
          <div id="section-3.2-8.1">
            <div class="alignCenter art-svg artwork" id="section-3.2-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="592" width="464" viewBox="0 0 464 592" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 16,512 L 16,528" fill="none" stroke="black"></path>
                <path d="M 64,56 L 64,304" fill="none" stroke="black"></path>
                <path d="M 64,336 L 64,560" fill="none" stroke="black"></path>
                <path d="M 400,56 L 400,304" fill="none" stroke="black"></path>
                <path d="M 400,336 L 400,560" fill="none" stroke="black"></path>
                <path d="M 432,448 L 432,464" fill="none" stroke="black"></path>
                <path d="M 24,48 L 120,48" fill="none" stroke="black"></path>
                <path d="M 344,48 L 432,48" fill="none" stroke="black"></path>
                <path d="M 72,112 L 392,112" fill="none" stroke="black"></path>
                <path d="M 72,160 L 392,160" fill="none" stroke="black"></path>
                <path d="M 72,208 L 392,208" fill="none" stroke="black"></path>
                <path d="M 72,256 L 392,256" fill="none" stroke="black"></path>
                <path d="M 72,304 L 392,304" fill="none" stroke="black"></path>
                <path d="M 72,368 L 392,368" fill="none" stroke="black"></path>
                <path d="M 72,416 L 392,416" fill="none" stroke="black"></path>
                <path d="M 72,496 L 392,496" fill="none" stroke="black"></path>
                <path d="M 72,560 L 392,560" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="440,464 428,458.4 428,469.6" fill="black" transform="rotate(90,432,464)"></polygon>
                <polygon class="arrowhead" points="400,560 388,554.4 388,565.6" fill="black" transform="rotate(0,392,560)"></polygon>
                <polygon class="arrowhead" points="400,416 388,410.4 388,421.6" fill="black" transform="rotate(0,392,416)"></polygon>
                <polygon class="arrowhead" points="400,304 388,298.4 388,309.6" fill="black" transform="rotate(0,392,304)"></polygon>
                <polygon class="arrowhead" points="400,208 388,202.4 388,213.6" fill="black" transform="rotate(0,392,208)"></polygon>
                <polygon class="arrowhead" points="400,112 388,106.4 388,117.6" fill="black" transform="rotate(0,392,112)"></polygon>
                <polygon class="arrowhead" points="80,496 68,490.4 68,501.6" fill="black" transform="rotate(180,72,496)"></polygon>
                <polygon class="arrowhead" points="80,368 68,362.4 68,373.6" fill="black" transform="rotate(180,72,368)"></polygon>
                <polygon class="arrowhead" points="80,256 68,250.4 68,261.6" fill="black" transform="rotate(180,72,256)"></polygon>
                <polygon class="arrowhead" points="80,160 68,154.4 68,165.6" fill="black" transform="rotate(180,72,160)"></polygon>
                <polygon class="arrowhead" points="24,528 12,522.4 12,533.6" fill="black" transform="rotate(90,16,528)"></polygon>
                <g class="text">
                  <text x="48" y="36">EAP</text>
                  <text x="84" y="36">peer</text>
                  <text x="336" y="36">EAP</text>
                  <text x="408" y="36">authenticator</text>
                  <text x="100" y="68">POST</text>
                  <text x="208" y="68">/.well-known/coap-eap</text>
                  <text x="52" y="84">0)</text>
                  <text x="128" y="84">No-Response</text>
                  <text x="160" y="100">Payload("/a/eap/1")</text>
                  <text x="300" y="132">POST</text>
                  <text x="356" y="132">/a/eap/1</text>
                  <text x="260" y="148">Payload(EAP-Req/Id||CS-C||RID-C)</text>
                  <text x="52" y="164">1)</text>
                  <text x="92" y="180">2.01</text>
                  <text x="144" y="180">Created</text>
                  <text x="232" y="180">Location-Path</text>
                  <text x="332" y="180">[/a/eap/2]</text>
                  <text x="208" y="196">Payload(EAP-Resp/Id||CS-I||RID-I)</text>
                  <text x="52" y="212">2)</text>
                  <text x="300" y="228">POST</text>
                  <text x="356" y="228">/a/eap/2</text>
                  <text x="308" y="244">Payload(EAP-X-Req)</text>
                  <text x="52" y="260">3)</text>
                  <text x="92" y="276">2.01</text>
                  <text x="144" y="276">Created</text>
                  <text x="232" y="276">Location-Path</text>
                  <text x="332" y="276">[/a/eap/3]</text>
                  <text x="152" y="292">Payload(EAP-X-Resp)</text>
                  <text x="52" y="308">4)</text>
                  <text x="236" y="324">....</text>
                  <text x="252" y="340">POST</text>
                  <text x="324" y="340">/a/eap/(n-1)</text>
                  <text x="308" y="356">Payload(EAP-X-Req)</text>
                  <text x="52" y="372">5)</text>
                  <text x="92" y="388">2.01</text>
                  <text x="144" y="388">Created</text>
                  <text x="232" y="388">Location-Path</text>
                  <text x="340" y="388">[/a/eap/(n)]</text>
                  <text x="152" y="404">Payload(EAP-X-Resp)</text>
                  <text x="52" y="420">6)</text>
                  <text x="432" y="436">MSK</text>
                  <text x="284" y="452">POST</text>
                  <text x="348" y="452">/a/eap/(n)</text>
                  <text x="364" y="468">OSCORE</text>
                  <text x="128" y="484">Payload(EAP</text>
                  <text x="288" y="484">Success||*Session-Lifetime)</text>
                  <text x="436" y="484">OSCORE</text>
                  <text x="16" y="500">MSK</text>
                  <text x="52" y="500">7)</text>
                  <text x="432" y="500">CTX</text>
                  <text x="92" y="532">2.04</text>
                  <text x="144" y="532">Changed</text>
                  <text x="28" y="548">OSCORE</text>
                  <text x="100" y="548">OSCORE</text>
                  <text x="16" y="564">CTX</text>
                  <text x="52" y="564">8)</text>
                  <text x="168" y="580">*Session-Lifetime</text>
                  <text x="252" y="580">is</text>
                  <text x="300" y="580">optional</text>
                </g>
              </svg><a href="#section-3.2-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-coap-eap-flow-of-operation-" class="selfRef">CoAP-EAP Flow of Operation with OSCORE</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="re-authentication">
<section id="section-3.3">
        <h3 id="name-re-authentication">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-re-authentication" class="section-name selfRef">Re-Authentication</a>
        </h3>
<p id="section-3.3-1">When the CoAP-EAP state is close to expiring, the EAP peer may want to start a new authentication process (re-authentication) to renew the state. The main goal is to obtain new and fresh keying material (MSK/EMSK) that, in turn, allows deriving a new OSCORE Security Context, increasing the protection against key leakage. The keying material <span class="bcp14">MUST</span> be renewed before the expiration of the Session-Lifetime. By default, the EAP key management framework <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span> establishes a default value of 8 hours to refresh the keying material. Certain EAP methods such as
Nimble Out-of-Band Authentication for EAP (EAP-NOOB) <span>[<a href="#RFC9140" class="cite xref">RFC9140</a>]</span> or EAP-AKA' <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span> provide fast reconnect for quicker re-authentication. The EAP Re-authentication Protocol (ERP) <span>[<a href="#RFC6696" class="cite xref">RFC6696</a>]</span> <span class="bcp14">MAY</span> also be used to avoid the repetition of the entire EAP exchange.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The re-authentication message flow will be the same as that shown in <a href="#figure3" class="auto internal xref">Figure 3</a>. Nevertheless, two different CoAP-EAP states will be active during the re-authentication: the current CoAP-EAP state and the new CoAP-EAP state, which will be created once the re-authentication has finished successfully. Once the re-authentication is completed successfully, the current CoAP-EAP state is deleted and replaced by the new CoAP-EAP state. If for any reason the re-authentication fails, the current CoAP-EAP state will be available until it expires, or it will be renewed during a subsequent re-authentication attempt.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">If the re-authentication fails, it is up to the EAP peer to decide when to start a new re-authentication before the current EAP state expires.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="managing_boot_state">
<section id="section-3.4">
        <h3 id="name-managing-the-state-of-the-s">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-managing-the-state-of-the-s" class="section-name selfRef">Managing the State of the Service</a>
        </h3>
<p id="section-3.4-1">The EAP peer and the EAP authenticator keep state during the CoAP-EAP negotiation. The CoAP-EAP state includes several important parts:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">A reference to an instance of the EAP (peer or authenticator/server) state machine.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The resource for the next message in the negotiation (e.g., "/a/eap/2").<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">The MSK, which is exported when the EAP authentication is successful. CoAP-EAP can access the different variables via the EAP state machine (see <span>[<a href="#RFC4137" class="cite xref">RFC4137</a>]</span>).<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.4">
            <p id="section-3.4-2.4.1">A reference to the OSCORE context.<a href="#section-3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">Once created, the EAP authenticator <span class="bcp14">MAY</span> choose to delete the state as described in <a href="#figure4" class="auto internal xref">Figure 4</a>. Conversely, the EAP peer may need to renew the CoAP-EAP state because the key material is close to expiring, as mentioned in <a href="#re-authentication" class="auto internal xref">Section 3.3</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">There are situations where the current CoAP-EAP state might need to be removed. For instance, due to its expiration or forced removal, the EAP peer has to be expelled from the security domain. Such an exchange is illustrated in <a href="#figure4" class="auto internal xref">Figure 4</a>.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">If the EAP authenticator deems it necessary to remove the CoAP-EAP state from the EAP peer before it expires, it can send a DELETE command in a request to the EAP peer, referencing the last CoAP-EAP state resource given by the CoAP server, whose identifier will be the last one received (e.g., "/a/eap/(n)" in <a href="#figure3" class="auto internal xref">Figure 3</a>). This message is protected by the OSCORE security association to prevent forgery. Upon reception of this message, the CoAP server sends a response to the EAP authenticator with the code '2.02 Deleted', which is also protected by the OSCORE security association. If a response from the EAP peer does not arrive after EXCHANGE_LIFETIME, the EAP authenticator will remove the state.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<span id="name-deleting-state"></span><div id="figure4">
<figure id="figure-4">
          <div id="section-3.4-6.1">
            <div class="alignCenter art-svg artwork" id="section-3.4-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="432" viewBox="0 0 432 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 56,56 L 56,176" fill="none" stroke="black"></path>
                <path d="M 376,56 L 376,176" fill="none" stroke="black"></path>
                <path d="M 8,48 L 104,48" fill="none" stroke="black"></path>
                <path d="M 312,48 L 408,48" fill="none" stroke="black"></path>
                <path d="M 64,112 L 368,112" fill="none" stroke="black"></path>
                <path d="M 64,176 L 368,176" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="376,176 364,170.4 364,181.6" fill="black" transform="rotate(0,368,176)"></polygon>
                <polygon class="arrowhead" points="72,112 60,106.4 60,117.6" fill="black" transform="rotate(180,64,112)"></polygon>
                <g class="text">
                  <text x="32" y="36">EAP</text>
                  <text x="68" y="36">peer</text>
                  <text x="304" y="36">EAP</text>
                  <text x="376" y="36">authenticator</text>
                  <text x="252" y="84">DELETE</text>
                  <text x="324" y="84">/a/eap/(n)</text>
                  <text x="340" y="100">OSCORE</text>
                  <text x="84" y="148">2.02</text>
                  <text x="136" y="148">Deleted</text>
                  <text x="92" y="164">OSCORE</text>
                </g>
              </svg><a href="#section-3.4-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-deleting-state" class="selfRef">Deleting State</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="error-handling">
<section id="section-3.5">
        <h3 id="name-error-handling">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
        </h3>
<p id="section-3.5-1">This section elaborates on how different errors are handled: EAP authentication failure (<a href="#eap-authentication-failure" class="auto internal xref">Section 3.5.1</a>), a non-responsive endpoint (<a href="#non-responsive-endpoint" class="auto internal xref">Section 3.5.2</a>), and duplicated messages (<a href="#duplicated-message-with-well-knowncoap-eap" class="auto internal xref">Section 3.5.3</a>).<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="eap-authentication-failure">
<section id="section-3.5.1">
          <h4 id="name-eap-authentication-failure">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-eap-authentication-failure" class="section-name selfRef">EAP Authentication Failure</a>
          </h4>
<p id="section-3.5.1-1">The EAP authentication may fail in different situations (e.g., wrong credentials). The result is that the EAP authenticator will send an EAP Failure message because of a failed EAP authentication (Step 7 in <a href="#figure3" class="auto internal xref">Figure 3</a>). In this case, the EAP peer <span class="bcp14">MUST</span> send a response '4.01 Unauthorized' in Step 8. Therefore, Steps 7 and 8 are not protected in this case because no MSK is exported and the OSCORE Security Context is not yet generated.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">If the EAP authentication fails during the re-authentication and the EAP authenticator sends an EAP Failure, the current CoAP-EAP state will still be usable until it expires.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-responsive-endpoint">
<section id="section-3.5.2">
          <h4 id="name-non-responsive-endpoint">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-non-responsive-endpoint" class="section-name selfRef">Non-Responsive Endpoint</a>
          </h4>
<p id="section-3.5.2-1">If for any reason one of the entities becomes non-responsive, the CoAP-EAP state <span class="bcp14">SHOULD</span> be removed after a stipulated amount of time. The amount of time can be adjusted according to the policies established by the application or use case where CoAP-EAP is used. As a default value, the CoAP EXCHANGE_LIFETIME parameter, as defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, will be used.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">The removal of the CoAP-EAP state in the EAP authenticator assumes that the EAP peer will need to authenticate again.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-3">According to CoAP, EXCHANGE_LIFETIME considers the time it takes until a client stops expecting a response to a request. A timer is reset every time a message is sent.
By default, CoAP-EAP adopts the value of EXCHANGE_LIFETIME as a timer in the EAP peer and authenticator to remove the CoAP-EAP state if the authentication process has not progressed to completion during that time.<a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
<p id="section-3.5.2-4">The EAP peer will remove the CoAP-EAP state if either the EXCHANGE_LIFETIME is triggered or the EAP peer state machine returns an eapFail.<a href="#section-3.5.2-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2-5">The EAP authenticator will remove the CoAP-EAP state if either the EXCHANGE_LIFETIME is triggered or, when the EAP authenticator is operating in pass-through mode (i.e., the EAP authentication is performed against a AAA server), the EAP authenticator state machine returns "aaaTimeout" <span>[<a href="#RFC4137" class="cite xref">RFC4137</a>]</span>.<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="duplicated-message-with-well-knowncoap-eap">
<section id="section-3.5.3">
          <h4 id="name-duplicated-message-with-wel">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-duplicated-message-with-wel" class="section-name selfRef">Duplicated Message with /.well-known/coap-eap</a>
          </h4>
<p id="section-3.5.3-1">The reception of the trigger message (Step 0 in <a href="#figure3" class="auto internal xref">Figure 3</a>) containing the URI /coap-eap needs some additional considerations, as the resource is always available in the EAP authenticator.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">If a trigger message arrives at the EAP authenticator during an ongoing authentication with the same EAP peer, the EAP authenticator <span class="bcp14">MUST</span> silently discard this trigger message.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
<p id="section-3.5.3-3">If an old "POST /.well-known/coap-eap" (Step 0 in <a href="#figure5" class="auto internal xref">Figure 5</a>) arrives at the EAP authenticator and there is no authentication ongoing, the EAP authenticator may understand that a new authentication process is requested. Consequently, the EAP authenticator will start a new EAP authentication. However, if the EAP peer did not start any authentication, it will send a '4.04 Not Found' in the response (<a href="#figure5" class="auto internal xref">Figure 5</a>).<a href="#section-3.5.3-3" class="pilcrow">¶</a></p>
<span id="name-well-known-coap-eap-with-no"></span><div id="figure5">
<figure id="figure-5">
            <div id="section-3.5.3-4.1">
              <div class="alignCenter art-svg artwork" id="section-3.5.3-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="432" viewBox="0 0 432 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 32,56 L 32,208" fill="none" stroke="black"></path>
                  <path d="M 368,56 L 368,208" fill="none" stroke="black"></path>
                  <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
                  <path d="M 328,48 L 400,48" fill="none" stroke="black"></path>
                  <path d="M 160,112 L 360,112" fill="none" stroke="black"></path>
                  <path d="M 40,160 L 360,160" fill="none" stroke="black"></path>
                  <path d="M 40,208 L 360,208" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="368,208 356,202.4 356,213.6" fill="black" transform="rotate(0,360,208)"></polygon>
                  <polygon class="arrowhead" points="368,112 356,106.4 356,117.6" fill="black" transform="rotate(0,360,112)"></polygon>
                  <polygon class="arrowhead" points="48,160 36,154.4 36,165.6" fill="black" transform="rotate(180,40,160)"></polygon>
                  <g class="text">
                    <text x="16" y="36">EAP</text>
                    <text x="52" y="36">peer</text>
                    <text x="304" y="36">EAP</text>
                    <text x="376" y="36">authenticator</text>
                    <text x="72" y="68">*POST</text>
                    <text x="184" y="68">/.well-known/coap-eap</text>
                    <text x="20" y="84">0)</text>
                    <text x="96" y="84">No-Response</text>
                    <text x="128" y="100">Payload("/a/eap/1")</text>
                    <text x="260" y="132">POST</text>
                    <text x="316" y="132">/a/eap/1</text>
                    <text x="248" y="148">Payload(EAP-Req/Id||CS-C)</text>
                    <text x="20" y="164">1)</text>
                    <text x="60" y="196">4.04</text>
                    <text x="96" y="196">Not</text>
                    <text x="136" y="196">found</text>
                    <text x="196" y="228">*Old</text>
                  </g>
                </svg><a href="#section-3.5.3-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-well-known-coap-eap-with-no" class="selfRef">/.well-known/coap-eap with No Ongoing Authentication from the EAP Authenticator</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="proxy">
<section id="section-3.6">
        <h3 id="name-proxy-operation-in-coap-eap">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-proxy-operation-in-coap-eap" class="section-name selfRef">Proxy Operation in CoAP-EAP</a>
        </h3>
<p id="section-3.6-1">The CoAP-EAP operation is intended to be compatible with the use of intermediary entities between the EAP peer and the EAP authenticator when direct communication is not possible. In this context, CoAP proxies can be used as enablers of the CoAP-EAP exchange.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">This specification is limited to using standard CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> as well as standardized CoAP options <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. It does not specify any addition in the form of CoAP options. This is expected to ease the integration of CoAP intermediaries in the CoAP-EAP exchange.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">When using proxies in the CoAP-EAP exchange, it should be considered that the exchange contains a role-reversal process at the beginning of the exchange. In the first message, the EAP peer acts as a CoAP client and the EAP authenticator acts as the CoAP server. In the remaining exchanges, the roles are reversed (i.e., the EAP
peer acts as the CoAP server, and the EAP authenticator acts as the CoAP client).
When using a proxy in the exchange, for message 0 it will act as a forward proxy, and as a reverse proxy for the rest. Additionally, in the first exchange, the EAP peer, as a CoAP client, sends the URI for the next CoAP message in the payload of a request. This is not the typical behavior, as URIs referring to new services/resources appear in Location-Path and/or Location-Query Options in CoAP responses. Hence, the proxy will have to treat the payload of Message 0 as if it were a Location-Path Option of a CoAP response.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="coap-eap-media-type">
<section id="section-4">
      <h2 id="name-coap-eap-media-type-format">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-coap-eap-media-type-format" class="section-name selfRef">CoAP-EAP Media Type Format</a>
      </h2>
<p id="section-4-1">In the CoAP-EAP exchange, the format specified by the "application/coap-eap" media type will be used. See <a href="#mediatypes" class="auto internal xref">Section 9.5</a>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In CoAP-EAP, there are two different elements that can be sent over the payload. The first one is a relative URI. This payload will be present for the first message (0) in <a href="#figure3" class="auto internal xref">Figure 3</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">In all the other cases, an EAP message will be followed by the CBOR Object specified in <a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>. A visual example of the second case can be found in <a href="#figure7" class="auto internal xref">Figure 7</a> (<a href="#crypto-negotiation" class="auto internal xref">Section 6.1</a>).<a href="#section-4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cbor-coap-eap">
<section id="section-5">
      <h2 id="name-cbor-objects-in-coap-eap">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-cbor-objects-in-coap-eap" class="section-name selfRef">CBOR Objects in CoAP-EAP</a>
      </h2>
<p id="section-5-1">In the CoAP-EAP exchange, information needs to be exchanged between the two entities -- for example, the cipher suites that need to be negotiated, or authorization information (Session-Lifetime). There may also be a need to extend the information that has to be exchanged in the future. This section specifies the CBOR data structure <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> to exchange information between the EAP peer and the EAP authenticator in the CoAP payload.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><a href="#figure6" class="auto internal xref">Figure 6</a> shows the specification of the CBOR Object to exchange information in CoAP-EAP.<a href="#section-5-2" class="pilcrow">¶</a></p>
<span id="name-cbor-data-structure-for-coa"></span><div id="figure6">
<figure id="figure-6">
        <div class="alignCenter art-text artwork" id="section-5-3.1">
<pre>
   CoAP-EAP_Info = {
      ?  1 : [+ int],     ; Cipher Suite (CS-C or CS-I)
      ?  2 : bstr,        ; RID-C
      ?  3 : bstr,        ; RID-I
      ?  4 : uint         ; Session-Lifetime
  }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-cbor-data-structure-for-coa" class="selfRef">CBOR Data Structure for CoAP-EAP</a>
        </figcaption></figure>
</div>
<p id="section-5-4">The parameters contain the following information:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5-5">
        <li id="section-5-5.1">Cipher Suite: An array with the list of proposed, or selected,
        CBOR Object Signing and Encryption (COSE) algorithms for OSCORE. If the
field is carried over a request,
        a proposed cipher suite is indicated; if it is carried over a
        response, it corresponds to the agreed-upon cipher suite.<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.2">RID-C: The Recipient ID of the EAP authenticator. The EAP peer
        uses this value as the Sender ID for its OSCORE Sender Context. The EAP
        authenticator uses this value as the Recipient ID for its Recipient
        Context.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.3">RID-I: The Recipient ID of the EAP peer. The EAP authenticator
        uses this value as the Sender ID for its OSCORE Sender Context. The EAP
        peer uses this value as the Recipient ID for its Recipient Context.<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.4">Session-Lifetime: The time that the session is valid, in seconds.<a href="#section-5-5.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-6">Other indexes can be used to carry additional values as needed, like specific authorization parameters.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">The indexes from 65001 to 65535 are reserved for experimentation.<a href="#section-5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key_deriv">
<section id="section-6">
      <h2 id="name-cipher-suite-negotiation-an">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-cipher-suite-negotiation-an" class="section-name selfRef">Cipher Suite Negotiation and Key Derivation</a>
      </h2>
<div id="crypto-negotiation">
<section id="section-6.1">
        <h3 id="name-cipher-suite-negotiation">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-cipher-suite-negotiation" class="section-name selfRef">Cipher Suite Negotiation</a>
        </h3>
<p id="section-6.1-1">OSCORE runs after the EAP authentication, using the cipher suite selected in the cipher suite negotiation (Steps 1 and 2 in <a href="#figure3" class="auto internal xref">Figure 3</a>). To negotiate the cipher suite, CoAP-EAP follows a simple approach: The EAP authenticator sends a list, in decreasing order of preference, with the identifiers of the supported cipher suites (Step 1 in <a href="#figure8" class="auto internal xref">Figure 8</a>). In the response to that message (Step 2 in <a href="#figure8" class="auto internal xref">Figure 8</a>), the EAP peer sends its choice.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">This list is included in the payload after the EAP message through a CBOR array. An example of how the fields are arranged in the CoAP payload can be seen in <a href="#figure7" class="auto internal xref">Figure 7</a>. An example exchange for the cipher suite negotiation is shown in <a href="#figure8" class="auto internal xref">Figure 8</a>. The EAP Request (EAP-Req/Id) and EAP Response (EAP-Resp/Id) are sent; both messages include the CBOR Object (<a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>) containing the cipher suite field for the cipher suite negotiation.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-cipher-suites-in-the-coap-p"></span><div id="figure7">
<figure id="figure-7">
          <div id="section-6.1-3.1">
            <div class="alignCenter art-svg artwork" id="section-6.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="448" viewBox="0 0 448 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 64,32 L 64,64" fill="none" stroke="black"></path>
                <path d="M 168,32 L 168,64" fill="none" stroke="black"></path>
                <path d="M 240,32 L 240,64" fill="none" stroke="black"></path>
                <path d="M 296,32 L 296,64" fill="none" stroke="black"></path>
                <path d="M 440,32 L 440,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 440,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 440,64" fill="none" stroke="black"></path>
                <path d="M 8,96 L 88,96" fill="none" stroke="black"></path>
                <path d="M 208,96 L 288,96" fill="none" stroke="black"></path>
                <path d="M 304,96 L 320,96" fill="none" stroke="black"></path>
                <path d="M 424,96 L 440,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="448,96 436,90.4 436,101.6" fill="black" transform="rotate(0,440,96)"></polygon>
                <polygon class="arrowhead" points="312,96 300,90.4 300,101.6" fill="black" transform="rotate(180,304,96)"></polygon>
                <polygon class="arrowhead" points="296,96 284,90.4 284,101.6" fill="black" transform="rotate(0,288,96)"></polygon>
                <polygon class="arrowhead" points="16,96 4,90.4 4,101.6" fill="black" transform="rotate(180,8,96)"></polygon>
                <g class="text">
                  <text x="36" y="52">Code</text>
                  <text x="116" y="52">Identifier</text>
                  <text x="204" y="52">Length</text>
                  <text x="268" y="52">Data</text>
                  <text x="340" y="52">cipher</text>
                  <text x="404" y="52">suites</text>
                  <text x="120" y="100">EAP</text>
                  <text x="164" y="100">Packet</text>
                  <text x="348" y="100">CBOR</text>
                  <text x="392" y="100">array</text>
                </g>
              </svg><a href="#section-6.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cipher-suites-in-the-coap-p" class="selfRef">Cipher Suites in the CoAP Payload</a>
          </figcaption></figure>
</div>
<span id="name-cipher-suite-negotiation-2"></span><div id="figure8">
<figure id="figure-8">
          <div id="section-6.1-4.1">
            <div class="alignCenter art-svg artwork" id="section-6.1-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="424" viewBox="0 0 424 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 32,72 L 32,208" fill="none" stroke="black"></path>
                <path d="M 368,72 L 368,208" fill="none" stroke="black"></path>
                <path d="M 8,64 L 104,64" fill="none" stroke="black"></path>
                <path d="M 320,64 L 416,64" fill="none" stroke="black"></path>
                <path d="M 40,112 L 360,112" fill="none" stroke="black"></path>
                <path d="M 40,160 L 360,160" fill="none" stroke="black"></path>
                <path d="M 40,208 L 360,208" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="368,208 356,202.4 356,213.6" fill="black" transform="rotate(0,360,208)"></polygon>
                <polygon class="arrowhead" points="368,112 356,106.4 356,117.6" fill="black" transform="rotate(0,360,112)"></polygon>
                <polygon class="arrowhead" points="48,160 36,154.4 36,165.6" fill="black" transform="rotate(180,40,160)"></polygon>
                <g class="text">
                  <text x="24" y="36">EAP</text>
                  <text x="60" y="36">peer</text>
                  <text x="328" y="36">EAP</text>
                  <text x="368" y="36">Auth.</text>
                  <text x="24" y="52">(CoAP</text>
                  <text x="80" y="52">server)</text>
                  <text x="336" y="52">(CoAP</text>
                  <text x="392" y="52">client)</text>
                  <text x="168" y="100">...</text>
                  <text x="260" y="132">POST</text>
                  <text x="316" y="132">/a/eap/1</text>
                  <text x="128" y="148">Payload(EAP-Req/Id,</text>
                  <text x="280" y="148">CBORArray[0,1,2])</text>
                  <text x="20" y="164">1)</text>
                  <text x="60" y="180">2.01</text>
                  <text x="112" y="180">Created</text>
                  <text x="200" y="180">Location-Path</text>
                  <text x="300" y="180">[/a/eap/2]</text>
                  <text x="124" y="196">Payload(EAP-Resp/Id,</text>
                  <text x="264" y="196">CBORArray[0])</text>
                  <text x="20" y="212">2)</text>
                  <text x="200" y="228">...</text>
                </g>
              </svg><a href="#section-6.1-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-cipher-suite-negotiation-2" class="selfRef">Cipher Suite Negotiation</a>
          </figcaption></figure>
</div>
<p id="section-6.1-5">If there is no CBOR array specifying the cipher suites, the default cipher suites are applied. If the EAP authenticator sends a restricted list of cipher suites that can be accepted, it <span class="bcp14">MUST</span> include the default value 0, since it is mandatory to implement. The EAP peer will have at least that option available.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">The cipher suite requirements are inherited from those established by OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, which are COSE algorithms <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>. By default, the HMAC-based Extract-and-Expand Key Derivation Function (HKDF) algorithm is SHA-256 and the Authenticated Encryption with Associated Data (AEAD) algorithm is AES-CCM-16-64-128 <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>. ("HMAC" stands for "Hashed Message Authentication Code".) Both are mandatory to implement. The other supported and negotiated cipher suites are listed below; these hash algorithms are considered in cases where the specification includes DTLS support in the future (TLS_SHA256, TLS_SHA384, TLS_SHA512; see <a href="#flow-of-operation-dtls" class="auto internal xref">Appendix A</a>):<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-7.1">
            <p id="section-6.1-7.1.1">0) AES-CCM-16-64-128, SHA-256 (default)<a href="#section-6.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-7.2">
            <p id="section-6.1-7.2.1">1) A128GCM, SHA-256<a href="#section-6.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-7.3">
            <p id="section-6.1-7.3.1">2) A256GCM, SHA-384<a href="#section-6.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-7.4">
            <p id="section-6.1-7.4.1">3) ChaCha20/Poly1305, SHA-256<a href="#section-6.1-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-7.5">
            <p id="section-6.1-7.5.1">4) ChaCha20/Poly1305, SHAKE256<a href="#section-6.1-7.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-8">This specification uses the HKDF as defined in <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span> to derive the necessary key material. Since the key derivation process uses the MSK, which is considered fresh key material, the HKDF-Expand function (shortened here as "KDF") will be used. See <a href="#limit_eap_medhods" class="auto internal xref">Section 8.1</a> regarding why the use of this function is enough and it is not necessary to use KDF-Extract.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OSCORE">
<section id="section-6.2">
        <h3 id="name-deriving-the-oscore-securit">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-deriving-the-oscore-securit" class="section-name selfRef">Deriving the OSCORE Security Context</a>
        </h3>
<p id="section-6.2-1">The derivation of the OSCORE Security Context allows securing the communication between the EAP peer and the EAP authenticator once the MSK has been exported, providing confidentiality, integrity, key confirmation (Steps 7 and 8 in <a href="#figure3" class="auto internal xref">Figure 3</a>), and detection of downgrading attacks.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Once the Master Secret and Master Salt are derived, they can be used to derive the rest of the OSCORE Security Context (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>). It should be noted that the ID Context is not provided for the OSCORE Security Context derivation.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The Master Secret can be derived by using the chosen cipher suite and the KDF as follows:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="alignCenter art-text artwork" id="section-6.2-4">
<pre>
Master Secret = KDF(MSK, CS | "COAP-EAP OSCORE MASTER SECRET", length)
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">where:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-6.1">
            <p id="section-6.2-6.1.1">The MSK is exported by the EAP method. The use of the MSK for key derivation is discussed in <a href="#security_considerations" class="auto internal xref">Section 8</a>.<a href="#section-6.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.2">
            <p id="section-6.2-6.2.1">CS is the concatenation of the content of the cipher suite negotiation -- that is, the concatenation of two CBOR arrays CS-C and CS-I (with CBOR ints as elements), as defined in <a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>. If neither CS-C nor CS-I was sent (i.e., default algorithms are used), the value used to generate CS will be the same as if the default algorithms were explicitly sent in CS-C or CS-I (i.e., a CBOR array with the cipher suite value of 0).<a href="#section-6.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.3">
            <p id="section-6.2-6.3.1">"COAP-EAP OSCORE MASTER SECRET" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).<a href="#section-6.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.4">
            <p id="section-6.2-6.4.1">CS and "COAP-EAP OSCORE MASTER SECRET" are concatenated.<a href="#section-6.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-6.5">
            <p id="section-6.2-6.5.1">length is the size of the output key material.<a href="#section-6.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-7">Similarly to the Master Secret, the Master Salt can be derived as follows:<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div class="alignCenter art-text artwork" id="section-6.2-8">
<pre>
Master Salt = KDF(MSK, CS | "COAP-EAP OSCORE MASTER SALT", length)
</pre><a href="#section-6.2-8" class="pilcrow">¶</a>
</div>
<p id="section-6.2-9">where:<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-10.1">
            <p id="section-6.2-10.1.1">The MSK is exported by the EAP method. The use of the MSK for key derivation is discussed in <a href="#security_considerations" class="auto internal xref">Section 8</a>.<a href="#section-6.2-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-10.2">
            <p id="section-6.2-10.2.1">CS is the concatenation of the content of the cipher suite negotiation -- that is, the concatenation of two CBOR arrays CS-C and CS-I (with CBOR ints as elements), as defined in <a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>. If neither CS-C nor CS-I was sent (i.e., default algorithms are used), the value used to generate CS will be the same as if the default algorithms were explicitly sent in CS-C or CS-I (i.e., a CBOR array with the cipher suite value of 0).<a href="#section-6.2-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-10.3">
            <p id="section-6.2-10.3.1">"COAP-EAP OSCORE MASTER SALT" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).<a href="#section-6.2-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-10.4">
            <p id="section-6.2-10.4.1">CS and "COAP-EAP OSCORE MASTER SALT" are concatenated.<a href="#section-6.2-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-10.5">
            <p id="section-6.2-10.5.1">length is the size of the output key material.<a href="#section-6.2-10.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.2-11">Since the MSK is used to derive the Master Key, the correct verification of the OSCORE-protected request (Step 7) and response (Step 8) confirms that the EAP authenticator and the EAP peer have the same Master Secret, achieving key confirmation.<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<p id="section-6.2-12">To prevent a downgrading attack, the content of the cipher suite
(referred to here as "CS") negotiation is embedded in the Master Secret derivation. If an attacker changes the value of the cipher suite negotiation, the result will be different OSCORE Security Contexts, which in turn will result in failure in Steps 7 and 8.<a href="#section-6.2-12" class="pilcrow">¶</a></p>
<p id="section-6.2-13">The EAP authenticator will use the Recipient ID of the EAP peer (RID-I) as the Sender ID for its OSCORE Sender Context. The EAP peer will use this value as the Recipient ID for its Recipient Context.<a href="#section-6.2-13" class="pilcrow">¶</a></p>
<p id="section-6.2-14">The EAP peer will use the Recipient ID of the EAP authenticator (RID-C) as the Sender ID for its OSCORE Sender Context. The EAP authenticator will use this value as the Recipient ID for its Recipient Context.<a href="#section-6.2-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation_considerations">
<section id="section-7">
      <h2 id="name-discussion">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-discussion" class="section-name selfRef">Discussion</a>
      </h2>
<div id="coap-as-eap-lower-layer">
<section id="section-7.1">
        <h3 id="name-coap-as-the-eap-lower-layer">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-coap-as-the-eap-lower-layer" class="section-name selfRef">CoAP as the EAP Lower Layer</a>
        </h3>
<p id="section-7.1-1">This section discusses the suitability of CoAP as the EAP lower layer and reviews the requisites imposed by EAP on any protocol transporting EAP. What EAP expects from its lower layers can be found in <span><a href="https://rfc-editor.org/rfc/rfc3748#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>, which is elaborated next:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.1-2">
          <dt id="section-7.1-2.1">Unreliable transport:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.2">EAP does not assume that lower layers are reliable, but it can benefit from a reliable lower layer. In this sense, CoAP provides a reliability mechanism (e.g., using Confirmable messages).<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.3">Lower-layer error detection:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.4">EAP relies on lower-layer error detection (e.g., CRC, checksum, Message Integrity Check (MIC), etc.). For simplicity, CoAP-EAP delegates error detection to the lower layers, such as the link layer or transport layer (e.g., UDP over IPv6 or TCP).<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.5">Lower-layer security:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.6">EAP does not require security services from the lower layers.<a href="#section-7.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.7">Minimum MTU:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.8">Lower layers need to provide an EAP MTU size of 1020 octets or greater. CoAP assumes an upper bound of 1024 octets for its payload, which covers the EAP requirements when only the EAP message is sent in the CoAP payload. In the case of Messages 1 and 2 in <a href="#figure3" class="auto internal xref">Figure 3</a>, those messages have extra information apart from EAP. Nevertheless, the EAP-Req/Id has a fixed length of 5 bytes. Message 2, with the EAP-Resp/Id, would limit the length of the identity being used to the CoAP payload maximum size (1024) - len( CS-I || RID-I ) - EAP Response header (5 bytes), which leaves enough space for sending even lengthy identities. Nevertheless, this limitation can be overcome by using CoAP block-wise transfers <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span>.
Note: When EAP is proxied over a AAA framework, the Access-Request packets in RADIUS <span class="bcp14">MUST</span> contain a Framed-MTU attribute with a value of 1024 and, in
Diameter, the Framed-MTU Attribute-Value Pair (AVP) with a value of 1024. This information signals the AAA server that it should limit its responses to 1024 octets.<a href="#section-7.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-2.9">Ordering guarantees:</dt>
          <dd style="margin-left: 1.5em" id="section-7.1-2.10">EAP relies on lower-layer ordering guarantees for correct operation. Regarding message ordering, every time a new message arrives at the authentication service hosted by the EAP peer, a new resource is created, and this is indicated in a '2.01 Created' response code along with the name of the new resource via Location-Path or Location-Query Options. This way, the application shows that its state has advanced.<a href="#section-7.1-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.1-3">Although <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> states that "EAP provides its own support for duplicate elimination and retransmission," EAP is also reliant on
lower-layer ordering guarantees. In this regard, <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> talks about possible duplication and says, "Where the lower layer is reliable, it will provide the EAP layer with a non-duplicated stream of packets. However, while it is desirable that lower layers provide for non-duplication, this is not a requirement." CoAP provides a non-duplicated stream of packets and accomplishes the desirable non-duplication. In addition, <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> says that when EAP runs over a reliable lower layer "the authenticator retransmission timer <span class="bcp14">SHOULD</span> be set to an infinite value, so that retransmissions do not occur at the EAP layer."<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="size-of-the-eap-lower-layer-vs-eap-method-size">
<section id="section-7.2">
        <h3 id="name-size-of-the-eap-lower-layer">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-size-of-the-eap-lower-layer" class="section-name selfRef">Size of the EAP Lower Layer vs. EAP Method Size</a>
        </h3>
<p id="section-7.2-1">Regarding the impact that an EAP lower layer will have on the number of bytes of the whole authentication exchange, <span>[<a href="#CoAP-EAP" class="cite xref">CoAP-EAP</a>]</span> provides a comparison with another network-layer-based EAP lower layer, the Protocol for Carrying Authentication for Network Access (PANA) as defined in <span>[<a href="#RFC5191" class="cite xref">RFC5191</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The EAP method being transported will take most of the exchange. However, the impact of the EAP lower layer cannot be ignored, especially in very constrained communication technologies such as those with limited capabilities (e.g., as can be found in IoT networks).<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Note: To improve efficiency in environments with constrained devices and networks, the latest versions of EAP methods (e.g., EAP-AKA' <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span>, EAP-TLS 1.3 <span>[<a href="#RFC9190" class="cite xref">RFC9190</a>]</span>) are recommended over older versions. EAP methods more adapted for IoT networks (e.g., EAP-NOOB <span>[<a href="#RFC9140" class="cite xref">RFC9140</a>]</span>, EAP-EDHOC <span>[<a href="#I-D.ietf-emu-eap-edhoc" class="cite xref">EAP-EDHOC</a>]</span>, etc.) are also recommended.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security_considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">Security aspects to be considered include how authorization is managed, the use of the MSK as key material, and how trust in the EAP authenticator is established. Additional considerations such as EAP channel binding as per <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span> are also discussed here.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="limit_eap_medhods">
<section id="section-8.1">
        <h3 id="name-use-of-eap-methods">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-use-of-eap-methods" class="section-name selfRef">Use of EAP Methods</a>
        </h3>
<p id="section-8.1-1">This document limits the use of EAP methods to those compliant with <span>[<a href="#RFC4017" class="cite xref">RFC4017</a>]</span>, yielding strong and fresh session keys such as the MSK. By this assumption, the HKDF-Expand function is used directly, as clarified in <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization">
<section id="section-8.2">
        <h3 id="name-authorization">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-authorization" class="section-name selfRef">Authorization</a>
        </h3>
<p id="section-8.2-1">Authorization is part of bootstrapping. It serves to establish whether the EAP peer can join and the set of conditions it must adhere to. The authorization data will be gathered from the organization that is responsible for the EAP peer and sent to the EAP authenticator if a AAA infrastructure is deployed.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">In standalone mode, the authorization information will be in the EAP authenticator. If pass-through mode is used, authorization data received from the AAA server can be delivered by the AAA protocol (e.g., RADIUS or Diameter).  Providing more fine-grained authorization data can be done by transporting the data using the Security Assertion Markup Language (SAML) in RADIUS <span>[<a href="#RFC7833" class="cite xref">RFC7833</a>]</span>.
After bootstrapping, additional authorization information may be needed to operate in the security domain. This can be taken care of by the solutions proposed in the Authentication and Authorization for Constrained Environments (ACE) WG, such as the use of OAuth <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, among other solutions, to provide ACE.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="allowing-coap-eap-traffic-to-perform-authentication">
<section id="section-8.3">
        <h3 id="name-allowing-coap-eap-traffic-t">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-allowing-coap-eap-traffic-t" class="section-name selfRef">Allowing CoAP-EAP Traffic to Perform Authentication</a>
        </h3>
<p id="section-8.3-1">Since CoAP is an application protocol, CoAP-EAP assumes certain IP connectivity in the link between the EAP peer and the EAP authenticator to run. This link <span class="bcp14">MUST</span> only authorize unprotected IP traffic to be sent between the EAP peer and the EAP authenticator during the authentication with CoAP-EAP. Once the authentication is successful, the key material generated by the EAP authentication (MSK) and any other traffic can be authorized if it is protected. It is worth noting that if the EAP authenticator is not in the same link as the EAP peer and an intermediate entity (e.g., a CoAP proxy) helps with this process, this
concept also applies to the communication between the EAP peer and the intermediary.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Alternatively, the link layer <span class="bcp14">MAY</span> provide support to transport CoAP-EAP without an IP address by using link-layer frames (e.g., by defining a new Key Management Protocol ID per IEEE 802.15.9 <span>[<a href="#IEEE802159" class="cite xref">IEEE802159</a>]</span>).<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="freshness-of-the-key-material">
<section id="section-8.4">
        <h3 id="name-freshness-of-the-key-materi">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-freshness-of-the-key-materi" class="section-name selfRef">Freshness of the Key Material</a>
        </h3>
<p id="section-8.4-1">In CoAP-EAP, there is no nonce exchange to provide freshness to the keys derived from the MSK. The MSKs and EMSKs are fresh key material per <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>. Since only one authentication is established per EAP authenticator, there is no need to generate additional key material. If a new MSK is required, a re-authentication can be done by running the process again or using a more lightweight EAP method to derive additional key material as elaborated in <a href="#re-authentication" class="auto internal xref">Section 3.3</a>.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="channel-binding-support">
<section id="section-8.5">
        <h3 id="name-channel-binding-support">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-channel-binding-support" class="section-name selfRef">Channel-Binding Support</a>
        </h3>
<p id="section-8.5-1">According to <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span>, channel binding, as related to EAP, is sent through the EAP method supporting it.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">To satisfy the requirements of this document, the EAP lower-layer identifier for CoAP-EAP (10, as assigned by IANA; see <a href="#lowerlayer" class="auto internal xref">Section 9.4</a>) needs to be sent, in the EAP Lower-Layer Attribute if RADIUS is used.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-security-considerations">
<section id="section-8.6">
        <h3 id="name-additional-security-conside">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-additional-security-conside" class="section-name selfRef">Additional Security Considerations</a>
        </h3>
<p id="section-8.6-1">In the authentication process, it is possible for an entity to forge messages to generate denial-of-service (DoS) attacks on any of the entities involved. For instance, an attacker can forge multiple initial messages to start an authentication (Step 0 in <a href="#figure3" class="auto internal xref">Figure 3</a>) with the EAP authenticator as if they were sent by different EAP peers. Consequently, the EAP authenticator will start an authentication process for each message received in Step 0, sending the
EAP-Req/Id (Step 1).<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">To minimize the effects of this DoS attack, it is <span class="bcp14">RECOMMENDED</span> that the EAP authenticator limit the rate at which it processes incoming messages in Step 0 to provide robustness against DoS attacks. The details of rate limiting are outside the scope of this specification. Nevertheless, the rate of these messages is also limited by the bandwidth available between the EAP peer and the EAP authenticator. This bandwidth will be especially limited in constrained links (e.g., Low-Power WANs (LPWANs)). Lastly, it is also <span class="bcp14">RECOMMENDED</span> to reduce at a minimum the state in the EAP authenticator at least until the EAP-Resp/Id is received by the EAP authenticator.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.6-3">Another security-related concern is how to ensure that the EAP peer joining the security domain can trust the EAP authenticator. This issue is elaborated in <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>. In particular, the EAP peer knows it can trust the EAP authenticator because the key that is used to establish the security association is derived from the MSK. If the EAP authenticator has the MSK, it is because the AAA server of the EAP peer trusted the EAP authenticator.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="ciphersuite">
<section id="section-9.1">
        <h3 id="name-coap-eap-cipher-suites">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-coap-eap-cipher-suites" class="section-name selfRef">CoAP-EAP Cipher Suites</a>
        </h3>
<p id="section-9.1-1">IANA has created a new registry titled "CoAP-EAP Cipher Suites" under a new registry group named "CoAP-EAP".  The registration procedures are "Specification
Required", "Private Use", and "Standards Action with Expert Review" (see <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>), as shown in <a href="#ciphersute-registration-ranges" class="auto internal xref">Table 1</a>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<span id="name-registration-procedures-for"></span><div id="ciphersute-registration-ranges">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-registration-procedures-for" class="selfRef">Registration Procedures for CoAP-EAP Cipher Suites</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">-65536 to -25</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">-24 to -21</td>
              <td class="text-left" rowspan="1" colspan="1">Private Use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">-20 to 23</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">24 to 65535</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.1-3">The columns of the registry are Value, Algorithms, Description, and Reference, where Value is an integer and the other columns are text strings.  The initial registrations are shown in <a href="#ciphersute-initial-value" class="auto internal xref">Table 2</a>.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<span id="name-coap-eap-cipher-suites-init"></span><div id="ciphersute-initial-value">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-coap-eap-cipher-suites-init" class="selfRef">CoAP-EAP Cipher Suites: Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithms</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">10, -16</td>
              <td class="text-left" rowspan="1" colspan="1">AES-CCM-16-64-128, SHA-256</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">1, -16</td>
              <td class="text-left" rowspan="1" colspan="1">A128GCM, SHA-256</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">3, -43</td>
              <td class="text-left" rowspan="1" colspan="1">A256GCM, SHA-384</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">24, -16</td>
              <td class="text-left" rowspan="1" colspan="1">ChaCha20/Poly1305, SHA-256</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">24, -45</td>
              <td class="text-left" rowspan="1" colspan="1">ChaCha20/Poly1305, SHAKE256</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="llid">
<section id="section-9.2">
        <h3 id="name-cddl-in-coap-eap-informatio">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-cddl-in-coap-eap-informatio" class="section-name selfRef">CDDL in CoAP-EAP Information Elements</a>
        </h3>
<p id="section-9.2-1">IANA has created a new registry titled "CoAP-EAP Information Elements" under a new registry group named "CoAP-EAP".  The registration procedures are "Standards Action with Expert Review", "Private Use", "Specification Required", and "Experimental Use" (see <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>),
as shown in <a href="#coap-eap-ie-registration-ranges" class="auto internal xref">Table 3</a>.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<span id="name-registration-procedures-for-"></span><div id="coap-eap-ie-registration-ranges">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-registration-procedures-for-" class="selfRef">Registration Procedures for CoAP-EAP Information Elements</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Range</th>
              <th class="text-left" rowspan="1" colspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0 to 23</td>
              <td class="text-left" rowspan="1" colspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">24 to 49</td>
              <td class="text-left" rowspan="1" colspan="1">Private Use</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">50 to 65000</td>
              <td class="text-left" rowspan="1" colspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">65001 to 65535</td>
              <td class="text-left" rowspan="1" colspan="1">Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-9.2-3">The columns of the registry are Name, Label, CBOR Type, Description, and Reference, where Label is an integer and the other columns are text strings.  The initial registrations are shown in <a href="#coap-eap-ie-values" class="auto internal xref">Table 4</a>.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<span id="name-coap-eap-information-elemen"></span><div id="coap-eap-ie-values">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-coap-eap-information-elemen" class="selfRef">CoAP-EAP Information Elements: Initial Registrations</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Cipher Suite</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR Array</td>
              <td class="text-left" rowspan="1" colspan="1">List of the proposed or selected COSE algorithms for OSCORE</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RID-C</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Byte String</td>
              <td class="text-left" rowspan="1" colspan="1">Contains the Recipient ID of the EAP authenticator</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RID-I</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Byte String</td>
              <td class="text-left" rowspan="1" colspan="1">Contains the Recipient ID of the EAP peer</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Session-Lifetime</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">uint</td>
              <td class="text-left" rowspan="1" colspan="1">Contains the time that the session is valid, in seconds</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="wellknown">
<section id="section-9.3">
        <h3 id="name-the-well-known-uris-registr">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-the-well-known-uris-registr" class="section-name selfRef">The Well-Known URIs Registry</a>
        </h3>
<p id="section-9.3-1">IANA has added the well-known URI "coap-eap" to the "Well-Known URIs" registry under the "Well-Known URIs" registry group defined by <span>[<a href="#RFC8615" class="cite xref">RFC8615</a>]</span>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-2">
          <dt id="section-9.3-2.1">URI Suffix:</dt>
          <dd style="margin-left: 1.5em" id="section-9.3-2.2">coap-eap<a href="#section-9.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.3">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-9.3-2.4">RFC 9820<a href="#section-9.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.5">Status:</dt>
          <dd style="margin-left: 1.5em" id="section-9.3-2.6">permanent<a href="#section-9.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.7">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-9.3-2.8">IETF<a href="#section-9.3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lowerlayer">
<section id="section-9.4">
        <h3 id="name-the-eap-lower-layers-regist">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-the-eap-lower-layers-regist" class="section-name selfRef">The EAP Lower Layers Registry</a>
        </h3>
<p id="section-9.4-1">IANA has added the identifier "CoAP-EAP" to the "EAP Lower Layers" registry (defined by <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span>) under the "Extensible Authentication Protocol (EAP) Registry".<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.4-2">
          <dt id="section-9.4-2.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-9.4-2.2">10<a href="#section-9.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-2.3">Lower Layer:</dt>
          <dd style="margin-left: 1.5em" id="section-9.4-2.4">CoAP-EAP<a href="#section-9.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.4-2.5">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-9.4-2.6">RFC 9820<a href="#section-9.4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="mediatypes">
<section id="section-9.5">
        <h3 id="name-media-types-registry">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-media-types-registry" class="section-name selfRef">Media Types Registry</a>
        </h3>
<p id="section-9.5-1">IANA has added the media type "application/coap-eap" to the "Media Types" registry. <a href="#coap-eap-media-type" class="auto internal xref">Section 4</a> defines the format.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.5-2">
          <dt id="section-9.5-2.1">Type name:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.2">application<a href="#section-9.5-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.3">Subtype name:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.4">coap-eap<a href="#section-9.5-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.5">Required parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.6">N/A<a href="#section-9.5-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.7">Optional parameters:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.8">N/A<a href="#section-9.5-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.9">Encoding considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.10">binary<a href="#section-9.5-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.11">Security considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.12">See <a href="#security_considerations" class="auto internal xref">Section 8</a> of RFC 9820.<a href="#section-9.5-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.13">Interoperability considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.14">N/A<a href="#section-9.5-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.15">Published specification:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.16">RFC 9820<a href="#section-9.5-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.17">Applications that use this media type:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.18">To be identified<a href="#section-9.5-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.19">Fragment identifier considerations:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.20">N/A<a href="#section-9.5-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.21">Additional information:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.22">
            <p id="section-9.5-2.22.1"><br></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.5-2.22.2">
              <dt id="section-9.5-2.22.2.1">Magic number(s):</dt>
              <dd style="margin-left: 1.5em" id="section-9.5-2.22.2.2">N/A<a href="#section-9.5-2.22.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.5-2.22.2.3">File extension(s):</dt>
              <dd style="margin-left: 1.5em" id="section-9.5-2.22.2.4">N/A<a href="#section-9.5-2.22.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-9.5-2.22.2.5">Macintosh file type code(s):</dt>
              <dd style="margin-left: 1.5em" id="section-9.5-2.22.2.6">N/A<a href="#section-9.5-2.22.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.23">Person and email address to contact for further information:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.24">ace@ietf.org<a href="#section-9.5-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.25">Intended usage:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.26">COMMON<a href="#section-9.5-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.27">Restrictions on usage:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.28">N/A<a href="#section-9.5-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.29">Author:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.30">See the "Authors' Addresses" section of RFC 9820.<a href="#section-9.5-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.5-2.31">Change Controller:</dt>
          <dd style="margin-left: 1.5em" id="section-9.5-2.32">IETF<a href="#section-9.5-2.32" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="content-format">
<section id="section-9.6">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registry</a>
        </h3>
<p id="section-9.6-1">IANA has added the media type "application/coap-eap" to the "CoAP Content-Formats" registry under the "Constrained RESTful Environments (CoRE) Parameters" registry group, following the specification in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.3" class="relref">Section 12.3</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<span id="name-coap-content-formats-registr"></span><div id="content-format_registry">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-coap-content-formats-registr" class="selfRef">CoAP Content-Formats Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Media Type</th>
              <th class="text-left" rowspan="1" colspan="1">Content Encoding</th>
              <th class="text-left" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">application/coap-eap</td>
              <td class="text-left" rowspan="1" colspan="1">-</td>
              <td class="text-left" rowspan="1" colspan="1">269</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="resource-type">
<section id="section-9.7">
        <h3 id="name-resource-type-rt-link-targe">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-resource-type-rt-link-targe" class="section-name selfRef">Resource Type (rt=) Link Target Attribute Values Registry</a>
        </h3>
<p id="section-9.7-1">IANA has added the resource type "core.coap-eap" to the "Resource Type (rt=) Link Target Attribute Values" registry under the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<span id="name-resource-type-rt-link-target"></span><div id="resource-type-reg">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-resource-type-rt-link-target" class="selfRef">Resource Type (rt=) Link Target Attribute Values Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">core.coap-eap</td>
              <td class="text-left" rowspan="1" colspan="1">CoAP-EAP resource</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9820</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="expert-review-instructions">
<section id="section-9.8">
        <h3 id="name-expert-review-instructions">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-9.8-1">The IANA registries established in this document apply the
   "Specification Required", "Private Use", "Standards Action with Expert Review",
and "Experimental Use" policies.  (See also <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.)
   This section provides general guidelines for what experts should focus on, but as they are designated experts for a reason, they should be granted flexibility.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.8-2.1">
            <p id="section-9.8-2.1.1">When defining the use of CoAP-EAP Information Elements (IEs), experts are expected to evaluate how the values are defined, their scope, and whether they align with CoAP-EAP's functionality and constraints. They are expected to assess whether the values are clear, well structured, and follow CoAP and CoAP-EAP conventions, such as concise encoding for constrained environments. They should ensure that these IEs can seamlessly integrate with existing CoAP implementations and extensions. Experts are also expected to verify that IE values are protected from unauthorized modification or misuse during transmission.<a href="#section-9.8-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.8-2.2">
            <p id="section-9.8-2.2.1">When adding new cipher suites, experts must ensure that algorithm values are sourced from the appropriate registry when required. They should also consider seeking input from relevant IETF working groups regarding the accuracy of registered parameters.<a href="#section-9.8-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5247">https://www.rfc-editor.org/info/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6677">[RFC6677]</dt>
        <dd>
<span class="refAuthor">Hartman, S., Ed.</span>, <span class="refAuthor">Clancy, T.</span>, and <span class="refAuthor">K. Hoeper</span>, <span class="refTitle">"Channel-Binding Support for Extensible Authentication Protocol (EAP) Methods"</span>, <span class="seriesInfo">RFC 6677</span>, <span class="seriesInfo">DOI 10.17487/RFC6677</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6677">https://www.rfc-editor.org/info/rfc6677</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8323">[RFC8323]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Lemay, S.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Hartke, K.</span>, <span class="refAuthor">Silverajan, B.</span>, and <span class="refAuthor">B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8323">https://www.rfc-editor.org/info/rfc8323</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CoAP-EAP">[CoAP-EAP]</dt>
        <dd>
<span class="refAuthor">Garcia-Carrillo, D.</span> and <span class="refAuthor">R. Marin-Lopez</span>, <span class="refTitle">"Lightweight CoAP-Based Bootstrapping Service for the Internet of Things"</span>, <span class="refContent">Sensors, vol. 16, no. 3</span>, <span class="seriesInfo">DOI 10.3390/s16030358</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://www.mdpi.com/1424-8220/16/3/358">https://www.mdpi.com/1424-8220/16/3/358</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-emu-eap-edhoc">[EAP-EDHOC]</dt>
        <dd>
<span class="refAuthor">Garcia-Carrillo, D.</span>, <span class="refAuthor">Marin-Lopez, R.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Lopez-Gomez</span>, <span class="refTitle">"Using the Extensible Authentication Protocol (EAP) with Ephemeral Diffie-Hellman over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-eap-edhoc-05</span>, <time datetime="2025-07-30" class="refDate">30 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-emu-eap-edhoc-05">https://datatracker.ietf.org/doc/html/draft-ietf-emu-eap-edhoc-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAP-Framework-IoT">[EAP-Framework-IoT]</dt>
        <dd>
<span class="refAuthor">Sethi, M.</span> and <span class="refAuthor">T. Aura</span>, <span class="refTitle">"Secure Network Access Authentication for IoT Devices: EAP Framework vs. Individual Protocols"</span>, <span class="refContent">IEEE Communications Standards Magazine, vol. 5, no. 3, pp. 34-39</span>, <span class="seriesInfo">DOI 10.1109/MCOMSTD.201.2000088</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/9579387">https://ieeexplore.ieee.org/document/9579387</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE802159">[IEEE802159]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Transport of Key Management Protocol (KMP) Datagrams"</span>, <span class="seriesInfo">IEEE Std 802.15.9-2021</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2022.9690134</span>, <time datetime="2022-01" class="refDate">January 2022</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2022.9690134">https://doi.org/10.1109/IEEESTD.2022.9690134</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LO-CoAP-EAP">[LO-CoAP-EAP]</dt>
        <dd>
<span class="refAuthor">Garcia-Carrillo, D.</span>, <span class="refAuthor">Marin-Lopez, R.</span>, <span class="refAuthor">Kandasamy, A.</span>, and <span class="refAuthor">A. Pelov</span>, <span class="refTitle">"A CoAP-Based Network Access Authentication Service for Low-Power Wide Area Networks: LO-CoAP-EAP"</span>, <span class="refContent">Sensors, vol. 17, no. 11</span>, <span class="seriesInfo">DOI 10.3390/s17112646</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://www.mdpi.com/1424-8220/17/11/2646">https://www.mdpi.com/1424-8220/17/11/2646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4017">[RFC4017]</dt>
        <dd>
<span class="refAuthor">Stanley, D.</span>, <span class="refAuthor">Walker, J.</span>, and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs"</span>, <span class="seriesInfo">RFC 4017</span>, <span class="seriesInfo">DOI 10.17487/RFC4017</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4017">https://www.rfc-editor.org/info/rfc4017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4137">[RFC4137]</dt>
        <dd>
<span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Eronen, P.</span>, <span class="refAuthor">Petroni, N.</span>, and <span class="refAuthor">Y. Ohba</span>, <span class="refTitle">"State Machines for Extensible Authentication Protocol (EAP) Peer and Authenticator"</span>, <span class="seriesInfo">RFC 4137</span>, <span class="seriesInfo">DOI 10.17487/RFC4137</span>, <time datetime="2005-08" class="refDate">August 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4137">https://www.rfc-editor.org/info/rfc4137</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4186">[RFC4186]</dt>
        <dd>
<span class="refAuthor">Haverinen, H., Ed.</span> and <span class="refAuthor">J. Salowey, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"</span>, <span class="seriesInfo">RFC 4186</span>, <span class="seriesInfo">DOI 10.17487/RFC4186</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4186">https://www.rfc-editor.org/info/rfc4186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4764">[RFC4764]</dt>
        <dd>
<span class="refAuthor">Bersani, F.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"The EAP-PSK Protocol: A Pre-Shared Key Extensible Authentication Protocol (EAP) Method"</span>, <span class="seriesInfo">RFC 4764</span>, <span class="seriesInfo">DOI 10.17487/RFC4764</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4764">https://www.rfc-editor.org/info/rfc4764</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5191">[RFC5191]</dt>
        <dd>
<span class="refAuthor">Forsberg, D.</span>, <span class="refAuthor">Ohba, Y., Ed.</span>, <span class="refAuthor">Patil, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">A. Yegin</span>, <span class="refTitle">"Protocol for Carrying Authentication for Network Access (PANA)"</span>, <span class="seriesInfo">RFC 5191</span>, <span class="seriesInfo">DOI 10.17487/RFC5191</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5191">https://www.rfc-editor.org/info/rfc5191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5433">[RFC5433]</dt>
        <dd>
<span class="refAuthor">Clancy, T.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method"</span>, <span class="seriesInfo">RFC 5433</span>, <span class="seriesInfo">DOI 10.17487/RFC5433</span>, <time datetime="2009-02" class="refDate">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5433">https://www.rfc-editor.org/info/rfc5433</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5448">[RFC5448]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 5448</span>, <span class="seriesInfo">DOI 10.17487/RFC5448</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5448">https://www.rfc-editor.org/info/rfc5448</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6696">[RFC6696]</dt>
        <dd>
<span class="refAuthor">Cao, Z.</span>, <span class="refAuthor">He, B.</span>, <span class="refAuthor">Shi, Y.</span>, <span class="refAuthor">Wu, Q., Ed.</span>, and <span class="refAuthor">G. Zorn, Ed.</span>, <span class="refTitle">"EAP Extensions for the EAP Re-authentication Protocol (ERP)"</span>, <span class="seriesInfo">RFC 6696</span>, <span class="seriesInfo">DOI 10.17487/RFC6696</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6696">https://www.rfc-editor.org/info/rfc6696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7833">[RFC7833]</dt>
        <dd>
<span class="refAuthor">Howlett, J.</span>, <span class="refAuthor">Hartman, S.</span>, and <span class="refAuthor">A. Perez-Mendez, Ed.</span>, <span class="refTitle">"A RADIUS Attribute, Binding, Profiles, Name Identifier Format, and Confirmation Methods for the Security Assertion Markup Language (SAML)"</span>, <span class="seriesInfo">RFC 7833</span>, <span class="seriesInfo">DOI 10.17487/RFC7833</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7833">https://www.rfc-editor.org/info/rfc7833</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7967">https://www.rfc-editor.org/info/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8824">[RFC8824]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, and <span class="refAuthor">R. Andreasen</span>, <span class="refTitle">"Static Context Header Compression (SCHC) for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8824</span>, <span class="seriesInfo">DOI 10.17487/RFC8824</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8824">https://www.rfc-editor.org/info/rfc8824</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9031">[RFC9031]</dt>
        <dd>
<span class="refAuthor">Vučinić, M., Ed.</span>, <span class="refAuthor">Simon, J.</span>, <span class="refAuthor">Pister, K.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Constrained Join Protocol (CoJP) for 6TiSCH"</span>, <span class="seriesInfo">RFC 9031</span>, <span class="seriesInfo">DOI 10.17487/RFC9031</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9031">https://www.rfc-editor.org/info/rfc9031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9140">[RFC9140]</dt>
        <dd>
<span class="refAuthor">Aura, T.</span>, <span class="refAuthor">Sethi, M.</span>, and <span class="refAuthor">A. Peltonen</span>, <span class="refTitle">"Nimble Out-of-Band Authentication for EAP (EAP-NOOB)"</span>, <span class="seriesInfo">RFC 9140</span>, <span class="seriesInfo">DOI 10.17487/RFC9140</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9140">https://www.rfc-editor.org/info/rfc9140</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
        <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9176">https://www.rfc-editor.org/info/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9190">[RFC9190]</dt>
        <dd>
<span class="refAuthor">Preuß Mattsson, J.</span> and <span class="refAuthor">M. Sethi</span>, <span class="refTitle">"EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3"</span>, <span class="seriesInfo">RFC 9190</span>, <span class="seriesInfo">DOI 10.17487/RFC9190</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9190">https://www.rfc-editor.org/info/rfc9190</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9200">https://www.rfc-editor.org/info/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="THREAD">[THREAD]</dt>
        <dd>
<span class="refAuthor">Kumar, S.</span> and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Thread 1.4 Features White Paper"</span>, <time datetime="2024-09" class="refDate">September 2024</time>, <span>&lt;<a href="https://www.threadgroup.org/Portals/0/Documents/Thread_1.4_Features_White_Paper_September_2024.pdf">https://www.threadgroup.org/Portals/0/Documents/Thread_1.4_Features_White_Paper_September_2024.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TS133.501">[TS133.501]</dt>
      <dd>
<span class="refAuthor">ETSI</span>, <span class="refTitle">"5G; Security architecture and procedures for 5G System"</span>, <span class="refContent">V18.9.0</span>, <span class="seriesInfo">ETSI TS 133 501</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.etsi.org/deliver/etsi_ts/133500_133599/133501/18.09.00_60/ts_133501v180900p.pdf">https://www.etsi.org/deliver/etsi_ts/133500_133599/133501/18.09.00_60/ts_133501v180900p.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="flow-of-operation-dtls">
<section id="appendix-A">
      <h2 id="name-flow-of-operation-dtls-esta">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-flow-of-operation-dtls-esta" class="section-name selfRef">Flow of Operation (DTLS Establishment)</a>
      </h2>
<p id="appendix-A-1">CoAP-EAP makes it possible to derive a Pre-Shared Key (PSK) from the MSK to allow (D)TLS PSK-based authentication between the EAP peer and the EAP authenticator instead of using OSCORE. In the case of using (D)TLS to establish a security association, there is a limitation on the use of intermediaries between the EAP peer and the EAP authenticator, as (D)TLS breaks the end-to-end communications when using intermediaries such as proxies.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><a href="#fig-dtls" class="auto internal xref">Figure 9</a> shows the last steps of the flow of operation for CoAP-EAP when (D)TLS is used to protect the communication between the EAP peer and the EAP authenticator using the keying material exported by the EAP authentication. The general flow is essentially the same as in the case of OSCORE, except that DTLS negotiation is established in Step 7. Once DTLS negotiation has finished successfully, the EAP peer is granted access to the domain. Step 7 <span class="bcp14">MUST</span> be interpreted by the EAP peer as an alternate success indication, which will end up with the MSK and the DTLS_PSK derivation for the (D)TLS authentication based on the PSK.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<span id="name-coap-eap-flow-of-operation-w"></span><div id="fig-dtls">
<figure id="figure-9">
        <div id="appendix-A-3.1">
          <div class="alignCenter art-svg artwork" id="appendix-A-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="504" viewBox="0 0 504 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,176 L 32,192" fill="none" stroke="black"></path>
              <path d="M 88,80 L 88,208" fill="none" stroke="black"></path>
              <path d="M 424,80 L 424,208" fill="none" stroke="black"></path>
              <path d="M 448,144 L 448,160" fill="none" stroke="black"></path>
              <path d="M 16,48 L 112,48" fill="none" stroke="black"></path>
              <path d="M 336,48 L 432,48" fill="none" stroke="black"></path>
              <path d="M 96,112 L 416,112" fill="none" stroke="black"></path>
              <path d="M 96,160 L 416,160" fill="none" stroke="black"></path>
              <path d="M 96,190 L 192,190" fill="none" stroke="black"></path>
              <path d="M 96,194 L 192,194" fill="none" stroke="black"></path>
              <path d="M 328,190 L 416,190" fill="none" stroke="black"></path>
              <path d="M 328,194 L 416,194" fill="none" stroke="black"></path>
              <path d="M 144,224 L 160,224" fill="none" stroke="black"></path>
              <path d="M 352,224 L 368,224" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="456,160 444,154.4 444,165.6" fill="black" transform="rotate(90,448,160)"></polygon>
              <polygon class="arrowhead" points="424,112 412,106.4 412,117.6" fill="black" transform="rotate(0,416,112)"></polygon>
              <polygon class="arrowhead" points="376,224 364,218.4 364,229.6" fill="black" transform="rotate(0,368,224)"></polygon>
              <polygon class="arrowhead" points="152,224 140,218.4 140,229.6" fill="black" transform="rotate(180,144,224)"></polygon>
              <polygon class="arrowhead" points="104,160 92,154.4 92,165.6" fill="black" transform="rotate(180,96,160)"></polygon>
              <polygon class="arrowhead" points="40,192 28,186.4 28,197.6" fill="black" transform="rotate(90,32,192)"></polygon>
              <g class="text">
                <text x="40" y="36">EAP</text>
                <text x="76" y="36">peer</text>
                <text x="344" y="36">EAP</text>
                <text x="416" y="36">authenticator</text>
                <text x="216" y="68">...</text>
                <text x="116" y="84">2.01</text>
                <text x="168" y="84">Created</text>
                <text x="256" y="84">Location-Path</text>
                <text x="364" y="84">[/a/eap/(n)]</text>
                <text x="176" y="100">Payload(EAP-X-Resp)</text>
                <text x="76" y="116">6)</text>
                <text x="448" y="132">MSK</text>
                <text x="172" y="148">(D)TLS</text>
                <text x="216" y="148">1.3</text>
                <text x="260" y="148">Client</text>
                <text x="312" y="148">Hello</text>
                <text x="32" y="164">MSK</text>
                <text x="76" y="164">7)</text>
                <text x="468" y="180">DTLS_PSK</text>
                <text x="220" y="196">DTLS</text>
                <text x="280" y="196">handshake</text>
                <text x="36" y="212">DTLS_PSK</text>
                <text x="208" y="228">Protected</text>
                <text x="268" y="228">with</text>
                <text x="316" y="228">(D)TLS</text>
              </g>
            </svg><a href="#appendix-A-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-coap-eap-flow-of-operation-w" class="selfRef">CoAP-EAP Flow of Operation with DTLS</a>
        </figcaption></figure>
</div>
<p id="appendix-A-4">According to <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, the provision of the PSK out of band also requires the provision of the KDF hash algorithm and the PSK identity. To simplify the design in CoAP-EAP, the KDF hash algorithm can be included in the list of cipher suites exchanged in Steps 1 and 2 (<a href="#figure8" class="auto internal xref">Figure 8</a>) if one wants to use DTLS instead of OSCORE. For the same reason, the PSK identity is derived from RID-C || RID-I as defined in <a href="#dtls-psk" class="auto internal xref">Appendix A.1</a>.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">Analogous to how the cipher suite is negotiated for OSCORE (<a href="#crypto-negotiation" class="auto internal xref">Section 6.1</a>), the EAP authenticator sends a list, in decreasing order of preference, with the identifiers of the hash algorithms supported (Step 1). In the response, the EAP peer sends its choice.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<p id="appendix-A-6">This list is included in the payload after the EAP message with a CBOR array that contains the cipher suites. This CBOR array is enclosed as one of the elements of the CBOR Object used for transporting information in CoAP-EAP (see <a href="#cbor-coap-eap" class="auto internal xref">Section 5</a>).   An example of how the fields are arranged in the CoAP payload can be seen in <a href="#figure7" class="auto internal xref">Figure 7</a>.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<p id="appendix-A-7">If there is no CBOR array specifying the cipher suites, the default cipher suites are applied. If the EAP authenticator sends a restricted list of cipher suites that can be accepted, it <span class="bcp14">MUST</span> include the default value 0, since it is mandatory to implement. The EAP peer will have at least that option available.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">For DTLS, the negotiated cipher suite is used to determine the hash function to be used to derive the "DTLS_PSK" from the MSK. The following hash algorithms are considered in cases where the specification includes DTLS support in the future:<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-9.1">
          <p id="appendix-A-9.1.1">5) TLS_SHA256<a href="#appendix-A-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-9.2">
          <p id="appendix-A-9.2.1">6) TLS_SHA384<a href="#appendix-A-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-9.3">
          <p id="appendix-A-9.3.1">7) TLS_SHA512<a href="#appendix-A-9.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-10">The inclusion of these values, apart from indicating the hash algorithm, indicates that the EAP authenticator intends to establish an OSCORE security association or a DTLS security association after the authentication is completed. If both options appear in the cipher suite negotiation, the OSCORE security association will be preferred over DTLS.<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<div id="dtls-psk">
<section id="appendix-A.1">
        <h3 id="name-deriving-dtls_psk-and-ident">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-deriving-dtls_psk-and-ident" class="section-name selfRef">Deriving DTLS_PSK and Identity</a>
        </h3>
<p id="appendix-A.1-1">To enable DTLS after an EAP authentication, Identity and the PSK for DTLS are defined. Identity in this case is generated by concatenating the exchanged Sender ID and the Recipient ID.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>
                CoAP-EAP PSK Identity = RID-C || RID-I
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">It is also possible to derive a PSK for DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, referred to here as "DTLS_PSK", from the MSK between both the EAP peer and EAP authenticator if required. The length of the DTLS_PSK will depend on the cipher suite. To have keying material with sufficient length, a key of 32 bytes is derived that can be truncated later if needed:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>
                DTLS_PSK = KDF(MSK, "CoAP-EAP DTLS_PSK", length)
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-5">where:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-6.1">
            <p id="appendix-A.1-6.1.1">The MSK is exported by the EAP method.<a href="#appendix-A.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-6.2">
            <p id="appendix-A.1-6.2.1">"CoAP-EAP DTLS_PSK" is the ASCII code representation of the non-NULL-terminated string (excluding the double quotes around it).<a href="#appendix-A.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-6.3">
            <p id="appendix-A.1-6.3.1">length is the size of the output key material.<a href="#appendix-A.1-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="using-coap-eap-for-distributing-key-material-for-iot-networks">
<section id="appendix-B">
      <h2 id="name-using-coap-eap-for-distribu">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-using-coap-eap-for-distribu" class="section-name selfRef">Using CoAP-EAP for Distributing Key Material for IoT Networks</a>
      </h2>
<p id="appendix-B-1">Similarly to the example in <a href="#dtls-psk" class="auto internal xref">Appendix A.1</a>, where a PSK for DTLS is derived, it is possible to provide key material to different link layers after the CoAP-EAP authentication is complete.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">For example, CoAP-EAP could be used to derive the PSK required to run the Constrained Join Protocol (CoJP) for IPv6 over the TSCH mode of IEEE 802.15.4e (6TiSCH) <span>[<a href="#RFC9031" class="cite xref">RFC9031</a>]</span>. ("TSCH" stands for "Time-Slotted Channel Hopping".)<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Another example would be when a shared Network Key is required by the devices that join a network. An example of this Network Key can be found in the THREAD protocol <span>[<a href="#THREAD" class="cite xref">THREAD</a>]</span>. After CoAP-EAP execution, a security association based on OSCORE protects any exchange between the EAP peer and the EAP authenticator. This security association can be used for distributing the Network Key securely and other required parameters. How the Network Key is distributed after a successful CoAP-EAP authentication is outside the scope of this document.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">How a particular link-layer technology uses the MSK to derive further key material for protecting the link layer or uses OSCORE protection to distribute key material is outside the scope of this document.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples-of-use-case-scenario">
<section id="appendix-C">
      <h2 id="name-example-use-case-scenarios">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-example-use-case-scenarios" class="section-name selfRef">Example Use Case Scenarios</a>
      </h2>
<p id="appendix-C-1">In IoT networks, for an EAP peer to act as a trustworthy entity within a security domain, certain key material needs to be shared between the EAP peer and the EAP authenticator.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Next, examples of different use case scenarios will be elaborated on as related to the usage of CoAP-EAP.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Generally, four entities are involved:<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">Two EAP peers (A and B).<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.2">
          <p id="appendix-C-4.2.1">One EAP authenticator (C). The EAP authenticator manages a domain where EAP peers can be deployed. In IoT networks, it can be considered a more powerful machine than the EAP peers.<a href="#appendix-C-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.3">
          <p id="appendix-C-4.3.1">One AAA server. Optional. The AAA server is not constrained. Here, the EAP authenticator is operating in pass-through mode.<a href="#appendix-C-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-C-5">Generally, any EAP peer wanting to join the domain managed by the EAP authenticator <span class="bcp14">MUST</span> perform a CoAP-EAP authentication with the EAP authenticator (C). This authentication <span class="bcp14">MAY</span> involve an external AAA server.  This means that the EAP peers (A and B), once deployed, will run CoAP-EAP once, as a bootstrapping phase, to establish a security association with C. Moreover, any other entity that wants to join and establish communications with EAP peers under
C's domain must also do the same.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<p id="appendix-C-6">By using EAP, the flexibility of having different types of credentials can be achieved. For instance, if a device that is not battery dependent and not very constrained is available, a heavier authentication method could be used. With varied EAP peers and networks, authentication methods that are more lightweight (e.g., EAP-NOOB <span>[<a href="#RFC9140" class="cite xref">RFC9140</a>]</span>, EAP-AKA' <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span>, EAP-PSK <span>[<a href="#RFC4764" class="cite xref">RFC4764</a>]</span>, EAP-EDHOC <span>[<a href="#I-D.ietf-emu-eap-edhoc" class="cite xref">EAP-EDHOC</a>]</span>, etc.) and
are able to adapt to different types of devices according to organization policies or device capabilities might need to be used.<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<div id="example-1-coap-eap-in-ace">
<section id="appendix-C.1">
        <h3 id="name-example-1-coap-eap-using-ac">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-example-1-coap-eap-using-ac" class="section-name selfRef">Example 1:  CoAP-EAP Using ACE</a>
        </h3>
<p id="appendix-C.1-1">When using ACE, the process of client registration and provisioning of credentials to the client is not specified. The process of client registration and provisioning can be achieved using CoAP-EAP. Once the process of authentication with EAP is completed, the fresh key material is shared between the EAP peer and the EAP authenticator. With ACE, the EAP authenticator and the Authorization Server (AS) can be co-located.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">Next, a general way to exemplify how client registration can be performed using CoAP-EAP is presented, to allow two EAP peers (A and B) to communicate and interact after a successful client registration.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">EAP peer A wants to communicate with EAP peer B (e.g., to activate a light switch).  The overall process is divided into three phases.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-4.1">
            <p id="appendix-C.1-4.1.1">In the first phase, EAP peer A does not yet belong to EAP authenticator C's domain.  Then, it communicates with C and authenticates with CoAP-EAP, which, optionally, communicates with the AAA server to complete the authentication process. If the authentication is successful, a fresh MSK is shared between C and EAP peer A. This key material allows EAP peer A to establish a security association with C. Some authorization information may also be provided in this step. If EAP is used in standalone mode, the AS itself, having information about the devices, can be the entity providing said authorization information.<a href="#appendix-C.1-4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-4.1.2">If authentication and authorization are correct, EAP peer A is enrolled in EAP authenticator C's domain for some period of time. In particular, <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span> recommends 8 hours, though the entity providing the authorization information can establish this lifetime.  In the same manner, B needs to perform the same process with CoAP-EAP to be part of EAP authenticator C's domain.<a href="#appendix-C.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-4.2">
            <p id="appendix-C.1-4.2.1">In the second phase, when EAP peer A wants to talk to EAP peer B, it contacts EAP authenticator C for authorization to access EAP peer B and obtain all the required information to do that securely (e.g., keys, tokens, authorization information, etc.).  This phase does NOT require the usage of CoAP-EAP.  The details of this phase are outside the scope of this document; the ACE framework is used for this purpose. See <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#appendix-C.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-4.3">
            <p id="appendix-C.1-4.3.1">In the third phase, EAP peer A can access EAP peer B with the credentials and information obtained from EAP authenticator C during the second phase. This access can be repeated without contacting the EAP authenticator, as long as the credentials given to A are still valid.  The details of this phase are outside the scope of this document.<a href="#appendix-C.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-C.1-5">It is worth noting that to join EAP authenticator C's domain, the first phase (authentication via CoAP-EAP) is required.  Once it is performed successfully, the communications are local to EAP authenticator C's domain and there is no need to perform a new EAP authentication as long as the key material is still valid. When the keys are about to expire, the EAP peer can engage in a re-authentication to renew the key material,
as explained in <a href="#re-authentication" class="auto internal xref">Section 3.3</a>.<a href="#appendix-C.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-2-multi-domain-with-aaa-infrastructures">
<section id="appendix-C.2">
        <h3 id="name-example-2-multiple-domains-">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-example-2-multiple-domains-" class="section-name selfRef">Example 2: Multiple Domains with AAA Infrastructures</a>
        </h3>
<p id="appendix-C.2-1">A device (A) of the domain acme.org uses a specific kind of credential
and intends to join the um.es domain. This user does not belong to this domain, for which it first performs a client registration using CoAP-EAP. To do this, it interacts with the EAP authenticator's domain, which in turn communicates with a AAA infrastructure (acting as a AAA client). Then, the local AAA server communicates with the home AAA server to complete the authentication. This way, the device can be considered as a trustworthy entity within EAP authenticator C's domain. In this scenario, the AS, in the role of the EAP authenticator, receives the key material from the AAA infrastructure.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-3-single-domain-with-aaa-infrastructure">
<section id="appendix-C.3">
        <h3 id="name-example-3-single-domain-wit">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-example-3-single-domain-wit" class="section-name selfRef">Example 3: Single Domain with a AAA Infrastructure</a>
        </h3>
<p id="appendix-C.3-1">In this scenario, a university campus has several faculty buildings, where each building has its criteria or policies in place to manage EAP peers under an AS. All buildings belong to the same domain (e.g., um.es). All these buildings are managed with a AAA infrastructure. A new device (A) with credentials from the domain (e.g., um.es) will be able to perform the device registration with an EAP authenticator (C) of any building if they are managed by the same general domain.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-4-single-domain-without-aaa-infrastructure">
<section id="appendix-C.4">
        <h3 id="name-example-4-single-domain-wit">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-example-4-single-domain-wit" class="section-name selfRef">Example 4: Single Domain Without a AAA Infrastructure</a>
        </h3>
<p id="appendix-C.4-1">In another case, without a AAA infrastructure, with an EAP authenticator that has co-located the EAP server, and using EAP standalone mode, all the devices can be managed within the same domain locally. Client registration of an EAP peer (A) with a Controller (C) can also be performed in the same manner.<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-use-cases">
<section id="appendix-C.5">
        <h3 id="name-other-use-cases">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-other-use-cases" class="section-name selfRef">Other Use Cases</a>
        </h3>
<div id="coap-eap-network-access-control">
<section id="appendix-C.5.1">
          <h4 id="name-coap-eap-for-network-access">
<a href="#appendix-C.5.1" class="section-number selfRef">C.5.1. </a><a href="#name-coap-eap-for-network-access" class="section-name selfRef">CoAP-EAP for Network Access Authentication</a>
          </h4>
<p id="appendix-C.5.1-1">One of the first steps for an EAP peer is to perform the authentication to gain access to the network. To do so, the device must first be authenticated and granted authorization to gain access to the network. Additionally, security parameters such as credentials can be derived from the authentication process, allowing the trustworthy operation of the EAP peer in a particular network by joining the security domain. By using EAP, this can be achieved with flexibility and scalability, because of the different EAP methods available and the ability to rely on AAA infrastructures if needed to support multi-domain scenarios, which is a key feature when the EAP peers deployed under the same security domain belong, for example, to different organizations.<a href="#appendix-C.5.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-2">The following two cases apply to the process of joining a network:
1) the node has an IPv6 address (e.g., link-local IPv6 or IPv6 global address) and 2) the node does not have an IPv6 address.<a href="#appendix-C.5.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-3">In networks where the device is in place but no IP support is available until the EAP peer is authenticated, specific support for this EAP lower layer has to be defined to allow CoAP-EAP messages to be exchanged between the EAP peer and the EAP authenticator. For example, in IEEE 802.15.4 networks, a new Key Management
Protocol (KMP) ID can be defined to add such support in the case of IEEE 802.15.9 <span>[<a href="#IEEE802159" class="cite xref">IEEE802159</a>]</span>, where it can be assumed that the device has at least a link-layer IPv6 address.<a href="#appendix-C.5.1-3" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-4">When the EAP peer intends to be admitted into the network, it would search for an entity that offers the CoAP-EAP service, be it directly via the EAP authenticator or through an intermediary (e.g., proxy). See <a href="#discovery-section" class="auto internal xref">Section 3.1</a>.<a href="#appendix-C.5.1-4" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-5">CoAP-EAP will run between the EAP peer and the EAP authenticator or through an intermediary entity such as a proxy, as happens in a mesh network, where the EAP authenticator could be placed one or more hops away from the EAP peer. In the case that a proxy participates in CoAP-EAP, it will be because it is already a trustworthy entity within the domain and communicates through a secure channel with the EAP authenticator, as illustrated by <a href="#fig-network-proxy" class="auto internal xref">Figure 10</a>.<a href="#appendix-C.5.1-5" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-6">If the EAP peer cannot connect to the EAP authenticator directly, the
EAP peer can follow the same process as that described in
<a href="#proxy" class="auto internal xref">Section 3.6</a> to perform the authentication (i.e., can connect via
an intermediary entity (e.g., proxy) that is already part of the network (already shares
key material and communicates through a secure channel with the authenticator) and
can aid in running CoAP-EAP).<a href="#appendix-C.5.1-6" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-7">When CoAP-EAP is completed and the OSCORE security association is established with the EAP authenticator, the EAP peer receives the local configuration parameters for the network (e.g., a Network Key) and can configure a global IPv6 address. Moreover, there is no need for an intermediary entity after a successful authentication.<a href="#appendix-C.5.1-7" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-8">For removal, if the EAP authenticator decides to remove a particular EAP peer from the network or the peer itself intends to leave, either the EAP peer or the EAP authenticator can directly send a DELETE command to explicitly express that the network access state is removed, and the device will no longer belong to the network. Thus, any state related to the EAP peer is removed in the EAP authenticator. Forced removal can be done by sending new specific key material to the devices that still belong to the network, excluding the removed device, following a model similar to CoJP for 6TiSCH <span>[<a href="#RFC9031" class="cite xref">RFC9031</a>]</span>. The specifics on how this process is to be done are outside the scope of this document.<a href="#appendix-C.5.1-8" class="pilcrow">¶</a></p>
<span id="name-coap-eap-through-coap-proxy"></span><div id="fig-network-proxy">
<figure id="figure-10">
            <div id="appendix-C.5.1-9.1">
              <div class="alignCenter art-svg artwork" id="appendix-C.5.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="144" width="568" viewBox="0 0 568 144" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                  <path d="M 72,32 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 144,32 L 144,80" fill="none" stroke="black"></path>
                  <path d="M 216,32 L 216,80" fill="none" stroke="black"></path>
                  <path d="M 440,32 L 440,80" fill="none" stroke="black"></path>
                  <path d="M 560,32 L 560,80" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 72,32" fill="none" stroke="black"></path>
                  <path d="M 144,32 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 440,32 L 560,32" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 136,64" fill="none" stroke="black"></path>
                  <path d="M 224,64 L 432,64" fill="none" stroke="black"></path>
                  <path d="M 8,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 144,80 L 216,80" fill="none" stroke="black"></path>
                  <path d="M 440,80 L 560,80" fill="none" stroke="black"></path>
                  <path d="M 224,112 L 240,112" fill="none" stroke="black"></path>
                  <path d="M 424,112 L 440,112" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="448,112 436,106.4 436,117.6" fill="black" transform="rotate(0,440,112)"></polygon>
                  <polygon class="arrowhead" points="440,64 428,58.4 428,69.6" fill="black" transform="rotate(0,432,64)"></polygon>
                  <polygon class="arrowhead" points="232,112 220,106.4 220,117.6" fill="black" transform="rotate(180,224,112)"></polygon>
                  <polygon class="arrowhead" points="232,64 220,58.4 220,69.6" fill="black" transform="rotate(180,224,64)"></polygon>
                  <polygon class="arrowhead" points="144,64 132,58.4 132,69.6" fill="black" transform="rotate(0,136,64)"></polygon>
                  <polygon class="arrowhead" points="88,64 76,58.4 76,69.6" fill="black" transform="rotate(180,80,64)"></polygon>
                  <g class="text">
                    <text x="32" y="52">EAP</text>
                    <text x="180" y="52">CoAP</text>
                    <text x="480" y="52">EAP</text>
                    <text x="36" y="68">peer</text>
                    <text x="184" y="68">proxy</text>
                    <text x="504" y="68">authenticator</text>
                    <text x="108" y="84">CoAP</text>
                    <text x="324" y="84">CoAP</text>
                    <text x="328" y="100">OSCORE/DTLS</text>
                    <text x="284" y="116">security</text>
                    <text x="368" y="116">association</text>
                  </g>
                </svg><a href="#appendix-C.5.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-coap-eap-through-coap-proxy" class="selfRef">CoAP-EAP Through CoAP Proxy</a>
            </figcaption></figure>
</div>
<p id="appendix-C.5.1-10">Given that EAP is also used for network access authentication, this service can be adapted to other technologies -- for instance, to provide network access control to very constrained technologies (e.g., Long Range (LoRa) networks). The authors of <span>[<a href="#LO-CoAP-EAP" class="cite xref">LO-CoAP-EAP</a>]</span> provide a study of a minimal version of CoAP-EAP for LPWANs, with interesting results. In this specific case, compression as provided by Static Context Header Compression (SCHC) for CoAP <span>[<a href="#RFC8824" class="cite xref">RFC8824</a>]</span> can be leveraged.<a href="#appendix-C.5.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="coap-eap-for-service-authentication">
<section id="appendix-C.5.2">
          <h4 id="name-coap-eap-for-service-authen">
<a href="#appendix-C.5.2" class="section-number selfRef">C.5.2. </a><a href="#name-coap-eap-for-service-authen" class="section-name selfRef">CoAP-EAP for Service Authentication</a>
          </h4>
<p id="appendix-C.5.2-1">It is not uncommon that the infrastructure where the device is deployed and the services of the EAP peer are managed by different organizations. Therefore, in addition to the authentication for network access control, the possibility of a secondary authentication to access different services has to be considered. This process of authentication, for example, will provide the necessary key material to establish a secure channel and interact with the entity in charge of granting access to different services.<a href="#appendix-C.5.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5.2-2">In 5G, for example, consider primary and secondary authentication using EAP <span>[<a href="#TS133.501" class="cite xref">TS133.501</a>]</span>.<a href="#appendix-C.5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">We would like to thank the reviewers of this work: <span class="contact-name">Paul Wouters</span>, <span class="contact-name">Heikki Vatiainen</span>,
      <span class="contact-name">Josh Howlett</span>, <span class="contact-name">Deb Cooley</span>,
      <span class="contact-name">Eliot Lear</span>, <span class="contact-name">Alan DeKok</span>,
      <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Mohit       Sethi</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">John Preuß Mattsson</span>,
      <span class="contact-name">Göran Selander</span>, <span class="contact-name">Alexandre       Petrescu</span>, <span class="contact-name">Pedro Moreno-Sanchez</span>, and <span class="contact-name">Eduardo Ingles-Sanchez</span>.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">We would also like to thank <span class="contact-name">Gabriel       Lopez-Millan</span> for the first review of this document, <span class="contact-name">Ivan Jimenez-Sanchez</span> for the first
      proof-of-concept implementation of this idea, <span class="contact-name">Julian       Niklas Schimmelpfennig</span> for the implementation of the Erbium-based IoT
      device implementation, and <span class="contact-name">Daniel Menendez       Gonzalez</span> for the Python implementation.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Thanks also to <span class="contact-name">Alexander Pelov</span> and <span class="contact-name">Laurent Toutain</span> for their valuable comments, especially regarding the
      potential optimizations of CoAP-EAP.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">This work was supported in part by Grant PID2020-112675RB-C44 funded
      by MCIN/AEI/10.13039/5011000011033 (ONOFRE-3-UMU) and in part by the
      H2020 EU project IoTCrawler under contract 779852.<a href="#appendix-D-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rafa Marin-Lopez</span></div>
<div dir="auto" class="left"><span class="org">University of Murcia</span></div>
<div dir="auto" class="left"><span class="street-address">Campus de Espinardo S/N, Faculty of Computer Science</span></div>
<div dir="auto" class="left">
<span class="postal-code">30100</span> <span class="locality">Murcia</span> </div>
<div dir="auto" class="left"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rafa@um.es" class="email">rafa@um.es</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Garcia-Carrillo</span></div>
<div dir="auto" class="left"><span class="org">University of Oviedo</span></div>
<div dir="auto" class="left"><span class="street-address">Calle Luis Ortiz Berrocal S/N, Edificio Polivalente</span></div>
<div dir="auto" class="left">
<span class="postal-code">33203</span> <span class="locality">Gijon</span> <span class="region">Asturias</span>
</div>
<div dir="auto" class="left"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:garciadan@uniovi.es" class="email">garciadan@uniovi.es</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
