<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9683: Remote Integrity Verification of Network Devices Containing Trusted Platform Modules</title>
<meta content="Guy C. Fedorkow" name="author">
<meta content="Eric Voit" name="author">
<meta content="Jessica Fitzgerald-McKay" name="author">
<meta content="
       This document describes a workflow for remote attestation of the integrity of firmware and software installed on network devices that contain Trusted Platform Modules (TPMs), as defined by 
the Trusted Computing Group (TCG), or equivalent hardware implementations that include the protected capabilities, as provided by TPMs. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="Attestation" name="keyword">
<meta content="TPM" name="keyword">
<meta content="9683" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9683.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-rats-tpm-based-network-device-attest-14" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9683" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9683</td>
<td class="center">Network Device RIV</td>
<td class="right">December 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fedorkow, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9683" class="eref">9683</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-12" class="published">December 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. C. Fedorkow, <span class="editor">Ed.</span>
</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">E. Voit</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">J. Fitzgerald-McKay</div>
<div class="org">National Security Agency</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9683</h1>
<h1 id="title">Remote Integrity Verification of Network Devices Containing Trusted Platform Modules</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a workflow for remote attestation of the integrity of firmware and software installed on network devices that contain Trusted Platform Modules (TPMs), as defined by 
the Trusted Computing Group (TCG), or equivalent hardware implementations that include the protected capabilities, as provided by TPMs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9683">https://www.rfc-editor.org/info/rfc9683</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation" class="internal xref">Requirements Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-document-organization" class="internal xref">Document Organization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-goals" class="internal xref">Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-description-of-remote-integ" class="internal xref">Description of Remote Integrity Verification (RIV)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-solution-requirements" class="internal xref">Solution Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7.2.1">
                    <p id="section-toc.1-1.1.2.7.2.1.1"><a href="#section-1.7.1" class="auto internal xref">1.7.1</a>.  <a href="#name-out-of-scope" class="internal xref">Out of Scope</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-solution-overview" class="internal xref">Solution Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-riv-software-configuration-" class="internal xref">RIV Software Configuration Attestation Using TPM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-what-does-riv-attest" class="internal xref">What Does RIV Attest?</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-notes-on-pcr-allocations" class="internal xref">Notes on PCR Allocations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-riv-keying" class="internal xref">RIV Keying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-riv-information-flow" class="internal xref">RIV Information Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-riv-simplifying-assumptions" class="internal xref">RIV Simplifying Assumptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-reference-integrity-manifes" class="internal xref">Reference Integrity Manifests (RIMs)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-attestation-logs" class="internal xref">Attestation Logs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-standards-components" class="internal xref">Standards Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-prerequisites-for-riv" class="internal xref">Prerequisites for RIV</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-unique-device-identity" class="internal xref">Unique Device Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-keys" class="internal xref">Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-appraisal-policy-for-eviden" class="internal xref">Appraisal Policy for Evidence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-reference-model-for-challen" class="internal xref">Reference Model for Challenge-Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-transport-and-encoding" class="internal xref">Transport and Encoding</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-centralized-vs-peer-to-peer" class="internal xref">Centralized vs. Peer-to-Peer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-keys-used-in-riv" class="internal xref">Keys Used in RIV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-prevention-of-spoofing-and-" class="internal xref">Prevention of Spoofing and Person-in-the-Middle Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-replay-attacks" class="internal xref">Replay Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-owner-signed-keys" class="internal xref">Owner-Signed Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-other-factors-for-trustwort" class="internal xref">Other Factors for Trustworthy Operation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-conclusion" class="internal xref">Conclusion</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-supporting-materials" class="internal xref">Supporting Materials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-using-a-tpm-for-attestation" class="internal xref">Using a TPM for Attestation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-root-of-trust-for-measureme" class="internal xref">Root of Trust for Measurement (RTM)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-layering-model-for-network-" class="internal xref">Layering Model for Network Equipment Attester and Verifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-implementation-notes" class="internal xref">Implementation Notes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">There are many aspects to consider in fielding a trusted computing device,
from operating systems to applications.  Mechanisms to prove that
a device installed at a customer's site is authentic (i.e., not counterfeit) and has
been configured with authorized software, all as part of a trusted supply chain, are just a few of the many aspects that need to be considered concurrently to have confidence that a device is truly trustworthy.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A generic architecture for remote attestation has been defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.  Additionally, use cases for remotely attesting networking devices are discussed within <span><a href="https://datatracker.ietf.org/doc/html/draft-richardson-rats-usecases-08#section-5" class="relref">Section 5</a> of [<a href="#I-D.richardson-rats-usecases" class="cite xref">RATS-USECASES</a>]</span>.  However, these documents do not provide sufficient guidance for network equipment vendors and operators to design, build, and deploy interoperable devices.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The intent of this document is to provide such guidance. It does this by outlining the Remote Integrity Verification (RIV) problem and then by identifying the necessary elements to get the complete, scalable attestation procedure working with commercial networking products such as routers, switches, and firewalls.   An underlying assumption is the availability within the device of a cryptoprocessor that is compatible with the Trusted Platform Module specifications <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span> to enable the trustworthy, remote assessment of the device's software and hardware.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="requirements-notation">
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">A number of terms are reused from <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.  These include Appraisal Policy for Evidence, Attestation Result, Attester, Evidence, Reference Value, Relying Party, Verifier, and Verifier Owner.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Additionally, this document defines the following term:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-3">
          <dt id="section-1.2-3.1">Attestation:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">The process of generating, conveying, and appraising
claims, backed by evidence, about device trustworthiness characteristics, including supply chain trust,
identity, device provenance, software configuration, device
composition, compliance to test suites, functional and assurance evaluations, etc.<a href="#section-1.2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-4">The goal of attestation is simply to assure an administrator or auditor that the device's configuration and software
were authentic and unmodified when the device started.
The determination of software authenticity is not prescribed in this document, but it's typically taken to mean
a software image generated by an authority trusted by the administrator, such as the device manufacturer.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">Within the context of the Trusted Computing Group (TCG), the scope of attestation is typically narrowed to describe the process by
which an independent Verifier can obtain cryptographic proof as to the identity
of the device in question, evidence of the integrity of the device's software that was loaded upon
startup, and verification that the current configuration matches the 
intended configuration.  For network equipment, a Verifier capability can
be embedded in a Network Management Station, a posture collection server,
or other network analytics tool (such as a software asset management solution,
or a threat detection and mitigation tool, etc.). 
This document focuses on a specific subset of attestation tasks, defined here as Remote
Integrity Verification (RIV), and informally referred to as attestation.  RIV in this document takes a network-equipment-centric perspective
that includes a set of protocols and procedures for determining whether a
particular device was launched with authentic software, starting from Roots
of Trust.  While there are many ways to accomplish attestation, RIV sets
out a specific set of protocols and tools that work in environments commonly
found in network equipment.  RIV does not cover other device characteristics
that could be attested (e.g., geographic location or connectivity; 
see <span>[<a href="#I-D.richardson-rats-usecases" class="cite xref">RATS-USECASES</a>]</span>), although it does provide evidence of a secure infrastructure
to increase the level of trust in other device characteristics attested
by other means (e.g., by Entity Attestation Tokens <span>[<a href="#I-D.ietf-rats-eat" class="cite xref">RATS-EAT</a>]</span>).<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">In line with definitions found in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, this document uses the term Endorser to refer to the 
role that signs identity and attestation certificates used by the Attester, while Reference Values are signed 
by a Reference Value Provider.  Typically, the manufacturer of a network device would be accepted as 
both the Endorser and Reference Value Provider, although the choice is ultimately up to the Verifier Owner.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-organization">
<section id="section-1.3">
        <h3 id="name-document-organization">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-document-organization" class="section-name selfRef">Document Organization</a>
        </h3>
<p id="section-1.3-1">The remainder of this document is organized into several sections:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">The remainder of this section covers goals and requirements, plus a top-level description of RIV.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">The Solution Overview section (<a href="#solution-overview" class="auto internal xref">Section 2</a>) outlines how RIV works.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">The Standards Components section (<a href="#standards-components" class="auto internal xref">Section 3</a>) links components of RIV to normative standards.<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">The Privacy and Security Considerations sections (Sections <a href="#privacy-considerations" class="auto internal xref">4</a> and <a href="#security-cons" class="auto internal xref">5</a>) shows how specific features of RIV contribute to the trustworthiness of the Attestation Result.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Supporting material is in an appendix (<a href="#appendix" class="auto internal xref">Appendix A</a>).<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="goals">
<section id="section-1.4">
        <h3 id="name-goals">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-goals" class="section-name selfRef">Goals</a>
        </h3>
<p id="section-1.4-1">Network operators benefit from a trustworthy attestation mechanism that provides
assurance that their network comprises authentic equipment and has loaded software
free of known vulnerabilities and unauthorized tampering.  In line with the overall goal of assuring integrity, attestation can be used to assist in asset management, vulnerability and compliance
assessment, plus configuration management.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">The RIV attestation workflow outlined in this document is intended to meet the following high-level goals:<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-3.1">Provable Device Identity - This specification requires that an Attester (i.e., the attesting device) includes
a cryptographic identifier unique to each device.  Effectively, this means that the device's TPM
must be provisioned with this during the manufacturing cycle.<a href="#section-1.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.4-3.2">Software Inventory - Key goals are to identify the software release(s) installed
on the Attester and to provide evidence that the software stored within hasn't
been altered without authorization.<a href="#section-1.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.4-3.3">Verifiability - Verification of the device's software and configuration shows
that the software that the administrator authorized for use was actually launched.<a href="#section-1.4-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.4-4">In addition, RIV is designed to operate either in a centralized environment, such as with a central authority that manages and configures a number of network devices, or "peer-to-peer", where network devices independently verify one another to establish a trust relationship. (See <a href="#peer-to-peer" class="auto internal xref">Section 3.3</a>.)<a href="#section-1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RIV-desc">
<section id="section-1.5">
        <h3 id="name-description-of-remote-integ">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-description-of-remote-integ" class="section-name selfRef">Description of Remote Integrity Verification (RIV)</a>
        </h3>
<p id="section-1.5-1">Attestation requires two interlocking mechanisms between the Attester network device and the Verifier:<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-2.1">Device Identity is the mechanism that provides trusted identity, which can reassure network
managers that the specific devices they ordered from authorized manufacturers for
attachment to their network are those that were installed and that they continue to
be present in their network. As part of the mechanism for Device Identity,
cryptographic proof of the manufacturer's identity is also provided.<a href="#section-1.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.5-2.2">Software Measurement is the mechanism that reports the state of mutable software components
on the device and that can assure administrators that they have known, authentic
software configured to run in their network.<a href="#section-1.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.5-3">By using these two interlocking mechanisms, RIV, which is a component in a chain of procedures, can assure a network operator that the equipment in
their network can be reliably identified and that authentic software of
a known version is installed on each device.  Equipment in the network includes
devices that make up the network itself, such as routers, switches, and firewalls.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">Software used to boot a device can be identified by a chain
of measurements, anchored at the start by a Root of Trust for Measurement (RTM) (see <a href="#root-of-trust" class="auto internal xref">Appendix A.2</a>). An attestation function embedded in each stage, verified by the previous stage, measures the next stage
and records the result in tamper-resistant storage. 
A measurement signifies the identity, integrity, and version of each
software component registered with an Attester's TPM <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span> so that a
subsequent verification stage can determine if the software
installed is authentic, up-to-date, and free of tampering.<a href="#section-1.5-4" class="pilcrow">¶</a></p>
<p id="section-1.5-5">RIV includes several major processes, which are split between the Attester and Verifier:<a href="#section-1.5-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.5-6">
<li id="section-1.5-6.1">Generation of Evidence is the process whereby an Attester generates cryptographic
proof (Evidence) of claims about device properties. In particular, the
device identity and its software configuration are both of critical importance.<a href="#section-1.5-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-1.5-6.2">Device Identification refers to the mechanism assuring the
Relying Party (ultimately, a network administrator) of the identities of devices, and the identities of their manufacturers, that make up their network.<a href="#section-1.5-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-1.5-6.3">Conveyance of Evidence
 reliably transports the collected Evidence from the Attester to a Verifier to allow a management station to perform
 a meaningful appraisal in Step 4. The transport
 is typically carried out via a management network.
 Although not required for reliable attestation, an encrypted channel may be used to
 provide integrity, authenticity, or confidentiality once attestation is complete.
 It should be noted that critical attestation evidence from the TPM is signed by a key known only to TPM, and is not
 dependent on encryption carried out as part of a reliable transport.<a href="#section-1.5-6.3" class="pilcrow">¶</a>
</li>
          <li id="section-1.5-6.4">Finally, appraisal of evidence occurs.  This is the process of verifying the Evidence received by
  a Verifier from the Attester and using an Appraisal Policy to develop an
  Attestation Result, which is used to inform decision-making.  In practice, this means comparing
  the Attester's measurements reported as Evidence with the device configuration expected
  by the Verifier.  Subsequently, the Appraisal Policy for Evidence might
  match Evidence found against Reference Values (aka Golden Measurements), which represent 
  the intended configured state of the connected device.<a href="#section-1.5-6.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-1.5-7">All implementations supporting this RIV specification require the support of the following three technologies:<a href="#section-1.5-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.5-8">
<li id="section-1.5-8.1">Identity: Device identity in RIV is based on Device Identity (DevID) defined by IEEE Std 802.1AR <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span>,
coupled with careful supply-chain management by the manufacturer.  The
Initial DevID (IDevID) certificate contains a statement by the manufacturer that establishes
the identity of the device as it left the factory.  Some applications with
a more complex post-manufacture supply chain (e.g., value added resellers),
or with different privacy concerns, may want to use alternative mechanisms for platform
authentication (for example, TCG Platform Certificates <span>[<a href="#PLATFORM-CERTS" class="cite xref">PLATFORM-CERTS</a>]</span> or 
post-manufacture installation of Local DevID (LDevID)).<a href="#section-1.5-8.1" class="pilcrow">¶</a>
</li>
          <li id="section-1.5-8.2">Platform attestation provides evidence of configuration of software elements
present in the device.  This form of attestation can be implemented
with TPM Platform Configuration Registers (PCRs) and  Quote and Log mechanisms, which provide cryptographically authenticated evidence
to report what software was started on the device through the boot cycle.  Successful attestation requires an 
unbroken chain from a boot-time Root of Trust through all layers of software needed to bring the device to an 
operational state, in which each stage computes the hash of components of the next stage, then updates the attestation log and 
the TPM.  The TPM can then report the hashes of all the measured hashes as signed evidence called a 
Quote (see <a href="#using-tpm" class="auto internal xref">Appendix A.1</a> for an overview of TPM operation or <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> and <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span> for many more details).<a href="#section-1.5-8.2" class="pilcrow">¶</a>
</li>
          <li id="section-1.5-8.3">Signed Reference Values (aka reference integrity measurements) must be conveyed from the Reference Value Provider (the entity accepted as the software authority,
often the manufacturer of the network device) to the Verifier.<a href="#section-1.5-8.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="solution-requirements">
<section id="section-1.6">
        <h3 id="name-solution-requirements">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-solution-requirements" class="section-name selfRef">Solution Requirements</a>
        </h3>
<p id="section-1.6-1">RIV must address the "Lying Endpoint"
problem, in which malicious software on an endpoint may subvert the
intended function and also prevent the endpoint from reporting its compromised
status.  (See <a href="#security-cons" class="auto internal xref">Section 5</a> for further Security Considerations.)<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<p id="section-1.6-2">RIV attestation is designed to be simple
to deploy at scale. RIV should work "out of the box" as far as possible,
that is, with the fewest possible provisioning steps or configuration databases
needed at the end user's site.  Network equipment is often required to "self-configure",
to reliably reach out without manual intervention to prove its identity and
operating posture, then download its own configuration, a process which precludes pre-installation configuration. See <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span> for an
example of Secure Zero Touch Provisioning (SZTP).<a href="#section-1.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scope">
<section id="section-1.7">
        <h3 id="name-scope">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.7-1">The need for assurance of software integrity, addressed by Remote Attestation, is a very general problem that could apply to most network-connected computing devices.  However, this document includes several assumptions that limit the scope to network equipment (e.g., routers, switches, and firewalls):<a href="#section-1.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-2.1">This solution is for use in non-privacy-preserving applications (for example,
networking or industrial Internet of Things (IoT) applications), which avoids the need for a Privacy Certification
Authority (also called an Attestation CA) for Attestation Keys (AKs) <span>[<a href="#AIK-ENROLL" class="cite xref">AIK-ENROLL</a>]</span> or TCG Platform
Certificates <span>[<a href="#PLATFORM-CERTS" class="cite xref">PLATFORM-CERTS</a>]</span>.<a href="#section-1.7-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.7-2.2">This document assumes network protocols that are common in network equipment such as YANG <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span> and Network Configuration Protocol (NETCONF) <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span>,
but not generally used in other applications.<a href="#section-1.7-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.7-2.3">The approach outlined in this document mandates the use of a TPM <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span> or a compatible cryptoprocessor.<a href="#section-1.7-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="out-of-scope">
<section id="section-1.7.1">
          <h4 id="name-out-of-scope">
<a href="#section-1.7.1" class="section-number selfRef">1.7.1. </a><a href="#name-out-of-scope" class="section-name selfRef">Out of Scope</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-1.7.1-1">
            <dt id="section-1.7.1-1.1">Run-Time Attestation:</dt>
            <dd style="margin-left: 1.5em" id="section-1.7.1-1.2">The Linux Integrity Measurement Architecture <span>[<a href="#IMA" class="cite xref">IMA</a>]</span> attests each process launched
after a device is started (and is in scope for RIV in general), but continuous run-time attestation of Linux or 
other multi-threaded operating system processes after the OS has started considerably expands the scope of the problem.
Many researchers are working on that problem, but this document defers the problem of continuous, in-memory
run-time attestation.<a href="#section-1.7.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-1.7.1-1.3">Multi-Vendor Embedded Systems:</dt>
            <dd style="margin-left: 1.5em" id="section-1.7.1-1.4"> Additional coordination would be needed for
devices that themselves comprise hardware and software from multiple vendors and are
integrated by the end user.  Although out of scope for this document, these
issues are accommodated in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.<a href="#section-1.7.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-1.7.1-1.5">Processor Sleep Modes:</dt>
            <dd style="margin-left: 1.5em" id="section-1.7.1-1.6">Network equipment typically does not "sleep", so
sleep and hibernate modes are not considered.  Although out of scope
for RIV in this document, TCG specifications do encompass sleep and hibernate
states, which could be incorporated into remote attestation for network equipment in the future, given a compelling need.<a href="#section-1.7.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-1.7.1-1.7">Virtualization and Containerization:</dt>
            <dd style="margin-left: 1.5em" id="section-1.7.1-1.8"> In a non-virtualized system, the host OS is
responsible for measuring each user-space file or process throughout the operational lifetime
of the system.  For virtualized systems, the host OS must verify the hypervisor, 
but then the hypervisor must manage its own chain of trust through the virtual machine.  Virtualization 
and containerization technologies are increasingly used in network equipment, but 
are not considered in this document.<a href="#section-1.7.1-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="solution-overview">
<section id="section-2">
      <h2 id="name-solution-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-solution-overview" class="section-name selfRef">Solution Overview</a>
      </h2>
<div id="riv-software-configuration-attestation-using-tpm">
<section id="section-2.1">
        <h3 id="name-riv-software-configuration-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-riv-software-configuration-" class="section-name selfRef">RIV Software Configuration Attestation Using TPM</a>
        </h3>
<p id="section-2.1-1">RIV Attestation is a process that can be used to determine the identity of software running
on a specifically identified device.  The Remote Attestation steps of <a href="#RIV-desc" class="auto internal xref">Section 1.5</a> are split into two
phases as shown in <a href="#RIV-Attestation-Model" class="auto internal xref">Figure 1</a>:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">During system startup, or Boot Phase, each distinct software object is "measured" by the Attester.
The object's identity, hash (i.e., cryptographic digest), and version information are recorded in a log.
Hashes are also extended into the TPM (see <a href="#using-tpm" class="auto internal xref">Appendix A.1</a> for more on extending hashes) in a way that can be used to validate the log entries.  The measurement process generally
follows the layered chain-of-trust model used in Measured Boot, where each stage
of the system measures the next one, and extends its measurement into the TPM,
before launching it.  See <span><a href="https://rfc-editor.org/rfc/rfc9334#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, "Layered Attestation Environments", for an architectural definition
of this model.<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.2">Once the device is running and has operational network connectivity, verification can take place.  A separate
 Verifier, running in its own trusted environment, will interrogate the network
device to retrieve the logs and a copy of the digests collected by hashing
each software object, signed by an attestation private key secured by, but never released by,
the TPM.  The YANG model described in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> facilitates this operation.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-3">The result is that the Verifier can verify the device's identity by checking
the subject <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and signature of the certificate containing the TPM's attestation public key.
The Verifier can then verify the log's correctness by accumulating all the hashes in the log
and comparing that to the signed digests from the TPM.  From
there, the Verifier can validate the launched software by
comparing the digests in the log with Reference Values.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">It should be noted that attestation and identity are inextricably linked;
signed Evidence that a particular version of software was loaded is of little
value without cryptographic proof of the identity of the Attester producing
the Evidence.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<span id="name-layered-riv-attestation-mod"></span><div id="RIV-Attestation-Model">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.1-5.1">
<pre>
    +-------------------------------------------------------+
    | +---------+    +--------+   +--------+    +---------+ |
    | |UEFI BIOS|---&gt;| Loader |--&gt;| Kernel |---&gt;|Userland | |
    | +---------+    +--------+   +--------+    +---------+ |
    |     |            |           |                        |
    |     |            |           |                        |
    |     +------------+-----------+-+                      |
    |                    Boot Phase  |                      |
    |                                V                      |
    |                            +--------+                 |
    |                            |  TPM   |                 |
    |                            +--------+                 |
    |   Router                       |                      |
    +--------------------------------|----------------------+
                                     |
                                     |  Verification Phase
                                     |    +-----------+
                                     +---&gt;| Verifier  |
                                          +-----------+

    Reset---------------flow-of-time-during-boot...---------&gt;
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-layered-riv-attestation-mod" class="selfRef">Layered RIV Attestation Model</a>
          </figcaption></figure>
</div>
<p id="section-2.1-6">In the Boot Phase, measurements are "extended", or hashed, into the TPM as processes start, 
which result in the TPM containing hashes of all the measured hashes. Later, once the system is operational, signed 
digests are retrieved from the TPM during the Verification Phase for off-box analysis.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<div id="what-does-riv-attest">
<section id="section-2.1.1">
          <h4 id="name-what-does-riv-attest">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-what-does-riv-attest" class="section-name selfRef">What Does RIV Attest?</a>
          </h4>
<p id="section-2.1.1-1">TPM attestation is focused on PCRs, but those registers are only vehicles for certifying 
accompanying Evidence conveyed in log entries.  It is the hashes in log entries that are extended into PCRs, where the final PCR values 
can be retrieved in the form of a structure called a Quote, which is signed by an AK known only to the TPM.  The use of multiple PCRs serves only to 
provide some independence between different classes of object so that one class of objects can be updated without changing the 
extended hash for other classes.  Although PCRs can be used for any purpose, this section outlines the objects within the 
scope of this document that may be extended into the TPM.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">In general, assignment of measurements to PCRs is a policy choice made by the device manufacturer, selected to independently attest three classes of object:<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1.1-3">
            <dt id="section-2.1.1-3.1">Code:</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.1-3.2">Instructions to be executed by a CPU.<a href="#section-2.1.1-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.1.1-3.3">Configuration:</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.1-3.4">Many devices offer numerous options controlled by non-volatile configuration variables that can impact the device's security posture.  These settings may have vendor defaults, but often can be changed by administrators, who may want to verify via attestation that the operational state of the settings match their intended state.<a href="#section-2.1.1-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.1.1-3.5">Credentials:</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.1-3.6">Administrators may wish to verify via attestation that public keys and credentials outside the Root of Trust have not been subject to unauthorized tampering.  (By definition, keys protecting the Root of Trust can't be verified independently.)<a href="#section-2.1.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-2.1.1-4">The "TCG PC Client Specific Platform Firmware Profile Specification" <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span> details what is to be 
measured during the Boot Phase of platform startup using a Unified Extensible Firmware Interface (UEFI) BIOS (<span>&lt;<a href="www.uefi.org">www.uefi.org</a>&gt;</span>), but the goal is simply to measure every bit of 
code executed in the process of starting the device, along with any configuration information related to security posture, leaving 
no gap for unmeasured code to remain undetected and potentially subverting the chain.<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1.1-5">For devices using a UEFI BIOS, <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span> and <span>[<a href="#PC-CLIENT-EFI-TPM-1.2" class="cite xref">PC-CLIENT-EFI-TPM-1.2</a>]</span> give detailed normative requirements for PCR usage.  For other 
platform architectures, where TCG normative requirements currently do not exist, <a href="#Attested-Objects" class="auto internal xref">Table 1</a> gives non-normative guidance for PCR assignment that generalizes the specific 
details of <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span>.<a href="#section-2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1.1-6">By convention, most PCRs are assigned in pairs, with the even-numbered PCR used to measure executable code and 
the odd-numbered PCR used to measure whatever data and configuration are associated with that code.  It is important 
to note that each PCR may contain results from dozens (or even thousands) of individual measurements.<a href="#section-2.1.1-6" class="pilcrow">¶</a></p>
<span id="name-attested-objects"></span><div id="Attested-Objects">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-attested-objects" class="selfRef">Attested Objects</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1"></th>
                <th class="text-left" rowspan="" colspan="2"> Assigned PCR #</th>
              </tr>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Function</th>
                <th class="text-left" rowspan="1" colspan="1">Code</th>
                <th class="text-left" rowspan="1" colspan="1">Configuration</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Firmware Static Root of Trust (i.e., initial boot firmware and drivers)</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Drivers and initialization for optional or add-in devices</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">OS loader code and configuration (i.e., the code launched by firmware) to load an  operating system kernel. These PCRs record each boot attempt, and an identifier for where the loader was found</td>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Vendor-specific measurements during boot</td>
                <td class="text-left" rowspan="1" colspan="1">6</td>
                <td class="text-left" rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Secure Boot Policy.  This PCR records keys and configuration used to validate the OS loader</td>
                <td class="text-left" rowspan="1" colspan="1"></td>
                <td class="text-left" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1"> Measurements made by the OS loader (e.g., GRUB2 for Linux)</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-left" rowspan="1" colspan="1">9</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Measurements made by OS (e.g., Linux IMA)</td>
                <td class="text-left" rowspan="1" colspan="1">10</td>
                <td class="text-left" rowspan="1" colspan="1">10</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="notes-on-pcr-allocations">
<section id="section-2.1.2">
          <h4 id="name-notes-on-pcr-allocations">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-notes-on-pcr-allocations" class="section-name selfRef">Notes on PCR Allocations</a>
          </h4>
<p id="section-2.1.2-1">It is important to recognize that PCR[0] is critical.  The first measurement into PCR[0] is taken by the Root of Trust for 
Measurement, which is code that, by definition, cannot be verified by measurement.  This measurement 
establishes the chain of trust for all subsequent measurements.  If the PCR[0] measurement cannot be trusted, the 
validity of the entire chain is called into question.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">Distinctions between PCR[0], PCR[2], PCR[4], and PCR[8] are summarized below:<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1.2-3">
            <dt id="section-2.1.2-3.1">PCR[0]</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.2-3.2">typically represents a consistent view of rarely changed boot components of the host platform, which allows Attestation policies to be defined using the less changeable components of the transitive trust chain. This PCR 
typically provides a consistent view of the platform regardless of user-selected options.<a href="#section-2.1.2-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.1.2-3.3">PCR[2]</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.2-3.4">is intended to represent a "user-configurable" environment where the user has the ability to alter the 
components that are measured into PCR[2]. This is typically done by adding adapter cards, etc., into user-accessible 
Peripheral Component Interconnect (PCI) or other slots.  In UEFI systems, these devices may be configured by Option ROMs measured into PCR[2] and 
executed by the UEFI BIOS.<a href="#section-2.1.2-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.1.2-3.5">PCR[4]</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.2-3.6">is intended to represent the software that manages the transition between the platform's pre-OS 
start and the state of a system with the OS present.  This PCR, along with PCR[5], identifies the initial 
OS loader (e.g., GRUB for Linux).<a href="#section-2.1.2-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.1.2-3.7">PCR[8]</dt>
            <dd style="margin-left: 1.5em" id="section-2.1.2-3.8">is used by the OS loader (e.g., GRUB) to record measurements of the various components of the operating system.<a href="#section-2.1.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-2.1.2-4">Although <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span> specifies the use of the first eight PCRs very carefully to ensure interoperability 
among multiple 
UEFI BIOS vendors, it should be noted that embedded software vendors may have considerably more flexibility.  Verifiers 
typically need to know which log entries are consequential and which are not (possibly controlled by local policies), but 
the Verifier may not need to know what each log entry means or why it was assigned to a particular PCR.   Designers must
recognize that some PCRs may cover log entries that a particular Verifier considers critical and other log entries that
are not considered important, so differing PCR values may not on their own constitute a check for authenticity.  For example, in a UEFI system, some administrators may consider booting an image from a removable drive, something recorded in a PCR, to be a security violation, while others might consider that operation to be an authorized recovery procedure.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-2.1.2-5">Designers may allocate particular events to specific PCRs in order to achieve a particular objective with local 
attestation (e.g., allowing a procedure to execute, or releasing a particular decryption key, only if a given PCR is in a given state).  It may also be important 
to designers to consider whether streaming notification of PCR updates is required (see <span>[<a href="#I-D.ietf-rats-network-device-subscription" class="cite xref">RATS-NET-DEV-SUB</a>]</span>).  Specific 
log entries can only be validated if the Verifier receives every log entry affecting the relevant PCR, so (for example) 
a designer might want to separate rare, high-value events, such as configuration changes, from high-volume, routine 
measurements such as IMA logs <span>[<a href="#IMA" class="cite xref">IMA</a>]</span>.<a href="#section-2.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="riv-keying">
<section id="section-2.2">
        <h3 id="name-riv-keying">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-riv-keying" class="section-name selfRef">RIV Keying</a>
        </h3>
<p id="section-2.2-1">RIV attestation relies on two credentials:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">An identity key pair and matching certificate is required to certify the identity of the Attester itself.
RIV specifies the use of an IEEE 802.1AR DevID <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span> that is
signed by the device manufacturer and contains the device serial number.  This requirement goes slightly
beyond 802.1AR; see <a href="#riv-simplify" class="auto internal xref">Section 2.4</a> for notes.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-2.2">An Attestation key pair and matching certificate is required to sign the Quote generated by the TPM to report evidence
of software configuration.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-3">In a TPM application, both the Attestation private key and the DevID private key <span class="bcp14">MUST</span> be protected by the TPM.
Depending on other TPM configuration procedures,
the two keys are likely to be different; some of the considerations are outlined in the
"TPM 2.0 Keys for Device Identity and Attestation" document <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The "TPM 2.0 Keys for Device Identity and Attestation" document <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> specifies further conventions for these keys:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-5.1">When separate Identity and Attestation keys are used, the 
AK and its X.509 certificate should parallel the DevID, with the same unique
device identification as the DevID certificate (that is, the same subject and subjectAltName (if present), even though the key pairs are different).  By examining the corresponding AK certificate, the Verifier 
can directly link a device's quote, which was signed by an 
AK, to the device that provided it.  If the
subject in the AK certificate doesn't match the corresponding DevID certificate, or 
if they're  signed by different authorities, the Verifier may signal the detection of an Asokan-style person-in-the-middle attack (see <a href="#pitm" class="auto internal xref">Section 5.2</a>).<a href="#section-2.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-5.2">Network devices that are expected to use SZTP as
specified in <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>
            <span class="bcp14">MUST</span> be shipped by the manufacturer with pre-provisioned keys (Initial DevID and Initial AK,
called IDevID and IAK, respectively).  IDevID and IAK certificates <span class="bcp14">MUST</span> both be signed by the Endorser 
(typically the device manufacturer).  Inclusion of an IDevID and IAK by a vendor does not
preclude a mechanism whereby an administrator can define LDevID and
Local Attestation Keys (LAK) if desired.<a href="#section-2.2-5.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="RIV-flow">
<section id="section-2.3">
        <h3 id="name-riv-information-flow">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-riv-information-flow" class="section-name selfRef">RIV Information Flow</a>
        </h3>
<p id="section-2.3-1">RIV workflow for network equipment is organized around a simple use case
where a network operator wishes to verify the integrity of software installed
in specific, fielded devices.  A normative taxonomy of terms is given in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, 
but as a reminder, this use case implies several roles and objects:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-2">
          <dt id="section-2.3-2.1">Attester:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.2">The device that the network operator wants to examine.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">Verifier:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.4">Which might be a Network Management Station and is somewhat separate
  from the Device that will retrieve the signed evidence and measurement logs, and analyze them to pass
  judgment on the security posture of the device.<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.5">Relying Party:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.6">Can act on Attestation Results.  Interaction between the Relying Party and the
  Verifier is considered out of scope for RIV.<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.7">Signed Reference Integrity Manifests (RIMs):</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.8">Contains Reference Values. RIMs can
  either be created by the device manufacturer
  and shipped along with the device as part of its software image, or alternatively,
  could be obtained several other ways (direct to the Verifier from the
  manufacturer, from a third party, from the owner's concept 
  of a "known good system", etc.).  Retrieving RIMs from the device
  itself allows attestation to be done in systems that may not have access
  to the public Internet, or by other devices that are not management stations
  per se (e.g., a peer device; see <a href="#RIM-policy" class="auto internal xref">Section 3.1.3</a>).  If Reference Values are obtained from
  multiple sources, the Verifier may need to evaluate the relative level of
  trust to be placed in each source in case of a discrepancy.<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.3-3">These components are illustrated in <a href="#RIV-Reference-Configuration" class="auto internal xref">Figure 2</a>.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<span id="name-riv-reference-configuration"></span><div id="RIV-Reference-Configuration">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.3-4.1">
<pre>
+----------------+        +-------------+        +---------+--------+
|Reference Value |        | Attester    | Step 1 | Verifier|        |
|Provider        |        | (Device     |&lt;-------| (Network| Relying|
|(Device         |        | under       |-------&gt;| Mgmt    | Party  |
|Manufacturer    |        | attestation)| Step 2 | Station)|        |
|or other        |        |             |        |         |        |
|authority)      |        |             |        |         |        |
+----------------+        +-------------+        +---------+--------+
       |                                             /\
       |                  Step 0                      |
       -----------------------------------------------
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-riv-reference-configuration" class="selfRef">RIV Reference Configuration for Network Equipment</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="olPercent" id="section-2.3-5">
          <dt>Step 0:</dt>
<dd style="margin-left: 4.5em" id="section-2.3-5.1">The Reference Value Provider (the device manufacturer or other authority) makes 
one or more RIMs, which correspond to the software image expected to be found on the device and are signed by the Reference Value Provider, available to the Verifier.
(See <a href="#RIM-policy" class="auto internal xref">Section 3.1.3</a> for "in-band" and "out of band" ways to make this happen.)<a href="#section-2.3-5.1" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 1:</dt>
<dd style="margin-left: 4.5em" id="section-2.3-5.2">On behalf of a Relying Party, the Verifier (Network Management Station) requests DevID,
Measurement Values, and possibly RIMs from the Attester.<a href="#section-2.3-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd style="margin-left: 4.5em" id="section-2.3-5.3">The
Attester responds to the request by providing a DevID, quotes (measured values that are signed by the Attester),
and optionally RIMs.<a href="#section-2.3-5.3" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.3-6">The use of the following standards components allows for interoperability:<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-7">
<li id="section-2.3-7.1">TPM keys <span class="bcp14">MUST</span> be configured according to <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> or <span>[<a href="#PLATFORM-ID-TPM-1.2" class="cite xref">PLATFORM-ID-TPM-1.2</a>]</span>.<a href="#section-2.3-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.2">For devices using UEFI and Linux, measurements of firmware and bootable modules <span class="bcp14">MUST</span> be taken according to "TCG EFI Platform Specification" <span>[<a href="#PC-CLIENT-EFI-TPM-1.2" class="cite xref">PC-CLIENT-EFI-TPM-1.2</a>]</span> or "TCG PC Client Specific Platform Firmware Profile Specification" <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span>, and Linux IMA <span>[<a href="#IMA" class="cite xref">IMA</a>]</span>.<a href="#section-2.3-7.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.3">DevID <span class="bcp14">MUST</span> be managed as DevID certificates as specified in IEEE Std 802.1AR <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span>, with keys protected by TPMs.<a href="#section-2.3-7.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.4">Attestation logs from Linux-based systems <span class="bcp14">MUST</span> be formatted according to the "Canonical Event Log Format" <span>[<a href="#CEL" class="cite xref">CEL</a>]</span>.  UEFI-based systems <span class="bcp14">MUST</span> use the TCG UEFI BIOS event log <span>[<a href="#PC-CLIENT-EFI-TPM-1.2" class="cite xref">PC-CLIENT-EFI-TPM-1.2</a>]</span> for TPM 1.2 systems and the "TCG PC Client Specific Platform Firmware Profile" <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span> for TPM 2.0 systems.<a href="#section-2.3-7.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.5">Quotes <span class="bcp14">MUST</span> be retrieved from the TPM according to the TCG Trusted Attestation Protocol Information Model (TAP IM) <span>[<a href="#TAP" class="cite xref">TAP</a>]</span> and the Challenge-Response-based Remote Attestation (CHARRA) YANG model <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  While the TAP IM gives a protocol-independent description of the data elements involved, it's important to note that quotes from the TPM are signed inside the TPM and <span class="bcp14">MUST</span> be retrieved in a way that does not invalidate the signature, to preserve the trust model.  The CHARRA YANG model <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> is used for this purpose.  (See <a href="#security-cons" class="auto internal xref">Section 5</a>, Security Considerations).<a href="#section-2.3-7.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-7.6">Reference Values <span class="bcp14">MUST</span> be encoded as defined in
  the TCG RIM document <span>[<a href="#RIM" class="cite xref">RIM</a>]</span>, typically using Software Identification (SWID) tags <span>[<a href="#SWID" class="cite xref">SWID</a>]</span> <span>[<a href="#NIST-IR-8060" class="cite xref">NIST-IR-8060</a>]</span> or Concise SWID (CoSWID) tags <span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>.<a href="#section-2.3-7.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="riv-simplify">
<section id="section-2.4">
        <h3 id="name-riv-simplifying-assumptions">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-riv-simplifying-assumptions" class="section-name selfRef">RIV Simplifying Assumptions</a>
        </h3>
<p id="section-2.4-1">This document makes the following simplifying assumptions to reduce complexity:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-2.1">The product to be attested <span class="bcp14">MUST</span> be shipped by the equipment vendor with both a DevID as specified by IEEE Std 802.1AR and an IAK, with certificates in place.  The IAK certificate must contain the same identity
information as the DevID (specifically, the same subject and subjectAltName (if used), signed by the manufacturer).  The IAK is a type of key that can be
used to sign a TPM Quote, but not other objects (i.e., it's marked as a TCG "Restricted" key; 
this convention is described in 
"TPM 2.0 Keys for Device Identity and Attestation" <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span>). For network equipment, which is generally not privacy sensitive, shipping
a device with both an IDevID and an IAK already provisioned substantially
simplifies initial startup.<a href="#section-2.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">IEEE Std 802.1AR does not require a product serial number as part of the subject, but RIV-compliant
devices <span class="bcp14">MUST</span> include their serial numbers in the DevID/IAK certificates to simplify tracking logistics 
for network equipment users.  All other optional
802.1AR fields remain optional in RIV.<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.4-2.2.2">
It should be noted that the use of X.509 certificate fields as specified by IEEE Std 802.1AR 
is not identical to that described in <span>[<a href="#RFC9525" class="cite xref">RFC9525</a>]</span> for representation of application service identity.<a href="#section-2.4-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.3">The product <span class="bcp14">MUST</span> be equipped with an RTM, a Root of Trust
for Storage, and a Root of Trust for Reporting (as defined in <span>[<a href="#SP800-155" class="cite xref">SP800-155</a>]</span>), which together are
capable of conforming to the TCG TAP IM <span>[<a href="#TAP" class="cite xref">TAP</a>]</span>.<a href="#section-2.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-2.4">The authorized software supplier <span class="bcp14">MUST</span> make available Reference Values
in the form of signed SWID or CoSWID tags.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="RIM-section">
<section id="section-2.4.1">
          <h4 id="name-reference-integrity-manifes">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-reference-integrity-manifes" class="section-name selfRef">Reference Integrity Manifests (RIMs)</a>
          </h4>
<p id="section-2.4.1-1"><span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> focuses on collecting and transmitting evidence in
the form of PCR measurements and attestation logs.  But the critical part
of the process is enabling the Verifier to decide whether the measurements
are "the right ones" or not.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1-2">While it must be up to network administrators to decide what they want on
their networks, the software supplier should supply the Reference Values, in 
signed RIMs, that
may be used by a Verifier to determine if evidence shows known good, known
bad, or unknown software configurations.<a href="#section-2.4.1-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1-3">In general, there are two kinds of reference measurements:<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4.1-4">
<li id="section-2.4.1-4.1">Measurements of early system startup (e.g., BIOS, boot loader, OS kernel)
are essentially single threaded and executed exactly once, in a known sequence,
before any results can be reported.  In this case, while the method for
computing the hash and extending relevant PCRs may be complicated, the net
result is that the software (more likely, firmware) vendor will have one
known good PCR value that "should" be present in the relevant PCRs after the box has
booted.  In this case, the signed reference measurement could simply list the
expected hashes for the given version.  However, a RIM that contains the
intermediate hashes can be useful in debugging cases where the expected final hash
is not the one reported.<a href="#section-2.4.1-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.4.1-4.2">Measurements taken later in operation of the system, once an OS has started
(for example, Linux IMA <span>[<a href="#IMA" class="cite xref">IMA</a>]</span>), may be more complex, with unpredictable "final"
PCR values.  In this case, the Verifier must have enough information to reconstruct
the expected PCR values from logs and signed reference measurements from
a trusted authority.<a href="#section-2.4.1-4.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-2.4.1-5">In both cases, the expected values can be expressed as signed SWID or CoSWID tags,
but the SWID structure in the second case is somewhat more complex, as reconstruction of the extended hash in a PCR may involve thousands of files and other objects.<a href="#section-2.4.1-5" class="pilcrow">¶</a></p>
<p id="section-2.4.1-6">TCG has published an information model defining elements of RIMs
under the title "TCG Reference Integrity Manifest (RIM) Information Model" <span>[<a href="#RIM" class="cite xref">RIM</a>]</span>.  This information model outlines how SWID tags should be structured to allow attestation, and it defines "bundles" of SWID tags that may be needed to describe a complete software release.  The RIM contains metadata relating to the software release it belongs to, plus hashes for each individual file or other object that could be attested.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">Many network equipment vendors use a UEFI BIOS to launch their network operating system.  These vendors may want to 
also use the "TCG PC Client Reference Integrity Manifest Specification" <span>[<a href="#PC-CLIENT-RIM" class="cite xref">PC-CLIENT-RIM</a>]</span>, which focuses specifically on a SWID-compatible format suitable for expressing measurement values expected from a UEFI BIOS.<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-logs">
<section id="section-2.4.2">
          <h4 id="name-attestation-logs">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-attestation-logs" class="section-name selfRef">Attestation Logs</a>
          </h4>
<p id="section-2.4.2-1">Quotes from a TPM can provide evidence of the state of a device up to the time
the evidence was recorded. However, to make sense of the quote in cases where several events are extended into one PCR, an
event log that identifies which software modules contributed which values to the quote
during startup must also be provided.  When required, the log <span class="bcp14">MUST</span> contain enough information
to demonstrate its integrity by allowing exact reconstruction of the digest
conveyed in the signed quote (that is, calculating the hash of all the hashes in the
log should produce the same values as contained in the PCRs; if they don't match, the log
may have been tampered with.  See <a href="#using-tpm" class="auto internal xref">Appendix A.1</a>).<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.4.2-2">There are multiple event log formats that may be supported as viable formats of Evidence between the Attester and Verifier;
however, to simplify interoperability, RIV focuses on just three:<a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4.2-3">
            <li id="section-2.4.2-3.1">TCG UEFI BIOS event log for TPM 2.0 ("TCG PC Client Specific Platform Firmware Profile Specification") <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span><a href="#section-2.4.2-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-2.4.2-3.2">TCG UEFI BIOS event log for TPM 1.2 ("TCG EFI Platform Specification" for TPM Family 1.1 or
1.2, Section 7) <span>[<a href="#PC-CLIENT-EFI-TPM-1.2" class="cite xref">PC-CLIENT-EFI-TPM-1.2</a>]</span><a href="#section-2.4.2-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-2.4.2-3.3">TCG "Canonical Event Log Format" <span>[<a href="#CEL" class="cite xref">CEL</a>]</span><a href="#section-2.4.2-3.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="standards-components">
<section id="section-3">
      <h2 id="name-standards-components">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-standards-components" class="section-name selfRef">Standards Components</a>
      </h2>
<div id="prerequisites-for-riv">
<section id="section-3.1">
        <h3 id="name-prerequisites-for-riv">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-prerequisites-for-riv" class="section-name selfRef">Prerequisites for RIV</a>
        </h3>
<p id="section-3.1-1">The Reference Interaction Model for Challenge-Response-based Remote Attestation (<span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">RATS-INTERACTION-MODELS</a>]</span>)
is based on the standard roles defined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.  However, additional prerequisites have been established to allow for interoperable implementations of RIV use cases.  These prerequisites are intended to provide sufficient context information so that the Verifier can acquire and evaluate measurements collected by the Attester.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="unique-device-identity">
<section id="section-3.1.1">
          <h4 id="name-unique-device-identity">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-unique-device-identity" class="section-name selfRef">Unique Device Identity</a>
          </h4>
<p id="section-3.1.1-1">A DevID in the form of a DevID certificate as specified by IEEE Std 802.1AR <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span> must be provisioned in the Attester's TPMs.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keys">
<section id="section-3.1.2">
          <h4 id="name-keys">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-keys" class="section-name selfRef">Keys</a>
          </h4>
<p id="section-3.1.2-1">The AK and certificate must also be provisioned on the Attester according to <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> or <span>[<a href="#PLATFORM-ID-TPM-1.2" class="cite xref">PLATFORM-ID-TPM-1.2</a>]</span>.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">It <span class="bcp14">MUST</span> be possible for the Verifier to determine that the Attester's AKs are resident in the same TPM as its DevID keys (see <a href="#riv-keying" class="auto internal xref">Section 2.2</a> and <a href="#security-cons" class="auto internal xref">Section 5</a>, Security Considerations).<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RIM-policy">
<section id="section-3.1.3">
          <h4 id="name-appraisal-policy-for-eviden">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-appraisal-policy-for-eviden" class="section-name selfRef">Appraisal Policy for Evidence</a>
          </h4>
<p id="section-3.1.3-1">As noted in <a href="#RIV-flow" class="auto internal xref">Section 2.3</a>, the Verifier may obtain Reference Values from several sources.  In addition, administrators may make authorized, site-specific changes (e.g., keys in key databases) that could impact attestation results.  As such, there could be conflicts, omissions, or ambiguities between some Reference Values and collected Evidence.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">The Verifier <span class="bcp14">MUST</span> have an Appraisal Policy for Evidence to evaluate the significance of any discrepancies between different reference sources, or between Reference Values and evidence from logs and quotes.
While there must be an Appraisal Policy, this document does not specify the format or mechanism to convey the intended policy, nor does RIV specify mechanisms by which the results of applying the policy are communicated to the Relying Party.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="reference-model-for-challenge-response">
<section id="section-3.2">
        <h3 id="name-reference-model-for-challen">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-reference-model-for-challen" class="section-name selfRef">Reference Model for Challenge-Response</a>
        </h3>
<p id="section-3.2-1">Once the prerequisites for RIV are met, a Verifier is able to acquire Evidence from an Attester.  <a href="#IETF-Attestation-Information-Flow" class="auto internal xref">Figure 3</a> illustrates a RIV information flow between a Verifier and an Attester, 
derived from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-11#section-7.1" class="relref">Section 7.1</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">RATS-INTERACTION-MODELS</a>]</span>.  In this diagram, each event with its
input and output parameters is shown as "Event(input-params)=&gt;(outputs)".
The event times shown correspond to the time types described within <span><a href="https://rfc-editor.org/rfc/rfc9334#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-ietf-attestation-informatio"></span><div id="IETF-Attestation-Information-Flow">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.2-2.1">
<pre>
.----------.                               .-----------------------.
| Attester |                              | Relying Party/Verifier |
'----------'                              '------------------------'
  time(VG)                                                      |
generateClaims(attestingEnvironment)                            |
   | =&gt; claims, eventLogs                                       |
   |                                                            |
   |                                                        time(NS)
   | &lt;-- requestAttestation(handle, authSecIDs, claimSelection) |
   |                                                            |
 time(EG)                                                       |
collectClaims(claims, claimSelection)                           |
   | =&gt; collectedClaims                                         |
   |                                                            |
generateEvidence(handle, authSecIDs, collectedClaims)           |
   | =&gt; evidence                                                |
   |                                                    time(RG,RA)
   | evidence, eventLogs -------------------------------------&gt; |
   |                                                            |
   |               appraiseEvidence(evidence, eventLogs, refValues)
   |                                       attestationResult &lt;= |
   |                                                            |
   ~                                                            ~
   |                                                       time(RX)
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-ietf-attestation-informatio" class="selfRef">IETF Attestation Information Flow</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2-3">
          <dt id="section-3.2-3.1">Step 1 (time(VG)):</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.2">One or more attesting network device PCRs are extended with measurements.  RIV provides no direct link between 
the time at which the event takes place and the time that it's attested, although streaming attestation as described in <span>[<a href="#I-D.ietf-rats-network-device-subscription" class="cite xref">RATS-NET-DEV-SUB</a>]</span> could.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.3">Step 2 (time(NS)):</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.4">The Verifier generates a unique random nonce ("number used once") and makes a request for one or more PCRs from an Attester.  For interoperability, this must be accomplished as specified in "A YANG Data Model for Challenge-Response-Based Remote Attestation (CHARRA) Procedures Using Trusted Platform Modules (TPMs)" <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  Both TPM 1.2 and TPM 2.0 allow nonces as large as the operative digest size (i.e., 20 or 32 bytes; see <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> Part 2, Section 5.5, and <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span> Part 2, Section 10.4.4).<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.5">Step 3 (time(EG)):</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.6">On the Attester, measured values are retrieved from the Attester's TPM. This requested PCR evidence
along with the Verifier's nonce is called a Quote and is signed by the AK associated with the DevID.  Quotes are retrieved according to the CHARRA YANG model <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  At the same time, the Attester collects log evidence showing the values have been extended into that PCR.  <a href="#using-tpm" class="auto internal xref">Appendix A.1</a> gives more detail on how this works and includes references to the structure and contents of quotes in TPM documents.<a href="#section-3.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.7">Step 4:</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.8">The collected Evidence is passed from the Attester to the Verifier.<a href="#section-3.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.9">Step 5 (time(RG,RA)):</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.10">
            <p id="section-3.2-3.10.1">The Verifier reviews the Evidence and takes action as needed.  As the interaction between Relying Party and Verifier is out of scope for RIV, this can be described as one step.<a href="#section-3.2-3.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.10.2.1">If the signature covering TPM Evidence is not correct, the device <span class="bcp14">SHOULD NOT</span> be trusted.<a href="#section-3.2-3.10.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-3.10.2.2">If the nonce in the response doesn't match the Verifier's nonce, the response may be a replay, and the device <span class="bcp14">SHOULD NOT</span> be trusted.<a href="#section-3.2-3.10.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-3.10.2.3">If the signed PCR values do not match the set of log entries that have extended a particular PCR, the device <span class="bcp14">SHOULD NOT</span> be trusted.<a href="#section-3.2-3.10.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-3.10.2.4">If the log entries that the Verifier considers important do not match known good values, the device <span class="bcp14">SHOULD NOT</span> be trusted.  We note that the process of collecting and analyzing the log can be omitted if the value in the relevant PCR is already a known-good value.<a href="#section-3.2-3.10.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-3.10.2.5">If the set of log entries are not seen as acceptable by the Appraisal Policy for Evidence, the device <span class="bcp14">SHOULD NOT</span> be trusted.<a href="#section-3.2-3.10.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-3.10.2.6">If time(RG)-time(NS) is greater than the Appraisal Policy for Evidence's threshold for assessing freshness, the Evidence is considered stale and <span class="bcp14">SHOULD NOT</span> be trusted.<a href="#section-3.2-3.10.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</dd>
        <dd class="break"></dd>
</dl>
<div id="transport-and-encoding">
<section id="section-3.2.1">
          <h4 id="name-transport-and-encoding">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-transport-and-encoding" class="section-name selfRef">Transport and Encoding</a>
          </h4>
<p id="section-3.2.1-1">Network Management systems may retrieve signed PCR-based Evidence using NETCONF or RESTCONF with <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.
In either case, implementations must do so using a secure tunnel.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">Log Evidence <span class="bcp14">MUST</span> be retrieved via log interfaces specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="peer-to-peer">
<section id="section-3.3">
        <h3 id="name-centralized-vs-peer-to-peer">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-centralized-vs-peer-to-peer" class="section-name selfRef">Centralized vs. Peer-to-Peer</a>
        </h3>
<p id="section-3.3-1"><a href="#IETF-Attestation-Information-Flow" class="auto internal xref">Figure 3</a> assumes that the Verifier is trusted, while the Attester is not.  In a peer-to-peer application such as two routers negotiating a trust relationship, the two peers can each ask the other to prove software integrity.  In this application, the information flow is the same, but each side plays a role both as an Attester and a Verifier.  Each device issues a challenge, and each device responds to the other's challenge, as shown in <a href="#Peer-to-peer-Information-Flow" class="auto internal xref">Figure 4</a>.  Peer-to-peer challenges, particularly if used to establish a trust relationship between routers, require devices to carry their own signed reference measurements (RIMs).  Devices may also have to carry an appraisal policy for evidence for each possible peer device so that each device has everything needed for remote attestation, without having to resort to a central authority.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-peer-to-peer-attestation-in"></span><div id="Peer-to-peer-Information-Flow">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.3-2.1">
<pre>
+---------------+                            +---------------+
| RefVal        |                            | RefVal        |
| Provider A    |                            | Provider B    |
| Firmware      |                            | Firmware      |
| Configuration |                            | Configuration |
| Authority     |                            | Authority     |
|               |                            |               |
+---------------+                            +---------------+
      |                                             |
      |                                             |Step 0B
      |       +------------+        +------------+  |
      |       |            | Step 1 |            |  |   \
      |       | Attester   |&lt;------&gt;| Verifier   |  |   |
      |       |            |&lt;------&gt;|            |  |   |  Router B
      +------&gt;|            | Step 2 |            |  |   |- Challenges
       Step 0A|            |        |            |  |   |  Router A
              |            |-------&gt;|            |  |   |
              |- Router A -| Step 3 |- Router B -|  |   /
              |            |        |            |  |
              |            |        |            |  |
              |            | Step 1 |            |  |   \
              | Verifier   |&lt;------&gt;| Attester   |&lt;-+   |  Router A
              |            |&lt;------&gt;|            |      |- Challenges
              |            | Step 2 |            |      |  Router B
              |            |        |            |      |
              |            |&lt;-------|            |      |
              +------------+ Step 3 +------------+      /
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-peer-to-peer-attestation-in" class="selfRef">Peer-to-Peer Attestation Information Flow</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">In this application, each device may need to be equipped with signed RIMs to act as an Attester, and to allow each device to act as a Verifier, each may need to be equipped with an Appraisal Policy for Evidence and a selection of trusted X.509 root certificates also.   An existing link layer protocol such as 802.1X <span>[<a href="#IEEE-802.1X" class="cite xref">IEEE-802.1X</a>]</span> or 802.1AE <span>[<a href="#IEEE-802.1AE" class="cite xref">IEEE-802.1AE</a>]</span>, with Evidence being enclosed over a variant of the Extensible Authentication Protocol (EAP) <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> or Link Layer Discovery Protocol (LLDP) <span>[<a href="#LLDP" class="cite xref">LLDP</a>]</span>, are suitable methods for such an exchange.
Details of peer-to-peer operation are out of scope for this document.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-4">
      <h2 id="name-privacy-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-4-1">Network equipment, such as routers, switches, and firewalls, has a key role to play in guarding the privacy of individuals using the network.  Network equipment generally adheres to several rules to protect privacy:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">Packets passing through the device must not be sent to unauthorized destinations.  For example:<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1.2.1">Routers often act as Policy Enforcement Points, where individual subscribers may be checked for
authorization to access a network.  Subscriber login information must not be released to unauthorized parties.<a href="#section-4-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-2.1.2.2">Network equipment is often called upon to block access to protected resources from unauthorized users.<a href="#section-4-2.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-2.2">Routing information, such as the identity of a router's peers, must not be leaked to unauthorized neighbors.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">If configured, encryption and decryption of traffic must be carried out reliably, while protecting keys and credentials.<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">Functions that protect privacy are implemented as part of each layer of hardware and software that
makes up the networking device.
In light of these requirements for protecting the privacy of users of the network, the network equipment
must identify itself, and its boot configuration and measured device state (for example, PCR values),
to the equipment's administrator so there's no uncertainty about the device's function and
configuration. Attestation is a component that allows the administrator to ensure that the network
provides individual and peer privacy guarantees, even though the device itself may not have a 
right to keep its identity secret.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">See <span>[<a href="#NET-EQ" class="cite xref">NET-EQ</a>]</span> for more context on privacy in networking devices.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">While attestation information from network devices is not likely to contain privacy-sensitive content regarding 
network users, administrators may want to keep attestation records confidential to avoid disclosing versions of 
software loaded on the device, which is information that could facilitate attacks against known vulnerabilities.<a href="#section-4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-cons">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">Specifications such as TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> and YANG <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span> contain considerable advice on keeping
network-connected systems secure.  This section outlines specific risks and mitigations related to attestation.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Attestation Evidence obtained by the RIV procedure is subject to a number of attacks:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">Keys may be compromised.<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.2">A counterfeit device may attempt to impersonate (spoof) a known authentic device.<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.3">Person-in-the-middle attacks may be used by a compromised device to attempt to deliver
responses that originate in an authentic device.<a href="#section-5-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-3.4">Replay attacks may be attempted by a compromised device.<a href="#section-5-3.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="keys-used-in-riv">
<section id="section-5.1">
        <h3 id="name-keys-used-in-riv">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-keys-used-in-riv" class="section-name selfRef">Keys Used in RIV</a>
        </h3>
<p id="section-5.1-1">Trustworthiness of RIV attestation depends strongly on the validity of keys used for identity
and attestation reports.  RIV takes full advantage of TPM capabilities to ensure that evidence can be trusted.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Two sets of key pairs are relevant to RIV attestation:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-3.1">A DevID key pair is used to certify the identity of the device in which the TPM is installed.<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-3.2">An AK key pair is used to certify attestation Evidence (i.e., quotes) and 
to provide evidence for integrity of the device software.<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-4">TPM practices usually require that these keys be different to ensure that a general-purpose
signing key cannot be used to spoof an attestation quote.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">In each case, the private half of the key is known only to the TPM and cannot be
retrieved externally, even by a trusted party.  To ensure that's the case,
specification-compliant private/public key pairs are generated inside the TPM, where they are never
exposed and cannot be extracted (see <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span>).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Keeping keys safe is a critical enabler of trustworthiness, but it's just part of attestation security; knowing which keys are bound
to the device in question is just as important in an environment where private keys are never exposed.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">While there are many ways to manage keys in a TPM (see <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span>), RIV includes
support for "zero touch" provisioning (also known as zero touch onboarding) of fielded
devices (e.g., SZTP <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>), where keys that have predictable trust properties are
provisioned by the device vendor.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">Device identity in RIV is based on DevID defined by IEEE Std 802.1AR. This specification provides several elements:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.1">A DevID requires a unique key pair for each device, accompanied by an X.509 certificate.<a href="#section-5.1-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-9.2">The private portion of the DevID key is to be stored in the device, in a manner that provides confidentiality (Section 6.2.5 of <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span>).<a href="#section-5.1-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-10">The X.509 certificate contains several components:<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.1">The public part of the unique DevID key assigned to that device allows a challenge of identity.<a href="#section-5.1-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-11.2">An identifying string that's unique to the manufacturer of the device.  This is normally the
serial number of the unit, which might also be printed on a label on the device.<a href="#section-5.1-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-11.3">The certificate must be signed by a key traceable to the manufacturer's root key.<a href="#section-5.1-11.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-12">With these elements, the device's manufacturer and serial number can be identified by analyzing the
DevID certificate plus the chain of intermediate certificates leading back to the manufacturer's root
certificate.  As is conventional in TLS or SSH connections, a random nonce must be signed by the device
in response to a challenge,
proving possession of its DevID private key.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">RIV uses the DevID to validate a TLS or SSH connection to the device as the attestation session begins.  Security of
this process derives from TLS or SSH security, with the DevID, which contains a device serial number, providing proof that the session terminates on
the intended device. See <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> <span>[<a href="#RFC4253" class="cite xref">RFC4253</a>]</span>.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1-14">Evidence of software integrity is delivered in the form of a quote that is signed by the TPM
itself and accompanied by an IAK certificate containing the same identity information as the DevID.  Because the contents of the quote are signed inside the TPM, any external
modification (including reformatting to a different data format) after measurements have been taken will be detected
as tampering.  An unbroken chain of trust is essential for ensuring that blocks of code that are taking
measurements have been verified before execution (see <a href="#RIV-Attestation-Model" class="auto internal xref">Figure 1</a>).<a href="#section-5.1-14" class="pilcrow">¶</a></p>
<p id="section-5.1-15">Requiring measurements of the operating software to be signed by a key known only to the TPM also
removes the need to trust the device's operating software (beyond the first measurement in the RTM; see below). 
If malicious software makes any changes to a quote
in the device itself, or in the path back to the Verifier, the signature on the quote will
be invalidated.<a href="#section-5.1-15" class="pilcrow">¶</a></p>
<p id="section-5.1-16">A critical feature of the YANG model described in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> is the ability to carry TPM data structures in their TCG-defined format, without requiring any changes to the structures as they were signed and delivered by the TPM.  While alternate methods of conveying TPM quotes could reduce redundant information, or add another layer of signing using external keys, the implementation <span class="bcp14">MUST</span> preserve the TPM signing so that tampering anywhere in the path between the TPM itself and the Verifier can be detected.<a href="#section-5.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pitm">
<section id="section-5.2">
        <h3 id="name-prevention-of-spoofing-and-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-prevention-of-spoofing-and-" class="section-name selfRef">Prevention of Spoofing and Person-in-the-Middle Attacks</a>
        </h3>
<p id="section-5.2-1">Prevention of spoofing attacks against attestation systems is also important.  There are several cases to consider:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">The entire device could be spoofed. If the Verifier goes to appraise a specific Attester, it might be redirected to a different Attester.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.2">A compromised device could have a valid DevID, but substitute a quote from a known-good device instead of returning its own, as described in <span>[<a href="#RFC6813" class="cite xref">RFC6813</a>]</span>.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-2.3">A device with a compromised OS could return a fabricated quote providing spoofed attestation Evidence.<a href="#section-5.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-3">Use of the 802.1AR DevID in the TPM provides protection against the case of a spoofed device by ensuring that the Verifier's TLS or SSH session is in fact terminating on the right device.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Protection against spoofed quotes from a device with valid identity is a bit more complex.
An identity key must be available to sign any kind of nonce or hash offered by the Verifier,
and consequently, could be used to sign a fabricated quote.  To block a spoofed Attestation
Result, the quote generated inside the TPM must be signed by
a key, known as an AK, that's different from the DevID.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">Given separate Attestation and DevID keys, the
binding between the AK and the same device must also be proven to
prevent a person-in-the-middle attack (e.g., the "Asokan Attack" <span>[<a href="#RFC6813" class="cite xref">RFC6813</a>]</span>).<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">This is accomplished in RIV through use of an AK certificate with the same elements as the DevID
(same manufacturer's serial number and signed by the same manufacturer's key), but containing
the device's unique AK public key instead of the DevID public key.
This binding between DevID and AK certificates is critical to reliable attestation.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">The TCG document "TPM 2.0 Keys for Device Identity and Attestation" <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> specifies
OIDs for Attestation Certificates that allow the CA to mark a key as specifically known to be 
an AK.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">These two key pairs and certificates are used together:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-9.1">The DevID is used to validate a TLS connection terminating on the device with a known serial number.<a href="#section-5.2-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-9.2">The AK is used to sign attestation quotes, which provides proof that the attestation
evidence comes from the same device.<a href="#section-5.2-9.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="replay-attacks">
<section id="section-5.3">
        <h3 id="name-replay-attacks">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-replay-attacks" class="section-name selfRef">Replay Attacks</a>
        </h3>
<p id="section-5.3-1">Replay attacks, where the results of a previous attestation are submitted in response to subsequent requests,
are usually prevented by the inclusion of a random nonce in the request to the TPM
for a quote.  Each request from the Verifier includes a new random number (a nonce). The resulting
quote signed by the TPM contains the same nonce, which allows the Verifier to determine
freshness (i.e., that the resulting quote was generated in response to the Verifier's specific request).
"Time-Based Uni-Directional Attestation" <span>[<a href="#I-D.birkholz-rats-tuda" class="cite xref">RATS-TUDA</a>]</span> provides an alternate mechanism
to verify freshness without requiring a request/response cycle.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="owner-signed-keys">
<section id="section-5.4">
        <h3 id="name-owner-signed-keys">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-owner-signed-keys" class="section-name selfRef">Owner-Signed Keys</a>
        </h3>
<p id="section-5.4-1">Although device manufacturers must pre-provision devices with easily verified DevID and AK certificates
if SZTP such as described in <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span> is to be supported,
use of those credentials is not mandatory.  IEEE Std 802.1AR incorporates the idea of an 
IDevID, which is provisioned by the manufacturer, and a LDevID, which is provisioned by the owner of
the device.  RIV and <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> extend that concept by defining an IAK and 
LAK with the same properties.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Device owners can use any method to provision the local credentials.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.1">The TCG document <span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span> shows how the IAKs
can be used to certify LDevID and LAK keys.  The use of the LDevID and LAK allows the device owner
to use a uniform identity structure across device types from multiple manufacturers (in the same way
that an "Asset Tag" is used by many enterprises to identify devices they own).  The TCG document
<span>[<a href="#PROV-TPM-2.0" class="cite xref">PROV-TPM-2.0</a>]</span> also contains guidance on provisioning local identity keys in TPM 2.0.
Owners should follow the same practice of binding LDevID and LAK as the manufacturer would for IDevID and IAK.
See <a href="#riv-keying" class="auto internal xref">Section 2.2</a>.<a href="#section-5.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-3.2">Device owners, however, can use any other mechanism they want, including physical inspection and programming in a secure location, to assure themselves that local identity
certificates are inserted into the intended device
if they prefer to avoid placing trust in the manufacturer-provided keys.<a href="#section-5.4-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.4-4">Clearly, local keys can't be used for SZTP; installation of the local keys
can only be done by some process that runs before the device is installed for network operation, 
or by using procedures such as those outlined in Bootstrapping Remote Secure Key Infrastructure (BRSKI) <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">On the other end of the device lifecycle, provision should be made to wipe local keys when a device
is decommissioned to indicate that the device is no longer owned by the enterprise.  The manufacturer's
initial identity keys must be preserved, as they contain no information that's not already printed on
the device's serial number plate.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-factors-for-trustworthy-operation">
<section id="section-5.5">
        <h3 id="name-other-factors-for-trustwort">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-other-factors-for-trustwort" class="section-name selfRef">Other Factors for Trustworthy Operation</a>
        </h3>
<p id="section-5.5-1">In addition to the trustworthy provisioning of keys, RIV depends on a number of other factors for trustworthy operation.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">Secure identity depends on mechanisms to prevent per-device secret keys from being compromised.  The TPM
provides this capability as a Root of Trust for Storage.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.2">Attestation depends on an unbroken chain of measurements, starting from the very first 
measurement.  See <a href="#using-tpm" class="auto internal xref">Appendix A.1</a> for background on TPM practices.<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.3">That first measurement is made by code called the RTM, typically done by trusted
firmware stored in boot flash.  Mechanisms for maintaining the trustworthiness of the RTM are out of
scope for RIV, but could include immutable firmware, signed updates, or a vendor-specific hardware
verification technique.    See <a href="#root-of-trust" class="auto internal xref">Appendix A.2</a> for background on Roots of Trust.<a href="#section-5.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.4">The device owner <span class="bcp14">SHOULD</span> provide some level of physical defense for the device.  If a TPM that has already been programmed
with an authentic DevID is stolen and is inserted into a counterfeit device, attestation of that counterfeit
device may become indistinguishable from an authentic device.<a href="#section-5.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-3">RIV also depends on reliable Reference Values, as expressed by the RIM <span>[<a href="#RIM" class="cite xref">RIM</a>]</span>.  The definition of
trust procedures for RIMs is out of scope for RIV, and the device owner is free to use any policy to validate
a set of reference measurements.  It should also be noted that, while RIV can provide a reliable indication that a known software package is in use by the device and that the package has not been tampered with, it is the device owner's responsibility to determine that it's the correct package for the application.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">RIMs may be conveyed either out-of-band or in-band as part of the attestation
process (see <a href="#RIM-policy" class="auto internal xref">Section 3.1.3</a>).  However, for network devices, where software is usually shipped as a self-contained
package, RIMs signed by the manufacturer and delivered in-band may be more convenient for the device owner.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<p id="section-5.5-5">The validity of RIV attestation results is also influenced by procedures used to create Reference Values:<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-6.1">While the RIM itself is signed, supply chains <span class="bcp14">SHOULD</span> be carefully scrutinized to ensure that the values are 
not subject to unexpected manipulation prior to signing.  Insider attacks against code bases and build chains
are particularly hard to spot.<a href="#section-5.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.2">Designers <span class="bcp14">SHOULD</span> guard against hash collision attacks.  RIMs often give hashes for large objects
of indeterminate size. If one of the measured objects can be replaced with an implant engineered to produce
the same hash, RIV will be unable to detect the substitution.  TPM 1.2 only uses SHA-1 hashes, which have been
shown to be susceptible to collision attack.  TPM 2.0 will produce quotes with SHA-256, which so far has resisted
such attacks.  Consequently, RIV implementations <span class="bcp14">SHOULD</span> use TPM 2.0.<a href="#section-5.5-6.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conclusion">
<section id="section-7">
      <h2 id="name-conclusion">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-conclusion" class="section-name selfRef">Conclusion</a>
      </h2>
<p id="section-7-1">TCG technologies can play an important part in the implementation of RIV.
Standards for many of the components needed for
implementation of RIV already exist:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">Platform identity can be based on IEEE 802.1AR DevID, coupled with
careful supply-chain management by the manufacturer.<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">Complex supply chains can be certified using TCG Platform Certificates <span>[<a href="#PLATFORM-CERTS" class="cite xref">PLATFORM-CERTS</a>]</span>.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">The TCG TAP mechanism coupled with <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> can be used to retrieve attestation evidence.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.4">Reference Values must be conveyed from the software authority (e.g.,
the manufacturer) in RIMs to the system in which verification will take place.  IETF and TCG
SWID and CoSWID work (<span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span> <span>[<a href="#RIM" class="cite xref">RIM</a>]</span>) forms the basis for this function.<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CEL">[CEL]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Canonical Event Log Format"</span>, <span class="refContent">Version 1.0, Revision 0.41</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_CEL_v1_r0p41_pub.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_CEL_v1_r0p41_pub.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802-1AR">[IEEE-802-1AR]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and Metropolitan Area Networks - Secure Device Identity"</span>, <span class="seriesInfo">IEEE Std 802.1AR-2018</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8423794</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2018.8423794">https://doi.org/10.1109/IEEESTD.2018.8423794</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IMA">[IMA]</dt>
        <dd>
<span class="refAuthor">The kernel development community</span>, <span class="refTitle">"dm-ima"</span>, <span class="refContent">Linux Kernel 6.11</span>, <time datetime="2024-09-15" class="refDate">15 September 2024</time>, <span>&lt;<a href="https://www.kernel.org/doc/html/v6.11/admin-guide/device-mapper/dm-ima.html">https://www.kernel.org/doc/html/v6.11/admin-guide/device-mapper/dm-ima.html</a>&gt;</span>. <span class="annotation">The latest version can be found at <span><a href="https://docs.kernel.org/admin-guide/device-mapper/dm-ima.html">https://docs.kernel.org/admin-guide/device-mapper/dm-ima.html</a></span>.</span>
        </dd>
<dd class="break"></dd>
<dt id="PC-CLIENT-BIOS-TPM-2.0">[PC-CLIENT-BIOS-TPM-2.0]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG PC Client Specific Platform Firmware Profile Specification"</span>, <span class="refContent">Family "2.0", Level 00, Version 1.05, Revision 23</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/pc-client-specific-platform-firmware-profile-specification/">https://trustedcomputinggroup.org/resource/pc-client-specific-platform-firmware-profile-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PC-CLIENT-EFI-TPM-1.2">[PC-CLIENT-EFI-TPM-1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG EFI Platform Specification"</span>, <span class="refContent">For TPM Family 1.1 or 1.2, Version 1.22, Revision 15</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-efi-platform-specification/">https://trustedcomputinggroup.org/resource/tcg-efi-platform-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PC-CLIENT-RIM">[PC-CLIENT-RIM]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG PC Client Reference Integrity Manifest Specification"</span>, <span class="refContent">Version 1.04</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-pc-client-reference-integrity-manifest-specification/">https://trustedcomputinggroup.org/resource/tcg-pc-client-reference-integrity-manifest-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PLATFORM-DEVID-TPM-2.0">[PLATFORM-DEVID-TPM-2.0]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM 2.0 Keys for Device Identity and Attestation"</span>, <span class="refContent">Version 1.00, Revision 12</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-2-0-keys-for-device-identity-and-attestation/">https://trustedcomputinggroup.org/resource/tpm-2-0-keys-for-device-identity-and-attestation/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PLATFORM-ID-TPM-1.2">[PLATFORM-ID-TPM-1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Infrastructure WG TPM Keys for Platform Identity for TPM 1.2"</span>, <span class="refContent">Specification Version 1.0, Revision 3</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-keys-for-platform-identity-for-tpm-1-2-2/">https://trustedcomputinggroup.org/resource/tpm-keys-for-platform-identity-for-tpm-1-2-2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4253">[RFC4253]</dt>
        <dd>
<span class="refAuthor">Ylonen, T.</span> and <span class="refAuthor">C. Lonvick, Ed.</span>, <span class="refTitle">"The Secure Shell (SSH) Transport Layer Protocol"</span>, <span class="seriesInfo">RFC 4253</span>, <span class="seriesInfo">DOI 10.17487/RFC4253</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4253">https://www.rfc-editor.org/info/rfc4253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9393">[RFC9393]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fitzgerald-McKay, J.</span>, <span class="refAuthor">Schmidt, C.</span>, and <span class="refAuthor">D. Waltermire</span>, <span class="refTitle">"Concise Software Identification Tags"</span>, <span class="seriesInfo">RFC 9393</span>, <span class="seriesInfo">DOI 10.17487/RFC9393</span>, <time datetime="2023-06" class="refDate">June 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9393">https://www.rfc-editor.org/info/rfc9393</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9684">[RFC9684]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Bhandari, S.</span>, <span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Sulzen, B.</span>, <span class="refAuthor">Xia, L.</span>, <span class="refAuthor">Laffey, T.</span>, and <span class="refAuthor">G. C. Fedorkow</span>, <span class="refTitle">"A YANG Data Model for Challenge-Response-Based Remote Attestation (CHARRA) Procedures Using Trusted Platform Modules (TPMs)"</span>, <span class="seriesInfo">RFC 9684</span>, <span class="seriesInfo">DOI 10.17487/RFC9684</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9684">https://www.rfc-editor.org/info/rfc9684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIM">[RIM]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Reference Integrity Manifest (RIM) Information Model"</span>, <span class="refContent">Version 1.01, Revision 0.16</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-reference-integrity-manifest-rim-information-model/">https://trustedcomputinggroup.org/resource/tcg-reference-integrity-manifest-rim-information-model/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SWID">[SWID]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Information technology - IT asset management - Part 2: Software identification tag"</span>, <span class="seriesInfo">ISO/IEC 19770-2:2015</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.iso.org/standard/65666.html">https://www.iso.org/standard/65666.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TAP">[TAP]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Trusted Attestation Protocol (TAP) Information Model for TPM Families 1.2 and 2.0 and DICE Family 1.0"</span>, <span class="refContent">Version 1.0, Revision 0.36</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TNC_TAP_Information_Model_v1.00_r0.36-FINAL.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TNC_TAP_Information_Model_v1.00_r0.36-FINAL.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AIK-ENROLL">[AIK-ENROLL]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Infrastructure Working Group A CMC Profile for AIK Certificate Enrollment"</span>, <span class="refContent">Version 1.0, Revision 7</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-infrastructure-working-group-a-cmc-profile-for-aik-certificate-enrollment/">https://trustedcomputinggroup.org/resource/tcg-infrastructure-working-group-a-cmc-profile-for-aik-certificate-enrollment/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.1AE">[IEEE-802.1AE]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Media Access Control (MAC) Security"</span>, <span class="seriesInfo">IEEE Std 802.1AE-2018</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8585421</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2018.8585421">https://doi.org/10.1109/IEEESTD.2018.8585421</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.1X">[IEEE-802.1X]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and Metropolitan Area Networks - Port-Based Network Access Control"</span>, <span class="seriesInfo">IEEE Std 802.1X-2020</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2020.9018454</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2020.9018454">https://doi.org/10.1109/IEEESTD.2020.9018454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LLDP">[LLDP]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Station and Media Access Control Connectivity Discovery"</span>, <span class="seriesInfo">IEEE Std 802.1AB-2016</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2016.7433915</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2016.7433915">https://doi.org/10.1109/IEEESTD.2016.7433915</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NET-EQ">[NET-EQ]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Guidance for Securing Network Equipment Using TCG Technology"</span>, <span class="refContent">Version 1.0, Revision 29</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-guidance-securing-network-equipment/">https://trustedcomputinggroup.org/resource/tcg-guidance-securing-network-equipment/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-IR-8060">[NIST-IR-8060]</dt>
        <dd>
<span class="refAuthor">Waltermire, D.</span>, <span class="refAuthor">Cheikes, B. A.</span>, <span class="refAuthor">Feldman, L.</span>, and <span class="refAuthor">G. Witte</span>, <span class="refTitle">"Guidelines for the Creation of Interoperable Software Identification (SWID) Tags"</span>, <span class="seriesInfo">NIST NISTIR 8060</span>, <span class="seriesInfo">DOI 10.6028/NIST.IR.8060</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/ir/2016/NIST.IR.8060.pdf">https://nvlpubs.nist.gov/nistpubs/ir/2016/NIST.IR.8060.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PLATFORM-CERTS">[PLATFORM-CERTS]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Platform Attribute Credential Profile"</span>, <span class="refContent">Specification Version 1.0, Revision 16</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tcg-platform-attribute-credential-profile/">https://trustedcomputinggroup.org/resource/tcg-platform-attribute-credential-profile/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PROV-TPM-2.0">[PROV-TPM-2.0]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG TPM v2.0 Provisioning Guidance"</span>, <span class="refContent">Version 1.0, Revision 1.0</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG-TPM-v2.0-Provisioning-Guidance-Published-v1r1.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG-TPM-v2.0-Provisioning-Guidance-Published-v1r1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[RATS-EAT]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-31</span>, <time datetime="2024-09-06" class="refDate">6 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-31">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-31</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-reference-interaction-models">[RATS-INTERACTION-MODELS]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Pan, W.</span>, and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-reference-interaction-models-11</span>, <time datetime="2024-07-22" class="refDate">22 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-11">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-network-device-subscription">[RATS-NET-DEV-SUB]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Voit, E.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Attestation Event Stream Subscription"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-network-device-subscription-05</span>, <time datetime="2024-07-07" class="refDate">7 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-network-device-subscription-05">https://datatracker.ietf.org/doc/html/draft-ietf-rats-network-device-subscription-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.birkholz-rats-tuda">[RATS-TUDA]</dt>
        <dd>
<span class="refAuthor">Fuchs, A.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">McDonald, I.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Time-Based Uni-Directional Attestation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-tuda-07</span>, <time datetime="2022-07-10" class="refDate">10 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07">https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.richardson-rats-usecases">[RATS-USECASES]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Wallace, C.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Use cases for Remote Attestation common encodings"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-richardson-rats-usecases-08</span>, <time datetime="2020-11-02" class="refDate">2 November 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-richardson-rats-usecases-08">https://datatracker.ietf.org/doc/html/draft-richardson-rats-usecases-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6813">[RFC6813]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Hanna</span>, <span class="refTitle">"The Network Endpoint Assessment (NEA) Asokan Attack Analysis"</span>, <span class="seriesInfo">RFC 6813</span>, <span class="seriesInfo">DOI 10.17487/RFC6813</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6813">https://www.rfc-editor.org/info/rfc6813</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Farrer, I.</span>, and <span class="refAuthor">M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8572">https://www.rfc-editor.org/info/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8995">https://www.rfc-editor.org/info/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9525">[RFC9525]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="seriesInfo">RFC 9525</span>, <span class="seriesInfo">DOI 10.17487/RFC9525</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9525">https://www.rfc-editor.org/info/rfc9525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-155">[SP800-155]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"BIOS Integrity Measurement Guidelines (Draft)"</span>, <span class="seriesInfo">NIST SP 800-155 (Draft)</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://csrc.nist.gov/files/pubs/sp/800/155/ipd/docs/draft-sp800-155_dec2011.pdf">https://csrc.nist.gov/files/pubs/sp/800/155/ipd/docs/draft-sp800-155_dec2011.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-193">[SP800-193]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Platform Firmware Resiliency Guidelines"</span>, <span class="seriesInfo">NIST SP 800-193</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-193</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-193.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-193.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SWID-GEN">[SWID-GEN]</dt>
        <dd>
<span class="refAuthor">Labs64</span>, <span class="refTitle">"SoftWare IDentification (SWID) Tags Generator (Maven Plugin)"</span>, <span>&lt;<a href="https://github.com/Labs64/swid-maven-plugin">https://github.com/Labs64/swid-maven-plugin</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCG-RT">[TCG-RT]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TCG Roots of Trust Specification"</span>, <span class="refContent">(Draft), Family "1.0", Level 00, Revision 0.20</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_Roots_of_Trust_Specification_v0p20_PUBLIC_REVIEW.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_Roots_of_Trust_Specification_v0p20_PUBLIC_REVIEW.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM-1.2">[TPM-1.2]</dt>
        <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"TPM 1.2 Main Specification"</span>, <span class="refContent">Level 2, Version 1.2, Revision 116</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-main-specification/">https://trustedcomputinggroup.org/resource/tpm-main-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM-2.0">[TPM-2.0]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library"</span>, <span class="refContent">Family "2.0", Level 00, Revision 01.83</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appendix">
<section id="appendix-A">
      <h2 id="name-supporting-materials">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-supporting-materials" class="section-name selfRef">Supporting Materials</a>
      </h2>
<div id="using-tpm">
<section id="appendix-A.1">
        <h3 id="name-using-a-tpm-for-attestation">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-using-a-tpm-for-attestation" class="section-name selfRef">Using a TPM for Attestation</a>
        </h3>
<p id="appendix-A.1-1">The TPM and surrounding ecosystem provide three interlocking capabilities to enable secure collection 
of evidence from a remote device: PCRs, a Quote mechanism, and a standardized Event Log.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Each TPM has at least eight and at most twenty-four PCRs (depending on the profile and vendor choices), each one large 
enough to hold one hash value (SHA-1, SHA-256, and other hash algorithms can 
be used, depending on TPM version).  PCRs can't be accessed directly from outside the chip, but the TPM 
interface provides a way to "extend" a new security measurement hash into any PCR, a process by which the existing value 
in the PCR is hashed with the new security measurement hash, and the result placed back into the same PCR.  The result 
is a composite fingerprint comprising the hash of all the security measurements extended into each PCR since the system was reset.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Every time a PCR is extended, an entry should be added to the corresponding Event Log.  Logs contain the security 
measurement hash plus informative fields offering hints as to which event generated the security measurement. 
The Event Log itself is protected against accidental manipulation, but it is implicitly tamper-evident:  Any 
verification process can read the security measurement hash from the log events, compute the composite value, 
and compare that to what is in the PCR.   If there's no discrepancy, the logs do provide an accurate 
view of what was placed into the PCR.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">Note that the composite hash-of-hashes recorded in PCRs is order-dependent, resulting in different PCR values for different 
ordering of the same set of events (e.g., Event A followed by Event B yields a different PCR value than B followed by A).
For single-threaded code, where both the events and their order are fixed, a Verifier may validate a single PCR value, and use the log only to diagnose a mismatch from Reference Values.  However, operating system code is usually 
nondeterministic, meaning that there may never be a single "known good" PCR value.  In this case, the Verifier may have
to verify that the log is correct, and then analyze each item in the log to determine if it represents an authorized event.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">In a conventional TPM Attestation environment, the first measurement must be made and extended into the TPM by trusted 
device code (called the RTM).  That first measurement should cover the segment of 
code that is run immediately after the RTM, which then measures the next code segment before running it, and so on, 
forming an unbroken chain of trust.  See <span>[<a href="#TCG-RT" class="cite xref">TCG-RT</a>]</span> for more on Mutable vs. Immutable Roots of Trust.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6">The TPM provides another mechanism called a Quote that can read the current value of the PCRs and package them, 
along with the Verifier's nonce, into a TPM-specific data structure signed by an Attestation private key, known 
only to the TPM.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">It's important to note that the Quote data structure is signed inside the TPM (see <a href="#security-cons" class="auto internal xref">Section 5</a>, Security Considerations).  The trust model is preserved by retrieving the Quote in a way that does not invalidate the signature, 
as specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  The structure of the command and response for a quote, including its signature, as generated by the TPM, can be seen in Part 3, Section 16.5, of <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span> and Section 18.4.2 of <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span>.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.1-8">The Verifier uses the Quote and Log together.  The Quote contains the composite hash of the complete sequence 
of security measurement hashes, signed by the TPM's private AK.  The Log contains a record of each
measurement extended into the TPM's PCRs.  By computing the composite hash of all the measurements, the Verifier
can verify the integrity of the Event Log, even though the Event Log itself is not signed.  Each hash in the validated 
Event Log can then be compared to corresponding expected values in the set of Reference Values to 
validate overall system integrity.<a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
<p id="appendix-A.1-9">A summary of information exchanged in obtaining quotes from TPM 1.2 and TPM 2.0 can be found in <span>[<a href="#TAP" class="cite xref">TAP</a>]</span>, Section 4.
Detailed information about PCRs and Quote data structures can be found in <span>[<a href="#TPM-1.2" class="cite xref">TPM-1.2</a>]</span>, <span>[<a href="#TPM-2.0" class="cite xref">TPM-2.0</a>]</span>.  Recommended log 
formats include <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span>, and <span>[<a href="#CEL" class="cite xref">CEL</a>]</span>.<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="root-of-trust">
<section id="appendix-A.2">
        <h3 id="name-root-of-trust-for-measureme">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-root-of-trust-for-measureme" class="section-name selfRef">Root of Trust for Measurement (RTM)</a>
        </h3>
<p id="appendix-A.2-1">The measurements needed for attestation require that the device being attested
is equipped with an RTM, that is, some trustworthy
mechanism that can compute the first measurement in the chain of trust required
to attest that each stage of system startup is verified, a Root of Trust for Storage (i.e., 
the TPM PCRs) to record the results, and a Root of Trust
for Reporting to report the results.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">While there are many complex aspects of Roots of Trust (<span>[<a href="#TCG-RT" class="cite xref">TCG-RT</a>]</span> <span>[<a href="#SP800-155" class="cite xref">SP800-155</a>]</span> <span>[<a href="#SP800-193" class="cite xref">SP800-193</a>]</span>), two aspects that

are important in the case of attestation are:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-3.1">The first measurement computed by the RTM and stored
in the TPM's Root of Trust for Storage must be assumed to be correct.<a href="#appendix-A.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-3.2">There must not be a way to reset the Root of Trust for Storage without re-entering
the RTM code.<a href="#appendix-A.2-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.2-4">The first measurement must be computed by code that is implicitly trusted; if that
first measurement can be subverted, none of the remaining measurements can
be trusted. (See <span>[<a href="#SP800-155" class="cite xref">SP800-155</a>]</span>.)<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5">It's important to note that the trustworthiness of the RTM code cannot be assured by 
the TPM or TPM supplier -- code or procedures external to the TPM must guarantee the 
security of the RTM.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="layering-model-for-network-equipment-attester-and-verifier">
<section id="appendix-A.3">
        <h3 id="name-layering-model-for-network-">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-layering-model-for-network-" class="section-name selfRef">Layering Model for Network Equipment Attester and Verifier</a>
        </h3>
<p id="appendix-A.3-1">Retrieval of identity and attestation state uses one protocol stack, while
retrieval of Reference Values uses a different set of protocols.  
<a href="#RIV-Protocol-Stacks" class="auto internal xref">Figure 5</a> shows the components involved.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<span id="name-riv-protocol-stacks"></span><div id="RIV-Protocol-Stacks">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="appendix-A.3-2.1">
<pre>
+-----------------------+              +-------------------------+
|                       |              |                         |
|       Attester        |&lt;-------------|        Verifier         |
|       (Device)        |-------------&gt;|   (Management Station)  |
|                       |      |       |                         |
+-----------------------+      |       +-------------------------+
                               |
           -------------------- --------------------
           |                                        |
-------------------------------    ---------------------------------
|      Reference Values       |    |          Attestation          |
-------------------------------    ---------------------------------

********************************************************************
*           IETF Remote Attestation Conceptual Data Flow           *
*                        RFC9334, Figure 1                         *
********************************************************************

    .........................          .........................
    .  Reference Integrity  .          .       TAP Info        .
    .       Manifest        .          .  Model and Canonical  .
    .                       .          .      Log Format       .
    .........................          .........................

    *************************          *************************
    *    YANG SWID Module   *          *    YANG Attestation   *
    *       RFC9393         *          *        Module         *
    *                       *          *        RFC9684        *
    *                       *          *                       *
    *************************          *************************

    *************************          *************************
    * XML, JSON, CBOR, etc. *          * XML, JSON, CBOR, etc. *
    *************************          *************************

    *************************          *************************
    *   RESTCONF/NETCONF    *          *   RESTCONF/NETCONF    *
    *************************          *************************

    *************************          *************************
    *       TLS, SSH        *          *       TLS, SSH        *
    *************************          *************************
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-riv-protocol-stacks" class="selfRef">RIV Protocol Stacks</a>
          </figcaption></figure>
</div>
<p id="appendix-A.3-3">IETF documents are captured in boxes surrounded by asterisks. TCG documents
are shown in boxes surrounded by dots.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-notes">
<section id="appendix-A.4">
        <h3 id="name-implementation-notes">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-implementation-notes" class="section-name selfRef">Implementation Notes</a>
        </h3>
<p id="appendix-A.4-1"><a href="#Component-Status" class="auto internal xref">Table 2</a> summarizes many of the actions needed to complete an Attestation
system, with links to relevant documents.  While documents are controlled
by several standards organizations, the implied actions required for
implementation are all the responsibility of the manufacturer of the device,
unless otherwise noted.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">As noted, SWID tags can be generated many ways, but one possible tool is <span>[<a href="#SWID-GEN" class="cite xref">SWID-GEN</a>]</span>.<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<span id="name-component-status"></span><div id="Component-Status">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-component-status" class="selfRef">Component Status</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Component</th>
              <th class="text-left" rowspan="1" colspan="1">Controlling Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.1.1.1">Make a Secure execution environment:<a href="#appendix-A.4-3.2.1.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.1.1.2.1">Attestation depends on a secure RTM outside the TPM, as well as Roots for Storage and Reporting inside the TPM.<a href="#appendix-A.4-3.2.1.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.1.1.2.2">Refer to "TCG Roots of Trust Specification" <span>[<a href="#TCG-RT" class="cite xref">TCG-RT</a>]</span>.<a href="#appendix-A.4-3.2.1.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.1.1.2.3">
                    <span>[<a href="#SP800-193" class="cite xref">SP800-193</a>]</span> also provides guidelines on Roots of Trust.<a href="#appendix-A.4-3.2.1.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.1.2.1"><span>[<a href="#TCG-RT" class="cite xref">TCG-RT</a>]</span><a href="#appendix-A.4-3.2.1.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.1.2.2"><span>&lt;<a href="www.uefi.org">www.uefi.org</a>&gt;</span><a href="#appendix-A.4-3.2.1.2.2" class="pilcrow">¶</a></p>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Provision the TPM as described in the TCG documents.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.2.2.1"><span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span><a href="#appendix-A.4-3.2.2.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.2.2.2"><span>[<a href="#PLATFORM-CERTS" class="cite xref">PLATFORM-CERTS</a>]</span><a href="#appendix-A.4-3.2.2.2.2" class="pilcrow">¶</a></p>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="2" colspan="">
                <p id="appendix-A.4-3.2.3.1.1">Put a DevID or Platform Certificate in the TPM:<a href="#appendix-A.4-3.2.3.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.3.1.2.1">Install an IAK at the same time so that Attestation can work out of the box.<a href="#appendix-A.4-3.2.3.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.3.1.2.2">Equipment suppliers and owners may want to implement LDevID as well as IDevID.<a href="#appendix-A.4-3.2.3.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.3.2.1"><span>[<a href="#PLATFORM-DEVID-TPM-2.0" class="cite xref">PLATFORM-DEVID-TPM-2.0</a>]</span><a href="#appendix-A.4-3.2.3.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.3.2.2"><span>[<a href="#PLATFORM-CERTS" class="cite xref">PLATFORM-CERTS</a>]</span><a href="#appendix-A.4-3.2.3.2.2" class="pilcrow">¶</a></p>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#IEEE-802-1AR" class="cite xref">IEEE-802-1AR</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.5.1.1">Connect the TPM to the TLS stack:<a href="#appendix-A.4-3.2.5.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.5.1.2.1">Use the DevID in the TPM to authenticate TAP connections, identifying the device.<a href="#appendix-A.4-3.2.5.1.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">Vendor TLS stack (This action configures TLS to use the DevID as its client certificate.)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.6.1.1">Make CoSWID tags for BIOS/Loader/Kernel objects:<a href="#appendix-A.4-3.2.6.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.6.1.2.1">Add reference measurements into SWID tags.<a href="#appendix-A.4-3.2.6.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.6.1.2.2">Manufacturer should sign the SWID tags.<a href="#appendix-A.4-3.2.6.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.6.1.2.3">The TCG RIM-IM <span>[<a href="#RIM" class="cite xref">RIM</a>]</span> identifies further procedures to create signed RIM documents that provide the necessary reference information.<a href="#appendix-A.4-3.2.6.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.6.2.1"><span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span><a href="#appendix-A.4-3.2.6.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.6.2.2"><span>[<a href="#SWID" class="cite xref">SWID</a>]</span><a href="#appendix-A.4-3.2.6.2.2" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.6.2.3"><span>[<a href="#NIST-IR-8060" class="cite xref">NIST-IR-8060</a>]</span><a href="#appendix-A.4-3.2.6.2.3" class="pilcrow">¶</a></p>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="2" colspan="1">
                <p id="appendix-A.4-3.2.7.1.1">Package the SWID tags with a vendor software release:<a href="#appendix-A.4-3.2.7.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.7.1.2.1">A tag-generator plugin such as <span>[<a href="#SWID-GEN" class="cite xref">SWID-GEN</a>]</span>  can be used.<a href="#appendix-A.4-3.2.7.1.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">Retrieve tags with <span>[<a href="#RFC9393" class="cite xref">RFC9393</a>]</span>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PC-CLIENT-RIM" class="cite xref">PC-CLIENT-RIM</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Use PC Client measurement definitions to define the use of PCRs (although Windows OS is rare on Networking Equipment, UEFI BIOS is not).</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PC-CLIENT-BIOS-TPM-2.0" class="cite xref">PC-CLIENT-BIOS-TPM-2.0</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.10.1.1">Use TAP to retrieve measurements:<a href="#appendix-A.4-3.2.10.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.10.1.2.1">
                    <p id="appendix-A.4-3.2.10.1.2.1.1">Map to YANG.<a href="#appendix-A.4-3.2.10.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.10.1.2.2">
                    <p id="appendix-A.4-3.2.10.1.2.2.1">Use Canonical Log Format.<a href="#appendix-A.4-3.2.10.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.10.2.1"><span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span><a href="#appendix-A.4-3.2.10.2.1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3.2.10.2.2"><span>[<a href="#CEL" class="cite xref">CEL</a>]</span><a href="#appendix-A.4-3.2.10.2.2" class="pilcrow">¶</a></p>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <p id="appendix-A.4-3.2.11.1.1">A Verifier (as described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>], <a href="https://rfc-editor.org/rfc/rfc9334#section-3" class="relref">Section 3</a></span>) should request the attestation and analyze the result. The Verifier application might be broken down to several more components:<a href="#appendix-A.4-3.2.11.1.1" class="pilcrow">¶</a></p>
<ul class="normal text-left">
<li class="normal text-left" id="appendix-A.4-3.2.11.1.2.1">A Posture Manager Server that collects reports and stores them in a database.<a href="#appendix-A.4-3.2.11.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal text-left" id="appendix-A.4-3.2.11.1.2.2">One or more Analyzers that can look at the results and figure out what it means.<a href="#appendix-A.4-3.2.11.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</td>
              <td class="text-left" rowspan="1" colspan="1">
      </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors wish to thank numerous reviewers for generous assistance, including <span class="contact-name">William Bellingrath</span>, <span class="contact-name">Mark Baushke</span>, <span class="contact-name">Ned Smith</span>,
<span class="contact-name">Henk Birkholz</span>, <span class="contact-name">Tom Laffey</span>, <span class="contact-name">Dave Thaler</span>, <span class="contact-name">Wei Pan</span>, <span class="contact-name">Michael Eckel</span>, <span class="contact-name">Thomas Hardjono</span>, <span class="contact-name">Bill Sulzen</span>, <span class="contact-name">Willard (Monty) Wiseman</span>,
<span class="contact-name">Kathleen Moriarty</span>, <span class="contact-name">Nancy Cam-Winget</span>, and <span class="contact-name">Shwetha Bhandari</span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guy C. Fedorkow (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">10 Technology Park Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Westford</span>, <span class="region">Massachusetts</span> <span class="postal-code">01886</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gfedorkow@juniper.net" class="email">gfedorkow@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Voit</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:evoit@cisco.com" class="email">evoit@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jessica Fitzgerald-McKay</span></div>
<div dir="auto" class="left"><span class="org">National Security Agency</span></div>
<div dir="auto" class="left"><span class="street-address">9800 Savage Road</span></div>
<div dir="auto" class="left">
<span class="locality">Ft. Meade</span>, <span class="region">Maryland</span> <span class="postal-code">20755</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jmfitz2@nsa.gov" class="email">jmfitz2@nsa.gov</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
