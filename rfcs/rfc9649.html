<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9649: WebP Image Format</title>
<meta content="James Zern" name="author">
<meta content="Pascal Massimino" name="author">
<meta content="Jyrki Alakuijala" name="author">
<meta content="
       This document defines the WebP image format and registers a media type
     supporting its use. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="VP8" name="keyword">
<meta content="WebP" name="keyword">
<meta content="9649" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9649.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-zern-webp-15" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9649" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9649</td>
<td class="center">WebP Image Format</td>
<td class="right">November 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zern, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9649" class="eref">9649</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-11" class="published">November 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Zern</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">P. Massimino</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">J. Alakuijala</div>
<div class="org">Google LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9649</h1>
<h1 id="title">WebP Image Format</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the WebP image format and registers a media type
     supporting its use.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9649">https://www.rfc-editor.org/info/rfc9649</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-webp-container-specificatio" class="internal xref">WebP Container Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-introduction-from-webp-cont" class="internal xref">Introduction (from "WebP Container Specification")</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-terminology-basics" class="internal xref">Terminology &amp; Basics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-riff-file-format" class="internal xref">RIFF File Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-webp-file-header" class="internal xref">WebP File Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-simple-file-format-lossy" class="internal xref">Simple File Format (Lossy)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-simple-file-format-lossless" class="internal xref">Simple File Format (Lossless)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-extended-file-format" class="internal xref">Extended File Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1">
                    <p id="section-toc.1-1.2.2.7.2.1.1"><a href="#section-2.7.1" class="auto internal xref">2.7.1</a>.  <a href="#name-chunks" class="internal xref">Chunks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.1">
                        <p id="section-toc.1-1.2.2.7.2.1.2.1.1"><a href="#section-2.7.1.1" class="auto internal xref">2.7.1.1</a>.  <a href="#name-animation" class="internal xref">Animation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.2">
                        <p id="section-toc.1-1.2.2.7.2.1.2.2.1"><a href="#section-2.7.1.2" class="auto internal xref">2.7.1.2</a>.  <a href="#name-alpha" class="internal xref">Alpha</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.3">
                        <p id="section-toc.1-1.2.2.7.2.1.2.3.1"><a href="#section-2.7.1.3" class="auto internal xref">2.7.1.3</a>.  <a href="#name-bitstream-vp8-vp8l" class="internal xref">Bitstream (VP8/VP8L)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.4">
                        <p id="section-toc.1-1.2.2.7.2.1.2.4.1"><a href="#section-2.7.1.4" class="auto internal xref">2.7.1.4</a>.  <a href="#name-color-profile" class="internal xref">Color Profile</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.5">
                        <p id="section-toc.1-1.2.2.7.2.1.2.5.1"><a href="#section-2.7.1.5" class="auto internal xref">2.7.1.5</a>.  <a href="#name-metadata" class="internal xref">Metadata</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.1.2.6">
                        <p id="section-toc.1-1.2.2.7.2.1.2.6.1"><a href="#section-2.7.1.6" class="auto internal xref">2.7.1.6</a>.  <a href="#name-unknown-chunks" class="internal xref">Unknown Chunks</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.2">
                    <p id="section-toc.1-1.2.2.7.2.2.1"><a href="#section-2.7.2" class="auto internal xref">2.7.2</a>.  <a href="#name-canvas-assembly-from-frames" class="internal xref">Canvas Assembly from Frames</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7.2.3">
                    <p id="section-toc.1-1.2.2.7.2.3.1"><a href="#section-2.7.3" class="auto internal xref">2.7.3</a>.  <a href="#name-example-file-layouts" class="internal xref">Example File Layouts</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-specification-for-webp-loss" class="internal xref">Specification for WebP Lossless Bitstream</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-abstract-from-specification" class="internal xref">Abstract (from "Specification for WebP Lossless Bitstream")</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-introduction-from-specifica" class="internal xref">Introduction (from "Specification for WebP Lossless Bitstream")</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-nomenclature" class="internal xref">Nomenclature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-riff-header" class="internal xref">RIFF Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-transforms" class="internal xref">Transforms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-predictor-transform" class="internal xref">Predictor Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-color-transform" class="internal xref">Color Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-subtract-green-transform" class="internal xref">Subtract Green Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-color-indexing-transform" class="internal xref">Color Indexing Transform</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-image-data" class="internal xref">Image Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-roles-of-image-data" class="internal xref">Roles of Image Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-encoding-of-image-data" class="internal xref">Encoding of Image Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2.2.1">
                        <p id="section-toc.1-1.3.2.6.2.2.2.1.1"><a href="#section-3.6.2.1" class="auto internal xref">3.6.2.1</a>.  <a href="#name-prefix-coded-literals" class="internal xref">Prefix-Coded Literals</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2.2.2">
                        <p id="section-toc.1-1.3.2.6.2.2.2.2.1"><a href="#section-3.6.2.2" class="auto internal xref">3.6.2.2</a>.  <a href="#name-lz77-backward-reference" class="internal xref">LZ77 Backward Reference</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2.2.3">
                        <p id="section-toc.1-1.3.2.6.2.2.2.3.1"><a href="#section-3.6.2.3" class="auto internal xref">3.6.2.3</a>.  <a href="#name-color-cache-coding" class="internal xref">Color Cache Coding</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-entropy-code" class="internal xref">Entropy Code</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="auto internal xref">3.7.2</a>.  <a href="#name-details" class="internal xref">Details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.1">
                        <p id="section-toc.1-1.3.2.7.2.2.2.1.1"><a href="#section-3.7.2.1" class="auto internal xref">3.7.2.1</a>.  <a href="#name-decoding-and-building-the-p" class="internal xref">Decoding and Building the Prefix Codes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.2">
                        <p id="section-toc.1-1.3.2.7.2.2.2.2.1"><a href="#section-3.7.2.2" class="auto internal xref">3.7.2.2</a>.  <a href="#name-decoding-of-meta-prefix-cod" class="internal xref">Decoding of Meta Prefix Codes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.3">
                        <p id="section-toc.1-1.3.2.7.2.2.2.3.1"><a href="#section-3.7.2.3" class="auto internal xref">3.7.2.3</a>.  <a href="#name-decoding-entropy-coded-imag" class="internal xref">Decoding Entropy-Coded Image Data</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-overall-structure-of-the-fo" class="internal xref">Overall Structure of the Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.1">
                    <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="auto internal xref">3.8.1</a>.  <a href="#name-basic-structure" class="internal xref">Basic Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.2">
                    <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="auto internal xref">3.8.2</a>.  <a href="#name-structure-of-transforms" class="internal xref">Structure of Transforms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.3">
                    <p id="section-toc.1-1.3.2.8.2.3.1"><a href="#section-3.8.3" class="auto internal xref">3.8.3</a>.  <a href="#name-structure-of-the-image-data" class="internal xref">Structure of the Image Data</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-interoperability-considerat" class="internal xref">Interoperability Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-the-image-webp-media-type" class="internal xref">The 'image/webp' Media Type</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-registration-details" class="internal xref">Registration Details</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">WebP is an image file format based on the <span><a href="#RIFF-spec" class="internal xref">Resource Interchange File Format
       (RIFF)</a> [<a href="#RIFF-spec" class="cite xref">RIFF-spec</a>]</span> (<a href="#webp-container" class="auto internal xref">Section 2</a>)
       that supports lossless and lossy
       compression as well as alpha (transparency) and animation. It covers use
       cases similar to <span><a href="#JPEG-spec" class="internal xref">JPEG</a> [<a href="#JPEG-spec" class="cite xref">JPEG-spec</a>]</span>,
       <span><a href="#RFC2083" class="internal xref">PNG</a> [<a href="#RFC2083" class="cite xref">RFC2083</a>]</span>, and the
       <span><a href="#GIF-spec" class="internal xref">Graphics Interchange Format (GIF)</a> [<a href="#GIF-spec" class="cite xref">GIF-spec</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">WebP consists of two compression algorithms used to reduce the size of
       image pixel data, including alpha (transparency) information. Lossy
       compression is achieved using VP8 intra-frame encoding <span>[<a href="#RFC6386" class="cite xref">RFC6386</a>]</span>. The <span><a href="#webp-lossless" class="internal xref">lossless
       algorithm</a> (<a href="#webp-lossless" class="auto internal xref">Section 3</a>)</span> stores and restores the pixel values exactly,
       including the color values for fully transparent pixels. A universal algorithm for sequential data compression
       <span>[<a href="#LZ77" class="cite xref">LZ77</a>]</span>, <span><a href="#Huffman" class="internal xref">prefix coding</a> [<a href="#Huffman" class="cite xref">Huffman</a>]</span>,
       and a color cache are used for compression of the bulk data.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
<div id="webp-container">
<section id="section-2">
      <h2 id="name-webp-container-specificatio">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-webp-container-specificatio" class="section-name selfRef">WebP Container Specification</a>
      </h2>
<aside id="section-2-1">
        <p id="section-2-1.1">Note that this section is based on the documentation in the <span><a href="#webp-riff-src" class="internal xref">libwebp source repository</a> [<a href="#webp-riff-src" class="cite xref">webp-riff-src</a>]</span>.<a href="#section-2-1.1" class="pilcrow">¶</a></p>
</aside>
<section id="section-2.1">
        <h3 id="name-introduction-from-webp-cont">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-introduction-from-webp-cont" class="section-name selfRef">Introduction (from "WebP Container Specification")</a>
        </h3>
<p id="section-2.1-1">WebP is an image format that uses either (i) the VP8 intra-frame
         encoding <span>[<a href="#RFC6386" class="cite xref">RFC6386</a>]</span> to compress image data in a lossy
           way or (ii) the <span><a href="#webp-lossless" class="internal xref">WebP lossless
             encoding</a> (<a href="#webp-lossless" class="auto internal xref">Section 3</a>)</span>. These encoding schemes should make it more
               efficient than older formats, such as JPEG, GIF, and PNG. It is optimized for fast
               image transfer over the network (for example, for websites). The WebP
               format has feature parity (color profile, metadata, animation,
               etc.) with other formats as well. This section describes the
               structure of a WebP file.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The WebP container (that is, the RIFF container for WebP) allows feature
         support over and above the basic use case of WebP (that is, a file
         containing a single image encoded as a VP8 key frame). The WebP
         container provides additional support for the following:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">Lossless Compression: An image can be losslessly compressed,
           using the WebP lossless format.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-3.2">Metadata: An image may have metadata stored in Exchangeable Image File Format <span>[<a href="#Exif" class="cite xref">Exif</a>]</span> or Extensible Metadata Platform <span>[<a href="#XMP" class="cite xref">XMP</a>]</span> format.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-3.3">Transparency: An image may have transparency, that is, an alpha
           channel.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-3.4">Color Profile: An image may have an embedded <span><a href="#ICC" class="internal xref">ICC profile (ICCP)</a> [<a href="#ICC" class="cite xref">ICC</a>]</span>.<a href="#section-2.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-3.5">Animation: An image may have multiple frames with pauses between
             them, making it an animation.<a href="#section-2.1-3.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<div id="terminology-amp-basics">
<section id="section-2.2">
        <h3 id="name-terminology-basics">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-terminology-basics" class="section-name selfRef">Terminology &amp; Basics</a>
        </h3>
<p id="section-2.2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">A WebP file contains either a still image (that is, an encoded matrix of
         pixels) or an <span><a href="#animation" class="internal xref">animation</a> (<a href="#animation" class="auto internal xref">Section 2.7.1.1</a>)</span>. Optionally,
           it can also contain transparency information, a color profile, and
           metadata. We refer to the matrix of pixels as the <em>canvas</em> of the
           image.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Bit numbering in chunk diagrams starts at <code>0</code> for the most
         significant bit ('MSB 0'), as described in <span>[<a href="#RFC1166" class="cite xref">RFC1166</a>]</span>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Below are additional terms used throughout this section:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.2-5">
          <dt id="section-2.2-5.1">Reader/Writer</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.2">Code that reads WebP files is referred to as a <em>reader</em>,
           while code that writes them is referred to as a
         <em>writer</em>.<a href="#section-2.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.3">uint16</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.4">A 16-bit, little-endian, unsigned integer.<a href="#section-2.2-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.5">uint24</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.6">A 24-bit, little-endian, unsigned integer.<a href="#section-2.2-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.7">uint32</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.8">A 32-bit, little-endian, unsigned integer.<a href="#section-2.2-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.9">FourCC</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.10">A four-character code (FourCC) is a uint32 created by
           concatenating four ASCII characters in little-endian order. This
           means 'aaaa' (0x61616161) and 'AAAA' (0x41414141) are treated as
           different FourCCs.<a href="#section-2.2-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.11">1-based</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.12">An unsigned integer field storing values offset by -1, for example, such
           a field would store value <em>25</em> as <em>24</em>.<a href="#section-2.2-5.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.13">ChunkHeader('ABCD')</dt>
          <dd style="margin-left: 2.0em" id="section-2.2-5.14">Used to describe the <em>FourCC</em> and <em>Chunk
           Size</em> header of individual chunks, where 'ABCD' is the FourCC
             for the chunk. This element's size is 8 bytes.<a href="#section-2.2-5.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="riff-file-format">
<section id="section-2.3">
        <h3 id="name-riff-file-format">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-riff-file-format" class="section-name selfRef">RIFF File Format</a>
        </h3>
<p id="section-2.3-1">The WebP file format is based on the <span><a href="#RIFF-spec" class="internal xref">RIFF</a> [<a href="#RIFF-spec" class="cite xref">RIFF-spec</a>]</span>
           document format.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The basic element of a RIFF file is a <em>chunk</em>. It consists
         of:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<span id="name-riff-chunk-structure"></span><figure id="figure-1">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-2.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Chunk FourCC                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Chunk Size                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                         Chunk Payload                         :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-riff-chunk-structure" class="selfRef">'RIFF' Chunk Structure</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.3-4">
          <dt id="section-2.3-4.1">Chunk FourCC: 32 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.3-4.2">ASCII four-character code used for chunk identification.<a href="#section-2.3-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.3">Chunk Size: 32 bits (<em>uint32</em>)</dt>
          <dd style="margin-left: 2.0em" id="section-2.3-4.4">The size of the chunk in bytes, not including this field, the
             chunk identifier, or padding.<a href="#section-2.3-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.5">Chunk Payload: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 2.0em" id="section-2.3-4.6">The data payload. If <em>Chunk Size</em> is odd, a single
             padding byte -- which <span class="bcp14">MUST</span> be <code>0</code> to conform with <span><a href="#RIFF-spec" class="internal xref">RIFF</a> [<a href="#RIFF-spec" class="cite xref">RIFF-spec</a>]</span> -- is added.<a href="#section-2.3-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<aside id="section-2.3-5">
          <p id="section-2.3-5.1">Note: RIFF has a convention that all uppercase chunk FourCCs are
           standard chunks that apply to any RIFF file format, while FourCCs
           specific to a file format are all lowercase. WebP does not follow
           this convention.<a href="#section-2.3-5.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<section id="section-2.4">
        <h3 id="name-webp-file-header">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-webp-file-header" class="section-name selfRef">WebP File Header</a>
        </h3>
<span id="name-webp-file-header-chunk"></span><figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.4-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      'R'      |      'I'      |      'F'      |      'F'      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           File Size                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      'W'      |      'E'      |      'B'      |      'P'      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-webp-file-header-chunk" class="selfRef">WebP File Header Chunk</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.4-2">
          <dt id="section-2.4-2.1">'RIFF': 32 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.4-2.2">The ASCII characters 'R', 'I', 'F', 'F'.<a href="#section-2.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.3">File Size: 32 bits (<em>uint32</em>)</dt>
          <dd style="margin-left: 2.0em" id="section-2.4-2.4">The size of the file in bytes, starting at offset 8. The maximum
           value of this field is 2<sup>32</sup> minus 10 bytes, and thus the size of the
           whole file is at most 4 GiB minus 2 bytes.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-2.5">'WEBP': 32 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.4-2.6">The ASCII characters 'W', 'E', 'B', 'P'.<a href="#section-2.4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.4-3">A WebP file <span class="bcp14">MUST</span> begin with a RIFF header with the FourCC 'WEBP'. The
         file size in the header is the total size of the chunks that follow
         plus <code>4</code> bytes for the 'WEBP' FourCC. The file <span class="bcp14">SHOULD NOT</span>
         contain any data after the data specified by <em>File Size</em>.
         Readers <span class="bcp14">MAY</span> parse such files, ignoring the trailing data. As the size
         of any chunk is even, the size given by the RIFF header is also even.
         The contents of individual chunks are described in the following
         sections.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
<div id="simple-file-format-lossy">
<section id="section-2.5">
        <h3 id="name-simple-file-format-lossy">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-simple-file-format-lossy" class="section-name selfRef">Simple File Format (Lossy)</a>
        </h3>
<p id="section-2.5-1">This layout <span class="bcp14">SHOULD</span> be used if the image requires lossy encoding and
         does not require transparency or other advanced features provided by
         the extended format. Files with this layout are smaller and supported
       by older software.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<span id="name-simple-webp-lossy-file-form"></span><figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-2.5-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                    WebP file header (12 bytes)                |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                        'VP8 ' Chunk                           :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-simple-webp-lossy-file-form" class="selfRef">Simple WebP (Lossy) File Format</a>
          </figcaption></figure>
<span id="name-vp8-chunk"></span><figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-2.5-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8 ')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                           VP8 data                            :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-vp8-chunk" class="selfRef">'VP8 ' Chunk</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.5-4">
          <dt id="section-2.5-4.1">VP8 data: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 2.0em" id="section-2.5-4.2">VP8 bitstream data.<a href="#section-2.5-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<aside id="section-2.5-5">
          <p id="section-2.5-5.1">Note that the fourth character in the 'VP8 ' FourCC is an ASCII space
        (0x20).<a href="#section-2.5-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.5-6">The VP8 bitstream format specification is described in <span>[<a href="#RFC6386" class="cite xref">RFC6386</a>]</span>.<a href="#section-2.5-6" class="pilcrow">¶</a></p>
<aside id="section-2.5-7">
          <p id="section-2.5-7.1">Note that the VP8 frame header contains the VP8
        frame width and height. That is assumed to be the width and height of
        the canvas.<a href="#section-2.5-7.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.5-8">The VP8 specification describes how to decode the image into Y'CbCr
        format. To convert to RGB, <span><a href="#REC601" class="internal xref">Recommendation 601</a> [<a href="#REC601" class="cite xref">REC601</a>]</span> <span class="bcp14">SHOULD</span>
          be used. Applications <span class="bcp14">MAY</span> use another conversion method, but visual
          results may differ among decoders.<a href="#section-2.5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="simple-file-format-lossless">
<section id="section-2.6">
        <h3 id="name-simple-file-format-lossless">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-simple-file-format-lossless" class="section-name selfRef">Simple File Format (Lossless)</a>
        </h3>
<aside id="section-2.6-1">
          <p id="section-2.6-1.1">Note: Older readers may not support files using the lossless
         format.<a href="#section-2.6-1.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.6-2">This layout <span class="bcp14">SHOULD</span> be used if the image requires lossless encoding
         (with an optional transparency channel) and does not require advanced
       features provided by the extended format.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<span id="name-simple-webp-lossless-file-f"></span><figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-2.6-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                    WebP file header (12 bytes)                |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                         'VP8L' Chunk                          :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-simple-webp-lossless-file-f" class="selfRef">Simple WebP (Lossless) File Format</a>
          </figcaption></figure>
<span id="name-vp8l-chunk"></span><figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-2.6-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8L')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                           VP8L data                           :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-vp8l-chunk" class="selfRef">'VP8L' Chunk</a>
          </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.6-5">
          <dt id="section-2.6-5.1">VP8L data: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 2.0em" id="section-2.6-5.2">VP8L bitstream data.<a href="#section-2.6-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.6-6">The specification of the VP8L bitstream can be found in <a href="#webp-lossless" class="auto internal xref">Section 3</a>.<a href="#section-2.6-6" class="pilcrow">¶</a></p>
<aside id="section-2.6-7">
          <p id="section-2.6-7.1">Note that the VP8L header contains the
         VP8L image width and height. That is assumed to be the width and
         height of the canvas.<a href="#section-2.6-7.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="ext-file-form">
<section id="section-2.7">
        <h3 id="name-extended-file-format">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-extended-file-format" class="section-name selfRef">Extended File Format</a>
        </h3>
<aside id="section-2.7-1">
          <p id="section-2.7-1.1">Note: Older readers may not support files using the extended
         format.<a href="#section-2.7-1.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.7-2">An extended format file consists of:<a href="#section-2.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7-3.1">A 'VP8X' Chunk with information about features used in the
           file.<a href="#section-2.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.2">An optional 'ICCP' Chunk with a color profile.<a href="#section-2.7-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.3">An optional 'ANIM' Chunk with animation control data.<a href="#section-2.7-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.4">Image data.<a href="#section-2.7-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.5">An optional 'EXIF' Chunk with Exif metadata.<a href="#section-2.7-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.6">An optional 'XMP ' Chunk with XMP metadata.<a href="#section-2.7-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-3.7">An optional list of <span><a href="#unknown-chunks" class="internal xref">unknown
           chunks</a> (<a href="#unknown-chunks" class="auto internal xref">Section 2.7.1.6</a>)</span>.<a href="#section-2.7-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.7-4">For a <em>still image</em>, the <em>image data</em> consists of a
         single frame, which is made up of:<a href="#section-2.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7-5.1">An optional <span><a href="#alpha" class="internal xref">alpha subchunk</a> (<a href="#alpha" class="auto internal xref">Section 2.7.1.2</a>)</span>.<a href="#section-2.7-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-5.2">A <span><a href="#bitstream-vp8vp8l" class="internal xref">bitstream subchunk</a> (<a href="#bitstream-vp8vp8l" class="auto internal xref">Section 2.7.1.3</a>)</span>.<a href="#section-2.7-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.7-6">For an <em>animated image</em>, the <em>image data</em> consists of
         multiple frames. More details about frames can be found in <a href="#animation" class="auto internal xref">Section 2.7.1.1</a>.<a href="#section-2.7-6" class="pilcrow">¶</a></p>
<p id="section-2.7-7">All chunks necessary for reconstruction and color correction, that is,
         'VP8X', 'ICCP', 'ANIM', 'ANMF', 'ALPH', 'VP8 ', and 'VP8L',
         <span class="bcp14">MUST</span> appear in the order described earlier. Readers
         <span class="bcp14">SHOULD</span> fail when chunks necessary for reconstruction and
         color correction are out of order.<a href="#section-2.7-7" class="pilcrow">¶</a></p>
<p id="section-2.7-8"><span><a href="#metadata" class="internal xref">Metadata</a> (<a href="#metadata" class="auto internal xref">Section 2.7.1.5</a>)</span> and <span><a href="#unknown-chunks" class="internal xref">unknown chunks</a> (<a href="#unknown-chunks" class="auto internal xref">Section 2.7.1.6</a>)</span> MAY appear out of
           order.<a href="#section-2.7-8" class="pilcrow">¶</a></p>
<aside id="section-2.7-9">
          <p id="section-2.7-9.1">Rationale: The chunks necessary for reconstruction should
         appear first in the file to allow a reader to begin decoding an image
         before receiving all of the data. An application may benefit from
         varying the order of metadata and custom chunks to suit the
         implementation.<a href="#section-2.7-9.1" class="pilcrow">¶</a></p>
</aside>
<span id="name-extended-webp-file-header"></span><div id="extended_header">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-2.7-10.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                   WebP file header (12 bytes)                 |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8X')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Rsv|I|L|E|X|A|R|                   Reserved                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Canvas Width Minus One               |             ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...  Canvas Height Minus One    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-extended-webp-file-header" class="selfRef">Extended WebP File Header</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlNewline" id="section-2.7-11">
          <dt id="section-2.7-11.1">Reserved (Rsv): 2 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.2">
            <span class="bcp14">MUST</span> be <code>0</code>. Readers <span class="bcp14">MUST</span> ignore this field.<a href="#section-2.7-11.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.3">ICC profile (I): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.4">Set if the file contains an 'ICCP' Chunk.<a href="#section-2.7-11.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.5">Alpha (L): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.6">Set if any of the frames of the image contain transparency
           information ("alpha").<a href="#section-2.7-11.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.7">Exif metadata (E): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.8">Set if the file contains Exif metadata.<a href="#section-2.7-11.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.9">XMP metadata (X): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.10">Set if the file contains XMP metadata.<a href="#section-2.7-11.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.11">Animation (A): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.12">Set if this is an animated image. Data in 'ANIM' and 'ANMF' Chunks
           should be used to control the animation.<a href="#section-2.7-11.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.13">Reserved (R): 1 bit</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.14">
            <span class="bcp14">MUST</span> be <code>0</code>. Readers <span class="bcp14">MUST</span> ignore this field.<a href="#section-2.7-11.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.15">Reserved: 24 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.16">
            <span class="bcp14">MUST</span> be <code>0</code>. Readers <span class="bcp14">MUST</span> ignore this field.<a href="#section-2.7-11.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.17">Canvas Width Minus One: 24 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.18">
            <em>1-based</em> width of the canvas in pixels. The actual canvas
           width is <code>1 + Canvas Width Minus One</code>.<a href="#section-2.7-11.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-11.19">Canvas Height Minus One: 24 bits</dt>
          <dd style="margin-left: 2.0em" id="section-2.7-11.20">
            <em>1-based</em> height of the canvas in pixels. The actual canvas
           height is <code>1 + Canvas Height Minus One</code>.<a href="#section-2.7-11.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.7-12">The product of <em>Canvas Width</em> and <em>Canvas Height</em> <span class="bcp14">MUST</span>
         be at most <code>2<sup>32</sup> - 1</code>.<a href="#section-2.7-12" class="pilcrow">¶</a></p>
<p id="section-2.7-13">Future specifications may add more fields. Unknown fields <span class="bcp14">MUST</span> be
         ignored.<a href="#section-2.7-13" class="pilcrow">¶</a></p>
<section id="section-2.7.1">
          <h4 id="name-chunks">
<a href="#section-2.7.1" class="section-number selfRef">2.7.1. </a><a href="#name-chunks" class="section-name selfRef">Chunks</a>
          </h4>
<div id="animation">
<section id="section-2.7.1.1">
            <h5 id="name-animation">
<a href="#section-2.7.1.1" class="section-number selfRef">2.7.1.1. </a><a href="#name-animation" class="section-name selfRef">Animation</a>
            </h5>
<p id="section-2.7.1.1-1">An animation is controlled by 'ANIM' and 'ANMF' Chunks.<a href="#section-2.7.1.1-1" class="pilcrow">¶</a></p>
<span id="name-anim-chunk"></span><div id="anim_chunk">
<figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-2.7.1.1-2.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ANIM')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Background Color                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Loop Count           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-anim-chunk" class="selfRef">'ANIM' Chunk</a>
              </figcaption></figure>
</div>
<p id="section-2.7.1.1-3">For an animated image, this chunk contains the <em>global
             parameters</em> of the animation.<a href="#section-2.7.1.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.1-4">
              <dt id="section-2.7.1.1-4.1">Background Color: 32 bits (<em>uint32</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-4.2">
                <p id="section-2.7.1.1-4.2.1">The default background color of the canvas in [Blue, Green,
                 Red, Alpha] byte order. This color <span class="bcp14">MAY</span> be used to fill the
                 unused space on the canvas around the frames, as well as the
                 transparent pixels of the first frame. The background color is
                 also used when the Disposal method is <code>1</code>.<a href="#section-2.7.1.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-2.7.1.1-4.2.2">Notes:<a href="#section-2.7.1.1-4.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.1-4.2.3.1">The background color <span class="bcp14">MAY</span> contain a nonopaque alpha value,
                   even if the <em>Alpha</em> flag in the <span><a href="#extended_header" class="internal xref">'VP8X' Chunk</a> (<a href="#extended_header" class="auto internal xref">Figure 7</a>)</span> is unset.<a href="#section-2.7.1.1-4.2.3.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-4.2.3.2">Viewer applications <span class="bcp14">SHOULD</span> treat the background color value
                   as a hint and are not required to use it.<a href="#section-2.7.1.1-4.2.3.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-4.2.3.3">The canvas is cleared at the start of each loop. The
                   background color <span class="bcp14">MAY</span> be used to achieve this.<a href="#section-2.7.1.1-4.2.3.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-4.3">Loop Count: 16 bits (<em>uint16</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-4.4">The number of times to loop the animation. If it is <code>0</code>, this means
               infinitely.<a href="#section-2.7.1.1-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-2.7.1.1-5">This chunk <span class="bcp14">MUST</span> appear if the <em>Animation</em> flag in the 'VP8X'
             Chunk is set. If the <em>Animation</em> flag is not set and this
               chunk is present, it <span class="bcp14">MUST</span> be ignored.<a href="#section-2.7.1.1-5" class="pilcrow">¶</a></p>
<span id="name-anmf-chunk"></span><figure id="figure-9">
              <div class="alignLeft art-text artwork" id="section-2.7.1.1-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ANMF')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Frame X                |             ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...          Frame Y            |   Frame Width Minus One     ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...             |           Frame Height Minus One              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Frame Duration                |  Reserved |B|D|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                         Frame Data                            :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-anmf-chunk" class="selfRef">'ANMF' Chunk</a>
              </figcaption></figure>
<p id="section-2.7.1.1-7">For animated images, this chunk contains information about a
             <em>single</em> frame. If the <em>Animation flag</em> is not set,
               then this chunk <span class="bcp14">SHOULD NOT</span> be present.<a href="#section-2.7.1.1-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.1-8">
              <dt id="section-2.7.1.1-8.1">Frame X: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.2">The X coordinate of the upper left corner of the frame is
                <code>Frame X * 2</code>.<a href="#section-2.7.1.1-8.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.3">Frame Y: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.4">The Y coordinate of the upper left corner of the frame is
                 <code>Frame Y * 2</code>.<a href="#section-2.7.1.1-8.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.5">Frame Width Minus One: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.6">The <em>1-based</em> width of the frame. The frame width is
                 <code>1 + Frame Width Minus One</code>.<a href="#section-2.7.1.1-8.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.7">Frame Height Minus One: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.8">The <em>1-based</em> height of the frame. The frame height
                 is <code>1 + Frame Height Minus One</code>.<a href="#section-2.7.1.1-8.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.9">Frame Duration: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.10">The time to wait before displaying the next frame, in
         1-millisecond units. Note that the interpretation of the Frame Duration
                 of 0 (and often &lt;= 10) is defined by the implementation. Many
                 tools and browsers assign a minimum duration similar to
                 GIF.<a href="#section-2.7.1.1-8.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.11">Reserved: 6 bits</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.12">
                <span class="bcp14">MUST</span> be <code>0</code>. Readers <span class="bcp14">MUST</span> ignore this field.<a href="#section-2.7.1.1-8.12" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.13">Blending method (B): 1 bit</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.14">
                <p id="section-2.7.1.1-8.14.1">Indicates how transparent pixels of <em>the current
                 frame</em> are to be blended with corresponding pixels of the
                   previous canvas:<a href="#section-2.7.1.1-8.14.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.1-8.14.2.1">
                    <code>0</code>: Use alpha-blending. After disposing of the
                     previous frame, render the current frame on the canvas
                     using <a href="#alpha-blending" class="internal xref">alpha-blending</a>.
                       If the current frame does not have an alpha channel,
                       assume the alpha value is 255, effectively replacing the
                       rectangle.<a href="#section-2.7.1.1-8.14.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-8.14.2.2">
                    <code>1</code>: Do not blend. After disposing of the
                     previous frame, render the current frame on the canvas by
                     overwriting the rectangle covered by the current
                     frame.<a href="#section-2.7.1.1-8.14.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.15">Disposal method (D): 1 bit</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.16">
                <p id="section-2.7.1.1-8.16.1">Indicates how <em>the current frame</em> is to be treated
                 after it has been displayed (before rendering the next frame)
                 on the canvas:<a href="#section-2.7.1.1-8.16.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.1-8.16.2.1">
                    <code>0</code>: Do not dispose. Leave the canvas as is.<a href="#section-2.7.1.1-8.16.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-8.16.2.2">
                    <code>1</code>: Dispose to the background color. Fill the
                     <em>rectangle</em> on the canvas covered by the <em>current
                     frame</em> with the background color specified in the <span><a href="#anim_chunk" class="internal xref">'ANIM' Chunk</a> (<a href="#anim_chunk" class="auto internal xref">Figure 8</a>)</span>.<a href="#section-2.7.1.1-8.16.2.2" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-2.7.1.1-8.16.3">Notes:<a href="#section-2.7.1.1-8.16.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.1-8.16.4.1">The frame disposal only applies to the <em>frame
                     rectangle</em>, that is, the rectangle defined by
                     <em>Frame X</em>, <em>Frame Y</em>, <em>frame width</em>,
                     and <em>frame height</em>. It may or may not cover the
                   whole canvas.<a href="#section-2.7.1.1-8.16.4.1" class="pilcrow">¶</a>
</li>
                  <li id="section-2.7.1.1-8.16.4.2" class="normal">
<div class="normal" id="alpha-blending">
                    <p id="section-2.7.1.1-8.16.4.2.1">Alpha-blending:<a href="#section-2.7.1.1-8.16.4.2.1" class="pilcrow">¶</a></p>
<p id="section-2.7.1.1-8.16.4.2.2">Given that each of the R, G, B, and A channels is 8 bits
                       and the RGB channels are <em>not premultiplied</em> by
                       alpha, the formula for blending 'dst' onto 'src' is:<a href="#section-2.7.1.1-8.16.4.2.2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.7.1.1-8.16.4.2.3">
<pre>
blend.A = src.A + dst.A * (1 - src.A / 255)
if blend.A = 0 then
  blend.RGB = 0
else
  blend.RGB =
      (src.RGB * src.A +
       dst.RGB * dst.A * (1 - src.A / 255)) / blend.A
</pre><a href="#section-2.7.1.1-8.16.4.2.3" class="pilcrow">¶</a>
</div>
</div>
                  </li>
<li class="normal" id="section-2.7.1.1-8.16.4.3">Alpha-blending <span class="bcp14">SHOULD</span> be done in linear color space by
                     taking into account the <span><a href="#color-profile" class="internal xref">color
                       profile</a> (<a href="#color-profile" class="auto internal xref">Section 2.7.1.4</a>)</span> of the image. If the color profile is not
                         present, standard RGB (sRGB) is to be assumed. (Note that sRGB also
                         needs to be linearized due to a gamma of ~2.2.)<a href="#section-2.7.1.1-8.16.4.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.1-8.17">Frame Data: <em>Chunk Size</em> bytes - <code>16</code>
</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.1-8.18">
                <p id="section-2.7.1.1-8.18.1">Consists of:<a href="#section-2.7.1.1-8.18.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.1-8.18.2.1">An optional <span><a href="#alpha" class="internal xref">alpha subchunk</a> (<a href="#alpha" class="auto internal xref">Section 2.7.1.2</a>)</span>
                       for the frame.<a href="#section-2.7.1.1-8.18.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-8.18.2.2">A <span><a href="#bitstream-vp8vp8l" class="internal xref">bitstream
                     subchunk</a> (<a href="#bitstream-vp8vp8l" class="auto internal xref">Section 2.7.1.3</a>)</span> for the frame.<a href="#section-2.7.1.1-8.18.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.1-8.18.2.3">An optional list of <span><a href="#unknown-chunks" class="internal xref">unknown chunks</a> (<a href="#unknown-chunks" class="auto internal xref">Section 2.7.1.6</a>)</span>.<a href="#section-2.7.1.1-8.18.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
<aside id="section-2.7.1.1-9">
              <p id="section-2.7.1.1-9.1">Note: The 'ANMF' payload, <em>Frame Data</em>, consists
               of individual <em>padded</em> chunks, as described by the <span><a href="#riff-file-format" class="internal xref">RIFF file format</a> (<a href="#riff-file-format" class="auto internal xref">Section 2.3</a>)</span>.<a href="#section-2.7.1.1-9.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="alpha">
<section id="section-2.7.1.2">
            <h5 id="name-alpha">
<a href="#section-2.7.1.2" class="section-number selfRef">2.7.1.2. </a><a href="#name-alpha" class="section-name selfRef">Alpha</a>
            </h5>
<span id="name-alph-chunk"></span><figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-2.7.1.2-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ALPH')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Rsv| P | F | C |     Alpha Bitstream...                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-alph-chunk" class="selfRef">'ALPH' Chunk</a>
              </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.2-2">
              <dt id="section-2.7.1.2-2.1">Reserved (Rsv): 2 bits</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.2-2.2">
                <span class="bcp14">MUST</span> be <code>0</code>. Readers <span class="bcp14">MUST</span> ignore this field.<a href="#section-2.7.1.2-2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.2-2.3">Preprocessing (P): 2 bits</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.2-2.4">
                <p id="section-2.7.1.2-2.4.1">These informative bits are used to signal the
               preprocessing that has been performed during compression. The
               decoder can use this information to, for example, dither the values or
               smooth the gradients prior to display.<a href="#section-2.7.1.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.4.2.1">
                    <code>0</code>: No preprocessing.<a href="#section-2.7.1.2-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.4.2.2">
                    <code>1</code>: Level reduction.<a href="#section-2.7.1.2-2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-2.7.1.2-2.4.3">Decoders are not required to use this information in any
                 specified way.<a href="#section-2.7.1.2-2.4.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.2-2.5">Filtering method (F): 2 bits</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.2-2.6">
                <p id="section-2.7.1.2-2.6.1">The filtering methods used are described as follows:<a href="#section-2.7.1.2-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.6.2.1">
                    <code>0</code>: None.<a href="#section-2.7.1.2-2.6.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.2.2">
                    <code>1</code>: Horizontal filter.<a href="#section-2.7.1.2-2.6.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.2.3">
                    <code>2</code>: Vertical filter.<a href="#section-2.7.1.2-2.6.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.2.4">
                    <code>3</code>: Gradient filter.<a href="#section-2.7.1.2-2.6.2.4" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-2.7.1.2-2.6.3">For each pixel, filtering is performed using the following
                 calculations. Assume the alpha values surrounding the current
               <code>X</code> position are labeled as:<a href="#section-2.7.1.2-2.6.3" class="pilcrow">¶</a></p>
<span id="name-pixels-used-in-alpha-filter"></span><figure id="figure-11">
                  <div class="alignLeft art-text artwork" id="section-2.7.1.2-2.6.4.1">
<pre>
 C | B |
---+---+
 A | X |
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-pixels-used-in-alpha-filter" class="selfRef">Pixels Used in Alpha Filtering</a>
                  </figcaption></figure>
<p id="section-2.7.1.2-2.6.5">We seek to compute the alpha value at position X. First, a
                 prediction is made depending on the filtering method:<a href="#section-2.7.1.2-2.6.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.6.6.1">Method <code>0</code>: predictor = 0<a href="#section-2.7.1.2-2.6.6.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.6.2">Method <code>1</code>: predictor = A<a href="#section-2.7.1.2-2.6.6.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.6.3">Method <code>2</code>: predictor = B<a href="#section-2.7.1.2-2.6.6.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.6.4">Method <code>3</code>: predictor = clip(A + B - C)<a href="#section-2.7.1.2-2.6.6.4" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-2.7.1.2-2.6.7">where <code>clip(v)</code> is equal to:<a href="#section-2.7.1.2-2.6.7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.6.8.1">0    if v &lt; 0,<a href="#section-2.7.1.2-2.6.8.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.8.2">255  if v &gt; 255, or<a href="#section-2.7.1.2-2.6.8.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.8.3">v    otherwise.<a href="#section-2.7.1.2-2.6.8.3" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-2.7.1.2-2.6.9">The final value is derived by adding the decompressed value
                 <code>X</code> to the predictor and using modulo-256 arithmetic to
                 wrap the [256..511] range into the [0..255] one:<a href="#section-2.7.1.2-2.6.9" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-2.7.1.2-2.6.10">
<pre>
alpha = (predictor + X) % 256
</pre><a href="#section-2.7.1.2-2.6.10" class="pilcrow">¶</a>
</div>
<p id="section-2.7.1.2-2.6.11">There are special cases for the left-most and top-most pixel
                 positions.<a href="#section-2.7.1.2-2.6.11" class="pilcrow">¶</a></p>
<p id="section-2.7.1.2-2.6.12">For example, the top-left value at location (0, 0) uses 0 as the predictor
                 value. Otherwise:<a href="#section-2.7.1.2-2.6.12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.6.13.1">For horizontal or gradient filtering methods, the
                   left-most pixels at location (0, y) are predicted using the
                   location (0, y-1) just above.<a href="#section-2.7.1.2-2.6.13.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.6.13.2">For vertical or gradient filtering methods, the top-most
                   pixels at location (x, 0) are predicted using the location
                   (x-1, 0) on the left.<a href="#section-2.7.1.2-2.6.13.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.2-2.7">Compression method (C): 2 bits</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.2-2.8">
                <p id="section-2.7.1.2-2.8.1">The compression method used:<a href="#section-2.7.1.2-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-2.8.2.1">
                    <code>0</code>: No compression.<a href="#section-2.7.1.2-2.8.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.7.1.2-2.8.2.2">
                    <code>1</code>: Compressed using the WebP lossless format.<a href="#section-2.7.1.2-2.8.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-2.7.1.2-2.9">Alpha bitstream: <em>Chunk Size</em> bytes - <code>1</code>
</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.2-2.10">Encoded alpha bitstream.<a href="#section-2.7.1.2-2.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-2.7.1.2-3">This optional chunk contains encoded alpha data for this frame. A
             frame containing a 'VP8L' Chunk <span class="bcp14">SHOULD NOT</span> contain this chunk.<a href="#section-2.7.1.2-3" class="pilcrow">¶</a></p>
<aside id="section-2.7.1.2-4">
              <p id="section-2.7.1.2-4.1">Rationale: The transparency information is already part of the
             'VP8L' Chunk.<a href="#section-2.7.1.2-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.7.1.2-5">The alpha channel data is stored as uncompressed raw data
             (when the compression method is '0') or compressed using the
           lossless format (when the compression method is '1').<a href="#section-2.7.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.2-6.1">Raw data: This consists of a byte sequence of length = width *
               height, containing all the 8-bit transparency values in scan
               order.<a href="#section-2.7.1.2-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.7.1.2-6.2">
                <p id="section-2.7.1.2-6.2.1">Lossless format compression: The byte sequence is a
               compressed image-stream (as described in <a href="#webp-lossless" class="auto internal xref">Section 3</a>) of implicit dimensions width x
                 height. That is, this image-stream does NOT contain any
             headers describing the image dimensions.<a href="#section-2.7.1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<aside id="section-2.7.1.2-7">
              <p id="section-2.7.1.2-7.1">Rationale: The dimensions are already known from other sources,
             so storing them again would be redundant and prone to errors.<a href="#section-2.7.1.2-7.1" class="pilcrow">¶</a></p>
</aside>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.7.1.2-8.1">
                <p id="section-2.7.1.2-8.1.1">Once the image-stream is decoded into Alpha, Red, Green, Blue (ARGB) color values,
               following the process described in the lossless format
               specification, the transparency information must be extracted
               from the green channel of the ARGB quadruplet.<a href="#section-2.7.1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<aside id="section-2.7.1.2-9">
              <p id="section-2.7.1.2-9.1">Rationale: The green channel is allowed extra transformation
               steps in the specification -- unlike the other channels -- that
               can improve compression.<a href="#section-2.7.1.2-9.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="bitstream-vp8vp8l">
<section id="section-2.7.1.3">
            <h5 id="name-bitstream-vp8-vp8l">
<a href="#section-2.7.1.3" class="section-number selfRef">2.7.1.3. </a><a href="#name-bitstream-vp8-vp8l" class="section-name selfRef">Bitstream (VP8/VP8L)</a>
            </h5>
<p id="section-2.7.1.3-1">This chunk contains compressed bitstream data for a single
             frame.<a href="#section-2.7.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.7.1.3-2">A bitstream chunk may be either (i) a 'VP8 ' Chunk, using 'VP8 '
             (note the significant fourth-character space) as its FourCC,
           <em>or</em> (ii) a 'VP8L' Chunk, using 'VP8L' as its FourCC.<a href="#section-2.7.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.7.1.3-3">The formats of' VP8 ' and 'VP8L' Chunks are as described in Sections <a href="#simple-file-format-lossy" class="auto internal xref">2.5</a> and <a href="#simple-file-format-lossless" class="auto internal xref">2.6</a>, respectively.<a href="#section-2.7.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="color-profile">
<section id="section-2.7.1.4">
            <h5 id="name-color-profile">
<a href="#section-2.7.1.4" class="section-number selfRef">2.7.1.4. </a><a href="#name-color-profile" class="section-name selfRef">Color Profile</a>
            </h5>
<span id="name-iccp-chunk"></span><figure id="figure-12">
              <div class="alignLeft art-text artwork" id="section-2.7.1.4-1.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ICCP')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                       Color Profile                           :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-iccp-chunk" class="selfRef">'ICCP' Chunk</a>
              </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.4-2">
              <dt id="section-2.7.1.4-2.1">Color Profile: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.4-2.2">ICC profile.<a href="#section-2.7.1.4-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-2.7.1.4-3">This chunk <span class="bcp14">MUST</span> appear before the image data.<a href="#section-2.7.1.4-3" class="pilcrow">¶</a></p>
<p id="section-2.7.1.4-4">There <span class="bcp14">SHOULD</span> be at most one such chunk. If there are more such
             chunks, readers <span class="bcp14">MAY</span> ignore all except the first one. See the <span><a href="#ICC" class="internal xref">ICC specification</a> [<a href="#ICC" class="cite xref">ICC</a>]</span> for details.<a href="#section-2.7.1.4-4" class="pilcrow">¶</a></p>
<p id="section-2.7.1.4-5">If this chunk is not present, sRGB <span class="bcp14">SHOULD</span> be assumed.<a href="#section-2.7.1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata">
<section id="section-2.7.1.5">
            <h5 id="name-metadata">
<a href="#section-2.7.1.5" class="section-number selfRef">2.7.1.5. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
            </h5>
<p id="section-2.7.1.5-1">Metadata can be stored in 'EXIF' or 'XMP ' Chunks.<a href="#section-2.7.1.5-1" class="pilcrow">¶</a></p>
<p id="section-2.7.1.5-2">There <span class="bcp14">SHOULD</span> be at most one chunk of each type ('EXIF' and 'XMP '). If there are more such chunks, readers <span class="bcp14">MAY</span> ignore all except
             the first one.<a href="#section-2.7.1.5-2" class="pilcrow">¶</a></p>
<p id="section-2.7.1.5-3">The chunks are defined as follows:<a href="#section-2.7.1.5-3" class="pilcrow">¶</a></p>
<span id="name-exif-chunk"></span><figure id="figure-13">
              <div class="alignLeft art-text artwork" id="section-2.7.1.5-4.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('EXIF')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                        Exif Metadata                          :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-exif-chunk" class="selfRef">'EXIF' Chunk</a>
              </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.5-5">
              <dt id="section-2.7.1.5-5.1">Exif Metadata: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.5-5.2">Image metadata in <span>[<a href="#Exif" class="cite xref">Exif</a>]</span> format.<a href="#section-2.7.1.5-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<span id="name-xmp-chunk"></span><figure id="figure-14">
              <div class="alignLeft art-text artwork" id="section-2.7.1.5-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('XMP ')                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                        XMP Metadata                           :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-xmp-chunk" class="selfRef">'XMP ' Chunk</a>
              </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-2.7.1.5-7">
              <dt id="section-2.7.1.5-7.1">XMP Metadata: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 2.0em" id="section-2.7.1.5-7.2">Image metadata in <span>[<a href="#XMP" class="cite xref">XMP</a>]</span> format.<a href="#section-2.7.1.5-7.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<aside id="section-2.7.1.5-8">
              <p id="section-2.7.1.5-8.1">Note that the fourth character in the 'XMP ' FourCC is an ASCII space
             (0x20).<a href="#section-2.7.1.5-8.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.7.1.5-9">Additional guidance about handling metadata can be found in the
             Metadata Working Group's <span><a href="#MWG" class="internal xref">"Guidelines For
               Handling Image Metadata"</a> [<a href="#MWG" class="cite xref">MWG</a>]</span>.<a href="#section-2.7.1.5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unknown-chunks">
<section id="section-2.7.1.6">
            <h5 id="name-unknown-chunks">
<a href="#section-2.7.1.6" class="section-number selfRef">2.7.1.6. </a><a href="#name-unknown-chunks" class="section-name selfRef">Unknown Chunks</a>
            </h5>
<p id="section-2.7.1.6-1">A RIFF chunk (described in <a href="#riff-file-format" class="auto internal xref">Section 2.3</a>) whose <em>FourCC</em> is
               different from any of the chunks described in this section is
               considered an <em>unknown chunk</em>.<a href="#section-2.7.1.6-1" class="pilcrow">¶</a></p>
<aside id="section-2.7.1.6-2">
              <p id="section-2.7.1.6-2.1">Rationale: Allowing unknown chunks gives a provision for
             future extension of the format and also allows storage of any
             application-specific data.<a href="#section-2.7.1.6-2.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-2.7.1.6-3">A file <span class="bcp14">MAY</span> contain unknown chunks:<a href="#section-2.7.1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7.1.6-4.1">at the end of the file, as described in <a href="#ext-file-form" class="auto internal xref">Section 2.7</a>, or<a href="#section-2.7.1.6-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.7.1.6-4.2">at the end of 'ANMF' Chunks, as described in <a href="#animation" class="auto internal xref">Section 2.7.1.1</a>.<a href="#section-2.7.1.6-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-2.7.1.6-5">Readers <span class="bcp14">SHOULD</span> ignore these chunks. Writers <span class="bcp14">SHOULD</span> preserve them
             in their original order (unless they specifically intend to modify
             these chunks).<a href="#section-2.7.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-2.7.2">
          <h4 id="name-canvas-assembly-from-frames">
<a href="#section-2.7.2" class="section-number selfRef">2.7.2. </a><a href="#name-canvas-assembly-from-frames" class="section-name selfRef">Canvas Assembly from Frames</a>
          </h4>
<p id="section-2.7.2-1">Here, we provide an overview of how a reader <span class="bcp14">MUST</span> assemble a canvas
         in the case of an animated image.<a href="#section-2.7.2-1" class="pilcrow">¶</a></p>
<p id="section-2.7.2-2">The process begins with creating a canvas using the dimensions
           given in the 'VP8X' Chunk, <code>Canvas Width Minus One + 1</code>
           pixels wide by <code>Canvas Height Minus One + 1</code> pixels high.
           The <code>Loop Count</code> field from the 'ANIM' Chunk controls how
           many times the animation process is repeated. This is <code>Loop
           Count - 1</code> for nonzero <code>Loop Count</code> values or
           infinite if the <code>Loop Count</code> is zero.<a href="#section-2.7.2-2" class="pilcrow">¶</a></p>
<p id="section-2.7.2-3">At the beginning of each loop iteration, the canvas is filled using
           the background color from the 'ANIM' Chunk or an application-defined
           color.<a href="#section-2.7.2-3" class="pilcrow">¶</a></p>
<p id="section-2.7.2-4">'ANMF' Chunks contain individual frames given in display order.
           Before rendering each frame, the previous frame's <code>Disposal
         method</code> is applied.<a href="#section-2.7.2-4" class="pilcrow">¶</a></p>
<p id="section-2.7.2-5">The rendering of the decoded frame begins at the Cartesian
           coordinates (<code>2 * Frame X</code>, <code>2 * Frame Y</code>), using the
           top-left corner of the canvas as the origin. <code>Frame Width Minus
           One + 1</code> pixels wide by <code>Frame Height Minus One + 1</code>
           pixels high are rendered onto the canvas using the <code>Blending
           method</code>.<a href="#section-2.7.2-5" class="pilcrow">¶</a></p>
<p id="section-2.7.2-6">The canvas is displayed for <code>Frame Duration</code> milliseconds.
           This continues until all frames given by 'ANMF' Chunks have been
           displayed. A new loop iteration is then begun, or the canvas is left
           in its final state if all iterations have been completed.<a href="#section-2.7.2-6" class="pilcrow">¶</a></p>
<p id="section-2.7.2-7">The following pseudocode illustrates the rendering process. The
           notation <em>VP8X.field</em> means the field in the 'VP8X' Chunk
             with the same description.<a href="#section-2.7.2-7" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-2.7.2-8">
<pre>
VP8X.flags.hasAnimation MUST be TRUE
canvas &lt;- new image of size VP8X.canvasWidth x VP8X.canvasHeight with
          background color ANIM.background_color or
          application-defined color.
loop_count &lt;- ANIM.loopCount
dispose_method &lt;- Dispose to background color
if loop_count == 0:
  loop_count = inf
frame_params &lt;- nil
next chunk in image_data is ANMF MUST be TRUE
for loop = 0..loop_count - 1
  clear canvas to ANIM.background_color or application-defined color
  until eof or non-ANMF chunk
    frame_params.frameX = Frame X
    frame_params.frameY = Frame Y
    frame_params.frameWidth = Frame Width Minus One + 1
    frame_params.frameHeight = Frame Height Minus One + 1
    frame_params.frameDuration = Frame Duration
    frame_right = frame_params.frameX + frame_params.frameWidth
    frame_bottom = frame_params.frameY + frame_params.frameHeight
    VP8X.canvasWidth &gt;= frame_right MUST be TRUE
    VP8X.canvasHeight &gt;= frame_bottom MUST be TRUE
    for subchunk in 'Frame Data':
      if subchunk.tag == "ALPH":
        alpha subchunks not found in 'Frame Data' earlier MUST be
          TRUE
        frame_params.alpha = alpha_data
      else if subchunk.tag == "VP8 " OR subchunk.tag == "VP8L":
        bitstream subchunks not found in 'Frame Data' earlier MUST
          be TRUE
        frame_params.bitstream = bitstream_data
    apply dispose_method.
    render frame with frame_params.alpha and frame_params.bitstream
      on canvas with top-left corner at (frame_params.frameX,
      frame_params.frameY), using Blending method
      frame_params.blendingMethod.
    canvas contains the decoded image.
    Show the contents of the canvas for
    frame_params.frameDuration * 1 ms.
    dispose_method = frame_params.disposeMethod
</pre><a href="#section-2.7.2-8" class="pilcrow">¶</a>
</div>
</section>
<section id="section-2.7.3">
          <h4 id="name-example-file-layouts">
<a href="#section-2.7.3" class="section-number selfRef">2.7.3. </a><a href="#name-example-file-layouts" class="section-name selfRef">Example File Layouts</a>
          </h4>
<p id="section-2.7.3-1">A lossy-encoded image with alpha may look as follows:<a href="#section-2.7.3-1" class="pilcrow">¶</a></p>
<span id="name-a-lossy-encoded-image-with-"></span><figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-2.7.3-2.1">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ALPH (alpha bitstream)
+- VP8 (bitstream)
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-a-lossy-encoded-image-with-" class="selfRef">A Lossy-Encoded Image with Alpha</a>
            </figcaption></figure>
<p id="section-2.7.3-3">A lossless-encoded image may look as follows:<a href="#section-2.7.3-3" class="pilcrow">¶</a></p>
<span id="name-a-lossless-encoded-image"></span><figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-2.7.3-4.1">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- VP8L (lossless bitstream)
+- XYZW (unknown chunk)
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-a-lossless-encoded-image" class="selfRef">A Lossless-Encoded Image</a>
            </figcaption></figure>
<p id="section-2.7.3-5">A lossless image with an ICC profile and XMP metadata may look as
           follows:<a href="#section-2.7.3-5" class="pilcrow">¶</a></p>
<span id="name-a-lossless-image-with-an-ic"></span><figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-2.7.3-6.1">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ICCP (color profile)
+- VP8L (lossless bitstream)
+- XMP  (metadata)
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-a-lossless-image-with-an-ic" class="selfRef">A Lossless Image with an ICC Profile and XMP Metadata</a>
            </figcaption></figure>
<p id="section-2.7.3-7">An animated image with Exif metadata may look as follows:<a href="#section-2.7.3-7" class="pilcrow">¶</a></p>
<span id="name-an-animated-image-with-exif"></span><figure id="figure-18">
            <div class="alignLeft art-text artwork" id="section-2.7.3-8.1">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ANIM (global animation parameters)
+- ANMF (frame1 parameters + data)
+- ANMF (frame2 parameters + data)
+- ANMF (frame3 parameters + data)
+- ANMF (frame4 parameters + data)
+- EXIF (metadata)
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-an-animated-image-with-exif" class="selfRef">An Animated Image with Exif Metadata</a>
            </figcaption></figure>
</section>
</section>
</div>
</section>
</div>
<div id="webp-lossless">
<section id="section-3">
      <h2 id="name-specification-for-webp-loss">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-specification-for-webp-loss" class="section-name selfRef">Specification for WebP Lossless Bitstream</a>
      </h2>
<aside id="section-3-1">
        <p id="section-3-1.1">Note that this section is based on the documentation in the <span><a href="#webp-lossless-src" class="internal xref">libwebp source repository</a> [<a href="#webp-lossless-src" class="cite xref">webp-lossless-src</a>]</span>.<a href="#section-3-1.1" class="pilcrow">¶</a></p>
</aside>
<section id="section-3.1">
        <h3 id="name-abstract-from-specification">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-abstract-from-specification" class="section-name selfRef">Abstract (from "Specification for WebP Lossless Bitstream")</a>
        </h3>
<p id="section-3.1-1">WebP lossless is an image format for lossless compression of ARGB
         images. The lossless format stores and restores the pixel values
         exactly, including the color values for pixels whose alpha value is 0.
         The format uses subresolution images, recursively embedded into the
         format itself, for storing statistical data about the images, such as
         the used entropy codes, spatial predictors, color space conversion,
         and color table. A universal algorithm for sequential data compression <span>[<a href="#LZ77" class="cite xref">LZ77</a>]</span>, prefix coding, and a color cache are used for
         compression of the bulk data. Decoding speeds faster than PNG have
         been demonstrated, as well as 25% denser compression than can be
         achieved using today's PNG format <span>[<a href="#webp-lossless-study" class="cite xref">webp-lossless-study</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-introduction-from-specifica">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-introduction-from-specifica" class="section-name selfRef">Introduction (from "Specification for WebP Lossless Bitstream")</a>
        </h3>
<p id="section-3.2-1">This section describes the compressed data representation of a WebP
         lossless image.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In this section, we extensively use C programming language syntax
         <span>[<a href="#ISO.9899.2018" class="cite xref">ISO.9899.2018</a>]</span> to describe the bitstream and assume the
         existence of a function for reading bits, <code>ReadBits(n)</code>. The
         bytes are read in the natural order of the stream containing them, and
         bits of each byte are read in least-significant-bit-first order. When
         multiple bits are read at the same time, the integer is constructed
         from the original data in the original order. The most significant
         bits of the returned integer are also the most significant bits of the
           original data. Thus, the statement<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.2-3">
<pre>
b = ReadBits(2);
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">is equivalent with the two statements below:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.2-5">
<pre>
b = ReadBits(1);
b |= ReadBits(1) &lt;&lt; 1;
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">We assume that each color component (that is, alpha, red, blue, and
         green) is represented using an 8-bit byte. We define the corresponding
         type as uint8. A whole ARGB pixel is represented by a type called
         uint32, which is an unsigned integer consisting of 32 bits. In the code showing
         the behavior of the transforms, these values are codified in the following bits: alpha in bits
         31..24, red in bits 23..16, green in bits 15..8, and blue in bits 7..0;
         however, implementations of the format are free to use another
       representation internally.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Broadly, a WebP lossless image contains header data, transform
         information, and actual image data. Headers contain the width and height of
         the image. A WebP lossless image can go through four different types
         of transforms before being entropy encoded. The transform
         information in the bitstream contains the data required to apply the
         respective inverse transforms.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-nomenclature">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-nomenclature" class="section-name selfRef">Nomenclature</a>
        </h3>
<span class="break"></span><dl class="dlNewline" id="section-3.3-1">
          <dt id="section-3.3-1.1">ARGB</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.2">A pixel value consisting of alpha, red, green, and blue
           values.<a href="#section-3.3-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.3">ARGB image</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.4">A two-dimensional array containing ARGB pixels.<a href="#section-3.3-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.5">color cache</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.6">A small hash-addressed array to store recently used colors to be
           able to recall them with shorter codes.<a href="#section-3.3-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.7">color indexing image</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.8">A one-dimensional image of colors that can be indexed using a
           small integer (up to 256 within WebP lossless).<a href="#section-3.3-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.9">color transform image</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.10">A two-dimensional subresolution image containing data about
           correlations of color components.<a href="#section-3.3-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.11">distance mapping</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.12">Changes LZ77 distances to have the smallest values for pixels in
           two-dimensional proximity.<a href="#section-3.3-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.13">entropy image</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.14">A two-dimensional subresolution image indicating which entropy
           coding should be used in a respective square in the image, that is,
         each pixel is a meta prefix code.<a href="#section-3.3-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.15">LZ77 <span>[<a href="#LZ77" class="cite xref">LZ77</a>]</span>
</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.16">A dictionary-based sliding window compression algorithm that either
         emits symbols or describes them as sequences of past symbols.<a href="#section-3.3-1.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.17">meta prefix code</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.18">A small integer (up to 16 bits) that indexes an element in the
         meta prefix table.<a href="#section-3.3-1.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.19">predictor image</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.20">A two-dimensional subresolution image indicating which spatial
           predictor is used for a particular square in the image.<a href="#section-3.3-1.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.21">prefix code</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.22">A classic way to do entropy coding where a smaller number of bits
           are used for more frequent codes.<a href="#section-3.3-1.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.23">prefix coding</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.24">A way to entropy code larger integers, which codes a few bits of the
           integer using an entropy code and codifies the remaining bits raw.
           This allows for the descriptions of the entropy codes to remain
         relatively small even when the range of symbols is large.<a href="#section-3.3-1.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-1.25">scan-line order</dt>
          <dd style="margin-left: 2.0em" id="section-3.3-1.26">A processing order of pixels (left to right and top to bottom),
           starting from the left-hand-top pixel. Once
           a row is completed, continue from the left-hand column of the next
           row.<a href="#section-3.3-1.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.4">
        <h3 id="name-riff-header">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-riff-header" class="section-name selfRef">RIFF Header</a>
        </h3>
<p id="section-3.4-1">The beginning of the header has the RIFF container. This consists of
         the following 21 bytes:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-2">
         <li id="section-3.4-2.1">String 'RIFF'.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.2">A little-endian, 32-bit value of the chunk length, which is the whole size
           of the chunk controlled by the RIFF header. Normally, this equals the
           payload size (file size minus 8 bytes: 4 bytes for the 'RIFF'
           identifier and 4 bytes for storing the value itself).<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.3">String 'WEBP' (RIFF container name).<a href="#section-3.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.4">String 'VP8L' (FourCC for lossless-encoded image data).<a href="#section-3.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.5">A little-endian, 32-bit value of the number of bytes in the
           lossless stream.<a href="#section-3.4-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.6">1-byte signature 0x2f.<a href="#section-3.4-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.4-3">The first 28 bits of the bitstream specify the width and height of
         the image. Width and height are decoded as 14-bit integers as
         follows:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.4-4">
<pre>
int image_width = ReadBits(14) + 1;
int image_height = ReadBits(14) + 1;
</pre><a href="#section-3.4-4" class="pilcrow">¶</a>
</div>
<p id="section-3.4-5">The 14-bit precision for image width and height limits the maximum
         size of a WebP lossless image to 16384x16384 pixels.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">The alpha_is_used bit is a hint only and <span class="bcp14">SHOULD NOT</span> impact
         decoding. It <span class="bcp14">SHOULD</span> be set to 0 when all alpha values are 255 in the
         picture and 1 otherwise.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.4-7">
<pre>
int alpha_is_used = ReadBits(1);
</pre><a href="#section-3.4-7" class="pilcrow">¶</a>
</div>
<p id="section-3.4-8">The version_number is a 3-bit code that <span class="bcp14">MUST</span> be set to 0. Any other
         value <span class="bcp14">MUST</span> be treated as an error.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.4-9">
<pre>
int version_number = ReadBits(3);
</pre><a href="#section-3.4-9" class="pilcrow">¶</a>
</div>
</section>
<section id="section-3.5">
        <h3 id="name-transforms">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-transforms" class="section-name selfRef">Transforms</a>
        </h3>
<p id="section-3.5-1">The transforms are reversible manipulations of the image data that
         can reduce the remaining symbolic entropy by modeling spatial and
         color correlations. They can make the final compression
         more dense.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">An image can go through four types of transforms. A 1 bit
         indicates the presence of a transform. Each transform is allowed to be
         used only once. The transforms are used only for the main-level
         ARGB image; the subresolution images (color transform image, entropy
         image, and predictor image) have no transforms, not even the 0 bit
         indicating the end of transforms.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<aside id="section-3.5-3">
          <p id="section-3.5-3.1">Typically, an encoder would use these transforms to reduce the
         Shannon entropy in the residual image. Also, the transform data can be
         decided based on entropy minimization.<a href="#section-3.5-3.1" class="pilcrow">¶</a></p>
</aside>
<div class="lang-c sourcecode" id="section-3.5-4">
<pre>
while (ReadBits(1)) {  // Transform present.
  // Decode transform type.
  enum TransformType transform_type = ReadBits(2);
  // Decode transform data.
  ...
}

// Decode actual image data.
</pre><a href="#section-3.5-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5-5">If a transform is present, then the next two bits specify the
         transform type. There are four types of transforms.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<span id="name-transform-types"></span><table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-transform-types" class="selfRef">Transform Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Transform</th>
              <th class="text-left" rowspan="1" colspan="1">Bit</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PREDICTOR_TRANSFORM</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">COLOR_TRANSFORM</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SUBTRACT_GREEN_TRANSFORM</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">COLOR_INDEXING_TRANSFORM</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.5-7">The transform type is followed by the transform data. Transform data
         contains the information required to apply the inverse transform and
         depends on the transform type. The inverse transforms are applied in
         the reverse order that they are read from the bitstream, that is, last
         one first.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">Next, we describe the transform data for different types.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<div id="predictor-transform">
<section id="section-3.5.1">
          <h4 id="name-predictor-transform">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-predictor-transform" class="section-name selfRef">Predictor Transform</a>
          </h4>
<p id="section-3.5.1-1">The predictor transform can be used to reduce entropy by exploiting
           the fact that neighboring pixels are often correlated. In the
           predictor transform, the current pixel value is predicted from the
           pixels already decoded (in scan-line order) and only the residual
           value (actual - predicted) is encoded. The green component of a
           pixel defines which of the 14 predictors is used within a particular
           block of the ARGB image. The <em>prediction mode</em> determines the
           type of prediction to use. We divide the image into squares, and all
           the pixels in a square use the same prediction mode.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">The first 3 bits of prediction data define the block width and
           height in number of bits.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-3">
<pre>
int size_bits = ReadBits(3) + 2;
int block_width = (1 &lt;&lt; size_bits);
int block_height = (1 &lt;&lt; size_bits);
#define DIV_ROUND_UP(num, den) (((num) + (den) - 1) / (den))
int transform_width = DIV_ROUND_UP(image_width, 1 &lt;&lt; size_bits);
</pre><a href="#section-3.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-4">The transform data contains the prediction mode for each block of
           the image. It is a subresolution image where the green component
           of a pixel defines which of the 14 predictors is used for all the
           <code>block_width * block_height</code> pixels within a particular
           block of the ARGB image. This subresolution image is encoded using
           the same techniques described in <a href="#image-data" class="auto internal xref">Section 3.6</a>.<a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
<p id="section-3.5.1-5">The number of block columns,
           <code>transform_width</code>, is used in two-dimensional indexing. For a pixel (x, y), one can compute the respective filter
           block address by:<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-6">
<pre>
int block_index = (y &gt;&gt; size_bits) * transform_width +
                  (x &gt;&gt; size_bits);
</pre><a href="#section-3.5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-7">There are 14 different prediction modes. In each prediction mode,
           the current pixel value is predicted from one or more neighboring
           pixels whose values are already known.<a href="#section-3.5.1-7" class="pilcrow">¶</a></p>
<p id="section-3.5.1-8">We chose the neighboring pixels (TL, T, TR, and L) of the current
           pixel (P) as follows:<a href="#section-3.5.1-8" class="pilcrow">¶</a></p>
<span id="name-neighboring-pixels-of-the-c"></span><figure id="figure-19">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-3.5.1-9.1">
<pre>
O    O    O    O    O    O    O    O    O    O    O
O    O    O    O    O    O    O    O    O    O    O
O    O    O    O    TL   T    TR   O    O    O    O
O    O    O    O    L    P    X    X    X    X    X
X    X    X    X    X    X    X    X    X    X    X
X    X    X    X    X    X    X    X    X    X    X
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-neighboring-pixels-of-the-c" class="selfRef">Neighboring Pixels of the Current Pixel (P)</a>
            </figcaption></figure>
<p id="section-3.5.1-10">where TL means top-left, T means top, TR means top-right, and L means left. At the
           time of predicting a value for P, all O, TL, T, TR, and L pixels have
           already been processed, and the P pixel and all X pixels are
           unknown.<a href="#section-3.5.1-10" class="pilcrow">¶</a></p>
<p id="section-3.5.1-11">Given the preceding neighboring pixels, the different prediction modes
           are defined as follows.<a href="#section-3.5.1-11" class="pilcrow">¶</a></p>
<span id="name-prediction-modes"></span><table class="left" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-prediction-modes" class="selfRef">Prediction Modes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Mode</th>
                <th class="text-left" rowspan="1" colspan="1">Predicted Value of Each Channel of the Current Pixel</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">0xff000000 (represents solid black color in ARGB)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">L</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">T</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">TR</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">TL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(Average2(L, TR), T)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">6</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(L, TL)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">7</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(L, T)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(TL, T)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">9</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(T, TR)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">10</td>
                <td class="text-left" rowspan="1" colspan="1">Average2(Average2(L, TL), Average2(T, TR))</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">11</td>
                <td class="text-left" rowspan="1" colspan="1">Select(L, T, TL)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">12</td>
                <td class="text-left" rowspan="1" colspan="1">ClampAddSubtractFull(L, T, TL)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">13</td>
                <td class="text-left" rowspan="1" colspan="1">ClampAddSubtractHalf(Average2(L, T), TL)</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.5.1-13"><code>Average2</code> is defined as follows for each ARGB
           component:<a href="#section-3.5.1-13" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-14">
<pre>
uint8 Average2(uint8 a, uint8 b) {
  return (a + b) / 2;
}
</pre><a href="#section-3.5.1-14" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-15">The Select predictor is defined as follows:<a href="#section-3.5.1-15" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-16">
<pre>
uint32 Select(uint32 L, uint32 T, uint32 TL) {
  // L = left pixel, T = top pixel, TL = top-left pixel.

  // ARGB component estimates for prediction.
  int pAlpha = ALPHA(L) + ALPHA(T) - ALPHA(TL);
  int pRed = RED(L) + RED(T) - RED(TL);
  int pGreen = GREEN(L) + GREEN(T) - GREEN(TL);
  int pBlue = BLUE(L) + BLUE(T) - BLUE(TL);

  // Manhattan distances to estimates for left and top pixels.
  int pL = abs(pAlpha - ALPHA(L)) + abs(pRed - RED(L)) +
           abs(pGreen - GREEN(L)) + abs(pBlue - BLUE(L));
  int pT = abs(pAlpha - ALPHA(T)) + abs(pRed - RED(T)) +
           abs(pGreen - GREEN(T)) + abs(pBlue - BLUE(T));

  // Return either left or top, the one closer to the prediction.
  if (pL &lt; pT) {
    return L;
  } else {
    return T;
  }
}
</pre><a href="#section-3.5.1-16" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-17">The functions <code>ClampAddSubtractFull</code> and
           <code>ClampAddSubtractHalf</code> are performed for each ARGB component
           as follows:<a href="#section-3.5.1-17" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-18">
<pre>
// Clamp the input value between 0 and 255.
int Clamp(int a) {
  return (a &lt; 0) ? 0 : (a &gt; 255) ? 255 : a;
}

int ClampAddSubtractFull(int a, int b, int c) {
  return Clamp(a + b - c);
}

int ClampAddSubtractHalf(int a, int b) {
  return Clamp(a + (a - b) / 2);
}
</pre><a href="#section-3.5.1-18" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-19">There are special handling rules for some border pixels. If there
           is a predictor transform, regardless of the mode [0..13] for these
           pixels, the predicted value for the left-topmost pixel of the image
           is 0xff000000, all pixels on the top row are L-pixel, and
           all pixels on the leftmost column are T-pixel.<a href="#section-3.5.1-19" class="pilcrow">¶</a></p>
<p id="section-3.5.1-20">Addressing the TR-pixel for pixels on the rightmost column is
           exceptional. The pixels on the rightmost column are predicted by
           using the modes [0..13], just like pixels not on the border, but the
           leftmost pixel on the same row as the current pixel is instead used
           as the TR-pixel.<a href="#section-3.5.1-20" class="pilcrow">¶</a></p>
<p id="section-3.5.1-21">The final pixel value is obtained by adding each channel of the
           predicted value to the encoded residual value.<a href="#section-3.5.1-21" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.1-22">
<pre>
void PredictorTransformOutput(uint32 residual, uint32 pred,
                              uint8* alpha, uint8* red,
                              uint8* green, uint8* blue) {
  *alpha = ALPHA(residual) + ALPHA(pred);
  *red = RED(residual) + RED(pred);
  *green = GREEN(residual) + GREEN(pred);
  *blue = BLUE(residual) + BLUE(pred);
}
</pre><a href="#section-3.5.1-22" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="color-transform">
<section id="section-3.5.2">
          <h4 id="name-color-transform">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-color-transform" class="section-name selfRef">Color Transform</a>
          </h4>
<p id="section-3.5.2-1">The goal of the color transform is to decorrelate the R, G, and B
           values of each pixel. The color transform keeps the green (G) value
           as it is, transforms the red (R) value based on the green value, and transforms
     the blue (B)
           value based on the green value and then on the red value.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">As is the case for the predictor transform, first the image is
           divided into blocks, and the same transform mode is used for all the
           pixels in a block. For each block, there are three types of color
           transform elements.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.2-3">
<pre>
typedef struct {
  uint8 green_to_red;
  uint8 green_to_blue;
  uint8 red_to_blue;
} ColorTransformElement;
</pre><a href="#section-3.5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.5.2-4">The actual color transform is done by defining a color
           transform delta. The color transform delta depends on the
           <code>ColorTransformElement</code>, which is the same for all the pixels
           in a particular block. The delta is subtracted during the color
           transform. The inverse color transform then is just adding those
           deltas.<a href="#section-3.5.2-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2-5">The color transform function is defined as follows:<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.2-6">
<pre>
void ColorTransform(uint8 red, uint8 blue, uint8 green,
                    ColorTransformElement *trans,
                    uint8 *new_red, uint8 *new_blue) {
  // Transformed values of red and blue components
  int tmp_red = red;
  int tmp_blue = blue;

  // Applying the transform is just subtracting the transform deltas
  tmp_red  -= ColorTransformDelta(trans-&gt;green_to_red,  green);
  tmp_blue -= ColorTransformDelta(trans-&gt;green_to_blue, green);
  tmp_blue -= ColorTransformDelta(trans-&gt;red_to_blue, red);

  *new_red = tmp_red &amp; 0xff;
  *new_blue = tmp_blue &amp; 0xff;
}
</pre><a href="#section-3.5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-3.5.2-7"><code>ColorTransformDelta</code> is computed using a signed 8-bit
           integer representing a 3.5-fixed-point number and a signed 8-bit
           RGB color channel (c) [-128..127] and is defined as follows:<a href="#section-3.5.2-7" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.2-8">
<pre>
int8 ColorTransformDelta(int8 t, int8 c) {
  return (t * c) &gt;&gt; 5;
}
</pre><a href="#section-3.5.2-8" class="pilcrow">¶</a>
</div>
<p id="section-3.5.2-9">A conversion from the 8-bit unsigned representation
           (<code>uint8</code>) to the 8-bit signed one (<code>int8</code>) is required
           before calling <code>ColorTransformDelta()</code>.
     The signed value should be interpreted as an 8-bit two's complement number (that is: uint8 range [128..255] is mapped
           to the [-128..-1] range of its converted int8 value).<a href="#section-3.5.2-9" class="pilcrow">¶</a></p>
<p id="section-3.5.2-10">The multiplication is to be done using more precision (with at
           least 16-bit precision). The sign extension property of the shift
           operation does not matter here; only the lowest 8 bits are used from
           the result, and in these bits, the sign extension shifting and
           unsigned shifting are consistent with each other.<a href="#section-3.5.2-10" class="pilcrow">¶</a></p>
<p id="section-3.5.2-11">Now, we describe the contents of color transform data so that
           decoding can apply the inverse color transform and recover the
           original red and blue values. The first 3 bits of the color
           transform data contain the width and height of the image block in
           number of bits, just like the predictor transform:<a href="#section-3.5.2-11" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.2-12">
<pre>
int size_bits = ReadBits(3) + 2;
int block_width = 1 &lt;&lt; size_bits;
int block_height = 1 &lt;&lt; size_bits;
</pre><a href="#section-3.5.2-12" class="pilcrow">¶</a>
</div>
<p id="section-3.5.2-13">The remaining part of the color transform data contains
           <code>ColorTransformElement</code> instances, corresponding to each block
           of the image. Each <code>ColorTransformElement</code> <code>'cte'</code> is
           treated as a pixel in a subresolution image whose alpha component is
           <code>255</code>, red component is <code>cte.red_to_blue</code>, green
           component is <code>cte.green_to_blue</code>, and blue component is
           <code>cte.green_to_red</code>.<a href="#section-3.5.2-13" class="pilcrow">¶</a></p>
<p id="section-3.5.2-14">During decoding, <code>ColorTransformElement</code> instances of the
           blocks are decoded and the inverse color transform is applied on the
           ARGB values of the pixels. As mentioned earlier, that inverse color
           transform is just adding <code>ColorTransformElement</code> values to
           the red and blue channels. The alpha and green channels are left as
           is.<a href="#section-3.5.2-14" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.2-15">
<pre>
void InverseTransform(uint8 red, uint8 green, uint8 blue,
                      ColorTransformElement *trans,
                      uint8 *new_red, uint8 *new_blue) {
  // Transformed values of red and blue components
  int tmp_red = red;
  int tmp_blue = blue;

  // Applying the inverse transform is just adding the
  // color transform deltas
  tmp_red  += ColorTransformDelta(trans-&gt;green_to_red, green);
  tmp_blue += ColorTransformDelta(trans-&gt;green_to_blue, green);
  tmp_blue +=
      ColorTransformDelta(trans-&gt;red_to_blue, tmp_red &amp; 0xff);

  *new_red = tmp_red &amp; 0xff;
  *new_blue = tmp_blue &amp; 0xff;
}
</pre><a href="#section-3.5.2-15" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-3.5.3">
          <h4 id="name-subtract-green-transform">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-subtract-green-transform" class="section-name selfRef">Subtract Green Transform</a>
          </h4>
<p id="section-3.5.3-1">The subtract green transform subtracts green values from red and
           blue values of each pixel. When this transform is present, the
           decoder needs to add the green value to both the red and blue values. There is
           no data associated with this transform. The decoder applies the
           inverse transform as follows:<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.3-2">
<pre>
void AddGreenToBlueAndRed(uint8 green, uint8 *red, uint8 *blue) {
  *red  = (*red  + green) &amp; 0xff;
  *blue = (*blue + green) &amp; 0xff;
}
</pre><a href="#section-3.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-3">This transform is redundant, as it can be modeled using the color
           transform, but since there is no additional data here, the subtract
           green transform can be coded using fewer bits than a full-blown
           color transform.<a href="#section-3.5.3-3" class="pilcrow">¶</a></p>
</section>
<div id="color-indexing-transform">
<section id="section-3.5.4">
          <h4 id="name-color-indexing-transform">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-color-indexing-transform" class="section-name selfRef">Color Indexing Transform</a>
          </h4>
<p id="section-3.5.4-1">If there are not many unique pixel values, it may be more efficient
           to create a color index array and replace the pixel values by the
           array's indices. The color indexing transform achieves this. (In the
           context of WebP lossless, we specifically do not call this a palette
           transform because a similar but more dynamic concept exists in WebP
           lossless encoding: color cache.)<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.5.4-2">The color indexing transform checks for the number of unique ARGB
           values in the image. If that number is below a threshold (256), it
           creates an array of those ARGB values, which is then used to replace
           the pixel values with the corresponding index: the green channel of
           the pixels are replaced with the index, all alpha values are set to
           255, and all red and blue values are set to 0.<a href="#section-3.5.4-2" class="pilcrow">¶</a></p>
<p id="section-3.5.4-3">The transform data contains the color table size and the entries in the
           color table. The decoder reads the color indexing transform data as
           follows:<a href="#section-3.5.4-3" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.4-4">
<pre>
// 8-bit value for the color table size
int color_table_size = ReadBits(8) + 1;
</pre><a href="#section-3.5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5.4-5">The color table is stored using the image storage format itself.
           The color table can be obtained by reading an image, without the
           RIFF header, image size, and transforms, assuming the height of 1
           pixel and the width of <code>color_table_size</code>. The color table is
             always subtraction-coded to reduce image entropy. The deltas of
             palette colors contain typically much less entropy than the colors
             themselves, leading to significant savings for smaller images. In
             decoding, every final color in the color table can be obtained by
             adding the previous color component values by each ARGB component
             separately and storing the least significant 8 bits of the
             result.<a href="#section-3.5.4-5" class="pilcrow">¶</a></p>
<p id="section-3.5.4-6">The inverse transform for the image is simply replacing the pixel
           values (which are indices to the color table) with the actual color
           table values. The indexing is done based on the green component of
           the ARGB color.<a href="#section-3.5.4-6" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.4-7">
<pre>
// Inverse transform
argb = color_table[GREEN(argb)];
</pre><a href="#section-3.5.4-7" class="pilcrow">¶</a>
</div>
<p id="section-3.5.4-8">If the index is equal to or larger than <code>color_table_size</code>, the
           argb color value should be set to 0x00000000 (transparent
           black).<a href="#section-3.5.4-8" class="pilcrow">¶</a></p>
<p id="section-3.5.4-9">When the color table is small (equal to or less than 16 colors),
           several pixels are bundled into a single pixel. The pixel bundling
           packs several (2, 4, or 8) pixels into a single pixel, reducing the
           image width respectively.<a href="#section-3.5.4-9" class="pilcrow">¶</a></p>
<aside id="section-3.5.4-10">
            <p id="section-3.5.4-10.1">Pixel bundling allows for a more efficient
           joint distribution entropy coding of neighboring pixels and gives
           some arithmetic coding-like benefits to the entropy code, but it can
           only be used when there are 16 or fewer unique values.<a href="#section-3.5.4-10.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.5.4-11"><code>color_table_size</code> specifies how many pixels are
           combined:<a href="#section-3.5.4-11" class="pilcrow">¶</a></p>
<span id="name-color-table-size-to-bundled"></span><table class="left" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-color-table-size-to-bundled" class="selfRef">Color Table Size to Bundled Pixel Bit Width Mapping</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">color_table_size</th>
                <th class="text-left" rowspan="1" colspan="1">width_bits value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1..2</td>
                <td class="text-left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">3..4</td>
                <td class="text-left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">5..16</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">17..256</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.5.4-13"><code>width_bits</code> has a value of 0, 1, 2, or 3. A value of 0
           indicates no pixel bundling is to be done for the image. A value of
           1 indicates that two pixels are combined, and each pixel has a range
           of [0..15]. A value of 2 indicates that four pixels are combined,
           and each pixel has a range of [0..3]. A value of 3 indicates that
           eight pixels are combined, and each pixel has a range of [0..1],
           that is, a binary value.<a href="#section-3.5.4-13" class="pilcrow">¶</a></p>
<p id="section-3.5.4-14">The values are packed into the green component as follows:<a href="#section-3.5.4-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.4-15.1">
              <code>width_bits</code> = 1: For every x value, where x = 2k + 0, a
             green value at x is positioned into the 4 least significant bits
             of the green value at x / 2, and a green value at x + 1 is positioned
             into the 4 most significant bits of the green value at x / 2.<a href="#section-3.5.4-15.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.4-15.2">
              <code>width_bits</code> = 2: For every x value, where x = 4k + 0, a
             green value at x is positioned into the 2 least significant bits
             of the green value at x / 4, and green values at x + 1 to x + 3 are
             positioned in order to the more significant bits of the green
             value at x / 4.<a href="#section-3.5.4-15.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.4-15.3">
              <code>width_bits</code> = 3: For every x value, where x = 8k + 0, a
             green value at x is positioned into the least significant bit of
             the green value at x / 8, and green values at x + 1 to x + 7 are
             positioned in order to the more significant bits of the green
             value at x / 8.<a href="#section-3.5.4-15.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.5.4-16">After reading this transform, <code>image_width</code> is subsampled by
           <code>width_bits</code>. This affects the size of subsequent transforms.
           The new size can be calculated using <code>DIV_ROUND_UP</code>, as
           defined in <a href="#predictor-transform" class="auto internal xref">Section 3.5.1</a>.<a href="#section-3.5.4-16" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.5.4-17">
<pre>
image_width = DIV_ROUND_UP(image_width, 1 &lt;&lt; width_bits);
</pre><a href="#section-3.5.4-17" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
<div id="image-data">
<section id="section-3.6">
        <h3 id="name-image-data">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-image-data" class="section-name selfRef">Image Data</a>
        </h3>
<p id="section-3.6-1">Image data is an array of pixel values in scan-line order.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<div id="roles-of-image-data">
<section id="section-3.6.1">
          <h4 id="name-roles-of-image-data">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-roles-of-image-data" class="section-name selfRef">Roles of Image Data</a>
          </h4>
<p id="section-3.6.1-1">We use image data in five different roles:<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.6.1-2">
           <li id="section-3.6.1-2.1">ARGB image: Stores the actual pixels of the image.<a href="#section-3.6.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.1-2.2">Entropy image: Stores the meta prefix
             codes (see <span><a href="#decoding-of-meta-prefix-codes" class="internal xref">"Decoding of Meta Prefix Codes"</a> (<a href="#decoding-of-meta-prefix-codes" class="auto internal xref">Section 3.7.2.2</a>)</span>).<a href="#section-3.6.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.1-2.3">Predictor image: Stores the metadata for the predictor transform (see <span><a href="#predictor-transform" class="internal xref">"Predictor Transform"</a> (<a href="#predictor-transform" class="auto internal xref">Section 3.5.1</a>)</span>).<a href="#section-3.6.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.1-2.4">Color transform image: Created by
             <code>ColorTransformElement</code> values (defined in <span><a href="#color-transform" class="internal xref">"Color Transform"</a> (<a href="#color-transform" class="auto internal xref">Section 3.5.2</a>)</span>) for different
               blocks of the image.<a href="#section-3.6.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.1-2.5">Color indexing image: An array of the size of
               <code>color_table_size</code> (up to 256 ARGB values) that stores the
               metadata for the color
                 indexing transform (see <span><a href="#color-indexing-transform" class="internal xref">"Color Indexing Transform"</a> (<a href="#color-indexing-transform" class="auto internal xref">Section 3.5.4</a>)</span>).<a href="#section-3.6.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<section id="section-3.6.2">
          <h4 id="name-encoding-of-image-data">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-encoding-of-image-data" class="section-name selfRef">Encoding of Image Data</a>
          </h4>
<p id="section-3.6.2-1">The encoding of image data is independent of its role.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">The image is first divided into a set of fixed-size blocks
           (typically 16x16 blocks). Each of these blocks are modeled using
           their own entropy codes. Also, several blocks may share the same
           entropy codes.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<aside id="section-3.6.2-3">
            <p id="section-3.6.2-3.1">Rationale: Storing an entropy code incurs a cost. This cost
           can be minimized if statistically similar blocks share an entropy
           code, thereby storing that code only once. For example, an encoder
           can find similar blocks by clustering them using their statistical
           properties or by repeatedly joining a pair of randomly selected
           clusters when it reduces the overall amount of bits needed to encode
           the image.<a href="#section-3.6.2-3.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.6.2-4">Each pixel is encoded using one of the three possible methods:<a href="#section-3.6.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.6.2-5">
           <li id="section-3.6.2-5.1">Prefix-coded literals: Each channel (green, red, blue, and alpha)
             is entropy-coded independently.<a href="#section-3.6.2-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.2-5.2">LZ77 backward reference: A sequence of pixels are copied from
             elsewhere in the image.<a href="#section-3.6.2-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.2-5.3">Color cache code: Using a short multiplicative hash code (color
             cache index) of a recently seen color.<a href="#section-3.6.2-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.6.2-6">The following subsections describe each of these in detail.<a href="#section-3.6.2-6" class="pilcrow">¶</a></p>
<div id="prefix-coded-literals">
<section id="section-3.6.2.1">
            <h5 id="name-prefix-coded-literals">
<a href="#section-3.6.2.1" class="section-number selfRef">3.6.2.1. </a><a href="#name-prefix-coded-literals" class="section-name selfRef">Prefix-Coded Literals</a>
            </h5>
<p id="section-3.6.2.1-1">The pixel is stored as prefix-coded values of green, red, blue,
             and alpha (in that order). See <a href="#decoding-entropy-coded-image-data" class="auto internal xref">Section 3.7.2.3</a> for details.<a href="#section-3.6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lz77-backward-reference">
<section id="section-3.6.2.2">
            <h5 id="name-lz77-backward-reference">
<a href="#section-3.6.2.2" class="section-number selfRef">3.6.2.2. </a><a href="#name-lz77-backward-reference" class="section-name selfRef">LZ77 Backward Reference</a>
            </h5>
<p id="section-3.6.2.2-1">Backward references are tuples of <em>length</em> and
            <em>distance code</em>:<a href="#section-3.6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.2.2-2.1">Length indicates how many pixels in scan-line order are to be
               copied.<a href="#section-3.6.2.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.6.2.2-2.2">Distance code is a number indicating the position of a
               previously seen pixel, from which the pixels are to be copied.
               The exact mapping is described <span><a href="#distance-mapping" class="internal xref">below</a> (<a href="#distance-mapping" class="auto internal xref">Section 3.6.2.2.1</a>)</span>.<a href="#section-3.6.2.2-2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.6.2.2-3">The length and distance values are stored using <strong>LZ77
             prefix coding</strong>.<a href="#section-3.6.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.6.2.2-4">LZ77 prefix coding divides large integer values into two parts:
             the <em>prefix code</em> and the <em>extra bits</em>. The prefix
               code is stored using an entropy code, while the extra bits are
               stored as they are (without an entropy code).<a href="#section-3.6.2.2-4" class="pilcrow">¶</a></p>
<aside id="section-3.6.2.2-5">
              <p id="section-3.6.2.2-5.1">Rationale: This approach reduces the storage requirement
             for the entropy code. Also, large values are usually rare, so
             extra bits would be used for very few values in the image. Thus,
             this approach results in better compression overall.<a href="#section-3.6.2.2-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.6.2.2-6">The following table denotes the prefix codes and extra bits used
             for storing different ranges of values.<a href="#section-3.6.2.2-6" class="pilcrow">¶</a></p>
<aside id="section-3.6.2.2-7">
              <p id="section-3.6.2.2-7.1">Note: The maximum backward reference length is limited to 4096.
             Hence, only the first 24 prefix codes (with the respective extra
             bits) are meaningful for length values. For distance values,
             however, all the 40 prefix codes are valid.<a href="#section-3.6.2.2-7.1" class="pilcrow">¶</a></p>
</aside>
<span id="name-value-to-prefix-code-and-ex"></span><table class="left" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-value-to-prefix-code-and-ex" class="selfRef">Value to Prefix Code and Extra Bits Mapping</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value Range</th>
                  <th class="text-left" rowspan="1" colspan="1">Prefix Code</th>
                  <th class="text-left" rowspan="1" colspan="1">Extra Bits</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">4</td>
                  <td class="text-left" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">5..6</td>
                  <td class="text-left" rowspan="1" colspan="1">4</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">7..8</td>
                  <td class="text-left" rowspan="1" colspan="1">5</td>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">9..12</td>
                  <td class="text-left" rowspan="1" colspan="1">6</td>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">13..16</td>
                  <td class="text-left" rowspan="1" colspan="1">7</td>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3072..4096</td>
                  <td class="text-left" rowspan="1" colspan="1">23</td>
                  <td class="text-left" rowspan="1" colspan="1">10</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                  <td class="text-left" rowspan="1" colspan="1">...</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">524289..786432</td>
                  <td class="text-left" rowspan="1" colspan="1">38</td>
                  <td class="text-left" rowspan="1" colspan="1">18</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">786433..1048576</td>
                  <td class="text-left" rowspan="1" colspan="1">39</td>
                  <td class="text-left" rowspan="1" colspan="1">18</td>
                </tr>
              </tbody>
            </table>
<p id="section-3.6.2.2-9">The pseudocode to obtain a (length or distance) value from the
             prefix code is as follows:<a href="#section-3.6.2.2-9" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.6.2.2-10">
<pre>
if (prefix_code &lt; 4) {
  return prefix_code + 1;
}
int extra_bits = (prefix_code - 2) &gt;&gt; 1;
int offset = (2 + (prefix_code &amp; 1)) &lt;&lt; extra_bits;
return offset + ReadBits(extra_bits) + 1;
</pre><a href="#section-3.6.2.2-10" class="pilcrow">¶</a>
</div>
<div id="distance-mapping">
<section id="section-3.6.2.2.1">
              <h6 id="name-distance-mapping">
<a href="#section-3.6.2.2.1" class="section-number selfRef">3.6.2.2.1. </a><a href="#name-distance-mapping" class="section-name selfRef">Distance Mapping</a>
              </h6>
<p id="section-3.6.2.2.1-1">As noted previously, a distance code is a number indicating the
             position of a previously seen pixel, from which the pixels are to
             be copied. This subsection defines the mapping between a distance
             code and the position of a previous pixel.<a href="#section-3.6.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2.2.1-2">Distance codes larger than 120 denote the pixel distance in
             scan-line order, offset by 120.<a href="#section-3.6.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2.2.1-3">The smallest distance codes [1..120] are special and are
             reserved for a close neighborhood of the current pixel. This
             neighborhood consists of 120 pixels:<a href="#section-3.6.2.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6.2.2.1-4.1">Pixels that are 1 to 7 rows above the current pixel and are
               up to 8 columns to the left or up to 7 columns to the right of
               the current pixel [Total such pixels = <code>7 * (8 + 1 + 7) =
               112</code>].<a href="#section-3.6.2.2.1-4.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.6.2.2.1-4.2">Pixels that are in the same row as the current pixel and are up
               to 8 columns to the left of the current pixel [<code>8</code> such
               pixels].<a href="#section-3.6.2.2.1-4.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-3.6.2.2.1-5">The mapping between distance code <code>distance_code</code> and the neighboring
             pixel offset <code>(xi, yi)</code> is as follows:<a href="#section-3.6.2.2.1-5" class="pilcrow">¶</a></p>
<span id="name-distance-code-to-neighborin"></span><figure id="figure-20">
                <div class="alignLeft art-ascii-art art-text artwork" id="section-3.6.2.2.1-6.1">
<pre>
(0, 1),  (1, 0),  (1, 1),  (-1, 1), (0, 2),  (2, 0),  (1, 2),
(-1, 2), (2, 1),  (-2, 1), (2, 2),  (-2, 2), (0, 3),  (3, 0),
(1, 3),  (-1, 3), (3, 1),  (-3, 1), (2, 3),  (-2, 3), (3, 2),
(-3, 2), (0, 4),  (4, 0),  (1, 4),  (-1, 4), (4, 1),  (-4, 1),
(3, 3),  (-3, 3), (2, 4),  (-2, 4), (4, 2),  (-4, 2), (0, 5),
(3, 4),  (-3, 4), (4, 3),  (-4, 3), (5, 0),  (1, 5),  (-1, 5),
(5, 1),  (-5, 1), (2, 5),  (-2, 5), (5, 2),  (-5, 2), (4, 4),
(-4, 4), (3, 5),  (-3, 5), (5, 3),  (-5, 3), (0, 6),  (6, 0),
(1, 6),  (-1, 6), (6, 1),  (-6, 1), (2, 6),  (-2, 6), (6, 2),
(-6, 2), (4, 5),  (-4, 5), (5, 4),  (-5, 4), (3, 6),  (-3, 6),
(6, 3),  (-6, 3), (0, 7),  (7, 0),  (1, 7),  (-1, 7), (5, 5),
(-5, 5), (7, 1),  (-7, 1), (4, 6),  (-4, 6), (6, 4),  (-6, 4),
(2, 7),  (-2, 7), (7, 2),  (-7, 2), (3, 7),  (-3, 7), (7, 3),
(-7, 3), (5, 6),  (-5, 6), (6, 5),  (-6, 5), (8, 0),  (4, 7),
(-4, 7), (7, 4),  (-7, 4), (8, 1),  (8, 2),  (6, 6),  (-6, 6),
(8, 3),  (5, 7),  (-5, 7), (7, 5),  (-7, 5), (8, 4),  (6, 7),
(-6, 7), (7, 6),  (-7, 6), (8, 5),  (7, 7),  (-7, 7), (8, 6),
(8, 7)
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-distance-code-to-neighborin" class="selfRef">Distance Code to Neighboring Pixel Offset Mapping</a>
                </figcaption></figure>
<p id="section-3.6.2.2.1-7">For example, the distance code <code>1</code> indicates an offset of
             <code>(0, 1)</code> for the neighboring pixel, that is, the pixel
             above the current pixel (0 pixel difference in the X direction and
             1 pixel difference in the Y direction). Similarly, the distance
             code <code>3</code> indicates the top-left pixel.<a href="#section-3.6.2.2.1-7" class="pilcrow">¶</a></p>
<p id="section-3.6.2.2.1-8">The decoder can convert a distance code <code>distance_code</code> to a
               scan-line order distance <code>dist</code> as follows:<a href="#section-3.6.2.2.1-8" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-3.6.2.2.1-9">
<pre>
(xi, yi) = distance_map[distance_code - 1]
dist = xi + yi * image_width
if (dist &lt; 1) {
  dist = 1
}
</pre><a href="#section-3.6.2.2.1-9" class="pilcrow">¶</a>
</div>
<p id="section-3.6.2.2.1-10">where <code>distance_map</code> is the mapping noted above, and
             <code>image_width</code> is the width of the image in pixels.<a href="#section-3.6.2.2.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="color-cache-coding">
<section id="section-3.6.2.3">
            <h5 id="name-color-cache-coding">
<a href="#section-3.6.2.3" class="section-number selfRef">3.6.2.3. </a><a href="#name-color-cache-coding" class="section-name selfRef">Color Cache Coding</a>
            </h5>
<p id="section-3.6.2.3-1">Color cache stores a set of colors that have been recently used
             in the image.<a href="#section-3.6.2.3-1" class="pilcrow">¶</a></p>
<aside id="section-3.6.2.3-2">
              <p id="section-3.6.2.3-2.1">Rationale: This way, the recently used colors can
             sometimes be referred to more efficiently than emitting them using
             the other two methods (described in Sections <a href="#prefix-coded-literals" class="auto internal xref">3.6.2.1</a>
             and <a href="#lz77-backward-reference" class="auto internal xref">3.6.2.2</a>).<a href="#section-3.6.2.3-2.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.6.2.3-3">Color cache codes are stored as follows. First, there is a 1-bit
             value that indicates if the color cache is used. If this bit is 0,
             no color cache codes exist, and they are not transmitted in the
             prefix code that decodes the green symbols and the length prefix
             codes. However, if this bit is 1, the color cache size is read
             next:<a href="#section-3.6.2.3-3" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.6.2.3-4">
<pre>
int color_cache_code_bits = ReadBits(4);
int color_cache_size = 1 &lt;&lt; color_cache_code_bits;
</pre><a href="#section-3.6.2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.6.2.3-5"><code>color_cache_code_bits</code> defines the size of the
             color cache (<code>1 &lt;&lt; color_cache_code_bits</code>). The
               range of allowed values for <code>color_cache_code_bits</code> is
                 [1..11]. Compliant decoders <span class="bcp14">MUST</span> indicate a corrupted
                 bitstream for other values.<a href="#section-3.6.2.3-5" class="pilcrow">¶</a></p>
<p id="section-3.6.2.3-6">A color cache is an array of size <code>color_cache_size</code>. Each
             entry stores one ARGB color. Colors are looked up by indexing them
             by <code>(0x1e35a7bd * color) &gt;&gt; (32 -
             color_cache_code_bits)</code>. Only one lookup is done in a
               color cache; there is no conflict resolution.<a href="#section-3.6.2.3-6" class="pilcrow">¶</a></p>
<p id="section-3.6.2.3-7">In the beginning of decoding or encoding of an image, all entries
             in all color cache values are set to zero. The color cache code is
             converted to this color at decoding time. The state of the color
             cache is maintained by inserting every pixel, be it produced by
             backward referencing or as literals, into the cache in the order
             they appear in the stream.<a href="#section-3.6.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</section>
</div>
<section id="section-3.7">
        <h3 id="name-entropy-code">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-entropy-code" class="section-name selfRef">Entropy Code</a>
        </h3>
<section id="section-3.7.1">
          <h4 id="name-overview">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
          </h4>
<p id="section-3.7.1-1">Most of the data is coded using a <span><a href="#Huffman" class="internal xref">canonical
           prefix code</a> [<a href="#Huffman" class="cite xref">Huffman</a>]</span>. Hence, the codes are transmitted by sending the
           <em>prefix code lengths</em>, as opposed to the actual <em>prefix
             codes</em>.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">In particular, the format uses <strong>spatially variant prefix
           coding</strong>. In other words, different blocks of the image can
             potentially use different entropy codes.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
<aside id="section-3.7.1-3">
            <p id="section-3.7.1-3.1">Rationale: Different areas of the image may have different
           characteristics. So, allowing them to use different entropy codes
           provides more flexibility and potentially better compression.<a href="#section-3.7.1-3.1" class="pilcrow">¶</a></p>
</aside>
</section>
<section id="section-3.7.2">
          <h4 id="name-details">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-details" class="section-name selfRef">Details</a>
          </h4>
<p id="section-3.7.2-1">The encoded image data consists of several parts:<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.7.2-2">
           <li id="section-3.7.2-2.1">Decoding and building the prefix codes.<a href="#section-3.7.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.7.2-2.2">Meta prefix codes.<a href="#section-3.7.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.7.2-2.3">Entropy-coded image data.<a href="#section-3.7.2-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.7.2-3">For any given pixel (x, y), there is a set of five prefix codes
           associated with it. These codes are (in bitstream order):<a href="#section-3.7.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2-4.1">
              <strong>Prefix code #1</strong>: Used for green channel,
             backward-reference length, and color cache.<a href="#section-3.7.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.7.2-4.2">
              <strong>Prefix code #2, #3, and #4</strong>: Used for red,
             blue, and alpha channels, respectively.<a href="#section-3.7.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.7.2-4.3">
              <strong>Prefix code #5</strong>: Used for backward-reference
             distance.<a href="#section-3.7.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.7.2-5">From here on, we refer to this set as a <strong>prefix code
           group</strong>.<a href="#section-3.7.2-5" class="pilcrow">¶</a></p>
<div id="decoding-and-building-the-prefix-codes">
<section id="section-3.7.2.1">
            <h5 id="name-decoding-and-building-the-p">
<a href="#section-3.7.2.1" class="section-number selfRef">3.7.2.1. </a><a href="#name-decoding-and-building-the-p" class="section-name selfRef">Decoding and Building the Prefix Codes</a>
            </h5>
<p id="section-3.7.2.1-1">This section describes how to read the prefix code lengths from
             the bitstream.<a href="#section-3.7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1-2">The prefix code lengths can be coded in two ways. The method
             used is specified by a 1-bit value.<a href="#section-3.7.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2.1-3.1">If this bit is 1, it is a <em>simple code length code</em>.<a href="#section-3.7.2.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.7.2.1-3.2">If this bit is 0, it is a <em>normal code length
               code</em>.<a href="#section-3.7.2.1-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.7.2.1-4">In both cases, there can be unused code lengths that are still
             part of the stream. This may be inefficient, but it is allowed by
             the format. The described tree must be a complete binary tree. A
             single leaf node is considered a complete binary tree and can be
             encoded using either the simple code length code or the normal
             code length code. When coding a single leaf node using the
             <em>normal code length code</em>, all but one code length are
             zeros, and the single leaf node value is marked with the length
             of 1 -- even when no bits are consumed when that single leaf node
             tree is used.<a href="#section-3.7.2.1-4" class="pilcrow">¶</a></p>
<div id="simple-code-length">
<section id="section-3.7.2.1.1">
              <h6 id="name-simple-code-length-code">
<a href="#section-3.7.2.1.1" class="section-number selfRef">3.7.2.1.1. </a><a href="#name-simple-code-length-code" class="section-name selfRef">Simple Code Length Code</a>
              </h6>
<p id="section-3.7.2.1.1-1">This variant is used in the special case when only 1 or 2 prefix
             symbols are in the range [0..255] with code length <code>1</code>. All
             other prefix code lengths are implicitly zeros.<a href="#section-3.7.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1.1-2">The first bit indicates the number of symbols:<a href="#section-3.7.2.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.1.1-3">
<pre>
int num_symbols = ReadBits(1) + 1;
</pre><a href="#section-3.7.2.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.1.1-4">The following are the symbol values. This first symbol is coded using
             1 or 8 bits, depending on the value of <code>is_first_8bits</code>. The
             range is [0..1] or [0..255], respectively. The second symbol, if
             present, is always assumed to be in the range [0..255] and coded
             using 8 bits.<a href="#section-3.7.2.1.1-4" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.1.1-5">
<pre>
int is_first_8bits = ReadBits(1);
symbol0 = ReadBits(1 + 7 * is_first_8bits);
code_lengths[symbol0] = 1;
if (num_symbols == 2) {
  symbol1 = ReadBits(8);
  code_lengths[symbol1] = 1;
}
</pre><a href="#section-3.7.2.1.1-5" class="pilcrow">¶</a>
</div>
<aside id="section-3.7.2.1.1-6">
                <p id="section-3.7.2.1.1-6.1">The two symbols should be different. Duplicate symbols are
             allowed, but inefficient.<a href="#section-3.7.2.1.1-6.1" class="pilcrow">¶</a></p>
</aside>
<aside id="section-3.7.2.1.1-7">
                <p id="section-3.7.2.1.1-7.1">Note: Another special case is when <em>all</em> prefix code
             lengths are <em>zeros</em> (an empty prefix code). For example, a
             prefix code for distance can be empty if there are no backward
             references. Similarly, prefix codes for alpha, red, and blue can
             be empty if all pixels within the same meta prefix code are
             produced using the color cache. However, this case doesn't need
             special handling, as empty prefix codes can be coded as those
             containing a single symbol <code>0</code>.<a href="#section-3.7.2.1.1-7.1" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="normal-code-length">
<section id="section-3.7.2.1.2">
              <h6 id="name-normal-code-length-code">
<a href="#section-3.7.2.1.2" class="section-number selfRef">3.7.2.1.2. </a><a href="#name-normal-code-length-code" class="section-name selfRef">Normal Code Length Code</a>
              </h6>
<p id="section-3.7.2.1.2-1">The code lengths of the prefix code fit in 8 bits and are read
             as follows. First, <code>num_code_lengths</code> specifies the number
             of code lengths.<a href="#section-3.7.2.1.2-1" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.1.2-2">
<pre>
int num_code_lengths = 4 + ReadBits(4);
</pre><a href="#section-3.7.2.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.1.2-3">The code lengths are themselves encoded using prefix codes;
             lower-level code lengths, <code>code_length_code_lengths</code>, first
             have to be read. The rest of those
             <code>code_length_code_lengths</code> (according to the order in
             <code>kCodeLengthCodeOrder</code>) are zeros.<a href="#section-3.7.2.1.2-3" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.1.2-4">
<pre>
int kCodeLengthCodes = 19;
int kCodeLengthCodeOrder[kCodeLengthCodes] = {
  17, 18, 0, 1, 2, 3, 4, 5, 16, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
};
int code_length_code_lengths[kCodeLengthCodes] = { 0 };  // All zeros
for (i = 0; i &lt; num_code_lengths; ++i) {
  code_length_code_lengths[kCodeLengthCodeOrder[i]] = ReadBits(3);
}
</pre><a href="#section-3.7.2.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.1.2-5">Next, if <code>ReadBits(1) == 0</code>, the maximum number of
             different read symbols (<code>max_symbol</code>) for each symbol type
             (A, R, G, B, and distance) is set to its alphabet size:<a href="#section-3.7.2.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2.1.2-6.1">G channel: 256 + 24 + <code>color_cache_size</code><a href="#section-3.7.2.1.2-6.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.7.2.1.2-6.2">Other literals (A, R, and B): 256<a href="#section-3.7.2.1.2-6.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.7.2.1.2-6.3">Distance code: 40<a href="#section-3.7.2.1.2-6.3" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-3.7.2.1.2-7">Otherwise, it is defined as:<a href="#section-3.7.2.1.2-7" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.1.2-8">
<pre>
int length_nbits = 2 + 2 * ReadBits(3);
int max_symbol = 2 + ReadBits(length_nbits);
</pre><a href="#section-3.7.2.1.2-8" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.1.2-9">If <code>max_symbol</code> is larger than the size of the alphabet
             for the symbol type, the bitstream is invalid.<a href="#section-3.7.2.1.2-9" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1.2-10">A prefix table is then built from
             <code>code_length_code_lengths</code> and used to read up to
             <code>max_symbol</code> code lengths.<a href="#section-3.7.2.1.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2.1.2-11.1">
                  <p id="section-3.7.2.1.2-11.1.1">Code [0..15] indicates literal code lengths.<a href="#section-3.7.2.1.2-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2.1.2-11.1.2.1">Value 0 means no symbols have been coded.<a href="#section-3.7.2.1.2-11.1.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-3.7.2.1.2-11.1.2.2">Values [1..15] indicate the bit length of the respective
                   code.<a href="#section-3.7.2.1.2-11.1.2.2" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-3.7.2.1.2-11.2">Code 16 repeats the previous nonzero value [3..6] times,
               that is, <code>3 + ReadBits(2)</code> times. If code 16 is used before
                 a nonzero value has been emitted, a value of 8 is
                 repeated.<a href="#section-3.7.2.1.2-11.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.7.2.1.2-11.3">Code 17 emits a streak of zeros of length [3..10], that is, <code>3 +
               ReadBits(3)</code> times.<a href="#section-3.7.2.1.2-11.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-3.7.2.1.2-11.4">Code 18 emits a streak of zeros of length [11..138], that is,
               <code>11 + ReadBits(7)</code> times.<a href="#section-3.7.2.1.2-11.4" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-3.7.2.1.2-12">Once code lengths are read, a prefix code for each symbol type
             (A, R, G, B, and distance) is formed using their respective alphabet
             sizes.<a href="#section-3.7.2.1.2-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="decoding-of-meta-prefix-codes">
<section id="section-3.7.2.2">
            <h5 id="name-decoding-of-meta-prefix-cod">
<a href="#section-3.7.2.2" class="section-number selfRef">3.7.2.2. </a><a href="#name-decoding-of-meta-prefix-cod" class="section-name selfRef">Decoding of Meta Prefix Codes</a>
            </h5>
<p id="section-3.7.2.2-1">As noted earlier, the format allows the use of different prefix
             codes for different blocks of the image. <em>Meta prefix
               codes</em> are indexes identifying which prefix codes to use in
                 different parts of the image.<a href="#section-3.7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2-2">Meta prefix codes may be used <em>only</em> when the image is
             being used in the <span><a href="#roles-of-image-data" class="internal xref">role</a> (<a href="#roles-of-image-data" class="auto internal xref">Section 3.6.1</a>)</span>
               of an <em>ARGB image</em>.<a href="#section-3.7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2-3">There are two possibilities for the meta prefix codes, indicated
             by a 1-bit value:<a href="#section-3.7.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.2.2-4.1">If this bit is zero, there is only one meta prefix code used
               everywhere in the image. No more data is stored.<a href="#section-3.7.2.2-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.7.2.2-4.2">If this bit is one, the image uses multiple meta prefix
               codes. These meta prefix codes are stored as an <em>entropy
                 image</em> (described below).<a href="#section-3.7.2.2-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.7.2.2-5">The red and green components of a pixel define a 16-bit meta
             prefix code used in a particular block of the ARGB image.<a href="#section-3.7.2.2-5" class="pilcrow">¶</a></p>
<div id="entropy-image">
<section id="section-3.7.2.2.1">
              <h6 id="name-entropy-image">
<a href="#section-3.7.2.2.1" class="section-number selfRef">3.7.2.2.1. </a><a href="#name-entropy-image" class="section-name selfRef">Entropy Image</a>
              </h6>
<p id="section-3.7.2.2.1-1">The entropy image defines which prefix codes are used in
             different parts of the image.<a href="#section-3.7.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2.1-2">The first 3 bits contain the <code>prefix_bits</code> value. The
             dimensions of the entropy image are derived from
             <code>prefix_bits</code>:<a href="#section-3.7.2.2.1-2" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.2.1-3">
<pre>
int prefix_bits = ReadBits(3) + 2;
int prefix_image_width =
    DIV_ROUND_UP(image_width, 1 &lt;&lt; prefix_bits);
int prefix_image_height =
    DIV_ROUND_UP(image_height, 1 &lt;&lt; prefix_bits);
</pre><a href="#section-3.7.2.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.2.1-4">where <code>DIV_ROUND_UP</code> is as defined in <a href="#predictor-transform" class="auto internal xref">Section 3.5.1</a>.<a href="#section-3.7.2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2.1-5">The next bits contain an entropy image of width
             <code>prefix_image_width</code> and height <code>prefix_image_height</code>.<a href="#section-3.7.2.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interp-meta-prefix-codes">
<section id="section-3.7.2.2.2">
              <h6 id="name-interpretation-of-meta-pref">
<a href="#section-3.7.2.2.2" class="section-number selfRef">3.7.2.2.2. </a><a href="#name-interpretation-of-meta-pref" class="section-name selfRef">Interpretation of Meta Prefix Codes</a>
              </h6>
<p id="section-3.7.2.2.2-1">The number of prefix code groups in the ARGB image can be
             obtained by finding the <em>largest meta prefix code</em> from
               the entropy image:<a href="#section-3.7.2.2.2-1" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.2.2-2">
<pre>
int num_prefix_groups = max(entropy image) + 1;
</pre><a href="#section-3.7.2.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.2.2-3">where <code>max(entropy image)</code> indicates the largest prefix
             code stored in the entropy image.<a href="#section-3.7.2.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2.2-4">As each prefix code group contains five prefix codes, the
             total number of prefix codes is:<a href="#section-3.7.2.2.2-4" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.2.2-5">
<pre>
int num_prefix_codes = 5 * num_prefix_groups;
</pre><a href="#section-3.7.2.2.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.2.2-6">Given a pixel (x, y) in the ARGB image, we can obtain the
             corresponding prefix codes to be used as follows:<a href="#section-3.7.2.2.2-6" class="pilcrow">¶</a></p>
<div class="lang-c sourcecode" id="section-3.7.2.2.2-7">
<pre>
int position =
    (y &gt;&gt; prefix_bits) * prefix_image_width + (x &gt;&gt; prefix_bits);
int meta_prefix_code = (entropy_image[position] &gt;&gt; 8) &amp; 0xffff;
PrefixCodeGroup prefix_group = prefix_code_groups[meta_prefix_code];
</pre><a href="#section-3.7.2.2.2-7" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.2.2-8">where we have assumed the existence of <code>PrefixCodeGroup</code>
             structure, which represents a set of five prefix codes. Also,
             <code>prefix_code_groups</code> is an array of
             <code>PrefixCodeGroup</code> (of size <code>num_prefix_groups</code>).<a href="#section-3.7.2.2.2-8" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2.2-9">The decoder then uses prefix code group <code>prefix_group</code> to
             decode the pixel (x, y), as explained in <a href="#decoding-entropy-coded-image-data" class="auto internal xref">Section 3.7.2.3</a>.<a href="#section-3.7.2.2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="decoding-entropy-coded-image-data">
<section id="section-3.7.2.3">
            <h5 id="name-decoding-entropy-coded-imag">
<a href="#section-3.7.2.3" class="section-number selfRef">3.7.2.3. </a><a href="#name-decoding-entropy-coded-imag" class="section-name selfRef">Decoding Entropy-Coded Image Data</a>
            </h5>
<p id="section-3.7.2.3-1">For the current position (x, y) in the image, the decoder first
             identifies the corresponding prefix code group (as explained in
             the last section). Given the prefix code group, the pixel is read
             and decoded as follows.<a href="#section-3.7.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.3-2">Next, read symbol S from the bitstream using prefix code #1.<a href="#section-3.7.2.3-2" class="pilcrow">¶</a></p>
<aside id="section-3.7.2.3-3">
              <p id="section-3.7.2.3-3.1">Note that S is any integer in the range <code>0</code> to
           <code>(256 + 24 + color_cache_size - 1)</code>. See <a href="#color-cache-coding" class="auto internal xref">Section 3.6.2.3</a> for details about
           <code>color_cache_size</code>.<a href="#section-3.7.2.3-3.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.7.2.3-4">The interpretation of S depends on its value:<a href="#section-3.7.2.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.7.2.3-5">
             <li id="section-3.7.2.3-5.1">
                <p id="section-3.7.2.3-5.1.1">If S &lt; 256<a href="#section-3.7.2.3-5.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-3.7.2.3-5.1.2">
                 <li id="section-3.7.2.3-5.1.2.1">Use S as the green component.<a href="#section-3.7.2.3-5.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.1.2.2">Read red from the bitstream using prefix code #2.<a href="#section-3.7.2.3-5.1.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.1.2.3">Read blue from the bitstream using prefix code #3.<a href="#section-3.7.2.3-5.1.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.1.2.4">Read alpha from the bitstream using prefix code #4.<a href="#section-3.7.2.3-5.1.2.4" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-3.7.2.3-5.2">
                <p id="section-3.7.2.3-5.2.1">If S &gt;= 256 &amp; S &lt; 256 + 24<a href="#section-3.7.2.3-5.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-3.7.2.3-5.2.2">
                 <li id="section-3.7.2.3-5.2.2.1">Use S - 256 as a length prefix code.<a href="#section-3.7.2.3-5.2.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.2">Read extra bits for the length from the bitstream.<a href="#section-3.7.2.3-5.2.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.3">Determine backward-reference length L from length prefix
                   code and the extra bits read.<a href="#section-3.7.2.3-5.2.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.4">Read the distance prefix code from the bitstream using prefix
                   code #5.<a href="#section-3.7.2.3-5.2.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.5">Read extra bits for the distance from the bitstream.<a href="#section-3.7.2.3-5.2.2.5" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.6">Determine backward-reference distance D from the distance
                 prefix code and the extra bits read.<a href="#section-3.7.2.3-5.2.2.6" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.2.2.7">Copy L pixels (in scan-line order) from the sequence of pixels
starting at the current position minus D pixels.<a href="#section-3.7.2.3-5.2.2.7" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-3.7.2.3-5.3">
                <p id="section-3.7.2.3-5.3.1">If S &gt;= 256 + 24<a href="#section-3.7.2.3-5.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-3.7.2.3-5.3.2">
                 <li id="section-3.7.2.3-5.3.2.1">Use S - (256 + 24) as the index into the color cache.<a href="#section-3.7.2.3-5.3.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-3.7.2.3-5.3.2.2">Get ARGB color from the color cache at that index.<a href="#section-3.7.2.3-5.3.2.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
</section>
</div>
</section>
</section>
<section id="section-3.8">
        <h3 id="name-overall-structure-of-the-fo">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-overall-structure-of-the-fo" class="section-name selfRef">Overall Structure of the Format</a>
        </h3>
<p id="section-3.8-1">Below is a view into the format in Augmented Backus-Naur Form <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span> <span>[<a href="#RFC7405" class="cite xref">RFC7405</a>]</span>. It does not cover all details. The end-of-image (EOI)
         is only implicitly coded into the number of pixels (image_width *
       image_height).<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<aside id="section-3.8-2">
          <p id="section-3.8-2.1">Note that <code>*element</code> means <code>element</code> can be repeated 0 or more times. <code>5element</code>
means <code>element</code> is repeated exactly 5 times. <code>%b</code> represents a binary value.<a href="#section-3.8-2.1" class="pilcrow">¶</a></p>
</aside>
<section id="section-3.8.1">
          <h4 id="name-basic-structure">
<a href="#section-3.8.1" class="section-number selfRef">3.8.1. </a><a href="#name-basic-structure" class="section-name selfRef">Basic Structure</a>
          </h4>
<div class="lang-abnf sourcecode" id="section-3.8.1-1">
<pre>
format        = RIFF-header image-header image-stream
RIFF-header   = %s"RIFF" 4OCTET %s"WEBPVP8L" 4OCTET
image-header  = %x2F image-size alpha-is-used version
image-size    = 14BIT 14BIT ; width - 1, height - 1
alpha-is-used = 1BIT
version       = 3BIT ; 0
image-stream  = optional-transform spatially-coded-image
</pre><a href="#section-3.8.1-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-3.8.2">
          <h4 id="name-structure-of-transforms">
<a href="#section-3.8.2" class="section-number selfRef">3.8.2. </a><a href="#name-structure-of-transforms" class="section-name selfRef">Structure of Transforms</a>
          </h4>
<div class="lang-abnf sourcecode" id="section-3.8.2-1">
<pre>
optional-transform   =  (%b1 transform optional-transform) / %b0
transform            =  predictor-tx / color-tx / subtract-green-tx
transform            =/ color-indexing-tx

predictor-tx         =  %b00 predictor-image
predictor-image      =  3BIT ; sub-pixel code
                        entropy-coded-image

color-tx             =  %b01 color-image
color-image          =  3BIT ; sub-pixel code
                        entropy-coded-image

subtract-green-tx    =  %b10

color-indexing-tx    =  %b11 color-indexing-image
color-indexing-image =  8BIT ; color count
                        entropy-coded-image
</pre><a href="#section-3.8.2-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-3.8.3">
          <h4 id="name-structure-of-the-image-data">
<a href="#section-3.8.3" class="section-number selfRef">3.8.3. </a><a href="#name-structure-of-the-image-data" class="section-name selfRef">Structure of the Image Data</a>
          </h4>
<div class="lang-abnf sourcecode" id="section-3.8.3-1">
<pre>
spatially-coded-image =  color-cache-info meta-prefix data
entropy-coded-image   =  color-cache-info data

color-cache-info      =  %b0
color-cache-info      =/ (%b1 4BIT) ; 1 followed by color cache size

meta-prefix           =  %b0 / (%b1 entropy-image)

data                  =  prefix-codes lz77-coded-image
entropy-image         =  3BIT ; subsample value
                         entropy-coded-image

prefix-codes          =  prefix-code-group *prefix-codes
prefix-code-group     =
    5prefix-code ; See "Interpretation of Meta Prefix Codes" to
                 ; understand what each of these five prefix
                 ; codes are for.

prefix-code           =  simple-prefix-code / normal-prefix-code
simple-prefix-code    =  ; see "Simple Code Length Code" for details
normal-prefix-code    =  ; see "Normal Code Length Code" for details

lz77-coded-image      =
    *((argb-pixel / lz77-copy / color-cache-code) lz77-coded-image)
</pre><a href="#section-3.8.3-1" class="pilcrow">¶</a>
</div>
<p id="section-3.8.3-2">The following is a possible example sequence:<a href="#section-3.8.3-2" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-3.8.3-3">
<pre>
RIFF-header image-size %b1 subtract-green-tx
%b1 predictor-tx %b0 color-cache-info
%b0 prefix-codes lz77-coded-image
</pre><a href="#section-3.8.3-3" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
</div>
<div id="Security">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">Implementations of this format face security risks, such as integer
       overflows, out-of-bounds reads and writes to both heap and stack,
       uninitialized data usage, null pointer dereferences, resource (disk or
       memory) exhaustion, and extended resource usage (long running time) as
       part of the demuxing and decoding process. In particular,
       implementations reading this format are likely to take input from
       unknown and possibly unsafe sources -- both clients (for example, web browsers or
       email clients) and servers (for example, applications that accept uploaded
       images). These may result in arbitrary code execution, information
       leakage (memory layout and contents), or crashes and thereby allow a
       device to be compromised or cause a denial of service to an application
       using the format <span>[<a href="#mitre-libwebp" class="cite xref">mitre-libwebp</a>]</span> <span>[<a href="#issues-security" class="cite xref">issues-security</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The format does not employ "active content" but does allow metadata
     (for example, <span>[<a href="#XMP" class="cite xref">XMP</a>]</span> and <span>[<a href="#Exif" class="cite xref">Exif</a>]</span>) and custom chunks to be
       embedded in a file. Applications that interpret these chunks may be
       subject to security considerations for those formats.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Interop">
<section id="section-5">
      <h2 id="name-interoperability-considerat">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-interoperability-considerat" class="section-name selfRef">Interoperability Considerations</a>
      </h2>
<p id="section-5-1">The format is defined using little-endian byte ordering (see <span><a href="https://rfc-editor.org/rfc/rfc2781#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC2781" class="cite xref">RFC2781</a>]</span>), but demuxing and decoding are
       possible on platforms using a different ordering with the appropriate
       conversion.

       The container is based on RIFF and allows extension via user-defined
       chunks, but nothing beyond the chunks defined by the container format
       (<a href="#webp-container" class="auto internal xref">Section 2</a>) are required for decoding of the image.
       These have been finalized, but they were extended in the format's early
       stages, so some older readers may not support lossless or animated image
       decoding.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">IANA has registered the 'image/webp' media type <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="webp-media-type">
<section id="section-6.1">
        <h3 id="name-the-image-webp-media-type">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-the-image-webp-media-type" class="section-name selfRef">The 'image/webp' Media Type</a>
        </h3>
<p id="section-6.1-1">This section contains the media type registration details per <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<section id="section-6.1.1">
          <h4 id="name-registration-details">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-registration-details" class="section-name selfRef">Registration Details</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-6.1.1-1">
            <dt id="section-6.1.1-1.1">Type name:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.2">image<a href="#section-6.1.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.3">Subtype name:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.4">webp<a href="#section-6.1.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.5">Required parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.6">N/A<a href="#section-6.1.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.7">Optional parameters:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.8">N/A<a href="#section-6.1.1-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.9">Encoding considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.10">Binary. The <span><a href="#RFC4648" class="internal xref">Base64
           encoding</a> [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> should be used on transports that cannot accommodate
           binary data directly.<a href="#section-6.1.1-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.11">Security considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.12">See RFC 9649, <a href="#Security" class="auto internal xref">Section 4</a>.<a href="#section-6.1.1-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.13">Interoperability considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.14">See RFC 9649, <a href="#Interop" class="auto internal xref">Section 5</a>.<a href="#section-6.1.1-1.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.15">Published specification:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.16">RFC 9649<a href="#section-6.1.1-1.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.17">Applications that use this media type:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.18">Applications that are used to
           display and process images, especially when smaller image file sizes
           are important.<a href="#section-6.1.1-1.18" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.19">Fragment identifier considerations:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.20">N/A<a href="#section-6.1.1-1.20" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.21">Additional information:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.22">
              <p id="section-6.1.1-1.22.1"><br></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-6.1.1-1.22.2">
                <dt id="section-6.1.1-1.22.2.1">Deprecated alias names for this type:</dt>
                <dd style="margin-left: 1.5em" id="section-6.1.1-1.22.2.2">N/A<a href="#section-6.1.1-1.22.2.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.1.1-1.22.2.3">Magic number(s):</dt>
                <dd style="margin-left: 1.5em" id="section-6.1.1-1.22.2.4">The first 4 bytes are 0x52, 0x49, 0x46, 0x46
             ('RIFF'), followed by 4 bytes for the 'RIFF' Chunk size. The next 7
             bytes are 0x57, 0x45, 0x42, 0x50, 0x56, 0x50, 0x38
             ('WEBPVP8').<a href="#section-6.1.1-1.22.2.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.1.1-1.22.2.5">File extension(s):</dt>
                <dd style="margin-left: 1.5em" id="section-6.1.1-1.22.2.6">webp<a href="#section-6.1.1-1.22.2.6" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.1.1-1.22.2.7">Apple Uniform Type Identifier:</dt>
                <dd style="margin-left: 1.5em" id="section-6.1.1-1.22.2.8">org.webmproject.webp conforms to
               public.image<a href="#section-6.1.1-1.22.2.8" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.1.1-1.22.2.9">Object Identifiers:</dt>
                <dd style="margin-left: 1.5em" id="section-6.1.1-1.22.2.10">N/A<a href="#section-6.1.1-1.22.2.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-1.23">Person &amp; email address to contact for further information:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-1.24">James Zern &lt;jzern@google.com&gt;<a href="#section-6.1.1-1.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlParallel" id="section-6.1.1-2">
            <dt id="section-6.1.1-2.1">Intended usage:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.2">COMMON<a href="#section-6.1.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.3">Restrictions on usage:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.4">N/A<a href="#section-6.1.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.5">Author:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.6">James Zern &lt;jzern@google.com&gt;<a href="#section-6.1.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.1.1-2.7">Change controller:</dt>
            <dd style="margin-left: 1.5em" id="section-6.1.1-2.8">IETF<a href="#section-6.1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="Exif">[Exif]</dt>
        <dd>
<span class="refAuthor">Camera &amp; Imaging Products Association (CIPA)</span> and <span class="refAuthor">Japan Electronics and Information Technology Industries Association (JEITA)</span>, <span class="refTitle">"Exchangeable image file format for digital still cameras: Exif Version 2.3"</span>, <span class="seriesInfo">CIPA DC-008-2012</span>, <span class="seriesInfo">JEITA CP-3451C</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf">https://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ICC">[ICC]</dt>
        <dd>
<span class="refAuthor">International Color Consortium</span>, <span class="refTitle">"Image technology colour management -- Architecture, profile format, and data structure"</span>, <span class="refContent">Profile version 4.3.0.0, REVISION of ICC.1:2004-10</span>, <span class="seriesInfo">Specification ICC.1:2010</span>, <time datetime="2010-12" class="refDate">December 2010</time>, <span>&lt;<a href="https://www.color.org/specification/ICC1v43_2010-12.pdf">https://www.color.org/specification/ICC1v43_2010-12.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.9899.2018">[ISO.9899.2018]</dt>
        <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Information technology -- Programming languages -- C"</span>, <span class="refContent">Fourth Edition</span>, <span class="seriesInfo">ISO/IEC 9899:2018</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.iso.org/standard/74528.html">https://www.iso.org/standard/74528.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REC601">[REC601]</dt>
        <dd>
<span class="refAuthor">ITU</span>, <span class="refTitle">"Studio encoding parameters of digital television for standard 4:3 and wide screen 16:9 aspect ratios"</span>, <span class="seriesInfo">ITU-R Recommendation BT.601</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.itu.int/rec/R-REC-BT.601/">https://www.itu.int/rec/R-REC-BT.601/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1166">[RFC1166]</dt>
        <dd>
<span class="refAuthor">Kirkpatrick, S.</span>, <span class="refAuthor">Stahl, M.</span>, and <span class="refAuthor">M. Recker</span>, <span class="refTitle">"Internet numbers"</span>, <span class="seriesInfo">RFC 1166</span>, <span class="seriesInfo">DOI 10.17487/RFC1166</span>, <time datetime="1990-07" class="refDate">July 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1166">https://www.rfc-editor.org/info/rfc1166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2781">[RFC2781]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">F. Yergeau</span>, <span class="refTitle">"UTF-16, an encoding of ISO 10646"</span>, <span class="seriesInfo">RFC 2781</span>, <span class="seriesInfo">DOI 10.17487/RFC2781</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2781">https://www.rfc-editor.org/info/rfc2781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6386">[RFC6386]</dt>
        <dd>
<span class="refAuthor">Bankoski, J.</span>, <span class="refAuthor">Koleszar, J.</span>, <span class="refAuthor">Quillio, L.</span>, <span class="refAuthor">Salonen, J.</span>, <span class="refAuthor">Wilkins, P.</span>, and <span class="refAuthor">Y. Xu</span>, <span class="refTitle">"VP8 Data Format and Decoding Guide"</span>, <span class="seriesInfo">RFC 6386</span>, <span class="seriesInfo">DOI 10.17487/RFC6386</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6386">https://www.rfc-editor.org/info/rfc6386</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7405">[RFC7405]</dt>
        <dd>
<span class="refAuthor">Kyzivat, P.</span>, <span class="refTitle">"Case-Sensitive String Support in ABNF"</span>, <span class="seriesInfo">RFC 7405</span>, <span class="seriesInfo">DOI 10.17487/RFC7405</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7405">https://www.rfc-editor.org/info/rfc7405</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XMP">[XMP]</dt>
      <dd>
<span class="refAuthor">Adobe Inc.</span>, <span class="refTitle">"XMP Specification"</span>, <span>&lt;<a href="https://www.adobe.com/devnet/xmp.html">https://www.adobe.com/devnet/xmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="GIF-spec">[GIF-spec]</dt>
        <dd>
<span class="refAuthor">CompuServe Incorporated</span>, <span class="refTitle">"Graphics Interchange Format(sm)"</span>, <span class="refContent">Version 89a</span>, <time datetime="1990-07" class="refDate">July 1990</time>, <span>&lt;<a href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">https://www.w3.org/Graphics/GIF/spec-gif89a.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Huffman">[Huffman]</dt>
        <dd>
<span class="refAuthor">Huffman, D.</span>, <span class="refTitle">"A Method for the Construction of Minimum-Redundancy Codes"</span>, <span class="refContent">Proceedings of the Institute of Radio Engineers, Vol. 40, Issue 9, pp. 1098-1101</span>, <span class="seriesInfo">DOI 10.1109/JRPROC.1952.273898</span>, <time datetime="1952-09" class="refDate">September 1952</time>, <span>&lt;<a href="https://doi.org/10.1109/JRPROC.1952.273898">https://doi.org/10.1109/JRPROC.1952.273898</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="issues-security">[issues-security]</dt>
        <dd>
<span class="refTitle">"libwebp Security Issues"</span>, <span>&lt;<a href="https://issues.webmproject.org/issues?q=componentid:1618983%2B%20(%22Restrict-View-Security%22%20OR%20type:vulnerability)">https://issues.webmproject.org/issues?q=componentid:1618983%2B%20(%22Restrict-View-Security%22%20OR%20type:vulnerability)</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JPEG-spec">[JPEG-spec]</dt>
        <dd>
<span class="refTitle">"Information Technology - Digital Compression and Coding of Continuous-Tone Still Images - Requirements and Guidelines"</span>, <span class="seriesInfo">ITU-T Recommendation T.81</span>, <span class="seriesInfo">ISO/IEC 10918-1</span>, <time datetime="1992-09" class="refDate">September 1992</time>, <span>&lt;<a href="https://www.w3.org/Graphics/JPEG/itu-t81.pdf">https://www.w3.org/Graphics/JPEG/itu-t81.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LZ77">[LZ77]</dt>
        <dd>
<span class="refAuthor">Ziv, J.</span> and <span class="refAuthor">A. Lempel</span>, <span class="refTitle">"A Universal Algorithm for Sequential Data Compression"</span>, <span class="refContent">IEEE Transactions on Information Theory, Vol. 23, Issue 3, pp. 337-343</span>, <span class="seriesInfo">DOI 10.1109/TIT.1977.1055714</span>, <time datetime="1977-05" class="refDate">May 1977</time>, <span>&lt;<a href="https://doi.org/10.1109/TIT.1977.1055714">https://doi.org/10.1109/TIT.1977.1055714</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="mitre-libwebp">[mitre-libwebp]</dt>
        <dd>
<span class="refTitle">"libwebp CVE List"</span>, <span>&lt;<a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=libwebp">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=libwebp</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MWG">[MWG]</dt>
        <dd>
<span class="refAuthor">Metadata Working Group</span>, <span class="refTitle">"Guidelines For Handling Image Metadata"</span>, <span class="refContent">Version 2.0</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://web.archive.org/web/20180919181934/http://www.metadataworkinggroup.org/pdf/mwg_guidance.pdf">https://web.archive.org/web/20180919181934/http://www.metadataworkinggroup.org/pdf/mwg_guidance.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2083">[RFC2083]</dt>
        <dd>
<span class="refAuthor">Boutell, T.</span>, <span class="refTitle">"PNG (Portable Network Graphics) Specification Version 1.0"</span>, <span class="seriesInfo">RFC 2083</span>, <span class="seriesInfo">DOI 10.17487/RFC2083</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2083">https://www.rfc-editor.org/info/rfc2083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIFF-spec">[RIFF-spec]</dt>
        <dd>
<span class="refTitle">"RIFF (Resource Interchange File Format)"</span>, <span>&lt;<a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000025.shtml">https://www.loc.gov/preservation/digital/formats/fdd/fdd000025.shtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webp-lossless-src">[webp-lossless-src]</dt>
        <dd>
<span class="refTitle">"WebP Lossless Bitstream Specification"</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://chromium.googlesource.com/webm/libwebp/+/refs/tags/webp-rfc9649/doc/webp-lossless-bitstream-spec.txt">https://chromium.googlesource.com/webm/libwebp/+/refs/tags/webp-rfc9649/doc/webp-lossless-bitstream-spec.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webp-lossless-study">[webp-lossless-study]</dt>
        <dd>
<span class="refAuthor">Alakuijala, J.</span> and <span class="refAuthor">V. Rabaud</span>, <span class="refTitle">"Lossless and Transparency Encoding in WebP"</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="https://developers.google.com/speed/webp/docs/webp_lossless_alpha_study">https://developers.google.com/speed/webp/docs/webp_lossless_alpha_study</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webp-riff-src">[webp-riff-src]</dt>
      <dd>
<span class="refTitle">"WebP RIFF Container"</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://chromium.googlesource.com/webm/libwebp/+/refs/tags/webp-rfc9649/doc/webp-container-spec.txt">https://chromium.googlesource.com/webm/libwebp/+/refs/tags/webp-rfc9649/doc/webp-container-spec.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">James Zern</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20650%20253-0000" class="tel">+1 650 253-0000</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:jzern@google.com" class="email">jzern@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Massimino</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pascal.massimino@gmail.com" class="email">pascal.massimino@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jyrki Alakuijala</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jyrki.alakuijala@gmail.com" class="email">jyrki.alakuijala@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
