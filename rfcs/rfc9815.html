<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9815: BGP Link State (BGP-LS) Shortest Path First (SPF) Routing</title>
<meta content="Keyur Patel" name="author">
<meta content="Acee Lindem" name="author">
<meta content="Shawn Zandi" name="author">
<meta content="Wim Henderickx" name="author">
<meta content="
       
        Many Massively Scaled Data Centers (MSDCs) have converged on simplified
        Layer 3 (L3) routing. Furthermore, requirements for operational simplicity
        have led many of these MSDCs to converge on BGP as their single routing
        protocol for both fabric routing and Data Center Interconnect
        (DCI) routing. This document describes extensions to BGP for use with BGP Link State (BGP-LS) distribution and the Shortest Path First (SPF) algorithm.
        In doing this, it allows
        BGP to be efficiently used as both the underlay protocol and the overlay protocol in
        MSDCs.
       
    " name="description">
<meta content="xml2rfc 3.30.0" name="generator">
<meta content="IDR" name="keyword">
<meta content="9815" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.30.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9815.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-lsvr-bgp-spf-51" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9815" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9815</td>
<td class="center">BGP-LS SPF Routing</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Patel, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9815" class="eref">9815</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07" class="published">July 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Patel</div>
<div class="org">Arrcus, Inc.</div>
</div>
<div class="author">
      <div class="author-name">A. Lindem</div>
<div class="org">Arrcus, Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Zandi</div>
</div>
<div class="author">
      <div class="author-name">W. Henderickx</div>
<div class="org">Nokia</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9815</h1>
<h1 id="title">BGP Link State (BGP-LS) Shortest Path First (SPF) Routing</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        Many Massively Scaled Data Centers (MSDCs) have converged on simplified
        Layer 3 (L3) routing. Furthermore, requirements for operational simplicity
        have led many of these MSDCs to converge on BGP as their single routing
        protocol for both fabric routing and Data Center Interconnect
        (DCI) routing. This document describes extensions to BGP for use with BGP Link State (BGP-LS) distribution and the Shortest Path First (SPF) algorithm.
        In doing this, it allows
        BGP to be efficiently used as both the underlay protocol and the overlay protocol in
        MSDCs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9815">https://www.rfc-editor.org/info/rfc9815</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-bgp-shortest-path-first-spf" class="internal xref">BGP Shortest Path First (SPF) Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-document-overview" class="internal xref">Document Overview</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-base-bgp-protocol-relations" class="internal xref">Base BGP Protocol Relationship</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-bgp-link-state-bgp-ls-relat" class="internal xref">BGP Link State (BGP-LS) Relationship</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-bgp-spf-peering-models" class="internal xref">BGP SPF Peering Models</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-bgp-single-hop-peering-on-n" class="internal xref">BGP Single-Hop Peering on Network Node Connections</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-bgp-peering-between-directl" class="internal xref">BGP Peering Between Directly Connected Nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-bgp-peering-in-route-reflec" class="internal xref">BGP Peering in Route-Reflector or Controller Topology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-bgp-shortest-path-first-spf-" class="internal xref">BGP Shortest Path First (SPF) Routing Protocol Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-bgp-ls-spf-safi" class="internal xref">BGP-LS-SPF SAFI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-bgp-ls-spf-nlri-tlvs" class="internal xref">BGP-LS-SPF NLRI TLVs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-bgp-ls-attribute" class="internal xref">BGP-LS Attribute</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-extensions-to-bgp-ls" class="internal xref">Extensions to BGP-LS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-node-nlri-usage" class="internal xref">Node NLRI Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1.2.1">
                        <p id="section-toc.1-1.5.2.2.2.1.2.1.1"><a href="#section-5.2.1.1" class="auto internal xref">5.2.1.1</a>.  <a href="#name-bgp-ls-spf-node-nlri-attrib" class="internal xref">BGP-LS-SPF Node NLRI Attribute SPF Status TLV</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-link-nlri-usage" class="internal xref">Link NLRI Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2.2.1">
                        <p id="section-toc.1-1.5.2.2.2.2.2.1.1"><a href="#section-5.2.2.1" class="auto internal xref">5.2.2.1</a>.  <a href="#name-bgp-ls-link-nlri-address-fa" class="internal xref">BGP-LS Link NLRI Address Family Link Descriptor TLV</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2.2.2">
                        <p id="section-toc.1-1.5.2.2.2.2.2.2.1"><a href="#section-5.2.2.2" class="auto internal xref">5.2.2.2</a>.  <a href="#name-bgp-ls-spf-link-nlri-attrib" class="internal xref">BGP-LS-SPF Link NLRI Attribute SPF Status TLV</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-ipv4-ipv6-prefix-nlri-usage" class="internal xref">IPv4/IPv6 Prefix NLRI Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.1">
                        <p id="section-toc.1-1.5.2.2.2.3.2.1.1"><a href="#section-5.2.3.1" class="auto internal xref">5.2.3.1</a>.  <a href="#name-bgp-ls-spf-prefix-nlri-attr" class="internal xref">BGP-LS-SPF Prefix NLRI Attribute SPF Status TLV</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-bgp-ls-attribute-sequence-n" class="internal xref">BGP-LS Attribute Sequence Number TLV</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-bgp-ls-spf-end-of-rib-eor-m" class="internal xref">BGP-LS-SPF End of RIB (EoR) Marker</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-bgp-next-hop-information" class="internal xref">BGP Next-Hop Information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-decision-process-with-the-s" class="internal xref">Decision Process with the SPF Algorithm</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-bgp-spf-nlri-selection" class="internal xref">BGP SPF NLRI Selection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-bgp-self-originated-nlri" class="internal xref">BGP Self-Originated NLRI</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-dual-stack-support" class="internal xref">Dual-Stack Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-spf-calculation-based-on-bg" class="internal xref">SPF Calculation Based on BGP-LS-SPF NLRI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-ipv4-ipv6-unicast-address-f" class="internal xref">IPv4/IPv6 Unicast Address Family Interaction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-nlri-advertisement" class="internal xref">NLRI Advertisement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.  <a href="#name-link-prefix-failure-converg" class="internal xref">Link/Prefix Failure Convergence</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.  <a href="#name-node-failure-convergence" class="internal xref">Node Failure Convergence</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-processing-of-bgp-ls-spf-tl" class="internal xref">Processing of BGP-LS-SPF TLVs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-processing-of-bgp-ls-spf-nl" class="internal xref">Processing of BGP-LS-SPF NLRIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-processing-of-bgp-ls-attrib" class="internal xref">Processing of BGP-LS Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-bgp-ls-spf-link-state-datab" class="internal xref">BGP-LS-SPF Link State Database Synchronization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-bgp-ls-spf-allocation-in-th" class="internal xref">BGP-LS-SPF Allocation in the SAFI Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-bgp-ls-spf-assignments-in-t" class="internal xref">BGP-LS-SPF Assignments in the BGP-LS NLRI and Attribute TLVs Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-bgp-ls-spf-node-nlri-attribu" class="internal xref">BGP-LS-SPF Node NLRI Attribute SPF Status TLV Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-bgp-ls-spf-link-nlri-attribu" class="internal xref">BGP-LS-SPF Link NLRI Attribute SPF Status TLV Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-bgp-ls-spf-prefix-nlri-attri" class="internal xref">BGP-LS-SPF Prefix NLRI Attribute SPF Status TLV Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-assignment-in-the-bgp-error" class="internal xref">Assignment in the BGP Error (Notification) Codes Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-management-considerations" class="internal xref">Management Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-link-metric-configuration" class="internal xref">Link Metric Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-unnumbered-link-configurati" class="internal xref">Unnumbered Link Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-adjacency-end-of-rib-eor-ma" class="internal xref">Adjacency End-of-RIB (EOR) Marker Requirement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-backoff-config" class="internal xref">backoff-config</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-bgp-ls-spf-nlri-readvertise" class="internal xref">BGP-LS-SPF NLRI Readvertisement Delay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-operational-data" class="internal xref">Operational Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="auto internal xref">10.8</a>.  <a href="#name-bgp-ls-spf-address-family-s" class="internal xref">BGP-LS-SPF Address Family Session Isolation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        Many Massively Scaled Data Centers (MSDCs) have converged on simplified
        Layer 3 (L3) routing. Furthermore, requirements for operational simplicity
        has led many of these MSDCs to converge on BGP <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>
        as their single routing protocol for both fabric routing and
        Data Center Interconnect (DCI) routing <span>[<a href="#RFC7938" class="cite xref">RFC7938</a>]</span>. This document describes an alternative solution that leverages
        BGP-LS <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
        and the Shortest Path First (SPF) algorithm used by
        Interior Gateway Protocols (IGPs).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        This document leverages both the BGP protocol <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and
        BGP-LS extensions <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>. The relationship as well as
        the scope of changes are described in Sections <a href="#BGP-base" class="auto internal xref">2</a>
        and <a href="#BGP-LS" class="auto internal xref">3</a>, respectively.
 The modifications to
        <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>
        for BGP SPF described herein only apply to IPv4 and IPv6 as underlay unicast
        Subsequent Address Family Identifiers (SAFIs).
        Operations for any other BGP SAFIs are outside the scope of this document.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
        This solution avails the benefits of both BGP and SPF-based IGPs.
        These include TCP-based flow-control, no periodic link-state refresh, and
        completely incremental Network Layer Reachability Information (NLRI) advertisement.
 These advantages can reduce the
        overhead in MSDCs where there is a high degree of Equal-Cost Multipath
        (ECMP) load balancing.
        Additionally, using an SPF-based computation can support fast convergence and
        the computation of Loop-Free Alternatives (LFAs). The SPF LFA extensions defined
        in <span>[<a href="#RFC5286" class="cite xref">RFC5286</a>]</span> can be similarly applied to BGP SPF calculations.
        However, the details are specific to implementation and are out of scope for this
        document.
        Furthermore, a BGP-based solution lends itself to multiple peering models
        including those incorporating route reflectors <span>[<a href="#RFC4456" class="cite xref">RFC4456</a>]</span>
        or controllers.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">
          This specification reuses terms defined in <span><a href="https://rfc-editor.org/rfc/rfc4271#section-1.1" class="relref">Section 1.1</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Additionally, this document introduces the following terms:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1">BGP SPF Routing Domain:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.2"> A set of BGP routers under a single
          administrative domain that exchange link-state information using the BGP-LS-SPF SAFI
          and compute routes using BGP SPF, as described herein.<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">BGP-LS-SPF NLRI:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.4">The BGP-LS Network Layer Reachability
          Information (NLRI) that is being advertised in the BGP-LS-SPF SAFI (<a href="#SAFI" class="auto internal xref">Section 5.1</a>)
          and is being used for BGP SPF route computation.<a href="#section-1.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">Dijkstra Algorithm:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.6">
            An algorithm for computing the shortest path from a given node in a graph
            to every other node in the graph.<a href="#section-1.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">Prefix NLRI:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.8">
            In the context of BGP SPF, this term refers to the IPv4 Topology Prefix NLRI
            and/or the IPv6 Topology Prefix NLRI.<a href="#section-1.1-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-1.2">
        <h3 id="name-requirements-language">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-bgp-shortest-path-first-spf">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-bgp-shortest-path-first-spf" class="section-name selfRef">BGP Shortest Path First (SPF) Motivation</a>
        </h3>
<p id="section-1.3-1">
          Given that <span>[<a href="#RFC7938" class="cite xref">RFC7938</a>]</span> already describes how BGP could be used
          as the sole routing protocol in an MSDC, one might question the motivation for
          defining an alternative BGP deployment model when a mature solution exists.
          For both alternatives, BGP offers the operational benefits of a single
          routing protocol as opposed to the combination of an IGP for the underlay
          and BGP as the overlay. However, BGP SPF offers some unique advantages above
          and beyond standard BGP path-vector routing. With BGP SPF, the
          simple single-hop peering model recommended in <span><a href="https://rfc-editor.org/rfc/rfc7938#section-5.2.1" class="relref">Section 5.2.1</a> of [<a href="#RFC7938" class="cite xref">RFC7938</a>]</span>
          is augmented with peering models requiring fewer BGP sessions.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">
          A primary advantage is that all BGP speakers in the BGP SPF routing domain
          have a complete view of the topology. This allows support for ECMP,
          IP fast-reroute (e.g., Loop-Free Alternatives (LFAs) <span>[<a href="#RFC5286" class="cite xref">RFC5286</a>]</span>,
          Shared Risk Link Groups (SRLGs) <span>[<a href="#RFC4202" class="cite xref">RFC4202</a>]</span>,
          and other routing enhancements without advertisement of additional
          BGP paths <span>[<a href="#RFC7911" class="cite xref">RFC7911</a>]</span>  or other extensions.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">
          With the BGP SPF Decision Process as defined in
          <a href="#bgp-decision" class="auto internal xref">Section 6</a>, NLRI changes can be disseminated throughout the BGP
          routing domain much more rapidly. The added advantage of BGP using TCP for reliable
          transport leverages TCP's inherent flow-control and guaranteed in-order delivery.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">
            Another primary advantage is a potential reduction in NLRI advertisement.

            With standard BGP path-vector routing, a single link failure may impact
            hundreds or thousands of prefixes and result in the withdrawal or readvertisement of
            the attendant NLRI. With BGP SPF, only the BGP speakers originating
            the Link NLRI need to withdraw the corresponding BGP-LS-SPF Link NLRI. Additionally,
            the changed NLRI is advertised immediately as opposed to normal BGP where it
            is only advertised after the best route selection. These advantages provide
            NLRI dissemination throughout the BGP SPF routing domain with efficiencies similar
            to link-state protocols.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">
            With controller and route-reflector peering models, BGP SPF advertisement
            and distributed computation require a minimal number of sessions and
            copies of the NLRI as only the latest version of the NLRI from the
            originator is required (see <a href="#peering-models" class="auto internal xref">Section 4</a>).
            Given that verification of whether or not to advertise a link (with a
            BGP-LS-SPF Link NLRI) is done outside of BGP, each BGP
            speaker only needs as many sessions and copies of the NLRI as required for
            redundancy. Additionally, a controller could inject topology (i.e., BGP-LS-SPF NLRI)
            that is learned outside the BGP SPF routing domain.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">
            Given that BGP-LS NLRI is already defined
            <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>, this functionality
            can be reused for BGP-LS-SPF NLRI.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7">
            Another advantage of BGP SPF is that both IPv6 and IPv4 can
            be supported using the BGP-LS-SPF SAFI with the same BGP-LS-SPF Link NLRIs. In many
            MSDC fabrics, the IPv4 and IPv6 topologies are congruent (refer to
            <a href="#Link-NLRI" class="auto internal xref">Section 5.2.2</a>).
            However, beyond the scope of this document, BGP-LS-SPF NLRI multi-topology extensions could
            be defined to support separate IPv4, IPv6, unicast, and multicast topologies
            while sharing the same NLRI.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8">
            Finally, the BGP SPF topology can be used as an underlay for other BGP
            SAFIs (using the existing model) and obtain all the above
            advantages.<a href="#section-1.3-8" class="pilcrow">¶</a></p>
</section>
<section id="section-1.4">
        <h3 id="name-document-overview">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-document-overview" class="section-name selfRef">Document Overview</a>
        </h3>
<p id="section-1.4-1">
            This document begins with <a href="#BGP-base" class="auto internal xref">Section 2</a> defining the
            precise relationship that BGP SPF has
            with the base BGP protocol <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and <a href="#BGP-LS" class="auto internal xref">Section 3</a> defining the
            BGP Link State (BGP-LS) extensions <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
            The BGP peering models as well as
            their respective trade-offs are then discussed in
            <a href="#peering-models" class="auto internal xref">Section 4</a>. The remaining sections, which make up the bulk of the
            document, define the protocol enhancements necessary to support BGP SPF including BGP-LS extensions
            (<a href="#protocol-extend" class="auto internal xref">Section 5</a>), replacement of the base BGP Decision Process
            with the SPF computation (<a href="#bgp-decision" class="auto internal xref">Section 6</a>), and BGP SPF error
            handling (<a href="#error-handling" class="auto internal xref">Section 7</a>).<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="BGP-base">
<section id="section-2">
      <h2 id="name-base-bgp-protocol-relations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-base-bgp-protocol-relations" class="section-name selfRef">Base BGP Protocol Relationship</a>
      </h2>
<p id="section-2-1">
  With the exception of the Decision Process, BGP SPF extensions leverage the BGP
  protocol <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>  without change. This includes the BGP protocol
  Finite State Machine, BGP messages and their encodings, the processing of BGP messages,
  BGP attributes and path attributes, BGP NLRI encodings, and any error handling
  defined in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>,
  and <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
  Due to changes in the Decision
  Process, there are mechanisms and encodings that are no longer applicable.
  Unless explicitly specified in the context of BGP SPF, all optional path
  attributes <span class="bcp14">SHOULD NOT</span> be advertised.  If received, all path attributes <span class="bcp14">MUST</span>
  be accepted, validated, and propagated consistently with the BGP protocol
  <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, even if not needed by BGP SPF.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
  <span><a href="https://rfc-editor.org/rfc/rfc4271#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> defines the Decision Process that
  is used to select routes for subsequent advertisement
  by applying the policies in the local Policy Information Base (PIB) to the
  routes stored in its Adj-RIBs-In. The output of the Decision Process is the
  set of routes that is announced by a BGP speaker to its peers. These
  selected routes are stored by a BGP speaker in the speaker's Adj-RIBs-Out,
  according to policy.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">
  The BGP SPF extension fundamentally changes the Decision Process, as described
  herein. Specifically:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-5">
  <li id="section-2-5.1">
    BGP advertisements are readvertised to neighbors immediately without waiting
    or dependence on the route computation, as specified in phase 3 of the base BGP
    Decision Process. Multiple peering models are supported, as specified in
    <a href="#peering-models" class="auto internal xref">Section 4</a>.<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-5.2">
  Determining the degree of preference for BGP routes, as described in phase 1 of the base BGP Decision Process, is replaced with the mechanisms
  in <a href="#Phase-1" class="auto internal xref">Section 6.1</a> for the SPF calculation.<a href="#section-2-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-5.3">
  Phase 2 of the base BGP protocol Decision Process is replaced with the
  SPF algorithm, also known as the Dijkstra algorithm.<a href="#section-2-5.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="BGP-LS">
<section id="section-3">
      <h2 id="name-bgp-link-state-bgp-ls-relat">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-bgp-link-state-bgp-ls-relat" class="section-name selfRef">BGP Link State (BGP-LS) Relationship</a>
      </h2>
<p id="section-3-1">
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> describes a mechanism by
  which link-state and Traffic Engineering (TE) information can be collected from networks and shared with external
  entities using BGP.
  This is achieved by defining NLRIs that are advertised using the BGP-LS AFI. The BGP-LS extensions defined in
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> make use of the Decision Process defined in
  <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>.  Rather than reusing the BGP-LS SAFI, the BGP-LS-SPF SAFI
  (<a href="#SAFI" class="auto internal xref">Section 5.1</a>) is introduced to ensure backward compatibility
  for BGP-LS SAFI usage.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
  The "BGP-LS NLRI and Attribute TLVs" registry <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> is shared between
  the BGP-LS SAFI and the BGP-LS-SPF SAFI.
  However, the TLVs defined in this document may not be applicable to
  the BGP-LS SAFI.  As specified in <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>, the presence
  of unknown or unexpected TLVs is required so that the NLRI or
  BGP-LS Attribute will not be considered
  malformed (<span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>).  The list of BGP-LS TLVs applicable
  to the BGP-LS-SPF SAFI are described in
  <a href="#NLRI-Use" class="auto internal xref">Section 5.2</a>. By default, the usage of other BGP-LS TLVs or
  extensions are ignored for the BGP-LS-SPF SAFI. However, this doesn't preclude the usage
  specification of these TLVs for the BGP-LS-SPF SAFI in future documents.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="peering-models">
<section id="section-4">
      <h2 id="name-bgp-spf-peering-models">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-bgp-spf-peering-models" class="section-name selfRef">BGP SPF Peering Models</a>
      </h2>
<p id="section-4-1">
  Depending on the topology, scaling, capabilities of the BGP speakers, and redundancy
  requirements, various peering models are supported. The only requirement is that all BGP
  speakers in the BGP SPF routing domain adhere to this specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
  The choice of the deployment model is up to the operator and their requirements and policies.
  Deployment model choice is out of scope for this document and is discussed in
  <span>[<a href="#RFC9816" class="cite xref">RFC9816</a>]</span>. The subsections below
  describe several BGP SPF deployment models. However, this doesn't preclude other
  deployment models.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="single-hop-peering">
<section id="section-4.1">
        <h3 id="name-bgp-single-hop-peering-on-n">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-bgp-single-hop-peering-on-n" class="section-name selfRef">BGP Single-Hop Peering on Network Node Connections</a>
        </h3>
<p id="section-4.1-1">
  The simplest peering model is the one where
  External BGP (EBGP) single-hop sessions are established over direct point-to-point links
  interconnecting the nodes in the BGP SPF routing domain.

  Once the single-hop BGP session has been
  established and the Multiprotocol Extensions Capability with the BGP-LS-SPF AFI/SAFI
  <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span> has been exchanged for the corresponding session, then the link is considered up and available from
  a BGP SPF perspective, and the corresponding BGP-LS-SPF Link NLRI is advertised.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
  An End-of-RIB (EoR) marker (<a href="#BGP-LS-SPF-EOR" class="auto internal xref">Section 5.3</a>) for the BGP-LS-SPF
  SAFI <span class="bcp14">MAY</span> be required from a peer prior to advertising the BGP-LS-SPF Link NLRI
  for the corresponding link to that peer.

  When required, the default is to
  wait indefinitely for the EoR marker prior to advertising the BGP-LS-SPF Link NLRI.
  Refer to <a href="#Adjacency-EoR-Required" class="auto internal xref">Section 10.4</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
  A failure to consistently configure the use of the EoR marker can
  result in transient micro-loops and dropped traffic due to incomplete
  forwarding state.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
  If the session goes down, the corresponding Link NLRIs are withdrawn. Topologically,
  this would be equivalent to the peering model in <span>[<a href="#RFC7938" class="cite xref">RFC7938</a>]</span> where there
  is a BGP session on every link in the data center switch fabric.  The content of the Link NLRI
  is described in <a href="#Link-NLRI" class="auto internal xref">Section 5.2.2</a>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4.2">
        <h3 id="name-bgp-peering-between-directl">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-bgp-peering-between-directl" class="section-name selfRef">BGP Peering Between Directly Connected Nodes</a>
        </h3>
<p id="section-4.2-1">
  In this model, BGP speakers peer with all directly connected
  nodes but the sessions may be between loopback addresses (i.e.,
  two-hop sessions), and the direct connection
  discovery and liveness detection for the interconnecting links are
  independent of the BGP protocol. The Bidirectional Forwarding Detection (BFD) protocol <span>[<a href="#RFC5880" class="cite xref">RFC5880</a>]</span>
  is <span class="bcp14">RECOMMENDED</span> for liveness detection. Usage of other liveness connection mechanisms
  is outside the scope of this document.
  Consequently, there is a single BGP session even if there are multiple
  direct connections between BGP speakers. The BGP-LS-SPF Link NLRI is advertised
  as long as a BGP session has been established, the BGP-LS-SPF AFI/SAFI
  capability has been exchanged <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>,
  the link is operational as determined using liveness detection mechanisms,
  and, optionally, the EoR marker has been received as described in
  <a href="#BGP-LS-SPF-EOR" class="auto internal xref">Section 5.3</a>.
  This is much like the previous peering model, except peering is between
  loopback addresses and the interconnecting links can be unnumbered. However,
  since there are BGP sessions between every directly connected node in the
  BGP SPF routing domain, there is a reduction in BGP sessions when there
  are parallel links between nodes. Hence, this peering model is <span class="bcp14">RECOMMENDED</span>
  over the single-hop peering model <a href="#single-hop-peering" class="auto internal xref">Section 4.1</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-bgp-peering-in-route-reflec">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-bgp-peering-in-route-reflec" class="section-name selfRef">BGP Peering in Route-Reflector or Controller Topology</a>
        </h3>
<p id="section-4.3-1">
  In this model, BGP speakers peer solely with one or more route reflectors
  <span>[<a href="#RFC4456" class="cite xref">RFC4456</a>]</span> or controllers. As in the previous model, direct
  connection discovery and liveness detection for those links in the BGP
  SPF routing domain are done outside of the BGP protocol.
  BGP-LS-SPF Link NLRI is advertised as long as the corresponding link is
  considered up and available as per the chosen liveness detection mechanism (thus, the BFD protocol
  <span>[<a href="#RFC5880" class="cite xref">RFC5880</a>]</span> is <span class="bcp14">RECOMMENDED</span>).<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
  This peering model, known as "sparse peering", allows for fewer BGP sessions
  and, consequently, fewer instances of the same NLRI received from multiple peers.
  Ideally, the route reflectors or controller BGP sessions would be on directly connected
  links to avoid dependence on another routing protocol for session connectivity. However,
  multi-hop peering is not precluded. The number of BGP sessions is dependent
  on the redundancy requirements and the stability of the BGP sessions.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">
  The controller may use constraints to determine
  when to advertise BGP-LS-SPF NLRI for BGP-LS peers. For example, a controller
  may delay advertisement of a link between two peers the until the EoR
   marker <a href="#BGP-LS-SPF-EOR" class="auto internal xref">Section 5.3</a> has been
  received from both BGP peers and the BGP-LS Link NLRI for the link(s) between the two nodes
  has been received from both BGP peers.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="protocol-extend">
<section id="section-5">
      <h2 id="name-bgp-shortest-path-first-spf-">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-bgp-shortest-path-first-spf-" class="section-name selfRef">BGP Shortest Path First (SPF) Routing Protocol Extensions</a>
      </h2>
<div id="SAFI">
<section id="section-5.1">
        <h3 id="name-bgp-ls-spf-safi">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-bgp-ls-spf-safi" class="section-name selfRef">BGP-LS-SPF SAFI</a>
        </h3>
<p id="section-5.1-1">
  This document introduces the BGP-LS-SPF SAFI with a value of 80.
  The SPF-based Decision Process (<a href="#bgp-decision" class="auto internal xref">Section 6</a>) applies only to the
  BGP-LS-SPF SAFI and <span class="bcp14">MUST NOT</span> be used with other combinations of
  the BGP-LS AFI (16388).
  In order for two BGP speakers to
  exchange BGP-LS-SPF NLRI, they <span class="bcp14">MUST</span> exchange the Multiprotocol
  Extensions Capability <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>
  to ensure that they are both capable of properly processing such an
  NLRI.  This is done with AFI 16388 / SAFI 80.  The BGP-LS-SPF SAFI
  is used to advertise IPv4 and IPv6 prefix information in a
  format facilitating an SPF-based Decision Process.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="BGP-LS-TLV">
<section id="section-5.1.1">
          <h4 id="name-bgp-ls-spf-nlri-tlvs">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-bgp-ls-spf-nlri-tlvs" class="section-name selfRef">BGP-LS-SPF NLRI TLVs</a>
          </h4>
<p id="section-5.1.1-1">
  All the TLVs defined for BGP-LS <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  are applicable and can be used with the BGP-LS-SPF SAFI to describe links, nodes,
  and prefixes comprising BGP SPF Link State Database (LSDB) information.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
  The NLRI and comprising TLVs <span class="bcp14">MUST</span> be encoded as specified in
  <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>. TLVs specified as
  mandatory in <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> are
  considered mandatory for the BGP-LS-SPF SAFI as
  well. If a mandatory TLV is not present, the NLRI <span class="bcp14">MUST NOT</span> be used in the
  BGP SPF route calculation. All the other TLVs are considered as optional TLVs. Documents
  specifying usage of optional TLVs for BGP SPF <span class="bcp14">MUST</span> address backward compatibility.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.1.2">
          <h4 id="name-bgp-ls-attribute">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-bgp-ls-attribute" class="section-name selfRef">BGP-LS Attribute</a>
          </h4>
<p id="section-5.1.2-1">
  The BGP-LS Attribute of the BGP-LS-SPF SAFI uses the exact same format as the BGP-LS AFI
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>. In
  other words, all the TLVs used in the BGP-LS Attribute of the BGP-LS AFI are applicable
  and are used for the BGP-LS Attribute of the BGP-LS-SPF SAFI. This attribute is an optional,
  non-transitive BGP attribute that is used to advertise link, node, and prefix
  properties and attributes. The BGP-LS Attribute is a set of TLVs.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">
  All the TLVs defined for the BGP-LS Attribute  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  are applicable and can be used with the BGP-LS-SPF SAFI to advertise link, node, and prefix
  properties and attributes.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">
  The BGP-LS Attribute may potentially be quite large depending on
  the amount of link-state information associated with a single BGP-LS-SPF NLRI.
  The BGP specification <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> mandates a maximum BGP
  message size of 4096 octets.  It is <span class="bcp14">RECOMMENDED</span> that an
  implementation support <span>[<a href="#RFC8654" class="cite xref">RFC8654</a>]</span> in order to accommodate a greater
  amount of information within the BGP-LS Attribute.  BGP speakers <span class="bcp14">MUST</span>
  ensure that they limit the TLVs included in the BGP-LS Attribute to
  ensure that a BGP UPDATE message for a single BGP-LS-SPF NLRI does
  not cross the maximum limit for a BGP message.  The determination of
  the types of TLVs to be included by the BGP speaker
  originating the attribute is outside the scope of this document.
  If, due to the limits on the maximum size of an UPDATE message, a single
  route doesn't fit into the message, the BGP speaker <span class="bcp14">MUST NOT</span> advertise the
  route to its peer and <span class="bcp14">MAY</span> choose to log an error locally <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="NLRI-Use">
<section id="section-5.2">
        <h3 id="name-extensions-to-bgp-ls">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-extensions-to-bgp-ls" class="section-name selfRef">Extensions to BGP-LS</a>
        </h3>
<p id="section-5.2-1">
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> describes a mechanism
  by which link-state and TE
  information can be collected from IGPs and shared with external components
  using the BGP protocol. It describes both the definition of the BGP-LS NLRI
  that advertise links, nodes, and prefixes comprising IGP link-state
  information and the definition of a BGP path attribute (BGP-LS
  Attribute) that carries link, node, and prefix properties and
  attributes, such as the link and prefix metric or auxiliary
  Router-IDs of nodes, etc. This document extends the usage of BGP-LS NLRI for
  the purpose of BGP SPF calculation via advertisement in the BGP-LS-SPF SAFI.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
  The protocol identifier specified in the Protocol-ID field
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  represents the origin of the advertised NLRI. For Node NLRI and Link NLRI,
  the specified Protocol-ID <span class="bcp14">MUST</span> be the direct protocol (4). Node or Link NLRI with a
  Protocol-ID other than the direct protocol is considered malformed.
  For Prefix NLRI, the specified Protocol-ID
  <span class="bcp14">MUST</span> be the origin of the prefix. The Local and Remote Node Descriptors for all NLRI <span class="bcp14">MUST</span>
  include the BGP Router-ID (TLV 516) <span>[<a href="#RFC9086" class="cite xref">RFC9086</a>]</span>
  and the Autonomous System (TLV 512) number
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  The BGP Confederation Member (TLV 517)
  <span>[<a href="#RFC9086" class="cite xref">RFC9086</a>]</span> is not applicable.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<section id="section-5.2.1">
          <h4 id="name-node-nlri-usage">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-node-nlri-usage" class="section-name selfRef">Node NLRI Usage</a>
          </h4>
<p id="section-5.2.1-1">
  The Node NLRI <span class="bcp14">MUST</span> be advertised unconditionally by all routers in
  the BGP SPF routing domain.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<div id="node-status-tlv">
<section id="section-5.2.1.1">
            <h5 id="name-bgp-ls-spf-node-nlri-attrib">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-bgp-ls-spf-node-nlri-attrib" class="section-name selfRef">BGP-LS-SPF Node NLRI Attribute SPF Status TLV</a>
            </h5>
<p id="section-5.2.1.1-1">
  A BGP-LS Attribute SPF Status TLV of the BGP-LS-SPF Node NLRI is defined to indicate the status of
  the node with respect to the BGP SPF calculation. This is used to rapidly take a
  node out of service (refer to <a href="#node-failure" class="auto internal xref">Section 6.5.2</a>)
  or to indicate that the node is not to be
  used for transit (i.e., non-local) traffic (refer to <a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>).
  If the SPF Status TLV is not included with the Node NLRI, the node is considered to be up
  and is available for transit traffic. A single TLV type is shared by the Node, Link, and
   Prefix NLRI.  The TLV type is 1184.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type (1184)                 |       Length (1 Octet)        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| SPF Status    |
+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.1.1-2" class="pilcrow">¶</a>
</div>
<span id="name-node-nlri-attribute-status-"></span><table class="center" id="table-1">
              <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-node-nlri-attribute-status-" class="selfRef">Node NLRI Attribute Status Values</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Node unreachable with respect to BGP SPF</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">Node does not support transit with respect to BGP SPF</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3-254</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">255</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.1.1-4">
  If a BGP speaker received the Node NLRI but
  the SPF Status TLV is not received, then any previously received SPF status information is
  considered as implicitly withdrawn, and the NLRI is propagated to other BGP speakers.
  A BGP speaker receiving a BGP Update containing
  an SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  with an unknown value <span class="bcp14">SHOULD</span> be advertised to other
  BGP speakers and <span class="bcp14">MUST</span> ignore the Status TLV with an unknown value in
  the SPF computation.
  An implementation <span class="bcp14">MAY</span> log this condition for further analysis.
  If the SPF Status TLV contains a reserved value (0 or 255), the TLV is considered malformed and
  is handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>.<a href="#section-5.2.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="Link-NLRI">
<section id="section-5.2.2">
          <h4 id="name-link-nlri-usage">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-link-nlri-usage" class="section-name selfRef">Link NLRI Usage</a>
          </h4>
<p id="section-5.2.2-1">
  The criteria for advertisement of Link NLRIs are discussed in
  <a href="#peering-models" class="auto internal xref">Section 4</a>.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">
  Link NLRI is advertised with unique Local and Remote Node Descriptors
  dependent on the IP addressing.

  For IPv4 links, the
  link's local IPv4 interface address (TLV 259) and remote IPv4 neighbor address (TLV 260) are used.
  For IPv6 links, the local IPv6 interface address (TLV 261) and remote IPv6 neighbor address (TLV 262)
  are used (see <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.2.2" class="relref">Section 5.2.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>). IPv6 links without
  global IPv6 addresses are considered unnumbered links and are handled as
  described below.
  For links supporting both IPv4 and IPv6 addresses, both sets
  of descriptors <span class="bcp14">MAY</span> be included in the same Link NLRI.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">
  For unnumbered links, the Link Local/Remote Identifiers (TLV 258)
  are used. The Link Remote Identifier isn't normally exchanged in BGP,
  and discovering the Link Remote Identifier is beyond the scope of this
  document. If the Link Remote Identifier is unknown, a Link Remote Identifier of
  0 <span class="bcp14">MUST</span> be advertised. When 0 is advertised and there are parallel unnumbered links
  between a pair of BGP speakers, there may be transient intervals where the
  BGP speakers don't agree on which of the parallel unnumbered links are operational.
  For this reason, it is <span class="bcp14">RECOMMENDED</span> that the Link Remote Identifiers be
  known (e.g., discovered using alternate mechanisms or configured) in the presence
  of parallel unnumbered links.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">
  The link descriptors are
  described in Table 4 of <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  Additionally, the Address Family (AF) Link Descriptor TLV is defined to determine whether an
  unnumbered link can be used in the IPv4 SPF, the IPv6, or both (refer to
  <a href="#af-link-descriptor-tlv" class="auto internal xref">Section 5.2.2.1</a>).<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">
  
  For a link to be used in SPF computation for a given address family,
  i.e., IPv4 or IPv6, both routers connecting the link <span class="bcp14">MUST</span> have matching addresses (i.e.,
  router interface addresses must be on the same subnet for numbered interfaces, or the
  Link Local/Remote Identifiers (<a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>) must match for unnumbered
  interfaces).<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2-6">
  The IGP Metric (TLV 1095) <span class="bcp14">MUST</span> be advertised. If a BGP speaker
  receives a Link NLRI without an IGP Metric attribute TLV, then it <span class="bcp14">MUST</span> consider
  the received NLRI as malformed and is handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>.
  The BGP SPF metric length is 4 octets. A metric is associated with the output side of each
  router interface.  This metric is configurable by the system administrator.  The
  lower the metric, the more likely the interface is to be used to forward data traffic.
  One possible default for the  metric would be to give each interface a metric of 1
  making the SPF metric effectively a hop count.<a href="#section-5.2.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2.2-7">
  The usage of other link attribute TLVs is beyond the scope of this document.<a href="#section-5.2.2-7" class="pilcrow">¶</a></p>
<div id="af-link-descriptor-tlv">
<section id="section-5.2.2.1">
            <h5 id="name-bgp-ls-link-nlri-address-fa">
<a href="#section-5.2.2.1" class="section-number selfRef">5.2.2.1. </a><a href="#name-bgp-ls-link-nlri-address-fa" class="section-name selfRef">BGP-LS Link NLRI Address Family Link Descriptor TLV</a>
            </h5>
<p id="section-5.2.2.1-1">
    For unnumbered links, the address family cannot be ascertained from the
    endpoint link descriptors. Hence, the Address Family Link Descriptor TLV <span class="bcp14">SHOULD</span>
    be included with the Link Local/Remote Identifiers TLV for unnumbered links,
    so that the link can be used in the respective address family SPF. If the
    Address Family Link
    Descriptor TLV is not present for an unnumbered link, the link will not be
    used in the SPF computation for either address family. If the Address Family Link
    Descriptor TLV is present for a numbered link, the link descriptor
    will be ignored. If the Address Family Link Descriptor TLV contains an
    undefined value (3-254), the link descriptor will be ignored.
    If the Address Family Link Descriptor TLV contains a
    reserved value (0 or 255), the TLV is considered malformed and
    is handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>.<a href="#section-5.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2.1-2">
    Note that an unnumbered link can be used for both the IPv4 and IPv6
    SPF computation by advertising separate Address Family Link Descriptor
    TLVs for IPv4 and IPv6.<a href="#section-5.2.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2.1-3">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type (1185)                 |      Length (1 Octet)         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Address Family|
  +-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.2.1-3" class="pilcrow">¶</a>
</div>
<span id="name-address-family-values"></span><table class="center" id="table-2">
              <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-address-family-values" class="selfRef">Address Family Values</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">IPv4 Address Family</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">IPv6 Address Family</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">3-254</td>
                  <td class="text-left" rowspan="1" colspan="1">Undefined</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">255</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
</section>
</div>
<div id="link-status-tlv">
<section id="section-5.2.2.2">
            <h5 id="name-bgp-ls-spf-link-nlri-attrib">
<a href="#section-5.2.2.2" class="section-number selfRef">5.2.2.2. </a><a href="#name-bgp-ls-spf-link-nlri-attrib" class="section-name selfRef">BGP-LS-SPF Link NLRI Attribute SPF Status TLV</a>
            </h5>
<p id="section-5.2.2.2-1">
    The BGP-LS Attribute SPF Status TLV of the BGP-LS-SPF Link NLRI is defined to
    indicate the status of the link with respect to the BGP SPF calculation. This is used to expedite
    convergence for link failures as discussed in <a href="#failure-converge" class="auto internal xref">Section 6.5.1</a>. If the
    SPF Status TLV is not included with the Link NLRI, the link is considered
    up and available. The SPF status is acted upon with the execution of the
    next SPF calculation (<a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>).
    A single TLV type is shared by the Node, Link, and Prefix NLRI.
    The TLV type is 1184.<a href="#section-5.2.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.2.2-2">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type (1184)                 |      Length (1 Octet)         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | SPF Status    |
  +-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.2.2-2" class="pilcrow">¶</a>
</div>
<span id="name-link-nlri-attribute-status-"></span><table class="center" id="table-3">
              <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-link-nlri-attribute-status-" class="selfRef">Link NLRI Attribute Status Values</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Link unreachable with respect to BGP SPF</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2-254</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">255</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.2.2-4">
    If a BGP speaker received the Link NLRI but
    the SPF Status TLV is not received, then any previously received SPF status information is
    considered as implicitly withdrawn, and the NLRI is propagated to other BGP speakers.
    A BGP speaker receiving a BGP Update containing
    an SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
    with an unknown value <span class="bcp14">SHOULD</span> be advertised to other
    BGP speakers and <span class="bcp14">MUST</span> ignore the SPF Status TLV with an unknown value in
    the SPF computation.
    An implementation <span class="bcp14">MAY</span> log this information for further analysis.
    If the SPF Status TLV contains a reserved value (0 or 255), the TLV is considered malformed and
    is handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>.<a href="#section-5.2.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Prefix-NLRI">
<section id="section-5.2.3">
          <h4 id="name-ipv4-ipv6-prefix-nlri-usage">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-ipv4-ipv6-prefix-nlri-usage" class="section-name selfRef">IPv4/IPv6 Prefix NLRI Usage</a>
          </h4>
<p id="section-5.2.3-1">
    An IPv4/IPv6 Prefix NLRI is advertised with a Local Node Descriptor and
    the prefix and length. The Prefix Descriptor field includes IP Reachability
    Information (TLV 265) as described in <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
    The Prefix Metric (TLV 1155) <span class="bcp14">MUST</span> be advertised to be considered for route calculation. The IGP Route Tag (TLV 1153) <span class="bcp14">MAY</span> be advertised. The usage of other BGP-LS
    Attribute TLVs is beyond the scope of this document.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<div id="prefix-status-tlv">
<section id="section-5.2.3.1">
            <h5 id="name-bgp-ls-spf-prefix-nlri-attr">
<a href="#section-5.2.3.1" class="section-number selfRef">5.2.3.1. </a><a href="#name-bgp-ls-spf-prefix-nlri-attr" class="section-name selfRef">BGP-LS-SPF Prefix NLRI Attribute SPF Status TLV</a>
            </h5>
<p id="section-5.2.3.1-1">
      A BGP-LS Attribute SPF Status TLV of the BGP-LS-SPF Prefix NLRI is defined to indicate the status of
      the prefix with respect to the BGP SPF calculation. This is used to expedite
      convergence for prefix unreachability, as discussed in <a href="#failure-converge" class="auto internal xref">Section 6.5.1</a>.
      If the SPF Status TLV is not included with the Prefix NLRI, the prefix is considered
      reachable.
      A single TLV type is shared by the Node, Link, and Prefix NLRI.
      The TLV type is 1184.<a href="#section-5.2.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.3.1-2">
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Type (1184)                 |      Length (1 Octet)         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | SPF Status    |
    +-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.3.1-2" class="pilcrow">¶</a>
</div>
<span id="name-prefix-nlri-attribute-statu"></span><table class="center" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-prefix-nlri-attribute-statu" class="selfRef">Prefix NLRI Attribute Status Values</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Prefix unreachable with respect to BGP SPF</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">2-254</td>
                  <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">255</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.1-4">
      If a BGP speaker received the Prefix NLRI but
      the SPF Status TLV is not received, then any previously received SPF status information is
      considered as implicitly withdrawn, and the NLRI is propagated to other BGP speakers.
      A BGP speaker receiving a BGP Update containing
      an SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
      with an unknown value <span class="bcp14">SHOULD</span> be advertised to other
      BGP speakers and <span class="bcp14">MUST</span> ignore the Status TLV with an unknown value in
      the SPF computation.
      An implementation <span class="bcp14">MAY</span> log this information for further analysis.
      If the SPF Status TLV contains a reserved value (0 or 255), the TLV is considered malformed and
      is handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>.<a href="#section-5.2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sequence-number-tlv">
<section id="section-5.2.4">
          <h4 id="name-bgp-ls-attribute-sequence-n">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-bgp-ls-attribute-sequence-n" class="section-name selfRef">BGP-LS Attribute Sequence Number TLV</a>
          </h4>
<p id="section-5.2.4-1">
    A BGP-LS Attribute Sequence Number TLV of the BGP-LS-SPF NLRI types is defined to assure the most
    recent version of a given NLRI is used in the SPF computation. The Sequence Number TLV is
    mandatory for BGP-LS-SPF NLRI.
    The TLV type 1181 has been assigned by IANA. The BGP-LS
    Attribute Sequence Number TLV contains an 8-octet sequence number. The usage of the
    Sequence Number TLV is described in <a href="#Phase-1" class="auto internal xref">Section 6.1</a>.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.4-2">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type (1181)                 |      Length (8 Octets)        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                Sequence Number (High-Order 32 Bits)           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                Sequence Number (Low-Order 32 Bits)            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-5.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.4-3">
    Sequence Number:
    The 64-bit strictly increasing sequence number <span class="bcp14">MUST</span> be incremented for every
    self-originated version of a BGP-LS-SPF NLRI. BGP speakers implementing this specification
    <span class="bcp14">MUST</span> use available mechanisms to preserve the sequence number's strictly increasing property
    for the deployed life of the BGP speaker (including cold restarts).
    One mechanism for accomplishing this would be to use the high-order 32 bits of the
    sequence number as a wrap/boot count that is incremented any time the BGP router
    loses its sequence number state or the low-order 32 bits wrap.<a href="#section-5.2.4-3" class="pilcrow">¶</a></p>
<p id="section-5.2.4-4">
    When incrementing the sequence number for each self-originated NLRI,
    the sequence number should be treated as an unsigned 64-bit
    value. If the lower-order 32-bit value wraps, the higher-order 32-bit value should
    be incremented and saved in non-volatile storage. If a BGP speaker completely
    loses its sequence number state (e.g., the BGP speaker hardware
    is replaced or experiences a cold start), the BGP NLRI selection rules
    (see <a href="#Phase-1" class="auto internal xref">Section 6.1</a>) ensure convergence, albeit not immediately.<a href="#section-5.2.4-4" class="pilcrow">¶</a></p>
<p id="section-5.2.4-5">
    If the Sequence Number TLV
    is not received, then the corresponding NLRI is considered as malformed and
    <span class="bcp14">MUST</span> be handled as described in <a href="#new-TLVs" class="auto internal xref">Section 7.1</a>. An implementation <span class="bcp14">SHOULD</span> log an error for
    further analysis.<a href="#section-5.2.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="BGP-LS-SPF-EOR">
<section id="section-5.3">
        <h3 id="name-bgp-ls-spf-end-of-rib-eor-m">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-bgp-ls-spf-end-of-rib-eor-m" class="section-name selfRef">BGP-LS-SPF End of RIB (EoR) Marker</a>
        </h3>
<p id="section-5.3-1">
   The usage of the EoR marker <span>[<a href="#RFC4724" class="cite xref">RFC4724</a>]</span> with the BGP-LS-SPF
   SAFI is somewhat different than the other BGP SAFIs. Reception of the EoR
   marker <span class="bcp14">MAY</span> optionally be expected prior to advertising a Link NLRI for a given peer.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEXT-HOP">
<section id="section-5.4">
        <h3 id="name-bgp-next-hop-information">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-bgp-next-hop-information" class="section-name selfRef">BGP Next-Hop Information</a>
        </h3>
<p id="section-5.4-1">
    The rules for setting the BGP Next-Hop in the MP_REACH_NLRI attribute <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>
    for the BGP-LS-SPF SAFI follow the rules in <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
    All BGP peers that support SPF extensions will locally compute the Local-RIB Next-Hop
    as a result of the SPF process. Hence, the use of the MP_REACH_NLRI Next-Hop as a tiebreaker in the
    standard BGP path decision processing is not applicable.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bgp-decision">
<section id="section-6">
      <h2 id="name-decision-process-with-the-s">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-decision-process-with-the-s" class="section-name selfRef">Decision Process with the SPF Algorithm</a>
      </h2>
<p id="section-6-1">
    The Decision Process described in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> takes place in
    three distinct phases. The Phase 1 decision function of the Decision Process is
    responsible for calculating the degree
    of preference for each route received from a BGP speaker's peer. The Phase 2 decision
    function is invoked on completion of the Phase 1 decision function and is responsible
    for choosing the best route out of all those available for each
    distinct destination and for installing each chosen route into the Local-RIB.
    The combination of the Phase 1 and 2 decision functions is characterized as
    a Path Vector algorithm.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
    The SPF-based Decision Process replaces the BGP Decision Process described in
    <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>.
    Since BGP-LS-SPF NLRI always contains the Local Node Descriptor as described in
    <a href="#NLRI-Use" class="auto internal xref">Section 5.2</a>, each NLRI is uniquely originated by a single
    BGP speaker in the BGP SPF routing domain (the BGP node matching the NLRI's Node
    Descriptors). Instances of the same NLRI originated by multiple BGP speakers would be
    indicative of a configuration error or a masquerading attack
    (refer to <a href="#Security" class="auto internal xref">Section 9</a>).
    These selected Node NLRIs and their Link/Prefix NLRIs are used to build a directed
    graph during the SPF computation as described below. The best routes for BGP prefixes
    are installed in the RIB as a result of the SPF process.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
  When BGP-LS-SPF NLRI is received, all that is required is to determine
  whether it is the most recent by examining the Node-ID and sequence number as described
  in <a href="#Phase-1" class="auto internal xref">Section 6.1</a>. If the received NLRI has changed, it is advertised
  to other BGP-LS-SPF peers. If the attributes have changed (other than the sequence number),
  a BGP SPF calculation is triggered. However, a changed NLRI <span class="bcp14">MAY</span> be advertised immediately
  to other peers and prior to any SPF calculation. Note that the BGP
  MinASOriginationIntervalTimer <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> timer is not applicable
  to the BGP-LS-SPF SAFI. The MinRouteAdvertisementIntervalTimer is applicable with a suggested default
  of 5 seconds consistent with Internal BGP (IBGP) (refer to <span><a href="https://rfc-editor.org/rfc/rfc4271#section-10" class="relref">Section 10</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>).

  The scheduling of the SPF calculation, as described in
  <a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>, is an implementation and/or configuration matter.
  Scheduling <span class="bcp14">MAY</span> be dampened consistent with the SPF Back-Off Delay algorithm
  specified in <span>[<a href="#RFC8405" class="cite xref">RFC8405</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
  The Phase 3 decision function
  of the Decision Process <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> is also simplified because under
  normal SPF operation, a BGP speaker <span class="bcp14">MUST</span> advertise the changed NLRIs
  to all BGP peers with the BGP-LS-SPF AFI/SAFI and install the changed routes in
  the GLOBAL-RIB. The only exceptions are unchanged
  NLRIs or stale NLRIs, i.e., an NLRI received with a less recent (numerically smaller)
  sequence number.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="Phase-1">
<section id="section-6.1">
        <h3 id="name-bgp-spf-nlri-selection">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-bgp-spf-nlri-selection" class="section-name selfRef">BGP SPF NLRI Selection</a>
        </h3>
<p id="section-6.1-1">
   For all BGP-LS-SPF NLRIs, the selection rules for Phase 1 of the BGP
   Decision Process (see <span><a href="https://rfc-editor.org/rfc/rfc4271#section-9.1.1" class="relref">Section 9.1.1</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>) no longer apply.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
<li id="section-6.1-2.1">
  NLRIs self-originated from directly connected BGP SPF peers are preferred.
  This condition can be determined by comparing the BGP Identifiers in
  the received Local Node Descriptor and the BGP OPEN message for an active
  BGP session. This rule assures that a stale NLRI is updated even if a BGP SPF router
  loses its sequence number state due to a cold start. Note that once the BGP session
  goes down, the NLRI received is no longer considered as being from a directly
  connected BGP SPF peer.<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.2">
  Consistent with base BGP <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, an NLRI received from a peer will always
  replace the same NLRI received from that peer. Coupled with rule #1, this will ensure that
  any stale NLRI in the BGP SPF routing domain will be updated.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.3">
  The NLRI with the most recent Sequence Number TLV, i.e., the highest sequence number is selected.<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.4">
  The NLRI received from the BGP speaker with the numerically larger BGP
  Identifier is preferred.<a href="#section-6.1-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.1-3">
  When a BGP speaker completely loses its sequence number state, e.g., due to a cold start, or
  in the unlikely possibility that a 64-bit sequence number wraps, the BGP routing domain will
  still converge.

  This is due to the fact that BGP speakers adjacent to the router
  always accept self-originated NLRIs from the associated speaker as more recent (rule #1). When a
  BGP speaker reestablishes a connection with its peers, any existing sessions are taken
  down and stale NLRIs are replaced. The adjacent BGP speakers update their NLRI
  advertisements and advertise to their neighbors until the BGP routing domain has converged.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
  The modified SPF Decision Process performs an SPF calculation rooted at the local BGP
  speaker using the metrics from the Link Attribute IGP Metric (TLV 1095) and
  the Prefix Attribute Prefix Metric (TLV 1155) <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  These metrics are considered consistently across the BGP SPF domain.
  As a result, any other BGP attributes that
  would influence the BGP Decision Process defined in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> including
  ORIGIN, MULTI_EXIT_DISC, and
  LOCAL_PREF attributes are ignored by the SPF algorithm. The Next Hop in the MP_REACH_NLRI attribute
  <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span> is discussed in <a href="#NEXT-HOP" class="auto internal xref">Section 5.4</a>.
  The AS_PATH and AS4_PATH attributes <span>[<a href="#RFC6793" class="cite xref">RFC6793</a>]</span>
  are preserved and used for loop detection <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. They are ignored
  during the SPF computation for BGP-LS-SPF NLRIs.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<div id="Self-Origin">
<section id="section-6.1.1">
          <h4 id="name-bgp-self-originated-nlri">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-bgp-self-originated-nlri" class="section-name selfRef">BGP Self-Originated NLRI</a>
          </h4>
<p id="section-6.1.1-1">
  Nodes, Links, or Prefix NLRIs with Node Descriptors matching the local BGP speaker are
  considered self-originated. When a self-originated NLRI is received and it doesn't match the
  local node's NLRI content (including the sequence number), special processing is required.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-2.1">
    If a self-originated NLRI is received and the sequence number is more recent (i.e., greater than
    the local node's sequence number for the NLRI), the NLRI sequence number is advanced to
    one greater than the received sequence number, and the NLRI is readvertised to all peers.<a href="#section-6.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-2.2">
    If a self-originated NLRI is received and the sequence number is the same as the local node's
    sequence number but the attributes differ, the NLRI sequence number is advanced to
    one greater than the received sequence number, and the NLRI is readvertised to all peers.<a href="#section-6.1.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.1-3">
  The above actions are performed immediately when the first instance of a newer self-originated NLRI is
  received. In this case, the newer instance is considered to be a stale instance that was advertised by
  the local node prior to a restart where the NLRI state was lost.
  However, if subsequent newer self-originated
  NLRI is received for the same Node, Link, or Prefix NLRI, the readvertisement
  or withdrawal is delayed by BGP_LS_SPF_SELF_READVERTISEMENT_DELAY (default 5) seconds
  since it is likely being advertised by a misconfigured or rogue BGP speaker
  (refer to <a href="#Security" class="auto internal xref">Section 9</a>).<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dual-stack">
<section id="section-6.2">
        <h3 id="name-dual-stack-support">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-dual-stack-support" class="section-name selfRef">Dual-Stack Support</a>
        </h3>
<p id="section-6.2-1">
  The SPF-based Decision Process operates on Node, Link, and Prefix NLRIs that support
  both IPv4 and IPv6 addresses. Whether to run a single SPF computation or multiple
  SPF computations for separate AFs is an implementation and/or policy matter. Normally, IPv4
  next-hops are calculated for IPv4 prefixes, and IPv6 next-hops are calculated for IPv6
  prefixes.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="BGP-SPF">
<section id="section-6.3">
        <h3 id="name-spf-calculation-based-on-bg">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-spf-calculation-based-on-bg" class="section-name selfRef">SPF Calculation Based on BGP-LS-SPF NLRI</a>
        </h3>
<p id="section-6.3-1">
  This section details the BGP-LS-SPF local Routing Information Base (RIB) calculation.
  The router uses BGP-LS-SPF Node, Link, and Prefix NLRIs to compute routes using the
  following algorithm. This calculation yields the set of routes associated
  with the BGP SPF routing domain.  A router calculates the shortest-path tree using itself
  as the root. Optimizations to the BGP-LS-SPF algorithm are possible but <span class="bcp14">MUST</span> yield
  the same set of routes. The algorithm below supports ECMP
  routes. Weighted Unequal-Cost Multipath (UCMP) routes are out of scope.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
  The following abstract data structures are defined in order to specify the algorithm.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-3">
          <dt id="section-6.3-3.1">Local Route Information Base (Local-RIB):</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-3.2">A routing table
   that contains reachability information (i.e., next-hops) for all prefixes (both
   IPv4 and IPv6) as well as BGP-LS-SPF node reachability.
   Implementations may
   choose to implement this with separate RIBs for each address family and/or
   separate RIBs for prefix and node reachability.<a href="#section-6.3-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.3">Global Routing Information Base (GLOBAL-RIB):</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-3.4">The
   RIB containing the current routes that are
   installed in the router's forwarding plane.  This is commonly referred to
   in networking parlance as "the RIB".<a href="#section-6.3-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.5">Link State Database (LSDB):</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-3.6">A database of BGP-LS-SPF NLRIs
   that facilitate access to all Node, Link, and Prefix NLRIs.<a href="#section-6.3-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.7">Candidate List (CAN-LIST):</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-3.8">A list of candidate Node
   NLRIs used during the BGP SPF calculation. The list is sorted by the cost
   to reach the Node NLRI, with the Node NLRI that has the lowest reachability cost
   at the head of the list. This facilitates the execution of the Dijkstra
   algorithm, where the shortest paths between the local node and other nodes
   in the graph are computed.  The CAN-LIST is typically implemented as a heap but
   other data structures have been used.<a href="#section-6.3-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-4">The Dijkstra algorithm consists of the steps below:<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-5">
<li id="section-6.3-5.1">
  The current Local-RIB is invalidated, and the CAN-LIST is initialized to be empty.
  The Local-RIB is rebuilt during the course of the SPF computation.  The existing routing entries
  are preserved for comparison to determine changes that need to be made to the GLOBAL-RIB in
  Step 6. These routes are referred to as "stale routes".<a href="#section-6.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.2">
   The cost of the Local-RIB Node route entry for the computing router is set to 0.
   The computing router's Node NLRI is added to the CAN-LIST (which was previously initialized
   to be empty in Step 1). The next-hop list is set to the internal loopback next-hop.<a href="#section-6.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.3">
  The Node NLRI with the lowest cost is removed from the CAN-LIST for processing.
  If the BGP-LS Attribute includes an SPF Status TLV
  (refer to <a href="#node-status-tlv" class="auto internal xref">Section 5.2.1.1</a>)
  indicating the node is unreachable, the Node NLRI is ignored and the next lowest-cost
  Node NLRI is selected from the CAN-LIST. The
  Node corresponding to this NLRI is referred to as the "Current-Node". If the CAN-LIST
  list is empty, the SPF calculation has completed and the algorithm proceeds to Step 6.<a href="#section-6.3-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.4">
            <p id="section-6.3-5.4.1">
    All the Prefix NLRIs with the same Local Node Descriptors as the Current-Node are considered
    for installation. The next-hop(s) for these Prefix NLRIs are inherited from the Current-Node.
    If the Current-Node is for the local BGP router, the next-hop for the prefix is a direct
    next-hop.  The cost for each prefix is the metric advertised in the Prefix Attribute
    Prefix Metric (TLV 1155) added to the cost to reach the Current-Node. The following
    is done for each Prefix NLRI (referred to as the "Current-Prefix"):<a href="#section-6.3-5.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.4.2.1">
    If the BGP-LS Prefix Attribute includes an SPF Status TLV indicating the prefix is
    unreachable, the Current-Prefix is considered unreachable, and the next Prefix
    NLRI is examined in Step 4.<a href="#section-6.3-5.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.4.2.2">
    If the Current-Prefix's corresponding prefix is in the Local-RIB and the
    Local-RIB metric is less than the Current-Prefix's metric,
    the Current-Prefix does not contribute to the route, and the next Prefix NLRI is
    examined in Step 4.<a href="#section-6.3-5.4.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.4.2.3">
    If the Current-Prefix's corresponding prefix is not in the Local-RIB,
    the prefix is installed with the Current-Node's next-hops
    installed as the Local-RIB route's next-hops. The Local-RIB route metric is set to the sum of the cost for Current-Node and the Current-Prefix's metric. If the
    IGP Route Tag (TLV 1153) is
    included in the Current-Prefix's NLRI Attribute, the tag(s) is installed in the
    current Local-RIB route's tag(s).<a href="#section-6.3-5.4.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.4.2.4">
    If the Current-Prefix's corresponding prefix is in the Local-RIB and the cost is less
    than the Local-RIB route's metric, the prefix is installed with the Current-Node's next-hops, which 
    replace the Local-RIB route's next-hops and the metric being updated, and any route tags
    are removed. If the IGP Route Tag (TLV 1153) is
    included in the Current-Prefix's NLRI Attribute, the tag(s) is installed in the
    current Local-RIB route's tag(s).<a href="#section-6.3-5.4.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.4.2.5">
    If the Current-Prefix's corresponding prefix is in the Local-RIB and the cost
    is the same as the Local-RIB route's metric, the Current-Node's next-hops are merged
    with the Local-RIB route's next-hops.
    The algorithm below supports ECMP routes.
    Some platforms or implementations may have limits on the number of
    ECMP routes that can be supported.  The setting or identification
    of any limitations is outside the scope if this document.
    Weighted UCMP routes are out of scope as well.<a href="#section-6.3-5.4.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-6.3-5.5">
            <p id="section-6.3-5.5.1">
    All the Link NLRIs with the same Node Identifiers as the Current-Node are considered
    for installation. Each link is examined and referred to as the "Current-Link" in the following text. The cost of the Current-Link is the advertised IGP Metric (TLV 1095)
    from the Link NLRI BGP-LS attribute added to the cost to reach the Current-Node.
    If the Current-Node is for the local BGP router,
    the next-hop for the link is a direct next-hop pointing to the corresponding local
    interface. For any other Current-Node, the next-hop(s) for the Current-Link is inherited
    from the Current-Node. The following is done for each link:<a href="#section-6.3-5.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-6.3-5.5.2">
<li id="section-6.3-5.5.2.1">
  If the Current-Link's NLRI attribute includes an SPF Status TLV indicating the link is
  down, the BGP-LS-SPF Link NLRI is considered down, and the next link
  for the Current-Node is examined in Step 5.<a href="#section-6.3-5.5.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.3-5.5.2.2">
  If the Current-Node NLRI attributes include the SPF Status TLV
  (refer to <a href="#node-status-tlv" class="auto internal xref">Section 5.2.1.1</a>) and the status
  indicates that the Node doesn't support transit, the next link for the Current-Node is
  processed in Step 5.<a href="#section-6.3-5.5.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-6.3-5.5.2.3">
                <p id="section-6.3-5.5.2.3.1">
    The Current-Link's Remote Node NLRI is accessed (i.e., the Node NLRI
    with the same Node Identifiers as the Current-Link's Remote Node Descriptors). If it exists,
    it is referred to as the "Remote-Node" and the algorithm proceeds as follows:<a href="#section-6.3-5.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.5.2.3.2.1">
    If the Remote-Node's NLRI attribute includes an SPF Status TLV indicating the node is
    unreachable, the next link for the Current-Node is examined in Step 5.<a href="#section-6.3-5.5.2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.2">
                    <p id="section-6.3-5.5.2.3.2.2.1">
  All the Link NLRIs corresponding to the Remote-Node are searched for a Link
  NLRI pointing to the Current-Node. Each Remote-Node's Link NLRI (referred to as the
  Remote-Link) is examined for Remote Node Descriptors matching the Current-Node and
  Link Descriptors matching the Current-Link.<a href="#section-6.3-5.5.2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.5.2.3.2.2.2.1">
      For IPv4/IPv6 numbered Link Descriptors to match during the IPv4 SPF computation, the
      Current-Link's IP4/IPv6 interface address link descriptor <span class="bcp14">MUST</span> match the Remote-Link
      IPv4/IPv6 neighbor address link descriptor, and the Current-Link's IPv4/IPv6 neighbor
      address <span class="bcp14">MUST</span> match the Remote-Link's IPv4/IPv6 interface address.<a href="#section-6.3-5.5.2.3.2.2.2.1" class="pilcrow">¶</a>
</li>
                      <li class="normal" id="section-6.3-5.5.2.3.2.2.2.2">
      For unnumbered links to match during the IPv4 or IPv6 SPF computation,
      the Current-Link and Remote-Link's Address Family Link Descriptor TLV must match
      the address family of the IPv4 or IPv6 SPF computation,
      the Current-Link's Remote Identifier <span class="bcp14">MUST</span> match the Remote-Link's Local
      Identifier, and the Current-Link's Remote Identifier <span class="bcp14">MUST</span> match the
      Remote-Link's Local Identifier.
      Since the Link's Remote Identifier may not be known, a value of 0
      is considered a wildcard and will match any Current or Remote Link's Local
      Identifier (see TLV 258 <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>).
      Address Family Link Descriptor TLVs for multiple address families may be
      advertised so that an unnumbered link can be used in the SPF computation for
      multiple address families.<a href="#section-6.3-5.5.2.3.2.2.2.2" class="pilcrow">¶</a>
</li>
                    </ul>
<p id="section-6.3-5.5.2.3.2.2.3">
    If these conditions are satisfied for one of the Remote-Node's links,
    the bidirectional connectivity
    check succeeds and the Remote-Node may be processed further. The
    Remote-Node's Link NLRI providing bidirectional connectivity
    is referred to as the Remote-Link. If no Remote-Link is found, the next
    link for the Current-Node is examined in Step 5.<a href="#section-6.3-5.5.2.3.2.2.3" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.3">
  If the Remote-Link NLRI attribute includes an SPF Status TLV indicating
  the link is down, the Remote-Link NLRI is considered down, and the next link
  for the Current-Node is examined in Step 5.<a href="#section-6.3-5.5.2.3.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.4">
  If the Remote-Node is not on the CAN-LIST, it is inserted based
  on the cost. The Remote Node's cost is the cost of the Current-Node added
  to the Current-Link's IGP Metric (TLV 1095). The next-hop(s) for the Remote-Node
  is inherited from the Current-Link.<a href="#section-6.3-5.5.2.3.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.5">
  If the Remote-Node NLRI is already on the CAN-LIST with a higher cost, it
  must be removed and reinserted with the Remote-Node cost based on the
  Current-Link (as calculated in the previous step). The
  next-hop(s) for the Remote-Node is inherited from the Current-Link.<a href="#section-6.3-5.5.2.3.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.6">
  If the Remote-Node NLRI is already on the CAN-LIST with the same cost, it need
  not be reinserted on the CAN-LIST. However, the Current-Link's next-hop(s)
  must be merged into the current set of next-hops for the Remote-Node.<a href="#section-6.3-5.5.2.3.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.3-5.5.2.3.2.7">
  If the Remote-Node NLRI is already on the CAN-LIST with a lower cost, it need
  not be reinserted on the CAN-LIST.<a href="#section-6.3-5.5.2.3.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li id="section-6.3-5.5.2.4">
  Return to Step 3 to process the next lowest-cost Node NLRI on the CAN-LIST.<a href="#section-6.3-5.5.2.4" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-6.3-5.6">
            <p id="section-6.3-5.6.1">
    The Local-RIB is examined and changes (adds, deletes, and modifications) are installed into
    the GLOBAL-RIB. For each route in the Local-RIB:<a href="#section-6.3-5.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-5.6.2.1">
    If the route was added during the current BGP SPF computation, install the route into
    the GLOBAL-RIB.<a href="#section-6.3-5.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.6.2.2">
  If the route was modified during the current BGP SPF computation (e.g., metric, tags,
  or next-hops), update the route in the GLOBAL-RIB.<a href="#section-6.3-5.6.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-5.6.2.3">
  If the route was not installed during the current BGP SPF computation, remove the route
  from the GLOBAL-RIB.<a href="#section-6.3-5.6.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<section id="section-6.4">
        <h3 id="name-ipv4-ipv6-unicast-address-f">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-ipv4-ipv6-unicast-address-f" class="section-name selfRef">IPv4/IPv6 Unicast Address Family Interaction</a>
        </h3>
<p id="section-6.4-1">
  While the BGP-LS-SPF address family and the BGP unicast address families may install routes
  into the routing tables of the same device, they operate independently (i.e., "ships-in-the-night" mode).
  There is no implicit route redistribution between the BGP-LS-SPF address family and the BGP
  unicast address families.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">
  It is <span class="bcp14">RECOMMENDED</span> that BGP-LS-SPF IPv4/IPv6 route computation and
  installation be given scheduling priority by default over other BGP address families
  as the BGP-LS-SPF SAFI is considered an underlay SAFI.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
<div id="NLRI-Advertise">
<section id="section-6.5">
        <h3 id="name-nlri-advertisement">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-nlri-advertisement" class="section-name selfRef">NLRI Advertisement</a>
        </h3>
<div id="failure-converge">
<section id="section-6.5.1">
          <h4 id="name-link-prefix-failure-converg">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-link-prefix-failure-converg" class="section-name selfRef">Link/Prefix Failure Convergence</a>
          </h4>
<p id="section-6.5.1-1">
  A local failure prevents a link from being used in the SPF calculation
  due to the IGP bidirectional connectivity requirement. Consequently, local link
  failures <span class="bcp14">SHOULD</span> always be communicated as quickly as possible and given priority
  over other categories of changes to ensure expeditious propagation
  and optimal convergence.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
<p id="section-6.5.1-2">
  According to standard BGP procedures, the link would continue
  to be used until the last copy of the BGP-LS-SPF Link NLRI is
  withdrawn. In order to avoid this delay, the originator of the Link NLRI <span class="bcp14">SHOULD</span>
  advertise a more recent version with an increased Sequence Number TLV for
  the BGP-LS-SPF Link NLRI including the SPF Status TLV
  (refer to <a href="#link-status-tlv" class="auto internal xref">Section 5.2.2.2</a>) indicating the link
  is down with respect to BGP SPF.
  The configurable LinkStatusDownAdvertise timer
  controls the interval that the BGP-LS-SPF Link NLRI is advertised with SPF Status indicating
  the link is down prior to withdrawal.

 If the BGP-LS-SPF Link NLRI is advertised with the SPF Status TLV
 included in the BGP-LS Attribute, and the link becomes available in that period,
 the originator of the BGP-LS-SPF Link NLRI <span class="bcp14">MUST</span> advertise a more recent
 version of the BGP-LS-SPF Link NLRI without the SPF Status TLV in the
 BGP-LS Link Attribute.

  The suggested default value for the LinkStatusDownAdvertise timer is 2 seconds.<a href="#section-6.5.1-2" class="pilcrow">¶</a></p>
<p id="section-6.5.1-3">
  Similarly, when a prefix becomes unreachable, a more recent version of the BGP-LS-SPF
  Prefix NLRI <span class="bcp14">SHOULD</span> be advertised with the SPF Status TLV
  (refer to <a href="#prefix-status-tlv" class="auto internal xref">Section 5.2.3.1</a>)
  to indicate that the prefix is unreachable in the BGP-LS Prefix Attributes, and the prefix will be
  considered unreachable with respect to BGP SPF.

  The configurable PrefixStatusDownAdvertise timer
  controls the interval that the BGP-LS-Prefix NLRI is advertised with SPF Status indicating
  the prefix is unreachable prior to withdrawal.
  If the BGP-LS-SPF Prefix has been advertised with the SPF Status TLV and the prefix
  becomes reachable in that period, the originator of the BGP-LS-SPF Prefix NLRI
  <span class="bcp14">MUST</span> advertise a more recent version of the BGP-LS-SPF Prefix NLRI without the
  SPF Status TLV in the BGP-LS Prefix Attributes.
  The suggested default value for the PrefixStatusDownAdvertise timer is 2 seconds.<a href="#section-6.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="node-failure">
<section id="section-6.5.2">
          <h4 id="name-node-failure-convergence">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-node-failure-convergence" class="section-name selfRef">Node Failure Convergence</a>
          </h4>
<p id="section-6.5.2-1">
  By default, all the NLRIs advertised by a node are withdrawn when a session
  failure is detected <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. If fast failure detection such as BFD
  <span>[<a href="#RFC5880" class="cite xref">RFC5880</a>]</span> is utilized, and the node is
  on the fastest converging path, the most recent versions of BGP-LS-SPF NLRI will be
  withdrawn. This may result in older versions of NLRIs received from one or more peers on
  a different path(s) in the LSDB until they are withdrawn.
  These stale NLRIs will not delay convergence since the adjacent nodes detect the
  link failure and advertise a more recent NLRI indicating the link is down with respect to
  BGP SPF (refer to <a href="#failure-converge" class="auto internal xref">Section 6.5.1</a>) and the
  bidirectional connectivity check fails during the BGP SPF calculation
  (refer to <a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>).<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="error-handling">
<section id="section-7">
      <h2 id="name-error-handling">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
      </h2>
<p id="section-7-1">
  This section describes error-handling actions, as described in
  <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>, that are specific to BGP-LS-SPF SAFI BGP UPDATE
  message processing.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="new-TLVs">
<section id="section-7.1">
        <h3 id="name-processing-of-bgp-ls-spf-tl">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-processing-of-bgp-ls-spf-tl" class="section-name selfRef">Processing of BGP-LS-SPF TLVs</a>
        </h3>
<p id="section-7.1-1">
  When a BGP speaker receives a BGP Update containing a malformed Node NLRI
  SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>,
  the corresponding Node NLRI is
  considered malformed and <span class="bcp14">MUST</span> be handled as 'treat-as-withdraw'. An
  implementation <span class="bcp14">SHOULD</span> log an error (subject to rate limiting) for further analysis.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
  When a BGP speaker receives a BGP Update containing a malformed Link NLRI
  SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>,
  the corresponding Link NLRI is
  considered malformed and <span class="bcp14">MUST</span> be handled as 'treat-as-withdraw'. An
  implementation <span class="bcp14">SHOULD</span> log an error (subject to rate limiting) for further analysis.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">
  When a BGP speaker receives a BGP Update containing a malformed Address Family
  Link Descriptor TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>,
  the corresponding Link NLRI is
  considered malformed and <span class="bcp14">MUST</span> be handled as 'treat-as-withdraw'. An
  implementation <span class="bcp14">SHOULD</span> log an error (subject to rate limiting) for further analysis.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">
  When a BGP speaker receives a BGP Update containing a malformed Prefix NLRI
  SPF Status TLV in the BGP-LS Attribute <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>,
  the corresponding Prefix NLRI is
  considered malformed and <span class="bcp14">MUST</span> be handled as 'treat-as-withdraw'. An
  implementation <span class="bcp14">SHOULD</span> log an error (subject to rate limiting) for further analysis.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">
  When a BGP speaker receives a BGP Update containing a malformed BGP-LS Attribute TE
  and IGP Metric TLV, the corresponding NLRI is considered malformed
  and <span class="bcp14">MUST</span> be handled as 'treat-as-withdraw' <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.
  An implementation <span class="bcp14">SHOULD</span> log an error (subject to rate limiting) for further analysis.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">
  The BGP-LS Attribute consists of Node attribute TLVs, Link attribute TLVs, and Prefix
  attribute TLVs. Node attribute TLVs and their error-handling rules are either defined in
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  or derived from <span>[<a href="#RFC5305" class="cite xref">RFC5305</a>]</span> and <span>[<a href="#RFC6119" class="cite xref">RFC6119</a>]</span>.
  If a BGP speaker receives a BGP-LS Attribute that is considered malformed based on these
  error-handling rules, then it <span class="bcp14">MUST</span> consider the received NLRI as malformed, and the receiving
  BGP speaker <span class="bcp14">MUST</span> handle such a malformed NLRI as 'treat-as-withdraw' <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7">
  Node Descriptor TLVs and their error-handling rules are defined in
  <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.2.1" class="relref">Section 5.2.1</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  Node Attribute TLVs and their error-handling rules are either defined in
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  or derived from <span>[<a href="#RFC5305" class="cite xref">RFC5305</a>]</span> and <span>[<a href="#RFC6119" class="cite xref">RFC6119</a>]</span>.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<p id="section-7.1-8">
  Link Descriptor TLVs and their error-handling rules are defined in
  <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.2.2" class="relref">Section 5.2.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  Link Attribute TLVs and their error-handling rules are either defined in
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  or derived from <span>[<a href="#RFC5305" class="cite xref">RFC5305</a>]</span> and <span>[<a href="#RFC6119" class="cite xref">RFC6119</a>]</span>.<a href="#section-7.1-8" class="pilcrow">¶</a></p>
<p id="section-7.1-9">
  Prefix Descriptor TLVs and their error-handling rules are defined in
  <span><a href="https://rfc-editor.org/rfc/rfc9552#section-5.2.3" class="relref">Section 5.2.3</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.
  Prefix Attribute TLVs and their error-handling rules are either defined in
  <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>
  or derived from <span>[<a href="#RFC5130" class="cite xref">RFC5130</a>]</span> and
  <span>[<a href="#RFC2328" class="cite xref">RFC2328</a>]</span>.<a href="#section-7.1-9" class="pilcrow">¶</a></p>
<p id="section-7.1-10">
  If a BGP speaker receives NLRI with a Node Descriptor TLV, Link Descriptor TLV, or Prefix Descriptor
  TLV that is considered malformed based on error handling rules defined in the above references,
  then it <span class="bcp14">MUST</span> consider the received NLRI as malformed, and the receiving
  BGP speaker <span class="bcp14">MUST</span> handle such a malformed NLRI as 'treat-as-withdraw' <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-7.1-10" class="pilcrow">¶</a></p>
<p id="section-7.1-11">
  When a BGP speaker receives a BGP Update that does not contain any BGP-LS Attributes,
  it is most likely an indication of 'Attribute Discard' fault handling, and the
  BGP speaker <span class="bcp14">SHOULD</span> preserve and propagate the BGP-LS-SPF NLRI as described in
  <span><a href="https://rfc-editor.org/rfc/rfc9552#section-8.2.2" class="relref">Section 8.2.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>. However, NLRIs without the BGP-LS Attribute
  <span class="bcp14">MUST NOT</span> be used in the SPF calculation (<a href="#BGP-SPF" class="auto internal xref">Section 6.3</a>). How this is accomplished
  is an implementation matter, but one way would be for these NLRIs not to be returned in
  LSDB lookups.<a href="#section-7.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bgpspf-nlri">
<section id="section-7.2">
        <h3 id="name-processing-of-bgp-ls-spf-nl">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-processing-of-bgp-ls-spf-nl" class="section-name selfRef">Processing of BGP-LS-SPF NLRIs</a>
        </h3>
<p id="section-7.2-1">
  A BGP speaker supporting the BGP-LS-SPF SAFI <span class="bcp14">MUST</span> perform the syntactic validation checks of the
  BGP-LS-SPF NLRI listed in <span><a href="https://rfc-editor.org/rfc/rfc9552#section-8.2.2" class="relref">Section 8.2.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> to determine if
  it is malformed.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bgpspf-attribute">
<section id="section-7.3">
        <h3 id="name-processing-of-bgp-ls-attrib">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-processing-of-bgp-ls-attrib" class="section-name selfRef">Processing of BGP-LS Attributes</a>
        </h3>
<p id="section-7.3-1">
 A BGP speaker supporting the BGP-LS-SPF SAFI <span class="bcp14">MUST</span> perform the syntactic validation checks of the
 BGP-LS Attribute listed in <span><a href="https://rfc-editor.org/rfc/rfc9552#section-8.2.2" class="relref">Section 8.2.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span> to determine if
 it is malformed.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">
  An implementation <span class="bcp14">SHOULD</span> log an error for further analysis for problems
  detected during syntax validation.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bgp-sync">
<section id="section-7.4">
        <h3 id="name-bgp-ls-spf-link-state-datab">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-bgp-ls-spf-link-state-datab" class="section-name selfRef">BGP-LS-SPF Link State Database Synchronization</a>
        </h3>
<p id="section-7.4-1">
    While uncommon, there may be situations where the LSDBs of two
    BGP speakers support the BGP-LS-SPF SAFI lose synchronization.
    In these situations, the BGP
    session <span class="bcp14">MUST</span> be reset unless other means of resynchronization are used
    (beyond the scope of this document).
    When the session is reset, the BGP speaker <span class="bcp14">MUST</span> send a NOTIFICATION
    message with the BGP error code "Loss of LSDB Synchronization" as described
    in <span><a href="https://rfc-editor.org/rfc/rfc4271#section-3" class="relref">Section 3</a> of [<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. The mechanisms to detect loss of
    synchronization are beyond the scope of this document.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-bgp-ls-spf-allocation-in-th">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-bgp-ls-spf-allocation-in-th" class="section-name selfRef">BGP-LS-SPF Allocation in the SAFI Values Registry</a>
        </h3>
<p id="section-8.1-1">
  IANA has assigned value 80 for BGP-LS-SPF from the First Come First
  Served range <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span> and listed this document as a reference in the "SAFI Values" registry within the "Subsequent Address Family Identifiers (SAFI) Parameters" registry group.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-bgp-ls-spf-assignments-in-t">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-bgp-ls-spf-assignments-in-t" class="section-name selfRef">BGP-LS-SPF Assignments in the BGP-LS NLRI and Attribute TLVs Registry</a>
        </h3>
<p id="section-8.2-1">
  IANA has assigned six TLVs for BGP-LS-SPF NLRI in the "BGP-LS NLRI and Attribute
  TLVs" registry. Supported TLV types include Sequence Number, SPF Status, and Address Family Link
  Descriptor.  Deprecated TLV types include SPF Capability, IPv4 Link Prefix Length, and IPv6
  Link Prefix Length.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-nlri-attribute-tlvs"></span><div id="tab.iana-attr">
<table class="center" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-nlri-attribute-tlvs" class="selfRef">NLRI Attribute TLVs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">TLV Code Point</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1181</td>
              <td class="text-left" rowspan="1" colspan="1">Sequence Number</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sequence-number-tlv" class="auto internal xref">Section 5.2.4</a> of RFC 9815</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1184</td>
              <td class="text-left" rowspan="1" colspan="1">SPF Status</td>
              <td class="text-left" rowspan="1" colspan="1">Sections <a href="#node-status-tlv" class="auto internal xref">5.2.1.1</a>,
<a href="#link-status-tlv" class="auto internal xref">5.2.2.2</a>, and <a href="#prefix-status-tlv" class="auto internal xref">5.2.3.1</a> of RFC 9815</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1185</td>
              <td class="text-left" rowspan="1" colspan="1">Address Family Link Descriptor</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#af-link-descriptor-tlv" class="auto internal xref">Section 5.2.2.1</a> of RFC 9815</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.2-3">
  The early allocation assignments for the TLV types SPF Capability (1180),
  IPv4 Link Prefix Length (1182), and IPv6 Link Prefix Length (1183) are no longer required
  and have been deprecated.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8.3">
        <h3 id="name-bgp-ls-spf-node-nlri-attribu">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-bgp-ls-spf-node-nlri-attribu" class="section-name selfRef">BGP-LS-SPF Node NLRI Attribute SPF Status TLV Values Registry</a>
        </h3>
<p id="section-8.3-1">
    IANA has created the "BGP-LS-SPF Node NLRI Attribute SPF
    Status TLV Values" registry for status values within the "BGP Shortest Path First (BGP SPF)" registry group.
    Initial values for this registry are provided below.  Future assignments
    are to be made using the Expert Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>
    with guidance for designated experts as per <span><a href="https://rfc-editor.org/rfc/rfc9552#section-7.2" class="relref">Section 7.2</a> of [<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ls-spf-node-nlri-attribut"></span><div id="tab.iana-node-status">
<table class="center" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-bgp-ls-spf-node-nlri-attribut" class="selfRef">BGP-LS-SPF Node NLRI Attribute SPF Status TLV Values Registry Assignments</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Values</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Node unreachable with respect to BGP SPF</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Node does not support transit traffic with respect to BGP SPF</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-254</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-8.4">
        <h3 id="name-bgp-ls-spf-link-nlri-attribu">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-bgp-ls-spf-link-nlri-attribu" class="section-name selfRef">BGP-LS-SPF Link NLRI Attribute SPF Status TLV Values Registry</a>
        </h3>
<p id="section-8.4-1">
    IANA has created the "BGP-LS-SPF Link NLRI Attribute SPF
    Status TLV Values" registry for status values within the BGP Shortest Path First (BGP SPF)" registry group.
    Initial values for this registry are provided below.  Future assignments
    are to be made using the IETF Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ls-spf-link-nlri-attribut"></span><div id="tab.iana-link-status">
<table class="center" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-bgp-ls-spf-link-nlri-attribut" class="selfRef">BGP-LS-SPF Link NLRI Attribute SPF Status TLV Values Registry Assignments</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Link unreachable with respect to BGP SPF</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-254</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-8.5">
        <h3 id="name-bgp-ls-spf-prefix-nlri-attri">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-bgp-ls-spf-prefix-nlri-attri" class="section-name selfRef">BGP-LS-SPF Prefix NLRI Attribute SPF Status TLV Values Registry</a>
        </h3>
<p id="section-8.5-1">
    IANA has created the "BGP-LS-SPF Prefix NLRI Attribute SPF
    Status TLV Values" registry for status values within the "BGP Shortest Path First (BGP SPF)" registry group.
    Initial values for this registry are provided below.  Future assignments
    are to be made using the IETF Review registration policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ls-spf-prefix-nlri-attrib"></span><div id="tab.iana-prefix-status">
<table class="center" id="table-8">
          <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-bgp-ls-spf-prefix-nlri-attrib" class="selfRef">BGP-LS-SPF Prefix NLRI Attribute SPF Status TLV Values Registry Assignments</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Prefix unreachable with respect to BGP SPF</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2-254</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-8.6">
        <h3 id="name-assignment-in-the-bgp-error">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-assignment-in-the-bgp-error" class="section-name selfRef">Assignment in the BGP Error (Notification) Codes Registry</a>
        </h3>
<p id="section-8.6-1">
    IANA has assigned value 9 for Loss of LSDB Synchronization in the
    "BGP Error (Notification) Codes" registry within the
    "Border Gateway Protocol (BGP) Parameters" registry group.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">
  This document defines a BGP SAFI, i.e., the BGP-LS-SPF SAFI. This document
  does not change the underlying security issues inherent in the BGP protocol
  <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>. The security considerations
  discussed in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> apply to the BGP SPF functionality as well.
  The analysis of the security issues for BGP mentioned
  in <span>[<a href="#RFC4272" class="cite xref">RFC4272</a>]</span> and <span>[<a href="#RFC6952" class="cite xref">RFC6952</a>]</span> also applies to this document.
  The threats and security considerations are similar to the BGP IPv4 unicast SAFI and
  IPv6 unicast SAFI when utilized in similar deployments, e.g., <span>[<a href="#RFC7938" class="cite xref">RFC7938</a>]</span>.
  The analysis of generic threats to routing protocols in <span>[<a href="#RFC4593" class="cite xref">RFC4593</a>]</span>
  is also worth noting.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
  As the modifications for
  BGP SPF described in this document apply to IPv4 unicast and IPv6 unicast as underlay SAFIs in a single
  BGP SPF routing domain, the BGP
  security solutions described in <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span> and <span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span>
  are out of scope as they are meant to apply for inter-domain BGP, where
  multiple BGP routing domains are typically involved. The BGP-LS-SPF SAFI NLRIs described
  in this document are typically advertised between EBGP or
  IBGP speakers under a single administrative domain.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
 The BGP-LS-SPF SAFI and associated BGP SPF processing inherit the
 encodings from BGP-LS <span>[<a href="#RFC9552" class="cite xref">RFC9552</a>]</span>, and consequently, inherit the security
 considerations for BGP-LS associated with these encodings. 
  Additionally,
  given that BGP SPF processing
  is used to install IPv4 and IPv6 unicast routes, the BGP SPF processing is vulnerable to
  attacks to the routing control plane that aren't applicable to BGP-LS. One notable
  Denial-of-Service attack would be to include malformed BGP attributes in a replicated
  BGP Update, causing the receiving peer to treat the advertised BGP-LS-SPF to a
  withdrawal <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">
  In order to mitigate the risk of peering with BGP speakers masquerading
  as legitimate authorized BGP speakers, it is <span class="bcp14">RECOMMENDED</span> that
  the TCP Authentication Option (TCP-AO) <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span> be used to
  authenticate BGP sessions. If an authorized BGP peer is compromised, that
  BGP peer could advertise a modified Node, Link, or Prefix NLRI that results
  in misrouting, repeating origination of NLRI, and/or excessive SPF
  calculations. When a BGP speaker detects that its self-originated NLRI
  is being originated by another BGP speaker, an appropriate error <span class="bcp14">SHOULD</span>
  be logged so that the operator can take corrective action. This exposure is similar
  to other BGP AFI/SAFIs.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Management">
<section id="section-10">
      <h2 id="name-management-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-management-considerations" class="section-name selfRef">Management Considerations</a>
      </h2>
<p id="section-10-1">
  This section includes unique management considerations for the BGP-LS-SPF address family.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="Config">
<section id="section-10.1">
        <h3 id="name-configuration">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
        </h3>
<p id="section-10.1-1">
  All routers in the BGP SPF routing domain are under a single administrative domain
  allowing for consistent configuration.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="link-metric-config">
<section id="section-10.2">
        <h3 id="name-link-metric-configuration">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-link-metric-configuration" class="section-name selfRef">Link Metric Configuration</a>
        </h3>
<p id="section-10.2-1">
    For loopback prefixes, it is <span class="bcp14">RECOMMENDED</span> that the metric be 0.
    For non-loopback prefixes, the setting of the
    metric is a local matter and beyond the scope of this document.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">
    Algorithms that set the metric inversely to the link speed 
    in some IGP implementations <span class="bcp14">MAY</span> be supported. However, the
    details of how the metric is computed are beyond the scope of this document.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">
   Within a BGP SPF routing domain, the IGP metrics for all advertised links <span class="bcp14">SHOULD</span> be configured or
   defaulted consistently. For example, if a default metric is used for one router's links, then a
   similar metric should be used for all router's links. Similarly, if the link metric is
   derived from using the inverse of the link bandwidth on one router, then this <span class="bcp14">SHOULD</span>
   be done for all routers, and the same reference bandwidth <span class="bcp14">SHOULD</span> be used to derive the
   inversely proportional metric. Failure to do so will result in incorrect routing based on
   the link metric.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="neighbor-config">
<section id="section-10.3">
        <h3 id="name-unnumbered-link-configurati">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-unnumbered-link-configurati" class="section-name selfRef">Unnumbered Link Configuration</a>
        </h3>
<p id="section-10.3-1">
    When parallel unnumbered links between BGP SPF routers are included in the BGP SPF routing
    domain and the Remote Link Identifiers aren't readily discovered, it is <span class="bcp14">RECOMMENDED</span> that
    the Remote Link Identifiers be configured so that precise Link NLRI matching can be done.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Adjacency-EoR-Required">
<section id="section-10.4">
        <h3 id="name-adjacency-end-of-rib-eor-ma">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-adjacency-end-of-rib-eor-ma" class="section-name selfRef">Adjacency End-of-RIB (EOR) Marker Requirement</a>
        </h3>
<p id="section-10.4-1">
  Depending on the peering model, topology, and convergence requirements, an
  EoR marker (<a href="#BGP-LS-SPF-EOR" class="auto internal xref">Section 5.3</a>) for the BGP-LS-SPF
  SAFI <span class="bcp14">MAY</span> be required from the peer prior to advertising a BGP-LS Link NLRI
  for the peer. If configuration is supported, this <span class="bcp14">MUST</span> be configurable at
  the BGP SPF instance level and <span class="bcp14">MUST</span> be configured consistently throughout
  the BGP SPF routing domain.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">
  When this configuration is provided, the default <span class="bcp14">MUST</span> be to wait
  indefinitely prior to advertising a BGP-LS Link NLRI. Configuration of
  a timer specifying the maximum time to wait prior to advertisement
  <span class="bcp14">MAY</span> be provided.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spf-backoff-config">
<section id="section-10.5">
        <h3 id="name-backoff-config">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-backoff-config" class="section-name selfRef">backoff-config</a>
        </h3>
<p id="section-10.5-1">
  In addition to the configuration of the BGP-LS-SPF address family, implementations <span class="bcp14">SHOULD</span>
  support "Shortest Path First (SPF) Back-Off Delay Algorithm for Link-State IGPs"
  <span>[<a href="#RFC8405" class="cite xref">RFC8405</a>]</span>. If supported, configuration of the INITIAL_SPF_DELAY, SHORT_SPF_DELAY,
  LONG_SPF_DELAY, TIME_TO_LEARN, and HOLDDOWN_INTERVAL <span class="bcp14">MUST</span> be supported <span>[<a href="#RFC8405" class="cite xref">RFC8405</a>]</span>.
  <span><a href="https://rfc-editor.org/rfc/rfc8405#section-6" class="relref">Section 6</a> of [<a href="#RFC8405" class="cite xref">RFC8405</a>]</span> recommends consistent configuration of these values
  throughout the IGP routing domain, and this also applies to the BGP SPF routing domain.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bgp-ls-spf-readvertisement-delay">
<section id="section-10.6">
        <h3 id="name-bgp-ls-spf-nlri-readvertise">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-bgp-ls-spf-nlri-readvertise" class="section-name selfRef">BGP-LS-SPF NLRI Readvertisement Delay</a>
        </h3>
<p id="section-10.6-1">
  The configuration parameter that specifies the delay for readvertising a more recent
  instance of a self-originated NLRI when received more than once in succession
  is BGP_LS_SPF_SELF_READVERTISEMENT_DELAY. The default is 5 seconds.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Operation">
<section id="section-10.7">
        <h3 id="name-operational-data">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-operational-data" class="section-name selfRef">Operational Data</a>
        </h3>
<p id="section-10.7-1">
  In order to troubleshoot SPF issues, implementations <span class="bcp14">SHOULD</span> support an SPF log including
  entries for previous SPF computations. Each SPF log entry would include the BGP-LS-SPF NLRI SPF
  triggering the SPF, SPF scheduled time, SPF start time, and SPF end time.
  Since the size of the log is finite, implementations
  <span class="bcp14">SHOULD</span> also maintain counters for the total number of SPF computations and the
  total number of SPF triggering events. Additionally, troubleshooting should be available for SPF scheduling and
  back-off <span>[<a href="#RFC8405" class="cite xref">RFC8405</a>]</span>, the current SPF back-off state, the remaining time-to-learn,
  the remaining hold-down interval, the last trigger event time, the last SPF time, and the next SPF time.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bgp-ls-spf-isolation">
<section id="section-10.8">
        <h3 id="name-bgp-ls-spf-address-family-s">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-bgp-ls-spf-address-family-s" class="section-name selfRef">BGP-LS-SPF Address Family Session Isolation</a>
        </h3>
<p id="section-10.8-1">
  In common deployment scenarios, the unicast routes installed during
  the BGP-LS-SPF AFI/SAFI computation serve as the
  underlay for other BGP AFI/SAFIs.
  To avoid errors encountered in other AFI/SAFIs from impacting
  the BGP-LS-SPF AFI/SAFI or vice versa, isolation mechanisms such as
  separate BGP instances or separate BGP sessions (e.g., using different
  addresses for peering) for BGP-LS-SPF information distribution
  <span class="bcp14">SHOULD</span> be used.<a href="#section-10.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2328">[RFC2328]</dt>
        <dd>
<span class="refAuthor">Moy, J.</span>, <span class="refTitle">"OSPF Version 2"</span>, <span class="seriesInfo">STD 54</span>, <span class="seriesInfo">RFC 2328</span>, <span class="seriesInfo">DOI 10.17487/RFC2328</span>, <time datetime="1998-04" class="refDate">April 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2328">https://www.rfc-editor.org/info/rfc2328</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4202">[RFC4202]</dt>
        <dd>
<span class="refAuthor">Kompella, K., Ed.</span> and <span class="refAuthor">Y. Rekhter, Ed.</span>, <span class="refTitle">"Routing Extensions in Support of Generalized Multi-Protocol Label Switching (GMPLS)"</span>, <span class="seriesInfo">RFC 4202</span>, <span class="seriesInfo">DOI 10.17487/RFC4202</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4202">https://www.rfc-editor.org/info/rfc4202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Katz, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5130">[RFC5130]</dt>
        <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Shand, M., Ed.</span>, and <span class="refAuthor">C. Martin</span>, <span class="refTitle">"A Policy Control Mechanism in IS-IS Using Administrative Tags"</span>, <span class="seriesInfo">RFC 5130</span>, <span class="seriesInfo">DOI 10.17487/RFC5130</span>, <time datetime="2008-02" class="refDate">February 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5130">https://www.rfc-editor.org/info/rfc5130</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5305">[RFC5305]</dt>
        <dd>
<span class="refAuthor">Li, T.</span> and <span class="refAuthor">H. Smit</span>, <span class="refTitle">"IS-IS Extensions for Traffic Engineering"</span>, <span class="seriesInfo">RFC 5305</span>, <span class="seriesInfo">DOI 10.17487/RFC5305</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5305">https://www.rfc-editor.org/info/rfc5305</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5880">[RFC5880]</dt>
        <dd>
<span class="refAuthor">Katz, D.</span> and <span class="refAuthor">D. Ward</span>, <span class="refTitle">"Bidirectional Forwarding Detection (BFD)"</span>, <span class="seriesInfo">RFC 5880</span>, <span class="seriesInfo">DOI 10.17487/RFC5880</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5880">https://www.rfc-editor.org/info/rfc5880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6119">[RFC6119]</dt>
        <dd>
<span class="refAuthor">Harrison, J.</span>, <span class="refAuthor">Berger, J.</span>, and <span class="refAuthor">M. Bartlett</span>, <span class="refTitle">"IPv6 Traffic Engineering in IS-IS"</span>, <span class="seriesInfo">RFC 6119</span>, <span class="seriesInfo">DOI 10.17487/RFC6119</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6119">https://www.rfc-editor.org/info/rfc6119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6793">[RFC6793]</dt>
        <dd>
<span class="refAuthor">Vohra, Q.</span> and <span class="refAuthor">E. Chen</span>, <span class="refTitle">"BGP Support for Four-Octet Autonomous System (AS) Number Space"</span>, <span class="seriesInfo">RFC 6793</span>, <span class="seriesInfo">DOI 10.17487/RFC6793</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6793">https://www.rfc-editor.org/info/rfc6793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8405">[RFC8405]</dt>
        <dd>
<span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, <span class="refAuthor">Gredler, H.</span>, <span class="refAuthor">Lindem, A.</span>, <span class="refAuthor">Francois, P.</span>, and <span class="refAuthor">C. Bowers</span>, <span class="refTitle">"Shortest Path First (SPF) Back-Off Delay Algorithm for Link-State IGPs"</span>, <span class="seriesInfo">RFC 8405</span>, <span class="seriesInfo">DOI 10.17487/RFC8405</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8405">https://www.rfc-editor.org/info/rfc8405</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8654">[RFC8654]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">D. Ward</span>, <span class="refTitle">"Extended Message Support for BGP"</span>, <span class="seriesInfo">RFC 8654</span>, <span class="seriesInfo">DOI 10.17487/RFC8654</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8654">https://www.rfc-editor.org/info/rfc8654</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9086">[RFC9086]</dt>
        <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Ray, S.</span>, and <span class="refAuthor">J. Dong</span>, <span class="refTitle">"Border Gateway Protocol - Link State (BGP-LS) Extensions for Segment Routing BGP Egress Peer Engineering"</span>, <span class="seriesInfo">RFC 9086</span>, <span class="seriesInfo">DOI 10.17487/RFC9086</span>, <time datetime="2021-08" class="refDate">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9086">https://www.rfc-editor.org/info/rfc9086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9552">[RFC9552]</dt>
      <dd>
<span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refTitle">"Distribution of Link-State and Traffic Engineering Information Using BGP"</span>, <span class="seriesInfo">RFC 9552</span>, <span class="seriesInfo">DOI 10.17487/RFC9552</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9552">https://www.rfc-editor.org/info/rfc9552</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4272">[RFC4272]</dt>
        <dd>
<span class="refAuthor">Murphy, S.</span>, <span class="refTitle">"BGP Security Vulnerabilities Analysis"</span>, <span class="seriesInfo">RFC 4272</span>, <span class="seriesInfo">DOI 10.17487/RFC4272</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4272">https://www.rfc-editor.org/info/rfc4272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4456">[RFC4456]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">R. Chandra</span>, <span class="refTitle">"BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)"</span>, <span class="seriesInfo">RFC 4456</span>, <span class="seriesInfo">DOI 10.17487/RFC4456</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4456">https://www.rfc-editor.org/info/rfc4456</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4593">[RFC4593]</dt>
        <dd>
<span class="refAuthor">Barbir, A.</span>, <span class="refAuthor">Murphy, S.</span>, and <span class="refAuthor">Y. Yang</span>, <span class="refTitle">"Generic Threats to Routing Protocols"</span>, <span class="seriesInfo">RFC 4593</span>, <span class="seriesInfo">DOI 10.17487/RFC4593</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4593">https://www.rfc-editor.org/info/rfc4593</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4724">[RFC4724]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Chen, E.</span>, <span class="refAuthor">Fernando, R.</span>, <span class="refAuthor">Scudder, J.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Graceful Restart Mechanism for BGP"</span>, <span class="seriesInfo">RFC 4724</span>, <span class="seriesInfo">DOI 10.17487/RFC4724</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4724">https://www.rfc-editor.org/info/rfc4724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5286">[RFC5286]</dt>
        <dd>
<span class="refAuthor">Atlas, A., Ed.</span> and <span class="refAuthor">A. Zinin, Ed.</span>, <span class="refTitle">"Basic Specification for IP Fast Reroute: Loop-Free Alternates"</span>, <span class="seriesInfo">RFC 5286</span>, <span class="seriesInfo">DOI 10.17487/RFC5286</span>, <time datetime="2008-09" class="refDate">September 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5286">https://www.rfc-editor.org/info/rfc5286</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6952">[RFC6952]</dt>
        <dd>
<span class="refAuthor">Jethanandani, M.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">L. Zheng</span>, <span class="refTitle">"Analysis of BGP, LDP, PCEP, and MSDP Issues According to the Keying and Authentication for Routing Protocols (KARP) Design Guide"</span>, <span class="seriesInfo">RFC 6952</span>, <span class="seriesInfo">DOI 10.17487/RFC6952</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6952">https://www.rfc-editor.org/info/rfc6952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7911">[RFC7911]</dt>
        <dd>
<span class="refAuthor">Walton, D.</span>, <span class="refAuthor">Retana, A.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Advertisement of Multiple Paths in BGP"</span>, <span class="seriesInfo">RFC 7911</span>, <span class="seriesInfo">DOI 10.17487/RFC7911</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7911">https://www.rfc-editor.org/info/rfc7911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7938">[RFC7938]</dt>
        <dd>
<span class="refAuthor">Lapukhov, P.</span>, <span class="refAuthor">Premji, A.</span>, and <span class="refAuthor">J. Mitchell, Ed.</span>, <span class="refTitle">"Use of BGP for Routing in Large-Scale Data Centers"</span>, <span class="seriesInfo">RFC 7938</span>, <span class="seriesInfo">DOI 10.17487/RFC7938</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7938">https://www.rfc-editor.org/info/rfc7938</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9816">[RFC9816]</dt>
      <dd>
<span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Lindem, A.</span>, <span class="refAuthor">Zandi, S.</span>, <span class="refAuthor">Dawra, G.</span>, and <span class="refAuthor">J. Dong</span>, <span class="refTitle">"Usage and Applicability of BGP Link State (BGP-LS) Shortest Path First (SPF) Routing in Data Centers"</span>, <span class="seriesInfo">RFC 9816</span>, <span class="seriesInfo">DOI 10.17487/RFC9816</span>, <time datetime="2025-07" class="refDate">July 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9816">https://www.rfc-editor.org/info/rfc9816</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank <span class="contact-name">Sue Hares</span>,
  <span class="contact-name">Jorge Rabadan</span>, <span class="contact-name">Boris Hassanov</span>,
  <span class="contact-name">Dan Frost</span>, <span class="contact-name">Matt Anderson</span>,
  <span class="contact-name">Fred Baker</span>, <span class="contact-name">Lukas Krattiger</span>,
  <span class="contact-name">Yingzhen Qu</span>, and <span class="contact-name">Haibo Wang</span> for
  their reviews and comments. Thanks to <span class="contact-name">Pushpasis Sarkar</span>
  for discussions on preventing a BGP SPF router from being used for non-local
  traffic (i.e., transit traffic).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The authors extend a special thanks to <span class="contact-name">Eric Rosen</span> for
  fruitful discussions on BGP-LS-SPF convergence as compared to IGPs.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">The authors would also like to thank the following people:<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">
          <p id="appendix-A-4.1.1"><span class="contact-name">Alvaro Retana</span> for multiple AD
  reviews and discussions.<a href="#appendix-A-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.2">
          <p id="appendix-A-4.2.1"><span class="contact-name">Ketan Talaulikar</span> for an
  extensive shepherd review.<a href="#appendix-A-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.3">
          <p id="appendix-A-4.3.1"><span class="contact-name">Adrian Farrel</span>,
  <span class="contact-name">Li Zhang</span>, and <span class="contact-name">Jie Dong</span> for WG
  Last Call review comments.<a href="#appendix-A-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.4">
          <p id="appendix-A-4.4.1"><span class="contact-name">Jim Guichard</span> for his AD review and
  discussion.<a href="#appendix-A-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.5">
          <p id="appendix-A-4.5.1"><span class="contact-name">David Dong</span> for his IANA review.<a href="#appendix-A-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.6">
          <p id="appendix-A-4.6.1"><span class="contact-name">Joel Halpern</span> for his GENART review.<a href="#appendix-A-4.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.7">
          <p id="appendix-A-4.7.1"><span class="contact-name">Erik Kline</span>,
  <span class="contact-name">Eric Vyncke</span>, <span class="contact-name">Mahesh   Jethanandani</span>, and <span class="contact-name">Roman Danyliw</span> for IESG review
  comments.<a href="#appendix-A-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.8">
          <p id="appendix-A-4.8.1"><span class="contact-name">John Scudder</span> for his detailed IESG
  review and specifically for helping align the document with BGP documents.<a href="#appendix-A-4.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="Contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="appendix-B-1">The following people contributed substantially to the content of this document and should be considered
coauthors:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Derek Yeung</span></div>
<div dir="auto" class="left"><span class="org">Arrcus, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:derek@arrcus.com" class="email">derek@arrcus.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gunter Van de Velde</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gunter.van_de_velde@nokia.com" class="email">gunter.van_de_velde@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Abhay Roy</span></div>
<div dir="auto" class="left"><span class="org">Arrcus, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:abhay@arrcus.com" class="email">abhay@arrcus.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Venu Venugopal</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:venuv@cisco.com" class="email">venuv@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chaitanya Yadlapalli</span></div>
<div dir="auto" class="left"><span class="org">AT&amp;T</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cy098d@att.com" class="email">cy098d@att.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Keyur Patel</span></div>
<div dir="auto" class="left"><span class="org">Arrcus, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:keyur@arrcus.com" class="email">keyur@arrcus.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Acee Lindem</span></div>
<div dir="auto" class="left"><span class="org">Arrcus, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">301 Midenhall Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cary</span>, <span class="region">NC</span> <span class="postal-code">27513</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:acee.ietf@gmail.com" class="email">acee.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shawn Zandi</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shafagh@shafagh.com" class="email">shafagh@shafagh.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Wim Henderickx</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left"><span class="street-address">copernicuslaan 50</span></div>
<div dir="auto" class="left">
<span class="postal-code">2018</span> <span class="locality">Antwerp</span>
</div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wim.henderickx@nokia.com" class="email">wim.henderickx@nokia.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
