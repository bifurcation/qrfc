<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9678: Forward Secrecy Extension to the Improved Extensible Authentication Protocol Method for Authentication and Key Agreement (EAP-AKA' FS)</title>
<meta content="Jari Arkko" name="author">
<meta content="Karl Norrman" name="author">
<meta content="John PreuÃŸ Mattsson" name="author">
<meta content="
       This document updates RFC 9048, &quot;Improved Extensible Authentication
      Protocol Method for 3GPP Mobile Network Authentication and Key Agreement
      (EAP-AKA')&quot;, and its predecessor RFC 5448 with an optional extension
      providing ephemeral key exchange. The extension EAP-AKA' Forward Secrecy
      (EAP-AKA' FS), when negotiated, provides forward secrecy for the session
      keys generated as a part of the authentication run in EAP-AKA'. This
      prevents an attacker who has gained access to the long-term key from
      obtaining session keys established in the past. In addition, EAP-AKA' FS mitigates passive attacks
      (e.g., large-scale pervasive monitoring) against future sessions. This
      forces attackers to use active attacks instead. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="EAP" name="keyword">
<meta content="AKA" name="keyword">
<meta content="AKA'" name="keyword">
<meta content="EAP-AKA'" name="keyword">
<meta content="EAP-AKA' FS" name="keyword">
<meta content="3GPP" name="keyword">
<meta content="9678" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 64.1
-->
<link href="rfc9678.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-emu-aka-pfs-12" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9678" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9678</td>
<td class="center">EAP-AKA' FS</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Arkko, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9678" class="eref">9678</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5448" class="eref">5448</a>, <a href="https://www.rfc-editor.org/rfc/rfc9048" class="eref">9048</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03" class="published">March 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Arkko</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">K. Norrman</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. PreuÃŸ Mattsson</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9678</h1>
<h1 id="title">Forward Secrecy Extension to the Improved Extensible Authentication Protocol Method for Authentication and Key Agreement (EAP-AKA' FS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates RFC 9048, "Improved Extensible Authentication
      Protocol Method for 3GPP Mobile Network Authentication and Key Agreement
      (EAP-AKA')", and its predecessor RFC 5448 with an optional extension
      providing ephemeral key exchange. The extension EAP-AKA' Forward Secrecy
      (EAP-AKA' FS), when negotiated, provides forward secrecy for the session
      keys generated as a part of the authentication run in EAP-AKA'. This
      prevents an attacker who has gained access to the long-term key from
      obtaining session keys established in the past. In addition, EAP-AKA' FS mitigates passive attacks
      (e.g., large-scale pervasive monitoring) against future sessions. This
      forces attackers to use active attacks instead.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9678">https://www.rfc-editor.org/info/rfc9678</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â–²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.Â Â <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.Â Â <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.Â Â <a href="#name-protocol-design-and-deploym" class="internal xref">Protocol Design and Deployment Objectives</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.Â Â <a href="#name-background" class="internal xref">Background</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.Â Â <a href="#name-aka" class="internal xref">AKA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.Â Â <a href="#name-eap-aka-protocol" class="internal xref">EAP-AKA' Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.Â Â <a href="#name-attacks-against-long-term-k" class="internal xref">Attacks Against Long-Term Keys in Smart Cards</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.Â Â <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.Â Â <a href="#name-extensions-to-eap-aka" class="internal xref">Extensions to EAP-AKA'</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.Â Â <a href="#name-at_pub_ecdhe" class="internal xref">AT_PUB_ECDHE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.Â Â <a href="#name-at_kdf_fs" class="internal xref">AT_KDF_FS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.Â Â <a href="#name-forward-secrecy-key-derivat" class="internal xref">Forward Secrecy Key Derivation Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.Â Â <a href="#name-ecdhe-groups" class="internal xref">ECDHE Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.Â Â <a href="#name-message-processing" class="internal xref">Message Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="auto internal xref">6.5.1</a>.Â Â <a href="#name-eap-request-aka-identity" class="internal xref">EAP-Request/AKA'-Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="auto internal xref">6.5.2</a>.Â Â <a href="#name-eap-response-aka-identity" class="internal xref">EAP-Response/AKA'-Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="auto internal xref">6.5.3</a>.Â Â <a href="#name-eap-request-aka-challenge" class="internal xref">EAP-Request/AKA'-Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.4">
                    <p id="section-toc.1-1.6.2.5.2.4.1"><a href="#section-6.5.4" class="auto internal xref">6.5.4</a>.Â Â <a href="#name-eap-response-aka-challenge" class="internal xref">EAP-Response/AKA'-Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.5">
                    <p id="section-toc.1-1.6.2.5.2.5.1"><a href="#section-6.5.5" class="auto internal xref">6.5.5</a>.Â Â <a href="#name-eap-request-aka-reauthentic" class="internal xref">EAP-Request/AKA'-Reauthentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.6">
                    <p id="section-toc.1-1.6.2.5.2.6.1"><a href="#section-6.5.6" class="auto internal xref">6.5.6</a>.Â Â <a href="#name-eap-response-aka-reauthenti" class="internal xref">EAP-Response/AKA'-Reauthentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.7">
                    <p id="section-toc.1-1.6.2.5.2.7.1"><a href="#section-6.5.7" class="auto internal xref">6.5.7</a>.Â Â <a href="#name-eap-response-aka-synchroniz" class="internal xref">EAP-Response/AKA'-Synchronization-Failure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.8">
                    <p id="section-toc.1-1.6.2.5.2.8.1"><a href="#section-6.5.8" class="auto internal xref">6.5.8</a>.Â Â <a href="#name-eap-response-aka-authentica" class="internal xref">EAP-Response/AKA'-Authentication-Reject</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.9">
                    <p id="section-toc.1-1.6.2.5.2.9.1"><a href="#section-6.5.9" class="auto internal xref">6.5.9</a>.Â Â <a href="#name-eap-response-aka-client-err" class="internal xref">EAP-Response/AKA'-Client-Error</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.10">
                    <p id="section-toc.1-1.6.2.5.2.10.1"><a href="#section-6.5.10" class="auto internal xref">6.5.10</a>.Â <a href="#name-eap-request-aka-notificatio" class="internal xref">EAP-Request/AKA'-Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.11">
                    <p id="section-toc.1-1.6.2.5.2.11.1"><a href="#section-6.5.11" class="auto internal xref">6.5.11</a>.Â <a href="#name-eap-response-aka-notificati" class="internal xref">EAP-Response/AKA'-Notification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.Â Â <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.Â Â <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.Â Â <a href="#name-security-properties" class="internal xref">Security Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.Â Â <a href="#name-denial-of-service" class="internal xref">Denial of Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.Â Â <a href="#name-identity-privacy" class="internal xref">Identity Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.Â Â <a href="#name-unprotected-data-and-privac" class="internal xref">Unprotected Data and Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.Â Â <a href="#name-forward-secrecy-within-at_e" class="internal xref">Forward Secrecy within AT_ENCR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.Â Â <a href="#name-post-quantum-considerations" class="internal xref">Post-Quantum Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.Â Â <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.Â Â <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.Â Â <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.Â Â <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec_intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Many different attacks have been reported as part of the revelations
      associated with pervasive surveillance. Some of the reported attacks
      involved compromising the Universal Subscriber Identity Module (USIM)
      card supply chain. Attacks revealing the AKA long-term key may occur,
      for instance:<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">during the manufacturing process of USIM cards,<a href="#section-1-2.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-1-2.2">during the transfer of the cards and associated information to
 the operator, and<a href="#section-1-2.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-1-2.3">when the system is running.<a href="#section-1-2.3" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-1-3">Since the publication of reports about such attacks (see <span>[<a href="#Heist2015" class="cite xref">Heist2015</a>]</span>), manufacturing and provisioning
      processes have gained much scrutiny and have improved.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">However, the danger of resourceful attackers attempting to gain
      information about long-term keys is still a concern because these keys
      are high-value targets.  Note that the attacks are largely independent
      of the used authentication technology; the issue is not vulnerabilities
      in algorithms or protocols, but rather the possibility of someone
      gaining unauthorized access to key material. Furthermore, an explicit
      goal of the IETF is to ensure that we understand the surveillance
      concerns related to IETF protocols and take appropriate countermeasures
      <span>[<a href="#RFC7258" class="cite xref">RFC7258</a>]</span>.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">While strong protection of manufacturing and other processes is
  essential in mitigating surveillance and other risks associated with
  AKA long-term keys, there are also protocol mechanisms that can
  help.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">This document updates <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>,
      "Improved Extensible Authentication Protocol Method for 3GPP Mobile
      Network Authentication and Key Agreement (EAP-AKA')", with an optional
      extension providing ephemeral key exchange, which minimizes the impact of
      long-term key compromise and strengthens the identity privacy
      requirements.  This is important, given the large number of users of AKA
      in mobile networks.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
<p id="section-1-7">The extension, when
  negotiated, provides Forward Secrecy (FS) <span>[<a href="#DOW1992" class="cite xref">DOW1992</a>]</span> for the session key
  generated as a part of the authentication run in EAP-AKA'.  This
  prevents an attacker who has gained access to the long-term
  key in a USIM card from getting access to past session
  keys. In addition to FS, the included Diffie-Hellman exchange forces
  attackers to be active if they want access to future session keys, even
  if they have access to the long-term key. This is beneficial because
  active attacks demand many more resources to launch and are easier to
  detect. As
  with other protocols, an active attacker with access to the
  long-term key material will, of course, be able to attack all future
  communications, but risks detection, particularly if done at
  scale.<a href="#section-1-7" class="pilcrow">Â¶</a></p>
<p id="section-1-8">It should also be noted that 5G network architecture <span>[<a href="#TS.33.501" class="cite xref">TS.33.501</a>]</span>
  includes the
  use of the EAP framework for authentication. While any methods can
  be run, the default authentication method within that context will
  be EAP-AKA'. As a result, improvements in EAP-AKA' security have the
  potential to improve security for many users.<a href="#section-1-8" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCPÂ 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-protocol-design-and-deploym">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-design-and-deploym" class="section-name selfRef">Protocol Design and Deployment Objectives</a>
      </h2>
<p id="section-3-1">The extension specified here reuses large portions of the
  current structure of 3GPP interfaces and functions, with the
  rationale that this will make the construction more easily adopted.
  In particular, the construction keeps the interface between the
  USIM and the mobile
  terminal intact. As a consequence, there is no need to roll out new
  credentials to existing subscribers. The work is based on an earlier
  paper (see <span>[<a href="#TrustCom2015" class="cite xref">TrustCom2015</a>]</span>) and uses much of the same
  material but is applied to EAP rather than the underlying AKA
  method.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">It has been a goal to implement this change as an extension
  of the widely supported EAP-AKA' method, rather than implement a completely new
  authentication method. The extension is implemented as a set of
  new, optional attributes that are provided alongside the
  base attributes in EAP-AKA'. Old implementations can ignore
  these attributes, but their presence will nevertheless be verified
  as part of the base EAP-AKA' integrity verification process, helping
  protect against bidding down attacks. This extension does
  not increase the number of rounds necessary to complete the
  protocol.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<p id="section-3-3">The use of this extension is at the discretion of the
  authenticating parties. It should be noted that FS and defenses
  against passive attacks do not solve all problems, but they can
  provide a partial defense that increases the cost and risk
  associated with pervasive surveillance.<a href="#section-3-3" class="pilcrow">Â¶</a></p>
<p id="section-3-4">While adding FS to the existing mobile
  network infrastructure can be done in multiple different ways, this
  document specifies a solution that is relatively easy to deploy. In particular:<a href="#section-3-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">As noted above, no new credentials are needed; there is no change
        to USIM cards.<a href="#section-3-5.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-3-5.2">FS property can be incorporated into any current or future system
        that supports EAP, without changing any network functions beyond the
        EAP endpoints.<a href="#section-3-5.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-3-5.3">Key generation happens at the endpoints, enabling the highest grade
        key material to be used both by the endpoints and the intermediate
        systems (such as access points that are given access to specific
        keys).<a href="#section-3-5.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-3-5.4">While EAP-AKA' is just one EAP method, for practical purposes,
        FS being available for both EAP-TLS <span>[<a href="#RFC5216" class="cite xref">RFC5216</a>]</span> <span>[<a href="#RFC9190" class="cite xref">RFC9190</a>]</span> and EAP-AKA' ensures that, for many practical
        systems, FS can be enabled for either all or a significant
        fraction of users.<a href="#section-3-5.4" class="pilcrow">Â¶</a>
</li>
      </ul>
</section>
<section id="section-4">
      <h2 id="name-background">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-4-1">The reader is assumed to
    have a basic understanding of the EAP framework <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<section id="section-4.1">
        <h3 id="name-aka">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-aka" class="section-name selfRef">AKA</a>
        </h3>
<p id="section-4.1-1">We use the term "Authentication and Key Agreement" (or "AKA") for the
    main authentication and key agreement protocol used by 3GPP mobile
    networks from the third generation (3G) and onward. Later
    generations add new features to AKA, but the core remains the
    same.  It is based on challenge-response mechanisms and symmetric
    cryptography.  In contrast to its earlier GSM counterparts, AKA
    provides long key lengths and mutual authentication.  The phone
    typically executes AKA in a USIM. A USIM is technically just an
    application that can reside on a removable Universal
    Integrated Circuit Card (UICC), an embedded UICC, or integrated in a
    Trusted Execution Environment (TEE). In this document, we use the
    term "USIM card" to refer to any Subscriber Identity Module (SIM)
    capable of running AKA.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.1-2">The goals of AKA are to mutually authenticate the USIM and the
        so-called home environment, which is the authentication Server in the
        subscriber's home operator's network, and to establish key material
        between the two.<a href="#section-4.1-2" class="pilcrow">Â¶</a></p>
<p id="section-4.1-3">AKA works in the following manner:<a href="#section-4.1-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">The USIM and the home environment have agreed on a long-term
          symmetric key beforehand.<a href="#section-4.1-4.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-4.2">The actual authentication process starts by having the home
          environment produce an authentication vector, based on the long-term
          key and a sequence number. The authentication vector contains a
          random part RAND, an authenticator part AUTN used for authenticating
          the network to the USIM, an expected result part XRES, a 128-bit
          session key for the integrity check IK, and a 128-bit session key for the
          encryption CK.<a href="#section-4.1-4.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-4.3">The authentication vector is passed to the serving network,
          which uses it to authenticate the device.<a href="#section-4.1-4.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-4.4">The RAND and the AUTN are delivered to the USIM.<a href="#section-4.1-4.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-4.5">The USIM verifies the AUTN, again based on the long-term key and
          the sequence number.  If this process is successful (the AUTN is
          valid and the sequence number used to generate the AUTN is within the
          correct range), the USIM produces an authentication result RES and
          sends it to the serving network.<a href="#section-4.1-4.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.1-4.6">The serving network verifies that the result from the USIM
          matches the expected value in the authentication vector.  If it
          does, the USIM is considered authenticated, and the IK and CK can be
          used to protect further communications between the USIM and the home
          environment.<a href="#section-4.1-4.6" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
<section id="section-4.2">
        <h3 id="name-eap-aka-protocol">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-eap-aka-protocol" class="section-name selfRef">EAP-AKA' Protocol</a>
        </h3>
<p id="section-4.2-1">When AKA is embedded into EAP, the authentication processing on
    the network side is moved to the home environment. The 3GPP Authentication
    Database (AD) generates authentication vectors. The 3GPP authentication
    Server takes the role of EAP Server. The USIM combined with
    the mobile phone takes the role of client.
    The difference between EAP-AKA <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span> and
    EAP-AKA' <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> is that EAP-AKA' 
    binds the derived keys to the name of the access network.
    <a href="#figaka" class="auto internal xref">Figure 1</a> describes the basic flow in the EAP-AKA'
    authentication process. The definition of the full protocol
    behavior, along with the definition of the attributes AT_RAND,
    AT_AUTN, AT_MAC, and AT_RES can be found in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> and <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>.
    Note the use of EAP terminology from hereon.  That is, the 3GPP
    serving network takes on the role of an EAP access network.<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
<span id="name-eap-aka-authentication-proc"></span><div id="figaka">
<figure id="figure-1">
          <div id="section-4.2-2.1">
            <div class="alignCenter art-svg artwork" id="section-4.2-2.1.2">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="750" width="500" viewBox="0 0 600 800" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,400 L 8,608" fill="none" stroke="black"></path>
                <path d="M 32,48 L 32,400" fill="none" stroke="black"></path>
                <path d="M 32,608 L 32,816" fill="none" stroke="black"></path>
                <path d="M 72,160 L 72,320" fill="none" stroke="black"></path>
                <path d="M 88,688 L 88,752" fill="none" stroke="black"></path>
                <path d="M 472,400 L 472,608" fill="none" stroke="black"></path>
                <path d="M 520,48 L 520,160" fill="none" stroke="black"></path>
                <path d="M 520,320 L 520,688" fill="none" stroke="black"></path>
                <path d="M 520,752 L 520,816" fill="none" stroke="black"></path>
                <path d="M 544,160 L 544,320" fill="none" stroke="black"></path>
                <path d="M 544,688 L 544,752" fill="none" stroke="black"></path>
                <path d="M 40,80 L 520,80" fill="none" stroke="black"></path>
                <path d="M 32,144 L 512,144" fill="none" stroke="black"></path>
                <path d="M 72,160 L 544,160" fill="none" stroke="black"></path>
                <path d="M 72,320 L 544,320" fill="none" stroke="black"></path>
                <path d="M 40,384 L 520,384" fill="none" stroke="black"></path>
                <path d="M 8,400 L 472,400" fill="none" stroke="black"></path>
                <path d="M 8,608 L 472,608" fill="none" stroke="black"></path>
                <path d="M 32,672 L 512,672" fill="none" stroke="black"></path>
                <path d="M 88,688 L 544,688" fill="none" stroke="black"></path>
                <path d="M 88,752 L 544,752" fill="none" stroke="black"></path>
                <path d="M 40,800 L 520,800" fill="none" stroke="black"></path>
                <path d="M 144,640 L 144,640" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="520,672 508,666.4 508,677.6" fill="black" transform="rotate(0,512,672)"></polygon>
                <polygon class="arrowhead" points="520,144 508,138.4 508,149.6" fill="black" transform="rotate(0,512,144)"></polygon>
                <polygon class="arrowhead" points="48,800 36,794.4 36,805.6" fill="black" transform="rotate(180,40,800)"></polygon>
                <polygon class="arrowhead" points="48,384 36,378.4 36,389.6" fill="black" transform="rotate(180,40,384)"></polygon>
                <polygon class="arrowhead" points="48,80 36,74.4 36,85.6" fill="black" transform="rotate(180,40,80)"></polygon>
                <g class="text">
                  <text x="28" y="36">Peer</text>
                  <text x="516" y="36">Server</text>
                  <text x="428" y="68">EAP-Request/Identity</text>
                  <text x="128" y="116">EAP-Response/Identity</text>
                  <text x="80" y="132">(Includes</text>
                  <text x="148" y="132">user's</text>
                  <text x="208" y="132">Network</text>
                  <text x="268" y="132">Access</text>
                  <text x="340" y="132">Identifier</text>
                  <text x="412" y="132">(NAI))</text>
                  <text x="96" y="180">The</text>
                  <text x="140" y="180">Server</text>
                  <text x="212" y="180">determines</text>
                  <text x="272" y="180">the</text>
                  <text x="320" y="180">network</text>
                  <text x="372" y="180">name</text>
                  <text x="408" y="180">and</text>
                  <text x="456" y="180">ensures</text>
                  <text x="508" y="180">that</text>
                  <text x="96" y="196">the</text>
                  <text x="136" y="196">given</text>
                  <text x="188" y="196">access</text>
                  <text x="248" y="196">network</text>
                  <text x="292" y="196">is</text>
                  <text x="348" y="196">authorized</text>
                  <text x="404" y="196">to</text>
                  <text x="432" y="196">use</text>
                  <text x="464" y="196">the</text>
                  <text x="112" y="212">claimed</text>
                  <text x="168" y="212">name.</text>
                  <text x="216" y="212">The</text>
                  <text x="260" y="212">Server</text>
                  <text x="308" y="212">then</text>
                  <text x="348" y="212">runs</text>
                  <text x="384" y="212">the</text>
                  <text x="436" y="212">EAP-AKA'</text>
                  <text x="124" y="228">algorithms</text>
                  <text x="212" y="228">generating</text>
                  <text x="276" y="228">RAND</text>
                  <text x="312" y="228">and</text>
                  <text x="352" y="228">AUTN,</text>
                  <text x="392" y="228">and</text>
                  <text x="440" y="228">derives</text>
                  <text x="504" y="228">session</text>
                  <text x="100" y="244">keys</text>
                  <text x="140" y="244">from</text>
                  <text x="176" y="244">CK'</text>
                  <text x="208" y="244">and</text>
                  <text x="244" y="244">IK'.</text>
                  <text x="292" y="244">RAND</text>
                  <text x="328" y="244">and</text>
                  <text x="364" y="244">AUTN</text>
                  <text x="400" y="244">are</text>
                  <text x="436" y="244">sent</text>
                  <text x="468" y="244">as</text>
                  <text x="112" y="260">AT_RAND</text>
                  <text x="160" y="260">and</text>
                  <text x="208" y="260">AT_AUTN</text>
                  <text x="288" y="260">attributes,</text>
                  <text x="368" y="260">whereas</text>
                  <text x="416" y="260">the</text>
                  <text x="464" y="260">network</text>
                  <text x="516" y="260">name</text>
                  <text x="92" y="276">is</text>
                  <text x="152" y="276">transported</text>
                  <text x="212" y="276">in</text>
                  <text x="240" y="276">the</text>
                  <text x="308" y="276">AT_KDF_INPUT</text>
                  <text x="404" y="276">attribute.</text>
                  <text x="484" y="276">AT_KDF</text>
                  <text x="112" y="292">signals</text>
                  <text x="160" y="292">the</text>
                  <text x="196" y="292">used</text>
                  <text x="232" y="292">key</text>
                  <text x="292" y="292">derivation</text>
                  <text x="376" y="292">function.</text>
                  <text x="440" y="292">The</text>
                  <text x="488" y="292">session</text>
                  <text x="100" y="308">keys</text>
                  <text x="136" y="308">are</text>
                  <text x="172" y="308">used</text>
                  <text x="204" y="308">to</text>
                  <text x="244" y="308">create</text>
                  <text x="288" y="308">the</text>
                  <text x="332" y="308">AT_MAC</text>
                  <text x="404" y="308">attribute.</text>
                  <text x="404" y="356">EAP-Request/AKA'-Challenge</text>
                  <text x="160" y="372">(AT_RAND,</text>
                  <text x="236" y="372">AT_AUTN,</text>
                  <text x="304" y="372">AT_KDF,</text>
                  <text x="392" y="372">AT_KDF_INPUT,</text>
                  <text x="480" y="372">AT_MAC)</text>
                  <text x="32" y="420">The</text>
                  <text x="68" y="420">Peer</text>
                  <text x="132" y="420">determines</text>
                  <text x="196" y="420">what</text>
                  <text x="232" y="420">the</text>
                  <text x="280" y="420">network</text>
                  <text x="332" y="420">name</text>
                  <text x="380" y="420">should</text>
                  <text x="424" y="420">be,</text>
                  <text x="40" y="436">based</text>
                  <text x="80" y="436">on,</text>
                  <text x="120" y="436">e.g.,</text>
                  <text x="164" y="436">what</text>
                  <text x="212" y="436">access</text>
                  <text x="284" y="436">technology</text>
                  <text x="340" y="436">it</text>
                  <text x="364" y="436">is</text>
                  <text x="404" y="436">using.</text>
                  <text x="32" y="452">The</text>
                  <text x="68" y="452">Peer</text>
                  <text x="108" y="452">also</text>
                  <text x="168" y="452">retrieves</text>
                  <text x="224" y="452">the</text>
                  <text x="272" y="452">network</text>
                  <text x="324" y="452">name</text>
                  <text x="364" y="452">sent</text>
                  <text x="396" y="452">by</text>
                  <text x="424" y="452">the</text>
                  <text x="48" y="468">network</text>
                  <text x="100" y="468">from</text>
                  <text x="136" y="468">the</text>
                  <text x="204" y="468">AT_KDF_INPUT</text>
                  <text x="300" y="468">attribute.</text>
                  <text x="368" y="468">The</text>
                  <text x="400" y="468">two</text>
                  <text x="440" y="468">names</text>
                  <text x="32" y="484">are</text>
                  <text x="84" y="484">compared</text>
                  <text x="136" y="484">for</text>
                  <text x="212" y="484">discrepancies,</text>
                  <text x="288" y="484">and</text>
                  <text x="316" y="484">if</text>
                  <text x="348" y="484">they</text>
                  <text x="380" y="484">do</text>
                  <text x="408" y="484">not</text>
                  <text x="44" y="500">match,</text>
                  <text x="88" y="500">the</text>
                  <text x="164" y="500">authentication</text>
                  <text x="236" y="500">is</text>
                  <text x="284" y="500">aborted.</text>
                  <text x="372" y="500">Otherwise,</text>
                  <text x="432" y="500">the</text>
                  <text x="48" y="516">network</text>
                  <text x="100" y="516">name</text>
                  <text x="140" y="516">from</text>
                  <text x="176" y="516">the</text>
                  <text x="244" y="516">AT_KDF_INPUT</text>
                  <text x="336" y="516">attribute</text>
                  <text x="388" y="516">is</text>
                  <text x="420" y="516">used</text>
                  <text x="28" y="532">in</text>
                  <text x="72" y="532">running</text>
                  <text x="120" y="532">the</text>
                  <text x="172" y="532">EAP-AKA'</text>
                  <text x="256" y="532">algorithms,</text>
                  <text x="344" y="532">verifying</text>
                  <text x="404" y="532">AUTN</text>
                  <text x="444" y="532">from</text>
                  <text x="48" y="548">AT_AUTN</text>
                  <text x="96" y="548">and</text>
                  <text x="144" y="548">Message</text>
                  <text x="236" y="548">Authentication</text>
                  <text x="316" y="548">Code</text>
                  <text x="360" y="548">(MAC)</text>
                  <text x="404" y="548">from</text>
                  <text x="440" y="548">the</text>
                  <text x="44" y="564">AT_MAC</text>
                  <text x="120" y="564">attributes.</text>
                  <text x="192" y="564">The</text>
                  <text x="228" y="564">Peer</text>
                  <text x="268" y="564">then</text>
                  <text x="328" y="564">generates</text>
                  <text x="388" y="564">RES.</text>
                  <text x="432" y="564">The</text>
                  <text x="36" y="580">Peer</text>
                  <text x="76" y="580">also</text>
                  <text x="128" y="580">derives</text>
                  <text x="192" y="580">session</text>
                  <text x="244" y="580">keys</text>
                  <text x="284" y="580">from</text>
                  <text x="336" y="580">CK'/IK.</text>
                  <text x="392" y="580">The</text>
                  <text x="436" y="580">AT_RES</text>
                  <text x="32" y="596">and</text>
                  <text x="76" y="596">AT_MAC</text>
                  <text x="148" y="596">attributes</text>
                  <text x="208" y="596">are</text>
                  <text x="276" y="596">constructed.</text>
                  <text x="92" y="644">EAP-Response</text>
                  <text x="204" y="644">AKA'-Challenge</text>
                  <text x="76" y="660">(AT_RES,</text>
                  <text x="144" y="660">AT_MAC)</text>
                  <text x="112" y="708">The</text>
                  <text x="156" y="708">Server</text>
                  <text x="212" y="708">checks</text>
                  <text x="256" y="708">the</text>
                  <text x="288" y="708">RES</text>
                  <text x="320" y="708">and</text>
                  <text x="352" y="708">MAC</text>
                  <text x="396" y="708">values</text>
                  <text x="460" y="708">received</text>
                  <text x="508" y="708">in</text>
                  <text x="124" y="724">AT_RES</text>
                  <text x="168" y="724">and</text>
                  <text x="216" y="724">AT_MAC,</text>
                  <text x="304" y="724">respectively.</text>
                  <text x="400" y="724">Success</text>
                  <text x="468" y="724">requires</text>
                  <text x="116" y="740">both</text>
                  <text x="172" y="740">compared</text>
                  <text x="236" y="740">values</text>
                  <text x="292" y="740">match,</text>
                  <text x="376" y="740">respectively.</text>
                  <text x="464" y="788">EAP-Success</text>
                </g>
              </svg><a href="#section-4.2-2.1.2" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-eap-aka-authentication-proc" class="selfRef">EAP-AKA' Authentication Process</a>
          </figcaption></figure>
</div>
</section>
<div id="attacks">
<section id="section-4.3">
        <h3 id="name-attacks-against-long-term-k">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-attacks-against-long-term-k" class="section-name selfRef">Attacks Against Long-Term Keys in Smart Cards</a>
        </h3>
<p id="section-4.3-1">The general security properties and potential vulnerabilities of
        AKA and EAP-AKA' are discussed in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-4.3-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3-2">An important question in that discussion relates to the potential
        compromise of long-term keys, as discussed earlier.  Attacks on
        long-term keys are not specific to AKA or EAP-AKA', and all security
        systems fail, at least to some extent, if key material is
        stolen. However, it would be preferable to retain some security even
        in the face of such attacks.  This document specifies a mechanism that
        reduces the risks of compromising key material belonging to previous
        sessions, before the long-term keys were compromised.  It also forces
        attackers to be active even after the compromise.<a href="#section-4.3-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
<section id="section-5">
      <h2 id="name-protocol-overview">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-5-1">Forward Secrecy (FS) for EAP-AKA' is achieved by using an Elliptic
      Curve Diffie-Hellman (ECDH) exchange <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>. To provide FS, the exchange must be run in an
      ephemeral manner, i.e., both sides generate temporary keys according to
      the negotiated ciphersuite. For example, for X25519, this is done as
      specified in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.  This method is
      referred to as "ECDHE", where the last "E" stands for "Ephemeral". The
      two initially registered elliptic curves and their wire formats are
      chosen to align with the elliptic curves and formats specified for
      Subscription Concealed Identifier (SUCI) encryption in Appendix C.3.4 of
      3GPP <span>[<a href="#TS.33.501" class="cite xref">TS.33.501</a>]</span>.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">The enhancements in the EAP-AKA' FS protocol are compatible
  with the signaling flow and other basic structures of both AKA and
  EAP-AKA'. The intent is to implement the enhancement as optional
      attributes that legacy implementations ignore.<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<p id="section-5-3">The purpose of the protocol is to achieve mutual authentication
  between the EAP Server and Peer and to establish key material
  for secure communication between the two.  This document specifies
  the calculation of key material, providing new properties that are
  not present in key material provided by EAP-AKA' in its original
      form.<a href="#section-5-3" class="pilcrow">Â¶</a></p>
<p id="section-5-4"><a href="#figakafs" class="auto internal xref">Figure 2</a> describes the overall
      process. Since the goal has been to not require new infrastructure or
      credentials, the flow diagrams also show the conceptual interaction with
      the USIM card and the home environment. Recall that the home environment
      represents the 3GPP Authentication Database (AD) and Server.  The
      details of those interactions are outside the scope of this document;
      however, and the reader is referred to the 3GPP specifications (for 5G,
      this is specified in 3GPP <span>[<a href="#TS.33.501" class="cite xref">TS.33.501</a>]</span>).<a href="#section-5-4" class="pilcrow">Â¶</a></p>
<span id="name-eap-aka-fs-authentication-p"></span><div id="figakafs">
<figure id="figure-2">
        <div id="section-5-5.1">
          <div class="alignCenter art-svg artwork" id="section-5-5.1.2">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1200" width="900" viewBox="0 0 552 1408" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,688 L 8,816" fill="none" stroke="black"></path>
              <path d="M 8,928 L 8,1040" fill="none" stroke="black"></path>
              <path d="M 32,48 L 32,688" fill="none" stroke="black"></path>
              <path d="M 32,816 L 32,928" fill="none" stroke="black"></path>
              <path d="M 32,1040 L 32,1392" fill="none" stroke="black"></path>
              <path d="M 88,160 L 88,272" fill="none" stroke="black"></path>
              <path d="M 88,432 L 88,576" fill="none" stroke="black"></path>
              <path d="M 88,1136 L 88,1328" fill="none" stroke="black"></path>
              <path d="M 152,48 L 152,160" fill="none" stroke="black"></path>
              <path d="M 152,272 L 152,432" fill="none" stroke="black"></path>
              <path d="M 152,576 L 152,688" fill="none" stroke="black"></path>
              <path d="M 152,816 L 152,928" fill="none" stroke="black"></path>
              <path d="M 152,1040 L 152,1136" fill="none" stroke="black"></path>
              <path d="M 152,1328 L 152,1392" fill="none" stroke="black"></path>
              <path d="M 384,48 L 384,160" fill="none" stroke="black"></path>
              <path d="M 384,272 L 384,432" fill="none" stroke="black"></path>
              <path d="M 384,576 L 384,688" fill="none" stroke="black"></path>
              <path d="M 384,816 L 384,928" fill="none" stroke="black"></path>
              <path d="M 384,1040 L 384,1136" fill="none" stroke="black"></path>
              <path d="M 384,1328 L 384,1392" fill="none" stroke="black"></path>
              <path d="M 464,688 L 464,816" fill="none" stroke="black"></path>
              <path d="M 464,928 L 464,1040" fill="none" stroke="black"></path>
              <path d="M 520,48 L 520,160" fill="none" stroke="black"></path>
              <path d="M 520,272 L 520,432" fill="none" stroke="black"></path>
              <path d="M 520,576 L 520,1136" fill="none" stroke="black"></path>
              <path d="M 520,1328 L 520,1392" fill="none" stroke="black"></path>
              <path d="M 544,1136 L 544,1328" fill="none" stroke="black"></path>
              <path d="M 560,160 L 560,272" fill="none" stroke="black"></path>
              <path d="M 560,432 L 560,576" fill="none" stroke="black"></path>
              <path d="M 160,80 L 384,80" fill="none" stroke="black"></path>
              <path d="M 152,144 L 376,144" fill="none" stroke="black"></path>
              <path d="M 88,160 L 560,160" fill="none" stroke="black"></path>
              <path d="M 88,272 L 560,272" fill="none" stroke="black"></path>
              <path d="M 384,352 L 512,352" fill="none" stroke="black"></path>
              <path d="M 392,416 L 520,416" fill="none" stroke="black"></path>
              <path d="M 88,432 L 560,432" fill="none" stroke="black"></path>
              <path d="M 88,576 L 560,576" fill="none" stroke="black"></path>
              <path d="M 160,672 L 384,672" fill="none" stroke="black"></path>
              <path d="M 8,688 L 464,688" fill="none" stroke="black"></path>
              <path d="M 8,816 L 464,816" fill="none" stroke="black"></path>
              <path d="M 40,864 L 152,864" fill="none" stroke="black"></path>
              <path d="M 32,912 L 144,912" fill="none" stroke="black"></path>
              <path d="M 8,928 L 464,928" fill="none" stroke="black"></path>
              <path d="M 8,1040 L 464,1040" fill="none" stroke="black"></path>
              <path d="M 152,1120 L 376,1120" fill="none" stroke="black"></path>
              <path d="M 88,1136 L 544,1136" fill="none" stroke="black"></path>
              <path d="M 88,1328 L 544,1328" fill="none" stroke="black"></path>
              <path d="M 160,1376 L 384,1376" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="520,352 508,346.4 508,357.6" fill="black" transform="rotate(0,512,352)"></polygon>
              <polygon class="arrowhead" points="400,416 388,410.4 388,421.6" fill="black" transform="rotate(180,392,416)"></polygon>
              <polygon class="arrowhead" points="384,1120 372,1114.4 372,1125.6" fill="black" transform="rotate(0,376,1120)"></polygon>
              <polygon class="arrowhead" points="384,144 372,138.4 372,149.6" fill="black" transform="rotate(0,376,144)"></polygon>
              <polygon class="arrowhead" points="168,1376 156,1370.4 156,1381.6" fill="black" transform="rotate(180,160,1376)"></polygon>
              <polygon class="arrowhead" points="168,672 156,666.4 156,677.6" fill="black" transform="rotate(180,160,672)"></polygon>
              <polygon class="arrowhead" points="168,80 156,74.4 156,85.6" fill="black" transform="rotate(180,160,80)"></polygon>
              <polygon class="arrowhead" points="152,912 140,906.4 140,917.6" fill="black" transform="rotate(0,144,912)"></polygon>
              <polygon class="arrowhead" points="48,864 36,858.4 36,869.6" fill="black" transform="rotate(180,40,864)"></polygon>
              <g class="text">
                <text x="28" y="36">USIM</text>
                <text x="148" y="36">Peer</text>
                <text x="380" y="36">Server</text>
                <text x="524" y="36">AD</text>
                <text x="308" y="68">EAP-Req/Identity</text>
                <text x="232" y="116">EAP-Resp/Identity</text>
                <text x="236" y="132">(Privacy-Friendly)</text>
                <text x="112" y="180">The</text>
                <text x="156" y="180">Server</text>
                <text x="200" y="180">now</text>
                <text x="232" y="180">has</text>
                <text x="260" y="180">an</text>
                <text x="308" y="180">identity</text>
                <text x="360" y="180">for</text>
                <text x="392" y="180">the</text>
                <text x="432" y="180">Peer.</text>
                <text x="480" y="180">The</text>
                <text x="524" y="180">Server</text>
                <text x="116" y="196">then</text>
                <text x="156" y="196">asks</text>
                <text x="192" y="196">the</text>
                <text x="228" y="196">help</text>
                <text x="260" y="196">of</text>
                <text x="288" y="196">the</text>
                <text x="316" y="196">AD</text>
                <text x="340" y="196">to</text>
                <text x="368" y="196">run</text>
                <text x="416" y="196">EAP-AKA</text>
                <text x="496" y="196">algorithms,</text>
                <text x="140" y="212">generating</text>
                <text x="208" y="212">RAND,</text>
                <text x="256" y="212">AUTN,</text>
                <text x="304" y="212">XRES,</text>
                <text x="344" y="212">CK,</text>
                <text x="376" y="212">and</text>
                <text x="408" y="212">IK.</text>
                <text x="476" y="212">Typically,</text>
                <text x="536" y="212">the</text>
                <text x="108" y="228">AD</text>
                <text x="156" y="228">performs</text>
                <text x="208" y="228">the</text>
                <text x="248" y="228">first</text>
                <text x="292" y="228">part</text>
                <text x="324" y="228">of</text>
                <text x="384" y="228">derivations</text>
                <text x="444" y="228">so</text>
                <text x="476" y="228">that</text>
                <text x="512" y="228">the</text>
                <text x="156" y="244">authentication</text>
                <text x="244" y="244">Server</text>
                <text x="292" y="244">gets</text>
                <text x="328" y="244">the</text>
                <text x="360" y="244">CK'</text>
                <text x="392" y="244">and</text>
                <text x="424" y="244">IK'</text>
                <text x="460" y="244">keys</text>
                <text x="512" y="244">already</text>
                <text x="116" y="260">tied</text>
                <text x="148" y="260">to</text>
                <text x="168" y="260">a</text>
                <text x="220" y="260">particular</text>
                <text x="296" y="260">network</text>
                <text x="352" y="260">name.</text>
                <text x="408" y="308">ID,</text>
                <text x="440" y="308">key</text>
                <text x="484" y="308">deriv.</text>
                <text x="432" y="324">function,</text>
                <text x="424" y="340">network</text>
                <text x="476" y="340">name</text>
                <text x="440" y="388">RAND,</text>
                <text x="488" y="388">AUTN,</text>
                <text x="416" y="404">XRES,</text>
                <text x="460" y="404">CK',</text>
                <text x="496" y="404">IK'</text>
                <text x="112" y="452">The</text>
                <text x="156" y="452">Server</text>
                <text x="200" y="452">now</text>
                <text x="232" y="452">has</text>
                <text x="264" y="452">the</text>
                <text x="308" y="452">needed</text>
                <text x="396" y="452">authentication</text>
                <text x="488" y="452">vector.</text>
                <text x="540" y="452">It</text>
                <text x="136" y="468">generates</text>
                <text x="188" y="468">an</text>
                <text x="240" y="468">ephemeral</text>
                <text x="296" y="468">key</text>
                <text x="336" y="468">pair,</text>
                <text x="376" y="468">and</text>
                <text x="416" y="468">sends</text>
                <text x="456" y="468">the</text>
                <text x="500" y="468">public</text>
                <text x="112" y="484">key</text>
                <text x="140" y="484">of</text>
                <text x="172" y="484">that</text>
                <text x="208" y="484">key</text>
                <text x="244" y="484">pair</text>
                <text x="280" y="484">and</text>
                <text x="312" y="484">the</text>
                <text x="352" y="484">first</text>
                <text x="392" y="484">EAP</text>
                <text x="436" y="484">method</text>
                <text x="496" y="484">message</text>
                <text x="540" y="484">to</text>
                <text x="112" y="500">the</text>
                <text x="152" y="500">Peer.</text>
                <text x="188" y="500">In</text>
                <text x="216" y="500">the</text>
                <text x="264" y="500">message</text>
                <text x="312" y="500">the</text>
                <text x="380" y="500">AT_PUB_ECDHE</text>
                <text x="472" y="500">attribute</text>
                <text x="128" y="516">carries</text>
                <text x="176" y="516">the</text>
                <text x="220" y="516">public</text>
                <text x="264" y="516">key</text>
                <text x="296" y="516">and</text>
                <text x="328" y="516">the</text>
                <text x="384" y="516">AT_KDF_FS</text>
                <text x="464" y="516">attribute</text>
                <text x="128" y="532">carries</text>
                <text x="184" y="532">other</text>
                <text x="252" y="532">FS-related</text>
                <text x="344" y="532">parameters.</text>
                <text x="412" y="532">Both</text>
                <text x="444" y="532">of</text>
                <text x="480" y="532">these</text>
                <text x="520" y="532">are</text>
                <text x="136" y="548">skippable</text>
                <text x="220" y="548">attributes</text>
                <text x="284" y="548">that</text>
                <text x="320" y="548">can</text>
                <text x="348" y="548">be</text>
                <text x="392" y="548">ignored</text>
                <text x="436" y="548">if</text>
                <text x="464" y="548">the</text>
                <text x="500" y="548">Peer</text>
                <text x="116" y="564">does</text>
                <text x="152" y="564">not</text>
                <text x="200" y="564">support</text>
                <text x="252" y="564">this</text>
                <text x="316" y="564">extension.</text>
                <text x="284" y="612">EAP-Req/AKA'-Challenge</text>
                <text x="204" y="628">AT_RAND,</text>
                <text x="276" y="628">AT_AUTN,</text>
                <text x="344" y="628">AT_KDF,</text>
                <text x="220" y="644">AT_KDF_FS,</text>
                <text x="320" y="644">AT_KDF_INPUT,</text>
                <text x="264" y="660">AT_PUB_ECDHE,</text>
                <text x="348" y="660">AT_MAC</text>
                <text x="32" y="708">The</text>
                <text x="68" y="708">Peer</text>
                <text x="116" y="708">checks</text>
                <text x="156" y="708">if</text>
                <text x="180" y="708">it</text>
                <text x="216" y="708">wants</text>
                <text x="252" y="708">to</text>
                <text x="276" y="708">do</text>
                <text x="304" y="708">the</text>
                <text x="332" y="708">FS</text>
                <text x="388" y="708">extension.</text>
                <text x="28" y="724">If</text>
                <text x="60" y="724">yes,</text>
                <text x="92" y="724">it</text>
                <text x="124" y="724">will</text>
                <text x="188" y="724">eventually</text>
                <text x="264" y="724">respond</text>
                <text x="316" y="724">with</text>
                <text x="388" y="724">AT_PUB_ECDHE</text>
                <text x="32" y="740">and</text>
                <text x="80" y="740">AT_MAC.</text>
                <text x="132" y="740">If</text>
                <text x="164" y="740">not,</text>
                <text x="196" y="740">it</text>
                <text x="228" y="740">will</text>
                <text x="276" y="740">ignore</text>
                <text x="356" y="740">AT_PUB_ECDHE</text>
                <text x="424" y="740">and</text>
                <text x="56" y="756">AT_KDF_FS</text>
                <text x="112" y="756">and</text>
                <text x="148" y="756">base</text>
                <text x="184" y="756">all</text>
                <text x="252" y="756">calculations</text>
                <text x="316" y="756">on</text>
                <text x="352" y="756">basic</text>
                <text x="412" y="756">EAP-AKA'</text>
                <text x="64" y="772">attributes,</text>
                <text x="156" y="772">continuing</text>
                <text x="220" y="772">just</text>
                <text x="252" y="772">as</text>
                <text x="276" y="772">in</text>
                <text x="324" y="772">EAP-AKA'</text>
                <text x="376" y="772">per</text>
                <text x="408" y="772">RFC</text>
                <text x="36" y="788">9048</text>
                <text x="84" y="788">rules.</text>
                <text x="132" y="788">In</text>
                <text x="160" y="788">any</text>
                <text x="200" y="788">case,</text>
                <text x="240" y="788">the</text>
                <text x="276" y="788">Peer</text>
                <text x="320" y="788">needs</text>
                <text x="356" y="788">to</text>
                <text x="392" y="788">query</text>
                <text x="432" y="788">the</text>
                <text x="36" y="804">auth</text>
                <text x="100" y="804">parameters</text>
                <text x="164" y="804">from</text>
                <text x="200" y="804">the</text>
                <text x="236" y="804">USIM</text>
                <text x="280" y="804">card.</text>
                <text x="80" y="852">RAND,</text>
                <text x="124" y="852">AUTN</text>
                <text x="56" y="900">CK,</text>
                <text x="88" y="900">IK,</text>
                <text x="120" y="900">RES</text>
                <text x="32" y="948">The</text>
                <text x="68" y="948">Peer</text>
                <text x="104" y="948">now</text>
                <text x="136" y="948">has</text>
                <text x="196" y="948">everything</text>
                <text x="252" y="948">to</text>
                <text x="300" y="948">respond.</text>
                <text x="356" y="948">If</text>
                <text x="380" y="948">it</text>
                <text x="416" y="948">wants</text>
                <text x="28" y="964">to</text>
                <text x="88" y="964">participate</text>
                <text x="148" y="964">in</text>
                <text x="176" y="964">the</text>
                <text x="204" y="964">FS</text>
                <text x="260" y="964">extension,</text>
                <text x="316" y="964">it</text>
                <text x="348" y="964">will</text>
                <text x="388" y="964">then</text>
                <text x="52" y="980">generate</text>
                <text x="104" y="980">its</text>
                <text x="136" y="980">key</text>
                <text x="176" y="980">pair,</text>
                <text x="240" y="980">calculate</text>
                <text x="288" y="980">a</text>
                <text x="324" y="980">shared</text>
                <text x="368" y="980">key</text>
                <text x="408" y="980">based</text>
                <text x="444" y="980">on</text>
                <text x="32" y="996">its</text>
                <text x="64" y="996">key</text>
                <text x="100" y="996">pair</text>
                <text x="136" y="996">and</text>
                <text x="168" y="996">the</text>
                <text x="220" y="996">Server's</text>
                <text x="284" y="996">public</text>
                <text x="332" y="996">key.</text>
                <text x="396" y="996">Finally,</text>
                <text x="444" y="996">it</text>
                <text x="52" y="1012">proceeds</text>
                <text x="100" y="1012">to</text>
                <text x="140" y="1012">derive</text>
                <text x="184" y="1012">all</text>
                <text x="236" y="1012">EAP-AKA'</text>
                <text x="288" y="1012">key</text>
                <text x="332" y="1012">values</text>
                <text x="376" y="1012">and</text>
                <text x="60" y="1028">constructs</text>
                <text x="112" y="1028">a</text>
                <text x="140" y="1028">full</text>
                <text x="200" y="1028">response.</text>
                <text x="256" y="1076">EAP-Resp/AKA'-Challenge</text>
                <text x="192" y="1092">AT_RES,</text>
                <text x="280" y="1092">AT_PUB_ECDHE,</text>
                <text x="188" y="1108">AT_MAC</text>
                <text x="112" y="1156">The</text>
                <text x="156" y="1156">Server</text>
                <text x="200" y="1156">now</text>
                <text x="232" y="1156">has</text>
                <text x="264" y="1156">all</text>
                <text x="296" y="1156">the</text>
                <text x="352" y="1156">necessary</text>
                <text x="424" y="1156">values.</text>
                <text x="476" y="1156">It</text>
                <text x="136" y="1172">generates</text>
                <text x="192" y="1172">the</text>
                <text x="232" y="1172">ECDHE</text>
                <text x="284" y="1172">shared</text>
                <text x="340" y="1172">secret</text>
                <text x="384" y="1172">and</text>
                <text x="428" y="1172">checks</text>
                <text x="472" y="1172">the</text>
                <text x="504" y="1172">RES</text>
                <text x="112" y="1188">and</text>
                <text x="144" y="1188">MAC</text>
                <text x="188" y="1188">values</text>
                <text x="252" y="1188">received</text>
                <text x="300" y="1188">in</text>
                <text x="340" y="1188">AT_RES</text>
                <text x="384" y="1188">and</text>
                <text x="432" y="1188">AT_MAC,</text>
                <text x="152" y="1204">respectively.</text>
                <text x="248" y="1204">Success</text>
                <text x="316" y="1204">requires</text>
                <text x="372" y="1204">both</text>
                <text x="404" y="1204">to</text>
                <text x="428" y="1204">be</text>
                <text x="464" y="1204">found</text>
                <text x="132" y="1220">correct.</text>
                <text x="196" y="1220">Note</text>
                <text x="236" y="1220">that</text>
                <text x="276" y="1220">when</text>
                <text x="316" y="1220">this</text>
                <text x="372" y="1220">document</text>
                <text x="420" y="1220">is</text>
                <text x="456" y="1220">used,</text>
                <text x="112" y="1236">the</text>
                <text x="148" y="1236">keys</text>
                <text x="208" y="1236">generated</text>
                <text x="268" y="1236">from</text>
                <text x="324" y="1236">EAP-AKA'</text>
                <text x="376" y="1236">are</text>
                <text x="416" y="1236">based</text>
                <text x="452" y="1236">on</text>
                <text x="480" y="1236">CK,</text>
                <text x="512" y="1236">IK,</text>
                <text x="112" y="1252">and</text>
                <text x="144" y="1252">the</text>
                <text x="184" y="1252">ECDHE</text>
                <text x="236" y="1252">value.</text>
                <text x="292" y="1252">Even</text>
                <text x="324" y="1252">if</text>
                <text x="360" y="1252">there</text>
                <text x="400" y="1252">was</text>
                <text x="428" y="1252">an</text>
                <text x="476" y="1252">attacker</text>
                <text x="112" y="1268">who</text>
                <text x="148" y="1268">held</text>
                <text x="184" y="1268">the</text>
                <text x="240" y="1268">long-term</text>
                <text x="300" y="1268">key,</text>
                <text x="340" y="1268">only</text>
                <text x="372" y="1268">an</text>
                <text x="412" y="1268">active</text>
                <text x="476" y="1268">attacker</text>
                <text x="120" y="1284">could</text>
                <text x="164" y="1284">have</text>
                <text x="228" y="1284">determined</text>
                <text x="288" y="1284">the</text>
                <text x="344" y="1284">generated</text>
                <text x="416" y="1284">session</text>
                <text x="472" y="1284">keys;</text>
                <text x="508" y="1284">in</text>
                <text x="120" y="1300">basic</text>
                <text x="180" y="1300">EAP-AKA'</text>
                <text x="232" y="1300">the</text>
                <text x="288" y="1300">generated</text>
                <text x="348" y="1300">keys</text>
                <text x="384" y="1300">are</text>
                <text x="420" y="1300">only</text>
                <text x="464" y="1300">based</text>
                <text x="500" y="1300">on</text>
                <text x="524" y="1300">CK</text>
                <text x="112" y="1316">and</text>
                <text x="144" y="1316">IK.</text>
                <text x="328" y="1364">EAP-Success</text>
              </g>
            </svg><a href="#section-5-5.1.2" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-eap-aka-fs-authentication-p" class="selfRef">EAP-AKA' FS Authentication Process</a>
        </figcaption></figure>
</div>
</section>
<section id="section-6">
      <h2 id="name-extensions-to-eap-aka">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-extensions-to-eap-aka" class="section-name selfRef">Extensions to EAP-AKA'</a>
      </h2>
<div id="at_pub_dh">
<section id="section-6.1">
        <h3 id="name-at_pub_ecdhe">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-at_pub_ecdhe" class="section-name selfRef">AT_PUB_ECDHE</a>
        </h3>
<p id="section-6.1-1">The AT_PUB_ECDHE attribute carries an ECDHE value.<a href="#section-6.1-1" class="pilcrow">Â¶</a></p>
<p id="section-6.1-2">The format of the AT_PUB_ECDHE attribute is shown below.<a href="#section-6.1-2" class="pilcrow">Â¶</a></p>
<div id="section-6.1-3">
          <div class="alignLeft art-svg artwork" id="section-6.1-3.2">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="112" width="528" viewBox="0 0 528 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,64 L 8,96" fill="none" stroke="black"></path>
              <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
              <path d="M 264,64 L 264,96" fill="none" stroke="black"></path>
              <path d="M 520,64 L 520,96" fill="none" stroke="black"></path>
              <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="176" y="36">1</text>
                <text x="336" y="36">2</text>
                <text x="496" y="36">3</text>
                <text x="16" y="52">0</text>
                <text x="32" y="52">1</text>
                <text x="48" y="52">2</text>
                <text x="64" y="52">3</text>
                <text x="80" y="52">4</text>
                <text x="96" y="52">5</text>
                <text x="112" y="52">6</text>
                <text x="128" y="52">7</text>
                <text x="144" y="52">8</text>
                <text x="160" y="52">9</text>
                <text x="176" y="52">0</text>
                <text x="192" y="52">1</text>
                <text x="208" y="52">2</text>
                <text x="224" y="52">3</text>
                <text x="240" y="52">4</text>
                <text x="256" y="52">5</text>
                <text x="272" y="52">6</text>
                <text x="288" y="52">7</text>
                <text x="304" y="52">8</text>
                <text x="320" y="52">9</text>
                <text x="336" y="52">0</text>
                <text x="352" y="52">1</text>
                <text x="368" y="52">2</text>
                <text x="384" y="52">3</text>
                <text x="400" y="52">4</text>
                <text x="416" y="52">5</text>
                <text x="432" y="52">6</text>
                <text x="448" y="52">7</text>
                <text x="464" y="52">8</text>
                <text x="480" y="52">9</text>
                <text x="496" y="52">0</text>
                <text x="512" y="52">1</text>
                <text x="68" y="84">AT_PUB_ECDHE</text>
                <text x="172" y="84">Length</text>
                <text x="296" y="84">Value</text>
              </g>
            </svg><a href="#section-6.1-3.2" class="pilcrow">Â¶</a>
</div>
</div>
<p id="section-6.1-4">The fields are as follows:<a href="#section-6.1-4" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.1-5">
          <dt id="section-6.1-5.1">AT_PUB_ECDHE:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.2">This is set to 152.<a href="#section-6.1-5.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.3">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.4">This is the length of the attribute, set as other attributes in
          EAP-AKA <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>. The length is
          expressed in multiples of 4 bytes. The length includes the attribute
          type field, the Length field itself, and the Value field (along with
          any padding).<a href="#section-6.1-5.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.5">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.6">
            <p id="section-6.1-5.6.1">This value is
           the sender's ECDHE public key. The value depends on the AT_KDF_FS attribute and
           is calculated as follows:<a href="#section-6.1-5.6.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.6.2.1">
                <p id="section-6.1-5.6.2.1.1">For X25519, the length of this value is 32 bytes, encoded
                as specified in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-6.1-5.6.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-6.1-5.6.2.2">
                <p id="section-6.1-5.6.2.2.1">For P-256, the length of this value is 33 bytes, encoded
                using the compressed form specified in Section 2.3.3 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-6.1-5.6.2.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
<p id="section-6.1-5.6.3">Because the length of the attribute must be a multiple of 4
            bytes, the sender pads the Value field with zero bytes when
            necessary. To retain the security of the keys, the sender
            <span class="bcp14">SHALL</span> generate a fresh value for each run of the
            protocol.<a href="#section-6.1-5.6.3" class="pilcrow">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="at_kdf_dh">
<section id="section-6.2">
        <h3 id="name-at_kdf_fs">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-at_kdf_fs" class="section-name selfRef">AT_KDF_FS</a>
        </h3>
<p id="section-6.2-1">The AT_KDF_FS attribute indicates the used or desired FS key
         generation function, if the FS extension
         is used. It will also indicate the
         used or desired ECDHE group. A new attribute is needed to
         carry this information, as AT_KDF carries the basic KDF
         value that is still used together with the FS KDF
         value. The basic KDF value is also used by those EAP Peers
         that cannot or do not want to use this extension.<a href="#section-6.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.2-2">This document only specifies the behavior relating to the following
        combinations of basic KDF values and FS KDF values:<a href="#section-6.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">the
        basic KDF value in AT_KDF is 1, as specified in <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span> and <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> and<a href="#section-6.2-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">the FS KDF values in AT_KDF_FS are 1 or 2, as specified
        below and in <a href="#kdf2" class="auto internal xref">Section 6.3</a>.<a href="#section-6.2-3.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-6.2-4">Any future specifications that add either new basic KDFs or new FS KDF values need to specify
  how they are treated and what combinations are allowed. This requirement is an update to how 
  <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span> and <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> may be extended in the future.<a href="#section-6.2-4" class="pilcrow">Â¶</a></p>
<p id="section-6.2-5">The format of the AT_KDF_FS attribute is shown below.<a href="#section-6.2-5" class="pilcrow">Â¶</a></p>
<div id="section-6.2-6">
          <div class="alignLeft art-svg artwork" id="section-6.2-6.2">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="112" width="528" viewBox="0 0 528 112" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,64 L 8,96" fill="none" stroke="black"></path>
              <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
              <path d="M 264,64 L 264,96" fill="none" stroke="black"></path>
              <path d="M 520,64 L 520,96" fill="none" stroke="black"></path>
              <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="176" y="36">1</text>
                <text x="336" y="36">2</text>
                <text x="496" y="36">3</text>
                <text x="16" y="52">0</text>
                <text x="32" y="52">1</text>
                <text x="48" y="52">2</text>
                <text x="64" y="52">3</text>
                <text x="80" y="52">4</text>
                <text x="96" y="52">5</text>
                <text x="112" y="52">6</text>
                <text x="128" y="52">7</text>
                <text x="144" y="52">8</text>
                <text x="160" y="52">9</text>
                <text x="176" y="52">0</text>
                <text x="192" y="52">1</text>
                <text x="208" y="52">2</text>
                <text x="224" y="52">3</text>
                <text x="240" y="52">4</text>
                <text x="256" y="52">5</text>
                <text x="272" y="52">6</text>
                <text x="288" y="52">7</text>
                <text x="304" y="52">8</text>
                <text x="320" y="52">9</text>
                <text x="336" y="52">0</text>
                <text x="352" y="52">1</text>
                <text x="368" y="52">2</text>
                <text x="384" y="52">3</text>
                <text x="400" y="52">4</text>
                <text x="416" y="52">5</text>
                <text x="432" y="52">6</text>
                <text x="448" y="52">7</text>
                <text x="464" y="52">8</text>
                <text x="480" y="52">9</text>
                <text x="496" y="52">0</text>
                <text x="512" y="52">1</text>
                <text x="56" y="84">AT_KDF_FS</text>
                <text x="172" y="84">Length</text>
                <text x="284" y="84">FS</text>
                <text x="312" y="84">Key</text>
                <text x="372" y="84">Derivation</text>
                <text x="452" y="84">Function</text>
              </g>
            </svg><a href="#section-6.2-6.2" class="pilcrow">Â¶</a>
</div>
</div>
<p id="section-6.2-7">The fields are as follows:<a href="#section-6.2-7" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-8">
          <dt id="section-6.2-8.1">AT_KDF_FS:</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.2">This is set to 153.<a href="#section-6.2-8.2" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-8.3">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.4">This is the length of the attribute; it <span class="bcp14">MUST</span> be set to 1.<a href="#section-6.2-8.4" class="pilcrow">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-8.5">FS Key Derivation Function:</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-8.6">This is an enumerated value representing the FS Key Derivation Function (KDF) that the Server (or Peer) wishes to use. See
          <a href="#kdf2" class="auto internal xref">Section 6.3</a> for the functions specified
          in this document. Note: this field has a different name space than
          the similar field in the AT_KDF attribute KDF
          defined in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-6.2-8.6" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-9">Servers <span class="bcp14">MUST</span> send one or more AT_KDF_FS attributes
        in the EAP-Request/AKA'-Challenge message. These attributes represent
        the desired functions ordered by preference, with the most preferred
        function being the first attribute. The most preferred function is the
        only one that the Server includes a public key value for, however. So,
        for a set of AT_KDF_FS attributes, there is always only one
        AT_PUB_ECDHE attribute.<a href="#section-6.2-9" class="pilcrow">Â¶</a></p>
<p id="section-6.2-10">Upon receiving a set of these attributes:<a href="#section-6.2-10" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-11.1">If the Peer supports and is willing to use the FS KDF indicated
          by the first AT_KDF_FS attribute, and is willing and able to use the
          extension defined in this document, the function will be used
          without any further negotiation.<a href="#section-6.2-11.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-11.2">If the Peer does not support this function or is unwilling to
          use it, it responds to the Server with an indication that a
          different function is needed. Similarly, with the negotiation process
          defined in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> for AT_KDF, the
          Peer sends an EAP-Response/AKA'-Challenge message that contains only
          one attribute, AT_KDF_FS, with the value set to the desired
          alternative function from among the ones suggested by the Server
          earlier. If there is no suitable alternative, the Peer has a choice
          of either falling back to EAP-AKA' or behaving as if the AUTN had been
          incorrect and failing authentication (see Figure 3 of <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>). The Peer <span class="bcp14">MUST</span>
          fail the authentication if there are any duplicate values within the
          list of AT_KDF_FS attributes (except where the duplication is due to
          a request to change the KDF; see below for
          further information).<a href="#section-6.2-11.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-11.3">If the Peer does not recognize the extension defined in this
          document or is unwilling to use it, it ignores the AT_KDF_FS
          attribute.<a href="#section-6.2-11.3" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-6.2-12">Upon receiving an EAP-Response/AKA'-Challenge message with an AT_KDF_FS attribute
        from the Peer, the Server checks that the suggested AT_KDF_FS value
        was one of the alternatives in its offer. The first AT_KDF_FS value in
        the message from the Server is not a valid alternative. If the Peer
        has replied with the first AT_KDF_FS value, the Server behaves as if
        the AT_MAC of the response had been incorrect and fails the
        authentication. For an overview of the failed authentication process
        in the Server side, see Section <a href="https://rfc-editor.org/rfc/rfc4187#section-3" class="relref">3</a> and Figure 2 in <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>. Otherwise, the Server re-sends the
        EAP-Response/AKA'-Challenge message, but adds the selected alternative
        to the beginning of the list of AT_KDF_FS attributes and retains the
        entire list following it. Note that this means that the selected
        alternative appears twice in the set of AT_KDF values. Responding to
        the Peer's request to change the FS KDF is the
        only valid situation where such duplication may occur.<a href="#section-6.2-12" class="pilcrow">Â¶</a></p>
<p id="section-6.2-13">When the Peer receives the new EAP-Request/AKA'-Challenge message,
        it <span class="bcp14">MUST</span> check that the requested change, and only the
        requested change, occurred in the list of AT_KDF_FS attributes. If so,
        it continues.  If not, it behaves as if AT_MAC were incorrect and
        fails the authentication. If the Peer receives multiple
        EAP-Request/AKA'-Challenge messages with differing AT_KDF_FS
        attributes without having requested negotiation, the Peer
        <span class="bcp14">MUST</span> behave as if AT_MAC were incorrect and fail
        the authentication.<a href="#section-6.2-13" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="kdf2">
<section id="section-6.3">
        <h3 id="name-forward-secrecy-key-derivat">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-forward-secrecy-key-derivat" class="section-name selfRef">Forward Secrecy Key Derivation Functions</a>
        </h3>
<p id="section-6.3-1">Two new FS KDF types are defined for "EAP-AKA'
        with ECDHE and X25519", represented by value 1, and "EAP-AKA' with
        ECDHE and P-256", represented by value 2. These values represent a particular
        choice of KDF and, at the same time, select an
        ECDHE group to be used.<a href="#section-6.3-1" class="pilcrow">Â¶</a></p>
<p id="section-6.3-2">The FS KDF type value is only used in the
        AT_KDF_FS attribute. When the FS extension is used, the
        AT_KDF_FS attribute determines how to derive the MK_ECDHE key, K_re key,
        Master Session Key (MSK), and Extended Master Session Key (EMSK). The
        AT_KDF_FS attribute should not be confused with the different range of
        KDFs that can be represented in the AT_KDF
        attribute as defined in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>. When the FS extension is used, the
        AT_KDF attribute only specifies how to derive the Master Key (MK), the K_encr key, and the
        K_aut key.<a href="#section-6.3-2" class="pilcrow">Â¶</a></p>
<p id="section-6.3-3">Key derivation in this extension produces exactly the same keys for
        internal use within one authentication run as EAP-AKA' <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> does.  For instance, the K_aut that is
        used in AT_MAC is still exactly as it was in EAP-AKA'. The only change
        to key derivation is in the re-authentication keys and keys exported out
        of the EAP method, MSK and EMSK. As a result, EAP-AKA' attributes such
        as AT_MAC continue to be usable even when this extension is in
        use.<a href="#section-6.3-3" class="pilcrow">Â¶</a></p>
<p id="section-6.3-4">When the FS KDF field in the AT_KDF_FS
         attribute is set to 1 or 2 and the KDF field
         in the AT_KDF attribute is set to 1, the MK and
         accompanying keys are derived as follows:<a href="#section-6.3-4" class="pilcrow">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-6.3-5">
<pre>
MK       = PRF'(IK'|CK',"EAP-AKA'"|Identity)
MK_ECDHE = PRF'(IK'|CK'|SHARED_SECRET,"EAP-AKA' FS"|Identity)
K_encr   = MK[0..127]
K_aut    = MK[128..383]
K_re     = MK_ECDHE[0..255]
MSK      = MK_ECDHE[256..767]
EMSK     = MK_ECDHE[768..1279]
</pre><a href="#section-6.3-5" class="pilcrow">Â¶</a>
</div>
<p id="section-6.3-6">An explanation of the notation used above is copied here:<a href="#section-6.3-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-7.1">[n..m] denotes the substring from bit n to m.<a href="#section-6.3-7.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.2">PRF' is a new pseudorandom function specified in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-6.3-7.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.3">K_encr is the encryption key (128 bits).<a href="#section-6.3-7.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.4">K_aut is the authentication key (256 bits).<a href="#section-6.3-7.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.5">K_re is the re-authentication key (256 bits).<a href="#section-6.3-7.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.6">MSK is the Master Session Key (512 bits).<a href="#section-6.3-7.6" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.3-7.7">EMSK is the Extended Master Session Key (512 bits).<a href="#section-6.3-7.7" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-6.3-8">Note: MSK and EMSK are outputs from a successful EAP method run
        <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.<a href="#section-6.3-8" class="pilcrow">Â¶</a></p>
<p id="section-6.3-9">The CK and IK are produced by the AKA algorithm. The IK' and CK' are
        derived as specified in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> from
        the IK and CK.<a href="#section-6.3-9" class="pilcrow">Â¶</a></p>
<p id="section-6.3-10">The value "EAP-AKA'" is an ASCII string that is 8 characters long.  It
        is used as is, without any trailing NUL characters. Similarly,
        "EAP-AKA' FS" is an ASCII string that is 11 characters long, also used as
        is.<a href="#section-6.3-10" class="pilcrow">Â¶</a></p>
<p id="section-6.3-11">Requirements for how to securely generate, validate, and process the
 ephemeral public keys depend on the elliptic curve.<a href="#section-6.3-11" class="pilcrow">Â¶</a></p>
<p id="section-6.3-12">For P-256, the SHARED_SECRET is the shared secret computed as
        specified in Section 5.7.1.2 of <span>[<a href="#SP-800-56A" class="cite xref">SP-800-56A</a>]</span>. Requirements are defined in Section 5 of 
 <span>[<a href="#SP-800-56A" class="cite xref">SP-800-56A</a>]</span>, in particular, Sections 5.6.2.3.4, 5.6.3.1,
        and 5.6.3.3. At least partial public key validation
        <span class="bcp14">MUST</span> be done for the ephemeral public keys. The
        uncompressed y-coordinate can be computed as described in Section
        2.3.4 of <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>.<a href="#section-6.3-12" class="pilcrow">Â¶</a></p>
<p id="section-6.3-13">For X25519, the SHARED_SECRET is the shared secret computed as specified in
 <span><a href="https://rfc-editor.org/rfc/rfc7748#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>. Both the Peer and the Server
 <span class="bcp14">MAY</span> check for the zero-value shared secret as specified in 
 <span><a href="https://rfc-editor.org/rfc/rfc7748#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>.<a href="#section-6.3-13" class="pilcrow">Â¶</a></p>
<aside id="section-6.3-14">
          <p id="section-6.3-14.1">Note: If performed inappropriately, the way that the shared
 secret is tested for zero can provide an ability for attackers to
 listen to CPU power usage side channels. Refer to <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span> for a description of how to
 perform this check in a way that it does not become a
problem.<a href="#section-6.3-14.1" class="pilcrow">Â¶</a></p>
</aside>
<p id="section-6.3-15">If validation of the other party's ephemeral public key or the shared secret fails,
 a party <span class="bcp14">MUST</span> behave as if the current EAP-AKA' process starts again from the beginning.<a href="#section-6.3-15" class="pilcrow">Â¶</a></p>
<p id="section-6.3-16">The rest of the computation proceeds as defined in <span><a href="https://rfc-editor.org/rfc/rfc9048#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-6.3-16" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="groups">
<section id="section-6.4">
        <h3 id="name-ecdhe-groups">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-ecdhe-groups" class="section-name selfRef">ECDHE Groups</a>
        </h3>
<p id="section-6.4-1">The selection of suitable groups for the elliptic curve
         computation is necessary. The choice of a group is made at
         the same time as the decision to use a particular KDF in the AT_KDF_FS attribute.<a href="#section-6.4-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4-2">For "EAP-AKA' with ECDHE and
         X25519", the group is the Curve25519 group specified in
         <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>. The support for this group is <span class="bcp14">REQUIRED</span>.<a href="#section-6.4-2" class="pilcrow">Â¶</a></p>
<p id="section-6.4-3">For "EAP-AKA' with ECDHE and P-256", the group is the NIST P-256
        group (SEC group secp256r1), specified in Section 3.2.1.3 of <span>[<a href="#SP-800-186" class="cite xref">SP-800-186</a>]</span> or alternatively, Section 2.4.2
        of <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.  The support for this group
        is <span class="bcp14">REQUIRED</span>.<a href="#section-6.4-3" class="pilcrow">Â¶</a></p>
<p id="section-6.4-4">The term "support" here means that the group <span class="bcp14">MUST</span> be implemented.<a href="#section-6.4-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="secMessageProc">
<section id="section-6.5">
        <h3 id="name-message-processing">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-message-processing" class="section-name selfRef">Message Processing</a>
        </h3>
<p id="section-6.5-1">This section specifies the changes related to message processing
        when this extension is used in EAP-AKA'. It specifies when a message
        may be transmitted or accepted, which attributes are allowed in a
        message, which attributes are required in a message, and other
        message-specific details, where those details are different for this
        extension than the base EAP-AKA' or EAP-AKA protocol. Unless otherwise
        specified here, the rules from <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> or <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>
        apply.<a href="#section-6.5-1" class="pilcrow">Â¶</a></p>
<section id="section-6.5.1">
          <h4 id="name-eap-request-aka-identity">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-eap-request-aka-identity" class="section-name selfRef">EAP-Request/AKA'-Identity</a>
          </h4>
<p id="section-6.5.1-1">There are no changes for the EAP-Request/AKA'-Identity, except
          that the AT_KDF_FS or AT_PUB_ECDHE attributes <span class="bcp14">MUST NOT</span> be added to this message.  The appearance of these
          attributes in a received message <span class="bcp14">MUST</span> be ignored.<a href="#section-6.5.1-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.2">
          <h4 id="name-eap-response-aka-identity">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-eap-response-aka-identity" class="section-name selfRef">EAP-Response/AKA'-Identity</a>
          </h4>
<p id="section-6.5.2-1">There are no changes for the EAP-Response/AKA'-Identity, except
          that the AT_KDF_FS or AT_PUB_ECDHE attributes <span class="bcp14">MUST NOT</span> be added to this message. The appearance of these
          attributes in a received message <span class="bcp14">MUST</span> be ignored. The
          Peer identifier <span class="bcp14">SHALL</span> comply with the
          privacy-friendly requirements of <span>[<a href="#RFC9190" class="cite xref">RFC9190</a>]</span>.  An example of a compliant way of constructing a
          privacy-friendly Peer identifier is using a non-null SUCI <span>[<a href="#TS.33.501" class="cite xref">TS.33.501</a>]</span>.<a href="#section-6.5.2-1" class="pilcrow">Â¶</a></p>
</section>
<div id="procakachall">
<section id="section-6.5.3">
          <h4 id="name-eap-request-aka-challenge">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-eap-request-aka-challenge" class="section-name selfRef">EAP-Request/AKA'-Challenge</a>
          </h4>
<p id="section-6.5.3-1">The Server sends the EAP-Request/AKA'-Challenge on full
          authentication as specified by <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.
          The attributes AT_RAND, AT_AUTN, and AT_MAC <span class="bcp14">MUST</span> be
          included and checked on reception as specified in <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>. They are also necessary for
          backwards compatibility.<a href="#section-6.5.3-1" class="pilcrow">Â¶</a></p>
<p id="section-6.5.3-2">In the EAP-Request/AKA'-Challenge, there is no message-specific data
          covered by the MAC for the AT_MAC attribute. The AT_KDF_FS and
          AT_PUB_ECDHE attributes <span class="bcp14">MUST</span> be included. The
          AT_PUB_ECDHE attribute carries the Server's public Diffie-Hellman
          key. If either AT_KDF_FS or AT_PUB_ECDHE is missing on reception,
          the Peer <span class="bcp14">MUST</span> treat it as if neither one was sent
          and assume that the extension defined in this document is not in
          use.<a href="#section-6.5.3-2" class="pilcrow">Â¶</a></p>
<p id="section-6.5.3-3">The AT_RESULT_IND, AT_CHECKCODE, AT_IV, AT_ENCR_DATA, AT_PADDING,
          AT_NEXT_PSEUDONYM, AT_NEXT_REAUTH_ID, and other attributes may be
          included as specified in <span><a href="https://rfc-editor.org/rfc/rfc4187#section-9.3" class="relref">Section 9.3</a> of [<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>.<a href="#section-6.5.3-3" class="pilcrow">Â¶</a></p>
<p id="section-6.5.3-4">When processing this message, the Peer <span class="bcp14">MUST</span>
          process AT_RAND, AT_AUTN, AT_KDF_FS, and AT_PUB_ECDHE before
          processing other attributes. The Peer derives keys and verifies
          AT_MAC only if these attributes are verified to be valid.  If the
          Peer is unable or unwilling to perform the extension specified in
          this document, it proceeds as defined in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>. Finally, if there is an error, see <span><a href="https://rfc-editor.org/rfc/rfc4187#section-6.3.1" class="relref">Section 6.3.1</a> of [<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>.<a href="#section-6.5.3-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="procakachallresp">
<section id="section-6.5.4">
          <h4 id="name-eap-response-aka-challenge">
<a href="#section-6.5.4" class="section-number selfRef">6.5.4. </a><a href="#name-eap-response-aka-challenge" class="section-name selfRef">EAP-Response/AKA'-Challenge</a>
          </h4>
<p id="section-6.5.4-1">The Peer sends an EAP-Response/AKA'-Challenge in response to a
      valid EAP-Request/AKA'-Challenge message, as specified by <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.
      If the Peer supports and is willing to perform the extension
      specified in this protocol, and the Server had made a valid
      request involving the attributes specified in <a href="#procakachall" class="auto internal xref">Section 6.5.3</a>, the Peer responds per the rules
      specified below. Otherwise, the Peer responds as specified in
      <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span> and ignores the attributes
      related to this extension. If the Peer has not received
      attributes related to this extension from the Server, and has a
      policy that requires it to always use this extension, it behaves
      as if the AUTN were incorrect and fails the authentication.<a href="#section-6.5.4-1" class="pilcrow">Â¶</a></p>
<p id="section-6.5.4-2">The AT_MAC attribute <span class="bcp14">MUST</span> be included and checked as
      specified in <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>. In the
      EAP-Response/AKA'-Challenge, there is no message-specific data
      covered by the MAC. The AT_PUB_ECDHE attribute <span class="bcp14">MUST</span> be included
      and carries the Peer's public Diffie-Hellman key.<a href="#section-6.5.4-2" class="pilcrow">Â¶</a></p>
<p id="section-6.5.4-3">The AT_RES attribute <span class="bcp14">MUST</span> be included and checked as
      specified in <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>.  When processing this
      message, the Server <span class="bcp14">MUST</span> process AT_RES before processing other
      attributes.  The Server derives keys and verifies AT_MAC only
      when this attribute is verified to be valid.<a href="#section-6.5.4-3" class="pilcrow">Â¶</a></p>
<p id="section-6.5.4-4">If the Server has proposed the use of the extension specified
      in this protocol, but the Peer ignores and continues the basic
      EAP-AKA' authentication, the Server makes a policy decision of
      whether this is allowed. If this is allowed, it continues the
      EAP-AKA' authentication to completion. If it is not allowed, the
      Server <span class="bcp14">MUST</span> behave as if authentication failed.<a href="#section-6.5.4-4" class="pilcrow">Â¶</a></p>
<p id="section-6.5.4-5">The AT_CHECKCODE, AT_RESULT_IND, AT_IV, AT_ENCR_DATA, and other
      attributes may be included as specified in <span><a href="https://rfc-editor.org/rfc/rfc4187#section-9.4" class="relref">Section 9.4</a> of [<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>.<a href="#section-6.5.4-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="reauth">
<section id="section-6.5.5">
          <h4 id="name-eap-request-aka-reauthentic">
<a href="#section-6.5.5" class="section-number selfRef">6.5.5. </a><a href="#name-eap-request-aka-reauthentic" class="section-name selfRef">EAP-Request/AKA'-Reauthentication</a>
          </h4>
<p id="section-6.5.5-1">There are no changes for the EAP-Request/AKA'-Reauthentication, but note that the re-authentication process
      uses the keys generated in the original EAP-AKA' authentication,
      which employs key material from the Diffie-Hellman procedure if the extension specified in this document is in use.<a href="#section-6.5.5-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-6.5.6">
          <h4 id="name-eap-response-aka-reauthenti">
<a href="#section-6.5.6" class="section-number selfRef">6.5.6. </a><a href="#name-eap-response-aka-reauthenti" class="section-name selfRef">EAP-Response/AKA'-Reauthentication</a>
          </h4>
<p id="section-6.5.6-1">There are no changes for the EAP-Response/AKA'-Reauthentication,
          but as discussed in <a href="#reauth" class="auto internal xref">Section 6.5.5</a>,
          re-authentication is based on the key material generated by EAP-AKA'
          and the extension defined in this document.<a href="#section-6.5.6-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.7">
          <h4 id="name-eap-response-aka-synchroniz">
<a href="#section-6.5.7" class="section-number selfRef">6.5.7. </a><a href="#name-eap-response-aka-synchroniz" class="section-name selfRef">EAP-Response/AKA'-Synchronization-Failure</a>
          </h4>
<p id="section-6.5.7-1">There are no changes for the
          EAP-Response/AKA'-Synchronization-Failure, except that the AT_KDF_FS
          or AT_PUB_ECDHE attributes <span class="bcp14">MUST NOT</span> be added to this
          message.  The appearance of these attributes in a received message
          <span class="bcp14">MUST</span> be ignored.<a href="#section-6.5.7-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.8">
          <h4 id="name-eap-response-aka-authentica">
<a href="#section-6.5.8" class="section-number selfRef">6.5.8. </a><a href="#name-eap-response-aka-authentica" class="section-name selfRef">EAP-Response/AKA'-Authentication-Reject</a>
          </h4>
<p id="section-6.5.8-1">There are no changes for the
          EAP-Response/AKA'-Authentication-Reject, except that the AT_KDF_FS
          or AT_PUB_ECDHE attributes <span class="bcp14">MUST NOT</span> be added to this
          message.  The appearance of these attributes in a received message
          <span class="bcp14">MUST</span> be ignored.<a href="#section-6.5.8-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.9">
          <h4 id="name-eap-response-aka-client-err">
<a href="#section-6.5.9" class="section-number selfRef">6.5.9. </a><a href="#name-eap-response-aka-client-err" class="section-name selfRef">EAP-Response/AKA'-Client-Error</a>
          </h4>
<p id="section-6.5.9-1">There are no changes for the EAP-Response/AKA'-Client-Error,
          except that the AT_KDF_FS or AT_PUB_ECDHE attributes <span class="bcp14">MUST NOT</span> be added to this message.  The appearance of
          these attributes in a received message <span class="bcp14">MUST</span> be
          ignored.<a href="#section-6.5.9-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.10">
          <h4 id="name-eap-request-aka-notificatio">
<a href="#section-6.5.10" class="section-number selfRef">6.5.10. </a><a href="#name-eap-request-aka-notificatio" class="section-name selfRef">EAP-Request/AKA'-Notification</a>
          </h4>
<p id="section-6.5.10-1">There are no changes for the EAP-Request/AKA'-Notification.<a href="#section-6.5.10-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-6.5.11">
          <h4 id="name-eap-response-aka-notificati">
<a href="#section-6.5.11" class="section-number selfRef">6.5.11. </a><a href="#name-eap-response-aka-notificati" class="section-name selfRef">EAP-Response/AKA'-Notification</a>
          </h4>
<p id="section-6.5.11-1">There are no changes for the EAP-Response/AKA'-Notification.<a href="#section-6.5.11-1" class="pilcrow">Â¶</a></p>
</section>
</section>
</div>
</section>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This section deals only with changes to security considerations for
      EAP-AKA' or new information that has been gathered since the publication
      of <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<p id="section-7-2">As discussed in <a href="#sec_intro" class="auto internal xref">Section 1</a>, FS is an important countermeasure against adversaries who gain
      access to long-term keys.  The long-term keys can be best protected
      with good processes, e.g., restricting access to the key material within
      a factory or among personnel, etc.  Even so, not all attacks can be
      entirely ruled out. For instance, well-resourced adversaries may be able
      to coerce insiders to collaborate, despite any technical protection
      measures.  The zero trust principles suggest that we assume that
      breaches are inevitable or have potentially already occurred and that
      we need to minimize the impact of these breaches (see <span>[<a href="#NSA-ZT" class="cite xref">NSA-ZT</a>]</span> and <span>[<a href="#NIST-ZT" class="cite xref">NIST-ZT</a>]</span>). One type
      of breach is key compromise or key exfiltration.<a href="#section-7-2" class="pilcrow">Â¶</a></p>
<p id="section-7-3">If a mechanism without ephemeral key exchange (such as 5G-AKA or
      EAP-AKA') is used, the effects of key compromise are devastating.  There
      are serious consequences to not properly providing FS for
      the key establishment, for the control plane and the user plane, and for
      both directions:<a href="#section-7-3" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-4">
<li id="section-7-4.1">
          <p id="section-7-4.1.1">An attacker can decrypt 5G communication that they
     previously recorded.<a href="#section-7-4.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li id="section-7-4.2">
          <p id="section-7-4.2.1">A passive attacker can eavesdrop (decrypt) all
     future 5G communication.<a href="#section-7-4.2.1" class="pilcrow">Â¶</a></p>
</li>
        <li id="section-7-4.3">
          <p id="section-7-4.3.1">An active attacker can impersonate the User Equipment (UE) or the
    network and inject messages in an ongoing 5G connection between
    the real UE and the real network.<a href="#section-7-4.3.1" class="pilcrow">Â¶</a></p>
</li>
      </ol>
<p id="section-7-5">At the time of writing, best practice security is to mandate FS (as is
      done in Wi-Fi Protected Access 3 (WPA3), EAP-TLS 1.3, EAP-TTLS 1.3,
      Internet Key Exchange Protocol Version 2 (IKEv2), Secure Shell (SSH),
      QUIC, WireGuard, Signal, etc.). In deployments, it is recommended that
      EAP-AKA methods without FS be phased out in the long
      term.<a href="#section-7-5" class="pilcrow">Â¶</a></p>
<p id="section-7-6">The FS extension provides assistance against passive attacks from
      attackers that have compromised the key material on USIM cards.  Passive
      attacks are attractive for attackers performing large-scale pervasive
      monitoring as they require far fewer resources and are much harder to
      detect. The extension also provides protection against active attacks as
      the attacker is forced to be on-path during the AKA run and subsequent
      communication between the parties. Without FS, an active attacker that
      has compromised the long-term key can inject messages in a connection
      between the real Peer and the real Server without being on-path. This
      extension is most useful when implemented in a context where the MSK or
      EMSK are used in protocols not providing FS. For instance, if used with
      IKEv2 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, the session keys
      produced by IKEv2 will in any case have this property, so the
      improvements from the use of EAP-AKA' FS are not that useful. However,
      typical link-layer usage of EAP does not involve running another key exchange with forward secrecy. Therefore, using EAP to authenticate
      access to a network is one situation where the extension defined in this
      document can be helpful.<a href="#section-7-6" class="pilcrow">Â¶</a></p>
<p id="section-7-7">The FS extension generates key material using the ECDHE
    exchange in order to gain the FS property. This means that once
    an EAP-AKA' authentication run ends, the session that it was used
    to protect is closed, and the corresponding keys are destroyed. Even someone who has recorded all of the data from the
    authentication run and session and gets access to all of the AKA
    long-term keys cannot reconstruct the keys used to protect the
    session or any previous session, without doing a brute-force
    search of the session key space.<a href="#section-7-7" class="pilcrow">Â¶</a></p>
<p id="section-7-8">Even if a compromise of the long-term keys has occurred, FS is
    still provided for all future sessions, as long as the attacker
    does not become an active attacker.<a href="#section-7-8" class="pilcrow">Â¶</a></p>
<p id="section-7-9">The extension does not provide protection against active attackers that
    mount an on-path attack on future EAP-AKA' runs and have access to the
    long-term key. They will be able to eavesdrop on the traffic protected by
    the resulting session key(s).  Still, past sessions where FS was in use
    remain protected.<a href="#section-7-9" class="pilcrow">Â¶</a></p>
<p id="section-7-10">Using EAP-AKA' FS once provides FS. FS limits the effect of key leakage
    in one direction (compromise of a key at time T2 does not compromise some
    key at time T1 where T1 &lt; T2). Protection in the other direction
    (compromise at time T1 does not compromise keys at time T2) can be
    achieved by rerunning ECDHE frequently. If a long-term authentication key
    has been compromised, rerunning EAP-AKA' FS gives protection against
    passive attackers. Using the terms in <span>[<a href="#RFC7624" class="cite xref">RFC7624</a>]</span>, FS without rerunning ECDHE does not stop an attacker
    from doing static key exfiltration. Frequently rerunning EC(DHE) forces an
    attacker to do dynamic key exfiltration (or content exfiltration).<a href="#section-7-10" class="pilcrow">Â¶</a></p>
<section id="section-7.1">
        <h3 id="name-deployment-considerations">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
        </h3>
<p id="section-7.1-1">Achieving FS requires that, when a connection is closed, each
    endpoint <span class="bcp14">MUST</span> destroy not only the ephemeral keys used by the
    connection but also any information that could be used to
    recompute those keys.<a href="#section-7.1-1" class="pilcrow">Â¶</a></p>
<p id="section-7.1-2">Similarly, other parts of the system matter. For instance, when the keys generated by EAP are transported to a
         pass-through authenticator, such transport must also provide forward secure encryption with respect to the long-term keys used to establish
         its security. Otherwise, an adversary may attack the transport connection
  used to carry keys from EAP, and use this method to gain access to current and past
 keys from EAP, which, in turn, would lead to the compromise of anything protected by those EAP keys.<a href="#section-7.1-2" class="pilcrow">Â¶</a></p>
<p id="section-7.1-3">Of course, these considerations
         apply to any EAP method, not only this one.<a href="#section-7.1-3" class="pilcrow">Â¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-security-properties">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-security-properties" class="section-name selfRef">Security Properties</a>
        </h3>
<p id="section-7.2-1">The following security properties of
    EAP-AKA' are impacted through this extension:<a href="#section-7.2-1" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7.2-2">
          <dt id="section-7.2-2.1">Protected ciphersuite negotiation:</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">EAP-AKA' has a negotiation mechanism for selecting the KDFs, and this mechanism has been extended by the
            extension specified in this document.  The resulting mechanism
            continues to be secure against bidding-down attacks.<a href="#section-7.2-2.2.1" class="pilcrow">Â¶</a></p>
<p id="section-7.2-2.2.2">There are two specific needs in the negotiation mechanism:<a href="#section-7.2-2.2.2" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7.2-2.2.3">
              <dt id="section-7.2-2.2.3.1">Negotiating KDFs within the extension:</dt>
              <dd style="margin-left: 1.5em" id="section-7.2-2.2.3.2">
        The negotiation mechanism allows changing the offered KDF, but the change is visible in the final
        EAP-Request/AKA'-Challenge message that the Server sends to the Peer.
        This message is authenticated via the AT_MAC attribute, and carries
        both the chosen alternative and the initially offered list.  The Peer
        refuses to accept a change it did not initiate.  As a result, both
        parties are aware that a change is being made and what the original
        offer was.<a href="#section-7.2-2.2.3.2" class="pilcrow">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-7.2-2.2.3.3">Negotiating the use of this extension:</dt>
              <dd style="margin-left: 1.5em" id="section-7.2-2.2.3.4">
                <p id="section-7.2-2.2.3.4.1"> This extension is offered by the Server through presenting
                the AT_KDF_FS and AT_PUB_ECDHE attributes in the
                EAP-Request/AKA'-Challenge message. These attributes are
                protected by AT_MAC, so attempts to change or omit them by an
                adversary will be detected.<a href="#section-7.2-2.2.3.4.1" class="pilcrow">Â¶</a></p>
<p id="section-7.2-2.2.3.4.2">These attempts will be detected, except of course, if the
 adversary holds the long-term key and is willing to engage in
 an active attack.  For instance, such an attack can forge the negotiation
 process so that no FS will be provided. However, as noted
 above, an attacker with these capabilities will, in any case,
 be able to impersonate any party in the protocol and perform
 on-path attacks. That is not a situation that can be improved
 by a technical solution. However, as discussed in the
 Introduction, even an attacker with access to the long-term
 keys is required to be on-path on each AKA run and subsequent
 communication, which makes mass surveillance more laborious.<a href="#section-7.2-2.2.3.4.2" class="pilcrow">Â¶</a></p>
<p id="section-7.2-2.2.3.4.3">
   The security properties of the extension also depend on a
   policy choice. As discussed in <a href="#procakachallresp" class="auto internal xref">Section 6.5.4</a>, both the Peer
   and the Server make a policy decision of what to do when it
   was willing to perform the extension specified in this
   protocol, but the other side does not wish to use the
   extension. Allowing this has the benefit of allowing
   backwards compatibility to equipment that did not yet
   support the extension. When the extension is not supported
   or negotiated by the parties, no FS can obviously be
   provided.<a href="#section-7.2-2.2.3.4.3" class="pilcrow">Â¶</a></p>
<p id="section-7.2-2.2.3.4.4">
   If turning off the extension specified in this protocol is
   not allowed by policy, the use of legacy equipment that does
   not support this protocol is no longer possible. This may be
   appropriate when, for instance, support for the extension is
   sufficiently widespread or required in a particular version
   of a mobile network.<a href="#section-7.2-2.2.3.4.4" class="pilcrow">Â¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-2.3">Key derivation:</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-2.4">This extension provides FS.  As described in several places in
          this specification, this can be roughly summarized as follows: an
          attacker with access to long-term keys is unable to obtain session
          keys of ended past sessions, assuming these sessions deleted all
          relevant session key material.  This extension does not change the
          properties related to re-authentication. No new Diffie-Hellman run
          is performed during the re-authentication allowed by
          EAP-AKA'. However, if this extension was in use when the original
          EAP-AKA' authentication was performed, the keys used for
          re-authentication (K_re) are based on the Diffie-Hellman keys;
          hence, they continue to be equally safe against exposure of the
          long-term key as the original authentication.<a href="#section-7.2-2.4" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-7.3">
        <h3 id="name-denial-of-service">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-denial-of-service" class="section-name selfRef">Denial of Service</a>
        </h3>
<p id="section-7.3-1">It is worthwhile to discuss Denial-of-Service (DoS) attacks and
        their impact on this protocol. The calculations involved in public key
        cryptography require computing power, which could be used in an attack
        to overpower either the Peer or the Server. While some forms of DoS
        attacks are always possible, the following factors help mitigate the
        concerns relating to public key cryptography and EAP-AKA' FS.<a href="#section-7.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">In a 5G context, other parts of the connection setup involve
            public key cryptography, so while performing additional operations
            in EAP-AKA' is an additional concern, it does not change the
            overall situation. As a result, the relevant system components
            need to be dimensioned appropriately, and detection and management
            mechanisms to reduce the effect of attacks need to be in
            place.<a href="#section-7.3-2.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">This specification is constructed so that it is possible to
     have a separation between the USIM and Peer on the client side and
     between the Server and AD on the network side. This ensures that
     the most sensitive (or legacy) system components cannot be the
     target of the attack. For instance, EAP-AKA' and public key
     cryptography both take place in the phone and not the low-power
     USIM card.<a href="#section-7.3-2.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.3">
            <p id="section-7.3-2.3.1">EAP-AKA' has been designed so that the first actual message in
    the authentication process comes from the Server, and that this
    message will not be sent unless the user has been identified as
    an active subscriber of the operator in question. While the initial identity
    can be spoofed before authentication has succeeded, this reduces the efficiency of
    an attack.<a href="#section-7.3-2.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.4">
            <p id="section-7.3-2.4.1">Finally, this memo specifies an order in which computations and
    checks must occur. For instance, when processing the EAP-Request/AKA'-Challenge
    message, the AKA authentication must be checked and
    succeed before the Peer proceeds to calculating or processing the
    FS-related parameters (see <a href="#procakachallresp" class="auto internal xref">Section 6.5.4</a>). The same is true of an
    EAP-Response/AKA'-Challenge (see <a href="#procakachallresp" class="auto internal xref">Section 6.5.4</a>). This ensures that the parties need to
    show possession of the long-term key in some way, and only then
    will the FS calculations become active. This limits the
    DoS to specific, identified subscribers. While
    botnets and other forms of malicious parties could take advantage
    of actual subscribers and their key material, at least such
    attacks are:<a href="#section-7.3-2.4.1" class="pilcrow">Â¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-7.3-2.4.2">
<li id="section-7.3-2.4.2.1">limited in terms of subscribers they control, and<a href="#section-7.3-2.4.2.1" class="pilcrow">Â¶</a>
</li>
              <li id="section-7.3-2.4.2.2">identifiable for the purposes of blocking the affected
    subscribers.<a href="#section-7.3-2.4.2.2" class="pilcrow">Â¶</a>
</li>
            </ol>
</li>
        </ul>
</section>
<section id="section-7.4">
        <h3 id="name-identity-privacy">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-identity-privacy" class="section-name selfRef">Identity Privacy</a>
        </h3>
<p id="section-7.4-1">As specified in <a href="#secMessageProc" class="auto internal xref">Section 6.5</a>, the Peer identity sent
       in the Identity Response message needs
       to follow the privacy-friendly requirements in <span>[<a href="#RFC9190" class="cite xref">RFC9190</a>]</span>.<a href="#section-7.4-1" class="pilcrow">Â¶</a></p>
</section>
<div id="unp">
<section id="section-7.5">
        <h3 id="name-unprotected-data-and-privac">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-unprotected-data-and-privac" class="section-name selfRef">Unprotected Data and Privacy</a>
        </h3>
<p id="section-7.5-1">Unprotected data and metadata can reveal sensitive information and need to be selected with care.
   In particular, this applies to
   AT_KDF, AT_KDF_FS, AT_PUB_ECDHE, and AT_KDF_INPUT. AT_KDF, AT_KDF_FS, and
   AT_PUB_ECDHE reveal the used cryptographic algorithms; if these depend on the
   Peer identity, they leak information about the Peer. AT_KDF_INPUT reveals the
   network name, although that is done on purpose to bind the authentication to a particular context.<a href="#section-7.5-1" class="pilcrow">Â¶</a></p>
<p id="section-7.5-2">An attacker observing network traffic may use the above types of information
   for traffic flow analysis or to track an endpoint.<a href="#section-7.5-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-7.6">
        <h3 id="name-forward-secrecy-within-at_e">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-forward-secrecy-within-at_e" class="section-name selfRef">Forward Secrecy within AT_ENCR</a>
        </h3>
<p id="section-7.6-1">The keys K_encr and K_aut are calculated and used before the shared secret from the ephemeral 
     key exchange is available.<a href="#section-7.6-1" class="pilcrow">Â¶</a></p>
<p id="section-7.6-2">K_encr and K_aut are used to encrypt and calculate a MAC in the
        EAP-Req/AKA'-Challenge message, especially the DH g<sup>x</sup>
        ephemeral pub key. At that point, the Server does not yet have the
        corresponding g<sup>y</sup> from the Peer and cannot compute the
        shared secret. K_aut is then used as the authentication key for the
        shared secret.<a href="#section-7.6-2" class="pilcrow">Â¶</a></p>
<p id="section-7.6-3">However, for K_encr, none of the encrypted data sent in the
        EAP-Req/AKA'-Challenge message in the AT_ENCR attribute will be a
        forward secret. That data may include re-authentication pseudonyms, so
        an adversary compromising the long-term key would be able to link
        re-authentication protocol runs when pseudonyms are used, within a
        sequence of runs followed after a full EAP-AKA' authentication. No
        such linking would be possible across different full authentication
        runs. If the pseudonym linkage risk is not acceptable, one way to
        avoid the linkage is to always require full EAP-AKA'
        authentication.<a href="#section-7.6-3" class="pilcrow">Â¶</a></p>
</section>
<section id="section-7.7">
        <h3 id="name-post-quantum-considerations">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-post-quantum-considerations" class="section-name selfRef">Post-Quantum Considerations</a>
        </h3>
<p id="section-7.7-1">As of the publication of this document, it is unclear when or even
        if a quantum computer of sufficient size and power to exploit ECC will exist.  Deployments that need to consider
        risks decades into the future should transition to Post-Quantum Cryptography (PQC) in the not-too-distant future.  Other systems may
        employ PQC when the quantum threat is more imminent. Current PQC
        algorithms have limitations compared to ECC, and the data sizes could be problematic for some constrained
        systems. If a Cryptographically Relevant Quantum Computer (CRQC) is
        built, it could recover the SHARED_SECRET from the ECDHE public
        keys.<a href="#section-7.7-1" class="pilcrow">Â¶</a></p>
<p id="section-7.7-2">However, this would not affect the ability of EAP-AKA', with or
        without this extension, to authenticate properly. As symmetric key
        cryptography is safe even if CRQCs are built, an adversary still will
        not be able to disrupt authentication as it requires computing a
        correct AT_MAC value. This computation requires the K_aut key, which is
        based on the MK, CK', and IK', but not SHARED_SECRET.<a href="#section-7.7-2" class="pilcrow">Â¶</a></p>
<p id="section-7.7-3">Other output keys do include SHARED_SECRET via MK_ECDHE, but they still include the CK' and IK', which are entirely based on symmetric cryptography. As a result,
 an adversary with a quantum computer still cannot compute the other output keys either.<a href="#section-7.7-3" class="pilcrow">Â¶</a></p>
<p id="section-7.7-4">However, if the adversary has also obtained knowledge of the long-term key, they
   could then compute the CK', IK', SHARED_SECRET, and any derived output keys. This means that
   the introduction of a powerful enough quantum computer would disable
   this protocol extension's ability to provide the forward secrecy
   capability. This would 
   make it necessary to update the current ECC algorithms in this document to PQC algorithms. This
   document does not add such algorithms, but a future update can do that.<a href="#section-7.7-4" class="pilcrow">Â¶</a></p>
<p id="section-7.7-5">Symmetric algorithms used in EAP-AKA' FS, such as HMAC-SHA-256 and
        the algorithms used to generate AT_AUTN and AT_RES, are practically
        secure against even large, robust quantum computers. EAP-AKA' FS is
        currently only specified for use with ECDHE key exchange algorithms,
        but use of any Key Encapsulation Method (KEM), including PQC KEMs, can
        be specified in the future. While the key exchange is specified with
        terms of the Diffie-Hellman protocol, the key exchange adheres to a
        KEM interface. AT_PUB_ECDHE would then contain either the ephemeral
        public key of the Server or the SHARED_SECRET encapsulated with the
        Server's public key. Note that the use of a KEM might require other
        changes, such as including the ephemeral public key of the Server in
        the key derivation to retain the property that both parties contribute
        randomness to the session key.<a href="#section-7.7-5" class="pilcrow">Â¶</a></p>
</section>
</section>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This extension of EAP-AKA' shares its attribute space and subtypes
      with the following:<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">"Extensible Authentication Protocol Method for Global System for
      Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)" <span>[<a href="#RFC4186" class="cite xref">RFC4186</a>]</span>,<a href="#section-8-2.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-8-2.2">"Extensible Authentication Protocol
      Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"
      <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span>, and<a href="#section-8-2.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-8-2.3">"Improved Extensible
      Authentication Protocol Method for 3GPP Mobile Network Authentication
      and Key Agreement (EAP-AKA')" <span>[<a href="#RFC9048" class="cite xref">RFC9048</a>]</span>.<a href="#section-8-2.3" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-8-3">IANA has assigned two new values in the "Attribute Types (Skippable
  Attributes 128-255)" registry under the "EAP-AKA and EAP-SIM Parameters"
  group as follows:<a href="#section-8-3" class="pilcrow">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8-4">
        <dt id="section-8-4.1">152:</dt>
        <dd style="margin-left: 1.5em" id="section-8-4.2">AT_PUB_ECDHE (<a href="#at_pub_dh" class="auto internal xref">Section 6.1</a>)<a href="#section-8-4.2" class="pilcrow">Â¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-8-4.3">153:</dt>
        <dd style="margin-left: 1.5em" id="section-8-4.4">AT_KDF_FS (<a href="#at_kdf_dh" class="auto internal xref">Section 6.2</a>)<a href="#section-8-4.4" class="pilcrow">Â¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-8-5">IANA has also created the "EAP-AKA' AT_KDF_FS
      Key Derivation Function Values" registry to represent FS KDF
      types. The "EAP-AKA' with ECDHE and X25519" and "EAP-AKA' with ECDHE and
      P-256" types (1 and 2, see <a href="#kdf2" class="auto internal xref">Section 6.3</a>) have been assigned, along with one reserved value. The initial contents of
      this registry are illustrated in <a href="#iana-fs-values" class="auto internal xref">Table 1</a>; new values can be created through the Specification
      Required policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  Expert
      reviewers should ensure that the referenced specification is clearly
      identified and stable and that the proposed addition is reasonable for
      the given category of allocation.<a href="#section-8-5" class="pilcrow">Â¶</a></p>
<span id="name-eap-aka-at_kdf_fs-key-deriv"></span><div id="iana-fs-values">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-eap-aka-at_kdf_fs-key-deriv" class="selfRef">EAP-AKA' AT_KDF_FS Key Derivation Function Values Registry Initial Contents</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9678</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">EAP-AKA' with ECDHE and X25519</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9678</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">EAP-AKA' with ECDHE and P-256</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9678</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">3-65535</td>
            <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
            <td class="text-left" rowspan="1" colspan="1">RFC 9678</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4187">[RFC4187]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">H. Haverinen</span>, <span class="refTitle">"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"</span>, <span class="seriesInfo">RFC 4187</span>, <span class="seriesInfo">DOI 10.17487/RFC4187</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4187">https://www.rfc-editor.org/info/rfc4187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5448">[RFC5448]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 5448</span>, <span class="seriesInfo">DOI 10.17487/RFC5448</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5448">https://www.rfc-editor.org/info/rfc5448</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7624">[RFC7624]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Hardie, T.</span>, <span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">D. Borkmann</span>, <span class="refTitle">"Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement"</span>, <span class="seriesInfo">RFC 7624</span>, <span class="seriesInfo">DOI 10.17487/RFC7624</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7624">https://www.rfc-editor.org/info/rfc7624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9048">[RFC9048]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, <span class="refAuthor">Torvinen, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 9048</span>, <span class="seriesInfo">DOI 10.17487/RFC9048</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9048">https://www.rfc-editor.org/info/rfc9048</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span class="refContent">Version 2.0</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <span class="refContent">Version 2.0</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.secg.org/sec2-v2.pdf">https://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-186">[SP-800-186]</dt>
        <dd>
<span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Moody, D.</span>, <span class="refAuthor">Randall, K.</span>, <span class="refAuthor">Regenscheid, A.</span>, and <span class="refAuthor">A. Robinson</span>, <span class="refTitle">"Recommendations for Discrete Logarithm-based Cryptography: Elliptic Curve Domain Parameters"</span>, <span class="seriesInfo">NIST SP 800-186</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-186</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-186">https://doi.org/10.6028/NIST.SP.800-186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-56A">[SP-800-56A]</dt>
      <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST SP 800-56A</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-56Ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Ar3">https://doi.org/10.6028/NIST.SP.800-56Ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DOW1992">[DOW1992]</dt>
        <dd>
<span class="refAuthor">Diffie, W.</span>, <span class="refAuthor">Van Oorschot, P. C.</span>, and <span class="refAuthor">M. J. Wiener</span>, <span class="refTitle">"Authentication and authenticated key exchanges"</span>, <span class="refContent">Designs, Codes and Cryptography, vol. 2, pp. 107-125</span>, <span class="seriesInfo">DOI 10.1007/BF00124891</span>, <time datetime="1992-06" class="refDate">June 1992</time>, <span>&lt;<a href="https://doi.org/10.1007/BF00124891">https://doi.org/10.1007/BF00124891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Heist2015">[Heist2015]</dt>
        <dd>
<span class="refAuthor">Scahill, J.</span> and <span class="refAuthor">J. Begley</span>, <span class="refTitle">"The Great SIM Heist"</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://theintercept.com/2015/02/19/great-sim-heist/">https://theintercept.com/2015/02/19/great-sim-heist/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-ZT">[NIST-ZT]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Implementing a Zero Trust Architecture"</span>, <span class="seriesInfo">NIST SP 1800-35</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://www.nccoe.nist.gov/sites/default/files/2024-07/zta-nist-sp-1800-35-preliminary-draft-4.pdf">https://www.nccoe.nist.gov/sites/default/files/2024-07/zta-nist-sp-1800-35-preliminary-draft-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NSA-ZT">[NSA-ZT]</dt>
        <dd>
<span class="refAuthor">National Security Agency</span>, <span class="refTitle">"Embracing a Zero Trust Security Model"</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://media.defense.gov/2021/Feb/25/2002588479/-1/-1/0/CSI_EMBRACING_ZT_SECURITY_MODEL_UOO115131-21.PDF">https://media.defense.gov/2021/Feb/25/2002588479/-1/-1/0/CSI_EMBRACING_ZT_SECURITY_MODEL_UOO115131-21.PDF</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4186">[RFC4186]</dt>
        <dd>
<span class="refAuthor">Haverinen, H., Ed.</span> and <span class="refAuthor">J. Salowey, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"</span>, <span class="seriesInfo">RFC 4186</span>, <span class="seriesInfo">DOI 10.17487/RFC4186</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4186">https://www.rfc-editor.org/info/rfc4186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5216">[RFC5216]</dt>
        <dd>
<span class="refAuthor">Simon, D.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">R. Hurst</span>, <span class="refTitle">"The EAP-TLS Authentication Protocol"</span>, <span class="seriesInfo">RFC 5216</span>, <span class="seriesInfo">DOI 10.17487/RFC5216</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5216">https://www.rfc-editor.org/info/rfc5216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9190">[RFC9190]</dt>
        <dd>
<span class="refAuthor">PreuÃŸ Mattsson, J.</span> and <span class="refAuthor">M. Sethi</span>, <span class="refTitle">"EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3"</span>, <span class="seriesInfo">RFC 9190</span>, <span class="seriesInfo">DOI 10.17487/RFC9190</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9190">https://www.rfc-editor.org/info/rfc9190</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TrustCom2015">[TrustCom2015]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Norrman, K.</span>, <span class="refAuthor">NÃ¤slund, M.</span>, and <span class="refAuthor">B. Sahlin</span>, <span class="refTitle">"A USIM Compatible 5G AKA Protocol with Perfect Forward Secrecy"</span>, <span class="refContent">IEEE International Conference on Trust, Security and
   Privacy in Computing and Communications (TrustCom)</span>, <span class="seriesInfo">DOI 10.1109/Trustcom.2015.506</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://doi.org/10.1109/Trustcom.2015.506">https://doi.org/10.1109/Trustcom.2015.506</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TS.33.501">[TS.33.501]</dt>
      <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"Security architecture and procedures for 5G System"</span>, <span class="refContent">Version 19.0.0</span>, <span class="seriesInfo">3GPP TS 33.501</span>, <time datetime="2024-09" class="refDate">September 2024</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to note that the technical solution in this
      document came out of the TrustCom paper <span>[<a href="#TrustCom2015" class="cite xref">TrustCom2015</a>]</span>, whose authors were <span class="contact-name">J. Arkko</span>,
      <span class="contact-name">K. Norrman</span>, <span class="contact-name">M. NÃ¤slund</span>, and
      <span class="contact-name">B. Sahlin</span>. This document also uses a lot of
      material from <span>[<a href="#RFC4187" class="cite xref">RFC4187</a>]</span> by <span class="contact-name">J. Arkko</span> and <span class="contact-name">H. Haverinen</span>, as well as
      <span>[<a href="#RFC5448" class="cite xref">RFC5448</a>]</span> by <span class="contact-name">J. Arkko</span>, <span class="contact-name">V. Lehtovirta</span>, and <span class="contact-name">P. Eronen</span>.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A-2">The authors would also like to thank <span class="contact-name">Ben       Campbell</span>, <span class="contact-name">Meiling Chen</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Linda Dunbar</span>, <span class="contact-name">Tim Evans</span>, <span class="contact-name">Zhang Fu</span>, <span class="contact-name">Russ Housley</span>, <span class="contact-name">Tero Kivinen</span>, <span class="contact-name">Murray Kucherawy</span>, <span class="contact-name">Warren Kumari</span>,
      <span class="contact-name">Eliot Lear</span>, <span class="contact-name">Vesa Lehtovirta</span>,
      <span class="contact-name">Kathleen Moriarty</span>, <span class="contact-name">Prajwol       Kumar Nakarmi</span>, <span class="contact-name">Francesca Palombini</span>, <span class="contact-name">Anand R. Prasad</span>, <span class="contact-name">Michael Richardson</span>,
      <span class="contact-name">GÃ¶ran Rune</span>, <span class="contact-name">Bengt Sahlin</span>,
      <span class="contact-name">Joseph Salowey</span>, <span class="contact-name">Mohit Sethi</span>,
      <span class="contact-name">Orie Steele</span>, <span class="contact-name">Rene Struik</span>,
      <span class="contact-name">Vesa Torvinen</span>, <span class="contact-name">Sean Turner</span>,
      <span class="contact-name">Helena Vahidi Mazinani</span>, <span class="contact-name">Robert       Wilton</span>, <span class="contact-name">Paul Wouters</span>, <span class="contact-name">Bo       Wu</span>, <span class="contact-name">Peter Yee</span>, and many other people at the
      IETF, GSMA, and 3GPP groups for interesting discussions in this problem
      space.<a href="#appendix-A-2" class="pilcrow">Â¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jari Arkko</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jari.arkko@piuha.net" class="email">jari.arkko@piuha.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karl Norrman</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16483</span> <span class="locality">Stockholm</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:karl.norrman@ericsson.com" class="email">karl.norrman@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John PreuÃŸ Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
