<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9673: IPv6 Hop-by-Hop Options Processing Procedures</title>
<meta content="Robert M. Hinden" name="author">
<meta content="Godred Fairhurst" name="author">
<meta content="
       This document specifies procedures for processing IPv6 Hop-by-Hop
  options in IPv6 routers and hosts. It modifies the procedures specified
  in the IPv6 Protocol Specification (RFC 8200) to make processing of the IPv6
  Hop-by-Hop Options header practical with the goal of making IPv6
  Hop-by-Hop options useful to deploy and use at IPv6 routers and hosts.
  This document updates RFC 8200. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="9673" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9673.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-6man-hbh-processing-20" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9673" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9673</td>
<td class="center">HBH Options Processing</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hinden &amp; Fairhurst</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9673" class="eref">9673</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8200" class="eref">8200</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10" class="published">October 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Hinden</div>
<div class="org">Check Point Software</div>
</div>
<div class="author">
      <div class="author-name">G. Fairhurst</div>
<div class="org">University of Aberdeen</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9673</h1>
<h1 id="title">IPv6 Hop-by-Hop Options Processing Procedures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies procedures for processing IPv6 Hop-by-Hop
  options in IPv6 routers and hosts. It modifies the procedures specified
  in the IPv6 Protocol Specification (RFC 8200) to make processing of the IPv6
  Hop-by-Hop Options header practical with the goal of making IPv6
  Hop-by-Hop options useful to deploy and use at IPv6 routers and hosts.
  This document updates RFC 8200.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9673">https://www.rfc-editor.org/info/rfc9673</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-hop-by-hop-header-processin" class="internal xref">Hop-by-Hop Header Processing Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-processing-the-extension-he" class="internal xref">Processing the Extension Header Carrying Hop-by-Hop Options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-configuration-enabling-hop-" class="internal xref">Configuration Enabling Hop-by-Hop Header Processing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-hop-by-hop-options-processi" class="internal xref">Hop-by-Hop Options Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-router-alert-option" class="internal xref">Router Alert Option</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-configuration-of-hop-by-hop" class="internal xref">Configuration of Hop-by-Hop Options Processing</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-defining-new-hop-by-hop-opt" class="internal xref">Defining New Hop-by-Hop Options</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-example-of-robust-usage" class="internal xref">Example of Robust Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="INTRO">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies procedures for processing IPv6 Hop-by-Hop
  options in IPv6 routers and hosts.
  It modifies the procedures specified in the IPv6
  Protocol Specification <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> to make processing of the IPv6 Hop-by-Hop Options header
  practical with the goal of making IPv6 Hop-by-Hop options useful to
  deploy and use at IPv6 routers and hosts.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">An IPv6 packet includes Hop-by-Hop
  options by including a Hop-by-Hop
  Options header. The current list of defined Hop-by-Hop options can be found at <span>[<a href="#IANA-HBH" class="cite xref">IANA-HBH</a>]</span>.
  The focus for this document is to set the minimum requirements
  for router processing of Hop-by-Hop options. It also discusses
  how Hop-by-Hop options are used by hosts.
  This document 
  does not propose a specific bound to the number or size of Hop-by-Hop options
  that ought to be processed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document updates <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
<div id="TERM">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">This document uses the following loosely defined
   terms:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Forwarding Plane:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">IPv6 routers exchange user or applications data through the
       Forwarding Plane.  Routers process fields contained in IPv6 packet
       headers.  However, they do not process information contained in packet
       payloads.<a href="#section-3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Control Plane:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">IPv6 routers exchange control
       information through the
       Control Plane.  The Control Plane processes the management and routing
       information exchanged with other routers.<a href="#section-3-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">Fast Path:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">A path through a router that is optimized for
       forwarding packets. The Fast Path
       might be supported by Application-Specific Integrated Circuits (ASICs),
       a Network Processor (NP),
       or other special purpose hardware. This is the typical processing path
       within a router taken by the Forwarding Plane.<a href="#section-3-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">Slow Path:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.8">A path through a router that is capable of
       general purpose processing and is not optimized for any particular
       function.  This processing path is used for packets that require
       special processing or that differ from assumptions made in Fast Path
       heuristics or to process router control protocols used by the Control
       Plane.<a href="#section-3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.9">Full Forwarding Rate:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.10">The rate at which a router can
       forward packets without adversely impacting the aggregate
       forwarding rate. For example, a router could process packets
       with Hop-by-Hop options at a rate that allows it to maintain the full
       speed on its outgoing interfaces, which is sometimes called
       "wire speed".<a href="#section-3-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.11">Source:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.12">The node originating the packet.<a href="#section-3-2.12" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">NOTE: <span>[<a href="#RFC6192" class="cite xref">RFC6192</a>]</span> is an example of how designs can
   separate Control Plane and Forwarding Plane
   functions. The separation between hardware and software processing
   described in <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span> does not apply to all router
   architectures.  However, a router that performs all or most processing
   in software might still incur more processing cost when providing
   special processing for Hop-by-Hop options.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="BACKGROUND">
<section id="section-4">
      <h2 id="name-background">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-4-1">
    In early versions of the IPv6 protocol specification
    <span>[<a href="#RFC1883" class="cite xref">RFC1883</a>]</span>
        <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span>,
    Hop-by-Hop options were
    required to be processed by all nodes: routers and hosts. This proved to
    not be practical in current high speed routers, as observed in <span><a href="https://rfc-editor.org/rfc/rfc7045#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7045" class="cite xref">RFC7045</a>]</span>: "it is to be expected that high-performance routers will
    either ignore it or assign packets containing it to a slow processing
    path". The reasons behind this include the following:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">The inability to process Hop-by-Hop options at the Full Forwarding
        Rate can result in issues.
        In some cases, Hop-by-Hop options would be sent to the
 control/management components that run on the Slow Path.
        This could degrade a router's performance and also its ability to process
        critical control traffic, both of which could be exploited as a
        Denial-of-Service (DoS) attack against the router.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">If a subset of packets within a flow includes Hop-by-Hop
 options, it could lead to an increased number of reordered
 packets and greater reordering distances for packets delivered to
 the destination.
        Such reordering could occur if the Hop-by-Hop
 Options header is included
 only in some packets or if a specific Hop-by-Hop option results
 in different processing for some of the packets within the
 flow. Significant reordering of packets within a flow can
 negatively impact the performance of upper-layer protocols and
 should therefore be avoided.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">Packets could include multiple Hop-by-Hop options. Too many
        options could make the
        previous issues worse by increasing the resources required to process
        them. The total size of the options determines the number of header bytes
        that might need to be processed. Measurements <span>[<a href="#Cus23a" class="cite xref">Cus23a</a>]</span> show
        that the probability of successful transmission across the
 public Internet is currently
        higher for packets that include Options that result in a short
        total Extension Header (EH) Chain size (i.e., less than 40 bytes).<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3"><span>[<a href="#RFC6564" class="cite xref">RFC6564</a>]</span> specifies a uniform format for new IPv6 Extension
    Headers, and this update was incorporated into
    <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> (note that
    <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> obsoleted <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span>).<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">When the IPv6 protocol specification was updated and published in
    July 2017 as
    <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>, the procedures relating to Hop-by-Hop options
    were specified (paragraphs 5 and 6 of <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4" class="relref">Section 4</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>) as follows:<a href="#section-4-4" class="pilcrow">¶</a></p>
<blockquote id="section-4-5">
        <p id="section-4-5.1">
       The Hop-by-Hop Options header is not inserted or deleted, but may be
       examined or processed by any node along a packet's delivery path,
       until the packet reaches the node (or each of the set of nodes, in
       the case of multicast) identified in the Destination Address field of
       the IPv6 header.  The Hop-by-Hop Options header, when present, must
       immediately follow the IPv6 header.  Its presence is indicated by the
       value zero in the Next Header field of the IPv6 header.<a href="#section-4-5.1" class="pilcrow">¶</a></p>
<p id="section-4-5.2">
       NOTE: While <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span> required that all nodes
       must examine and process the Hop-by-Hop Options header, it is now
       expected that nodes along a packet's delivery path only examine
       and process the Hop-by-Hop Options header if explicitly configured
       to do so.<a href="#section-4-5.2" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-4-6">
    The changes meant that an implementation complied with the IPv6 protocol
    specification even if it did not process Hop-by-Hop options and that
    routers were expected to add configuration information to
    control whether they process the Hop-by-Hop Options header.
    In practice, routers may include configuration options to control
    which Hop-by-Hop options they will process.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The text regarding the processing of Hop-by-Hop options in <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> was not intended to change the processing of these
    options. It documented how they were being used in
    the Internet at the time RFC 8200 was published (see <span><a href="https://rfc-editor.org/rfc/rfc8200#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>).  This was a constraint on
    publishing the IPv6 protocol specification as an IETF Standard.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">The main issues remain:<a href="#section-4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-9.1">Routers can be configured
        to drop transit packets containing Hop-by-Hop Options that
        require processing by a processor that implements the Control Plane.
        This could be done to protect against a DoS attack on the
 router <span>[<a href="#RFC9098" class="cite xref">RFC9098</a>]</span> <span>[<a href="#RFC9288" class="cite xref">RFC9288</a>]</span>.<a href="#section-4-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-9.2">IPv6 packets that include a Hop-by-Hop Options header are dropped
        by some Internet paths.
        A survey in 2015 reported a high loss rate in transit Autonomous Systems (ASes) for packets that include
        Hop-by-Hop options <span>[<a href="#RFC7872" class="cite xref">RFC7872</a>]</span>.
        The operational implications of IPv6 packets that include
        Extension Headers are discussed in <span>[<a href="#RFC9098" class="cite xref">RFC9098</a>]</span>.
 
        Measurements taken in 2023 confirm this to still be the case for many types of
 network paths <span>[<a href="#Cus23b" class="cite xref">Cus23b</a>]</span>.<a href="#section-4-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-9.3">Allowing multiple Hop-by-Hop options in a single packet in some cases
        consumes more router resources to process these packets.  It also adds
        complexity to the number of permutations that might need to be
        processed/configured.<a href="#section-4-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-9.4">Including larger or multiple Hop-by-Hop options in a
        Hop-by-Hop Options header increases
        the number of bytes that need to be processed in forwarding,
        which in some designs can impact
        the cost of processing a packet, and in turn could increase the probability of
        drop <span>[<a href="#RFC7872" class="cite xref">RFC7872</a>]</span>. A larger Extension Header
        could also reduce the probability of a router locating all
        the header bytes required to successfully process
        an access control list operating on fields after the Hop-by-Hop
        Options header.<a href="#section-4-9.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-9.5">Any option that can be used to force packets into the
 processor that implements the router's Control Plane can be 
 exploited as a DoS
        attack on a transit router by saturating the resources needed for
        router management protocols (routing protocols, network management
        protocols, etc.), which could cause adverse router operation.
        This is an issue for the
        Router Alert Option <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span>, which
 intentionally forwards packets to the Control Plane
        as discussed in <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>.
        This impact could be mitigated by limiting
        the use of Control Plane resources by a specific packet and/or
        by using per-function rate-limiters for packets processed
        by the Control Plane.<a href="#section-4-9.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-10"><span><a href="https://rfc-editor.org/rfc/rfc6398#section-3" class="relref">Section 3</a> of [<a href="#RFC6398" class="cite xref">RFC6398</a>]</span> includes a summary of processing the IP Router Alert Option:<a href="#section-4-10" class="pilcrow">¶</a></p>
<blockquote id="section-4-11">
        In a nutshell, the IP Router Alert Option does not provide a
        convenient universal mechanism to accurately and reliably distinguish
        between IP Router Alert packets of interest and unwanted IP Router
        Alert packets.  This, in turn, creates a security concern when the IP
        Router Alert Option is used, because, short of appropriate
        router-implementation-specific mechanisms, the router slow path is at risk
        of being flooded by unwanted traffic.<a href="#section-4-11" class="pilcrow">¶</a>
</blockquote>
<p id="section-4-12">This is an example of the need to limit the resources that can
        be consumed when a particular function is executed and to avoid consuming
        Control Plane resources
        where support for a function has not been configured.<a href="#section-4-12" class="pilcrow">¶</a></p>
<p id="section-4-13">There has been research that has discussed
    the general problem with dropping packets containing IPv6 Extension
    Headers, including the Hop-by-Hop Options header.
    For example, <span>[<a href="#Hendriks" class="cite xref">Hendriks</a>]</span> states that "Dropping all
    packets that contain Extension Headers is a bad practice" and that "The share
    of traffic containing more than one EH however, is very small. For the
    design of hardware able to handle the dynamic nature of EHs, we therefore
    recommend to support at least one EH".  Operational aspects of the topics
    discussed in this section are further discussed in <span>[<a href="#I-D.ietf-v6ops-hbh" class="cite xref">HBH</a>]</span>.<a href="#section-4-13" class="pilcrow">¶</a></p>
<p id="section-4-14">"Transmission and Processing of IPv6 Extension Headers" <span>[<a href="#RFC7045" class="cite xref">RFC7045</a>]</span> clarifies how intermediate nodes should process
    Extension Headers.  This document is generally consistent with
    <span>[<a href="#RFC7045" class="cite xref">RFC7045</a>]</span> and addresses an issue that was raised for
    discussion when <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span> was updated and replaced by
    <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>. This document updates <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> as described in the next section and consequently
    clarifies the description in <span><a href="https://rfc-editor.org/rfc/rfc7045#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC7045" class="cite xref">RFC7045</a>]</span>,
    using the language of BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>.<a href="#section-4-14" class="pilcrow">¶</a></p>
<p id="section-4-15">This document defines a set of procedures for the Hop-by-Hop
    Options header that are intended to make the processing of Hop-by-Hop
    options practical in modern routers. The common cases are
    that some Hop-by-Hop options will be processed across the Internet,
    while others will only be processed within a limited domain <span>[<a href="#RFC8799" class="cite xref">RFC8799</a>]</span> (e.g., where a specific service is made available
    in that network segment that relies on one or more Hop-by-Hop
    options).<a href="#section-4-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="HBH">
<section id="section-5">
      <h2 id="name-hop-by-hop-header-processin">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-hop-by-hop-header-processin" class="section-name selfRef">Hop-by-Hop Header Processing Procedures</a>
      </h2>
<p id="section-5-1">This section describes several changes to <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>. <a href="#FAST" class="auto internal xref">Section 5.1</a> describes the processing of
    the Hop-by-Hop options Extension Header, and <a href="#ONE" class="auto internal xref">Section 5.2</a> describes
    the processing of individual Hop-by-Hop options.
    These sections update the text in paragraph 6 of
   <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4" class="relref">Section 4</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> and, as noted in <a href="#ONE" class="auto internal xref">Section 5.2</a>, modify   
   <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="FAST">
<section id="section-5.1">
        <h3 id="name-processing-the-extension-he">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-processing-the-extension-he" class="section-name selfRef">Processing the Extension Header Carrying Hop-by-Hop Options</a>
        </h3>
<p id="section-5.1-1">When a packet includes one or more Extension Headers, the Next Header
        field of the IPv6 Header identifies the type of Extension Header.
        It does not identify the transport protocol.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The Extension Header used to carry Hop-by-Hop options
       is defined in <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> and is identified
       by a Next Header value of 0 in the IPv6
        header.  <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> requires this Hop-by-Hop
        Options header to appear immediately after the IPv6 header.  <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> also requires that a Hop-by-Hop Options header
        only appear at most once in a packet.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The Hop-by-Hop Options header as defined in
        <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> can contain
        one or more Hop-by-Hop options.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Routers that process the Hop-by-Hop Options header <span class="bcp14">SHOULD</span> do
        so using the method defined in this document.
 Exceptions to this <span class="bcp14">SHOULD</span> include routers that are configured to
 drop packets with a Hop-by-Hop Options header to protect
 downstream devices that do not comply with this
 specification  (see <span>[<a href="#RFC9288" class="cite xref">RFC9288</a>]</span>).<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Even if a router does not process the Hop-by-Hop Options
        header (for example, when based on configuration), it <span class="bcp14">MUST</span> forward the
        packet normally based on the remaining Extension Header(s) after
        the Hop-by-Hop Options header.  A router <span class="bcp14">MUST NOT</span> drop a packet
        solely because it contains an Extension Header carrying
        Hop-by-Hop options.  A configuration could control whether normal
        processing skips any or all of the Hop-by-Hop options carried in
        the Hop-by-Hop Options header.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">It is expected that the Hop-by-Hop Options header will be
        processed by the destination(s).
        Hosts <span class="bcp14">SHOULD</span> process the Hop-by-Hop Options header in
        received packets.  A constrained host is an example of a node
 that does not process the Hop-by-Hop Options header.
        If a destination does not process the Hop-by-Hop Options header,
        it <span class="bcp14">MUST</span> process the remainder of the packet normally.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div id="CONFIG">
<section id="section-5.1.1">
          <h4 id="name-configuration-enabling-hop-">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-configuration-enabling-hop-" class="section-name selfRef">Configuration Enabling Hop-by-Hop Header Processing</a>
          </h4>
<p id="section-5.1.1-1"><span><a href="https://rfc-editor.org/rfc/rfc8200#section-4" class="relref">Section 4</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> allows a router to control its processing
        of IPv6 Hop-by-Hop options by local configuration.  The text is:<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<blockquote id="section-5.1.1-2">
           NOTE: While <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span> required that all nodes must examine and
           process the Hop-by-Hop Options header, it is now expected that nodes
           along the path only examine and process the
           Hop-by-Hop Options header if explicitly configured to do so.<a href="#section-5.1.1-2" class="pilcrow">¶</a>
</blockquote>
<p id="section-5.1.1-3">
  This document clarifies that a configuration could control whether
  processing skips any specific Hop-by-Hop options carried in the Hop-
  by-Hop Options header.  A router that does not process the contents
  of the Hop-by-Hop Options header does not process any of the
  Option Types contained in the Hop-by-Hop Options header.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ONE">
<section id="section-5.2">
        <h3 id="name-hop-by-hop-options-processi">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-hop-by-hop-options-processi" class="section-name selfRef">Hop-by-Hop Options Processing</a>
        </h3>
<p id="section-5.2-1">A Source creating packets with a Hop-by-Hop Options header <span class="bcp14">SHOULD</span> use
           a method that is robust to network nodes selectively processing only
           some of the Hop-by-Hop options that are included in the packet or that forward
           packets without the option(s) being processed (see <a href="#HOW" class="auto internal xref">Section 6.1</a>).
           
        A Source <span class="bcp14">MAY</span>, based on local configuration,
        allow only one Hop-by-Hop option to be included in a packet,
        or it could allow more than one Hop-by-Hop option
        but limit their size to increase the likelihood of successful
        transfer across a network path.
        Because some routers might only process one or a limited number of
        options in the Hop-by-Hop Options header, Sources are motivated to
        order the placement of Hop-by-Hop options within the Hop-by-Hop
        Options header in decreasing order of importance for their
        processing by nodes on the path.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">A router configuration needs to avoid vulnerabilities that
        arise when it cannot process the first Hop-by-Hop option at the Full
        Forwarding Rate.  Therefore, a router <span class="bcp14">SHOULD NOT</span> be configured to
        process the first Hop-by-Hop option if this adversely impacts the
        aggregate forwarding rate.  A router <span class="bcp14">SHOULD</span> process additional
        Hop-by-Hop options, if configured to do so, providing that these
        also do not adversely impact the aggregate forwarding rate.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">If a router is unable to process a specific Hop-by-Hop option
        (or is not configured to do so), it
        <span class="bcp14">SHOULD</span> behave in the same way specified for an unrecognized Option Type when the
        action bits are set to "00", and it
        <span class="bcp14">SHOULD</span> skip the remaining options
        using the "Hdr Ext Len" field in the
        Hop-by-Hop Options header.  This field specifies the length of the Options
        Header in 8-octet units.  After skipping an option, the router continues
        processing the remaining options in the header.
        Skipped options do not need to be verified.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The Router
        Alert Option <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span> is an exception
        to this because it is designed to tell a router
 that the packet needs additional processing, which is usually done
        in the Control Plane; see <a href="#RTRALERT" class="auto internal xref">Section 5.2.1</a>.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5"><span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>
        defines the Option Type identifiers as internally encoded such that their
        highest-order 2 bits specify the action that must be taken if the
        processing IPv6 node does not recognize the Option Type. The text is:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>
   00 - skip over this option and continue processing the header.

   01 - discard the packet.

   10 - discard the packet and, regardless of whether or not the
        packet's Destination Address was a multicast address,
        send an ICMP Parameter Problem, Code 2, message to the
        packet's Source Address, pointing to the unrecognized
        Option Type.

   11 - discard the packet and, only if the packet's Destination
        Address was not a multicast address, send an ICMP Parameter
        Problem, Code 2, message to the packet's Source Address,
        pointing to the unrecognized Option Type.
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2-7">This document modifies this behavior for the "01", "10", and
 "11" action bits so that if a router is unable to process a specific Hop-by-Hop option
        (or is not configured to do so), it <span class="bcp14">SHOULD</span> behave in the same way
 specified for an unrecognized Option Type when the 
        action bits are set to "00".
            
        It also modifies the behavior for values "10" and "11" in the case where 
        the packet is discarded and the
        node <span class="bcp14">MAY</span> send an ICMP Parameter Problem, Code 2 <span>[<a href="#RFC4443" class="cite xref">RFC4443</a>]</span>,
 message to the packet's Source Address, pointing to the unrecognized Option Type.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">The modified text for values "01", "10", and "11" is:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-9">
<pre>
   01 - MAY discard the packet, if so configured. Nodes should not
        rely on routers dropping these unrecognized Option Types.

   10 - MAY discard the packet, if so configured, regardless of
        whether or not the packet's Destination Address was a
        multicast address. If the packet was discarded, an ICMP
        Parameter Problem, Code 2, message MAY be sent to the
        packet's Source Address, pointing to the unrecognized
        Option Type.

   11 - MAY discard the packet, if so configured. If the packet
        was discarded and the packet's Destination Address was
        not a multicast address, an ICMP Parameter Problem,
        Code 2, message MAY be sent to the packet's Source
        Address, pointing to the unrecognized Option Type.
</pre><a href="#section-5.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.2-10">When an ICMP Parameter Problem, Code 2, message is delivered to the
        Source, it
 indicates that at least one node on the
        path has failed to recognize the option <span>[<a href="#RFC4443" class="cite xref">RFC4443</a>]</span>.
        Generating any ICMP message
        incurs additional router processing.
        Reception of this message is
        not guaranteed;
        routers might be unable to be configured so that they do not generate
        these messages, 
 and they are not always forwarded to the Source.
        The motivation here is to loosen
        the requirement to send an ICMPv6 Parameter Problem message when a router
        forwards a packet without processing the list of all options.<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<div id="RTRALERT">
<section id="section-5.2.1">
          <h4 id="name-router-alert-option">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-router-alert-option" class="section-name selfRef">Router Alert Option</a>
          </h4>
<p id="section-5.2.1-1">The purpose of the Router Alert Option <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span> is to tell
        a router that the packet needs additional processing in the Control Plane.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">The Router Alert Option includes a two-octet Value field that
        describes the protocol that is carried in the packet.
 The
 current specified values can 
        be found in the "IPv6 Router Alert Option Values" IANA registry <span>[<a href="#IANA-RA" class="cite xref">IANA-RA</a>]</span>.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">DISCUSSION<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p style="margin-left: 1.5em" id="section-5.2.1-4">The function of a Router Alert Option can result in the processing
 that this specification is proposing to eliminate, that is,
 instructing a router to process the packet in the Control Plane.
 This processing causes concerns, which are discussed in <a href="#BACKGROUND" class="auto internal xref">Section 4</a>.
 One approach would be to deprecate this, because current usage 
 beyond the local network appears to be limited, and packets containing 
 Hop-by-Hop options are frequently dropped. Deprecation would allow 
 current implementations to continue, and its use could be phased out 
 over time.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p style="margin-left: 1.5em" id="section-5.2.1-5">The Router Alert Option could potentially be used with new
 functions that have to be processed in the Control Plane.  Keeping
 this as the single exception for processing in the Control Plane
 with the restrictions that follow is a reasonable compromise to
 allow future flexibility.  These restrictions are compatible 
 with <span><a href="https://rfc-editor.org/rfc/rfc6398#section-5" class="relref">Section 5</a> of [<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<p id="section-5.2.1-6">
        As noted in <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>, 
        "Implementations of the IP Router Alert Option
        <span class="bcp14">SHOULD</span> offer the configuration option to simply ignore the presence
        of 'IP Router Alert' in IPv4 and IPv6 packets."<a href="#section-5.2.1-6" class="pilcrow">¶</a></p>
<p id="section-5.2.1-7">A node that is configured to process a Router Alert Option
        <span class="bcp14">MUST</span> protect itself from an infrastructure attack
        that could result from processing in the Control Plane. This might include
        some combination of an access control list to only permit access from trusted nodes,
        rate limiting of processing, or other methods <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>.<a href="#section-5.2.1-7" class="pilcrow">¶</a></p>
<p id="section-5.2.1-8">As specified in <span>[<a href="#RFC2711" class="cite xref">RFC2711</a>]</span>, the top two bits of the Option Type
        for the Router Alert Option are always set to "00", indicating that the node
        should skip over this option as if it does not recognize the Option
 Type and continue processing the header.
        An implementation that does recognize the Router Alert Option
 <span class="bcp14">SHOULD</span> verify that the Router Alert Option contains a
        protocol, as indicated by the Value field in the Router Alert Option,
        that is configured as a protocol of interest to that
        router.  A verified packet <span class="bcp14">SHOULD</span> be sent to the Control Plane for further processing
        <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>.  Otherwise, the router implementation <span class="bcp14">SHOULD</span> forward
        this packet subject to all normal policies and forwarding rules.<a href="#section-5.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CONFIG2">
<section id="section-5.2.2">
          <h4 id="name-configuration-of-hop-by-hop">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-configuration-of-hop-by-hop" class="section-name selfRef">Configuration of Hop-by-Hop Options Processing</a>
          </h4>
<p id="section-5.2.2-1">A router can be configured to process a specific Option.  The set
      of enabled options <span class="bcp14">SHOULD</span> be configurable by the operator of the
      router.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">A possible approach to implementing this is to maintain a lookup
      table based on an Option Type of the IPv6 options that can be
      processed at the Full Forwarding Rate.  This would allow a router to
      quickly determine if an option is supported and can be processed.
      If the option is not supported, then the router processes the
      option as described in <a href="#FAST" class="auto internal xref">Section 5.1</a> of this document.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">The actions of the lookup table should be configurable by the operator of
    the router.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="NEW">
<section id="section-6">
      <h2 id="name-defining-new-hop-by-hop-opt">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-defining-new-hop-by-hop-opt" class="section-name selfRef">Defining New Hop-by-Hop Options</a>
      </h2>
<p id="section-6-1">This section updates <span><a href="https://rfc-editor.org/rfc/rfc8200#section-4.8" class="relref">Section 4.8</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Any future new IPv6 Hop-by-Hop options should be designed to
    be processed at the Full Forwarding Rate and should have the following characteristics:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">New Hop-by-Hop options should
        be designed to ensure the router can process the options at the Full
        Forwarding Rate. That is, they should be simple to process.<a href="#section-6-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.2">New Hop-by-Hop options should be defined with the Action type (highest-order 2
        bits of the Option Type) set to "00", which enables skipping over this option
 and continuing with the processing of the header if a router does not recognize
 the option.<a href="#section-6-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.3">The size of Hop-by-Hop options should not extend beyond what can be
        expected to be executed at the Full Forwarding Rate.  A larger Hop-by-Hop
        Options header can increase the likelihood that a packet will be
        dropped <span>[<a href="#Cus23b" class="cite xref">Cus23b</a>]</span>.<a href="#section-6-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.4">New Hop-by-Hop options should be designed with the expectation that a router
        might be configured to only process a subset of Hop-by-Hop options (e.g., the first option) in the
        Hop-by-Hop Options header.<a href="#section-6-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.5">The design of protocols that use new Hop-by-Hop options should consider
        that a router may drop packets containing the new Hop-by-Hop option.<a href="#section-6-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-4">If a new Hop-by-Hop option does not meet
    these criteria, its specification must include a detailed
    explanation why that is the case and show that there
    is a reasonable expectation that the option can still proceed at the Full
    Forwarding Rate.  This is consistent with [RFC6564].
    This is consistent with <span>[<a href="#RFC6564" class="cite xref">RFC6564</a>]</span>.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The general issue of robust operation of packets with new
    Hop-by-Hop options is described in <a href="#HOW" class="auto internal xref">Section 6.1</a>.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="HOW">
<section id="section-6.1">
        <h3 id="name-example-of-robust-usage">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-example-of-robust-usage" class="section-name selfRef">Example of Robust Usage</a>
        </h3>
<p id="section-6.1-1">Recent measurement
        surveys (e.g., <span>[<a href="#Cus23a" class="cite xref">Cus23a</a>]</span>)
        show that packets that include Extension Headers can cause the packets to
        be dropped by some
        Internet paths. In a limited domain, routers can be configured or updated
        to provide support for any required Hop-by-Hop options.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The primary motivation of this document is to make it
        more practical to use Hop-by-Hop options beyond such a limited domain, with the
        expectation that applications can improve the
        quality of or add new features to their offered service when
        the path successfully forwards packets with the required Hop-by-Hop options
        and otherwise refrains from using these options.
        The focus is on incremental deployability.

        A protocol feature (such as using Hop-by-Hop options) is incrementally
        deployable if early adopters gain some
        benefit on the paths being used, even though other paths do not support the
        protocol feature.
 A Source ought to order the Hop-by-Hop options that are carried
 in the Hop-by-Hop Options header in decreasing order of
        importance for processing by nodes on the path.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Methods can be developed that do not rely upon all routers
        to implement a specific Hop-by-Hop option (e.g., <span>[<a href="#RFC9268" class="cite xref">RFC9268</a>]</span>)
        and that are robust when the
        current path drops packets that contain a Hop-by-Hop option (e.g.,
        <span>[<a href="#RFC9098" class="cite xref">RFC9098</a>]</span>).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">For example, an application can be designed to first send
        a test packet that includes the required option or combination
        of options and then send other packets without including
        the option. The application does not send additional
        packets that include this option (or set of options) until the
        test packet(s) is acknowledged.
        The need for potential loss recovery when a path drops
        these test packets can be avoided by choosing packets that do not
        carry application data that needs to be reliably delivered.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Since the set of nodes forming a path can change with time,
        this discovery process ought to be repeated from time to time.
        The process of sending packets both with and without a specific
        header to discover whether a path can support a specific header
        is sometimes called "racing". Transport protocol racing
        is explained in <span>[<a href="#I-D.ietf-taps-arch" class="cite xref">TAPS-ARCH</a>]</span>,
        and A/B protocol feature testing is described in <span>[<a href="#Tram17" class="cite xref">Tram17</a>]</span>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document updates the processing of
        Hop-by-Hop options.
        IANA has added this document as an
        additional reference for the "Destination Options and Hop-by-Hop Options" registry
        in the "Internet Protocol Version 6 (IPv6) Parameters" registry group <span>[<a href="#IANA-HBH" class="cite xref">IANA-HBH</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">Security issues caused by including IPv6 Hop-by-Hop options are well known and have
    been documented in several places, including
    <span>[<a href="#RFC6398" class="cite xref">RFC6398</a>]</span>,
    <span>[<a href="#RFC6192" class="cite xref">RFC6192</a>]</span>, <span>[<a href="#RFC7045" class="cite xref">RFC7045</a>]</span>, and
    <span>[<a href="#RFC9098" class="cite xref">RFC9098</a>]</span>.
    The main issue, as noted in <a href="#BACKGROUND" class="auto internal xref">Section 4</a>, is that
    any mechanism that can be used to force packets into the
    router's Control Plane or Slow Path can be exploited as a DoS attack on a
    router by saturating the resources needed for router management
    (routing protocols, network management protocols, etc.), and this can
    cause the router to fail or perform suboptimally.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">While Hop-by-Hop options are not required to be processed in the
    Control Plane, the Router Alert Option is the one exception that is designed
    to be processed in the Control Plane.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Some IPv6 nodes implement features that access more of the protocol
    information than a typical IPv6 router (e.g., <span>[<a href="#RFC9098" class="cite xref">RFC9098</a>]</span>).
    Examples are nodes that provide
    DoS mitigation, firewall/access control, traffic engineering,
    or traffic normalization. These nodes
    could be configured to drop packets when they are unable to access
    and process all Extension Headers or are unable to locate and process
    the higher-layer packet information. This document provides guidance
    on the requirements concerning Hop-by-Hop options.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4"> Finally, this document notes that Internet protocol processing needs to be robust for
    malformed/malicious protocol fields.

    For example, a packet with an
    excessive number of options could consume significant resources;
    inclusion of a large Extension Header could potentially cause an
    on-path router to be unable to utilize hardware optimizations
    to process later headers (e.g., to perform equal cost multipath
    forwarding or port filtering).
    
    This requirement is not specific to
    Hop-by-Hop options. It is important that implementations
    fail gracefully when a malformed or malicious Hop-by-Hop option is encountered.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">This document changes how the Hop-by-Hop Options header is processed,
    which significantly reduces the attack surface.  These changes include the following:<a href="#section-8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-6.1">A router configuration needs to avoid vulnerabilities that
            arise when it cannot process a Hop-by-Hop option at the Full
            Forwarding Rate; therefore, it <span class="bcp14">SHOULD NOT</span> be configured to
            process the Hop-by-Hop option if it adversely impacts the
            aggregate forwarding rate. Instead, it
            <span class="bcp14">SHOULD</span> behave in the same way specified for an unrecognized Option Type when the
            action bits are set to "00", as specified in <a href="#ONE" class="auto internal xref">Section 5.2</a>.<a href="#section-8-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.2">This document adds criteria for the Router Alert Option (<a href="#RTRALERT" class="auto internal xref">Section 5.2.1</a>)
        to allow control over how it is
        processed and describes how a node configured to support these options must
        protect itself from attacks by using the Router Alert Option.<a href="#section-8-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.3">This document sets the expectation that if a packet
        includes a Hop-by-Hop Options header, the packet will be forwarded across the network path.<a href="#section-8-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.4">A Source <span class="bcp14">MAY</span> include a single Hop-by-Hop option (based on
        local configuration) or <span class="bcp14">MAY</span> be configured to include more
        Hop-by-Hop options. The configuration of intermediate nodes determines
    whether a node processes any of these options, and if so, which ones and how many.<a href="#section-8-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.5">This document adds guidance for the design of
        any future new Hop-by-Hop option that reduces the
        computational requirements and encourages a
        limit to their size.<a href="#section-8-6.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-7">The intent of this document is to highlight that these changes significantly reduce the
    security issues relating to processing the IPv6 Hop-by-Hop Options header
    and enable Hop-by-Hop options to be safely used in the Internet.<a href="#section-8-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="IANA-HBH">[IANA-HBH]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Destination Options and Hop-by-Hop Options"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipv6-parameters/">https://www.iana.org/assignments/ipv6-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
    <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10">
      <h2 id="name-informative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="Cus23a">[Cus23a]</dt>
      <dd>
<span class="refAuthor">Custura, A.</span> and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"Internet Measurements: IPv6 Extension Header Edition"</span>, <span class="refContent">IEPG Meeting: IETF 116</span>, <time datetime="2023-03" class="refDate">March 2023</time>, <span>&lt;<a href="http://www.iepg.org/2023-03-26-ietf116/eh.pdf">http://www.iepg.org/2023-03-26-ietf116/eh.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cus23b">[Cus23b]</dt>
      <dd>
<span class="refAuthor">Custura, A.</span>, <span class="refAuthor">Secchi, R.</span>, <span class="refAuthor">Boswell, E.</span>, and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"Is it possible to extend IPv6?"</span>, <span class="refContent">Computer Communications, vol. 214, pp. 90-99</span>, <span class="seriesInfo">DOI 10.1016/j.comcom.2023.10.006</span>, <time datetime="2024-01" class="refDate">January 2024</time>, <span>&lt;<a href="https://www.sciencedirect.com/science/article/pii/S0140366423003705">https://www.sciencedirect.com/science/article/pii/S0140366423003705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-v6ops-hbh">[HBH]</dt>
      <dd>
<span class="refAuthor">Peng, S.</span>, <span class="refAuthor">Li, Z.</span>, <span class="refAuthor">Xie, C.</span>, <span class="refAuthor">Qin, Z.</span>, and <span class="refAuthor">G. S. Mishra</span>, <span class="refTitle">"Operational Issues with Processing of the Hop-by-Hop Options Header"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-v6ops-hbh-10</span>, <time datetime="2024-02-16" class="refDate">16 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-v6ops-hbh-10">https://datatracker.ietf.org/doc/html/draft-ietf-v6ops-hbh-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Hendriks">[Hendriks]</dt>
      <dd>
<span class="refAuthor">Hendriks, L.</span>, <span class="refAuthor">Velan, P.</span>, <span class="refAuthor">Schmidt, RO.</span>, <span class="refAuthor">Boer, P.</span>, and <span class="refAuthor">A. Aiko</span>, <span class="refTitle">"Threats and Surprises behind IPv6 Extension Headers"</span>, <span class="refContent">2017 Network Traffic Measurement and Analysis Conference (TMA)</span>, <span class="seriesInfo">DOI 10.23919/TMA.2017.8002912</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="http://dl.ifip.org/db/conf/tma/tma2017/tma2017_paper22.pdf">http://dl.ifip.org/db/conf/tma/tma2017/tma2017_paper22.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-RA">[IANA-RA]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IPv6 Router Alert Option Values"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipv6-routeralert-values/">https://www.iana.org/assignments/ipv6-routeralert-values/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1883">[RFC1883]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 1883</span>, <span class="seriesInfo">DOI 10.17487/RFC1883</span>, <time datetime="1995-12" class="refDate">December 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1883">https://www.rfc-editor.org/info/rfc1883</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2460">[RFC2460]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2460">https://www.rfc-editor.org/info/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2711">[RFC2711]</dt>
      <dd>
<span class="refAuthor">Partridge, C.</span> and <span class="refAuthor">A. Jackson</span>, <span class="refTitle">"IPv6 Router Alert Option"</span>, <span class="seriesInfo">RFC 2711</span>, <span class="seriesInfo">DOI 10.17487/RFC2711</span>, <time datetime="1999-10" class="refDate">October 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2711">https://www.rfc-editor.org/info/rfc2711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
      <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6192">[RFC6192]</dt>
      <dd>
<span class="refAuthor">Dugal, D.</span>, <span class="refAuthor">Pignataro, C.</span>, and <span class="refAuthor">R. Dunn</span>, <span class="refTitle">"Protecting the Router Control Plane"</span>, <span class="seriesInfo">RFC 6192</span>, <span class="seriesInfo">DOI 10.17487/RFC6192</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6192">https://www.rfc-editor.org/info/rfc6192</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6398">[RFC6398]</dt>
      <dd>
<span class="refAuthor">Le Faucheur, F., Ed.</span>, <span class="refTitle">"IP Router Alert Considerations and Usage"</span>, <span class="seriesInfo">BCP 168</span>, <span class="seriesInfo">RFC 6398</span>, <span class="seriesInfo">DOI 10.17487/RFC6398</span>, <time datetime="2011-10" class="refDate">October 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6398">https://www.rfc-editor.org/info/rfc6398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6564">[RFC6564]</dt>
      <dd>
<span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Woodyatt, J.</span>, <span class="refAuthor">Kline, E.</span>, <span class="refAuthor">Hoagland, J.</span>, and <span class="refAuthor">M. Bhatia</span>, <span class="refTitle">"A Uniform Format for IPv6 Extension Headers"</span>, <span class="seriesInfo">RFC 6564</span>, <span class="seriesInfo">DOI 10.17487/RFC6564</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6564">https://www.rfc-editor.org/info/rfc6564</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7045">[RFC7045]</dt>
      <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Jiang</span>, <span class="refTitle">"Transmission and Processing of IPv6 Extension Headers"</span>, <span class="seriesInfo">RFC 7045</span>, <span class="seriesInfo">DOI 10.17487/RFC7045</span>, <time datetime="2013-12" class="refDate">December 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7045">https://www.rfc-editor.org/info/rfc7045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7872">[RFC7872]</dt>
      <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Linkova, J.</span>, <span class="refAuthor">Chown, T.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Observations on the Dropping of Packets with IPv6 Extension Headers in the Real World"</span>, <span class="seriesInfo">RFC 7872</span>, <span class="seriesInfo">DOI 10.17487/RFC7872</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7872">https://www.rfc-editor.org/info/rfc7872</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8799">[RFC8799]</dt>
      <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">B. Liu</span>, <span class="refTitle">"Limited Domains and Internet Protocols"</span>, <span class="seriesInfo">RFC 8799</span>, <span class="seriesInfo">DOI 10.17487/RFC8799</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8799">https://www.rfc-editor.org/info/rfc8799</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9098">[RFC9098]</dt>
      <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Hilliard, N.</span>, <span class="refAuthor">Doering, G.</span>, <span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Huston, G.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Operational Implications of IPv6 Packets with Extension Headers"</span>, <span class="seriesInfo">RFC 9098</span>, <span class="seriesInfo">DOI 10.17487/RFC9098</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9098">https://www.rfc-editor.org/info/rfc9098</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9268">[RFC9268]</dt>
      <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"IPv6 Minimum Path MTU Hop-by-Hop Option"</span>, <span class="seriesInfo">RFC 9268</span>, <span class="seriesInfo">DOI 10.17487/RFC9268</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9268">https://www.rfc-editor.org/info/rfc9268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9288">[RFC9288]</dt>
      <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Recommendations on the Filtering of IPv6 Packets Containing IPv6 Extension Headers at Transit Routers"</span>, <span class="seriesInfo">RFC 9288</span>, <span class="seriesInfo">DOI 10.17487/RFC9288</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9288">https://www.rfc-editor.org/info/rfc9288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-taps-arch">[TAPS-ARCH]</dt>
      <dd>
<span class="refAuthor">Pauly, T., Ed.</span>, <span class="refAuthor">Trammell, B., Ed.</span>, <span class="refAuthor">Brunstrom, A.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Architecture and Requirements for Transport Services"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-taps-arch-19</span>, <time datetime="2023-11-09" class="refDate">9 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-taps-arch-19">https://datatracker.ietf.org/doc/html/draft-ietf-taps-arch-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Tram17">[Tram17]</dt>
    <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Kühlewind, M.</span>, <span class="refAuthor">De Vaere, P.</span>, <span class="refAuthor">Learmonth, I.</span>, and <span class="refAuthor">G. Fairhurst</span>, <span class="refTitle">"Tracking Transport-Layer Evolution with PATHspider"</span>, <span class="refContent">ANRW '17: Proceedings of the 2017 Applied Networking Research Workshop</span>, <span class="seriesInfo">DOI 10.1145/3106328.3106336</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://irtf.org/anrw/2017/anrw17-final16.pdf">https://irtf.org/anrw/2017/anrw17-final16.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="Ack">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Helpful comments were received from <span class="contact-name">Brian     Carpenter</span>, <span class="contact-name">Ron Bonica</span>, <span class="contact-name">Ole     Troan</span>, <span class="contact-name">Mike Heard</span>, <span class="contact-name">Tom     Herbert</span>, <span class="contact-name">Cheng Li</span>, <span class="contact-name">Éric     Vyncke</span>, <span class="contact-name">Greg Mirsky</span>, <span class="contact-name">Xiao     Min</span>, <span class="contact-name">Fernando Gont</span>, <span class="contact-name">Darren     Dukes</span>, <span class="contact-name">Peng Shuping</span>, <span class="contact-name">Dave     Thaler</span>, <span class="contact-name">Ana Custura</span>, <span class="contact-name">Tim     Winters</span>, <span class="contact-name">Jingrong Xie</span>, <span class="contact-name">Lorenzo     Colitti</span>, <span class="contact-name">Toerless Eckert</span>, <span class="contact-name">Suresh Krishnan</span>, <span class="contact-name">Mikael Abrahamsson</span>,
    <span class="contact-name">Adrian Farrel</span>, <span class="contact-name">Jie Dong</span>,
    <span class="contact-name">Jen Linkova</span>, <span class="contact-name">Erik Kline</span>, and
    other members of the 6MAN Working Group.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert M. Hinden</span></div>
<div dir="auto" class="left"><span class="org">Check Point Software</span></div>
<div dir="auto" class="left"><span class="street-address">100 Oracle Parkway, Suite 800</span></div>
<div dir="auto" class="left">
<span class="locality">Redwood City</span>, <span class="region">CA</span> <span class="postal-code">94065</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bob.hinden@gmail.com" class="email">bob.hinden@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Godred Fairhurst</span></div>
<div dir="auto" class="left"><span class="org">University of Aberdeen</span></div>
<div dir="auto" class="left"><span class="street-address">School of Engineering<br>Fraser Noble Building</span></div>
<div dir="auto" class="left"><span class="locality">Aberdeen</span></div>
<div dir="auto" class="left"><span class="postal-code">AB24 3UE</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gorry@erg.abdn.ac.uk" class="email">gorry@erg.abdn.ac.uk</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
