<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9800: Compressed SRv6 Segment List Encoding</title>
<meta content="Weiqiang Cheng" name="author">
<meta content="Clarence Filsfils" name="author">
<meta content="Zhenbin Li" name="author">
<meta content="Bruno Decraene" name="author">
<meta content="Francois Clad" name="author">
<meta content="
       Segment Routing over IPv6 (SRv6) is the instantiation of Segment Routing (SR) on the IPv6 data plane. This document specifies new flavors for the SRv6 endpoint behaviors defined in RFC 8986, which enable the compression of an SRv6 segment list. Such compression significantly reduces the size of the SRv6 encapsulation needed to steer packets over long segment lists. 
       This document updates RFC 8754 by allowing a Segment List entry in the Segment Routing Header (SRH) to be either an IPv6 address, as specified in RFC 8754, or a REPLACE-CSID container in packed format, as specified in this document. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="Segment Routing" name="keyword">
<meta content="IPv6 Segment Routing" name="keyword">
<meta content="Compressed SID" name="keyword">
<meta content="CSID" name="keyword">
<meta content="NEXT-CSID" name="keyword">
<meta content="REPLACE-SID" name="keyword">
<meta content="SRH Compression" name="keyword">
<meta content="9800" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9800.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-spring-srv6-srh-compression-23" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9800" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9800</td>
<td class="center">Compressed SRv6 Segment List Encoding</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Cheng, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9800" class="eref">9800</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8754" class="eref">8754</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06" class="published">June 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Cheng, <span class="editor">Ed.</span>
</div>
<div class="org">China Mobile</div>
</div>
<div class="author">
      <div class="author-name">C. Filsfils</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">Z. Li</div>
<div class="org">Huawei Technologies</div>
</div>
<div class="author">
      <div class="author-name">B. Decraene</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">F. Clad, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9800</h1>
<h1 id="title">Compressed SRv6 Segment List Encoding</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Segment Routing over IPv6 (SRv6) is the instantiation of Segment Routing (SR) on the IPv6 data plane. This document specifies new flavors for the SRv6 endpoint behaviors defined in RFC 8986, which enable the compression of an SRv6 segment list. Such compression significantly reduces the size of the SRv6 encapsulation needed to steer packets over long segment lists.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document updates RFC 8754 by allowing a Segment List entry in the Segment Routing Header (SRH) to be either an IPv6 address, as specified in RFC 8754, or a REPLACE-CSID container in packed format, as specified in this document.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9800">https://www.rfc-editor.org/info/rfc9800</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-basic-concepts" class="internal xref">Basic Concepts</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-sr-segment-endpoint-flavors" class="internal xref">SR Segment Endpoint Flavors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-next-csid-flavor" class="internal xref">NEXT-CSID Flavor</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-end-with-next-csid" class="internal xref">End with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-endx-with-next-csid" class="internal xref">End.X with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-endt-with-next-csid" class="internal xref">End.T with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.4">
                    <p id="section-toc.1-1.4.2.1.2.4.1"><a href="#section-4.1.4" class="auto internal xref">4.1.4</a>.  <a href="#name-endb6encaps-with-next-csid" class="internal xref">End.B6.Encaps with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.5">
                    <p id="section-toc.1-1.4.2.1.2.5.1"><a href="#section-4.1.5" class="auto internal xref">4.1.5</a>.  <a href="#name-endb6encapsred-with-next-cs" class="internal xref">End.B6.Encaps.Red with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.6">
                    <p id="section-toc.1-1.4.2.1.2.6.1"><a href="#section-4.1.6" class="auto internal xref">4.1.6</a>.  <a href="#name-endbm-with-next-csid" class="internal xref">End.BM with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.7">
                    <p id="section-toc.1-1.4.2.1.2.7.1"><a href="#section-4.1.7" class="auto internal xref">4.1.7</a>.  <a href="#name-combination-with-psp-usp-an" class="internal xref">Combination with PSP, USP, and USD Flavors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-replace-csid-flavor" class="internal xref">REPLACE-CSID Flavor</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-end-with-replace-csid" class="internal xref">End with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-endx-with-replace-csid" class="internal xref">End.X with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-endt-with-replace-csid" class="internal xref">End.T with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-endb6encaps-with-replace-cs" class="internal xref">End.B6.Encaps with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="auto internal xref">4.2.5</a>.  <a href="#name-endb6encapsred-with-replace" class="internal xref">End.B6.Encaps.Red with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a href="#section-4.2.6" class="auto internal xref">4.2.6</a>.  <a href="#name-endbm-with-replace-csid" class="internal xref">End.BM with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.7">
                    <p id="section-toc.1-1.4.2.2.2.7.1"><a href="#section-4.2.7" class="auto internal xref">4.2.7</a>.  <a href="#name-enddx-and-enddt-with-replac" class="internal xref">End.DX and End.DT with REPLACE-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.8">
                    <p id="section-toc.1-1.4.2.2.2.8.1"><a href="#section-4.2.8" class="auto internal xref">4.2.8</a>.  <a href="#name-combination-with-psp-usp-and" class="internal xref">Combination with PSP, USP, and USD Flavors</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-csid-allocation" class="internal xref">CSID Allocation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-global-csid" class="internal xref">Global CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-local-csid" class="internal xref">Local CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-recommended-installation-of" class="internal xref">Recommended Installation of CSIDs in FIB</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-sr-source-node" class="internal xref">SR Source Node</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-sid-validation-for-compress" class="internal xref">SID Validation for Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-segment-list-compression" class="internal xref">Segment List Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-rules-for-segment-lists-con" class="internal xref">Rules for Segment Lists Containing NEXT-CSID Flavor SIDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-rules-for-segment-lists-cont" class="internal xref">Rules for Segment Lists Containing REPLACE-CSID Flavor SIDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-upper-layer-checksums" class="internal xref">Upper-Layer Checksums</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-inter-domain-compression" class="internal xref">Inter-Domain Compression</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-endlbs-locator-block-swap" class="internal xref">End.LBS: Locator-Block Swap</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-endlbs-with-next-csid" class="internal xref">End.LBS with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-endlbs-with-replace-csid" class="internal xref">End.LBS with REPLACE-CSID</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-endxlbs-l3-cross-connect-an" class="internal xref">End.XLBS: L3 Cross-Connect and Locator-Block Swap</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-endxlbs-with-next-csid" class="internal xref">End.XLBS with NEXT-CSID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-endxlbs-with-replace-csid" class="internal xref">End.XLBS with REPLACE-CSID</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-control-plane" class="internal xref">Control Plane</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-flavor-block-and-csid-lengt" class="internal xref">Flavor, Block, and CSID Length</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-gib-lib-usage" class="internal xref">GIB/LIB Usage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-pinging-a-sid" class="internal xref">Pinging a SID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-icmp-error-processing" class="internal xref">ICMP Error Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-applicability-to-other-srv6" class="internal xref">Applicability to Other SRv6 Endpoint Behaviors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-srv6-endpoint-behaviors" class="internal xref">SRv6 Endpoint Behaviors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-complete-pseudocodes" class="internal xref">Complete Pseudocodes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-end-with-next-csid-2" class="internal xref">End with NEXT-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-endx-with-next-csid-2" class="internal xref">End.X with NEXT-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-endt-with-next-csid-2" class="internal xref">End.T with NEXT-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-endb6encaps-with-next-csid-2" class="internal xref">End.B6.Encaps with NEXT-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-endbm-with-next-csid-2" class="internal xref">End.BM with NEXT-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-end-with-replace-csid-2" class="internal xref">End with REPLACE-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#appendix-A.7" class="auto internal xref">A.7</a>.  <a href="#name-endx-with-replace-csid-2" class="internal xref">End.X with REPLACE-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#appendix-A.8" class="auto internal xref">A.8</a>.  <a href="#name-endt-with-replace-csid-2" class="internal xref">End.T with REPLACE-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.9">
                <p id="section-toc.1-1.14.2.9.1"><a href="#appendix-A.9" class="auto internal xref">A.9</a>.  <a href="#name-endb6encaps-with-replace-csi" class="internal xref">End.B6.Encaps with REPLACE-CSID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.10">
                <p id="section-toc.1-1.14.2.10.1"><a href="#appendix-A.10" class="auto internal xref">A.10</a>. <a href="#name-endbm-with-replace-csid-2" class="internal xref">End.BM with REPLACE-CSID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Segment Routing (SR) architecture <span>[<a href="#RFC8402" class="cite xref">RFC8402</a>]</span> describes two data plane instantiations of SR: SR over MPLS (SR-MPLS) and SR over IPv6 (SRv6).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">SRv6 Network Programming <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> builds upon the IPv6 Segment Routing Header (SRH) <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> to define a framework for constructing a network program with topological and service segments.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Some SRv6 applications, such as strict path traffic engineering, may require long segment lists. Compressing the encoding of these long segment lists in the packet header can significantly reduce the header size. This document specifies new flavors to the SRv6 endpoint behaviors defined in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> that enable a compressed encoding of the SRv6 segment list.
This document also specifies new SRv6 endpoint behaviors to preserve the compression efficiency in multi-domain environments.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The SRv6 endpoint behaviors defined in this document leverage the SRv6 data plane defined in <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> and <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>; the behaviors are compatible with the SRv6 control plane extensions for IS-IS <span>[<a href="#RFC9352" class="cite xref">RFC9352</a>]</span>, OSPF <span>[<a href="#RFC9513" class="cite xref">RFC9513</a>]</span>, and BGP <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document updates <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> by allowing a Segment List entry in the SRH to be either an IPv6 address, as specified in <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>, or a REPLACE-CSID container in packed format, as specified in <a href="#sec-replace" class="auto internal xref">Section 4.2</a>.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This document leverages the terms defined in <span>[<a href="#RFC8402" class="cite xref">RFC8402</a>]</span>, <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>, and <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>, in particular segment, segment list, Segment Identifier (SID), SID list, SR policy, prefix segment, adjacency segment, SRH, SR domain, SR source node, SR segment endpoint node, transit node, SRv6 endpoint behavior, flavor, SID block, locator, function, and argument. The reader is assumed to be familiar with this terminology.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document introduces the following new terms:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Locator-Block:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">The most significant bits of a SID locator
        that represent the SRv6 SID block. The Locator-Block is referred to as
        "B" in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Locator-Node:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">The least significant bits of a SID locator
        that identify the SR segment endpoint node instantiating the SID. The
        Locator-Node is referred to as "N" in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Compressed-SID (CSID):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">A compressed encoding of a SID. The
        CSID includes the Locator-Node and Function bits of the SID being
        compressed. If either constituent of the SID is empty (zero length),
        then the same applies to its CSID encoding.<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">CSID container:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">A 128-bit IPv6 address that functions as a
        container holding a list of one or more CSIDs and the Argument (if
        any) of the last CSID.<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">CSID sequence:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">A group of one or more consecutive SID list
        entries encoding the common Locator-Block and at least one CSID
        container.<a href="#section-2-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Compressed SID list:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">A segment list encoding that reduces
        the packet header length thanks to one or more CSID sequences. A
        compressed SID list also contains zero, one, or more uncompressed
        SIDs.<a href="#section-2-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Global Identifiers Block (GIB):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.14">The pool of CSID values
        available for global allocation.<a href="#section-2-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">Local Identifiers Block (LIB):</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.16">The pool of CSID values
        available for local allocation.<a href="#section-2-3.16" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">In this document, the length of each constituent part of a SID is referred to as follows:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">
          <p id="section-2-5.1.1">LBL is the Locator-Block length of the SID.<a href="#section-2-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-5.2">
          <p id="section-2-5.2.1">LNL is the Locator-Node length of the SID.<a href="#section-2-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-5.3">
          <p id="section-2-5.3.1">FL is the Function length of the SID.<a href="#section-2-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-5.4">
          <p id="section-2-5.4.1">AL is the Argument length of the SID.<a href="#section-2-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-6">In addition, the Locator-Node and Function length (LNFL) is the sum of the LNL and the FL of the SID. It is also referred to as the "CSID length".<a href="#section-2-6" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="basic-concepts">
<section id="section-3">
      <h2 id="name-basic-concepts">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-basic-concepts" class="section-name selfRef">Basic Concepts</a>
      </h2>
<p id="section-3-1">In an SR domain, all SRv6 SIDs instantiated from the same Locator-Block share the same most significant bits. In addition, when the combined length of the SRv6 SID Locator, Function, and Argument is smaller than 128 bits, the least significant bits of the SID are padded with zeros.
The compressed segment list encoding seeks to decrease the packet header length by avoiding the repetition of the same Locator-Block and reducing the use of padding bits.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Building upon, and fully compatible with the mechanisms specified in <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> and <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>, the compressed segment list encoding leverages a SID list compression logic at the SR source node (see <a href="#sec-source-node" class="auto internal xref">Section 6</a>) in combination with new flavors of the SRv6 endpoint behaviors that process the compressed SID list (see <a href="#sec-endpoint" class="auto internal xref">Section 4</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">An SR source node constructs and compresses the SID list depending on the SIDs instantiated on each SR segment endpoint node that the packet is intended to traverse, as well as its own compression capabilities. The resulting compressed SID list is a combination of CSID sequences, for the SIDs that the SR source node was able to compress, and uncompressed SIDs, which could not be compressed. In case the SR source node is able to compress all the SIDs in the SID list, the compressed SID list comprises only CSID sequences (one or more) and no uncompressed SIDs. Conversely, the compressed SID list comprises only uncompressed SIDs when the SR source is unable to compress any of the constituent SIDs.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-endpoint">
<section id="section-4">
      <h2 id="name-sr-segment-endpoint-flavors">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sr-segment-endpoint-flavors" class="section-name selfRef">SR Segment Endpoint Flavors</a>
      </h2>
<p id="section-4-1">This section defines two SR segment endpoint flavors: NEXT-CSID and REPLACE-CSID, for the End, End.X, End.T, End.B6.Encaps, End.B6.Encaps.Red, and End.BM behaviors of <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This section also defines a REPLACE-CSID flavor for the End.DX6, End.DX4, End.DT6, End.DT4, End.DT46, End.DX2, End.DX2V, End.DT2U, and End.DT2M behaviors of <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.
A counterpart NEXT-CSID flavor is not defined for these behaviors. Any SID can be the last element of a CSID sequence compressed using the NEXT-CSID flavor (see <a href="#sec-next" class="auto internal xref">Section 4.1</a>) and the aforementioned SRv6 endpoint behaviors are always in the last position in a SID list; thus, there is no need for any modification of the behaviors defined in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Future documents may extend the applicability of the NEXT-CSID and REPLACE-CSID flavors to other SRv6 endpoint behaviors (see <a href="#sec-future" class="auto internal xref">Section 10</a>).<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The use of these flavors, either individually or in combination, enables the compressed segment list encoding.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The NEXT-CSID flavor and the REPLACE-CSID flavor both leverage the SID Argument to determine the next SID to be processed, but employ different SID list compression schemes.
With the NEXT-CSID flavor, each CSID container is a fully formed SRv6 SID with the common Locator-Block for all the CSIDs in the CSID container, a Locator-Node and Function that are those of the first CSID, and an Argument carrying the subsequent CSIDs.
With the REPLACE-CSID flavor, only the first element in a CSID sequence is a fully formed SRv6 SID. It has the common Locator-Block for all the CSIDs in the CSID sequence, and a Locator-Node and Function that are those of the first CSID. The remaining elements in the CSID sequence are CSID containers carrying the subsequent CSIDs without the Locator-Block.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Regardless of which flavor is used, the IPv6 address carried in the Destination Address field of the IPv6 header is a valid SRv6 SID conforming to <span>[<a href="#RFC9602" class="cite xref">RFC9602</a>]</span>.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">In the remainder of this document, the term "a SID of this document" refers to any End, End.X, End.T, End.B6.Encaps, End.B6.Encaps.Red, or End.BM SID with the NEXT-CSID or the REPLACE-CSID flavor and with any combination of Penultimate Segment Pop (PSP), Ultimate Segment Pop (USP), and Ultimate Segment Decapsulation (USD) flavor, or any End.DX6, End.DX4, End.DT6, End.DT4, End.DT46, End.DX2, End.DX2V, End.DT2U, or End.DT2M with the REPLACE-CSID flavor. All the SRv6 endpoint behaviors introduced in this document are listed in <a href="#tbl-iana-endpoint-behaviors" class="auto internal xref">Table 1</a>.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">In the remainder of this document, the terms "NEXT-CSID flavor SID" and "REPLACE-CSID flavor SID" refer to any SID of this document with the NEXT-CSID flavor and with the REPLACE-CSID flavor, respectively.<a href="#section-4-8" class="pilcrow">¶</a></p>
<div id="sec-next">
<section id="section-4.1">
        <h3 id="name-next-csid-flavor">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-next-csid-flavor" class="section-name selfRef">NEXT-CSID Flavor</a>
        </h3>
<p id="section-4.1-1">A CSID sequence compressed using the mechanism of the NEXT-CSID flavor comprises one or more CSID containers. Each CSID container is a fully formed 128-bit SID structured as shown in <a href="#fig-next-struct" class="auto internal xref">Figure 1</a>. It carries a Locator-Block followed by a series of CSIDs. The Locator-Node and Function of the CSID container are those of the first CSID, and its Argument is the contiguous series of subsequent CSIDs. The second CSID is encoded in the most significant bits of the CSID container Argument.  The third CSID is encoded in the bits of the Argument that immediately follow the second CSID, and so on. When all CSIDs have the same length, a CSID container can carry up to K CSIDs, where K is computed as floor((128-LBL)/LNFL) (floor(x) is the greatest integer less than or equal to x <span>[<a href="#GKP94" class="cite xref">GKP94</a>]</span>). Each CSID container for NEXT-CSID is independent, such that contiguous CSID containers in a CSID sequence can be considered to be separate CSID sequences.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">When a CSID sequence compressed using the NEXT-CSID flavor comprises at least two CSIDs, the last CSID in the sequence is not required to have the NEXT-CSID flavor. It can be bound to any SRv6 endpoint behavior, including <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> behaviors and REPLACE-CSID flavor, as long as the updated Destination Address resulting from the processing of the previous CSID in the sequence is a valid form for that last SID. Line S12 of the first pseudocode in <a href="#sec-source-compression" class="auto internal xref">Section 6.2</a> provides sufficient conditions to ensure this property.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-next-csid-fl"></span><div id="fig-next-struct">
<figure id="figure-1">
          <div id="section-4.1-3.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="552" viewBox="0 0 552 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 208,40 L 208,72" fill="none" stroke="black"></path>
                <path d="M 280,40 L 280,72" fill="none" stroke="black"></path>
                <path d="M 544,32 L 544,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 544,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 544,80" fill="none" stroke="black"></path>
                <path d="M 16,96 L 200,96" fill="none" stroke="black"></path>
                <path d="M 216,96 L 272,96" fill="none" stroke="black"></path>
                <path d="M 288,96 L 536,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="544,96 532,90.4 532,101.6" fill="black" transform="rotate(0,536,96)"></polygon>
                <polygon class="arrowhead" points="296,96 284,90.4 284,101.6" fill="black" transform="rotate(180,288,96)"></polygon>
                <polygon class="arrowhead" points="280,96 268,90.4 268,101.6" fill="black" transform="rotate(0,272,96)"></polygon>
                <polygon class="arrowhead" points="224,96 212,90.4 212,101.6" fill="black" transform="rotate(180,216,96)"></polygon>
                <polygon class="arrowhead" points="208,96 196,90.4 196,101.6" fill="black" transform="rotate(0,200,96)"></polygon>
                <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
                <g class="text">
                  <text x="104" y="52">Locator-Block</text>
                  <text x="244" y="52">Loc-Node</text>
                  <text x="412" y="52">Argument</text>
                  <text x="244" y="68">Function</text>
                  <text x="104" y="116">LBL</text>
                  <text x="244" y="116">LNFL</text>
                  <text x="412" y="116">AL</text>
                </g>
              </svg><a href="#section-4.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-structure-of-a-next-csid-fl" class="selfRef">Structure of a NEXT-CSID Flavor SID (Scaled for a 48-Bit Locator‑Block, 16-Bit Combined Locator-Node and Function, and 64-Bit Argument)</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4"><a href="#fig-next-csid-list" class="auto internal xref">Figure 2</a> illustrates a compressed SID list as could be produced by an SR source node steering a packet into an SR policy with a SID list of eight NEXT-CSID flavor SIDs. All SIDs in this example have a 48-bit Locator-Block, 16-bit combined Locator-Node and Function, and 64-bit Argument. The SR source node compresses the SR policy SID list as a compressed SID list of two CSID containers. The first CSID container carries a Locator-Block and the first five CSIDs. The second CSID container carries a Locator-Block and the sixth, seventh, and eighth CSIDs. Since the SR source node does not use the second CSID container at full capacity, it sets the 32 least significant bits to zero. The SR source node sets the IPv6 Destination Address (DA) with the value of the first CSID container and the first element of the SRH Segment List with the value of the second CSID container. Without reduced SRH (see <span><a href="https://rfc-editor.org/rfc/rfc8754#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>), the SR source node also writes the first CSID container as the second element of the SRH Segment List.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Note that the CSIDs within a given CSID container appear in forward order to leverage the longest-prefix match IP forwarding, while the entries in the SRH Segment List appear in reversed order of their processing, as specified in <span><a href="https://rfc-editor.org/rfc/rfc8754#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<span id="name-compressed-sid-list-of-eigh"></span><div id="fig-next-csid-list">
<figure id="figure-2">
          <div id="section-4.1-6.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="432" width="528" viewBox="0 0 528 432" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
                <path d="M 8,272 L 8,400" fill="none" stroke="black"></path>
                <path d="M 264,96 L 264,192" fill="none" stroke="black"></path>
                <path d="M 264,304 L 264,368" fill="none" stroke="black"></path>
                <path d="M 520,64 L 520,192" fill="none" stroke="black"></path>
                <path d="M 520,272 L 520,400" fill="none" stroke="black"></path>
                <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                <path d="M 264,96 L 520,96" fill="none" stroke="black"></path>
                <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                <path d="M 8,160 L 520,160" fill="none" stroke="black"></path>
                <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
                <path d="M 8,272 L 520,272" fill="none" stroke="black"></path>
                <path d="M 264,304 L 520,304" fill="none" stroke="black"></path>
                <path d="M 8,336 L 520,336" fill="none" stroke="black"></path>
                <path d="M 8,368 L 520,368" fill="none" stroke="black"></path>
                <path d="M 8,400 L 520,400" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">0</text>
                  <text x="176" y="36">1</text>
                  <text x="336" y="36">2</text>
                  <text x="496" y="36">3</text>
                  <text x="16" y="52">0</text>
                  <text x="32" y="52">1</text>
                  <text x="48" y="52">2</text>
                  <text x="64" y="52">3</text>
                  <text x="80" y="52">4</text>
                  <text x="96" y="52">5</text>
                  <text x="112" y="52">6</text>
                  <text x="128" y="52">7</text>
                  <text x="144" y="52">8</text>
                  <text x="160" y="52">9</text>
                  <text x="176" y="52">0</text>
                  <text x="192" y="52">1</text>
                  <text x="208" y="52">2</text>
                  <text x="224" y="52">3</text>
                  <text x="240" y="52">4</text>
                  <text x="256" y="52">5</text>
                  <text x="272" y="52">6</text>
                  <text x="288" y="52">7</text>
                  <text x="304" y="52">8</text>
                  <text x="320" y="52">9</text>
                  <text x="336" y="52">0</text>
                  <text x="352" y="52">1</text>
                  <text x="368" y="52">2</text>
                  <text x="384" y="52">3</text>
                  <text x="400" y="52">4</text>
                  <text x="416" y="52">5</text>
                  <text x="432" y="52">6</text>
                  <text x="448" y="52">7</text>
                  <text x="464" y="52">8</text>
                  <text x="480" y="52">9</text>
                  <text x="496" y="52">0</text>
                  <text x="512" y="52">1</text>
                  <text x="136" y="100">Locator-Block</text>
                  <text x="368" y="116">1st</text>
                  <text x="404" y="116">CSID</text>
                  <text x="112" y="148">2nd</text>
                  <text x="148" y="148">CSID</text>
                  <text x="368" y="148">3rd</text>
                  <text x="404" y="148">CSID</text>
                  <text x="112" y="180">4th</text>
                  <text x="148" y="180">CSID</text>
                  <text x="368" y="180">5th</text>
                  <text x="404" y="180">CSID</text>
                  <text x="200" y="212">First</text>
                  <text x="244" y="212">CSID</text>
                  <text x="304" y="212">container</text>
                  <text x="16" y="244">0</text>
                  <text x="176" y="244">1</text>
                  <text x="336" y="244">2</text>
                  <text x="496" y="244">3</text>
                  <text x="16" y="260">0</text>
                  <text x="32" y="260">1</text>
                  <text x="48" y="260">2</text>
                  <text x="64" y="260">3</text>
                  <text x="80" y="260">4</text>
                  <text x="96" y="260">5</text>
                  <text x="112" y="260">6</text>
                  <text x="128" y="260">7</text>
                  <text x="144" y="260">8</text>
                  <text x="160" y="260">9</text>
                  <text x="176" y="260">0</text>
                  <text x="192" y="260">1</text>
                  <text x="208" y="260">2</text>
                  <text x="224" y="260">3</text>
                  <text x="240" y="260">4</text>
                  <text x="256" y="260">5</text>
                  <text x="272" y="260">6</text>
                  <text x="288" y="260">7</text>
                  <text x="304" y="260">8</text>
                  <text x="320" y="260">9</text>
                  <text x="336" y="260">0</text>
                  <text x="352" y="260">1</text>
                  <text x="368" y="260">2</text>
                  <text x="384" y="260">3</text>
                  <text x="400" y="260">4</text>
                  <text x="416" y="260">5</text>
                  <text x="432" y="260">6</text>
                  <text x="448" y="260">7</text>
                  <text x="464" y="260">8</text>
                  <text x="480" y="260">9</text>
                  <text x="496" y="260">0</text>
                  <text x="512" y="260">1</text>
                  <text x="136" y="308">Locator-Block</text>
                  <text x="368" y="324">6th</text>
                  <text x="404" y="324">CSID</text>
                  <text x="112" y="356">7th</text>
                  <text x="148" y="356">CSID</text>
                  <text x="368" y="356">8th</text>
                  <text x="404" y="356">CSID</text>
                  <text x="264" y="388">0</text>
                  <text x="204" y="420">Second</text>
                  <text x="252" y="420">CSID</text>
                  <text x="312" y="420">container</text>
                </g>
              </svg><a href="#section-4.1-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-compressed-sid-list-of-eigh" class="selfRef">Compressed SID List of Eight NEXT-CSID Flavor SIDs with a 48-Bit Locator‑Block, 16-Bit Combined Locator-Node and Function, and 64-Bit Argument</a>
          </figcaption></figure>
</div>
<p id="section-4.1-7">An implementation <span class="bcp14">MUST</span> support a 32-bit LBL and a 16-bit CSID length (LNFL) for NEXT-CSID flavor SIDs, and it <span class="bcp14">MAY</span> support any additional Locator-Block and CSID length.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The AL for NEXT-CSID flavor SIDs is equal to 128-LBL-LNFL.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">When processing an IPv6 packet that matches a Forwarding Information Base (FIB) entry locally instantiated as a SID with the NEXT-CSID flavor, the SR segment endpoint node applies the procedure specified in the following subsection that corresponds to the SID behavior. If the SID also has the PSP, USP, or USD flavor, the procedure is modified as described in <a href="#sec-next-flavors" class="auto internal xref">Section 4.1.7</a>.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">An SR segment endpoint node instantiating a SID of this document with the NEXT-CSID flavor <span class="bcp14">MUST</span> accept any Argument value for that SID.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">At a high level, for any SID with the NEXT-CSID flavor, the SR segment endpoint node determines the next SID of the SID list as follows. If the Argument value of the active SID is non-zero, the SR segment endpoint node constructs the next SID from the active SID by copying the entire SID Argument value to the bits that immediately follow the Locator-Block, thus overwriting the active SID Locator-Node and Function with those of the next CSID, and filling the least significant LNFL bits of the Argument with zeros. Otherwise (if the Argument value is 0), the SR segment endpoint node copies the next 128-bit Segment List entry from the SRH to the Destination Address field of the IPv6 header.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<div id="sec-next-end">
<section id="section-4.1.1">
          <h4 id="name-end-with-next-csid">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-end-with-next-csid" class="section-name selfRef">End with NEXT-CSID</a>
          </h4>
<p id="section-4.1.1-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End SID with the NEXT-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">The below pseudocode is inserted between lines S01 and S02 of the SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.  In addition, this pseudocode is executed before processing the first
header in the IPv6 extension header chain that is not an SRH, a Hop-by-Hop header, or a Destination Options header.  If the IPv6
extension header chain does not include any header matching this
criterion, this pseudocode is executed before processing the upper-layer header.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.1.1-3">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.   Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
N09. }
</pre><a href="#section-4.1.1-3" class="pilcrow">¶</a>
</div>
<aside id="section-4.1.1-4">
            <p id="section-4.1.1-4.1">Notes:<a href="#section-4.1.1-4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-4.2.1">
                <p id="section-4.1.1-4.2.1.1"><code>DA.Argument</code> identifies the value contained in the bits <code>[(LBL+LNFL)..127]</code> in the Destination Address of the IPv6 header.<a href="#section-4.1.1-4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.1-4.2.2">
                <p id="section-4.1.1-4.2.2.1">The value in the Segments Left field of the SRH is not modified when <code>DA.Argument</code> in the received packet has a non-zero value.<a href="#section-4.1.1-4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</aside>
<p id="section-4.1.1-5">A rendering of the complete pseudocode is provided in <a href="#sec-next-end-complete" class="auto internal xref">Appendix A.1</a>.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-endx">
<section id="section-4.1.2">
          <h4 id="name-endx-with-next-csid">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-endx-with-next-csid" class="section-name selfRef">End.X with NEXT-CSID</a>
          </h4>
<p id="section-4.1.2-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.X SID with the NEXT-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The pseudocode in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a> of this document is modified by replacing line N08 as shown below.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.1.2-3">
<pre>
N08.   Submit the packet to the IPv6 module for transmission to the
         new destination via a member of J.
</pre><a href="#section-4.1.2-3" class="pilcrow">¶</a>
</div>
<aside id="section-4.1.2-4">
            <p id="section-4.1.2-4.1">Note: the variable J is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.1.2-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.1.2-5">The resulting pseudocode is inserted between lines S01 and S02 of the SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> after applying the modification described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>. In addition, this pseudocode is executed before processing the first
header in the IPv6 extension header chain that is not an SRH, a Hop-by-Hop header, or a Destination Options header. If the IPv6
extension header chain does not include any header matching this
criterion, this pseudocode is executed before processing the upper-layer header.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6">A rendering of the complete pseudocode is provided in <a href="#sec-next-endx-complete" class="auto internal xref">Appendix A.2</a>.<a href="#section-4.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-endt">
<section id="section-4.1.3">
          <h4 id="name-endt-with-next-csid">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-endt-with-next-csid" class="section-name selfRef">End.T with NEXT-CSID</a>
          </h4>
<p id="section-4.1.3-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.T SID with the NEXT-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">The pseudocode in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a> of this document is modified by replacing line N08 as shown below.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.1.3-3">
<pre>
N08.1.   Set the packet's associated FIB table to T.
N08.2.   Submit the packet to the egress IPv6 FIB lookup for
           transmission to the new destination.
</pre><a href="#section-4.1.3-3" class="pilcrow">¶</a>
</div>
<aside id="section-4.1.3-4">
            <p id="section-4.1.3-4.1">Note: the variable T is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.1.3-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.1.3-5">The resulting pseudocode is inserted between lines S01 and S02 of the SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> after applying the modification described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.  In addition, this pseudocode is executed before processing the first
header in the IPv6 extension header chain that is not an SRH, a Hop-by-Hop header, or a Destination Options header. If the IPv6
extension header chain does not include any header matching this
criterion, this pseudocode is executed before processing the upper-layer header.<a href="#section-4.1.3-5" class="pilcrow">¶</a></p>
<p id="section-4.1.3-6">A rendering of the complete pseudocode is provided in <a href="#sec-next-endt-complete" class="auto internal xref">Appendix A.3</a>.<a href="#section-4.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-endb6">
<section id="section-4.1.4">
          <h4 id="name-endb6encaps-with-next-csid">
<a href="#section-4.1.4" class="section-number selfRef">4.1.4. </a><a href="#name-endb6encaps-with-next-csid" class="section-name selfRef">End.B6.Encaps with NEXT-CSID</a>
          </h4>
<p id="section-4.1.4-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.B6.Encaps SID with the NEXT-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.4-2">The pseudocode in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a> of this document is modified by replacing line N08 as shown below.<a href="#section-4.1.4-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.1.4-3">
<pre>
N08.1.   Push a new IPv6 header with its own SRH containing B.
N08.2.   Set the outer IPv6 SA to A.
N08.3.   Set the outer IPv6 DA to the first SID of B.
N08.4.   Set the outer Payload Length, Traffic Class, Flow Label,
           Hop Limit, and Next Header fields.
N08.5.   Submit the packet to the egress IPv6 FIB lookup for
           transmission to the next destination.
</pre><a href="#section-4.1.4-3" class="pilcrow">¶</a>
</div>
<aside id="section-4.1.4-4">
            <p id="section-4.1.4-4.1">Note: the variables A and B, as well as the values of the Payload Length, Traffic Class, Flow Label, Hop Limit, and Next Header are defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.1.4-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.1.4-5">The resulting pseudocode is inserted between lines S01 and S02 of the SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.  In addition, this pseudocode is executed before processing the first
header in the IPv6 extension header chain that is not an SRH, a Hop-by-Hop header, or a Destination Options header. If the IPv6
extension header chain does not include any header matching this
criterion, this pseudocode is executed before processing the upper-layer header.<a href="#section-4.1.4-5" class="pilcrow">¶</a></p>
<p id="section-4.1.4-6">A rendering of the complete pseudocode is provided in <a href="#sec-next-endb6-complete" class="auto internal xref">Appendix A.4</a>.<a href="#section-4.1.4-6" class="pilcrow">¶</a></p>
<p id="section-4.1.4-7">Similar to the base End.B6.Encaps SID defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>, the NEXT-CSID flavor variant updates the Destination Address field of the inner IPv6 header to the next SID in the original segment list before encapsulating the packet with the segment list of SR Policy B. At the endpoint of SR Policy B, the encapsulation is removed and the inner packet is forwarded towards the exposed Destination Address, which already contains the next SID in the original segment list.<a href="#section-4.1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-endb6red">
<section id="section-4.1.5">
          <h4 id="name-endb6encapsred-with-next-cs">
<a href="#section-4.1.5" class="section-number selfRef">4.1.5. </a><a href="#name-endb6encapsred-with-next-cs" class="section-name selfRef">End.B6.Encaps.Red with NEXT-CSID</a>
          </h4>
<p id="section-4.1.5-1">This is an optimization of the End.B6.Encaps with NEXT-CSID behavior.<a href="#section-4.1.5-1" class="pilcrow">¶</a></p>
<p id="section-4.1.5-2">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.B6.Encaps.Red SID with the NEXT-CSID flavor, the procedure described in <a href="#sec-next-endb6" class="auto internal xref">Section 4.1.4</a> of this document is executed with the modifications in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.14" class="relref">Section 4.14</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-endbm">
<section id="section-4.1.6">
          <h4 id="name-endbm-with-next-csid">
<a href="#section-4.1.6" class="section-number selfRef">4.1.6. </a><a href="#name-endbm-with-next-csid" class="section-name selfRef">End.BM with NEXT-CSID</a>
          </h4>
<p id="section-4.1.6-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.BM SID with the NEXT-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.1.6-1" class="pilcrow">¶</a></p>
<p id="section-4.1.6-2">The pseudocode in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a> of this document is modified by replacing line N08 as shown below.<a href="#section-4.1.6-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.1.6-3">
<pre>
N08.1.   Push the MPLS label stack for B.
N08.2.   Submit the packet to the MPLS engine for transmission.
</pre><a href="#section-4.1.6-3" class="pilcrow">¶</a>
</div>
<aside id="section-4.1.6-4">
            <p id="section-4.1.6-4.1">Note: the variable B is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.1.6-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.1.6-5">The resulting pseudocode is inserted between lines S01 and S02 of the SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>. In addition, this pseudocode is executed before processing the first
header in the IPv6 extension header chain that is not an SRH, a Hop-by-Hop header, or a Destination Options header. If the IPv6
extension header chain does not include any header matching this
criterion, this pseudocode is executed before processing the upper-layer header.<a href="#section-4.1.6-5" class="pilcrow">¶</a></p>
<p id="section-4.1.6-6">A rendering of the complete pseudocode is provided in <a href="#sec-next-endbm-complete" class="auto internal xref">Appendix A.5</a>.<a href="#section-4.1.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-flavors">
<section id="section-4.1.7">
          <h4 id="name-combination-with-psp-usp-an">
<a href="#section-4.1.7" class="section-number selfRef">4.1.7. </a><a href="#name-combination-with-psp-usp-an" class="section-name selfRef">Combination with PSP, USP, and USD Flavors</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.1.7-1">
            <dt id="section-4.1.7-1.1">PSP:</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.7-1.2">The PSP flavor defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.1" class="relref">Section 4.16.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is unchanged when combined
            with the NEXT-CSID flavor.<a href="#section-4.1.7-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.7-1.3">USP:</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.7-1.4">The USP flavor defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.2" class="relref">Section 4.16.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is unchanged when combined
            with the NEXT-CSID flavor.<a href="#section-4.1.7-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.7-1.5">USD:</dt>
            <dd style="margin-left: 1.5em" id="section-4.1.7-1.6">The USD flavor defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.3" class="relref">Section 4.16.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is unchanged when combined
            with the NEXT-CSID flavor.<a href="#section-4.1.7-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-replace">
<section id="section-4.2">
        <h3 id="name-replace-csid-flavor">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-replace-csid-flavor" class="section-name selfRef">REPLACE-CSID Flavor</a>
        </h3>
<p id="section-4.2-1">A CSID sequence compressed using the mechanism of the REPLACE-CSID flavor starts with a CSID container in fully formed 128-bit SID format. The Locator-Block of this SID is the common Locator-Block for all the CSIDs in the CSID sequence, its Locator-Node and Function are those of the first CSID, and its Argument carries the index of the current CSID in the current CSID container. The Argument value is initially 0. When more segments are present in the segment list, the CSID sequence continues with one or more CSID containers in packed format carrying the series of subsequent CSIDs. Each container in packed format is a 128-bit Segment List entry split into K "positions" of LNFL bits, where K is computed as floor(128/LNFL). If LNFL does not divide into 128 perfectly, a zero pad is added in the least significant bits of the CSID container to fill the bits left over. The second CSID in the CSID sequence is encoded in the least significant bit position of the first CSID container in packed format (position K-1), the third CSID is encoded in position K-2, and so on.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The last CSID in the CSID sequence is not required to have the REPLACE-CSID flavor. It can be bound to any SRv6 endpoint behavior, including the behaviors described in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> and NEXT-CSID flavor, as long as it meets the conditions defined in <a href="#sec-source-node" class="auto internal xref">Section 6</a>.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The structure of a SID with the REPLACE-CSID flavor is shown in <a href="#fig-replace-struct" class="auto internal xref">Figure 3</a>. The same structure is also that of the CSID container for REPLACE-CSID in fully formed 128-bit SID format.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-replace-csid"></span><div id="fig-replace-struct">
<figure id="figure-3">
          <div id="section-4.2-4.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="560" viewBox="0 0 560 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 208,40 L 208,72" fill="none" stroke="black"></path>
                <path d="M 344,40 L 344,72" fill="none" stroke="black"></path>
                <path d="M 552,32 L 552,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 552,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 552,80" fill="none" stroke="black"></path>
                <path d="M 16,96 L 200,96" fill="none" stroke="black"></path>
                <path d="M 216,96 L 336,96" fill="none" stroke="black"></path>
                <path d="M 352,96 L 544,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="552,96 540,90.4 540,101.6" fill="black" transform="rotate(0,544,96)"></polygon>
                <polygon class="arrowhead" points="360,96 348,90.4 348,101.6" fill="black" transform="rotate(180,352,96)"></polygon>
                <polygon class="arrowhead" points="344,96 332,90.4 332,101.6" fill="black" transform="rotate(0,336,96)"></polygon>
                <polygon class="arrowhead" points="224,96 212,90.4 212,101.6" fill="black" transform="rotate(180,216,96)"></polygon>
                <polygon class="arrowhead" points="208,96 196,90.4 196,101.6" fill="black" transform="rotate(0,200,96)"></polygon>
                <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
                <g class="text">
                  <text x="104" y="52">Locator-Block</text>
                  <text x="276" y="52">Locator-Node</text>
                  <text x="444" y="52">Argument</text>
                  <text x="240" y="68">+</text>
                  <text x="284" y="68">Function</text>
                  <text x="104" y="116">LBL</text>
                  <text x="276" y="116">LNFL</text>
                  <text x="444" y="116">AL</text>
                </g>
              </svg><a href="#section-4.2-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-structure-of-a-replace-csid" class="selfRef">Structure of a REPLACE-CSID Flavor SID (Scaled for a 48-Bit Locator‑Block, 32-Bit Combined Locator-Node and Function, and 48-Bit Argument)</a>
          </figcaption></figure>
</div>
<p id="section-4.2-5">The structure of a CSID container for REPLACE-CSID in packed format is shown in <a href="#fig-replace-container" class="auto internal xref">Figure 4</a>.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-csid-contain"></span><div id="fig-replace-container">
<figure id="figure-4">
          <div id="section-4.2-6.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="560" viewBox="0 0 560 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,80" fill="none" stroke="black"></path>
                <path d="M 144,40 L 144,72" fill="none" stroke="black"></path>
                <path d="M 280,40 L 280,72" fill="none" stroke="black"></path>
                <path d="M 416,40 L 416,72" fill="none" stroke="black"></path>
                <path d="M 552,32 L 552,80" fill="none" stroke="black"></path>
                <path d="M 8,32 L 552,32" fill="none" stroke="black"></path>
                <path d="M 8,80 L 552,80" fill="none" stroke="black"></path>
                <path d="M 16,96 L 136,96" fill="none" stroke="black"></path>
                <path d="M 152,96 L 272,96" fill="none" stroke="black"></path>
                <path d="M 288,96 L 408,96" fill="none" stroke="black"></path>
                <path d="M 424,96 L 544,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="552,96 540,90.4 540,101.6" fill="black" transform="rotate(0,544,96)"></polygon>
                <polygon class="arrowhead" points="432,96 420,90.4 420,101.6" fill="black" transform="rotate(180,424,96)"></polygon>
                <polygon class="arrowhead" points="416,96 404,90.4 404,101.6" fill="black" transform="rotate(0,408,96)"></polygon>
                <polygon class="arrowhead" points="296,96 284,90.4 284,101.6" fill="black" transform="rotate(180,288,96)"></polygon>
                <polygon class="arrowhead" points="280,96 268,90.4 268,101.6" fill="black" transform="rotate(0,272,96)"></polygon>
                <polygon class="arrowhead" points="160,96 148,90.4 148,101.6" fill="black" transform="rotate(180,152,96)"></polygon>
                <polygon class="arrowhead" points="144,96 132,90.4 132,101.6" fill="black" transform="rotate(0,136,96)"></polygon>
                <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
                <g class="text">
                  <text x="52" y="52">Fourth</text>
                  <text x="100" y="52">CSID</text>
                  <text x="192" y="52">Third</text>
                  <text x="236" y="52">CSID</text>
                  <text x="324" y="52">Second</text>
                  <text x="372" y="52">CSID</text>
                  <text x="464" y="52">First</text>
                  <text x="508" y="52">CSID</text>
                  <text x="64" y="68">(position</text>
                  <text x="116" y="68">0)</text>
                  <text x="200" y="68">(position</text>
                  <text x="252" y="68">1)</text>
                  <text x="336" y="68">(position</text>
                  <text x="388" y="68">2)</text>
                  <text x="472" y="68">(position</text>
                  <text x="524" y="68">3)</text>
                  <text x="76" y="116">LNFL</text>
                  <text x="212" y="116">LNFL</text>
                  <text x="348" y="116">LNFL</text>
                  <text x="484" y="116">LNFL</text>
                </g>
              </svg><a href="#section-4.2-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-structure-of-a-csid-contain" class="selfRef">Structure of a CSID Container for REPLACE-CSID Using a 32-Bit CSID Length (K = 4)</a>
          </figcaption></figure>
</div>
<p id="section-4.2-7"><a href="#fig-replace-csid-list" class="auto internal xref">Figure 5</a> illustrates a compressed SID list as could be produced by an SR source node steering a packet into an SR policy SID list of seven REPLACE-CSID flavor SIDs. All SIDs in this example have a 48-bit Locator-Block, 32-bit combined Locator-Node and Function, and 48-bit Argument. The SR source node compresses the SR policy SID list as a compressed SID list of three CSID containers. The first CSID container is in fully formed 128-bit SID format. It carries a Locator-Block, the first CSID, and the argument value zero. The second and third CSID containers are in packed format. The second CSID container carries the second, third, fourth, and fifth CSIDs. The third CSID container carries the sixth and seventh CSIDs. Since the SR source node does not use the third CSID container at full capacity, it sets the 64 least significant bits to zero. The SR source node sets the IPv6 DA with the value of the first CSID container, sets the first element in the SRH Segment List with the value of the third CSID container, and sets the second element of the SRH Segment List with the value of the second CSID container (the elements in the SRH Segment List appear in reversed order of their processing, as specified in <span><a href="https://rfc-editor.org/rfc/rfc8754#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>). Without reduced SRH, the SR source node also writes the first CSID container as the third element of the SRH Segment List.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<span id="name-compressed-sid-list-of-seve"></span><div id="fig-replace-csid-list">
<figure id="figure-5">
          <div id="section-4.2-8.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="640" width="528" viewBox="0 0 528 640" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
                <path d="M 8,272 L 8,400" fill="none" stroke="black"></path>
                <path d="M 8,480 L 8,608" fill="none" stroke="black"></path>
                <path d="M 264,96 L 264,160" fill="none" stroke="black"></path>
                <path d="M 520,64 L 520,192" fill="none" stroke="black"></path>
                <path d="M 520,272 L 520,400" fill="none" stroke="black"></path>
                <path d="M 520,480 L 520,608" fill="none" stroke="black"></path>
                <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
                <path d="M 264,96 L 520,96" fill="none" stroke="black"></path>
                <path d="M 8,128 L 520,128" fill="none" stroke="black"></path>
                <path d="M 8,160 L 264,160" fill="none" stroke="black"></path>
                <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
                <path d="M 8,272 L 520,272" fill="none" stroke="black"></path>
                <path d="M 8,304 L 520,304" fill="none" stroke="black"></path>
                <path d="M 8,336 L 520,336" fill="none" stroke="black"></path>
                <path d="M 8,368 L 520,368" fill="none" stroke="black"></path>
                <path d="M 8,400 L 520,400" fill="none" stroke="black"></path>
                <path d="M 8,480 L 520,480" fill="none" stroke="black"></path>
                <path d="M 8,544 L 520,544" fill="none" stroke="black"></path>
                <path d="M 8,576 L 520,576" fill="none" stroke="black"></path>
                <path d="M 8,608 L 520,608" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">0</text>
                  <text x="176" y="36">1</text>
                  <text x="336" y="36">2</text>
                  <text x="496" y="36">3</text>
                  <text x="16" y="52">0</text>
                  <text x="32" y="52">1</text>
                  <text x="48" y="52">2</text>
                  <text x="64" y="52">3</text>
                  <text x="80" y="52">4</text>
                  <text x="96" y="52">5</text>
                  <text x="112" y="52">6</text>
                  <text x="128" y="52">7</text>
                  <text x="144" y="52">8</text>
                  <text x="160" y="52">9</text>
                  <text x="176" y="52">0</text>
                  <text x="192" y="52">1</text>
                  <text x="208" y="52">2</text>
                  <text x="224" y="52">3</text>
                  <text x="240" y="52">4</text>
                  <text x="256" y="52">5</text>
                  <text x="272" y="52">6</text>
                  <text x="288" y="52">7</text>
                  <text x="304" y="52">8</text>
                  <text x="320" y="52">9</text>
                  <text x="336" y="52">0</text>
                  <text x="352" y="52">1</text>
                  <text x="368" y="52">2</text>
                  <text x="384" y="52">3</text>
                  <text x="400" y="52">4</text>
                  <text x="416" y="52">5</text>
                  <text x="432" y="52">6</text>
                  <text x="448" y="52">7</text>
                  <text x="464" y="52">8</text>
                  <text x="480" y="52">9</text>
                  <text x="496" y="52">0</text>
                  <text x="512" y="52">1</text>
                  <text x="136" y="100">Locator-Block</text>
                  <text x="368" y="116">1st</text>
                  <text x="404" y="116">CSID</text>
                  <text x="72" y="148">1st</text>
                  <text x="108" y="148">CSID</text>
                  <text x="168" y="148">continued</text>
                  <text x="392" y="164">0</text>
                  <text x="200" y="212">First</text>
                  <text x="244" y="212">CSID</text>
                  <text x="304" y="212">container</text>
                  <text x="16" y="244">0</text>
                  <text x="176" y="244">1</text>
                  <text x="336" y="244">2</text>
                  <text x="496" y="244">3</text>
                  <text x="16" y="260">0</text>
                  <text x="32" y="260">1</text>
                  <text x="48" y="260">2</text>
                  <text x="64" y="260">3</text>
                  <text x="80" y="260">4</text>
                  <text x="96" y="260">5</text>
                  <text x="112" y="260">6</text>
                  <text x="128" y="260">7</text>
                  <text x="144" y="260">8</text>
                  <text x="160" y="260">9</text>
                  <text x="176" y="260">0</text>
                  <text x="192" y="260">1</text>
                  <text x="208" y="260">2</text>
                  <text x="224" y="260">3</text>
                  <text x="240" y="260">4</text>
                  <text x="256" y="260">5</text>
                  <text x="272" y="260">6</text>
                  <text x="288" y="260">7</text>
                  <text x="304" y="260">8</text>
                  <text x="320" y="260">9</text>
                  <text x="336" y="260">0</text>
                  <text x="352" y="260">1</text>
                  <text x="368" y="260">2</text>
                  <text x="384" y="260">3</text>
                  <text x="400" y="260">4</text>
                  <text x="416" y="260">5</text>
                  <text x="432" y="260">6</text>
                  <text x="448" y="260">7</text>
                  <text x="464" y="260">8</text>
                  <text x="480" y="260">9</text>
                  <text x="496" y="260">0</text>
                  <text x="512" y="260">1</text>
                  <text x="240" y="292">5th</text>
                  <text x="276" y="292">CSID</text>
                  <text x="240" y="324">4th</text>
                  <text x="276" y="324">CSID</text>
                  <text x="240" y="356">3rd</text>
                  <text x="276" y="356">CSID</text>
                  <text x="240" y="388">2nd</text>
                  <text x="276" y="388">CSID</text>
                  <text x="204" y="420">Second</text>
                  <text x="252" y="420">CSID</text>
                  <text x="312" y="420">container</text>
                  <text x="16" y="452">0</text>
                  <text x="176" y="452">1</text>
                  <text x="336" y="452">2</text>
                  <text x="496" y="452">3</text>
                  <text x="16" y="468">0</text>
                  <text x="32" y="468">1</text>
                  <text x="48" y="468">2</text>
                  <text x="64" y="468">3</text>
                  <text x="80" y="468">4</text>
                  <text x="96" y="468">5</text>
                  <text x="112" y="468">6</text>
                  <text x="128" y="468">7</text>
                  <text x="144" y="468">8</text>
                  <text x="160" y="468">9</text>
                  <text x="176" y="468">0</text>
                  <text x="192" y="468">1</text>
                  <text x="208" y="468">2</text>
                  <text x="224" y="468">3</text>
                  <text x="240" y="468">4</text>
                  <text x="256" y="468">5</text>
                  <text x="272" y="468">6</text>
                  <text x="288" y="468">7</text>
                  <text x="304" y="468">8</text>
                  <text x="320" y="468">9</text>
                  <text x="336" y="468">0</text>
                  <text x="352" y="468">1</text>
                  <text x="368" y="468">2</text>
                  <text x="384" y="468">3</text>
                  <text x="400" y="468">4</text>
                  <text x="416" y="468">5</text>
                  <text x="432" y="468">6</text>
                  <text x="448" y="468">7</text>
                  <text x="464" y="468">8</text>
                  <text x="480" y="468">9</text>
                  <text x="496" y="468">0</text>
                  <text x="512" y="468">1</text>
                  <text x="264" y="516">0</text>
                  <text x="240" y="564">7th</text>
                  <text x="276" y="564">CSID</text>
                  <text x="240" y="596">6th</text>
                  <text x="276" y="596">CSID</text>
                  <text x="200" y="628">Third</text>
                  <text x="244" y="628">CSID</text>
                  <text x="304" y="628">container</text>
                </g>
              </svg><a href="#section-4.2-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-compressed-sid-list-of-seve" class="selfRef">Compressed SID List of Seven REPLACE-CSID Flavor SIDs with a 48-Bit Locator‑Block, 32-Bit Combined Locator-Node and Function, and 48-Bit Argument</a>
          </figcaption></figure>
</div>
<p id="section-4.2-9">This document updates <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> by allowing each entry in the SRH Segment List to be either an IPv6 address or a REPLACE-CSID container in packed format. The SRv6 endpoint behaviors specified herein ensure that this entry is never copied as is to the IPv6 header and that the Destination Address field of the IPv6 header is always a valid SRv6 SID conforming to <span>[<a href="#RFC9602" class="cite xref">RFC9602</a>]</span>.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">The REPLACE-CSID flavor SIDs support any LBL, depending on the needs of the operator, as long as it does not exceed 128-LNFL-ceiling(log_2(128/LNFL)) (ceiling(x) is the least integer greater than or equal to x <span>[<a href="#GKP94" class="cite xref">GKP94</a>]</span>), so that enough bits remain available for the CSID and Argument. An LBL of 48, 56, 64, 72, or 80 bits is recommended for easier reading in operation.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
<p id="section-4.2-11">This document defines the REPLACE-CSID flavor for 16-bit and 32-bit CSID lengths (LNFL). An implementation <span class="bcp14">MUST</span> support a 32-bit CSID length for REPLACE-CSID flavor SIDs.<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.2-12">The AL for REPLACE-CSID flavor SIDs is equal to 128-LBL-LNFL. The index value is encoded in the least significant X bits of the Argument, where X is computed as ceiling(log_2(128/LNFL)).<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<p id="section-4.2-13">When processing an IPv6 packet that matches a FIB entry locally instantiated as a SID with the REPLACE-CSID flavor, the SR segment endpoint node applies the procedure specified in the following subsection that corresponds to the SID behavior. If the SID also has the PSP, USP, or USD flavor, the procedure is modified as described in <a href="#sec-replace-flavors" class="auto internal xref">Section 4.2.8</a>.<a href="#section-4.2-13" class="pilcrow">¶</a></p>
<p id="section-4.2-14">At a high level, at the start of a CSID sequence using the REPLACE-CSID flavor, the first CSID container in fully formed 128-bit SID format is copied to the Destination Address of the IPv6 header. Then, for any SID with the REPLACE-CSID flavor, the SR segment endpoint node determines the next SID of the SID list as follows. When an SRH is present, the SR segment endpoint node decrements the index value in the Argument of the active SID if the index value is not 0 or, if it is 0, decrements the Segments Left value in the SRH and sets the index value in the Argument of the active SID to K-1. The updated index value indicates the position of the next CSID within the CSID container in packed format at the "Segment List" index "Segments Left" in the SRH. The SR segment endpoint node then constructs the next SID by copying this next CSID to the bits that immediately follow the Locator-Block in the Destination Address field of the IPv6 header, thus overwriting the active SID Locator-Node and Function with those of the next CSID. If no SRH is present, the SR segment endpoint node ignores the index value in the SID Argument (except End.DT2M, see <a href="#sec-replace-enddx" class="auto internal xref">Section 4.2.7</a>) and processes the upper-layer header as per <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>. The CSID sequence ends with a last CSID in the last CSID container that does not have the REPLACE-CSID flavor, or with the special CSID value 0, or when reaching the end of the segment list, whichever comes first.<a href="#section-4.2-14" class="pilcrow">¶</a></p>
<div id="sec-replace-end">
<section id="section-4.2.1">
          <h4 id="name-end-with-replace-csid">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-end-with-replace-csid" class="section-name selfRef">End with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.1-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End SID with the REPLACE-CSID flavor, the SRH processing described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">Line S02 of SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is replaced as follows.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.1-3">
<pre>
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
</pre><a href="#section-4.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-4">Lines S09 to S15 are replaced by the following pseudocode.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.1-5">
<pre>
R01. If (DA.Arg.Index != 0) {
R02.   If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.     Send an ICMP Parameter Problem to the Source Address,
           Code 0 (Erroneous header field encountered),
           Pointer set to the Segments Left field,
           interrupt packet processing and discard the packet.
R04.   }
R05.   Decrement DA.Arg.Index by 1.
R06.   If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.     Decrement Segments Left by 1.
R08.     Decrement IPv6 Hop Limit by 1.
R09.     Update IPv6 DA with Segment List[Segments Left]
R10.     Submit the packet to the egress IPv6 FIB lookup for
          transmission to the new destination.
R11.   }
R12. } Else {
R13.   If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.     Send an ICMP Parameter Problem to the Source Address,
           Code 0 (Erroneous header field encountered),
           Pointer set to the Segments Left field,
           interrupt packet processing and discard the packet.
R15.   }
R16.   Decrement Segments Left by 1.
R17.   Set DA.Arg.Index to (floor(128/LNFL) - 1).
R18. }
R19. Decrement IPv6 Hop Limit by 1.
R20. Write Segment List[Segments Left][DA.Arg.Index] into the bits
       [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
       header.
R21. Submit the packet to the egress IPv6 FIB lookup for
       transmission to the new destination.
</pre><a href="#section-4.2.1-5" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.1-6">
            <p id="section-4.2.1-6.1">Notes:<a href="#section-4.2.1-6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-6.2.1">
                <p id="section-4.2.1-6.2.1.1"><code>DA.Arg.Index</code> identifies the value contained in the bits <code>[(128-ceiling(log_2(128/LNFL)))..127]</code> in the Destination Address of the IPv6 header.<a href="#section-4.2.1-6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.1-6.2.2">
                <p id="section-4.2.1-6.2.2.1"><code>Segment List[Segments Left][DA.Arg.Index]</code> identifies the value contained in the bits <code>[DA.Arg.Index*LNFL..(DA.Arg.Index+1)*LNFL-1]</code> in the SRH Segment List entry at index Segments Left.<a href="#section-4.2.1-6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</aside>
<p id="section-4.2.1-7">The upper-layer header processing described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is unchanged.<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">A rendering of the complete pseudocode is provided in <a href="#sec-replace-end-complete" class="auto internal xref">Appendix A.6</a>.<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-endx">
<section id="section-4.2.2">
          <h4 id="name-endx-with-replace-csid">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-endx-with-replace-csid" class="section-name selfRef">End.X with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.2-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.X SID with the REPLACE-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> of this document is modified by replacing lines R10 and R21 as shown below.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.2-3">
<pre>
R10. Submit the packet to the IPv6 module for transmission to the
       new destination via a member of J.
</pre><a href="#section-4.2.2-3" class="pilcrow">¶</a>
</div>
<div class="lang-pseudocode sourcecode" id="section-4.2.2-4">
<pre>
R21. Submit the packet to the IPv6 module for transmission to the
       new destination via a member of J.
</pre><a href="#section-4.2.2-4" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.2-5">
            <p id="section-4.2.2-5.1">Note: the variable J is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.2.2-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.2.2-6">The SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is replaced with the resulting pseudocode. The upper-layer header processing is unchanged.<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2.2-7">A rendering of the complete pseudocode is provided in <a href="#sec-replace-endx-complete" class="auto internal xref">Appendix A.7</a>.<a href="#section-4.2.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-endt">
<section id="section-4.2.3">
          <h4 id="name-endt-with-replace-csid">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-endt-with-replace-csid" class="section-name selfRef">End.T with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.3-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.T SID with the REPLACE-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">The pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> of this document is modified by replacing lines R10 and R21 as shown below.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.3-3">
<pre>
R10.1. Set the packet's associated FIB table to T.
R10.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
</pre><a href="#section-4.2.3-3" class="pilcrow">¶</a>
</div>
<div class="lang-pseudocode sourcecode" id="section-4.2.3-4">
<pre>
R21.1. Set the packet's associated FIB table to T.
R21.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
</pre><a href="#section-4.2.3-4" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.3-5">
            <p id="section-4.2.3-5.1">Note: the variable T is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.2.3-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.2.3-6">The SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is replaced with the resulting pseudocode. The upper-layer header processing is unchanged.<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
<p id="section-4.2.3-7">A rendering of the complete pseudocode is provided in <a href="#sec-replace-endt-complete" class="auto internal xref">Appendix A.8</a>.<a href="#section-4.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-endb6">
<section id="section-4.2.4">
          <h4 id="name-endb6encaps-with-replace-cs">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-endb6encaps-with-replace-cs" class="section-name selfRef">End.B6.Encaps with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.4-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.B6.Encaps SID with the REPLACE-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2">The pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> of this document is modified by replacing lines R10 and R21 as shown below.<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.4-3">
<pre>
R10.1. Push a new IPv6 header with its own SRH containing B.
R10.2. Set the outer IPv6 SA to A.
R10.3. Set the outer IPv6 DA to the first SID of B.
R10.4. Set the outer Payload Length, Traffic Class, Flow Label,
         Hop Limit, and Next Header fields.
R10.5. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
</pre><a href="#section-4.2.4-3" class="pilcrow">¶</a>
</div>
<div class="lang-pseudocode sourcecode" id="section-4.2.4-4">
<pre>
R21.1. Push a new IPv6 header with its own SRH containing B.
R21.2. Set the outer IPv6 SA to A.
R21.3. Set the outer IPv6 DA to the first SID of B.
R21.4. Set the outer Payload Length, Traffic Class, Flow Label,
         Hop Limit, and Next Header fields.
R21.5. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
</pre><a href="#section-4.2.4-4" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.4-5">
            <p id="section-4.2.4-5.1">Note: the variables A and B, as well as the values of the Payload Length, Traffic Class, Flow Label, Hop Limit, and Next Header are defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.2.4-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.2.4-6">The SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is replaced with the resulting pseudocode. The upper-layer header processing is unchanged.<a href="#section-4.2.4-6" class="pilcrow">¶</a></p>
<p id="section-4.2.4-7">A rendering of the complete pseudocode is provided in <a href="#sec-replace-endb6-complete" class="auto internal xref">Appendix A.9</a>.<a href="#section-4.2.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-endb6red">
<section id="section-4.2.5">
          <h4 id="name-endb6encapsred-with-replace">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-endb6encapsred-with-replace" class="section-name selfRef">End.B6.Encaps.Red with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.5-1">This is an optimization of the End.B6.Encaps with REPLACE-CSID behavior.<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<p id="section-4.2.5-2">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.B6.Encaps.Red SID with the REPLACE-CSID flavor, the procedure described in <a href="#sec-replace-endb6" class="auto internal xref">Section 4.2.4</a> of this document is executed with the modifications in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.14" class="relref">Section 4.14</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-endbm">
<section id="section-4.2.6">
          <h4 id="name-endbm-with-replace-csid">
<a href="#section-4.2.6" class="section-number selfRef">4.2.6. </a><a href="#name-endbm-with-replace-csid" class="section-name selfRef">End.BM with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.6-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.BM SID with the REPLACE-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modifications.<a href="#section-4.2.6-1" class="pilcrow">¶</a></p>
<p id="section-4.2.6-2">The pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> of this document is modified by replacing lines R10 and R21 as shown below.<a href="#section-4.2.6-2" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.6-3">
<pre>
R10.1. Push the MPLS label stack for B.
R10.2. Submit the packet to the MPLS engine for transmission.
</pre><a href="#section-4.2.6-3" class="pilcrow">¶</a>
</div>
<div class="lang-pseudocode sourcecode" id="section-4.2.6-4">
<pre>
R21.1. Push the MPLS label stack for B.
R21.2. Submit the packet to the MPLS engine for transmission.
</pre><a href="#section-4.2.6-4" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.6-5">
            <p id="section-4.2.6-5.1">Note: the variable B is defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-4.2.6-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.2.6-6">The SRH processing in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.15" class="relref">Section 4.15</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is replaced with the resulting pseudocode. The upper-layer header processing is unchanged.<a href="#section-4.2.6-6" class="pilcrow">¶</a></p>
<p id="section-4.2.6-7">A rendering of the complete pseudocode is provided in <a href="#sec-replace-endbm-complete" class="auto internal xref">Appendix A.10</a>.<a href="#section-4.2.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-enddx">
<section id="section-4.2.7">
          <h4 id="name-enddx-and-enddt-with-replac">
<a href="#section-4.2.7" class="section-number selfRef">4.2.7. </a><a href="#name-enddx-and-enddt-with-replac" class="section-name selfRef">End.DX and End.DT with REPLACE-CSID</a>
          </h4>
<p id="section-4.2.7-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.DX6, End.DX4, End.DT6, End.DT4, End.DT46, End.DX2, End.DX2V, or End.DT2U SID with the REPLACE-CSID flavor, the corresponding procedure described in Sections <a href="https://rfc-editor.org/rfc/rfc8986#section-4.4" class="relref">4.4</a> through <a href="https://rfc-editor.org/rfc/rfc8986#section-4.11" class="relref">4.11</a> of <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed.<a href="#section-4.2.7-1" class="pilcrow">¶</a></p>
<p id="section-4.2.7-2">These SIDs differ from those defined in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> by the presence of an Argument as part of the SID structure. The Argument value is ignored by the SR segment endpoint node.<a href="#section-4.2.7-2" class="pilcrow">¶</a></p>
<p id="section-4.2.7-3">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.DT2M SID with the REPLACE-CSID flavor, the procedure described in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.12" class="relref">Section 4.12</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is executed with the following modification.<a href="#section-4.2.7-3" class="pilcrow">¶</a></p>
<p id="section-4.2.7-4">For any End.DT2M SID with the REPLACE-CSID flavor, the value of <code>Arg.FE2</code> is 16 bits long. The SR segment endpoint node obtains the value <code>Arg.FE2</code> from the 16 most significant bits of <code>DA.Argument</code> if <code>DA.Arg.Index</code> is zero or from the 16 least significant bits of the next position in the current CSID container (<code>Segment List[Segments Left][DA.Arg.Index-1]</code>) otherwise (<code>DA.Arg.Index</code> is non-zero).<a href="#section-4.2.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-replace-flavors">
<section id="section-4.2.8">
          <h4 id="name-combination-with-psp-usp-and">
<a href="#section-4.2.8" class="section-number selfRef">4.2.8. </a><a href="#name-combination-with-psp-usp-and" class="section-name selfRef">Combination with PSP, USP, and USD Flavors</a>
          </h4>
<p id="section-4.2.8-1">PSP:
When combined with the REPLACE-CSID flavor, the additional PSP flavor instructions defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.1.2" class="relref">Section 4.16.1.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> are inserted after lines R09 and R20 of the pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a>, and the first line of the inserted instructions after R20 is modified as follows.<a href="#section-4.2.8-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.2.8-2">
<pre>
R20.1.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
             Segment List[0][DA.Arg.Index-1] == 0)) {
</pre><a href="#section-4.2.8-2" class="pilcrow">¶</a>
</div>
<aside id="section-4.2.8-3">
            <p id="section-4.2.8-3.1">Note: <code>Segment List[Segments Left][DA.Arg.Index-1]</code> identifies the value contained in the bits <code>[(DA.Arg.Index-1)*LNFL..DA.Arg.Index*LNFL-1]</code> in the SRH Segment List entry at index Segments Left.<a href="#section-4.2.8-3.1" class="pilcrow">¶</a></p>
</aside>
<span class="break"></span><dl class="dlParallel" id="section-4.2.8-4">
            <dt id="section-4.2.8-4.1">USP:</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.8-4.2">When combined with the REPLACE-CSID flavor, the
            line S03 of the pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> are
            substituted by the USP flavor instructions S03.1 to S03.4 defined
            in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.2" class="relref">Section 4.16.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>. Note that S03 is shown in the complete
            pseudocode in <a href="#sec-replace-end-complete" class="auto internal xref">Appendix A.6</a>.<a href="#section-4.2.8-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.8-4.3">USD:</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.8-4.4">The USD flavor defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.16.3" class="relref">Section 4.16.3</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> is unchanged when combined
            with the REPLACE-CSID flavor.<a href="#section-4.2.8-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="csid-allocation">
<section id="section-5">
      <h2 id="name-csid-allocation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-csid-allocation" class="section-name selfRef">CSID Allocation</a>
      </h2>
<p id="section-5-1">The CSID value of 0 is reserved. It is used to indicate the end of a CSID container.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In order to efficiently manage the CSID numbering space, a deployment may divide it into two non-overlapping sub-spaces: a GIB and a LIB.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The CSID values that are allocated from the GIB have a global semantic within the Locator-Block, while those that are allocated from the LIB have a local semantic on an SR segment endpoint node and within the scope of the Locator-Block.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The concept of LIB is applicable to SRv6 and specifically to its NEXT-CSID and REPLACE-CSID flavors. The shorter the CSID, the more benefit the LIB brings.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The opportunity to use these sub-spaces, their size, and their CSID allocation policy depends on the CSID length relative to the size of the network (e.g., number of nodes, links, service routes). Some guidelines for a typical deployment scenario are provided in the below subsections.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="global-csid">
<section id="section-5.1">
        <h3 id="name-global-csid">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-global-csid" class="section-name selfRef">Global CSID</a>
        </h3>
<p id="section-5.1-1">A global CSID is a CSID allocated from the GIB.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A global CSID identifies a segment defined at the Locator-Block level. The tuple (Locator-Block, CSID) identifies the same segment across all nodes of the SR domain. A typical example is a prefix segment bound to the End behavior.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">A node can have multiple global CSIDs under the same Locator-Block (e.g., one per IGP flexible algorithm (<span>[<a href="#RFC9350" class="cite xref">RFC9350</a>]</span>)). Multiple nodes may share the same global CSID (e.g., anycast <span>[<a href="#RFC4786" class="cite xref">RFC4786</a>]</span>).<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-csid">
<section id="section-5.2">
        <h3 id="name-local-csid">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-local-csid" class="section-name selfRef">Local CSID</a>
        </h3>
<p id="section-5.2-1">A local CSID is a CSID allocated from the LIB.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">A local CSID identifies a segment defined at the node level and within the scope of a particular Locator-Block. The tuple (Locator-Block, CSID) identifies a different segment on each node of the SR domain. A typical example is a non-routed Adjacency segment bound to the End.X behavior.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Let N1 and N2 be two different physical nodes of the SR domain and I a local CSID value: N1 may allocate value I to SID S1 and N2 may allocate the same value I to SID S2.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-csid-installation">
<section id="section-5.3">
        <h3 id="name-recommended-installation-of">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-recommended-installation-of" class="section-name selfRef">Recommended Installation of CSIDs in FIB</a>
        </h3>
<p id="section-5.3-1"><span><a href="https://rfc-editor.org/rfc/rfc8754#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> defines how an SR segment endpoint node identifies a locally instantiated SRv6 SID. To ensure that any valid argument value is accepted, an SR segment endpoint node instantiating a NEXT-CSID or REPLACE-CSID flavor SID should install a corresponding FIB entry that matches only the Locator and Function parts of the SID (i.e., with a prefix length of LBL + LNL + FL).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">In addition, an SR segment endpoint node instantiating NEXT-CSID flavor SIDs from both the GIB and LIB may install combined "Global + Local" FIB entries to match a sequence of global and local CSIDs in a single longest-prefix match (LPM) lookup.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">For example, let us consider an SR segment endpoint node 10 instantiating the following two NEXT-CSID flavor SIDs according to the CSID length, LBL, and GIB/LIB recommendations in this section.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1">
            <p id="section-5.3-4.1.1">The SID <code>2001:db8:b1:10::</code> bound to the End behavior with the NEXT-CSID flavor is instantiated from a GIB with:<a href="#section-5.3-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1.2.1">
                <p id="section-5.3-4.1.2.1.1">LBL = 48 (Locator-Block value <code>0x20010db800b1</code>),<a href="#section-5.3-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.1.2.2">
                <p id="section-5.3-4.1.2.2.1">LNL = 16 (Locator-Node value <code>0x0010</code>),<a href="#section-5.3-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.1.2.3">
                <p id="section-5.3-4.1.2.3.1">FL = 0, and<a href="#section-5.3-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.1.2.4">
                <p id="section-5.3-4.1.2.4.1">AL = 64.<a href="#section-5.3-4.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.3-4.2">
            <p id="section-5.3-4.2.1">The SID <code>2001:db8:b1:f123::</code> bound to the End.X behavior for its local IGP adjacency <code>123</code> with the NEXT-CSID flavor is instantiated from a LIB with:<a href="#section-5.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.2.2.1">
                <p id="section-5.3-4.2.2.1.1">LBL = 48 (Locator-Block value <code>0x20010db800b1</code>),<a href="#section-5.3-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.2.2.2">
                <p id="section-5.3-4.2.2.2.1">LNL = 0,<a href="#section-5.3-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.2.2.3">
                <p id="section-5.3-4.2.2.3.1">FL = 16 (Function value <code>0xf123</code>), and<a href="#section-5.3-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.3-4.2.2.4">
                <p id="section-5.3-4.2.2.4.1">AL = 64.<a href="#section-5.3-4.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-5.3-5">For SID <code>2001:db8:b1:10::</code>, Node 10 would install the FIB entry <code>2001:db8:b1:10::/64</code> bound to the End SID with the NEXT-CSID flavor.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">For SID <code>2001:db8:b1:f123::</code>, Node 10 would install the FIB entry <code>2001:db8:b1:f123::/64</code> bound to the End.X SID for adjacency <code>123</code> with the NEXT-CSID flavor.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">In addition, Node 10 may also install the combined FIB entry <code>2001:db8:b1:10:f123::/80</code> bound to the End.X SID for adjacency <code>123</code> with the NEXT-CSID flavor.<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3-8">As another example, let us consider an SR segment endpoint node 20 instantiating the following two REPLACE-CSID flavor SIDs according to the CSID length, LBL, and GIB/LIB recommendations in this section.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-9.1">
            <p id="section-5.3-9.1.1"><code>2001:db8:b2:20:1::</code> from a GIB with LBL = 48, LNL = 16, FL = 16, AL = 48, and bound to the End behavior with the REPLACE-CSID flavor.<a href="#section-5.3-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-9.2">
            <p id="section-5.3-9.2.1"><code>2001:db8:b2:20:123::</code> from a GIB with LBL = 48, LNL = 16, FL = 16, AL = 48, and bound to the End.X behavior for its local IGP adjacency <code>123</code> with the REPLACE-CSID flavor.<a href="#section-5.3-9.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-10">For SID <code>2001:db8:b2:20:1::</code>, Node 20 would install the FIB entry <code>2001:db8:b2:20:1::/80</code> bound to the End SID with the REPLACE-CSID flavor.<a href="#section-5.3-10" class="pilcrow">¶</a></p>
<p id="section-5.3-11">For SID <code>2001:db8:b2:20:123::</code>, Node 20 would install the FIB entry <code>2001:db8:b2:20:123::/80</code> bound to the End.X SID for adjacency <code>123</code> with the REPLACE-CSID flavor.<a href="#section-5.3-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-source-node">
<section id="section-6">
      <h2 id="name-sr-source-node">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-sr-source-node" class="section-name selfRef">SR Source Node</a>
      </h2>
<p id="section-6-1">An SR source node may learn from a control plane protocol (see <a href="#sec-control-plane" class="auto internal xref">Section 8</a>) or local configuration the SIDs that it can use in a segment list, along with their respective SRv6 endpoint behavior, structure, and any other relevant attribute (e.g., the set of L3 adjacencies associated with an End.X SID).<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="sid-validation-for-compression">
<section id="section-6.1">
        <h3 id="name-sid-validation-for-compress">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-sid-validation-for-compress" class="section-name selfRef">SID Validation for Compression</a>
        </h3>
<p id="section-6.1-1">As part of the compression process or as a preliminary step, the SR source node <span class="bcp14">MUST</span> validate the SID structure of each SID of this document in the segment list. The SR source node does so regardless of whether the segment list is explicitly configured, locally computed, or advertised by a controller (e.g., via BGP <span>[<a href="#I-D.ietf-idr-sr-policy-safi" class="cite xref">BGP-SR-Policy</a>]</span> or PCEP <span>[<a href="#RFC9603" class="cite xref">RFC9603</a>]</span>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A SID structure is valid for compression if it meets all the following conditions:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">The LBL is not 0.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">The LNFL is not 0.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.3">
            <p id="section-6.1-3.3.1">The AL is equal to 128-LBL-LNL-FL.<a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-4">When compressing a SID list, the SR source node <span class="bcp14">MUST</span> treat an invalid SID structure as unknown. A SID with an unknown SID structure is  not compressible.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5"><a href="#sec-control-plane" class="auto internal xref">Section 8</a> discusses how the SIDs of this document and their structure can be advertised to the SR source node through various control plane protocols. The SID structure may also be learned through configuration or
other management protocols. The details of such mechanisms are outside the scope of this document.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-source-compression">
<section id="section-6.2">
        <h3 id="name-segment-list-compression">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-segment-list-compression" class="section-name selfRef">Segment List Compression</a>
        </h3>
<p id="section-6.2-1">An SR source node <span class="bcp14">MAY</span> compress a SID list when it includes NEXT-CSID and/or REPLACE-CSID flavor SIDs to reduce the packet header length.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">It is out of the scope of this document to describe the mechanism through which an uncompressed SID list is derived, since such a mechanism may include a wide range of considerations independent of compression (e.g., minimizing a specific metric, excluding certain links, or providing a loop-free fast-reroute path). As general guidance for implementation or future specification, such a mechanism should aim to select the combination of SIDs that would result in the shortest compressed SID list. For example, by selecting a CSID flavor SID over an equivalent non-CSID flavor SID or by consistently selecting SIDs of the same CSID flavor within each routing domain.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The SID list that the SR source node pushes onto the packet <span class="bcp14">MUST</span> comply with the rules in Sections <a href="#sec-source-next" class="auto internal xref">6.3</a> and <a href="#sec-source-replace" class="auto internal xref">6.4</a> and express the same list of segments as the original SID list. If these rules are not followed, the packet may get dropped or misrouted.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">If an SR source node chooses to compress the SID list, one method is described below for illustrative purposes. Any other method producing a compressed SID list of equal or shorter length than the uncompressed SID list <span class="bcp14">MAY</span> be used.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">This method walks the uncompressed SID list and compresses each series of consecutive NEXT-CSID flavor SIDs and each series of consecutive REPLACE-CSID flavor SIDs.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-6.1">
            <p id="section-6.2-6.1.1">When the compression method encounters a series of one or
          more consecutive compressible NEXT-CSID flavor SIDs, it compresses
          the series as follows. A SID with the NEXT-CSID flavor is
          compressible if its structure is known to the SR source node and its
          Argument value is 0.<a href="#section-6.2-6.1.1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-6.2-6.1.2">
<pre>
S01. Initialize a NEXT-CSID container equal to the first SID in
       the series and initialize the remaining capacity of the
       CSID container to the AL of that SID
S02. For each subsequent SID in the series {
S03.   If the current SID Locator-Block matches that of the CSID
         container and the current SID LNFL is lower than or equal
         to the remaining capacity of the NEXT-CSID container {
S04.     Copy the current SID Locator-Node and Function to the
           most significant remaining Argument bits of the
           NEXT-CSID container and decrement the remaining
           capacity by LNFL
S05.   } Else {
S06.     Push the NEXT-CSID container onto the compressed SID list
S07.     Initialize a new NEXT-CSID container equal to the current
           SID in the series and initialize the remaining capacity
           of the NEXT-CSID container to the AL of that SID
S08.   } // End If
S09. } // End For
S10. If at least one SID remains in the uncompressed SID list
       (following the series of compressible NEXT-CSID flavor
       SIDs) {
S11.   Set S to the next SID in the uncompressed SID list
S12.   If S is advertised with a SID structure, and the
         Locator-Block of S matches that of the NEXT-CSID
         container, and the sum of the Locator-Node, Function, and
         Argument length of S is lower than or equal to the
         remaining capacity of the CSID container {
S13.     Copy the Locator-Node, Function, and Argument of S to the
           most significant remaining Argument bits of the CSID
           container
S14.   } // End If
S15. } // End If
S16. Push the NEXT-CSID container onto the compressed SID list
</pre><a href="#section-6.2-6.1.2" class="pilcrow">¶</a>
</div>
</li>
          <li class="normal" id="section-6.2-6.2">
            <p id="section-6.2-6.2.1">When the compression method encounters a series of
          REPLACE-CSID flavor SIDs of the same CSID length in the uncompressed
          SID list, it compresses the series as per the following high-level
          pseudocode. A compression checking function ComCheck(F, S) is
          defined to check if two SIDs F and S share the same SID structure
          and Locator-Block value, and if S has either no Argument or an
          Argument with value 0. If the check passes, then ComCheck(F,S)
          returns true.<a href="#section-6.2-6.2.1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-6.2-6.2.2">
<pre>
S01. Initialize a REPLACE-CSID container in full SID format equal
       to the first SID in the series
S02. Push the REPLACE-CSID container onto the compressed SID list
S03. Initialize a new REPLACE-CSID container in packed format if
       there are more than one SIDs and initialize the remaining
       capacity of the REPLACE-CSID container to 128 bits
S04. For each subsequent SID in the uncompressed SID list {
S05.   Set S to the current SID in the uncompressed SID list
S06.   If ComCheck(First SID, S) {
S07.     If the LNFL of S is lower than or equal to
           the remaining capacity of the REPLACE-CSID container {
S08.       Copy the Locator-Node and Function of S to the least
             significant remaining bits of the REPLACE-CSID
             container and decrement the remaining capacity by
             LNFL  // Note
S09.     } Else {
S10.       Push the REPLACE-CSID container onto the compressed SID
             list
S11.       Initialize a new REPLACE-CSID container in packed
             format with all bits set to 0
S12.       Copy the Locator-Node and Function of S to the least
             significant remaining bits of the REPLACE-CSID
             container and decrement the remaining capacity by
             LNFL  // Note
S13.     }
S14.     If S is not a REPLACE-CSID flavor SID, then break
S15.   } Else {
S16.     Break
S17.   } // End If
S18. } // End For
S19. Push the REPLACE-CSID container (if it is not empty) onto the
       compressed SID list
</pre><a href="#section-6.2-6.2.2" class="pilcrow">¶</a>
</div>
</li>
        </ul>
<aside id="section-6.2-7">
          <p id="section-6.2-7.1">Note: When the last CSID is an End.DT2M SID with the REPLACE-CSID flavor, if there are 0 or at least two CSID positions left in the current REPLACE-CSID container, the CSID is encoded as described above and the value of the <code>Arg.FE2</code> argument is placed in the 16 least significant bits of the next CSID position. Otherwise (if there is only one CSID position left in the current REPLACE-CSID container), the current REPLACE-CSID container is pushed onto the SID list (the value of the CSID position 0 remains zero) and the End.DT2M SID with the REPLACE-CSID flavor is encoded in full SID format with the value of the <code>Arg.FE2</code> argument in the 16 most significant bits of the SID Argument.<a href="#section-6.2-7.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-6.2-8">In all remaining cases (i.e., when the compression method encounters a SID in the uncompressed SID list that is not handled by any of the previous subroutines), it pushes this SID as is onto the compressed SID list.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<p id="section-6.2-9">Regardless of how a compressed SID list is produced, the SR source node writes it in the IPv6 packet as described in Sections <a href="https://rfc-editor.org/rfc/rfc8754#section-4.1" class="relref">4.1</a> and <a href="https://rfc-editor.org/rfc/rfc8754#section-4.1.1" class="relref">4.1.1</a> of <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>. The text is reproduced below for reference.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<blockquote id="section-6.2-10">
          <p id="section-6.2-10.1">A source node steers a packet into an SR Policy. If the SR Policy
results in a Segment List containing a single segment, and there is
no need to add information to the SRH flag or add TLV; the DA is set
to the single Segment List entry, and the SRH <span class="bcp14">MAY</span> be omitted.<a href="#section-6.2-10.1" class="pilcrow">¶</a></p>
<p id="section-6.2-10.2">When needed, the SRH is created as follows:<a href="#section-6.2-10.2" class="pilcrow">¶</a></p>
<p id="section-6.2-10.3">The Next Header and Hdr Ext Len fields are set as specified in
  <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>.<a href="#section-6.2-10.3" class="pilcrow">¶</a></p>
<p id="section-6.2-10.4">The Routing Type field is set to 4.<a href="#section-6.2-10.4" class="pilcrow">¶</a></p>
<p id="section-6.2-10.5">The DA of the packet is set with the value of the first segment.<a href="#section-6.2-10.5" class="pilcrow">¶</a></p>
<p id="section-6.2-10.6">The first element of the SRH Segment List is the ultimate segment.
  The second element is the penultimate segment, and so on.<a href="#section-6.2-10.6" class="pilcrow">¶</a></p>
<p id="section-6.2-10.7">The Segments Left field is set to n-1, where n is the number of
  elements in the SR Policy.<a href="#section-6.2-10.7" class="pilcrow">¶</a></p>
<p id="section-6.2-10.8">The Last Entry field is set to n-1, where n is the number of
  elements in the SR Policy.<a href="#section-6.2-10.8" class="pilcrow">¶</a></p>
<p id="section-6.2-10.9">TLVs (including HMAC) may be set according to their specification.<a href="#section-6.2-10.9" class="pilcrow">¶</a></p>
<p id="section-6.2-10.10">The packet is forwarded toward the packet's Destination Address
  (the first segment).<a href="#section-6.2-10.10" class="pilcrow">¶</a></p>
<p id="section-6.2-10.11">When a source does not require the entire SID list to be preserved
in the SRH, a reduced SRH may be used.<a href="#section-6.2-10.11" class="pilcrow">¶</a></p>
<p id="section-6.2-10.12">A reduced SRH does not contain the first segment of the related SR
Policy (the first segment is the one already in the DA of the IPv6
header), and the Last Entry field is set to n-2, where n is the
number of elements in the SR Policy.<a href="#section-6.2-10.12" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="sec-source-next">
<section id="section-6.3">
        <h3 id="name-rules-for-segment-lists-con">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-rules-for-segment-lists-con" class="section-name selfRef">Rules for Segment Lists Containing NEXT-CSID Flavor SIDs</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-6.3-1">
<li id="section-6.3-1.1">
            <p id="section-6.3-1.1.1">If a Destination Options header would follow an SRH with a segment list of more than one segment compressed as a single NEXT-CSID container, the SR source node <span class="bcp14">MUST NOT</span> omit the SRH.<a href="#section-6.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-1.2">
            <p id="section-6.3-1.2.1">When the last Segment List entry (index 0) in the SRH is a NEXT-CSID container representing more than one segment and the segment S preceding the first segment of this NEXT-CSID container in the segment list has the PSP flavor, then the PSP operation is performed at the SR segment endpoint node of S. If the PSP behavior should instead be performed at the penultimate segment along the path, then the SR source node <span class="bcp14">MUST NOT</span> compress the ultimate SID of the SID list into a NEXT-CSID container.<a href="#section-6.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-1.3">
            <p id="section-6.3-1.3.1">If a Destination Options header would follow an SRH with a last Segment List entry being a NEXT-CSID container representing more than one segment, the SR source node <span class="bcp14">MUST</span> ensure that the PSP operation is not performed before the penultimate SR segment endpoint node along the path.<a href="#section-6.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-1.4">
            <p id="section-6.3-1.4.1">When the Argument of a NEXT-CSID container is not used to full capacity, the remaining least significant bits of that Argument <span class="bcp14">MUST</span> be set to 0.<a href="#section-6.3-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="sec-source-replace">
<section id="section-6.4">
        <h3 id="name-rules-for-segment-lists-cont">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-rules-for-segment-lists-cont" class="section-name selfRef">Rules for Segment Lists Containing REPLACE-CSID Flavor SIDs</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-6.4-1">
<li id="section-6.4-1.1">
            <p id="section-6.4-1.1.1">All SIDs compressed in a REPLACE-CSID sequence <span class="bcp14">MUST</span> share the same Locator-Block and the same compression scheme.<a href="#section-6.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.4-1.2">
            <p id="section-6.4-1.2.1">All SIDs except the last one in a CSID sequence for REPLACE-CSID <span class="bcp14">MUST</span> have the REPLACE-CSID flavor. If the last REPLACE-CSID container is fully filled (i.e., the last CSID is at position 0 in the REPLACE-CSID container) and the last SID in the CSID sequence is not the last segment in the segment list, the last SID in the CSID sequence <span class="bcp14">MUST NOT</span> have the REPLACE-CSID flavor.<a href="#section-6.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.4-1.3">
            <p id="section-6.4-1.3.1">When a REPLACE-CSID flavor CSID is present as the last SID in a container that is not the last Segment List entry (index 0) in the SRH, the next element in the SID list <span class="bcp14">MUST</span> be a REPLACE-CSID container in packed format carrying at least one CSID.<a href="#section-6.4-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.4-2">The SR source node determines the compression scheme of REPLACE-CSID flavor SIDs as follows.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">When receiving a SID advertisement for a REPLACE-CSID flavor SID with LNL = 16, FL = 0, AL = 128-LBL-LNFL, and all zeros as the value of the Argument, the SR source node marks both the SID and its locator as using 16-bit compression. All other SIDs allocated from this locator with LNL = 16, FL = 16, AL = 128-LBL-LNFL, and all zeros as the value of the Argument are also marked as using 16-bit compression. When receiving a SID advertisement for a REPLACE-CSID flavor SID with LNFL = 32, AL = 128-LBL-LNFL, and all zeros as the value of the Argument, the SR source node marks both the SID and its locator as using 32-bit compression.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-source-checksum">
<section id="section-6.5">
        <h3 id="name-upper-layer-checksums">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-upper-layer-checksums" class="section-name selfRef">Upper-Layer Checksums</a>
        </h3>
<p id="section-6.5-1">The Destination Address used in the IPv6 pseudo-header (<span><a href="https://rfc-editor.org/rfc/rfc8200#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8200" class="cite xref">RFC8200</a>]</span>) is that of the ultimate destination.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">At the SR source node, that address will be the Destination Address as it is expected to be received by the ultimate destination. When the last element in the compressed SID list is a CSID container, this address can be obtained from the last element in the uncompressed SID list or by repeatedly applying the segment behavior as described in <a href="#sec-operations-icmp-error" class="auto internal xref">Section 9.4</a>. This applies regardless of whether an SRH is present in the IPv6 packet or is omitted.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">At the ultimate destination(s), that address will be in the Destination Address field of the IPv6 header.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-inter-domain">
<section id="section-7">
      <h2 id="name-inter-domain-compression">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-inter-domain-compression" class="section-name selfRef">Inter-Domain Compression</a>
      </h2>
<p id="section-7-1">Some SRv6 traffic may need to cross multiple routing domains, such as different Autonomous Systems (ASes) or different routing areas within an SR domain. Different routing domains may use different addressing schema and Locator-Blocks.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">A property of a CSID sequence is that all CSIDs in the sequence share the same Locator-Block. Therefore, a segment list that spans multiple routing domains using different Locator-Blocks may need a separate CSID sequence for each domain.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">This section defines a solution to improve the efficiency of CSID compression in multi-domain environments by enabling a CSID sequence to combine CSIDs having different Locator-Blocks.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The solution leverages two new SRv6 endpoint behaviors, "Endpoint with SRv6 Locator-Block Swap" ("End.LBS" for short) and "Endpoint with L3 cross-connect and SRv6 Locator-Block Swap" ("End.XLBS" for short), that enable modifying the Locator-Block for the next CSID in the CSID sequence at the routing domain boundary.<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="endlbs-locator-block-swap">
<section id="section-7.1">
        <h3 id="name-endlbs-locator-block-swap">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-endlbs-locator-block-swap" class="section-name selfRef">End.LBS: Locator-Block Swap</a>
        </h3>
<p id="section-7.1-1">The End.LBS behavior is a variant of the End behavior that modifies the Locator-Block of the active CSID sequence. This document defines the End.LBS behavior with the NEXT-CSID flavor and the End.LBS behavior with the REPLACE-CSID flavor.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">An End.LBS SID is used to transition to a new Locator-Block when the routing domain boundary is on the SR segment endpoint node.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Each instance of an End.LBS SID is associated with a target Locator-Block B2/m, where B2 is an IPv6 address prefix and m is the associated prefix length.
The original and target Locator-Blocks can have different prefix lengths as long as the new Destination Address formed by combining the target Locator-Block with the Locator-Node, Function, and Argument as described in the pseudocode of Sections <a href="#sec-next-endlbs" class="auto internal xref">7.1.1</a> and <a href="#sec-replace-endlbs" class="auto internal xref">7.1.2</a> is a valid IPv6 address.
The target Locator-Block is a local property of the End.LBS SID on the SR segment endpoint node.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<aside id="section-7.1-4">
          <p id="section-7.1-4.1">Note: a local SID property is an attribute associated with the SID when it is instantiated on the SR segment endpoint node. When the SR segment endpoint node identifies the Destination Address of a received packet as a locally instantiated SID, it also retrieves any local property associated with this SID. Other examples of local SID properties include the set of L3 adjacencies of an End.X SID (<span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>) and the lookup table of an End.DT6 SID (<span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.6" class="relref">Section 4.6</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>).<a href="#section-7.1-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-7.1-5">The means by which an SR source node learns the target Locator-Block associated with an End.LBS SID are outside the scope of this document. As examples, it could be learned via configuration or signaled by a controller.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<div id="sec-next-endlbs">
<section id="section-7.1.1">
          <h4 id="name-endlbs-with-next-csid">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-endlbs-with-next-csid" class="section-name selfRef">End.LBS with NEXT-CSID</a>
          </h4>
<p id="section-7.1.1-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.LBS SID with the NEXT-CSID flavor and associated with the target Locator-Block B2/m, the SR segment endpoint node applies the procedure specified in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a> with the lines N05 to N06 replaced as follows.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.1.1-2">
<pre>
N05.1. Initialize an IPv6 address A equal to B2.
N05.2. Copy DA.Argument into the bits [m..(m+AL-1)] of A.
N06.   Copy A to the Destination Address of the IPv6 header.
</pre><a href="#section-7.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endlbs">
<section id="section-7.1.2">
          <h4 id="name-endlbs-with-replace-csid">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-endlbs-with-replace-csid" class="section-name selfRef">End.LBS with REPLACE-CSID</a>
          </h4>
<p id="section-7.1.2-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.LBS SID with the REPLACE-CSID flavor and associated with the target Locator-Block B2/m, the SR segment endpoint node applies the procedure specified in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a> with the line R20 replaced as follows.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.1.2-2">
<pre>
R20.1. Initialize an IPv6 address A equal to B2.
R20.2. Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [m..m+LNFL-1] of A.
R20.3. Write DA.Arg.Index into the bits
         [(128-ceiling(log_2(128/LNFL)))..127] of A.
R20.4. Copy A to the Destination Address of the IPv6 header.
</pre><a href="#section-7.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="endxlbs-l3-cross-connect-and-locator-block-swap">
<section id="section-7.2">
        <h3 id="name-endxlbs-l3-cross-connect-an">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-endxlbs-l3-cross-connect-an" class="section-name selfRef">End.XLBS: L3 Cross-Connect and Locator-Block Swap</a>
        </h3>
<p id="section-7.2-1">The End.XLBS behavior is a variant of the End.X behavior that modifies the Locator-Block of the active CSID sequence. This document defines the End.XLBS behavior with the NEXT-CSID flavor and the End.XLBS behavior with the REPLACE-CSID flavor.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">An End.XLBS SID is used to transition to a new Locator-Block when the routing domain boundary is on a link adjacent to the SR segment endpoint node.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Each instance of an End.XLBS SID is associated with a target Locator-Block B2/m and a set, J, of one or more L3 adjacencies.
The original and target Locator-Blocks can have different prefix lengths as long as the new Destination Address formed by combining the target Locator-Block with the Locator-Node, Function, and Argument as described in the pseudocode of Sections <a href="#sec-next-endxlbs" class="auto internal xref">7.2.1</a> and <a href="#sec-replace-endxlbs" class="auto internal xref">7.2.2</a> is a valid IPv6 address.
The target Locator-Block and set of adjacencies are local properties of the End.XLBS SID on the SR segment endpoint node.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">The means by which an SR source node learns the target Locator-Block associated with an End.XLBS SID are outside the scope of this document. As examples, it could be learned via configuration or signaled by a controller.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<div id="sec-next-endxlbs">
<section id="section-7.2.1">
          <h4 id="name-endxlbs-with-next-csid">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-endxlbs-with-next-csid" class="section-name selfRef">End.XLBS with NEXT-CSID</a>
          </h4>
<p id="section-7.2.1-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.XLBS SID with the NEXT-CSID flavor and associated with the target Locator-Block B2/m, the SR segment endpoint node applies the procedure specified in <a href="#sec-next-endx" class="auto internal xref">Section 4.1.2</a> with the lines N05 to N06 (of the pseudocode in <a href="#sec-next-end" class="auto internal xref">Section 4.1.1</a>) replaced as follows.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.2.1-2">
<pre>
N05.1. Initialize an IPv6 address A equal to B2.
N05.2. Copy DA.Argument into the bits [m..(m+AL-1)] of A.
N06.   Copy A to the Destination Address of the IPv6 header.
</pre><a href="#section-7.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endxlbs">
<section id="section-7.2.2">
          <h4 id="name-endxlbs-with-replace-csid">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-endxlbs-with-replace-csid" class="section-name selfRef">End.XLBS with REPLACE-CSID</a>
          </h4>
<p id="section-7.2.2-1">When processing an IPv6 packet that matches a FIB entry locally instantiated as an End.XLBS SID with the REPLACE-CSID flavor and associated with the target Locator-Block B2/m, the SR segment endpoint node applies the procedure specified in <a href="#sec-replace-endx" class="auto internal xref">Section 4.2.2</a> with the line R20 (of the pseudocode in <a href="#sec-replace-end" class="auto internal xref">Section 4.2.1</a>) replaced as follows.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.2.2-2">
<pre>
R20.1. Initialize an IPv6 address A equal to B2.
R20.2. Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [m..m+LNFL-1] of A.
R20.3. Write DA.Arg.Index into the bits
         [(128-ceiling(log_2(128/LNFL)))..127] of A.
R20.4. Copy A to the Destination Address of the IPv6 header.
</pre><a href="#section-7.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-control-plane">
<section id="section-8">
      <h2 id="name-control-plane">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-control-plane" class="section-name selfRef">Control Plane</a>
      </h2>
<p id="section-8-1"><span><a href="https://rfc-editor.org/rfc/rfc8986#section-8" class="relref">Section 8</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> provides an overview of the control plane protocols used for signaling of the SRv6 endpoint behaviors introduced by that document, including the base SRv6 endpoint behaviors that are extended in the present document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The CSID-flavored behaviors introduced by this document are advertised in the same manner as their base SRv6 endpoint behaviors using the SRv6 extensions for various routing protocols, such as:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
          <p id="section-8-3.1.1">IS-IS <span>[<a href="#RFC9352" class="cite xref">RFC9352</a>]</span><a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.2">
          <p id="section-8-3.2.1">OSPFv3 <span>[<a href="#RFC9513" class="cite xref">RFC9513</a>]</span><a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.3">
          <p id="section-8-3.3.1">BGP <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>, <span>[<a href="#RFC9514" class="cite xref">RFC9514</a>]</span>, <span>[<a href="#I-D.ietf-idr-sr-policy-safi" class="cite xref">BGP-SR-Policy</a>]</span><a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.4">
          <p id="section-8-3.4.1">BGP-LS <span>[<a href="#I-D.ietf-idr-bgp-ls-sr-policy" class="cite xref">BGP-LS-SR-Policy</a>]</span><a href="#section-8-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.5">
          <p id="section-8-3.5.1">PCEP <span>[<a href="#RFC9603" class="cite xref">RFC9603</a>]</span><a href="#section-8-3.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-4">The SR segment endpoint node <span class="bcp14">MUST</span> set the SID Argument bits to 0 when advertising a locally instantiated SID of this document in the routing protocol (e.g., IS-IS <span>[<a href="#RFC9352" class="cite xref">RFC9352</a>]</span>, OSPF <span>[<a href="#RFC9513" class="cite xref">RFC9513</a>]</span>, or BGP-LS <span>[<a href="#RFC9514" class="cite xref">RFC9514</a>]</span>).<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Signaling the SRv6 SID Structure is <span class="bcp14">REQUIRED</span> for all the SIDs introduced in this document. It is used by an SR source node to compress a SID list as described in <a href="#sec-source-node" class="auto internal xref">Section 6</a>.
The node initiating the SID advertisement <span class="bcp14">MUST</span> set the length values in the SRv6 SID Structure to match the format of the SID on the SR segment endpoint node. For example, for a SID of this document instantiated from a /48 SRv6 SID block and a /64 Locator, and having a 16-bit Function, the SRv6 SID Structure advertisement carries the following values.<a href="#section-8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-6.1">
          <p id="section-8-6.1.1">LBL: 48<a href="#section-8-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.2">
          <p id="section-8-6.2.1">LNL: 16<a href="#section-8-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.3">
          <p id="section-8-6.3.1">FL: 16<a href="#section-8-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-6.4">
          <p id="section-8-6.4.1">AL: 48 (= 128-48-16-16)<a href="#section-8-6.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-7">A local CSID may be advertised in the control plane individually and/or in combination with a global CSID instantiated on the same SR segment endpoint node, with the End behavior, and the same Locator-Block and flavor as the local CSID. A combined global and local CSID is advertised as follows:<a href="#section-8-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-8.1">
          <p id="section-8-8.1.1">The SID Locator-Block is that shared by the global and local CSIDs<a href="#section-8-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.2">
          <p id="section-8-8.2.1">The SID Locator-Node is that of the global CSID<a href="#section-8-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.3">
          <p id="section-8-8.3.1">The SID Function is that of the local CSID<a href="#section-8-8.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.4">
          <p id="section-8-8.4.1">The SID AL is equal to 128-LBL-LNL-FL and the SID Argument value is 0<a href="#section-8-8.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-8.5">
          <p id="section-8-8.5.1">All other attributes of the SID (e.g., SRv6 endpoint behavior or algorithm) are those of the local CSID<a href="#section-8-8.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-9">The combined advertisement of local CSIDs with a global CSID is needed in particular for control plane protocols mandating that the SID is a subnet of a locator advertised in the same protocol (e.g., <span><a href="https://rfc-editor.org/rfc/rfc9352#section-8" class="relref">Section 8</a> of [<a href="#RFC9352" class="cite xref">RFC9352</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc9513#section-9" class="relref">Section 9</a> of [<a href="#RFC9513" class="cite xref">RFC9513</a>]</span> for advertising Adjacency SIDs in IS-IS and OSPFv3, respectively).<a href="#section-8-9" class="pilcrow">¶</a></p>
<p id="section-8-10">For a segment list computed by a controller and signaled to an SR source node (e.g., via BGP <span>[<a href="#I-D.ietf-idr-sr-policy-safi" class="cite xref">BGP-SR-Policy</a>]</span> or PCEP <span>[<a href="#RFC9603" class="cite xref">RFC9603</a>]</span>), the controller provides the ordered segment list comprising the uncompressed SIDs, with their respective behavior and structure, to the SR source node. The SR source node may then compress the SID list as described in <a href="#sec-source-node" class="auto internal xref">Section 6</a>.<a href="#section-8-10" class="pilcrow">¶</a></p>
<p id="section-8-11">When a node receives an advertisement of a SID of this document that it does not support, it handles the advertisement as described in the corresponding control plane specification (e.g., Sections <a href="https://rfc-editor.org/rfc/rfc9352#section-7.2" class="relref">7.2</a>, <a href="https://rfc-editor.org/rfc/rfc9352#section-8.1" class="relref">8.1</a>, and <a href="https://rfc-editor.org/rfc/rfc9352#section-8.2" class="relref">8.2</a> of <span>[<a href="#RFC9352" class="cite xref">RFC9352</a>]</span>, Sections <a href="https://rfc-editor.org/rfc/rfc9513#section-8" class="relref">8</a>, <a href="https://rfc-editor.org/rfc/rfc9513#section-9.1" class="relref">9.1</a>, and <a href="https://rfc-editor.org/rfc/rfc9513#section-9.2" class="relref">9.2</a> of <span>[<a href="#RFC9513" class="cite xref">RFC9513</a>]</span>, and <span><a href="https://rfc-editor.org/rfc/rfc9252#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>).<a href="#section-8-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operational-considerations">
<section id="section-9">
      <h2 id="name-operational-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<div id="flavor-block-and-csid-length">
<section id="section-9.1">
        <h3 id="name-flavor-block-and-csid-lengt">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-flavor-block-and-csid-lengt" class="section-name selfRef">Flavor, Block, and CSID Length</a>
        </h3>
<p id="section-9.1-1">SRv6 is intended for use in a variety of networks that require different prefix lengths and SID numbering spaces. Each of the two flavors introduced in this document comes with its own recommendations for Locator-Block and CSID length, as specified in Sections <a href="#sec-next" class="auto internal xref">4.1</a> and <a href="#sec-replace" class="auto internal xref">4.2</a>. These flavors are best suited for different environments, depending on the requirements of the network. For instance, larger CSID lengths may be more suitable for networks requiring ample SID numbering space, while smaller CSID lengths are better for compression efficiency. The two compression flavors allow the compressed segment list encoding to adapt to a range of requirements, with support for multiple compression levels. Network operators can choose the flavor that best suits their use case, deployment design, and network scale.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Both CSID flavors can coexist in the same SR domain, on the same SR segment endpoint node, and even in the same segment list. However, operators should generally avoid instantiating SIDs of different CSID flavors within the same routing domain or Locator-Block since these SIDs have different length and allocation recommendations (see Sections <a href="#sec-next" class="auto internal xref">4.1</a>, <a href="#sec-replace" class="auto internal xref">4.2</a>, and <a href="#sec-csid-lib-recommendation" class="auto internal xref">9.2</a>). In a multi-domain deployment, different flavors may be used in different routing domains of the SR domain.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">A deployment should use consistent LBLs and CSID lengths for all SIDs within a routing domain. Heterogeneous lengths, while possible, may impact the compression efficiency.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">The compressed segment list encoding works with various Locator-Block allocations. For example, each routing domain within the SR domain can be allocated a /48 Locator-Block from a global IPv6 block available to the operator or from a prefix allocated to SRv6 SIDs as discussed in <span><a href="https://rfc-editor.org/rfc/rfc9602#section-5" class="relref">Section 5</a> of [<a href="#RFC9602" class="cite xref">RFC9602</a>]</span>.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-csid-lib-recommendation">
<section id="section-9.2">
        <h3 id="name-gib-lib-usage">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-gib-lib-usage" class="section-name selfRef">GIB/LIB Usage</a>
        </h3>
<p id="section-9.2-1">GIB and LIB usage is a local implementation and/or configuration decision; however, some guidelines for determining usage for specific SRv6 endpoint behaviors and recommendations are provided.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The GIB number space is shared among all SR segment endpoint nodes using SRv6 locators under a Locator-Block space.  The more SIDs assigned from this space, per node, the faster it is exhausted.  Therefore, its use is prioritized for global segments, such as SIDs that identify a node.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">The LIB number space is unique per node. Each node can fully utilize the entire LIB number space without consideration for assignments at other nodes.  Therefore, its use is prioritized for local segments, such as SIDs that identify services (of which there may be many) at nodes, cross-connects, or adjacencies.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">While a longer CSID length permits more flexibility in which SRv6 endpoint behaviors may be assigned from the GIB, it also reduces the compression efficiency.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">Given the previous Locator-Block and CSID length recommendations, the following GIB/LIB usage is recommended:<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-6.1">
            <p id="section-9.2-6.1.1">NEXT-CSID:<a href="#section-9.2-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-6.1.2.1">
                <p id="section-9.2-6.1.2.1.1">GIB: End<a href="#section-9.2-6.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2-6.1.2.2">
                <p id="section-9.2-6.1.2.2.1">LIB: End.X, End.T, End.DT4/6/46/2U/2M, End.DX4/6/2/2V (including large-scale pseudowire), End.B6.Encaps, End.B6.Encaps.Red, End.BM, End.LBS, and End.XLBS<a href="#section-9.2-6.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-9.2-6.2">
            <p id="section-9.2-6.2.1">REPLACE-CSID:<a href="#section-9.2-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-6.2.2.1">
                <p id="section-9.2-6.2.2.1.1">GIB: End, End.X, End.T, End.DT4/6/46/2U/2M, End.DX4/6/2/2V, End.B6.Encaps, End.B6.Encaps.Red, End.BM, End.LBS, and End.XLBS<a href="#section-9.2-6.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.2-6.2.2.2">
                <p id="section-9.2-6.2.2.2.1">LIB: End.DX2/2V for large-scale pseudowire<a href="#section-9.2-6.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-9.2-7">Any other allocation is possible but may lead to a suboptimal use of the CSID numbering space.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pinging-a-sid">
<section id="section-9.3">
        <h3 id="name-pinging-a-sid">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-pinging-a-sid" class="section-name selfRef">Pinging a SID</a>
        </h3>
<p id="section-9.3-1">An SR source node may ping an SRv6 SID by sending an ICMPv6 echo request packet destined to the SRv6 SID. The SR source node may ping the target SID with a SID list comprising only that target SID or with a longer one that comprises two or more SIDs. In that case, the target SID is the last element in the SID list. This operation is illustrated in <span><a href="https://rfc-editor.org/rfc/rfc9259#appendix-A.1.2" class="relref">Appendix A.1.2</a> of [<a href="#RFC9259" class="cite xref">RFC9259</a>]</span>.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">When pinging a SID of this document, the SR source node <span class="bcp14">MUST</span> construct the IPv6 packet as described in <a href="#sec-source-node" class="auto internal xref">Section 6</a>, including computing the ICMPv6 checksum as described in <a href="#sec-source-checksum" class="auto internal xref">Section 6.5</a>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">In particular, when pinging a SID of this document with a SID list comprising only the target SID, the SR source node places the SID with Argument value 0 in the Destination Address of the ICMPv6 echo request and computes the ICMPv6 checksum using this SID as the Destination Address in the IPv6 pseudo-header. The Argument value 0 allows the SID SR segment endpoint node (<a href="#sec-endpoint" class="auto internal xref">Section 4</a>) to identify itself as the ultimate destination of the packet and process the ICMPv6 payload.
Therefore, any existing IPv6 ping implementation can originate ICMP echo requests to a NEXT-CSID or REPLACE-CSID flavor SID with a SID list comprising only the target SID, provided that the user ensures that the SID Argument is 0.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-operations-icmp-error">
<section id="section-9.4">
        <h3 id="name-icmp-error-processing">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-icmp-error-processing" class="section-name selfRef">ICMP Error Processing</a>
        </h3>
<p id="section-9.4-1">When an IPv6 node encounters an error while processing a packet, it may report that error by sending an IPv6 error message to the packet source with an enclosed copy of the invoking packet. For the source of an invoking packet to process the ICMP error message, the ultimate Destination Address of the IPv6 header may be required.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2"><span><a href="https://rfc-editor.org/rfc/rfc8754#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> defines the logic that an SR source node follows to determine the ultimate destination of an invoking packet containing an SRH.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">For an SR source node that supports the compressed segment list encoding defined in this document, the logic to determine the ultimate destination is generalized as follows.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.4-4.1">
            <p id="section-9.4-4.1.1">If the Destination Address of the invoking IPv6 packet matches a known SRv6 SID, modify the invoking IPv6 packet by applying the SRv6 endpoint behavior associated with the matched SRv6 SID;<a href="#section-9.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.4-4.2">
            <p id="section-9.4-4.2.1">Repeat until the application of the SRv6 endpoint behavior would result in the processing of the upper-layer header.<a href="#section-9.4-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.4-5">The Destination Address of the resulting IPv6 packet may be used as the ultimate destination of the invoking IPv6 packet.<a href="#section-9.4-5" class="pilcrow">¶</a></p>
<p id="section-9.4-6">Since the SR source node that needs to determine the ultimate destination is the same node that originally built the SID list in the invoking packet, it can perform this operation for all the SIDs in the packet.<a href="#section-9.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-future">
<section id="section-10">
      <h2 id="name-applicability-to-other-srv6">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-applicability-to-other-srv6" class="section-name selfRef">Applicability to Other SRv6 Endpoint Behaviors</a>
      </h2>
<p id="section-10-1">Future documents may extend the applicability of the NEXT-CSID and REPLACE-CSID flavors to other SRv6 endpoint behaviors.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">For an SRv6 endpoint behavior that can be used before the last position of a segment list, a CSID flavor is defined by reproducing the same logic as described in Sections <a href="#sec-next" class="auto internal xref">4.1</a> and <a href="#sec-replace" class="auto internal xref">4.2</a> to determine the next SID in the SID list.<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1"><span><a href="https://rfc-editor.org/rfc/rfc8402#section-8" class="relref">Section 8</a> of [<a href="#RFC8402" class="cite xref">RFC8402</a>]</span> discusses the security considerations for Segment Routing.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2"><span><a href="https://rfc-editor.org/rfc/rfc8754#section-5" class="relref">Section 5</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> describes the intra-SR-domain deployment model and how to secure it. <span><a href="https://rfc-editor.org/rfc/rfc8754#section-7" class="relref">Section 7</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> describes the threats applicable to SRv6 and how to mitigate them.<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3"><span><a href="https://rfc-editor.org/rfc/rfc8986#section-9" class="relref">Section 9</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> discusses the security considerations applicable to the SRv6 network programming framework, as well as the SR source node and SR segment endpoint node behaviors that it defines.<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">This document introduces two new flavors, NEXT-CSID and REPLACE-CSID, for some of the SRv6 endpoint behaviors defined in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> and a method by which an SR source node may leverage the SIDs of these flavors to produce a compressed segment list encoding.<a href="#section-11-4" class="pilcrow">¶</a></p>
<p id="section-11-5">This document also introduces two new SRv6 endpoint behaviors, End.LBS and End.XLBS, to preserve the efficiency of CSID compression in multi-domain environments.<a href="#section-11-5" class="pilcrow">¶</a></p>
<p id="section-11-6">An SR source node constructs an IPv6 packet with a compressed segment list encoding as defined in Sections <a href="https://rfc-editor.org/rfc/rfc8754#section-3.1" class="relref">3.1</a> and <a href="https://rfc-editor.org/rfc/rfc8754#section-4.1" class="relref">4.1</a> of <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8986#section-5" class="relref">Section 5</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>. The paths that an SR source node may enforce using a compressed segment list encoding are the same, from a topology and service perspective, as those that an SR source node could enforce using the SIDs of <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">An SR segment endpoint node processes an IPv6 packet matching a locally instantiated SID as defined in <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>, with the pseudocode modifications in <a href="#sec-endpoint" class="auto internal xref">Section 4</a> of this document. These modifications change how the SR segment endpoint node determines the next SID in the packet but not the semantic of either the active or the next SID. For example, an adjacency segment instantiated with the End.X behavior remains an adjacency segment regardless of whether it uses the base End.X behavior defined in <span><a href="https://rfc-editor.org/rfc/rfc8986#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> or a CSID flavor of that behavior. This document does not introduce any new SID semantic.<a href="#section-11-7" class="pilcrow">¶</a></p>
<p id="section-11-8">Any other transit node processes the packet as described in <span><a href="https://rfc-editor.org/rfc/rfc8754#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>.<a href="#section-11-8" class="pilcrow">¶</a></p>
<p id="section-11-9">This document defines a new method of encoding the SIDs inside a SID list at the SR source node (<a href="#sec-source-node" class="auto internal xref">Section 6</a>) and decoding them at the SR segment endpoint node (see Sections <a href="#sec-endpoint" class="auto internal xref">4</a> and <a href="#sec-inter-domain" class="auto internal xref">7</a>), but it does not change how the SID list itself is encoded in the IPv6 packet nor the semantic of any segment that it comprises. Therefore, this document is subject to the same security considerations that are discussed in <span>[<a href="#RFC8402" class="cite xref">RFC8402</a>]</span>, <span>[<a href="#RFC8754" class="cite xref">RFC8754</a>]</span>, and <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span>.<a href="#section-11-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-12">
      <h2 id="name-iana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="srv6-endpoint-behaviors">
<section id="section-12.1">
        <h3 id="name-srv6-endpoint-behaviors">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-srv6-endpoint-behaviors" class="section-name selfRef">SRv6 Endpoint Behaviors</a>
        </h3>
<p id="section-12.1-1">IANA has updated the reference of the following registrations from the "SRv6 Endpoint Behaviors" registry under the "Segment Routing" registry group (<span>&lt;<a href="https://www.iana.org/assignments/segment-routing/">https://www.iana.org/assignments/segment-routing/</a>&gt;</span>) to point to this document and transfer change control to the IETF.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<span id="name-srv6-endpoint-behaviors-reg"></span><div id="tbl-iana-endpoint-behaviors">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-srv6-endpoint-behaviors-reg" class="selfRef">SRv6 Endpoint Behaviors Registration List</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">43</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">44</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">45</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">46</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">47</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">48</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">49</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">50</td>
              <td class="text-left" rowspan="1" colspan="1">End with NEXT-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">52</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">53</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">54</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">55</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">56</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">57</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">58</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">59</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with NEXT-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">85</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">86</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">87</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">88</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">89</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">90</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">91</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">92</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with NEXT-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">93</td>
              <td class="text-left" rowspan="1" colspan="1">End.B6.Encaps with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">94</td>
              <td class="text-left" rowspan="1" colspan="1">End.B6.Encaps.Red with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">95</td>
              <td class="text-left" rowspan="1" colspan="1">End.BM with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">96</td>
              <td class="text-left" rowspan="1" colspan="1">End.LBS with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">97</td>
              <td class="text-left" rowspan="1" colspan="1">End.XLBS with NEXT-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">101</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">102</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">103</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">104</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">105</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">106</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">107</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">108</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">109</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">110</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID &amp; PSP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">111</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">112</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID, PSP &amp; USP</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">114</td>
              <td class="text-left" rowspan="1" colspan="1">End.B6.Encaps with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">115</td>
              <td class="text-left" rowspan="1" colspan="1">End.BM with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">116</td>
              <td class="text-left" rowspan="1" colspan="1">End.DX6 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">117</td>
              <td class="text-left" rowspan="1" colspan="1">End.DX4 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">118</td>
              <td class="text-left" rowspan="1" colspan="1">End.DT6 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">119</td>
              <td class="text-left" rowspan="1" colspan="1">End.DT4 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">120</td>
              <td class="text-left" rowspan="1" colspan="1">End.DT46 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">121</td>
              <td class="text-left" rowspan="1" colspan="1">End.DX2 with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">122</td>
              <td class="text-left" rowspan="1" colspan="1">End.DX2V with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">123</td>
              <td class="text-left" rowspan="1" colspan="1">End.DT2U with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">124</td>
              <td class="text-left" rowspan="1" colspan="1">End.DT2M with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">127</td>
              <td class="text-left" rowspan="1" colspan="1">End.B6.Encaps.Red with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">128</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">129</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">130</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">131</td>
              <td class="text-left" rowspan="1" colspan="1">End with REPLACE-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">132</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">133</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">134</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">135</td>
              <td class="text-left" rowspan="1" colspan="1">End.X with REPLACE-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">136</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">137</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID, PSP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">138</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">139</td>
              <td class="text-left" rowspan="1" colspan="1">End.T with REPLACE-CSID, PSP, USP &amp; USD</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">140</td>
              <td class="text-left" rowspan="1" colspan="1">End.LBS with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">141</td>
              <td class="text-left" rowspan="1" colspan="1">End.XLBS with REPLACE-CSID</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9800</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8754">[RFC8754]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Dukes, D., Ed.</span>, <span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">D. Voyer</span>, <span class="refTitle">"IPv6 Segment Routing Header (SRH)"</span>, <span class="seriesInfo">RFC 8754</span>, <span class="seriesInfo">DOI 10.17487/RFC8754</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-idr-bgp-ls-sr-policy">[BGP-LS-SR-Policy]</dt>
        <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Dong, J.</span>, <span class="refAuthor">Gredler, H.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"Advertisement of Segment Routing Policies using BGP Link-State"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-bgp-ls-sr-policy-17</span>, <time datetime="2025-03-06" class="refDate">6 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-bgp-ls-sr-policy-17">https://datatracker.ietf.org/doc/html/draft-ietf-idr-bgp-ls-sr-policy-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-sr-policy-safi">[BGP-SR-Policy]</dt>
        <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Mattes, P.</span>, and <span class="refAuthor">D. Jain</span>, <span class="refTitle">"Advertising Segment Routing Policies in BGP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-sr-policy-safi-13</span>, <time datetime="2025-02-06" class="refDate">6 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-sr-policy-safi-13">https://datatracker.ietf.org/doc/html/draft-ietf-idr-sr-policy-safi-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GKP94">[GKP94]</dt>
        <dd>
<span class="refAuthor">Graham, R.</span>, <span class="refAuthor">Knuth, D.</span>, and <span class="refAuthor">O. Patashnik</span>, <span class="refTitle">"Concrete Mathematics: A Foundation for Computer Science"</span>, <span class="seriesInfo">ISBN 9780201558029</span>, <time datetime="1994" class="refDate">1994</time>. </dd>
<dd class="break"></dd>
<dt id="RFC4786">[RFC4786]</dt>
        <dd>
<span class="refAuthor">Abley, J.</span> and <span class="refAuthor">K. Lindqvist</span>, <span class="refTitle">"Operation of Anycast Services"</span>, <span class="seriesInfo">BCP 126</span>, <span class="seriesInfo">RFC 4786</span>, <span class="seriesInfo">DOI 10.17487/RFC4786</span>, <time datetime="2006-12" class="refDate">December 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4786">https://www.rfc-editor.org/info/rfc4786</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9252">[RFC9252]</dt>
        <dd>
<span class="refAuthor">Dawra, G., Ed.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9252</span>, <span class="seriesInfo">DOI 10.17487/RFC9252</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9252">https://www.rfc-editor.org/info/rfc9252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9259">[RFC9259]</dt>
        <dd>
<span class="refAuthor">Ali, Z.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Matsushima, S.</span>, <span class="refAuthor">Voyer, D.</span>, and <span class="refAuthor">M. Chen</span>, <span class="refTitle">"Operations, Administration, and Maintenance (OAM) in Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9259</span>, <span class="seriesInfo">DOI 10.17487/RFC9259</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9259">https://www.rfc-editor.org/info/rfc9259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9350">[RFC9350]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Hegde, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, and <span class="refAuthor">A. Gulko</span>, <span class="refTitle">"IGP Flexible Algorithm"</span>, <span class="seriesInfo">RFC 9350</span>, <span class="seriesInfo">DOI 10.17487/RFC9350</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9350">https://www.rfc-editor.org/info/rfc9350</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9352">[RFC9352]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Bashandy, A.</span>, <span class="refAuthor">Decraene, B.</span>, and <span class="refAuthor">Z. Hu</span>, <span class="refTitle">"IS-IS Extensions to Support Segment Routing over the IPv6 Data Plane"</span>, <span class="seriesInfo">RFC 9352</span>, <span class="seriesInfo">DOI 10.17487/RFC9352</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9352">https://www.rfc-editor.org/info/rfc9352</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9513">[RFC9513]</dt>
        <dd>
<span class="refAuthor">Li, Z.</span>, <span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, and <span class="refAuthor">P. Psenak</span>, <span class="refTitle">"OSPFv3 Extensions for Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9513</span>, <span class="seriesInfo">DOI 10.17487/RFC9513</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9513">https://www.rfc-editor.org/info/rfc9513</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9514">[RFC9514]</dt>
        <dd>
<span class="refAuthor">Dawra, G.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Chen, M.</span>, <span class="refAuthor">Bernier, D.</span>, and <span class="refAuthor">B. Decraene</span>, <span class="refTitle">"Border Gateway Protocol - Link State (BGP-LS) Extensions for Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9514</span>, <span class="seriesInfo">DOI 10.17487/RFC9514</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9514">https://www.rfc-editor.org/info/rfc9514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9602">[RFC9602]</dt>
        <dd>
<span class="refAuthor">Krishnan, S.</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Segment Identifiers in the IPv6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 9602</span>, <span class="seriesInfo">DOI 10.17487/RFC9602</span>, <time datetime="2024-10" class="refDate">October 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9602">https://www.rfc-editor.org/info/rfc9602</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9603">[RFC9603]</dt>
      <dd>
<span class="refAuthor">Li, C., Ed.</span>, <span class="refAuthor">Kaladharan, P.</span>, <span class="refAuthor">Sivabalan, S.</span>, <span class="refAuthor">Koldychev, M.</span>, and <span class="refAuthor">Y. Zhu</span>, <span class="refTitle">"Path Computation Element Communication Protocol (PCEP) Extensions for IPv6 Segment Routing"</span>, <span class="seriesInfo">RFC 9603</span>, <span class="seriesInfo">DOI 10.17487/RFC9603</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9603">https://www.rfc-editor.org/info/rfc9603</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="complete-pseudocodes">
<section id="appendix-A">
      <h2 id="name-complete-pseudocodes">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-complete-pseudocodes" class="section-name selfRef">Complete Pseudocodes</a>
      </h2>
<p id="appendix-A-1">The content of this section is purely informative rendering of the pseudocodes of <span>[<a href="#RFC8986" class="cite xref">RFC8986</a>]</span> with the modifications in this document. This rendering may not be used as a reference.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="sec-next-end-complete">
<section id="appendix-A.1">
        <h3 id="name-end-with-next-csid-2">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-end-with-next-csid-2" class="section-name selfRef">End with NEXT-CSID</a>
        </h3>
<p id="appendix-A.1-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End SID with the NEXT-CSID flavor:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.1-2">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address
           with Code 0 (Hop limit exceeded in transit),
           interrupt packet processing, and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.   Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
N09. }
S02. If (Segments Left == 0) {
S03.   Stop processing the SRH and proceed to process the next
         header in the packet, whose type is identified by
         the Next Header field in the routing header.
S04. }
S05. If (IPv6 Hop Limit &lt;= 1) {
S06.   Send an ICMP Time Exceeded message to the Source Address
         with Code 0 (Hop limit exceeded in transit),
         interrupt packet processing, and discard the packet.
S07. }
S08. max_LE = (Hdr Ext Len / 2) - 1
S09. If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)) {
S10.   Send an ICMP Parameter Problem to the Source Address
         with Code 0 (Erroneous header field encountered)
         and Pointer set to the Segments Left field,
         interrupt packet processing, and discard the packet.
S11. }
S12. Decrement IPv6 Hop Limit by 1.
S13. Decrement Segments Left by 1.
S14. Update IPv6 DA with Segment List[Segments Left].
S15. Submit the packet to the egress IPv6 FIB lookup for
       transmission to the new destination.
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">Before processing the upper-layer header or any IPv6 extension header other than Hop-by-Hop or Destination Options of a packet matching a FIB entry locally instantiated as an End SID with the NEXT-CSID flavor:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.1-4">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.   Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
N09. }
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-5">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End SID with the NEXT-CSID flavor:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.1-6">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
         with Code 4 (SR Upper-layer Header Error)
         and Pointer set to the offset of the upper-layer header,
         interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-next-endx-complete">
<section id="appendix-A.2">
        <h3 id="name-endx-with-next-csid-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-endx-with-next-csid-2" class="section-name selfRef">End.X with NEXT-CSID</a>
        </h3>
<p id="appendix-A.2-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.X SID with the NEXT-CSID flavor:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.2-2">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address
           with Code 0 (Hop limit exceeded in transit),
           interrupt packet processing, and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.   Submit the packet to the IPv6 module for transmission to the
         new destination via a member of J.
N09. }
S02. If (Segments Left == 0) {
S03.   Stop processing the SRH and proceed to process the next
         header in the packet, whose type is identified by
         the Next Header field in the routing header.
S04. }
S05. If (IPv6 Hop Limit &lt;= 1) {
S06.   Send an ICMP Time Exceeded message to the Source Address
         with Code 0 (Hop limit exceeded in transit),
         interrupt packet processing, and discard the packet.
S07. }
S08. max_LE = (Hdr Ext Len / 2) - 1
S09. If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)) {
S10.   Send an ICMP Parameter Problem to the Source Address
         with Code 0 (Erroneous header field encountered)
         and Pointer set to the Segments Left field,
         interrupt packet processing, and discard the packet.
S11. }
S12. Decrement IPv6 Hop Limit by 1.
S13. Decrement Segments Left by 1.
S14. Update IPv6 DA with Segment List[Segments Left].
S15. Submit the packet to the IPv6 module for transmission
       to the new destination via a member of J.
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-3">Before processing the upper-layer header or any IPv6 extension header other than Hop-by-Hop or Destination Options of a packet matching a FIB entry locally instantiated as an End.X SID with the NEXT-CSID flavor:<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.2-4">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.   Submit the packet to the IPv6 module for transmission to the
         new destination via a member of J.
N09. }
</pre><a href="#appendix-A.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-5">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.X SID with the NEXT-CSID flavor:<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.2-6">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
         with Code 4 (SR Upper-layer Header Error)
         and Pointer set to the offset of the upper-layer header,
         interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-next-endt-complete">
<section id="appendix-A.3">
        <h3 id="name-endt-with-next-csid-2">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-endt-with-next-csid-2" class="section-name selfRef">End.T with NEXT-CSID</a>
        </h3>
<p id="appendix-A.3-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.T SID with the NEXT-CSID flavor:<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.3-2">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address
           with Code 0 (Hop limit exceeded in transit),
           interrupt packet processing, and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Set the packet's associated FIB table to T.
N08.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
N09. }
S02. If (Segments Left == 0) {
S03.   Stop processing the SRH and proceed to process the next
         header in the packet, whose type is identified by
         the Next Header field in the routing header.
S04. }
S05. If (IPv6 Hop Limit &lt;= 1) {
S06.   Send an ICMP Time Exceeded message to the Source Address
         with Code 0 (Hop limit exceeded in transit),
         interrupt packet processing, and discard the packet.
S07. }
S08. max_LE = (Hdr Ext Len / 2) - 1
S09. If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)) {
S10.   Send an ICMP Parameter Problem to the Source Address
         with Code 0 (Erroneous header field encountered)
         and Pointer set to the Segments Left field,
         interrupt packet processing, and discard the packet.
S11. }
S12. Decrement IPv6 Hop Limit by 1.
S13. Decrement Segments Left by 1.
S14. Update IPv6 DA with Segment List[Segments Left].
S15.1. Set the packet's associated FIB table to T.
S15.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
</pre><a href="#appendix-A.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3-3">Before processing the upper-layer header or any IPv6 extension header other than Hop-by-Hop or Destination Options of a packet matching a FIB entry locally instantiated as an End.T SID with the NEXT-CSID flavor:<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.3-4">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Set the packet's associated FIB table to T.
N08.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
N09. }
</pre><a href="#appendix-A.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3-5">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.T SID with the NEXT-CSID flavor:<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.3-6">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
         with Code 4 (SR Upper-layer Header Error)
         and Pointer set to the offset of the upper-layer header,
         interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-next-endb6-complete">
<section id="appendix-A.4">
        <h3 id="name-endb6encaps-with-next-csid-2">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-endb6encaps-with-next-csid-2" class="section-name selfRef">End.B6.Encaps with NEXT-CSID</a>
        </h3>
<p id="appendix-A.4-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.B6.Encaps SID with the NEXT-CSID flavor:<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.4-2">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Push a new IPv6 header with its own SRH containing B.
N08.2. Set the outer IPv6 SA to A.
N08.3. Set the outer IPv6 DA to the first SID of B.
N08.4. Set the outer Payload Length, Traffic Class, Flow Label,
         Hop Limit, and Next Header fields.
N08.5. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
N09. }
S02. If (Segments Left == 0) {
S03.   Stop processing the SRH and proceed to process the next
         header in the packet, whose type is identified by
         the Next Header field in the routing header.
S04. }
S05. If (IPv6 Hop Limit &lt;= 1) {
S06.   Send an ICMP Time Exceeded message to the Source Address
         with Code 0 (Hop limit exceeded in transit),
         interrupt packet processing, and discard the packet.
S07. }
S08. max_LE = (Hdr Ext Len / 2) - 1
S09. If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)) {
S10.   Send an ICMP Parameter Problem to the Source Address
         with Code 0 (Erroneous header field encountered)
         and Pointer set to the Segments Left field,
         interrupt packet processing, and discard the packet.
S11. }
S12. Decrement IPv6 Hop Limit by 1.
S13. Decrement Segments Left by 1.
S14. Update IPv6 DA with Segment List[Segments Left].
S15. Push a new IPv6 header with its own SRH containing B.
S16. Set the outer IPv6 SA to A.
S17. Set the outer IPv6 DA to the first SID of B.
S18. Set the outer Payload Length, Traffic Class, Flow Label,
       Hop Limit, and Next Header fields.
S19. Submit the packet to the egress IPv6 FIB lookup for
       transmission to the new destination.
</pre><a href="#appendix-A.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4-3">Before processing the upper-layer header or any IPv6 extension header other than Hop-by-Hop or Destination Options of a packet matching a FIB entry locally instantiated as an End.B6.Encaps SID with the NEXT-CSID flavor:<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.4-4">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Push a new IPv6 header with its own SRH containing B.
N08.2. Set the outer IPv6 SA to A.
N08.3. Set the outer IPv6 DA to the first SID of B.
N08.4. Set the outer Payload Length, Traffic Class, Flow Label,
         Hop Limit, and Next Header fields.
N08.5. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
N09. }
</pre><a href="#appendix-A.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4-5">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.B6.Encaps SID with the NEXT-CSID flavor:<a href="#appendix-A.4-5" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.4-6">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
         with Code 4 (SR Upper-layer Header Error)
         and Pointer set to the offset of the upper-layer header,
         interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.4-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-next-endbm-complete">
<section id="appendix-A.5">
        <h3 id="name-endbm-with-next-csid-2">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-endbm-with-next-csid-2" class="section-name selfRef">End.BM with NEXT-CSID</a>
        </h3>
<p id="appendix-A.5-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.BM SID with the NEXT-CSID flavor:<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.5-2">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Push the MPLS label stack for B.
N08.2. Submit the packet to the MPLS engine for transmission.
N09. }
S02. If (Segments Left == 0) {
S03.   Stop processing the SRH and proceed to process the next
         header in the packet, whose type is identified by
         the Next Header field in the routing header.
S04. }
S05. If (IPv6 Hop Limit &lt;= 1) {
S06.   Send an ICMP Time Exceeded message to the Source Address
         with Code 0 (Hop limit exceeded in transit),
         interrupt packet processing, and discard the packet.
S07. }
S08. max_LE = (Hdr Ext Len / 2) - 1
S09. If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)) {
S10.   Send an ICMP Parameter Problem to the Source Address
         with Code 0 (Erroneous header field encountered)
         and Pointer set to the Segments Left field,
         interrupt packet processing, and discard the packet.
S11. }
S12. Decrement IPv6 Hop Limit by 1.
S13. Decrement Segments Left by 1.
S14. Update IPv6 DA with Segment List[Segments Left].
S15. Push the MPLS label stack for B.
S16. Submit the packet to the MPLS engine for transmission.
</pre><a href="#appendix-A.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.5-3">Before processing the upper-layer header or any IPv6 extension header other than Hop-by-Hop or Destination Options of a packet matching a FIB entry locally instantiated as an End.BM SID with the NEXT-CSID flavor:<a href="#appendix-A.5-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.5-4">
<pre>
N01. If (DA.Argument != 0) {
N02.   If (IPv6 Hop Limit &lt;= 1) {
N03.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
N04.   }
N05.   Copy DA.Argument into the bits [LBL..(LBL+AL-1)] of the
         Destination Address.
N06.   Set the bits [(LBL+AL)..127] of the Destination Address to
         zero.
N07.   Decrement IPv6 Hop Limit by 1.
N08.1. Push the MPLS label stack for B.
N08.2. Submit the packet to the MPLS engine for transmission.
N09. }
</pre><a href="#appendix-A.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.5-5">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.BM SID with the NEXT-CSID flavor:<a href="#appendix-A.5-5" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.5-6">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
         with Code 4 (SR Upper-layer Header Error)
         and Pointer set to the offset of the upper-layer header,
         interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.5-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-end-complete">
<section id="appendix-A.6">
        <h3 id="name-end-with-replace-csid-2">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-end-with-replace-csid-2" class="section-name selfRef">End with REPLACE-CSID</a>
        </h3>
<p id="appendix-A.6-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End SID with the REPLACE-CSID flavor:<a href="#appendix-A.6-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.6-2">
<pre>
S01. When an SRH is processed {
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
S03.     Stop processing the SRH and proceed to process the next
           header in the packet, whose type is identified by
           the Next Header field in the routing header.
S04.   }
S05.   If (IPv6 Hop Limit &lt;= 1) {
S06.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
S07.   }
S08.   max_LE = (Hdr Ext Len / 2) - 1
R01.   If (DA.Arg.Index != 0) {
R02.     If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R04.     }
R05.     Decrement DA.Arg.Index by 1.
R06.     If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.       Decrement Segments Left by 1.
R08.       Decrement IPv6 Hop Limit by 1.
R09.       Update IPv6 DA with Segment List[Segments Left]
R10.       Submit the packet to the egress IPv6 FIB lookup for
            transmission to the new destination.
R11.     }
R12.   } Else {
R13.     If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R15.     }
R16.     Decrement Segments Left by 1.
R17.     Set DA.Arg.Index to (128/LNFL - 1).
R18.   }
R19.   Decrement IPv6 Hop Limit by 1.
R20.   Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
         header.
R21.   Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
S16. }
</pre><a href="#appendix-A.6-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.6-3">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End SID with the REPLACE-CSID flavor:<a href="#appendix-A.6-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.6-4">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
          with Code 4 (SR Upper-layer Header Error)
          and Pointer set to the offset of the upper-layer header,
          interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.6-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endx-complete">
<section id="appendix-A.7">
        <h3 id="name-endx-with-replace-csid-2">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-endx-with-replace-csid-2" class="section-name selfRef">End.X with REPLACE-CSID</a>
        </h3>
<p id="appendix-A.7-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.X SID with the REPLACE-CSID flavor:<a href="#appendix-A.7-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.7-2">
<pre>
S01. When an SRH is processed {
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
S03.     Stop processing the SRH and proceed to process the next
           header in the packet, whose type is identified by
           the Next Header field in the routing header.
S04.   }
S05.   If (IPv6 Hop Limit &lt;= 1) {
S06.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
S07.   }
S08.   max_LE = (Hdr Ext Len / 2) - 1
R01.   If (DA.Arg.Index != 0) {
R02.     If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R04.     }
R05.     Decrement DA.Arg.Index by 1.
R06.     If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.       Decrement Segments Left by 1.
R08.       Decrement IPv6 Hop Limit by 1.
R09.       Update IPv6 DA with Segment List[Segments Left]
R10.       Submit the packet to the IPv6 module for transmission to
             the new destination via a member of J.
R11.     }
R12.   } Else {
R13.     If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R15.     }
R16.     Decrement Segments Left by 1.
R17.     Set DA.Arg.Index to (128/LNFL - 1).
R18.   }
R19.   Decrement IPv6 Hop Limit by 1.
R20.   Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
         header.
R21.   Submit the packet to the IPv6 module for transmission to the
         new destination via a member of J.
S16. }
</pre><a href="#appendix-A.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.7-3">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.X SID with the REPLACE-CSID flavor:<a href="#appendix-A.7-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.7-4">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
          with Code 4 (SR Upper-layer Header Error)
          and Pointer set to the offset of the upper-layer header,
          interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endt-complete">
<section id="appendix-A.8">
        <h3 id="name-endt-with-replace-csid-2">
<a href="#appendix-A.8" class="section-number selfRef">A.8. </a><a href="#name-endt-with-replace-csid-2" class="section-name selfRef">End.T with REPLACE-CSID</a>
        </h3>
<p id="appendix-A.8-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.T SID with the REPLACE-CSID flavor:<a href="#appendix-A.8-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.8-2">
<pre>
S01. When an SRH is processed {
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
S03.     Stop processing the SRH and proceed to process the next
           header in the packet, whose type is identified by
           the Next Header field in the routing header.
S04.   }
S05.   If (IPv6 Hop Limit &lt;= 1) {
S06.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
S07.   }
S08.   max_LE = (Hdr Ext Len / 2) - 1
R01.   If (DA.Arg.Index != 0) {
R02.     If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R04.     }
R05.     Decrement DA.Arg.Index by 1.
R06.     If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.       Decrement Segments Left by 1.
R08.       Decrement IPv6 Hop Limit by 1.
R09.       Update IPv6 DA with Segment List[Segments Left]
R10.1.     Set the packet's associated FIB table to T.
R10.2.     Submit the packet to the egress IPv6 FIB lookup for
             transmission to the new destination.
R11.     }
R12.   } Else {
R13.     If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R15.     }
R16.     Decrement Segments Left by 1.
R17.     Set DA.Arg.Index to (128/LNFL - 1).
R18.   }
R19.   Decrement IPv6 Hop Limit by 1.
R20.   Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
         header.
R21.1. Set the packet's associated FIB table to T.
R21.2. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the new destination.
S16. }
</pre><a href="#appendix-A.8-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.8-3">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.T SID with the REPLACE-CSID flavor:<a href="#appendix-A.8-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.8-4">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
          with Code 4 (SR Upper-layer Header Error)
          and Pointer set to the offset of the upper-layer header,
          interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.8-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endb6-complete">
<section id="appendix-A.9">
        <h3 id="name-endb6encaps-with-replace-csi">
<a href="#appendix-A.9" class="section-number selfRef">A.9. </a><a href="#name-endb6encaps-with-replace-csi" class="section-name selfRef">End.B6.Encaps with REPLACE-CSID</a>
        </h3>
<p id="appendix-A.9-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.B6.Encaps SID with the REPLACE-CSID flavor:<a href="#appendix-A.9-1" class="pilcrow">¶</a></p>
<div class="breakable lang-pseudocode sourcecode" id="appendix-A.9-2">
<pre>
S01. When an SRH is processed {
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
S03.     Stop processing the SRH and proceed to process the next
           header in the packet, whose type is identified by
           the Next Header field in the routing header.
S04.   }
S05.   If (IPv6 Hop Limit &lt;= 1) {
S06.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
S07.   }
S08.   max_LE = (Hdr Ext Len / 2) - 1
R01.   If (DA.Arg.Index != 0) {
R02.     If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R04.     }
R05.     Decrement DA.Arg.Index by 1.
R06.     If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.       Decrement Segments Left by 1.
R08.       Decrement IPv6 Hop Limit by 1.
R09.       Update IPv6 DA with Segment List[Segments Left]
R10.1.     Push a new IPv6 header with its own SRH containing B.
R10.2.     Set the outer IPv6 SA to A.
R10.3.     Set the outer IPv6 DA to the first SID of B.
R10.4.     Set the outer Payload Length, Traffic Class, Flow Label,
             Hop Limit, and Next Header fields.
R10.5.     Submit the packet to the egress IPv6 FIB lookup for
             transmission to the next destination.
R11.     }
R12.   } Else {
R13.     If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R15.     }
R16.     Decrement Segments Left by 1.
R17.     Set DA.Arg.Index to (128/LNFL - 1).
R18.   }
R19.   Decrement IPv6 Hop Limit by 1.
R20.   Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
         header.
R21.1. Push a new IPv6 header with its own SRH containing B.
R21.2. Set the outer IPv6 SA to A.
R21.3. Set the outer IPv6 DA to the first SID of B.
R21.4. Set the outer Payload Length, Traffic Class, Flow Label,
         Hop Limit, and Next Header fields.
R21.5. Submit the packet to the egress IPv6 FIB lookup for
         transmission to the next destination.
S16. }
</pre><a href="#appendix-A.9-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.9-3">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.B6.Encaps SID with the REPLACE-CSID flavor:<a href="#appendix-A.9-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.9-4">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
          with Code 4 (SR Upper-layer Header Error)
          and Pointer set to the offset of the upper-layer header,
          interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.9-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-replace-endbm-complete">
<section id="appendix-A.10">
        <h3 id="name-endbm-with-replace-csid-2">
<a href="#appendix-A.10" class="section-number selfRef">A.10. </a><a href="#name-endbm-with-replace-csid-2" class="section-name selfRef">End.BM with REPLACE-CSID</a>
        </h3>
<p id="appendix-A.10-1">When processing the SRH of a packet matching a FIB entry locally instantiated as an End.BM SID with the REPLACE-CSID flavor:<a href="#appendix-A.10-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.10-2">
<pre>
S01. When an SRH is processed {
S02.   If (Segments Left == 0 and (DA.Arg.Index == 0 or
           Segment List[0][DA.Arg.Index-1] == 0)) {
S03.     Stop processing the SRH and proceed to process the next
           header in the packet, whose type is identified by
           the Next Header field in the routing header.
S04.   }
S05.   If (IPv6 Hop Limit &lt;= 1) {
S06.     Send an ICMP Time Exceeded message to the Source Address,
           Code 0 (Hop limit exceeded in transit),
           interrupt packet processing and discard the packet.
S07.   }
S08.   max_LE = (Hdr Ext Len / 2) - 1
R01.   If (DA.Arg.Index != 0) {
R02.     If ((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry)) {
R03.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R04.     }
R05.     Decrement DA.Arg.Index by 1.
R06.     If (Segment List[Segments Left][DA.Arg.Index] == 0) {
R07.       Decrement Segments Left by 1.
R08.       Decrement IPv6 Hop Limit by 1.
R09.       Update IPv6 DA with Segment List[Segments Left]
R10.1.     Push the MPLS label stack for B.
R10.2.     Submit the packet to the MPLS engine for transmission.
R11.     }
R12.   } Else {
R13.     If((Last Entry &gt; max_LE) or (Segments Left &gt; Last Entry+1)){
R14.       Send an ICMP Parameter Problem to the Source Address,
             Code 0 (Erroneous header field encountered),
             Pointer set to the Segments Left field,
             interrupt packet processing and discard the packet.
R15.     }
R16.     Decrement Segments Left by 1.
R17.     Set DA.Arg.Index to (128/LNFL - 1).
R18.   }
R19.   Decrement IPv6 Hop Limit by 1.
R20.   Write Segment List[Segments Left][DA.Arg.Index] into the bits
         [LBL..LBL+LNFL-1] of the Destination Address of the IPv6
         header.
R21.1. Push the MPLS label stack for B.
R21.2. Submit the packet to the MPLS engine for transmission.
S16. }
</pre><a href="#appendix-A.10-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.10-3">When processing the upper-layer header of a packet matching a FIB entry locally instantiated as an End.BM SID with the REPLACE-CSID flavor:<a href="#appendix-A.10-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-A.10-4">
<pre>
S01. If (upper-layer header type is allowed by local configuration) {
S02.   Proceed to process the upper-layer header
S03. } Else {
S04.   Send an ICMP Parameter Problem to the Source Address
          with Code 4 (SR Upper-layer Header Error)
          and Pointer set to the offset of the upper-layer header,
          interrupt packet processing, and discard the packet.
S05. }
</pre><a href="#appendix-A.10-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">The authors would like to thank <span class="contact-name">Kamran Raza</span>, <span class="contact-name">Xing Jiang</span>, <span class="contact-name">YuanChao Su</span>, <span class="contact-name">Han Li</span>, <span class="contact-name">Yisong Liu</span>, <span class="contact-name">Martin Vigoureux</span>, <span class="contact-name">Joel Halpern</span>, and <span class="contact-name">Tal Mizrahi</span> for their insightful feedback and suggestions.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The authors would also like to thank <span class="contact-name">Andrew Alston</span>, <span class="contact-name">Linda Dunbar</span>, <span class="contact-name">Adrian Farrel</span>, <span class="contact-name">Boris Hassanov</span>, <span class="contact-name">Alvaro Retana</span>, and <span class="contact-name">Gunter Van de Velde</span> for their thorough review of this document.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Liu Aihua</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:liu.aihua@zte.com.cn" class="email">liu.aihua@zte.com.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dennis Cai</span></div>
<div dir="auto" class="left"><span class="org">Alibaba</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:d.cai@alibaba-inc.com" class="email">d.cai@alibaba-inc.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Darren Dukes</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ddukes@cisco.com" class="email">ddukes@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">James N Guichard</span></div>
<div dir="auto" class="left"><span class="org">Futurewei Technologies Ltd.</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:james.n.guichard@futurewei.com" class="email">james.n.guichard@futurewei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cheng Li</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:c.l@huawei.com" class="email">c.l@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Raszuk</span></div>
<div dir="auto" class="left"><span class="org">NTT Network Innovations</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:robert@raszuk.net" class="email">robert@raszuk.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ketan Talaulikar</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ketant.ietf@gmail.com" class="email">ketant.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Voyer</span></div>
<div dir="auto" class="left"><span class="org">Bell Canada</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.voyer@bell.ca" class="email">daniel.voyer@bell.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shay Zadok</span></div>
<div dir="auto" class="left"><span class="org">Broadcom</span></div>
<div dir="auto" class="left"><span class="country-name">Israel</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shay.zadok@broadcom.com" class="email">shay.zadok@broadcom.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Weiqiang Cheng (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">China Mobile</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chengweiqiang@chinamobile.com" class="email">chengweiqiang@chinamobile.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Clarence Filsfils</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cf@cisco.com" class="email">cf@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Zhenbin Li</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lizhenbin@huawei.com" class="email">lizhenbin@huawei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bruno Decraene</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bruno.decraene@orange.com" class="email">bruno.decraene@orange.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francois Clad (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fclad.ietf@gmail.com" class="email">fclad.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
