<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9665: Service Registration Protocol for DNS-Based Service Discovery</title>
<meta content="Ted Lemon" name="author">
<meta content="Stuart Cheshire" name="author">
<meta content="
       The Service Registration Protocol (SRP) for DNS-based Service
        Discovery (DNS‑SD) uses the standard DNS Update mechanism to
        enable DNS‑SD using only unicast packets.  This makes it possible
        to deploy DNS‑SD without multicast, which greatly improves
        scalability and improves performance on networks where multicast
        service is not an optimal choice, particularly IEEE 802.11
        (Wi-Fi) and IEEE 802.15.4 networks.  DNS‑SD Service
        registration uses public keys and SIG(0) to allow services to defend
        their registrations.
       
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Multicast DNS" name="keyword">
<meta content="DNS-Based Service Discovery" name="keyword">
<meta content="DNS Update" name="keyword">
<meta content="SIG(0)" name="keyword">
<meta content="9665" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 65.0
-->
<link href="rfc9665.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://datatracker.ietf.org/doc/draft-ietf-dnssd-srp-latest" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc9665" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9665</td>
<td class="center">Service Registration Protocol</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lemon &amp; Cheshire</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9665" class="eref">9665</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06" class="published">June 2025</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Lemon</div>
<div class="org">Apple Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Cheshire</div>
<div class="org">Apple Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9665</h1>
<h1 id="title">Service Registration Protocol for DNS-Based Service Discovery</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Service Registration Protocol (SRP) for DNS-based Service
        Discovery (DNS‑SD) uses the standard DNS Update mechanism to
        enable DNS‑SD using only unicast packets.  This makes it possible
        to deploy DNS‑SD without multicast, which greatly improves
        scalability and improves performance on networks where multicast
        service is not an optimal choice, particularly IEEE 802.11
        (Wi-Fi) and IEEE 802.15.4 networks.  DNS‑SD Service
        registration uses public keys and SIG(0) to allow services to defend
        their registrations.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9665">https://www.rfc-editor.org/info/rfc9665</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-service-registration-protoc" class="internal xref">Service Registration Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-protocol-variants" class="internal xref">Protocol Variants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1" class="keepWithNext"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-full-featured-hosts" class="internal xref">Full-Featured Hosts</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-constrained-hosts" class="internal xref">Constrained Hosts</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-why-two-variants" class="internal xref">Why two variants?</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-protocol-details" class="internal xref">Protocol Details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-what-to-publish" class="internal xref">What to Publish</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-where-to-publish-it" class="internal xref">Where to Publish It</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-how-to-publish-it" class="internal xref">How to Publish It</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3.2.1">
                        <p id="section-toc.1-1.3.2.2.2.3.2.1.1"><a href="#section-3.2.3.1" class="auto internal xref">3.2.3.1</a>.  <a href="#name-how-the-dnssd-service-regis" class="internal xref">How the DNS‑SD Service Registration Process Differs from DNS Update</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3.2.2">
                        <p id="section-toc.1-1.3.2.2.2.3.2.2.1"><a href="#section-3.2.3.2" class="auto internal xref">3.2.3.2</a>.  <a href="#name-retransmission-strategy" class="internal xref">Retransmission Strategy</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3.2.3">
                        <p id="section-toc.1-1.3.2.2.2.3.2.3.1"><a href="#section-3.2.3.3" class="auto internal xref">3.2.3.3</a>.  <a href="#name-successive-updates" class="internal xref">Successive Updates</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-how-to-secure-it" class="internal xref">How to Secure It</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4.2.1">
                        <p id="section-toc.1-1.3.2.2.2.4.2.1.1"><a href="#section-3.2.4.1" class="auto internal xref">3.2.4.1</a>.  <a href="#name-fcfs-naming" class="internal xref">FCFS Naming</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="auto internal xref">3.2.5</a>.  <a href="#name-srp-requester-behavior" class="internal xref">SRP Requester Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5.2.1">
                        <p id="section-toc.1-1.3.2.2.2.5.2.1.1"><a href="#section-3.2.5.1" class="auto internal xref">3.2.5.1</a>.  <a href="#name-public-private-key-pair-gen" class="internal xref">Public/Private Key Pair Generation and Storage</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5.2.2">
                        <p id="section-toc.1-1.3.2.2.2.5.2.2.1"><a href="#section-3.2.5.2" class="auto internal xref">3.2.5.2</a>.  <a href="#name-name-conflict-handling" class="internal xref">Name Conflict Handling</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5.2.3">
                        <p id="section-toc.1-1.3.2.2.2.5.2.3.1"><a href="#section-3.2.5.3" class="auto internal xref">3.2.5.3</a>.  <a href="#name-record-lifetimes" class="internal xref">Record Lifetimes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5.2.4">
                        <p id="section-toc.1-1.3.2.2.2.5.2.4.1"><a href="#section-3.2.5.4" class="auto internal xref">3.2.5.4</a>.  <a href="#name-compression-in-srv-records" class="internal xref">Compression in SRV Records</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5.2.5">
                        <p id="section-toc.1-1.3.2.2.2.5.2.5.1"><a href="#section-3.2.5.5" class="auto internal xref">3.2.5.5</a>.  <a href="#name-removing-published-services" class="internal xref">Removing Published Services</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-validation-and-processing-o" class="internal xref">Validation and Processing of SRP Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-validation-of-dns-update-ad" class="internal xref">Validation of DNS Update Add and Delete RRs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1.2.1">
                        <p id="section-toc.1-1.3.2.3.2.1.2.1.1"><a href="#section-3.3.1.1" class="auto internal xref">3.3.1.1</a>.  <a href="#name-service-discovery-instructi" class="internal xref">Service Discovery Instruction</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1.2.2">
                        <p id="section-toc.1-1.3.2.3.2.1.2.2.1"><a href="#section-3.3.1.2" class="auto internal xref">3.3.1.2</a>.  <a href="#name-service-description-instruc" class="internal xref">Service Description Instruction</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1.2.3">
                        <p id="section-toc.1-1.3.2.3.2.1.2.3.1"><a href="#section-3.3.1.3" class="auto internal xref">3.3.1.3</a>.  <a href="#name-host-description-instructio" class="internal xref">Host Description Instruction</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-valid-srp-update-requiremen" class="internal xref">Valid SRP Update Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-fcfs-name-and-signature-val" class="internal xref">FCFS Name and Signature Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-handling-of-service-subtype" class="internal xref">Handling of Service Subtypes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="auto internal xref">3.3.5</a>.  <a href="#name-srp-update-response" class="internal xref">SRP Update Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a href="#section-3.3.6" class="auto internal xref">3.3.6</a>.  <a href="#name-optional-behavior" class="internal xref">Optional Behavior</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-ttl-consistency" class="internal xref">TTL Consistency</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-maintenance" class="internal xref">Maintenance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-cleaning-up-stale-data" class="internal xref">Cleaning Up Stale Data</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-source-validation" class="internal xref">Source Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-other-dns-updates" class="internal xref">Other DNS Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-risks-of-allowing-arbitrary" class="internal xref">Risks of Allowing Arbitrary Names to be Registered in SRP Updates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-security-of-local-service-d" class="internal xref">Security of Local Service Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-srp-registrar-authenticatio" class="internal xref">SRP Registrar Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-required-signature-algorith" class="internal xref">Required Signature Algorithm</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-domain-name-reservation-con" class="internal xref">Domain Name Reservation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-users" class="internal xref">Users</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-application-software" class="internal xref">Application Software</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-name-resolution-apis-and-li" class="internal xref">Name Resolution APIs and Libraries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-recursive-resolvers" class="internal xref">Recursive Resolvers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-authoritative-dns-servers" class="internal xref">Authoritative DNS Servers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-dns-server-operators" class="internal xref">DNS Server Operators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-dns-registries-registrars" class="internal xref">DNS Registries/Registrars</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-delegation-of-servicearpa" class="internal xref">Delegation of "service.arpa."</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-registration-and-delegation" class="internal xref">Registration and Delegation of "service.arpa." as a Special-Use Domain Name</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-addition-of-servicearpa-to-" class="internal xref">Addition of "service.arpa." to the Locally-Served Zones Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-subdomains-of-servicearpa" class="internal xref">Subdomains of "service.arpa."</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-service-name-registrations" class="internal xref">Service Name Registrations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4.2.1">
                    <p id="section-toc.1-1.10.2.4.2.1.1"><a href="#section-10.4.1" class="auto internal xref">10.4.1</a>.  <a href="#name-dnssd-srp-service-name" class="internal xref">"dnssd-srp" Service Name</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4.2.2">
                    <p id="section-toc.1-1.10.2.4.2.2.1"><a href="#section-10.4.2" class="auto internal xref">10.4.2</a>.  <a href="#name-dnssd-srp-tls-service-name" class="internal xref">"dnssd-srp-tls" Service Name</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-anycast-address" class="internal xref">Anycast Address</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-using-standard-authoritativ" class="internal xref">Using Standard Authoritative DNS Servers Compliant with RFC 2136 to Test SRP Requesters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-how-to-allow-srp-requesters" class="internal xref">How to Allow SRP Requesters to Update Standard Servers Compliant with RFC 2136</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-sample-bind-9-configuration" class="internal xref">Sample BIND 9 Configuration for "default.service.arpa."</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        DNS‑SD <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>
        is a component of Zero Configuration Networking
        <span>[<a href="#RFC6760" class="cite xref">RFC6760</a>]</span>
        <span>[<a href="#ZC" class="cite xref">ZC</a>]</span>
        <span>[<a href="#I-D.cheshire-dnssd-roadmap" class="cite xref">ROADMAP</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        This document describes an enhancement to DNS‑SD that
 allows servers to register the services they offer using the DNS protocol
 over unicast rather than using Multicast DNS (mDNS) <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>.
 There is already a large installed base of DNS‑SD
 clients that can discover services using the DNS
 protocol (e.g., Android, Windows, Linux, Apple operating systems).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
        This document is intended for three audiences: Implementers of software that provides services that should be advertised
        using DNS‑SD, implementers of authoritative DNS servers that will
        be used in contexts where DNS‑SD registration is needed, and
        administrators of networks where DNS‑SD service is required.
        The document is expected to provide sufficient
        information to allow interoperable implementation
        of the Service Registration Protocol.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
  DNS‑SD allows servers to publish the information required to access
  the services they provide.  DNS‑SD clients can then discover the set
  of service instances of a particular type that are available.  They can then
  select an instance from among those that are available and obtain the
  information required to use it.  Although DNS‑SD using the DNS
  protocol can be more efficient and versatile than using mDNS, it is
  not common in practice because of the difficulties associated with
  updating authoritative DNS services with service information.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
 The existing practice for updating DNS zones is either to enter new data manually or to use DNS Update
      <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>. Unfortunately, DNS Update requires either:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">that the authoritative DNS server automatically trust
 updates or<a href="#section-1-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-6.2">that the DNS Update requester have some kind of shared secret
 or public key that is known to the authoritative DNS server
 and can be used to authenticate the update.<a href="#section-1-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-7">Furthermore, DNS Update can be a fairly chatty process, requiring multiple
 roundtrips with different conditional predicates to complete the update process.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
 The Service Registration Protocol (SRP) adds a set of default
 heuristics for processing DNS updates that eliminates the need for
 conditional predicates.
 Instead, the SRP registrar (an authoritative DNS server
 that supports SRP Updates) has a set of default predicates
 that are applied to the update; and the update either succeeds entirely or fails in a way that allows the requester to know
 what went wrong and construct a new update.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">
 SRP also adds a feature called "First Come, First Served Naming" (or "FCFS Naming"), which allows the requester to:<a href="#section-1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-10.1">claim a name that is
 not yet in use, and<a href="#section-1-10.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-10.2">authenticate, using SIG(0) <span>[<a href="#RFC2931" class="cite xref">RFC2931</a>]</span>,
 both the initial claim
 (to ensure it has not been modified in transit)
 and subsequent updates
 (to ensure they come from the same entity that performed the initial claim).<a href="#section-1-10.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-11">This prevents a new service instance from "stealing" a name that is already in use:
 A second SRP requester attempting to claim an existing name will not possess the
 SIG(0) key used by the first requester to claim it. Because of this, its claim will be rejected. This will force it to
 choose a new name.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">
 It is important to understand that "authenticate" here just means that we can tell that an update came from the same source
 as the original registration. We have not established trust. This has important implications for what we can and can't do
 with data the SRP requester sends us.
 You will notice as you read this document that
 we only support adding a very restricted set
 of records, and the content of those records is further constrained.<a href="#section-1-12" class="pilcrow">¶</a></p>
<p id="section-1-13">
 The reason for this is precisely that we have not established trust. So, we can only publish information that we feel safe in
 publishing even though we do not have any basis for trusting the requester.
 We reason that mDNS <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span> allows
 arbitrary hosts on a single IP link to advertise services
 <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>, relying on whatever service is
 advertised to provide authentication as a part of its protocol rather than in the service advertisement.<a href="#section-1-13" class="pilcrow">¶</a></p>
<p id="section-1-14">
 This is considered reasonably safe because it requires physical presence on the network in order to advertise. An off-network
 mDNS attack is simply not possible. Our goal with this specification is to impose similar constraints. Therefore, you will
 see in <a href="#add_validation" class="auto internal xref">Section 3.3.1</a> that a very restricted set of records with a very restricted set of relationships are
 allowed. You will also see in <a href="#source_validation" class="auto internal xref">Section 6.1</a> that we give advice on how to prevent off-network attacks.<a href="#section-1-14" class="pilcrow">¶</a></p>
<p id="section-1-15">
 This leads us to the disappointing observation that this protocol is not a mechanism for adding arbitrary information to
 DNS zones. We have not evaluated the security properties of adding, for example, an SOA record, an MX record, or a CNAME
 record; therefore, these are forbidden.
 Future updates to this specification might include analyses for other records
 and extend the set of records and/or record content that can be registered here.
 Or it might require establishment of trust, and add an authorization model
 to the authentication model we now have.
 But that is work for a future document.<a href="#section-1-15" class="pilcrow">¶</a></p>
<p id="section-1-16">
 Finally, SRP adds the concept of a "lease" <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>,
 analogous to leases in DHCP <span>[<a href="#RFC2131" class="cite xref">RFC2131</a>]</span> <span>[<a href="#RFC8415" class="cite xref">RFC8415</a>]</span>.  The SRP registration itself has a lease that may
 be on the order of two hours; if the requester does not renew the
 lease before it has elapsed, the registration is removed.  The claim
 on the name can have a longer lease so that another requester cannot
 immediately claim the name, even though the registration itself has
 expired.<a href="#section-1-16" class="pilcrow">¶</a></p>
<p id="section-1-17">
        The Service Registration Protocol for DNS‑SD
        specified in this document provides a reasonably secure
        mechanism for publishing this information.
        Once published, these services can be readily
        discovered by DNS‑SD clients using
        standard DNS lookups.<a href="#section-1-17" class="pilcrow">¶</a></p>
<p id="section-1-18">
        Section <a href="https://rfc-editor.org/rfc/rfc6763#section-10" class="relref">10</a>
        of the DNS‑SD specification <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>
        briefly discusses ways that servers can advertise the services
        they provide in the DNS namespace.  In the case of
        mDNS, it allows servers to advertise their services on the local link,
        using names in the "local." namespace, which makes
        their services directly discoverable by peers attached to that same local link.<a href="#section-1-18" class="pilcrow">¶</a></p>
<p id="section-1-19">
        DNS‑SD <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span> also allows clients to discover services
        by using the DNS protocol over traditional unicast <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>.
        This can be done by
        having a system administrator manually configure service information in the DNS; however, manually populating DNS authoritative
        server databases is costly and potentially error-prone and requires a knowledgeable network administrator.  Consequently,
        although all DNS‑SD client implementations of which we are
        aware support DNS‑SD using DNS queries, in practice it
        is used much less frequently than mDNS.<a href="#section-1-19" class="pilcrow">¶</a></p>
<p id="section-1-20">
        The Discovery Proxy <span>[<a href="#RFC8766" class="cite xref">RFC8766</a>]</span> provides one way to automatically populate the DNS
        namespace but is only appropriate on networks where services are easily advertised using mDNS.  The present document describes a
        solution more suitable for networks where multicast is inefficient,
        or where sleepy devices are common, by supporting the use of unicast
        for both the offering of and the discovery of services.<a href="#section-1-20" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology Used in This Document</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Strictly speaking, fully qualified domain names end with a dot
 (".").  In DNS zone files and other similar contexts, if the final dot
 is omitted, then a name may be treated incorrectly as relative to some
 other parent domain.  This document follows the formal DNS convention,
 ending fully qualified domain names with a dot.  When this document
 mentions domain names such as "local." and "default.service.arpa.",
 the final dot is part of the domain name; it is not a period
 indicating the end of the sentence.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-service-registration-protoc">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-service-registration-protoc" class="section-name selfRef">Service Registration Protocol</a>
      </h2>
<p id="section-3-1">
        Services that implement SRP use DNS Update <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> with SIG(0) <span>[<a href="#RFC3007" class="cite xref">RFC3007</a>]</span> to publish service information
        in the DNS.  Two variants exist: One for full-featured hosts and one for devices designed for Constrained-Node Networks (CNNs)
        <span>[<a href="#RFC7228" class="cite xref">RFC7228</a>]</span>.
        An SRP registrar is most likely an authoritative DNS server
        or is a source of data for one or more authoritative DNS servers.
        There is no requirement that the authoritative DNS server that is
        receiving SRP Updates be the same authoritative DNS server that is
        answering queries that return records that have been registered.
        For example, an SRP registrar could be the "hidden primary" that is
        the source of data for a fleet of secondary authoritative DNS servers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-protocol-variants">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-protocol-variants" class="section-name selfRef">Protocol Variants</a>
        </h3>
<section id="section-3.1.1">
          <h4 id="name-full-featured-hosts">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-full-featured-hosts" class="section-name selfRef">Full-Featured Hosts</a>
          </h4>
<p id="section-3.1.1-1">
            Full-featured hosts either are configured manually with a registration domain or discover the default registration
     domain automatically using the Domain Enumeration process described in
     Section <a href="https://rfc-editor.org/rfc/rfc6763#section-11" class="relref">11</a>
     of the DNS‑SD specification <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>.
     If this process does not produce a
     default registration domain, the SRP registrar
     is not discoverable on the local network using this
     mechanism. Other discovery mechanisms are possible, but they are out of scope for this document.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">
            Configuration of the registration domain can be done either:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.1">by querying the list of available registration
            domains ("r._dns‑sd._udp") and allowing the user to select one from the UI, or<a href="#section-3.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-3.2">by any other means appropriate to
            the particular use case being addressed.<a href="#section-3.1.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.1.1-4">Full-featured devices construct the names of the SRV, TXT, and PTR records
            describing their service or services as subdomains of the chosen service registration domain.  For these names, they then discover
            the zone apex of the closest enclosing DNS zone using SOA queries
            as described in
            Section <a href="https://rfc-editor.org/rfc/rfc8765#section-6.1" class="relref">6.1</a>
            of the DNS Push Notification specification <span>[<a href="#RFC8765" class="cite xref">RFC8765</a>]</span>.
            Having
            discovered the enclosing DNS zone, they query for the "_dnssd‑srp._tcp.&lt;zone&gt;" SRV record to discover the
            SRP registrar to which they can send SRP Updates.  Hosts that support SRP Updates using TLS use the
            "_dnssd‑srp‑tls._tcp.&lt;zone&gt;" SRV record instead.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">
     Examples of full-featured hosts include devices such as home computers, laptops, powered peripherals with network
     connections (such as printers and home routers), and even battery-operated devices such as mobile phones that have
     long battery lives.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
</section>
<div id="constrained_hosts">
<section id="section-3.1.2">
          <h4 id="name-constrained-hosts">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-constrained-hosts" class="section-name selfRef">Constrained Hosts</a>
          </h4>
<p id="section-3.1.2-1">
            For devices designed for CNNs <span>[<a href="#RFC7228" class="cite xref">RFC7228</a>]</span>,
            some simplifications are available.  Instead of
            being configured with (or discovering) the service registration domain,
            the special-use domain name <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span> "default.service.arpa." is used.
            The details of how SRP registrars are discovered will be specific
            to the constrained network; therefore, we do not suggest a specific mechanism here.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">
            SRP requesters on CNNs are expected to receive, from the network,
            a list of SRP registrars with which to register.  It is the
            responsibility of a CNN supporting SRP to provide at least one
            registrar address and port.  It is the responsibility of the
            registrar supporting a CNN to handle the updates appropriately.
            In some network environments, updates may be accepted directly
            into a local "default.service.arpa." zone, which has only local
            visibility.  In other network environments, updates for names
            ending in "default.service.arpa." may be rewritten by the
            registrar to names with broader visibility.  Domain name rewriting
            should be performed as appropriate for the network environment in
            question.  Some suggested techniques for how domain names can be
            translated from a locally scoped name to a domain name with larger
            scope can be found in the discussion of data translation for names
            in Multicast DNS answers in Section <a href="https://rfc-editor.org/rfc/rfc8766#section-5.5" class="relref">5.5</a> of the Discovery Proxy
            specification <span>[<a href="#RFC8766" class="cite xref">RFC8766</a>]</span>.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.1.3">
          <h4 id="name-why-two-variants">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-why-two-variants" class="section-name selfRef">Why two variants?</a>
          </h4>
<p id="section-3.1.3-1">
            The reason for these different variants is that low-power devices that typically use CNNs may have
            very limited battery capacity.  The series of DNS lookups required to discover an SRP registrar and then communicate with
            it will increase the energy required to advertise a service; for low-power devices, the additional flexibility this
            provides does not justify the additional use of energy.  It is also fairly typical of such networks that some network
            service information is obtained as part of the process of joining the network; thus, this can be relied upon to provide
            nodes with the information they need.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">
            Networks that are not CNNs can have more complicated topologies at the IP layer. Nodes connected
            to such networks can be assumed to be able to do DNS‑SD
            service registration domain discovery. Such networks are
            generally able to provide registration domain discovery and routing.  This creates the possibility of off-network
     spoofing, where a device from a foreign network registers a service on the local network in order to attack devices
     on the local network. To guard against off-path spoofing, TCP is required for such networks.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3.2">
        <h3 id="name-protocol-details">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-protocol-details" class="section-name selfRef">Protocol Details</a>
        </h3>
<p id="section-3.2-1">
We will discuss several parts to this process:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-2.1">how to know what to publish (<a href="#what" class="auto internal xref">Section 3.2.1</a>),<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-2.2">how to know where to publish it (under what name) (<a href="#where" class="auto internal xref">Section 3.2.2</a>),<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-2.3">how to publish it (<a href="#how" class="auto internal xref">Section 3.2.3</a>),<a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-2.4">how to secure its publication (<a href="#how-to-secure" class="auto internal xref">Section 3.2.4</a>), and<a href="#section-3.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-2.5">how to maintain
          the information once published (<a href="#maintenance" class="auto internal xref">Section 5</a>).<a href="#section-3.2-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<div id="what">
<section id="section-3.2.1">
          <h4 id="name-what-to-publish">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-what-to-publish" class="section-name selfRef">What to Publish</a>
          </h4>
<p id="section-3.2.1-1">
            SRP Updates are sent by SRP requesters to SRP registrars.  Three types of instructions appear in an SRP Update: Service
     Discovery instructions, Service Description instructions, and Host Description instructions. These instructions are made
     up of DNS Update Resource Records (RRs) that are either adds or deletes. The types of records that are added, updated, and removed in each
     of these instructions, as well as the constraints that apply to them, are described in <a href="#server_behavior" class="auto internal xref">Section 3.3</a>.
     An SRP Update is a DNS Update message <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> that is
     constructed so as to meet the constraints described in that section. The
     following is a brief overview of what is included in a typical SRP Update:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.1">
              Service Discovery PTR RR(s) for service(s), which map from a
              generic service type (or subtype(s)) to a specific
              service instance name <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>.<a href="#section-3.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.2">
       For each service instance name, an SRV RR, one or more
       TXT RRs, and a KEY RR. Although, in principle, DNS‑SD
       Service Description records can include other record types with
       the same service instance name, in practice, they rarely do.
       Currently, SRP does not permit other record types. The KEY RR is used
       to support FCFS Naming and has no specific meaning for DNS‑SD
       lookups. SRV records for all services described in an
       SRP Update point to the same hostname.<a href="#section-3.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.3">
       There is always exactly one hostname in a single SRP Update.
              A DNS Update containing more than one hostname is not an SRP Update.
              The hostname has one or more address RRs (AAAA or A) and
              a KEY RR (used for FCFS Naming). Depending on the use case, an SRP requester may be required to suppress some
              addresses that would not be usable by hosts discovering the service through the SRP registrar. The exact address
              record suppression behavior required may vary for different types of SRP requesters.
              Some suggested policies for suppressing unusable records can be found in
              Section <a href="https://rfc-editor.org/rfc/rfc8766#section-5.5.2" class="relref">5.5.2</a>
              of the Discovery Proxy specification <span>[<a href="#RFC8766" class="cite xref">RFC8766</a>]</span>.<a href="#section-3.2.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.2.1-3">
            The DNS-Based Service Discovery specification
            <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span> describes the details of
            what each of these RR types mean, with the exception of
            the KEY RR, which is defined in the
            specification for how to store Diffie-Hellman
            Keys in the DNS <span>[<a href="#RFC2539" class="cite xref">RFC2539</a>]</span>.
            These specifications should be considered
            the definitive sources for
            information about what to publish; the reason for summarizing this here is to provide the reader with enough information
            about what will be published that the service registration process can be understood at a high level without first
            learning the full details of DNS‑SD.
            Also, the "service instance name" is an important aspect of FCFS
            Naming, which we describe later on in this document.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="where">
<section id="section-3.2.2">
          <h4 id="name-where-to-publish-it">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-where-to-publish-it" class="section-name selfRef">Where to Publish It</a>
          </h4>
<p id="section-3.2.2-1">
            Multicast DNS (mDNS) uses a single namespace, "local.".
            Subdomains of "local." are specific to the local link on which they are advertised.
            This convenience is not available for
            DNS‑SD using the DNS protocol: Services must exist in
            some specific DNS namespace that is chosen either by the
     network operator or automatically.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">
            As described above, full-featured devices are responsible for knowing the domain in which to register their services.
     Such devices <span class="bcp14">MAY</span> optionally support configuration of a registration domain by the operator of the device. However,
     such devices <span class="bcp14">MUST</span> support registration domain discovery as described in
     Section <a href="https://rfc-editor.org/rfc/rfc6763#section-11" class="relref">11</a>
     of the DNS‑SD specification <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">
            Devices made for CNNs register in the
            special-use domain name <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span>
            "default.service.arpa." and let the SRP registrar handle
            rewriting that to a different domain if necessary,
            as mentioned in <a href="#constrained_hosts" class="auto internal xref">Section 3.1.2</a>.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="how">
<section id="section-3.2.3">
          <h4 id="name-how-to-publish-it">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-how-to-publish-it" class="section-name selfRef">How to Publish It</a>
          </h4>
<p id="section-3.2.3-1">
            It is possible to send a DNS Update message that does several things at once:
            For example, it's possible in a single transaction
            to add or update a single Host Description
            while also adding or updating the RRs comprising the Service Description(s)
            for one or more service instance(s) available on that host
            and adding or updating the RRs comprising the Service Discovery instruction(s)
            for those service instance(s).<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">
            An SRP Update takes advantage of this: It is implemented as a
            single DNS Update message that contains a service's Service
            Discovery records, Service Description records, and Host
            Description records.<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.3-3">
     Updates done according to this specification are somewhat
     different from normal DNS Updates <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> where
     the update process could involve many update attempts. The
     requester might first attempt to add a name if it doesn't exist;
     if that fails, then in a second message the requester might update
     the name if it does exist but matches certain
     preconditions. Because the Service Registration Protocol described
     in this document uses a single transaction, some of this
     adaptability is lost.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
<p id="section-3.2.3-4">
            In order to allow updates to happen in a single transaction, SRP Updates do not include update prerequisites.  The
            requirements specified in <a href="#server_behavior" class="auto internal xref">Section 3.3</a> are implicit in the processing of SRP Updates; thus, there is
            no need for the SRP requester to put in any explicit prerequisites.<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
<section id="section-3.2.3.1">
            <h5 id="name-how-the-dnssd-service-regis">
<a href="#section-3.2.3.1" class="section-number selfRef">3.2.3.1. </a><a href="#name-how-the-dnssd-service-regis" class="section-name selfRef">How the DNS‑SD Service Registration Process Differs from DNS Update</a>
            </h5>
<p id="section-3.2.3.1-1">
              DNS‑SD Service Registration uses the DNS Update specification <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>
              with some additions:<a href="#section-3.2.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.3.1-2.1">
 It implements FCFS Naming, protected using SIG(0) <span>[<a href="#RFC2931" class="cite xref">RFC2931</a>]</span>.<a href="#section-3.2.3.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.3.1-2.2">
 It enforces policy about what updates are allowed.<a href="#section-3.2.3.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.3.1-2.3">
 It optionally performs rewriting of "default.service.arpa." to some other domain.<a href="#section-3.2.3.1-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.3.1-2.4">
 It optionally performs automatic population of the address-to-name reverse mapping domains.<a href="#section-3.2.3.1-2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.3.1-2.5">
 An SRP registrar is not required to implement general DNS Update prerequisite processing.<a href="#section-3.2.3.1-2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2.3.1-2.6">
 CNN SRP requesters are allowed to send updates to the generic domain "default.service.arpa.".<a href="#section-3.2.3.1-2.6" class="pilcrow">¶</a>
</li>
            </ul>
</section>
<section id="section-3.2.3.2">
            <h5 id="name-retransmission-strategy">
<a href="#section-3.2.3.2" class="section-number selfRef">3.2.3.2. </a><a href="#name-retransmission-strategy" class="section-name selfRef">Retransmission Strategy</a>
            </h5>
<p id="section-3.2.3.2-1">The DNS protocol, including DNS updates, can operate over UDP
     or TCP.  For UDP updates from CNN devices, reliable transmission
     must be guaranteed by retransmitting when a DNS UDP message is not
     acknowledged in a reasonable interval.  Section <a href="https://rfc-editor.org/rfc/rfc1035#section-4.2.1" class="relref">4.2.1</a> of the DNS
     specification <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> provides some guidance on
     this topic, as does Section <a href="https://rfc-editor.org/rfc/rfc1536#section-1" class="relref">1</a> of the IETF document describing common DNS
     implementation errors <span>[<a href="#RFC1536" class="cite xref">RFC1536</a>]</span>.  Section <a href="https://rfc-editor.org/rfc/rfc8085#section-3.1.3" class="relref">3.1.3</a> of the UDP
     Usage Guidelines document <span>[<a href="#RFC8085" class="cite xref">RFC8085</a>]</span> also provides
     useful guidance that is particularly relevant to DNS.<a href="#section-3.2.3.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2.3.3">
            <h5 id="name-successive-updates">
<a href="#section-3.2.3.3" class="section-number selfRef">3.2.3.3. </a><a href="#name-successive-updates" class="section-name selfRef">Successive Updates</a>
            </h5>
<p id="section-3.2.3.3-1">SRP does not require that every update contain the same information.
       When an SRP requester needs to send more than one
       SRP Update to the SRP registrar, it <span class="bcp14">SHOULD</span> combine
       these into a single SRP Update,
       when possible, subject to DNS message size limits and link-specific
          size limits (e.g., an IEEE 802.15.4 network will perform poorly when asked
          to deliver a packet larger than about 500 bytes).
       If the updates do not fit into a single SRP Update,
       then the SRP requester <span class="bcp14">MUST</span>
       send subsequent SRP Updates sequentially:
       Until an earlier SRP Update has been acknowledged,
       the requester <span class="bcp14">MUST NOT</span>
       send any subsequent SRP Updates.
       If a configuration change occurs while an outstanding
       SRP Update is in flight, the SRP registrar
       <span class="bcp14">MUST</span> defer sending a new SRP Update for
       that change until the previous SRP Update has completed.<a href="#section-3.2.3.3-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="how-to-secure">
<section id="section-3.2.4">
          <h4 id="name-how-to-secure-it">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-how-to-secure-it" class="section-name selfRef">How to Secure It</a>
          </h4>
<p id="section-3.2.4-1">
            DNS Update messages can be secured using secret key transaction signatures (TSIG)
            <span>[<a href="#RFC8945" class="cite xref">RFC8945</a>]</span>.
            This approach uses a secret key shared between
            the DNS Update requester (which issues the update) and
            the authoritative DNS server (which authenticates it).
            This model does not work for automatic service registration.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">
            The goal of securing the DNS‑SD Registration Protocol
            is to provide the best possible security given the constraint
            that service registration has to be automatic.  It is possible to layer more operational security on top of what we
            describe here, but FCFS Naming is already an improvement over the security of mDNS.<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
<div id="fcfs">
<section id="section-3.2.4.1">
            <h5 id="name-fcfs-naming">
<a href="#section-3.2.4.1" class="section-number selfRef">3.2.4.1. </a><a href="#name-fcfs-naming" class="section-name selfRef">FCFS Naming</a>
            </h5>
<p id="section-3.2.4.1-1">
              FCFS Naming provides a limited degree of security. A server that registers its service using SRP
              is given ownership of a name for an extended period of time based on a lease
              specific to the key used to authenticate the SRP Update, which may be longer than the lease associated with the
              registered RRs.  As long as the registrar remembers the name
              and the public key corresponding to the private key used to register RRs on that name,
              no other SRP requester can add or update the
              information associated with that name.
              If the SRP requester fails to renew its
              service registration before the KEY lease expires
              (Section <a href="https://rfc-editor.org/rfc/rfc9664#section-4" class="relref">4</a>
              of the DNS Update Lease specification <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>)
              its name is no longer protected.
              FCFS Naming is used to protect both the Service Description
              and the Host Description.<a href="#section-3.2.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-3.2.5">
          <h4 id="name-srp-requester-behavior">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-srp-requester-behavior" class="section-name selfRef">SRP Requester Behavior</a>
          </h4>
<section id="section-3.2.5.1">
            <h5 id="name-public-private-key-pair-gen">
<a href="#section-3.2.5.1" class="section-number selfRef">3.2.5.1. </a><a href="#name-public-private-key-pair-gen" class="section-name selfRef">Public/Private Key Pair Generation and Storage</a>
            </h5>
<p id="section-3.2.5.1-1">
       The requester generates a public/private key pair (<a href="#rsa" class="auto internal xref">Section 6.6</a>).
       This key pair <span class="bcp14">MUST</span> be stored in stable
       storage; if there is no writable stable storage on the SRP requester, the SRP requester <span class="bcp14">MUST</span> be preconfigured with a
       public/private key pair in read-only storage.
       This key pair <span class="bcp14">MUST</span> be unique to the device.
       A device
       with rewritable storage <span class="bcp14">SHOULD</span> retain this key indefinitely.  When the device changes ownership, it may be appropriate
       for the former owner to erase the old key pair, which would then require the new owner to install a new
              one. Therefore, the SRP requester on the device <span class="bcp14">SHOULD</span> provide a mechanism to erase the key (for example, as the
              result of a "factory reset") and to generate a new key.<a href="#section-3.2.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5.1-2">
       Note that when a new key is generated, this will prevent the
       device from registering with the name associated with the old
       key in the same domain where it had previously registered. So,
       implicit in the generation of a new key is the generation of a
       new name; this can be done either proactively when regenerating
       a key or only in the event that the SRP update produces a name conflict.<a href="#section-3.2.5.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.5.1-3">
       The policy described here for managing keys assumes that the keys are only used for SRP. If a key that is used for SRP
       is also used for other purposes, the policy described here is likely to be insufficient. The policy stated here is <span class="bcp14">NOT RECOMMENDED</span> in such a situation: a policy appropriate to the full set of uses for the key must be chosen. Specifying
       such a policy is out of scope for this document.<a href="#section-3.2.5.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.5.1-4">
       When sending DNS updates, the requester includes a KEY record containing the public portion of the key in each Host
       Description Instruction and each Service Description Instruction.  Each KEY record <span class="bcp14">MUST</span> contain the same public key.
       The update is signed using SIG(0), using the private key that corresponds to the public key in the KEY record.  The
       lifetimes of the records in the update are
       set using the EDNS(0) Update Lease option
       <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>.<a href="#section-3.2.5.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.5.1-5">
       The format of the KEY resource record in the SRP Update is
       defined in the IETF specification for DNSSEC Resource Records
       <span>[<a href="#RFC4034" class="cite xref">RFC4034</a>]</span>. Because the KEY RR
       used in SIG(0) is not a zone-signing key, the flags field in the KEY RR <span class="bcp14">MUST</span> be all zeroes.<a href="#section-3.2.5.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.5.1-6">
       The KEY record in Service Description updates <span class="bcp14">MAY</span> be omitted for brevity; if it is omitted, the SRP registrar <span class="bcp14">MUST</span> behave
       as if the same KEY record that is given for the Host Description is also given for each Service Description for which
       no KEY record is provided.  Omitted KEY records are not used when computing the SIG(0) signature.<a href="#section-3.2.5.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2.5.2">
            <h5 id="name-name-conflict-handling">
<a href="#section-3.2.5.2" class="section-number selfRef">3.2.5.2. </a><a href="#name-name-conflict-handling" class="section-name selfRef">Name Conflict Handling</a>
            </h5>
<p id="section-3.2.5.2-1">
       "Add" operations for both Host Description RRs and
       Service Description RRs can have names that result in name conflicts.
       Service Discovery record "Add" operations
       cannot have name conflicts.
       If any Host Description or Service Description record
       is found by the SRP registrar to have a conflict with an existing name, the registrar will respond to the SRP Update
       with a YXDomain RCODE <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>, indicating that the
       desired name is already owned by a different SIG(0) key. In this case, the
       SRP requester <span class="bcp14">MUST</span> choose a new name or give up.<a href="#section-3.2.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5.2-2">
       There is no specific requirement for how the SRP
       requester should choose a new name. Typically,
       however, the requester will append a number to the
       preferred name. This number could be sequentially increasing or could be chosen randomly. One existing implementation
       attempts several sequential numbers before choosing randomly.
       For instance, it might try host.default.service.arpa.,
       then host‑1.default.service.arpa.,
       then host‑2.default.service.arpa.,
       then host‑31773.default.service.arpa.<a href="#section-3.2.5.2-2" class="pilcrow">¶</a></p>
</section>
<div id="lifetimes">
<section id="section-3.2.5.3">
            <h5 id="name-record-lifetimes">
<a href="#section-3.2.5.3" class="section-number selfRef">3.2.5.3. </a><a href="#name-record-lifetimes" class="section-name selfRef">Record Lifetimes</a>
            </h5>
<p id="section-3.2.5.3-1">
       The lifetime of the DNS‑SD PTR, SRV, A, AAAA, and TXT
       records <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span> uses the LEASE field
       of the Update Lease option and is typically set to two hours.  Thus, if a device is disconnected from the
       network, it does not continue to appear for too long in the
       user interfaces of devices looking for instances of that service type.<a href="#section-3.2.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5.3-2">
       The lifetime of the KEY records is set using the KEY-LEASE field
       of the Update Lease Option and <span class="bcp14">SHOULD</span> be set to a
       much longer time, typically 14 days.  The result being that even
       though a device may be temporarily disconnected or powered off
       -- disappearing from the network for a few days -- it makes a
       claim on its name that lasts much longer.<a href="#section-3.2.5.3-2" class="pilcrow">¶</a></p>
<p id="section-3.2.5.3-3">Therefore, even if a device is disconnected from the network for a
     few days, and its services are not available for that time, no
     other device can come along and claim its name the moment it
     disappears from the network. In the event that a device is
     disconnected from the network and permanently discarded, then its
     name is eventually cleaned up and made available for reuse.<a href="#section-3.2.5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.2.5.4">
            <h5 id="name-compression-in-srv-records">
<a href="#section-3.2.5.4" class="section-number selfRef">3.2.5.4. </a><a href="#name-compression-in-srv-records" class="section-name selfRef">Compression in SRV Records</a>
            </h5>
<p id="section-3.2.5.4-1">
       Although the original SRV specification <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>
       requires that the target hostname in the RDATA of an SRV record
       not be compressed in DNS queries and responses, an SRP requester
       <span class="bcp14">MAY</span> compress the target in the SRV record,
       since an SRP Update is neither a DNS query nor a DNS response.
       The motivation for <em>not</em> compressing
       is not stated in the SRV specification
       but is assumed to be because a recursive resolver
       (caching server) that does not understand the format of the
       SRV record might store it as binary data without decoding a
       compression pointer embedded with the target hostname field
       and thus return nonsensical RDATA in response to a query.
       This concern does not apply in the
       case of SRP. An SRP registrar needs to understand SRV records in order to validate the SRP Update. Compression of the
       target can save space in the SRP Update,
       so we want SRP requesters to be able to
       assume that the registrar will handle
       this. Therefore, SRP registrars <span class="bcp14">MUST</span> support compression of SRV RR targets.<a href="#section-3.2.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5.4-2">
       Note that this document does not update
       the SRV specification <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>:
       Authoritative DNS servers still <span class="bcp14">MUST NOT</span> compress SRV record targets.
       The requirement to accept compressed SRV records in updates only applies to SRP
       registrars. SRP registrars that are also authoritative DNS servers still
       <span class="bcp14">MUST NOT</span> compress SRV record targets in DNS responses.
       We note also that Multicast DNS <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>
       similarly compresses SRV records in mDNS messages.<a href="#section-3.2.5.4-2" class="pilcrow">¶</a></p>
<p id="section-3.2.5.4-3">
       In addition, we note that an implementer of an SRP requester
       might update existing code that creates SRV records or
       compresses DNS messages so that it compresses the target of an
       SRV record. Care must be taken if such code is used both in
       requesters and in authoritative DNS servers that the code only
       compresses SRV targets in the case where a requester is
       generating an SRP Update.<a href="#section-3.2.5.4-3" class="pilcrow">¶</a></p>
</section>
<div id="remove">
<section id="section-3.2.5.5">
            <h5 id="name-removing-published-services">
<a href="#section-3.2.5.5" class="section-number selfRef">3.2.5.5. </a><a href="#name-removing-published-services" class="section-name selfRef">Removing Published Services</a>
            </h5>
<div id="zero-lease">
<section id="section-3.2.5.5.1">
              <h6 id="name-removing-all-published-serv">
<a href="#section-3.2.5.5.1" class="section-number selfRef">3.2.5.5.1. </a><a href="#name-removing-all-published-serv" class="section-name selfRef">Removing All Published Services</a>
              </h6>
<p id="section-3.2.5.5.1-1">
 To remove all the services registered to a particular hostname,
 the SRP requester transmits an SRP Update for that hostname
 with an Update Lease option that has a LEASE value of zero.
 The SRP Update <span class="bcp14">MUST</span> contain
 exactly one Host Description Instruction
 that contains exactly one "Delete All RRsets From A Name" instruction for the hostname
 and no "Add to an RRSet" instructions for that hostname.
 If the registration is to be permanently removed,
 KEY-LEASE <span class="bcp14">SHOULD</span> also be zero. Otherwise, it <span class="bcp14">SHOULD</span> be set to the same value it had previously; this holds the name
 in reserve for when the SRP requester is once again able to provide the service.<a href="#section-3.2.5.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5.5.1-2">
 This method of removing services is intended for the case
 where the requester is going offline and does not want
 any of its services to continue being advertised.<a href="#section-3.2.5.5.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.5.5.1-3">To support this, when removing a hostname, an SRP registrar
       <span class="bcp14">MUST</span> remove all service instances pointing to
       that hostname and all Service Discovery PTR records pointing to
       those service instances, even if the SRP requester doesn't list
       them explicitly. If the KEY lease time is nonzero, the SRP
       registrar <span class="bcp14">MUST NOT</span> delete the KEY records for
       these service instances.<a href="#section-3.2.5.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.2.5.5.2">
              <h6 id="name-removing-some-published-ser">
<a href="#section-3.2.5.5.2" class="section-number selfRef">3.2.5.5.2. </a><a href="#name-removing-some-published-ser" class="section-name selfRef">Removing Some Published Services</a>
              </h6>
<p id="section-3.2.5.5.2-1">
 In some use cases, a requester may need to remove a
 specific service instance without removing its other services.
 For example, a device may
 shut down its remote screen access (_rfb._tcp) service
 while retaining its command-line login (_ssh._tcp) service.
 This can be accomplished in one of two ways:<a href="#section-3.2.5.5.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.5.5.2-2">
   <li id="section-3.2.5.5.2-2.1">To simply remove a specific service instance, the requester sends
   a valid SRP Update with a Service Description Instruction
   (<a href="#servdesc" class="auto internal xref">Section 3.3.1.2</a>) containing a single "Delete All
   RRsets From A Name" update to the service instance name.
   The SRP Update <span class="bcp14">SHOULD</span> include Service
   Discovery Instructions (<a href="#servdis" class="auto internal xref">Section 3.3.1.1</a>) consisting
   of "Delete An RR From An RRset" updates <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> that delete any Service Discovery PTR
   records whose target is the service instance name.  However,
   even in the absence of such Service Discovery Instructions,
   the SRP registrar <span class="bcp14">MUST</span> delete any Service
   Discovery PTR records that point to the deleted service
   instance name.<a href="#section-3.2.5.5.2-2.1" class="pilcrow">¶</a>
</li>
                <li id="section-3.2.5.5.2-2.2">When deleting one service instance while simultaneously
 creating a new service instance with a different service
 instance name, an alternative is to perform both operations
 using a single SRP Update.  In this case, the old service is
 deleted as in the first alternative.  The new service is
 added, just as it would be in an update that wasn't deleting
 the old service. Because both the removal of the old service
 and the add of the new service consist of a valid Service
 Discovery Instruction and a valid Service Description
 Instruction, the update as a whole is a valid SRP Update and
 will result in the old service being removed and the new one
 added; or, to put it differently, the SRP Update will result
 in the old service being replaced by the new service.<a href="#section-3.2.5.5.2-2.2" class="pilcrow">¶</a>
</li>
              </ol>
<p id="section-3.2.5.5.2-3">
 It is perhaps worth noting that if a service is being updated without
 the service instance name changing (for example, when only the target
 port in the SRV record is being updated), then that SRP Update will
 look very much like the second alternative above.
 The PTR record in the Service Discovery Instruction will be the same for
 both the "Delete An RR From An RRset" update and the "Add To An RRset" update
 <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>.
 Since the removal of the old service and the addition
 of the new service are both valid SRP Update operations,
 the combined operation is a valid SRP Update operation.
 The SRP registrar does not need to include code to
 recognize this special case and does not need to
 take any special actions to handle it correctly.<a href="#section-3.2.5.5.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.5.5.2-4">
 Whichever of these two alternatives is used, the hostname lease
 will be updated with the lease time provided in the SRP update.
 In neither of these cases is it permissible to delete the hostname.
 All services must point to a hostname. If a hostname
 is to be deleted, this must be done using the method
 described in <a href="#zero-lease" class="auto internal xref">Section 3.2.5.5.1</a>, which deletes the
 hostname and all services that have that hostname as their target.<a href="#section-3.2.5.5.2-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
</section>
</section>
<div id="server_behavior">
<section id="section-3.3">
        <h3 id="name-validation-and-processing-o">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-validation-and-processing-o" class="section-name selfRef">Validation and Processing of SRP Updates</a>
        </h3>
<div id="add_validation">
<section id="section-3.3.1">
          <h4 id="name-validation-of-dns-update-ad">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-validation-of-dns-update-ad" class="section-name selfRef">Validation of DNS Update Add and Delete RRs</a>
          </h4>
<p id="section-3.3.1-1">
     The SRP registrar first validates that the DNS Update message is a syntactically and semantically valid DNS Update message according to
     the usual DNS Update rules <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">
     SRP Updates consist of a set of <em>instructions</em>
     that together add or remove one or more services.
     Each <em>instruction</em> consists of
     one or more delete update(s), or one or more add update(s),
     or some combination of both delete updates and add updates.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">
     The SRP registrar checks each instruction in the SRP Update to see that it is either a Service Discovery Instruction, a
     Service Description Instruction, or a Host Description Instruction.  Order matters in DNS updates.  Specifically,
     deletes must precede adds for records that the deletes would affect; otherwise, the add will have no effect.  This is the
     only ordering constraint: Aside from this constraint, updates may appear in whatever order is convenient when
     constructing the update.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">
     Because the SRP Update is a DNS update, it <span class="bcp14">MUST</span> contain a single entry in the Zone Section (what would be the Question Section in a DNS query or response) that indicates the zone to be updated. Every delete and update in an SRP Update <span class="bcp14">MUST</span> be within the zone that is specified for the SRP Update.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<div id="servdis">
<section id="section-3.3.1.1">
            <h5 id="name-service-discovery-instructi">
<a href="#section-3.3.1.1" class="section-number selfRef">3.3.1.1. </a><a href="#name-service-discovery-instructi" class="section-name selfRef">Service Discovery Instruction</a>
            </h5>
<p id="section-3.3.1.1-1">An instruction is a Service Discovery Instruction if it:<a href="#section-3.3.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.1.1-2.1">consists of
       exactly one "Add To An RRSet" or
       exactly one "Delete An RR From An RRSet"
       RR update
       (Section <a href="https://rfc-editor.org/rfc/rfc2136#section-2.5" class="relref">2.5</a>
       of the DNS Update specification <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>),<a href="#section-3.3.1.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.1-2.2">which updates a PTR RR,<a href="#section-3.3.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.1-2.3">the target of which is a service instance name<a href="#section-3.3.1.1-2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.1-2.4">
                <p id="section-3.3.1.1-2.4.1">for which name a Service Description Instruction is present in the SRP Update, and:<a href="#section-3.3.1.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.1.1-2.4.2.1">if the Service Discovery Instruction is an "Add To An RRSet" instruction,
   that Service Description Instruction contains
   a "Delete All RRsets From A Name" instruction for that service instance name
   followed by "Add To An RRset" instructions
   for the SRV and TXT records describing that service; or<a href="#section-3.3.1.1-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-3.3.1.1-2.4.2.2">if the Service Discovery Instruction is a "Delete An RR
   From An RRSet" instruction, that Service Description
   Instruction contains a "Delete All RRsets From A Name"
   instruction for that service instance name with no following
   "Add To An RRset" instructions for the SRV and TXT records
   describing that service. An "Add to an RRset" instruction
   for the KEY record here is allowed but not
   implicit.<a href="#section-3.3.1.1-2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-3.3.1.1-3">
       Note that there can be more than one Service Discovery
       Instruction for the same service name
       (the owner name of the Service Discovery PTR record)
       if the SRP requester is advertising more than one instance
       of the same service type or is changing the target of a PTR RR.
       When subtypes are being used
       (Section <a href="https://rfc-editor.org/rfc/rfc6763#section-7.1" class="relref">7.1</a>
       of the DNS‑SD specification <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>),
       each subtype is a separate Service Discovery Instruction.
       For each such PTR RR add or delete, the above constraints must be met.<a href="#section-3.3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="servdesc">
<section id="section-3.3.1.2">
            <h5 id="name-service-description-instruc">
<a href="#section-3.3.1.2" class="section-number selfRef">3.3.1.2. </a><a href="#name-service-description-instruc" class="section-name selfRef">Service Description Instruction</a>
            </h5>
<p id="section-3.3.1.2-1">An instruction is a Service Description Instruction if, for the
            given service instance name, all of the following are true:<a href="#section-3.3.1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.1.2-2.1">
 It contains exactly one "Delete All RRsets From A Name" update for the service instance name
 (Section <a href="https://rfc-editor.org/rfc/rfc2136#section-2.5.3" class="relref">2.5.3</a>
 of the DNS Update specification <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>).<a href="#section-3.3.1.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.2-2.2">
 It contains zero or one "Add To An RRset" KEY RRs that, if present, contains the public key corresponding to the private key
 that was used to sign the message (if present, the KEY RR <span class="bcp14">MUST</span> match the KEY RR given in the Host Description).<a href="#section-3.3.1.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.2-2.3">
 It contains zero or one "Add To An RRset" SRV RR.<a href="#section-3.3.1.2-2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.2-2.4">
 If an "Add To An RRSet" update for an SRV RR is present,
 there <span class="bcp14">MUST</span> be at least one "Add To An RRset"
 update for the corresponding TXT RR, and
 the target of the SRV RR <span class="bcp14">MUST</span> be the hostname given in the Host Description Instruction in
 the SRP Update, or<a href="#section-3.3.1.2-2.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.2-2.5">
 If there is no "Add To An RRset" update for an SRV RR, then
 there <span class="bcp14">MUST</span> be no "Add To An RRset" updates for the corresponding TXT RR,
 and either:<a href="#section-3.3.1.2-2.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-3.3.1.2-2.6">
                <ul class="compact">
<li class="compact" id="section-3.3.1.2-2.6.1.1">the name to which the "Delete All RRsets From A Name" applies does not exist, or<a href="#section-3.3.1.2-2.6.1.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-3.3.1.2-2.6.1.2">there is an existing KEY RR on that name that matches the key with which the SRP Update was
   signed.<a href="#section-3.3.1.2-2.6.1.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-3.3.1.2-3">Service Description Instructions do not add any other resource records.<a href="#section-3.3.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1.2-4">An SRP registrar <span class="bcp14">MUST</span> correctly handle compressed names in the SRV target.<a href="#section-3.3.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hdi">
<section id="section-3.3.1.3">
            <h5 id="name-host-description-instructio">
<a href="#section-3.3.1.3" class="section-number selfRef">3.3.1.3. </a><a href="#name-host-description-instructio" class="section-name selfRef">Host Description Instruction</a>
            </h5>
<p id="section-3.3.1.3-1">Every SRP Update always contains exactly one Host Description Instruction.<a href="#section-3.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1.3-2">An instruction is a Host Description Instruction if, for the appropriate hostname, it contains the following:<a href="#section-3.3.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1.3-3.1">
 exactly one "Delete All RRsets From A Name" RR<a href="#section-3.3.1.3-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.3.1.3-3.2">
 exactly one "Add To An RRset" RR that adds a KEY RR that
 contains the public key corresponding to the private key that
 was used to sign the message<a href="#section-3.3.1.3-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.3.1.3-3.3">
 zero "Add To An RRset" operations (in the case of deleting a registration)
 or one or more "Add To An RRset" RRs of type A and/or AAAA
 (in the case of creating or updating a registration)<a href="#section-3.3.1.3-3.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-3.3.1.3-4">
       Host Description Instructions do not add any other resource records.<a href="#section-3.3.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1.3-5">
       A and/or AAAA records that are not of sufficient scope to be
       validly published in a DNS zone <span class="bcp14">MAY</span> be ignored by
       the SRP registrar, which could result in a Host Description
       effectively containing zero reachable addresses even when it
       contains one or more addresses.<a href="#section-3.3.1.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1.3-6">
       For example, if an IPv4 link-local address <span>[<a href="#RFC3927" class="cite xref">RFC3927</a>]</span>
       or an IPv6 link-local address <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>
       is provided by the SRP requester, the SRP
       registrar could elect not to publish this in a DNS zone.
       However, in some situations, the registrar might make the records
       available through a mechanism such as an advertising proxy only on the specific link from which the SRP Update
       originated. In such a situation, locally scoped records are still valid.<a href="#section-3.3.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="validation">
<section id="section-3.3.2">
          <h4 id="name-valid-srp-update-requiremen">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-valid-srp-update-requiremen" class="section-name selfRef">Valid SRP Update Requirements</a>
          </h4>
<p id="section-3.3.2-1">
     An SRP Update <span class="bcp14">MUST</span> contain exactly one Host Description Instruction.
 Multiple Service Discovery updates and Service Description updates
 may be combined into a single SRP Update
 along with a single Host Description update,
 as described in <a href="#how" class="auto internal xref">Section 3.2.3</a>.
     A DNS Update message that contains any additional
     adds or deletes that cannot be identified as Service Discovery, Service Description, or Host Description Instructions is
     not an SRP Update. A DNS update that contains any prerequisites is not an SRP Update.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">An SRP Update <span class="bcp14">MUST</span> include an EDNS(0) Update Lease option
     <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>.
     The LEASE time specified in the Update Lease
     option <span class="bcp14">MUST</span> be less than
     or equal to the KEY-LEASE time. A DNS update that does not include the Update Lease option, or that includes a
     KEY-LEASE value that is less than the LEASE value, is not an SRP Update.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">When an SRP registrar receives a DNS Update message that is not an SRP
   update, it <span class="bcp14">MAY</span> process the update as normal DNS Update
   <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>, including
   access control checks and constraint checks, if supported. Otherwise,
   the SRP registrar <span class="bcp14">MUST</span> reject the DNS Update with the
   Refused RCODE.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2-4">
     If the definitions of each of these instructions are followed
     carefully and the update requirements are validated correctly,
     many DNS Update messages that look very much like SRP Updates
     nevertheless will fail to validate.  For example, a DNS update
     that contains an "Add To An RRset" instruction for a Service Name
     and an "Add to an RRset" instruction for a service instance name
     where the PTR record added to the Service Name does not reference
     the service instance name is not a valid SRP Update but may be a
     valid DNS Update.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.3.3">
          <h4 id="name-fcfs-name-and-signature-val">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-fcfs-name-and-signature-val" class="section-name selfRef">FCFS Name and Signature Validation</a>
          </h4>
<p id="section-3.3.3-1">
     Assuming that the SRP registrar has confirmed that a DNS Update message
     is a valid SRP Update (<a href="#validation" class="auto internal xref">Section 3.3.2</a>), it
     then checks that the name in the Host Description Instruction exists in the zone being updated.  If so, then the registrar checks to see if the KEY
     record on that name is the same as the KEY record in the Host Description Instruction.  The registrar performs the same
     check for the KEY records in any Service Description Instructions.  For KEY records that were omitted from Service
     Description Instructions, the KEY from the Host Description Instruction is used.  If any existing KEY record
     corresponding to a KEY record in the SRP Update does not match the KEY record in the SRP Update (whether provided
     or taken from the Host Description Instruction), then the SRP registrar
     <span class="bcp14">MUST</span> reject the SRP Update with a YXDomain
     RCODE indicating that the desired name is already owned by a different SIG(0) key.
     This informs the SRP requester that it should select a different name and try again.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">
     If the SRP Update is not in conflict with existing data in the zone being updated, the SRP registrar validates the SRP Update using SIG(0) against the public key in the KEY record of the Host
     Description Instruction.  If the validation fails,
     the SRP Update is malformed, and the registrar
     <span class="bcp14">MUST</span> reject the SRP Update with the Refused RCODE.
     Otherwise, the SRP Update is considered valid and authentic and
     is processed as for a normal DNS Update <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">
     KEY record updates omitted from Service Description Instruction(s) are processed as if they had been explicitly present.
     After the SRP Update has been applied, every Service Description that is updated <span class="bcp14">MUST</span> have a KEY RR, which <span class="bcp14">MUST</span> have the
     same value as the KEY RR that is present in the Host Description to which the Service Description refers.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3.3-4">
     The IETF specification for
     DNSSEC Resource Records <span>[<a href="#RFC4034" class="cite xref">RFC4034</a>]</span>
     states that the flags field in the KEY RR
     <span class="bcp14">MUST</span> be zero except for bit 7, which can
     be one in the case of a zone key.
     SRP requesters implementing this version of the SRP specification
     <span class="bcp14">MUST</span> set the flags field in the KEY RR to all zeroes.
     SRP registrars implementing this version of the SRP specification
     <span class="bcp14">MUST</span> accept and store the flags field in the KEY RR
     as received, without checking or modifying its value.<a href="#section-3.3.3-4" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3.4">
          <h4 id="name-handling-of-service-subtype">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-handling-of-service-subtype" class="section-name selfRef">Handling of Service Subtypes</a>
          </h4>
<p id="section-3.3.4-1">
     SRP registrars <span class="bcp14">MUST</span> treat the update instructions for a service type and all its subtypes as atomic. That is, when a
     service and its subtypes are being updated, whatever information appears in the SRP Update is the entirety of
     information about that service and its subtypes. If any subtype appeared in a previous update but does not appear in
     the current update, then the SRP registrar <span class="bcp14">MUST</span> remove that subtype.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">
     There is intentionally no mechanism for deleting a single subtype
     individually. A delete of a service deletes all of its subtypes.
     To delete a single subtype individually, an SRP Update must
     be constructed that contains the service type and all subtypes
     for that service except for the subtype(s) to be deleted.<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3.5">
          <h4 id="name-srp-update-response">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-srp-update-response" class="section-name selfRef">SRP Update Response</a>
          </h4>
<p id="section-3.3.5-1">
     The status that is returned depends on the result of processing the update and can be either NoError, ServFail, Refused,
     or YXDomain. All other possible outcomes will already have been accounted for when applying the constraints that
     qualify the update as an SRP Update. The meanings of these responses are explained in
     Section <a href="https://rfc-editor.org/rfc/rfc2136#section-2.2" class="relref">2.2</a>
     of the DNS Update specification <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">
     In the case of a response other than NoError,
     Section <a href="https://rfc-editor.org/rfc/rfc2136#section-3.8" class="relref">3.8</a>
     of the DNS Update specification <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>
     states that
     the authoritative DNS server is permitted
            to respond either with no RRs or to copy the RRs
            sent by the DNS Update client into the response.
            The SRP requester <span class="bcp14">MUST NOT</span> attempt
     to validate any RRs that are included in the response. It is possible that a future SRP extension may include per-RR
     indications as to why the update failed, but
     at the time of writing this is not specified.
     So, if an SRP requester were to attempt to validate
            the RRs in the response, it might reject such a response, since it would contain RRs but probably not a set of RRs
     identical to what was sent in the SRP Update.<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3.6">
          <h4 id="name-optional-behavior">
<a href="#section-3.3.6" class="section-number selfRef">3.3.6. </a><a href="#name-optional-behavior" class="section-name selfRef">Optional Behavior</a>
          </h4>
<p id="section-3.3.6-1">
     The SRP registrar <span class="bcp14">MAY</span> add a Reverse Mapping PTR record
     (described for IPv4 in Section 
     <a href="https://rfc-editor.org/rfc/rfc1035#section-3.5" class="relref">3.5</a>
     of the DNS specification <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>
     and for IPv6 in Section 
     <a href="https://rfc-editor.org/rfc/rfc3596#section-2.5" class="relref">2.5</a>
     of the later document updating DNS for IPv6 <span>[<a href="#RFC3596" class="cite xref">RFC3596</a>]</span>) that corresponds to the Host Description.
     This is optional: The reverse mapping PTR record serves no
     essential protocol function. One reason to provide reverse
     mappings is that they can be used to annotate logs and network
     packet traces. In order for the registrar to do a reverse mapping
     update, it must be authoritative for the zone that would need to
     be updated or have credentials to do the update.  The SRP
     requester <span class="bcp14">MAY</span> also do a reverse mapping update if
     it has credentials to do so.<a href="#section-3.3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.3.6-2">
     The SRP registrar <span class="bcp14">MAY</span> apply additional criteria when accepting updates.  In some networks, it may be possible to do
     out-of-band registration of keys and only accept updates from preregistered keys.  In this case, an update for a key
     that has not been registered <span class="bcp14">SHOULD</span> be rejected with the Refused RCODE.
     When use of managed keys is desired,
     there are at least two benefits to doing this in conjunction with SRP
     rather than simply performing traditional DNS Updates using SIG(0) keys:<a href="#section-3.3.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3.6-3">
<li id="section-3.3.6-3.1">The same
     over-the-air registration protocol is used in both cases,
     so both use cases can be addressed by the same SRP requester
     implementation.<a href="#section-3.3.6-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.6-3.2">The Service Registration Protocol includes
     maintenance functionality not present with normal DNS
     updates.<a href="#section-3.3.6-3.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.3.6-4">
     Note that the semantics of using SRP in this way
     are different from the semantics of typical
     implementations of DNS Update. The KEY used
     to sign the SRP Update only allows the SRP requester to update records that refer to its Host Description.
     Implementations of traditional DNS Update
     <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> do not normally provide
     a way to enforce a constraint of this type.<a href="#section-3.3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.3.6-5">
     The SRP registrar could also have a dictionary of names or name patterns that are not permitted.  If such a list is used,
     updates for service instance names that match entries in the dictionary are rejected with a Refused RCODE.<a href="#section-3.3.6-5" class="pilcrow">¶</a></p>
</section>
</section>
</div>
</section>
<section id="section-4">
      <h2 id="name-ttl-consistency">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ttl-consistency" class="section-name selfRef">TTL Consistency</a>
      </h2>
<p id="section-4-1">
 All RRs within an RRset are required to have the same TTL
 (required by
 Section <a href="https://rfc-editor.org/rfc/rfc2181#section-5.2" class="relref">5.2</a>
 of the DNS Clarifications document <span>[<a href="#RFC2181" class="cite xref">RFC2181</a>]</span>).
 In order to avoid inconsistencies, SRP places restrictions on TTLs sent by requesters and requires that SRP registrars enforce
 consistency.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
 Requesters sending SRP Updates <span class="bcp14">MUST</span> use consistent
 TTLs in all RRs within each RRset contained within an SRP Update.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
 SRP registrars <span class="bcp14">MUST</span> check that the TTLs for all RRs
 within each RRset contained within an SRP Update are the same.
 If they are not, the SRP
 update <span class="bcp14">MUST</span> be rejected with a Refused RCODE.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
 Additionally, when adding RRs to an RRset (for example, when processing Service Discovery records), the SRP registrar <span class="bcp14">MUST</span> use the
 same TTL on all RRs in the RRset.  How this consistency is enforced is up to the implementation.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
 TTLs sent in SRP Updates are advisory: they indicate the SRP requester's guess as to what a good TTL would be.  SRP registrars may
 override these TTLs.  SRP registrars <span class="bcp14">SHOULD</span> ensure that TTLs are reasonable: neither too long nor too short.  The TTL <span class="bcp14">SHOULD NOT</span>
 ever be longer than the lease time (<a href="#stale" class="auto internal xref">Section 5.1</a>).  Shorter TTLs will result in more frequent data refreshes;
 this increases latency on the DNS‑SD client side, increases
 load on any caching resolvers and on the authoritative DNS server,
 and also increases network load, which may be an issue for CNNs.  Longer TTLs will increase the likelihood
 that data in caches will be stale.  TTL minimums and maximums <span class="bcp14">SHOULD</span> be configurable by the operator of the SRP registrar.<a href="#section-4-5" class="pilcrow">¶</a></p>
</section>
<div id="maintenance">
<section id="section-5">
      <h2 id="name-maintenance">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-maintenance" class="section-name selfRef">Maintenance</a>
      </h2>
<div id="stale">
<section id="section-5.1">
        <h3 id="name-cleaning-up-stale-data">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cleaning-up-stale-data" class="section-name selfRef">Cleaning Up Stale Data</a>
        </h3>
<p id="section-5.1-1">Because the DNS‑SD Service Registration Protocol
          is automatic and not managed by humans,
          some additional bookkeeping is required.  When an update is constructed by the SRP requester,
          it <span class="bcp14">MUST</span> include an EDNS(0) Update Lease Option <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>.
          The Update Lease Option contains two lease times: the Lease Time and the KEY
          Lease Time.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Similar to DHCP leases <span>[<a href="#RFC2131" class="cite xref">RFC2131</a>]</span>,
          these leases are promises from the SRP requester that it will
          send a new update for the service registration before the
          lease time expires.
          The Lease time is chosen to represent the duration after the update
          during which the registered records other than the KEY record
          can be assumed to be valid.
          The KEY lease time represents the duration after the update
          during which the KEY record can be assumed to be valid.
          The reasoning behind the different lease times is discussed in
          Sections <a href="#fcfs" class="auto internal xref">3.2.4.1</a> and
          <a href="#lifetimes" class="auto internal xref">3.2.5.3</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">SRP registrars may be configured with limits for these values.
          At the time of writing, a default limit of two hours for
          the Lease and 14 days for the SIG(0) KEY are thought to be good choices.  Devices with limited
          battery that wake infrequently are likely to request longer leases; registrars that support such devices may need to set
          higher limits.  SRP requesters that are going to
          continue to use names on which they hold leases
          <span class="bcp14">SHOULD</span> refresh them well before
          the lease ends in case the registrar is
          temporarily unavailable or under heavy load.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
   The lease time applies specifically to the hostname.
   All service instances, and all service entries for such service
   instances, depend on the hostname. When the lease on a
   hostname expires, the hostname and all services that
   reference it <span class="bcp14">MUST</span> be removed at the same
   time: It is never valid for a service instance to remain
   when the hostname it references has been removed.
   If the KEY record for the hostname is to remain, the KEY record
   for any services that reference it <span class="bcp14">MUST</span> also
   remain. However, the Service Discovery PTR record <span class="bcp14">MUST</span>
   be removed since it has no key associated with it and since it
   is never valid to have a Service Discovery PTR record for which
   there is no service instance on the target of the PTR record.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">
   SRP registrars <span class="bcp14">MUST</span> also track a lease time per service instance. The reason being that a requester may
   re-register a hostname with a different set of services and
   not remember that some different service instance had previously
   been registered. In this case, when that service instance lease expires, the SRP registrar <span class="bcp14">MUST</span> remove the service
   instance,
   and any associated Service Discovery PTR records pointing to that service instance,
   (although the KEY record for the service instance
   <span class="bcp14">SHOULD</span> be retained until the
   KEY lease on that service
   expires).
   This is beneficial because it avoids stale services continuing
   to be advertised after the SRP requester has forgotten about them.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">The SRP registrar <span class="bcp14">MUST</span> include an EDNS(0) Update
 Lease option in the response.  The requester <span class="bcp14">MUST</span> check
 for the EDNS(0) Update Lease option in the response, and when deciding
 when to renew its registration the requester <span class="bcp14">MUST</span> use
 the lease times from the Update Lease option in the response in place
 of the lease times that it originally requested from the registrar.
 The times may be shorter or longer than those specified in the SRP
 Update. The SRP requester must honor them in either case.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">SRP requesters <span class="bcp14">SHOULD</span> assume that each lease ends N
 seconds after the update was first transmitted (where N is the granted lease
 duration).  SRP registrars <span class="bcp14">SHOULD</span> assume that each lease
 ends N seconds after the update that was successfully processed was
 received.  Because the registrar will always receive the update after
 the SRP requester sent it, this avoids the possibility of
 a race condition where the SRP registrar prematurely removes
 a service when the SRP requester thinks the lease has not yet expired.
 In addition, the SRP requester <span class="bcp14">MUST</span> begin attempting to renew
 its lease in advance of the expected expiration time, as required
 by the DNS Update Lease specification <span>[<a href="#RFC9664" class="cite xref">RFC9664</a>]</span>,
 to accommodate the situation where the clocks on the SRP requester
 and the SRP registrar do not run at precisely the same rate.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">SRP registrars <span class="bcp14">MUST</span> reject updates that do not
 include an EDNS(0) Update Lease option.  DNS authoritative servers
 that allow both SRP and non-SRP DNS updates <span class="bcp14">MAY</span> accept
 updates that don't include leases, but they <span class="bcp14">SHOULD</span>
 differentiate between SRP Updates and other updates and
 <span class="bcp14">MUST</span> reject updates that would otherwise be SRP Updates
 if they do not include leases.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">The function of Lease times and the
 function of TTLs are completely different. On an
 authoritative DNS server, the TTL on a resource record is a
 constant. Whenever that RR is served in a DNS response, the TTL value
 sent in the answer is the same.  The lease time is never sent as a
 TTL; its sole purpose is to determine when the authoritative DNS
 server will delete stale records.  It is not an error to send a DNS
 response with a TTL of M when the remaining time on the lease is
 less than M.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="source_validation">
<section id="section-6.1">
        <h3 id="name-source-validation">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-source-validation" class="section-name selfRef">Source Validation</a>
        </h3>
<p id="section-6.1-1">SRP Updates have no authorization semantics other than
   "First Come, First Served" (FCFS).
   Thus, if an attacker from outside the administrative
   domain of the SRP registrar knows the registrar's IP address, it can, in principle, send updates to the registrar
   that will be processed successfully.   Therefore, SRP registrars <span class="bcp14">SHOULD</span> be configured to reject updates
   from source addresses outside of the administrative domain of the registrar.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">For TCP updates, the initial SYN-SYN+ACK handshake prevents
   updates being forged by an off-path attacker.  In order to
   ensure that this handshake happens, SRP registrars relying on three-way-handshake validation <span class="bcp14">MUST NOT</span> accept TCP Fast Open payloads
   <span>[<a href="#RFC7413" class="cite xref">RFC7413</a>]</span>.
   If the network infrastructure allows it, an SRP registrar
   <span class="bcp14">MAY</span> accept TCP Fast Open payloads if all such packets
   are validated along the path, and the network is able to reject this type of spoofing at all ingress points.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">For UDP updates from CNN devices, spoofing would have to be prevented with appropriate source address filtering
   on routers <span>[<a href="#RFC2827" class="cite xref">RFC2827</a>]</span>.
   This would ordinarily be accomplished by measures such as those described in
   Section <a href="https://rfc-editor.org/rfc/rfc7084#section-4.5" class="relref">4.5</a>
   of the IPv6 CE Router Requirements document <span>[<a href="#RFC7084" class="cite xref">RFC7084</a>]</span>.
   For example, a stub router <span>[<a href="#I-D.ietf-snac-simple" class="cite xref">SNAC-SIMPLE</a>]</span>
   for a CNN might only accept UDP updates from source addresses known to be on-link on that stub network and might
   further validate that the UDP update was actually received on the stub network interface and not the interface connected to
   the adjacent infrastructure link.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.2">
        <h3 id="name-other-dns-updates">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-other-dns-updates" class="section-name selfRef">Other DNS Updates</a>
        </h3>
<p id="section-6.2-1">Note that these rules only apply to the validation of SRP Updates.
   An authoritative DNS server that accepts updates from SRP
   requesters may also accept other DNS Update messages, and those DNS Update messages may be validated
   using different rules.
   However, in the case of an authoritative DNS server that accepts SRP
   updates, the intersection of the SRP Update rules and
   whatever other update rules are present must be considered very carefully.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">For example, a normal authenticated DNS update to any
   RR that was added using SRP, but is authenticated using a
   different key, could be used to override a promise made by the SRP registrar to an SRP requester by replacing all or part of
   the service registration information with information provided by an authenticated DNS update requester.  An implementation
   that allows both kinds of updates <span class="bcp14">SHOULD NOT</span> allow DNS Update requesters that are using different authentication and
   authorization credentials to update records added by SRP requesters.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-6.3">
        <h3 id="name-risks-of-allowing-arbitrary">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-risks-of-allowing-arbitrary" class="section-name selfRef">Risks of Allowing Arbitrary Names to be Registered in SRP Updates</a>
        </h3>
<p id="section-6.3-1">It is possible to set up SRP Updates for a zone
   that is also used for non-DNS‑SD records.
   For example, imagine that you set
   up SRP service for "example.com".
   SRP requesters can now register names like "www"
   or "mail" or "smtp" in this domain. In addition,
   SRP Updates using FCFS Naming can insert names that are obscene or offensive into the zone. There is no simple solution to
   these problems. However, we have two recommendations to address this problem:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">Do not provide SRP service in organization-level zones.
     Use subdomains of the organizational domain for DNS‑SD.
     This does not prevent registering names as mentioned above
     but does ensure that genuinely important names
     are not accidentally claimed by SRP requesters.
     So, for example, the zone "dnssd.example.com." could be used
     instead of "example.com." for SRP Updates. Because of the way that
     DNS-browsing domains are discovered, there is no need for the
     DNS‑SD discovery zone that is updated by SRP to
     have a user-friendly or important-sounding name.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.2">Configure a dictionary of names that are prohibited. Dictionaries of common obscene and offensive names are no doubt
     available and can be augmented with a list of typical "special" names like "www", "mail", "smtp", and so on. Lists of
     names are generally available or can be constructed manually.
     Names rejected due to this should return a Refused
     RCODE, indicating to the SRP requester that it
     should not append or increment a number at the
     end of the name and then try again, since this
     would likely result in an infinite loop.
     If a name is considered unacceptable because it is
     obscene or offensive, adding a number on the end is
     unlikely to make the name acceptable.<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-6.4">
        <h3 id="name-security-of-local-service-d">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-security-of-local-service-d" class="section-name selfRef">Security of Local Service Discovery</a>
        </h3>
<p id="section-6.4-1">Local links can be protected by managed services such as RA Guard
 <span>[<a href="#RFC6105" class="cite xref">RFC6105</a>]</span>, but multicast services like DHCP <span>[<a href="#RFC2131" class="cite xref">RFC2131</a>]</span>, DHCPv6 <span>[<a href="#RFC8415" class="cite xref">RFC8415</a>]</span>, and IPv6 Neighbor
 Discovery <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> are, in most cases, not
 authenticated and can't be controlled on unmanaged networks, such as
 home networks and small office networks where no network management
 staff are present. In such situations, the SRP service has
 comparatively fewer potential security exposures and, hence, is not
 the weak link. This is discussed in more detail in <a href="#how-to-secure" class="auto internal xref">Section 3.2.4</a>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">The fundamental protection for networks of this type is the user's
 choice of what devices to add to the network. Work is being done in
 other working groups and standards bodies to improve the state of the
 art for network on-boarding and device isolation (e.g., Manufacturer
 Usage Descriptions <span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span> provide a means for
 constraining what behaviors are allowed for a device in an automatic
 way), but such work is out of scope for this document.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5">
        <h3 id="name-srp-registrar-authenticatio">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-srp-registrar-authenticatio" class="section-name selfRef">SRP Registrar Authentication</a>
        </h3>
<p id="section-6.5-1">This specification does not provide a mechanism for validating responses from SRP registrars to
   SRP requesters.   In principle, a KEY RR could be used by
   a non-CNN SRP requester to validate responses from the registrar, but this is not required,
   nor do we specify a mechanism for determining which key to use.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">In addition, for DNS-over-TLS connections, out-of-band key pinning as described in
   Section <a href="https://rfc-editor.org/rfc/rfc7858#section-4.2" class="relref">4.2</a>
   of the DNS-over-TLS specification <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>
   could be used for authentication of the SRP registrar,
   e.g., to prevent man-in-the-middle attacks. However, the use of such keys is impractical for an unmanaged service
   registration protocol; hence, it is out of scope for this document.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
<div id="rsa">
<section id="section-6.6">
        <h3 id="name-required-signature-algorith">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-required-signature-algorith" class="section-name selfRef">Required Signature Algorithm</a>
        </h3>
<p id="section-6.6-1">
   For validation, SRP registrars <span class="bcp14">MUST</span> implement the ECDSAP256SHA256 signature algorithm.  SRP registrars <span class="bcp14">SHOULD</span> implement the
   algorithms that are listed in
   Section <a href="https://rfc-editor.org/rfc/rfc8624#section-3.1" class="relref">3.1</a>
   of the DNSSEC Cryptographic Algorithms specification <span>[<a href="#RFC8624" class="cite xref">RFC8624</a>]</span>,
   in the validation column of the
   table, that are numbered 13 or higher and that have a "<span class="bcp14">MUST</span>", "<span class="bcp14">RECOMMENDED</span>", or "<span class="bcp14">MAY</span>" designation in the validation column of
   the table.
   SRP requesters <span class="bcp14">MUST NOT</span> assume that any algorithm numbered lower than 13 is
   available for use in validating SIG(0) signatures.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">
 Because DNS‑SD SRP Updates can be sent off-link,
 the privacy implications of SRP are
 different from those for mDNS responses.
 SRP Requester implementations that are using TCP <span class="bcp14">SHOULD</span>
 also use DNS-over-TLS <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span> if available.
 SRP registrar implementations <span class="bcp14">MUST</span> offer TLS support.
 Because there is no mechanism for sharing keys,
 validation of DNS-over-TLS keys is not possible;
 DNS-over-TLS is used only for Opportunistic Privacy, as documented in
 Section <a href="https://rfc-editor.org/rfc/rfc7858#section-4.1" class="relref">4.1</a>
 of the DNS-over-TLS specification <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
 SRP requesters that are able to use TLS <span class="bcp14">SHOULD NOT</span>
 fall back to TCP. Since all SRP registrars are required to support TLS,
 whether to use TLS is entirely the decision of the SRP requester.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
 Public keys can be used as identifiers to track hosts. SRP registrars <span class="bcp14">MAY</span> elect not to return KEY records for queries for
 SRP registrations. To avoid DNSSEC validation failures, an SRP registrar that signs the zone for DNSSEC but refuses to return
 a KEY record <span class="bcp14">MUST NOT</span> store the KEY record in the zone itself. Because the KEY record isn't in the zone, the nonexistence of
 the KEY record can be validated.
 If the zone is not signed, the authoritative DNS server <span class="bcp14">MAY</span>
 instead return a negative response (either NXDOMAIN or no data).<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-domain-name-reservation-con">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-domain-name-reservation-con" class="section-name selfRef">Domain Name Reservation Considerations</a>
      </h2>
<p id="section-8-1">This section specifies considerations for systems involved in domain name resolution when resolving queries for names
 ending with ".service.arpa.".  Each item in this section addresses some aspect of the DNS or the process of resolving domain
 names that would be affected by this special-use allocation.
 Detailed explanations of these items can be found in
 Section <a href="https://rfc-editor.org/rfc/rfc6761#section-5" class="relref">5</a>
 of the Special-Use Domain Names specification <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<section id="section-8.1">
        <h3 id="name-users">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-users" class="section-name selfRef">Users</a>
        </h3>
<p id="section-8.1-1">The current proposed use for "service.arpa." does not
 require special knowledge on the part of the user. While the
   "default.service.arpa." subdomain is used as a generic name for registration, users are not expected to see this name in
   user interfaces. In the event that it does show up in a user interface, it is just a domain name and requires no special
   treatment by the user.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-application-software">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-application-software" class="section-name selfRef">Application Software</a>
        </h3>
<p id="section-8.2-1">
   Application software does not need to handle
   subdomains of "service.arpa." specially.
   "service.arpa." <span class="bcp14">SHOULD NOT</span> be treated
   as more trustworthy than any other insecure DNS domain, simply because it is locally served (or for any other reason). It
   is not possible to register a PKI certificate for a subdomain of "service.arpa." because it is a locally served domain
   name. So, no such subdomain can be considered to be uniquely identifying a particular host, as would be required for such a
   PKI certificate to be issued. If a subdomain of "service.arpa." is returned by an API or entered in an input field of an
   application, PKI authentication of the endpoint being identified by the name will not be possible. Alternative methods
   and practices for authenticating such endpoints are out of scope for this document.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.3">
        <h3 id="name-name-resolution-apis-and-li">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-name-resolution-apis-and-li" class="section-name selfRef">Name Resolution APIs and Libraries</a>
        </h3>
<p id="section-8.3-1">Name resolution APIs and libraries <span class="bcp14">MUST NOT</span> recognize names that end in "service.arpa." as special and <span class="bcp14">MUST NOT</span> treat
   them as having special significance, except that it may be
   necessary that such APIs not bypass the locally discovered
   recursive resolvers.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">One or more IP addresses for recursive resolvers will usually
   be supplied to the SRP requester through router advertisements
   or DHCP.  For an administrative domain that uses subdomains of "service.arpa.", the recursive resolvers provided by that
   domain will be able to answer queries for subdomains of "service.arpa.". Other (non-local) resolvers will not, or they
   will provide answers that are not correct within that administrative domain.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">A host that is configured to use a resolver other than one that has been provided by the local network may not be able to
   resolve or may receive incorrect results for subdomains of
   "service.arpa.".  In order to avoid this, hosts <span class="bcp14">SHOULD</span> use the
   resolvers that are locally provided for resolving "service.arpa." names,
   even when they are configured to use other resolvers for other names.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
</section>
<section id="section-8.4">
        <h3 id="name-recursive-resolvers">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-recursive-resolvers" class="section-name selfRef">Recursive Resolvers</a>
        </h3>
<p id="section-8.4-1">There are two considerations for recursive resolvers
 (also known as "caching DNS servers" or "recursive DNS servers") that
 follow this specification:<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.4-2">
   <li id="section-8.4-2.1">For correctness, recursive resolvers at sites using
   'service.arpa.' must, in practice, transparently support DNSSEC
   queries: queries for DNSSEC records and queries with the DNSSEC OK
   (DO) bit set
   (Section <a href="https://rfc-editor.org/rfc/rfc4035#section-3.2.1" class="relref">3.2.1</a>
   of the DNSSEC specification <span>[<a href="#RFC4035" class="cite xref">RFC4035</a>]</span>).

   DNSSEC validation <span>[<a href="#RFC9364" class="cite xref">RFC9364</a>]</span>
   is a best current practice: Although validation is not required, a
   caching recursive resolver that does not validate answers that can
   be validated may cache invalid data.  In turn, this would prevent
   validating stub resolvers from successfully validating
   answers. Hence, as a practical matter, recursive resolvers at sites
   using "service.arpa." should do DNSSEC validation.<a href="#section-8.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.4-2.2">
            <p id="section-8.4-2.2.1">Unless configured otherwise, recursive resolvers and DNS
     proxies <span class="bcp14">MUST</span> behave following
     the rules prescribed for Iterative Resolvers in
     Section <a href="https://rfc-editor.org/rfc/rfc6303#section-3" class="relref">3</a>
     of the IETF Locally Served DNS Zones document <span>[<a href="#RFC6303" class="cite xref">RFC6303</a>]</span>.
     That is, queries for "service.arpa." and subdomains of
     "service.arpa." <span class="bcp14">MUST NOT</span> be forwarded, with one
     important exception: a query for a DS record with the DO bit set
     <span class="bcp14">MUST</span> return the correct answer for that question,
     including correct information in the authority section that proves
that the record is nonexistent.<a href="#section-8.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4-2.2.2">So, for example, a query for the NS record for "service.arpa."
            <span class="bcp14">MUST NOT</span> result in that query being forwarded to an
            upstream cache nor to the authoritative DNS server for ".arpa.".
            However, to provide accurate authority information, a
            query for the DS record <span class="bcp14">MUST</span> result in forwarding
            whatever queries are necessary. Typically, this will just be a
            query for the DS record since the necessary authority information
            will be included in the authority section of the response if the
            DO bit is set.<a href="#section-8.4-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
<section id="section-8.5">
        <h3 id="name-authoritative-dns-servers">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-authoritative-dns-servers" class="section-name selfRef">Authoritative DNS Servers</a>
        </h3>
<p id="section-8.5-1">No special processing of "service.arpa." is required for authoritative DNS server implementations.  It is possible that an
   authoritative DNS server might attempt to check the authoritative DNS servers for "service.arpa." for a delegation beneath that
   name before answering authoritatively for such a delegated name.  In such a case, because the name always has only local
   significance, there will be no such delegation in the "service.arpa." zone;
   therefore, the authoritative DNS server would refuse to answer
   authoritatively for such a zone.  An authoritative DNS server that implements
   this sort of check <span class="bcp14">MUST</span> be configurable so that either it does
   not do this check for the "service.arpa." domain or it ignores the results of the check.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.6">
        <h3 id="name-dns-server-operators">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-dns-server-operators" class="section-name selfRef">DNS Server Operators</a>
        </h3>
<p id="section-8.6-1">DNS server operators <span class="bcp14">MAY</span> configure an authoritative DNS server for "service.arpa." for use with SRP.  The operator for the
   DNS servers that are authoritative for "service.arpa." in the global DNS will configure any such DNS servers as described in
   <a href="#delegation" class="auto internal xref">Section 9</a>.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8.7">
        <h3 id="name-dns-registries-registrars">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-dns-registries-registrars" class="section-name selfRef">DNS Registries/Registrars</a>
        </h3>
<p id="section-8.7-1">"service.arpa." is a subdomain of the "arpa." top-level domain,
   which is operated by IANA under the authority of the
   Internet Architecture Board (IAB) <span>[<a href="#RFC3172" class="cite xref">RFC3172</a>]</span>.
   There are no other DNS registrars for "arpa.".<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="delegation">
<section id="section-9">
      <h2 id="name-delegation-of-servicearpa">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-delegation-of-servicearpa" class="section-name selfRef">Delegation of "service.arpa."</a>
      </h2>
<p id="section-9-1">
 The owner of the "arpa." zone, at the time of writing the IAB <span>[<a href="#IAB-ARPA" class="cite xref">IAB-ARPA</a>]</span>,
 has added a delegation of "service.arpa."
 in the "arpa." zone <span>[<a href="#RFC3172" class="cite xref">RFC3172</a>]</span>,
 following the guidance provided in
 Section <a href="https://rfc-editor.org/rfc/rfc8375#section-7" class="relref">7</a>
 of the "home.arpa." specification <span>[<a href="#RFC8375" class="cite xref">RFC8375</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-registration-and-delegation">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-registration-and-delegation" class="section-name selfRef">Registration and Delegation of "service.arpa." as a Special-Use Domain Name</a>
        </h3>
<p id="section-10.1-1">IANA has recorded the domain name "service.arpa." in the "Special-Use Domain Names" registry
   <span>[<a href="#SUDN" class="cite xref">SUDN</a>]</span>. IANA has implemented the delegation requested in
   <a href="#delegation" class="auto internal xref">Section 9</a>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-10.2">
        <h3 id="name-addition-of-servicearpa-to-">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-addition-of-servicearpa-to-" class="section-name selfRef">Addition of "service.arpa." to the Locally-Served Zones Registry</a>
        </h3>
<p id="section-10.2-1">IANA has also added a new entry to the "Transport-Independent Locally-Served Zones Registry" registry of
   the "Locally-Served DNS Zones" group <span>[<a href="#LSDZ" class="cite xref">LSDZ</a>]</span>.
   The entry is for the domain "SERVICE.ARPA." with the
   description "DNS‑SD Service Registration Protocol
   Special-Use Domain" and lists this document as the reference.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
<div id="subdomains">
<section id="section-10.3">
        <h3 id="name-subdomains-of-servicearpa">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-subdomains-of-servicearpa" class="section-name selfRef">Subdomains of "service.arpa."</a>
        </h3>
<p id="section-10.3-1">This document only makes use of the "default.service.arpa."
 subdomain of "service.arpa." Other subdomains are reserved for future
 use by DNS‑SD or related work.  IANA has created the
 "service.arpa. Subdomain" registry <span>[<a href="#SUB" class="cite xref">SUB</a>]</span>.  The IETF has
 change control for this registry. New entries may be added either as a
 result of Standards Action (Section <a href="https://rfc-editor.org/rfc/rfc8126#section-4.9" class="relref">4.9</a> of the IANA Guidelines) or with
 IESG Approval (Section <a href="https://rfc-editor.org/rfc/rfc8126#section-4.10" class="relref">4.10</a> of the IANA Guidelines) <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, provided that the values and their meanings are
 documented in a permanent and readily available public specification,
 in sufficient detail so that interoperability between independent
 implementations is possible.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">
   IANA has grouped the "service.arpa. Subdomain" registry
   with the "Locally-Served DNS Zones" group.
          The registry is a table with three columns: the subdomain name (expressed as a fully qualified domain
   name), a brief description of how it is used, and a reference to the document that describes its use in detail.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">
   This initial contents of this registry are as follows:<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Subdomain Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">default.service.arpa.</td>
              <td class="text-left" rowspan="1" colspan="1">Default domain for SRP Updates</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9665</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<section id="section-10.4">
        <h3 id="name-service-name-registrations">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-service-name-registrations" class="section-name selfRef">Service Name Registrations</a>
        </h3>
<p id="section-10.4-1">IANA has added two new entries to the
   "Service Name and Transport Protocol Port Number Registry"
   <span>[<a href="#PORT" class="cite xref">PORT</a>]</span>. The following subsections
   contain tables with the fields required by
   Section <a href="https://rfc-editor.org/rfc/rfc6335#section-8.1.1" class="relref">8.1.1</a>
   of IANA's Procedures for Service Name allocation <span>[<a href="#RFC6335" class="cite xref">RFC6335</a>]</span>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<section id="section-10.4.1">
          <h4 id="name-dnssd-srp-service-name">
<a href="#section-10.4.1" class="section-number selfRef">10.4.1. </a><a href="#name-dnssd-srp-service-name" class="section-name selfRef">"dnssd-srp" Service Name</a>
          </h4>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Service Name       </td>
                <td class="text-left" rowspan="1" colspan="1">  dnssd-srp                         </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Transport Protocol </td>
                <td class="text-left" rowspan="1" colspan="1">  tcp                               </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Assignee           </td>
                <td class="text-left" rowspan="1" colspan="1">  IESG &lt;iesg@ietf.org&gt;        </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Contact            </td>
                <td class="text-left" rowspan="1" colspan="1">  IETF Chair &lt;chair@ietf.org&gt; </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Description        </td>
                <td class="text-left" rowspan="1" colspan="1">  DNS‑SD Service Discovery     </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Reference          </td>
                <td class="text-left" rowspan="1" colspan="1">  RFC 9665                          </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Port Number        </td>
                <td class="text-left" rowspan="1" colspan="1">  None                              </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Service Code       </td>
                <td class="text-left" rowspan="1" colspan="1">  None                              </td>
              </tr>
            </tbody>
          </table>
</section>
<section id="section-10.4.2">
          <h4 id="name-dnssd-srp-tls-service-name">
<a href="#section-10.4.2" class="section-number selfRef">10.4.2. </a><a href="#name-dnssd-srp-tls-service-name" class="section-name selfRef">"dnssd-srp-tls" Service Name</a>
          </h4>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field Name</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Service Name       </td>
                <td class="text-left" rowspan="1" colspan="1">  dnssd-srp-tls                     </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Transport Protocol </td>
                <td class="text-left" rowspan="1" colspan="1">  tcp                               </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Assignee           </td>
                <td class="text-left" rowspan="1" colspan="1">  IESG &lt;iesg@ietf.org&gt;                             </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Contact            </td>
                <td class="text-left" rowspan="1" colspan="1">  IETF Chair &lt;chair@ietf.org&gt;                        </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Description        </td>
                <td class="text-left" rowspan="1" colspan="1">  DNS‑SD Service Discovery (TLS) </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Reference          </td>
                <td class="text-left" rowspan="1" colspan="1">  RFC 9665                          </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Port Number        </td>
                <td class="text-left" rowspan="1" colspan="1">  None                              </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">  Service Code       </td>
                <td class="text-left" rowspan="1" colspan="1">  None                              </td>
              </tr>
            </tbody>
          </table>
</section>
</section>
<section id="section-10.5">
        <h3 id="name-anycast-address">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-anycast-address" class="section-name selfRef">Anycast Address</a>
        </h3>
<p id="section-10.5-1">IANA has allocated an IPv6 anycast address from the
   "IANA IPv6 Special-Purpose Address Registry" <span>[<a href="#IPv6" class="cite xref">IPv6</a>]</span>,
   similar to the Port
   Control Protocol <span>[<a href="#RFC6887" class="cite xref">RFC6887</a>]</span>
   anycast address <span>[<a href="#RFC7723" class="cite xref">RFC7723</a>]</span>.
   The purpose of this allocation is to provide a fixed anycast
   address that can be commonly used as a destination for
   SRP Updates when no SRP registrar is explicitly configured. The initial values for the registry are as follows:<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Address Block</td>
              <td class="text-left" rowspan="1" colspan="1">2001:1::3/128</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Name</td>
              <td class="text-left" rowspan="1" colspan="1">DNS‑SD Service Registration Protocol Anycast Address</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RFC</td>
              <td class="text-left" rowspan="1" colspan="1">RFC 9665</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Allocation Date</td>
              <td class="text-left" rowspan="1" colspan="1">2024-04</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Termination Date</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Source</td>
              <td class="text-left" rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Destination</td>
              <td class="text-left" rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Forwardable</td>
              <td class="text-left" rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Globally Reachable</td>
              <td class="text-left" rowspan="1" colspan="1">True</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Reserved-by-Protocol</td>
              <td class="text-left" rowspan="1" colspan="1">False</td>
            </tr>
          </tbody>
        </table>
</section>
</section>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1536">[RFC1536]</dt>
        <dd>
<span class="refAuthor">Kumar, A.</span>, <span class="refAuthor">Postel, J.</span>, <span class="refAuthor">Neuman, C.</span>, <span class="refAuthor">Danzig, P.</span>, and <span class="refAuthor">S. Miller</span>, <span class="refTitle">"Common DNS Implementation Errors and Suggested Fixes"</span>, <span class="seriesInfo">RFC 1536</span>, <span class="seriesInfo">DOI 10.17487/RFC1536</span>, <time datetime="1993-10" class="refDate">October 1993</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1536">https://www.rfc-editor.org/info/rfc1536</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2136">[RFC2136]</dt>
        <dd>
<span class="refAuthor">Vixie, P., Ed.</span>, <span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Rekhter, Y.</span>, and <span class="refAuthor">J. Bound</span>, <span class="refTitle">"Dynamic Updates in the Domain Name System (DNS UPDATE)"</span>, <span class="seriesInfo">RFC 2136</span>, <span class="seriesInfo">DOI 10.17487/RFC2136</span>, <time datetime="1997-04" class="refDate">April 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2136">https://www.rfc-editor.org/info/rfc2136</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2181">[RFC2181]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span> and <span class="refAuthor">R. Bush</span>, <span class="refTitle">"Clarifications to the DNS Specification"</span>, <span class="seriesInfo">RFC 2181</span>, <span class="seriesInfo">DOI 10.17487/RFC2181</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2181">https://www.rfc-editor.org/info/rfc2181</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2539">[RFC2539]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Storage of Diffie-Hellman Keys in the Domain Name System (DNS)"</span>, <span class="seriesInfo">RFC 2539</span>, <span class="seriesInfo">DOI 10.17487/RFC2539</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2539">https://www.rfc-editor.org/info/rfc2539</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2931">[RFC2931]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"DNS Request and Transaction Signatures ( SIG(0)s )"</span>, <span class="seriesInfo">RFC 2931</span>, <span class="seriesInfo">DOI 10.17487/RFC2931</span>, <time datetime="2000-09" class="refDate">September 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2931">https://www.rfc-editor.org/info/rfc2931</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3172">[RFC3172]</dt>
        <dd>
<span class="refAuthor">Huston, G., Ed.</span>, <span class="refTitle">"Management Guidelines &amp; Operational Requirements for the Address and Routing Parameter Area Domain ("arpa")"</span>, <span class="seriesInfo">BCP 52</span>, <span class="seriesInfo">RFC 3172</span>, <span class="seriesInfo">DOI 10.17487/RFC3172</span>, <time datetime="2001-09" class="refDate">September 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3172">https://www.rfc-editor.org/info/rfc3172</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3596">[RFC3596]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Ksinant, V.</span>, and <span class="refAuthor">M. Souissi</span>, <span class="refTitle">"DNS Extensions to Support IP Version 6"</span>, <span class="seriesInfo">STD 88</span>, <span class="seriesInfo">RFC 3596</span>, <span class="seriesInfo">DOI 10.17487/RFC3596</span>, <time datetime="2003-10" class="refDate">October 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3596">https://www.rfc-editor.org/info/rfc3596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6303">[RFC6303]</dt>
        <dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Locally Served DNS Zones"</span>, <span class="seriesInfo">BCP 163</span>, <span class="seriesInfo">RFC 6303</span>, <span class="seriesInfo">DOI 10.17487/RFC6303</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6303">https://www.rfc-editor.org/info/rfc6303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8375">[RFC8375]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span> and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"Special-Use Domain 'home.arpa.'"</span>, <span class="seriesInfo">RFC 8375</span>, <span class="seriesInfo">DOI 10.17487/RFC8375</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8375">https://www.rfc-editor.org/info/rfc8375</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8624">[RFC8624]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span> and <span class="refAuthor">O. Sury</span>, <span class="refTitle">"Algorithm Implementation Requirements and Usage Guidance for DNSSEC"</span>, <span class="seriesInfo">RFC 8624</span>, <span class="seriesInfo">DOI 10.17487/RFC8624</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8624">https://www.rfc-editor.org/info/rfc8624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8765">[RFC8765]</dt>
        <dd>
<span class="refAuthor">Pusateri, T.</span> and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"DNS Push Notifications"</span>, <span class="seriesInfo">RFC 8765</span>, <span class="seriesInfo">DOI 10.17487/RFC8765</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8765">https://www.rfc-editor.org/info/rfc8765</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9364">[RFC9364]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9364">https://www.rfc-editor.org/info/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9664">[RFC9664]</dt>
      <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"An EDNS(0) Option to Negotiate Leases on DNS Updates"</span>, <span class="seriesInfo">RFC 9664</span>, <span class="seriesInfo">DOI 10.17487/RFC9664</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9664">https://www.rfc-editor.org/info/rfc9664</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IAB-ARPA">[IAB-ARPA]</dt>
        <dd>
<span class="refTitle">"Internet Architecture Board statement on the registration of special use names in the ARPA domain"</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.iab.org/documents/correspondence-reports-documents/2017-2/iab-statement-on-the-registration-of-special-use-names-in-the-arpa-domain/">https://www.iab.org/documents/correspondence-reports-documents/2017-2/iab-statement-on-the-registration-of-special-use-names-in-the-arpa-domain/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPv6">[IPv6]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IANA IPv6 Special-Purpose Address Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/iana-ipv6-special-registry">https://www.iana.org/assignments/iana-ipv6-special-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LSDZ">[LSDZ]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Locally-Served DNS Zones"</span>, <span>&lt;<a href="https://www.iana.org/assignments/locally-served-dns-zones">https://www.iana.org/assignments/locally-served-dns-zones</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PORT">[PORT]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Service Name and Transport Protocol Port Number Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/service-names-port-numbers">https://www.iana.org/assignments/service-names-port-numbers</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
        <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2827">[RFC2827]</dt>
        <dd>
<span class="refAuthor">Ferguson, P.</span> and <span class="refAuthor">D. Senie</span>, <span class="refTitle">"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"</span>, <span class="seriesInfo">BCP 38</span>, <span class="seriesInfo">RFC 2827</span>, <span class="seriesInfo">DOI 10.17487/RFC2827</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2827">https://www.rfc-editor.org/info/rfc2827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3007">[RFC3007]</dt>
        <dd>
<span class="refAuthor">Wellington, B.</span>, <span class="refTitle">"Secure Domain Name System (DNS) Dynamic Update"</span>, <span class="seriesInfo">RFC 3007</span>, <span class="seriesInfo">DOI 10.17487/RFC3007</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3007">https://www.rfc-editor.org/info/rfc3007</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3927">[RFC3927]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">E. Guttman</span>, <span class="refTitle">"Dynamic Configuration of IPv4 Link-Local Addresses"</span>, <span class="seriesInfo">RFC 3927</span>, <span class="seriesInfo">DOI 10.17487/RFC3927</span>, <time datetime="2005-05" class="refDate">May 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3927">https://www.rfc-editor.org/info/rfc3927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6105">[RFC6105]</dt>
        <dd>
<span class="refAuthor">Levy-Abegnoli, E.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Popoviciu, C.</span>, and <span class="refAuthor">J. Mohacsi</span>, <span class="refTitle">"IPv6 Router Advertisement Guard"</span>, <span class="seriesInfo">RFC 6105</span>, <span class="seriesInfo">DOI 10.17487/RFC6105</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6105">https://www.rfc-editor.org/info/rfc6105</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6335">https://www.rfc-editor.org/info/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6760">[RFC6760]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Requirements for a Protocol to Replace the AppleTalk Name Binding Protocol (NBP)"</span>, <span class="seriesInfo">RFC 6760</span>, <span class="seriesInfo">DOI 10.17487/RFC6760</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6760">https://www.rfc-editor.org/info/rfc6760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6761">[RFC6761]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span class="seriesInfo">RFC 6761</span>, <span class="seriesInfo">DOI 10.17487/RFC6761</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6761">https://www.rfc-editor.org/info/rfc6761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6887">[RFC6887]</dt>
        <dd>
<span class="refAuthor">Wing, D., Ed.</span>, <span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Penno, R.</span>, and <span class="refAuthor">P. Selkirk</span>, <span class="refTitle">"Port Control Protocol (PCP)"</span>, <span class="seriesInfo">RFC 6887</span>, <span class="seriesInfo">DOI 10.17487/RFC6887</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6887">https://www.rfc-editor.org/info/rfc6887</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7084">[RFC7084]</dt>
        <dd>
<span class="refAuthor">Singh, H.</span>, <span class="refAuthor">Beebee, W.</span>, <span class="refAuthor">Donley, C.</span>, and <span class="refAuthor">B. Stark</span>, <span class="refTitle">"Basic Requirements for IPv6 Customer Edge Routers"</span>, <span class="seriesInfo">RFC 7084</span>, <span class="seriesInfo">DOI 10.17487/RFC7084</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7084">https://www.rfc-editor.org/info/rfc7084</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7413">[RFC7413]</dt>
        <dd>
<span class="refAuthor">Cheng, Y.</span>, <span class="refAuthor">Chu, J.</span>, <span class="refAuthor">Radhakrishnan, S.</span>, and <span class="refAuthor">A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7723">[RFC7723]</dt>
        <dd>
<span class="refAuthor">Kiesel, S.</span> and <span class="refAuthor">R. Penno</span>, <span class="refTitle">"Port Control Protocol (PCP) Anycast Addresses"</span>, <span class="seriesInfo">RFC 7723</span>, <span class="seriesInfo">DOI 10.17487/RFC7723</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7723">https://www.rfc-editor.org/info/rfc7723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
        <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8520">[RFC8520]</dt>
        <dd>
<span class="refAuthor">Lear, E.</span>, <span class="refAuthor">Droms, R.</span>, and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"Manufacturer Usage Description Specification"</span>, <span class="seriesInfo">RFC 8520</span>, <span class="seriesInfo">DOI 10.17487/RFC8520</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8520">https://www.rfc-editor.org/info/rfc8520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8766">[RFC8766]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refTitle">"Discovery Proxy for Multicast DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 8766</span>, <span class="seriesInfo">DOI 10.17487/RFC8766</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8766">https://www.rfc-editor.org/info/rfc8766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8945">[RFC8945]</dt>
        <dd>
<span class="refAuthor">Dupont, F.</span>, <span class="refAuthor">Morris, S.</span>, <span class="refAuthor">Vixie, P.</span>, <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">STD 93</span>, <span class="seriesInfo">RFC 8945</span>, <span class="seriesInfo">DOI 10.17487/RFC8945</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8945">https://www.rfc-editor.org/info/rfc8945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.cheshire-dnssd-roadmap">[ROADMAP]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refTitle">"Service Discovery Road Map"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-cheshire-dnssd-roadmap-03</span>, <time datetime="2018-10-23" class="refDate">23 October 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-cheshire-dnssd-roadmap-03">https://datatracker.ietf.org/doc/html/draft-cheshire-dnssd-roadmap-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-snac-simple">[SNAC-SIMPLE]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">J. Hui</span>, <span class="refTitle">"Automatically Connecting Stub Networks to Unmanaged Infrastructure"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-snac-simple-06</span>, <time datetime="2024-11-04" class="refDate">4 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-snac-simple-06">https://datatracker.ietf.org/doc/html/draft-ietf-snac-simple-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SUB">[SUB]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"service.arpa Subdomain"</span>, <span>&lt;<a href="https://www.iana.org/assignments/locally-served-dns-zones/locally-served-dns-zones">https://www.iana.org/assignments/locally-served-dns-zones/locally-served-dns-zones</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SUDN">[SUDN]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span>&lt;<a href="https://www.iana.org/assignments/special-use-domain-names">https://www.iana.org/assignments/special-use-domain-names</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZC">[ZC]</dt>
      <dd>
<span class="refAuthor">Steinberg, D.H.</span> and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Zero Configuration Networking: The Definitive Guide"</span>, <span class="refContent">O'Reilly Media, Inc.</span>, <span class="seriesInfo">ISBN 9780596101008</span>, <time datetime="2005-12" class="refDate">December 2005</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-using-standard-authoritativ">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-using-standard-authoritativ" class="section-name selfRef">Using Standard Authoritative DNS Servers Compliant with RFC 2136 to Test SRP Requesters</a>
      </h2>
<p id="appendix-A-1">
        For testing, it may be useful to set up an
        authoritative DNS server that does not implement SRP.
        This can be done by configuring the
        authoritative DNS server to listen on the anycast address or by
        advertising it in the "_dnssd‑srp._tcp.&lt;zone&gt;" and
        "_dnssd‑srp‑tls._tcp.&lt;zone&gt;" SRV records.
        It must be configured to be authoritative for
        "default.service.arpa." and to accept updates from hosts
        on local networks for names under "default.service.arpa."
        without authentication since such authoritative DNS servers will not
        have support for FCFS authentication (<a href="#fcfs" class="auto internal xref">Section 3.2.4.1</a>).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">
        An authoritative DNS server configured in this way will be able to successfully accept and process SRP Updates from requesters that send SRP
        updates.  However, no prerequisites will be applied; this means
        that the test authoritative DNS server will accept internally
        inconsistent SRP Updates and will not stop two SRP Updates sent by different services that claim the same name or names
        from overwriting each other.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">
        Since SRP Updates are signed with keys, validation of the SIG(0) algorithm used by the requester can be done by manually
        installing the requester's public key on the authoritative DNS server
        that will be receiving the updates.  The key can then be used to
        authenticate the SRP Update and can be used as a requirement for the update.  An example configuration for testing SRP
        using BIND 9 is given in <a href="#bind-example" class="auto internal xref">Appendix C</a>.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-how-to-allow-srp-requesters">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-how-to-allow-srp-requesters" class="section-name selfRef">How to Allow SRP Requesters to Update Standard Servers Compliant with RFC 2136</a>
      </h2>
<p id="appendix-B-1">
        Ordinarily, CNN SRP Updates sent to an authoritative DNS server
        that implements standard DNS Update <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span> but not SRP
        will fail
        because the zone being updated is "default.service.arpa." and because
        no authoritative DNS server that is not an SRP registrar would normally
        be configured to be authoritative for "default.service.arpa.".
        Therefore, a requester that sends an SRP Update can
        tell that the receiving authoritative DNS server
        does not support SRP but does support
        standard DNS Update <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>
        because the RCODE will either be NotZone, NotAuth, or Refused or because
        there is no response to the update request (when using the anycast address).<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
        In this case, a requester <span class="bcp14">MAY</span>
        attempt to register itself using
        normal DNS updates <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>.
        To do so, it must discover the
        default registration zone and the authoritative DNS server designated
        to receive updates for that zone, as described earlier, using the
        _dns‑update._udp SRV record.  It can then send the update to the port and host pointed to by the SRV record, and it is
        expected to use appropriate prerequisites to avoid overwriting competing records.  Such updates are out of scope for SRP,
        and a requester that implements SRP <span class="bcp14">MUST</span>
        first attempt to use SRP to register itself and
        only attempt to use backwards capability with
        normal DNS Update <span>[<a href="#RFC2136" class="cite xref">RFC2136</a>]</span>
        if that fails.
        Although the owner name of the SRV record for
        DNS Update (_dns-update._udp) specifies UDP,
        it is also possible to use TCP, and TCP <span class="bcp14">SHOULD</span> be required to prevent spoofing.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
<div id="bind-example">
<section id="appendix-C">
      <h2 id="name-sample-bind-9-configuration">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-sample-bind-9-configuration" class="section-name selfRef">Sample BIND 9 Configuration for "default.service.arpa."</a>
      </h2>
<span id="name-zone-configuration-in-named"></span><figure id="figure-1">
        <div class="alignCenter art-text artwork" id="appendix-C-1.1">
<pre>
zone "default.service.arpa." {
  type primary;
  file "/etc/bind/primary/service.db";
  allow-update { key demo.default.service.arpa.; };
};</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-zone-configuration-in-named" class="selfRef">Zone Configuration in named.conf</a>
        </figcaption></figure>
<span id="name-example-zone-file"></span><figure id="figure-2">
        <div class="alignCenter art-text artwork" id="appendix-C-2.1">
<pre>
$TTL 57600  ; 16 hours
@                   IN SOA       ns postmaster (
                      2951053287 ; serial
                      3600       ; refresh (1 hour)
                      1800       ; retry   (30 minutes)
                      604800     ; expire  (1 week)
                      3600       ; minimum (1 hour)
                      )
                    NS           ns
ns                  AAAA         2001:db8:0:2::1

$TTL 3600   ; 1 hour

; Autoconguration bootstrap records
_dnssd-srp._tcp     SRV 0 0 53   ns
_dnssd-srp-tls._tcp SRV 0 0 853  ns

; Service Discovery Instruction
_ipps._tcp          PTR          demo._ipps._tcp

; Service Description Instruction
demo._ipps._tcp     SRV 0 0 631  demohost
                    TXT          ""

; Host Description Instruction
demohost            AAAA         2001:db8:0:2::2
                    KEY 0 3 13 (
                      qweEmaaq0FAWok5//ftuQtZgiZoiFSUsm0srWREdywQU
                      9dpvtOhrdKWUuPT3uEFF5TZU6B4q1z1I662GdaUwqg==
                      ); alg = ECDSAP256SHA256 ; key id = 14495
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-zone-file" class="selfRef">Example Zone File</a>
        </figcaption></figure>
</section>
</div>
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">Thanks to <span class="contact-name">Toke Høiland-Jørgensen</span>, <span class="contact-name">Jonathan Hui</span>, <span class="contact-name">Esko Dijk</span>, <span class="contact-name">Kangping Dong</span>, and <span class="contact-name">Abtin Keshavarzian</span>
      for their thorough technical reviews. Thanks to <span class="contact-name">Kangping</span> and <span class="contact-name">Abtin</span> as well for
      testing the document by doing an independent implementation. Thanks to
      <span class="contact-name">Tamara Kemper</span> for doing a nice developmental edit,
      <span class="contact-name">Tim Wattenberg</span> for doing an SRP requester
      proof-of-concept implementation at the Montreal Hackathon at IETF 102,
      and <span class="contact-name">Tom Pusateri</span> for reviewing during the
      hackathon and afterwards. Thanks to <span class="contact-name">Esko</span> for a
      really thorough second Last Call review. Thanks also to <span class="contact-name">Nathan Dyck</span>, <span class="contact-name">Gabriel Montenegro</span>,
      <span class="contact-name">Kangping Dong</span>, <span class="contact-name">Martin Turon</span>,
      and <span class="contact-name">Michael Cowan</span> for their detailed second last
      call reviews. Thanks to <span class="contact-name">Patrik Fältström</span>, <span class="contact-name">Dhruv Dhody</span>, <span class="contact-name">David Dong</span>, <span class="contact-name">Joey Salazar</span>, <span class="contact-name">Jean-Michel Combes</span>, and
      <span class="contact-name">Joerg Ott</span> for their respective directorate
      reviews. Thanks to <span class="contact-name">Paul Wouters</span> for a
      <em>really</em> detailed IESG review! Thanks also to the other IESG
      members who provided comments or simply took the time to review the
      document.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ted Lemon</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino</span>, <span class="region">CA</span> <span class="postal-code">95014</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mellon@fugue.com" class="email">mellon@fugue.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stuart Cheshire</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino</span>, <span class="region">CA</span> <span class="postal-code">95014</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20408%20974%203207" class="tel">+1 408 974 3207</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cheshire@apple.com" class="email">cheshire@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
